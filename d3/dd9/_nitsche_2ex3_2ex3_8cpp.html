<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - National University of Ireland, Galway/Desktop/femus/source/applications/Nitsche/ex3/ex3.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d3/dd9/_nitsche_2ex3_2ex3_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ex3.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../df/d7c/_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/dce/_multi_level_solution_8hpp_source.html">MultiLevelSolution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/dbc/_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df7/_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d84/_g_m_v_writer_8hpp_source.html">GMVWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d31/_petsc_matrix_8hpp_source.html">PetscMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;slepceps.h&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d69/_linear_implicit_system_8hpp_source.html">LinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d84/_marker_8hpp_source.html">Marker.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/d3a/_line_8hpp_source.html">Line.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d6d/_fluid_8hpp_source.html">Fluid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d7c/_solid_8hpp_source.html">Solid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d1d/_parameter_8hpp_source.html">Parameter.hpp</a>&quot;</code><br />
</div>
<p><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a2e46d3d6a029c1cf6ccbcf0f4b84b2db"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2e46d3d6a029c1cf6ccbcf0f4b84b2db">AssembleNitscheProblem_AD</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;mlProb)</td></tr>
<tr class="separator:a2e46d3d6a029c1cf6ccbcf0f4b84b2db"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0b05575316919a4fd6d7cb0f2daaa7cd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a0b05575316919a4fd6d7cb0f2daaa7cd">BuildFlag</a> (<a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;mlSol)</td></tr>
<tr class="separator:a0b05575316919a4fd6d7cb0f2daaa7cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7d8e300019ed90d788a45877936a66ed"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a7d8e300019ed90d788a45877936a66ed">GetInterfaceElementEigenvalues</a> (<a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;mlSol)</td></tr>
<tr class="separator:a7d8e300019ed90d788a45877936a66ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a> (const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a> (int argc, char **args)</td></tr>
<tr class="separator:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a1586fa1c4660de16b0d05493354e992a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d42/classfemus_1_1_line.html">Line</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a></td></tr>
<tr class="separator:a1586fa1c4660de16b0d05493354e992a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aed2973510af2dd9ff93ef05465ed515f"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d42/classfemus_1_1_line.html">Line</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a></td></tr>
<tr class="separator:aed2973510af2dd9ff93ef05465ed515f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c7f4646f2d0019cf0f5d26738922a6e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d42/classfemus_1_1_line.html">Line</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a></td></tr>
<tr class="separator:a9c7f4646f2d0019cf0f5d26738922a6e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d74540095f3eb8232f3cdefa65b6c61"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> = 2</td></tr>
<tr class="separator:a2d74540095f3eb8232f3cdefa65b6c61"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a2e46d3d6a029c1cf6ccbcf0f4b84b2db" name="a2e46d3d6a029c1cf6ccbcf0f4b84b2db"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e46d3d6a029c1cf6ccbcf0f4b84b2db">&#9670;&#160;</a></span>AssembleNitscheProblem_AD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AssembleNitscheProblem_AD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>mlProb</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00330">330</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  330</span>                                                           {</div>
<div class="line"><span class="lineno">  331</span>  <span class="comment">//  ml_prob is the global object from/to where get/set all the data</span></div>
<div class="line"><span class="lineno">  332</span>  <span class="comment">//  level is the level of the PDE system to be assembled</span></div>
<div class="line"><span class="lineno">  333</span>  <span class="comment">//  levelMax is the Maximum level of the MultiLevelProblem</span></div>
<div class="line"><span class="lineno">  334</span>  <span class="comment">//  assembleMatrix is a flag that tells if only the residual or also the matrix should be assembled</span></div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>  <span class="comment">// call the adept stack object</span></div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  adept::Stack&amp; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> = <a class="code hl_variable" href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>  <span class="comment">//  extract pointers to the several objects that we are going to use</span></div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>* mlPdeSys  = &amp;ml_prob.get_system&lt;<a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&gt; (<span class="stringliteral">&quot;Nitsche&quot;</span>);   <span class="comment">// pointer to the linear implicit system named &quot;Poisson&quot;</span></div>
<div class="line"><span class="lineno">  344</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlPdeSys-&gt;<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>(); <span class="comment">// We have different level of meshes. we assemble the problem on the specified one.</span></div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>*                    msh = ml_prob._ml_msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>(level);    <span class="comment">// pointer to the mesh (level) object</span></div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>*                     el = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;  <span class="comment">// pointer to the elem object in msh (level)</span></div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>*    mlSol = ml_prob._ml_sol;  <span class="comment">// pointer to the multilevel solution object</span></div>
<div class="line"><span class="lineno">  350</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>*                sol = ml_prob._ml_sol-&gt;GetSolutionLevel(level);    <span class="comment">// pointer to the solution (level) object</span></div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>  <a class="code hl_class" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>* pdeSys = mlPdeSys-&gt;<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[level]; <span class="comment">// pointer to the equation (level) object</span></div>
<div class="line"><span class="lineno">  353</span>  <a class="code hl_class" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a>*             <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;  <span class="comment">// pointer to the global stifness matrix object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  354</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>*           RES = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>; <span class="comment">// pointer to the global residual vector object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="../../dc/d88/_s_w_2ex4_2ex4_8cpp.html#aca45debda5a6ad2b105279e0860f9710">rho1</a> = ml_prob.parameters.get&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid1&quot;</span>).get_density();</div>
<div class="line"><span class="lineno">  357</span>  <span class="keywordtype">double</span> rho2 = ml_prob.parameters.get&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid2&quot;</span>).get_density();</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>  <span class="keywordtype">double</span> mu1 = ml_prob.parameters.get&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid1&quot;</span>).get_lame_shear_modulus();</div>
<div class="line"><span class="lineno">  360</span>  <span class="keywordtype">double</span> lambda1 = ml_prob.parameters.get&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid1&quot;</span>).get_lame_lambda();</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>  <span class="keywordtype">double</span> mu2 = ml_prob.parameters.get&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid2&quot;</span>).get_lame_shear_modulus();</div>
<div class="line"><span class="lineno">  363</span>  <span class="keywordtype">double</span> lambda2 = ml_prob.parameters.get&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid2&quot;</span>).get_lame_lambda();</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>  <span class="keywordtype">double</span> g[<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a>] = {1.};</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>(); <span class="comment">// get the domain dimension of the problem</span></div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  <span class="comment">//solution variable</span></div>
<div class="line"><span class="lineno">  372</span>  std::vector&lt; unsigned &gt; solD1Index(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  373</span>  solD1Index[0] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;DX1&quot;</span>);</div>
<div class="line"><span class="lineno">  374</span>  solD1Index[1] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;DY1&quot;</span>);</div>
<div class="line"><span class="lineno">  375</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 3)solD1Index[2] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;DZ1&quot;</span>);</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  std::vector&lt; unsigned &gt; solD2Index(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  378</span>  solD2Index[0] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;DX2&quot;</span>);</div>
<div class="line"><span class="lineno">  379</span>  solD2Index[1] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;DY2&quot;</span>);</div>
<div class="line"><span class="lineno">  380</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 3)solD2Index[2] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;DZ2&quot;</span>);</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>  <span class="keywordtype">unsigned</span> solDType = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(solD1Index[0]);</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>  std::vector&lt; unsigned &gt; solD1PdeIndex(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  385</span>  solD1PdeIndex[0] = mlPdeSys-&gt;<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;DX1&quot;</span>);</div>
<div class="line"><span class="lineno">  386</span>  solD1PdeIndex[1] = mlPdeSys-&gt;<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;DY1&quot;</span>);</div>
<div class="line"><span class="lineno">  387</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 3) solD1PdeIndex[2] = mlPdeSys-&gt;<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;DZ1&quot;</span>);</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>  std::vector&lt; unsigned &gt; solD2PdeIndex(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  390</span>  solD2PdeIndex[0] = mlPdeSys-&gt;<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;DX2&quot;</span>);</div>
<div class="line"><span class="lineno">  391</span>  solD2PdeIndex[1] = mlPdeSys-&gt;<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;DY2&quot;</span>);</div>
<div class="line"><span class="lineno">  392</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 3) solD2PdeIndex[2] = mlPdeSys-&gt;<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;DZ2&quot;</span>);</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>  std::vector &lt; std::vector &lt; adept::adouble &gt; &gt; solD1(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>); <span class="comment">// local solution</span></div>
<div class="line"><span class="lineno">  395</span>  std::vector &lt; std::vector &lt; adept::adouble &gt; &gt; solD2(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>); <span class="comment">// local solution</span></div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>  <span class="keywordtype">unsigned</span> CMIndex[2];</div>
<div class="line"><span class="lineno">  398</span>  <span class="keywordtype">unsigned</span> CLIndex[2];</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  CMIndex[0] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CM1&quot;</span>);</div>
<div class="line"><span class="lineno">  401</span>  CMIndex[1] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CM2&quot;</span>);</div>
<div class="line"><span class="lineno">  402</span>  </div>
<div class="line"><span class="lineno">  403</span>  CLIndex[0] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CL1&quot;</span>);</div>
<div class="line"><span class="lineno">  404</span>  CLIndex[1] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CL2&quot;</span>);</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>  <span class="keywordtype">unsigned</span> eflagIndex = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;eflag&quot;</span>);</div>
<div class="line"><span class="lineno">  407</span>  <span class="keywordtype">unsigned</span> nflagIndex = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;nflag&quot;</span>);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>  vector &lt; unsigned &gt;  nodeFlag; <span class="comment">// local solution</span></div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>  vector &lt; vector &lt; double &gt; &gt; x(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);    <span class="comment">// local coordinates. x is now dim x m matrix.</span></div>
<div class="line"><span class="lineno">  412</span>  <span class="keywordtype">unsigned</span> xType = 2; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE QUADRATIC)</span></div>
<div class="line"><span class="lineno">  413</span> </div>
<div class="line"><span class="lineno">  414</span>  vector &lt;double&gt; <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno">  415</span>  vector &lt;double&gt; phi_x; <span class="comment">// local test function first order partial derivatives</span></div>
<div class="line"><span class="lineno">  416</span>  <span class="keywordtype">double</span> weight; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>  std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; aResD1(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>); <span class="comment">// local redidual vector</span></div>
<div class="line"><span class="lineno">  419</span>  std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; aResD2(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>); <span class="comment">// local redidual vector</span></div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>  vector&lt; unsigned &gt; l2GMap; <span class="comment">// local to global mapping</span></div>
<div class="line"><span class="lineno">  422</span>  vector&lt; double &gt; Res; <span class="comment">// local redidual vector</span></div>
<div class="line"><span class="lineno">  423</span>  vector &lt; double &gt; Jac;</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>  <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;zero(); <span class="comment">// Set to zero all the entries of the Global Matrix</span></div>
<div class="line"><span class="lineno">  426</span>  RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>(); <span class="comment">// Set to zero all the entries of the Global Residual</span></div>
<div class="line"><span class="lineno">  427</span> </div>
<div class="line"><span class="lineno">  428</span>  std::vector &lt; std::vector &lt; std::vector &lt;double &gt; &gt; &gt; aP(3);</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>  std::vector&lt;Marker*&gt; particle1 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a47540a9b4bed6171c59bc76fe560fdf8">GetParticles</a>();</div>
<div class="line"><span class="lineno">  431</span>  std::vector&lt;unsigned&gt; markerOffset1 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a3b3081a718e2dd06970a35f1e792f9a5">GetMarkerOffset</a>();</div>
<div class="line"><span class="lineno">  432</span>  <span class="keywordtype">unsigned</span> imarker1 = markerOffset1[iproc];</div>
<div class="line"><span class="lineno">  433</span> </div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>  std::vector&lt;Marker*&gt; particle2 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a47540a9b4bed6171c59bc76fe560fdf8">GetParticles</a>();</div>
<div class="line"><span class="lineno">  436</span>  std::vector&lt;unsigned&gt; markerOffset2 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a3b3081a718e2dd06970a35f1e792f9a5">GetMarkerOffset</a>();</div>
<div class="line"><span class="lineno">  437</span>  <span class="keywordtype">unsigned</span> imarker2 = markerOffset2[iproc];</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>  std::vector&lt;Marker*&gt; particleI = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a47540a9b4bed6171c59bc76fe560fdf8">GetParticles</a>();</div>
<div class="line"><span class="lineno">  440</span>  std::vector&lt;unsigned&gt; markerOffsetI = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a3b3081a718e2dd06970a35f1e792f9a5">GetMarkerOffset</a>();</div>
<div class="line"><span class="lineno">  441</span>  <span class="keywordtype">unsigned</span> imarkerI = markerOffsetI[iproc];</div>
<div class="line"><span class="lineno">  442</span> </div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  447</span>    <span class="keywordtype">unsigned</span> nDofD  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, solDType);  <span class="comment">// number of solution element dofs</span></div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>    <span class="keywordtype">unsigned</span> eFlag = <span class="keyword">static_cast &lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(floor((*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[eflagIndex])(iel) + 0.5));</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    <span class="comment">// resize local arrays</span></div>
<div class="line"><span class="lineno">  452</span>    l2GMap.resize(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> * 2 * nDofD);</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  454</span>      solD1[k].resize(nDofD);</div>
<div class="line"><span class="lineno">  455</span>      solD2[k].resize(nDofD);</div>
<div class="line"><span class="lineno">  456</span>      aResD1[k].assign(nDofD, 0.);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  457</span>      aResD2[k].assign(nDofD, 0.);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  458</span>    }</div>
<div class="line"><span class="lineno">  459</span>    nodeFlag.resize(nDofD);</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  462</span>      x[k].resize(nDofD);</div>
<div class="line"><span class="lineno">  463</span>    }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <span class="comment">// local storage of global mapping and solution</span></div>
<div class="line"><span class="lineno">  468</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  469</span>      <span class="keywordtype">unsigned</span> iDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, solDType);</div>
<div class="line"><span class="lineno">  470</span>      nodeFlag[i] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[nflagIndex])(iDof);</div>
<div class="line"><span class="lineno">  471</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  472</span>        solD1[k][i] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solD1Index[k]])(iDof);</div>
<div class="line"><span class="lineno">  473</span>        solD2[k][i] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solD2Index[k]])(iDof);</div>
<div class="line"><span class="lineno">  474</span> </div>
<div class="line"><span class="lineno">  475</span>        l2GMap[k * nDofD + i] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(solD1Index[k], solD1PdeIndex[k], i, iel);</div>
<div class="line"><span class="lineno">  476</span>        l2GMap[(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k) * nDofD + i] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(solD2Index[k], solD2PdeIndex[k], i, iel);</div>
<div class="line"><span class="lineno">  477</span> </div>
<div class="line"><span class="lineno">  478</span>      }</div>
<div class="line"><span class="lineno">  479</span>    }</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    <span class="comment">// local storage of coordinates</span></div>
<div class="line"><span class="lineno">  482</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  483</span>      <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, 2);    <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  484</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  485</span>        x[k][i] = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k])(xDof);      <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  486</span>      }</div>
<div class="line"><span class="lineno">  487</span>    }</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>    <span class="comment">// start a new recording of all the operations involving adept::adouble variables</span></div>
<div class="line"><span class="lineno">  490</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.new_recording();</div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">if</span>(eFlag == 0 || eFlag == 2) {</div>
<div class="line"><span class="lineno">  492</span>      <span class="comment">// *** Element Gauss point loop ***</span></div>
<div class="line"><span class="lineno">  493</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][solDType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>(); <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  494</span>        <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno">  495</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][solDType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>        <span class="comment">// evaluate the solution, the solution derivatives and the coordinates in the gauss point</span></div>
<div class="line"><span class="lineno">  498</span>        std::vector &lt; std::vector &lt; adept::adouble &gt; &gt; gradSolD1(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  499</span>        std::vector &lt; std::vector &lt; adept::adouble &gt; &gt; gradSolD2(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  502</span>          gradSolD1[k].assign(nDofD, 0.);</div>
<div class="line"><span class="lineno">  503</span>          gradSolD2[k].assign(nDofD, 0.);</div>
<div class="line"><span class="lineno">  504</span>        }</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  507</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  508</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  509</span>              gradSolD1[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * solD1[k][i];</div>
<div class="line"><span class="lineno">  510</span>              gradSolD2[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * solD2[k][i];</div>
<div class="line"><span class="lineno">  511</span>            }</div>
<div class="line"><span class="lineno">  512</span>          }</div>
<div class="line"><span class="lineno">  513</span>        }</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>        <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  516</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>          adept::adouble divD1 = 0.;</div>
<div class="line"><span class="lineno">  519</span>          adept::adouble divD2 = 0.;</div>
<div class="line"><span class="lineno">  520</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  521</span>            divD1 += gradSolD1[k][k] * (eFlag == 0);</div>
<div class="line"><span class="lineno">  522</span>            divD2 += gradSolD2[k][k] * (eFlag == 2);</div>
<div class="line"><span class="lineno">  523</span>          }</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>            adept::adouble sigma1 = 0.;</div>
<div class="line"><span class="lineno">  528</span>            adept::adouble sigma2 = 0.;</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  531</span>              sigma1 += mu1 * (gradSolD1[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + gradSolD1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][k] * (eFlag == 0)) * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  532</span>              sigma2 += mu2 * (gradSolD2[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + gradSolD2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][k] * (eFlag == 2)) * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  533</span>            }</div>
<div class="line"><span class="lineno">  534</span>            sigma1 += lambda1 * divD1 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k];</div>
<div class="line"><span class="lineno">  535</span>            sigma2 += lambda2 * divD2 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k];</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>            <span class="keywordflow">if</span>(eFlag == 0) {</div>
<div class="line"><span class="lineno">  538</span>              aResD1[k][i] += (- <a class="code hl_variable" href="../../dc/d88/_s_w_2ex4_2ex4_8cpp.html#aca45debda5a6ad2b105279e0860f9710">rho1</a> * g[k] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] + sigma1) * weight;</div>
<div class="line"><span class="lineno">  539</span>              <span class="keywordflow">if</span>(nodeFlag[i] != 1) { <span class="comment">// fake equation for sugular matrix</span></div>
<div class="line"><span class="lineno">  540</span>                aResD2[k][i] += sigma2 * weight;</div>
<div class="line"><span class="lineno">  541</span>              }</div>
<div class="line"><span class="lineno">  542</span>            }</div>
<div class="line"><span class="lineno">  543</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>(eFlag == 2) {</div>
<div class="line"><span class="lineno">  544</span>              aResD2[k][i] += (- rho2 * g[k] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] + sigma2) * weight;</div>
<div class="line"><span class="lineno">  545</span>              <span class="keywordflow">if</span>(nodeFlag[i] != 1) { <span class="comment">// fake equation for sugular matrix</span></div>
<div class="line"><span class="lineno">  546</span>                aResD1[k][i] += sigma1 * weight;</div>
<div class="line"><span class="lineno">  547</span>              }</div>
<div class="line"><span class="lineno">  548</span>            }</div>
<div class="line"><span class="lineno">  549</span>          }</div>
<div class="line"><span class="lineno">  550</span> </div>
<div class="line"><span class="lineno">  551</span>        } <span class="comment">// end phi_i loop</span></div>
<div class="line"><span class="lineno">  552</span>      } <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno">  553</span>    }</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>      <span class="keywordtype">double</span> iM1C1 = 1. / (mu1 * (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CMIndex[0]])(iel));</div>
<div class="line"><span class="lineno">  558</span>      <span class="keywordtype">double</span> iM2C2 = 1. / (mu2 * (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CMIndex[1]])(iel));</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>      <span class="keywordtype">double</span> denM = iM1C1 + iM2C2;</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>      <span class="keywordtype">double</span> gammaM1 = iM1C1 / denM;</div>
<div class="line"><span class="lineno">  563</span>      <span class="keywordtype">double</span> gammaM2 = iM2C2 / denM;</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>      <span class="keywordtype">double</span> thetaM = 8. / denM;</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>      <span class="keywordtype">double</span> iL1C1 = 1. / (lambda1 * (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CLIndex[0]])(iel));</div>
<div class="line"><span class="lineno">  568</span>      <span class="keywordtype">double</span> iL2C2 = 1. / (lambda2 * (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CLIndex[1]])(iel));</div>
<div class="line"><span class="lineno">  569</span>      </div>
<div class="line"><span class="lineno">  570</span>      <span class="keywordtype">double</span> denL = iL1C1 + iL2C2;</div>
<div class="line"><span class="lineno">  571</span>      </div>
<div class="line"><span class="lineno">  572</span>      <span class="keywordtype">double</span> gammaL1 = iL1C1 / denL;</div>
<div class="line"><span class="lineno">  573</span>      <span class="keywordtype">double</span> gammaL2 = iL2C2 / denL;</div>
<div class="line"><span class="lineno">  574</span>      </div>
<div class="line"><span class="lineno">  575</span>      <span class="keywordtype">double</span> thetaL = 4. / denL;</div>
<div class="line"><span class="lineno">  576</span>      </div>
<div class="line"><span class="lineno">  577</span>      </div>
<div class="line"><span class="lineno">  578</span><span class="comment">//       double gammaL1 = 0.5;</span></div>
<div class="line"><span class="lineno">  579</span><span class="comment">//       double gammaL2 = 0.5;</span></div>
<div class="line"><span class="lineno">  580</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  581</span><span class="comment">//       double gammaM1 = 0.5;</span></div>
<div class="line"><span class="lineno">  582</span><span class="comment">//       double gammaM2 = 0.5;</span></div>
<div class="line"><span class="lineno">  583</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  584</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  585</span><span class="comment">//       double thetaL = lambda1;</span></div>
<div class="line"><span class="lineno">  586</span><span class="comment">//       double thetaM = mu1;</span></div>
<div class="line"><span class="lineno">  587</span> </div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span>      <span class="comment">//bulk1</span></div>
<div class="line"><span class="lineno">  591</span>      <span class="keywordflow">while</span>(imarker1 &lt; markerOffset1[iproc + 1] &amp;&amp; iel == particle1[imarker1]-&gt;GetMarkerElement()) {</div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span>        <span class="comment">// the local coordinates of the particles are the Gauss points in this context</span></div>
<div class="line"><span class="lineno">  594</span>        std::vector &lt;double&gt; <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a> = particle1[imarker1]-&gt;GetMarkerLocalCoordinates();</div>
<div class="line"><span class="lineno">  595</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][solDType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x, <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno">  596</span>        <span class="keywordtype">double</span> weight = particle1[imarker1]-&gt;GetMarkerMass();</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>        <span class="comment">// evaluate the solution, the solution derivatives and the coordinates in the gauss point</span></div>
<div class="line"><span class="lineno">  600</span>        std::vector &lt; std::vector &lt; adept::adouble &gt; &gt; gradSolD1(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  601</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  602</span>          gradSolD1[k].assign(nDofD, 0.);</div>
<div class="line"><span class="lineno">  603</span>        }</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  606</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  607</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  608</span>              gradSolD1[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * solD1[k][i];</div>
<div class="line"><span class="lineno">  609</span>            }</div>
<div class="line"><span class="lineno">  610</span>          }</div>
<div class="line"><span class="lineno">  611</span>        }</div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  614</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>          adept::adouble divD1 = 0.;</div>
<div class="line"><span class="lineno">  617</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  618</span>            divD1 += gradSolD1[k][k];</div>
<div class="line"><span class="lineno">  619</span>          }</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  622</span>            adept::adouble sigma1 = 0.;</div>
<div class="line"><span class="lineno">  623</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  624</span>              sigma1 += mu1 * (gradSolD1[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + gradSolD1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][k]) * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  625</span>            }</div>
<div class="line"><span class="lineno">  626</span>            sigma1 += lambda1 * divD1 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k];</div>
<div class="line"><span class="lineno">  627</span>            aResD1[k][i] += (- <a class="code hl_variable" href="../../dc/d88/_s_w_2ex4_2ex4_8cpp.html#aca45debda5a6ad2b105279e0860f9710">rho1</a> * g[k] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] + sigma1) * weight;</div>
<div class="line"><span class="lineno">  628</span>          }</div>
<div class="line"><span class="lineno">  629</span>        } <span class="comment">// end phi_i loop</span></div>
<div class="line"><span class="lineno">  630</span>        imarker1++;</div>
<div class="line"><span class="lineno">  631</span>      }</div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>      <span class="comment">//bulk2</span></div>
<div class="line"><span class="lineno">  634</span>      <span class="keywordflow">while</span>(imarker2 &lt; markerOffset2[iproc + 1] &amp;&amp; iel == particle2[imarker2]-&gt;GetMarkerElement()) {</div>
<div class="line"><span class="lineno">  635</span> </div>
<div class="line"><span class="lineno">  636</span>        <span class="comment">// the local coordinates of the particles are the Gauss points in this context</span></div>
<div class="line"><span class="lineno">  637</span>        std::vector &lt;double&gt; <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a> = particle2[imarker2]-&gt;GetMarkerLocalCoordinates();</div>
<div class="line"><span class="lineno">  638</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][solDType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x, <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordtype">double</span> weight = particle2[imarker2]-&gt;GetMarkerMass();</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>        std::vector &lt; std::vector &lt; adept::adouble &gt; &gt; gradSolD2(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  642</span> </div>
<div class="line"><span class="lineno">  643</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  644</span>          gradSolD2[k].assign(nDofD, 0.);</div>
<div class="line"><span class="lineno">  645</span>        }</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  648</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  649</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  650</span>              gradSolD2[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * solD2[k][i];</div>
<div class="line"><span class="lineno">  651</span>            }</div>
<div class="line"><span class="lineno">  652</span>          }</div>
<div class="line"><span class="lineno">  653</span>        }</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>        <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  656</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  657</span>          adept::adouble divD2 = 0.;</div>
<div class="line"><span class="lineno">  658</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  659</span>            divD2 += gradSolD2[k][k];</div>
<div class="line"><span class="lineno">  660</span>          }</div>
<div class="line"><span class="lineno">  661</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  662</span>            adept::adouble sigma2 = 0.;</div>
<div class="line"><span class="lineno">  663</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  664</span>              sigma2 += mu2 * (gradSolD2[k][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + gradSolD2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][k]) * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  665</span>            }</div>
<div class="line"><span class="lineno">  666</span>            sigma2 += lambda2 * divD2 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k];</div>
<div class="line"><span class="lineno">  667</span>            aResD2[k][i] += (- rho2 * g[k] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] + sigma2) * weight;</div>
<div class="line"><span class="lineno">  668</span>          }</div>
<div class="line"><span class="lineno">  669</span>        }</div>
<div class="line"><span class="lineno">  670</span>        imarker2++;</div>
<div class="line"><span class="lineno">  671</span>      }</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>      <span class="comment">// interface</span></div>
<div class="line"><span class="lineno">  674</span>      <span class="keywordflow">while</span>(imarkerI &lt; markerOffsetI[iproc + 1] &amp;&amp; iel == particleI[imarkerI]-&gt;GetMarkerElement()) {</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>        <span class="comment">// the local coordinates of the particles are the Gauss points in this context</span></div>
<div class="line"><span class="lineno">  677</span>        std::vector &lt;double&gt; <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a> = particleI[imarkerI]-&gt;GetMarkerLocalCoordinates();</div>
<div class="line"><span class="lineno">  678</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][solDType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x, <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span>        std::vector &lt;std::vector &lt; double &gt; &gt; T;</div>
<div class="line"><span class="lineno">  681</span>        particleI[imarkerI]-&gt;GetMarkerTangent(T);</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>        <span class="keywordtype">double</span> weight;</div>
<div class="line"><span class="lineno">  684</span>        std::vector &lt; double &gt; <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  685</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 2) {</div>
<div class="line"><span class="lineno">  686</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] =  T[0][1];</div>
<div class="line"><span class="lineno">  687</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] = -T[0][0];</div>
<div class="line"><span class="lineno">  688</span>          weight = sqrt(<a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] + <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1]);</div>
<div class="line"><span class="lineno">  689</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] /= weight;</div>
<div class="line"><span class="lineno">  690</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] /= weight;</div>
<div class="line"><span class="lineno">  691</span>        }</div>
<div class="line"><span class="lineno">  692</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  693</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] = T[0][1] * T[1][2] - T[0][2] * T[1][1];</div>
<div class="line"><span class="lineno">  694</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] = T[0][2] * T[1][0] - T[0][0] * T[1][2];</div>
<div class="line"><span class="lineno">  695</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2] = T[0][0] * T[1][1] - T[0][1] * T[1][0];</div>
<div class="line"><span class="lineno">  696</span>          weight = sqrt(<a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] + <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] + <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2]);</div>
<div class="line"><span class="lineno">  697</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] /= weight;</div>
<div class="line"><span class="lineno">  698</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] /= weight;</div>
<div class="line"><span class="lineno">  699</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2] /= weight;</div>
<div class="line"><span class="lineno">  700</span>        }</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span>        std::vector &lt; adept::adouble &gt; u1(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  703</span>        std::vector &lt; adept::adouble &gt; u2(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>        std::vector &lt; adept::adouble &gt; tau(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  708</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  709</span>            u1[k] += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * solD1[k][i];</div>
<div class="line"><span class="lineno">  710</span>            u2[k] += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * solD2[k][i];</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  713</span>              tau[k] += (gammaL1 * lambda1 * solD1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] +</div>
<div class="line"><span class="lineno">  714</span>                         gammaL2 * lambda2 * solD2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[k];</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>              tau[k] += (gammaM1 * mu1 * solD1[k][i] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] +</div>
<div class="line"><span class="lineno">  717</span>                         gammaM2 * mu2 * solD2[k][i] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>              tau[k] += (gammaM1 * mu1 * solD1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] +</div>
<div class="line"><span class="lineno">  720</span>                         gammaM2 * mu2 * solD2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k]) * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  721</span> </div>
<div class="line"><span class="lineno">  722</span>            }</div>
<div class="line"><span class="lineno">  723</span>          }</div>
<div class="line"><span class="lineno">  724</span>        }</div>
<div class="line"><span class="lineno">  725</span>        <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  726</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  727</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  728</span>            aResD1[k][i] += tau[k] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * weight;</div>
<div class="line"><span class="lineno">  729</span>            aResD1[k][i] += -thetaM * (u2[k] - u1[k]) * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * weight;</div>
<div class="line"><span class="lineno">  730</span> </div>
<div class="line"><span class="lineno">  731</span>            aResD2[k][i] += -tau[k] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * weight;</div>
<div class="line"><span class="lineno">  732</span>            aResD2[k][i] +=  thetaM * (u2[k] - u1[k]) * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * weight;</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  735</span>              aResD1[k][i] += -gammaL1 * (lambda1 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * (u2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - u1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>])) * weight;</div>
<div class="line"><span class="lineno">  736</span>              aResD1[k][i] += -gammaM1 * (mu1 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * (u2[k] - u1[k])) * weight;</div>
<div class="line"><span class="lineno">  737</span>              aResD1[k][i] += -gammaM1 * (mu1 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[k] * (u2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - u1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>])) * weight;</div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>              aResD1[k][i] += -thetaL * (u2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - u1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[k] * weight;</div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>              aResD2[k][i] += -gammaL2 * (lambda2 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * (u2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - u1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>])) * weight;</div>
<div class="line"><span class="lineno">  742</span>              aResD2[k][i] += -gammaM2 * (mu2 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * (u2[k] - u1[k])) * weight;</div>
<div class="line"><span class="lineno">  743</span>              aResD2[k][i] += -gammaM2 * (mu2 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[k] * (u2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - u1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>])) * weight;</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>              aResD2[k][i] +=  thetaL * (u2[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - u1[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[k] * weight;</div>
<div class="line"><span class="lineno">  746</span>            }</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>          }</div>
<div class="line"><span class="lineno">  750</span>        } <span class="comment">// end phi_i loop</span></div>
<div class="line"><span class="lineno">  751</span>        imarkerI++;</div>
<div class="line"><span class="lineno">  752</span>      }</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    }</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>    <span class="comment">//copy the value of the adept::adoube aRes in double Res and store</span></div>
<div class="line"><span class="lineno">  757</span>    Res.resize(2 * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> * nDofD);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  760</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nDofD; i++) {</div>
<div class="line"><span class="lineno">  761</span>        Res[k * nDofD + i] = - aResD1[k][i].value();</div>
<div class="line"><span class="lineno">  762</span>        Res[(k + <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>) * nDofD + i] = - aResD2[k][i].<a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>();</div>
<div class="line"><span class="lineno">  763</span>      }</div>
<div class="line"><span class="lineno">  764</span>    }</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res, l2GMap);</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>    <span class="comment">// define the dependent variables</span></div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  770</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.dependent(&amp;aResD1[k][0], nDofD);</div>
<div class="line"><span class="lineno">  771</span>    }</div>
<div class="line"><span class="lineno">  772</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  773</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.dependent(&amp;aResD2[k][0], nDofD);</div>
<div class="line"><span class="lineno">  774</span>    }</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>    <span class="comment">// define the independent variables</span></div>
<div class="line"><span class="lineno">  777</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  778</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent(&amp;solD1[k][0], nDofD);</div>
<div class="line"><span class="lineno">  779</span>    }</div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  781</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent(&amp;solD2[k][0], nDofD);</div>
<div class="line"><span class="lineno">  782</span>    }</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>    <span class="comment">// get the jacobian matrix (ordered by row major )</span></div>
<div class="line"><span class="lineno">  785</span>    Jac.resize(2 * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> * nDofD * 2 * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> * nDofD);   <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  786</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.jacobian(&amp;Jac[0], <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>    <span class="comment">//store K in the global matrix KK</span></div>
<div class="line"><span class="lineno">  789</span>    <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(Jac, l2GMap, l2GMap);</div>
<div class="line"><span class="lineno">  790</span> </div>
<div class="line"><span class="lineno">  791</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_independents();</div>
<div class="line"><span class="lineno">  792</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_dependents();</div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span>  } <span class="comment">//end element loop for each process</span></div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>  RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  797</span>  <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;close();</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span><span class="comment">//   PetscViewer    viewer;</span></div>
<div class="line"><span class="lineno">  800</span><span class="comment">//   //PetscViewerDrawOpen (PETSC_COMM_WORLD, NULL, NULL, 0, 0, 900, 900, &amp;viewer);</span></div>
<div class="line"><span class="lineno">  801</span><span class="comment">//   //PetscObjectSetName ( (PetscObject) viewer, &quot;FSI matrix&quot;);</span></div>
<div class="line"><span class="lineno">  802</span><span class="comment">//   //PetscViewerPushFormat (viewer, PETSC_VIEWER_DRAW_LG);</span></div>
<div class="line"><span class="lineno">  803</span><span class="comment">//   MatView ( (static_cast&lt;PetscMatrix*&gt; (KK))-&gt;mat(), viewer);</span></div>
<div class="line"><span class="lineno">  804</span><span class="comment">//   VecView ( (static_cast&lt;PetscVector*&gt; (RES))-&gt;vec(), viewer);</span></div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>  <span class="comment">//double a;</span></div>
<div class="line"><span class="lineno">  807</span>  <span class="comment">//std::cin &gt;&gt; a;</span></div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span> </div>
<div class="line"><span class="lineno">  811</span>  <span class="comment">//***************** END ASSEMBLY *******************</span></div>
<div class="line"><span class="lineno">  812</span>}</div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451"><div class="ttname"><a href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a></div><div class="ttdeci">@ KK</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9a/_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_a1586fa1c4660de16b0d05493354e992a"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a></div><div class="ttdeci">Line * line1</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00032">ex3.cpp:32</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_a2d74540095f3eb8232f3cdefa65b6c61"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a></div><div class="ttdeci">unsigned DIM</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00036">ex3.cpp:36</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_a9c7f4646f2d0019cf0f5d26738922a6e"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a></div><div class="ttdeci">Line * lineI</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00034">ex3.cpp:34</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_aed2973510af2dd9ff93ef05465ed515f"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a></div><div class="ttdeci">Line * line2</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00033">ex3.cpp:33</a></div></div>
<div class="ttc" id="a_refinement_2ex2_2ex2_8cpp_html_a520a4554f772168e7d5b94a7947c8d87"><div class="ttname"><a href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a></div><div class="ttdeci">const double xi[10][3]</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp_source.html#l00037">ex2.cpp:37</a></div></div>
<div class="ttc" id="a_s_w_2ex2_2ex2_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">double phi</div><div class="ttdef"><b>Definition</b> <a href="../../de/d25/_s_w_2ex2_2ex2_8cpp_source.html#l00038">ex2.cpp:38</a></div></div>
<div class="ttc" id="a_s_w_2ex4_2ex4_8cpp_html_aca45debda5a6ad2b105279e0860f9710"><div class="ttname"><a href="../../dc/d88/_s_w_2ex4_2ex4_8cpp.html#aca45debda5a6ad2b105279e0860f9710">rho1</a></div><div class="ttdeci">double rho1[10]</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d88/_s_w_2ex4_2ex4_8cpp_source.html#l00030">ex4.cpp:30</a></div></div>
<div class="ttc" id="a_u_q_2ex12_2ex12_8cpp_html_a78d6eaf1636482a27da7047fd73c78c3"><div class="ttname"><a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a></div><div class="ttdeci">unsigned N</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp_source.html#l00027">ex12.cpp:27</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html_ab48c1191eb7ebb370a323d3ec4f713c9"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">femus::FemusInit::_adeptStack</a></div><div class="ttdeci">static adept::Stack _adeptStack</div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00059">FemusInit.hpp:59</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html_a3b3081a718e2dd06970a35f1e792f9a5"><div class="ttname"><a href="../../dc/d42/classfemus_1_1_line.html#a3b3081a718e2dd06970a35f1e792f9a5">femus::Line::GetMarkerOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; GetMarkerOffset()</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d3a/_line_8hpp_source.html#l00067">Line.hpp:67</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html_a47540a9b4bed6171c59bc76fe560fdf8"><div class="ttname"><a href="../../dc/d42/classfemus_1_1_line.html#a47540a9b4bed6171c59bc76fe560fdf8">femus::Line::GetParticles</a></div><div class="ttdeci">std::vector&lt; Marker * &gt; GetParticles()</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d3a/_line_8hpp_source.html#l00071">Line.hpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a20ac8999e714492516cd8a2be53fb54f"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d77/_linear_equation_8cpp_source.html#l00071">LinearEquation.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00118">LinearEquation.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00055">LinearEquationSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">femus::LinearImplicitSystem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00038">LinearImplicitSystem.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a58ebbec8ab1f2eb863cba438f30404e0"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">femus::LinearImplicitSystem::_LinSolver</a></div><div class="ttdeci">vector&lt; LinearEquationSolver * &gt; _LinSolver</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00077">LinearImplicitSystem.hpp:77</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a24f5ab73a260d61b0ea9ff28f03bc815"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">femus::Mesh::GetLevel</a></div><div class="ttdeci">unsigned GetLevel() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00260">Mesh.hpp:260</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a555c4982e81fc0042426c6741a792ca2"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">femus::Mesh::_finiteElement</a></div><div class="ttdeci">const elem_type * _finiteElement[N_GEOM_ELS][5]</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00321">Mesh.hpp:321</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01222">Mesh.cpp:1222</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00162">Mesh.hpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01212">Mesh.cpp:1212</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db0/_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a0440021963af01ac49a6f02df562e44b"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">femus::NumericVector::add_vector_blocked</a></div><div class="ttdeci">virtual void add_vector_blocked(const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)=0</div><div class="ttdoc">where v is a std::vector !!!fast</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html">femus::Solid</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d7c/_solid_8hpp_source.html#l00036">Solid.hpp:36</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d14/_sparse_matrix_8hpp_source.html#l00047">SparseMatrix.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a16af0d7b8849d6ea983a5e425fb90fee"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">femus::System::GetLevelToAssemble</a></div><div class="ttdeci">unsigned GetLevelToAssemble() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/def/_system_8hpp_source.html#l00116">System.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a4ebc859deb32b54c9936fa28f1485a93"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">femus::System::GetSolPdeIndex</a></div><div class="ttdeci">unsigned GetSolPdeIndex(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00087">System.cpp:87</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a3fa8f889f9ae97586b3db574acb4448e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">femus::elem_type::GetGaussPointNumber</a></div><div class="ttdeci">unsigned GetGaussPointNumber() const</div><div class="ttdef"><b>Definition</b> <a href="../../d8/df9/_elem_type_8hpp_source.html#l00208">ElemType.hpp:208</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="anamespacefemus_html_a7216a0536acdac46863fd54b0320a8e6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">femus::s</a></div><div class="ttdeci">double * s</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dc5/_f_s_i_time_dependent_assembly_supg_g_c_l_8hpp_source.html#l00036">FSITimeDependentAssemblySupgGCL.hpp:36</a></div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
<div class="ttc" id="anamespacesegment_1_1function__0_html_a1907e04e881c10f3ef9cc3dac6dde30b"><div class="ttname"><a href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">segment::function_0::value</a></div><div class="ttdeci">double value(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfe/ex02__poisson__a__all__dims__dir__neu_8cpp_source.html#l00035">ex02_poisson_a_all_dims_dir_neu.cpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0b05575316919a4fd6d7cb0f2daaa7cd" name="a0b05575316919a4fd6d7cb0f2daaa7cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0b05575316919a4fd6d7cb0f2daaa7cd">&#9670;&#160;</a></span>BuildFlag()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildFlag </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>mlSol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00814">814</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  814</span>                                          {</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>  <span class="keywordtype">unsigned</span> level = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> *sol  = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level);</div>
<div class="line"><span class="lineno">  819</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>     *msh   = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno">  820</span>  <span class="keywordtype">unsigned</span> iproc  = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span>  <span class="keywordtype">unsigned</span> eflagIndex = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;eflag&quot;</span>);</div>
<div class="line"><span class="lineno">  823</span>  <span class="keywordtype">unsigned</span> nflagIndex = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;nflag&quot;</span>);</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>  <span class="keywordtype">unsigned</span> nflagType = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(nflagIndex);</div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[eflagIndex]-&gt;zero();</div>
<div class="line"><span class="lineno">  828</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[nflagIndex]-&gt;zero();</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>(); <span class="comment">// get the domain dimension of the problem</span></div>
<div class="line"><span class="lineno">  831</span>  std::vector &lt; std::vector&lt;double&gt; &gt;  x(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  836</span>    <span class="keywordtype">unsigned</span> nDofu  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, nflagType);  <span class="comment">// number of solution element dofs</span></div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  839</span>      x[k].resize(nDofu);  <span class="comment">// Now we</span></div>
<div class="line"><span class="lineno">  840</span>    }</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  843</span>      <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, 2);    <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  844</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  845</span>        x[k][i] = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k])(xDof);      <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  846</span>      }</div>
<div class="line"><span class="lineno">  847</span>    }</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    <span class="keywordtype">bool</span> <span class="keyword">interface </span>= false;</div>
<div class="line"><span class="lineno">  850</span>    <span class="keywordtype">double</span> signi = (x[0][0] &lt; 0.) ? -1. : 1.;</div>
<div class="line"><span class="lineno">  851</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 1; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofu; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  852</span>      <span class="keywordtype">double</span> signj = (x[0][<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] &lt; 0.) ? -1. : 1.;</div>
<div class="line"><span class="lineno">  853</span>      <span class="keywordflow">if</span>(signi != signj) {</div>
<div class="line"><span class="lineno">  854</span>        <span class="keyword">interface </span>= true;</div>
<div class="line"><span class="lineno">  855</span>        <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  856</span>      }</div>
<div class="line"><span class="lineno">  857</span>    }</div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>    <span class="keywordflow">if</span>(interface) {</div>
<div class="line"><span class="lineno">  860</span>      sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[eflagIndex]-&gt;set(iel, 1.);</div>
<div class="line"><span class="lineno">  861</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  862</span>        <span class="keywordtype">unsigned</span> iDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, nflagType);</div>
<div class="line"><span class="lineno">  863</span>        sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[nflagIndex]-&gt;set(iDof, 1.);</div>
<div class="line"><span class="lineno">  864</span>      }</div>
<div class="line"><span class="lineno">  865</span>    }</div>
<div class="line"><span class="lineno">  866</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(x[0][0] &gt; 0. &amp;&amp; x[0][1] &gt; 0.) {</div>
<div class="line"><span class="lineno">  867</span>      sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[eflagIndex]-&gt;set(iel, 2.);</div>
<div class="line"><span class="lineno">  868</span>    }</div>
<div class="line"><span class="lineno">  869</span>  }</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[eflagIndex]-&gt;close();</div>
<div class="line"><span class="lineno">  872</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[nflagIndex]-&gt;close();</div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span>}</div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a89a77678df230dce7f2dd2ff171c71b4"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">femus::MultiLevelMesh::GetNumberOfLevels</a></div><div class="ttdeci">unsigned GetNumberOfLevels()</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00157">MultiLevelMesh.hpp:157</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0b3054885210f9a51ebff160e52ec2df"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">femus::MultiLevelSolution::_mlMesh</a></div><div class="ttdeci">MultiLevelMesh * _mlMesh</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00148">MultiLevelSolution.hpp:148</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7d8e300019ed90d788a45877936a66ed" name="a7d8e300019ed90d788a45877936a66ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7d8e300019ed90d788a45877936a66ed">&#9670;&#160;</a></span>GetInterfaceElementEigenvalues()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetInterfaceElementEigenvalues </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>mlSol</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00877">877</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  877</span>                                                               {</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>  <span class="keywordtype">unsigned</span> level = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> *sol  = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level);</div>
<div class="line"><span class="lineno">  882</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>     *msh   = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno">  883</span>  <span class="keywordtype">unsigned</span> iproc  = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>  <span class="keywordtype">unsigned</span> eflagIndex = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;eflag&quot;</span>);</div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span>  <span class="keywordtype">unsigned</span> CMIndex[2];</div>
<div class="line"><span class="lineno">  888</span>  CMIndex[0] = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CM1&quot;</span>);</div>
<div class="line"><span class="lineno">  889</span>  CMIndex[1] = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CM2&quot;</span>);</div>
<div class="line"><span class="lineno">  890</span> </div>
<div class="line"><span class="lineno">  891</span>  <span class="keywordtype">unsigned</span> CLIndex[2];</div>
<div class="line"><span class="lineno">  892</span>  CLIndex[0] = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CL1&quot;</span>);</div>
<div class="line"><span class="lineno">  893</span>  CLIndex[1] = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;CL2&quot;</span>);</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>  <span class="keywordtype">unsigned</span> solIndex = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;DX1&quot;</span>);</div>
<div class="line"><span class="lineno">  896</span>  <span class="keywordtype">unsigned</span> soluType = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(solIndex);</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>(); <span class="comment">// get the domain dimension of the problem</span></div>
<div class="line"><span class="lineno">  899</span>  std::vector &lt; std::vector&lt;double&gt; &gt;  x(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>  vector &lt;double&gt; <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno">  902</span>  vector &lt;double&gt; phi_x; <span class="comment">// local test function first order partial derivatives</span></div>
<div class="line"><span class="lineno">  903</span>  <span class="keywordtype">double</span> weight; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>  std::vector &lt; std::vector &lt; std::vector &lt;double &gt; &gt; &gt; aP(3);</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>  std::vector&lt;Marker*&gt; particle1 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a47540a9b4bed6171c59bc76fe560fdf8">GetParticles</a>();</div>
<div class="line"><span class="lineno">  908</span>  std::vector&lt;unsigned&gt; markerOffset1 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a3b3081a718e2dd06970a35f1e792f9a5">GetMarkerOffset</a>();</div>
<div class="line"><span class="lineno">  909</span>  <span class="keywordtype">unsigned</span> imarker1 = markerOffset1[iproc];</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>  std::vector&lt;Marker*&gt; particle2 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a47540a9b4bed6171c59bc76fe560fdf8">GetParticles</a>();</div>
<div class="line"><span class="lineno">  912</span>  std::vector&lt;unsigned&gt; markerOffset2 = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a3b3081a718e2dd06970a35f1e792f9a5">GetMarkerOffset</a>();</div>
<div class="line"><span class="lineno">  913</span>  <span class="keywordtype">unsigned</span> imarker2 = markerOffset2[iproc];</div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>  std::vector&lt;Marker*&gt; particleI = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a47540a9b4bed6171c59bc76fe560fdf8">GetParticles</a>();</div>
<div class="line"><span class="lineno">  916</span>  std::vector&lt;unsigned&gt; markerOffsetI = <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a3b3081a718e2dd06970a35f1e792f9a5">GetMarkerOffset</a>();</div>
<div class="line"><span class="lineno">  917</span>  <span class="keywordtype">unsigned</span> imarkerI = markerOffsetI[iproc];</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CMIndex[0]]-&gt;zero();</div>
<div class="line"><span class="lineno">  920</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CMIndex[1]]-&gt;zero();</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CLIndex[0]]-&gt;zero();</div>
<div class="line"><span class="lineno">  923</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CLIndex[1]]-&gt;zero();</div>
<div class="line"><span class="lineno">  924</span> </div>
<div class="line"><span class="lineno">  925</span>  std::vector &lt; double &gt; aM;</div>
<div class="line"><span class="lineno">  926</span>  std::vector &lt; double &gt; aM0;</div>
<div class="line"><span class="lineno">  927</span>  std::vector &lt; std::vector &lt; double &gt; &gt; bM(2);</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>  std::vector &lt; double &gt; aM1;</div>
<div class="line"><span class="lineno">  930</span>  std::vector &lt; double &gt; bM1;</div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>  std::vector &lt; double &gt; aL;</div>
<div class="line"><span class="lineno">  934</span>  std::vector &lt; double &gt; aL0;</div>
<div class="line"><span class="lineno">  935</span>  std::vector &lt; std::vector &lt; double &gt; &gt; bL(2);</div>
<div class="line"><span class="lineno">  936</span> </div>
<div class="line"><span class="lineno">  937</span>  std::vector &lt; double &gt; aL1;</div>
<div class="line"><span class="lineno">  938</span>  std::vector &lt; double &gt; bL1;</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span><span class="comment">//   std::vector &lt; double &gt; a2;</span></div>
<div class="line"><span class="lineno">  942</span><span class="comment">//   std::vector &lt; std::vector &lt; double &gt; &gt; b2(2);</span></div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>  Mat <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, B;</div>
<div class="line"><span class="lineno">  945</span>  Vec v;</div>
<div class="line"><span class="lineno">  946</span>  EPS <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>;</div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>    <span class="keywordtype">unsigned</span> eFlag = <span class="keyword">static_cast &lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span>(floor((*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[eflagIndex])(iel) + 0.5));</div>
<div class="line"><span class="lineno">  951</span>    <span class="keywordflow">if</span>(eFlag == 1) {</div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>      <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  954</span>      <span class="keywordtype">unsigned</span> nDofu  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, soluType);  <span class="comment">// number of solution element dofs</span></div>
<div class="line"><span class="lineno">  955</span> </div>
<div class="line"><span class="lineno">  956</span>      <span class="keywordtype">unsigned</span> sizeAll = <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> * nDofu;</div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>      aM.assign(sizeAll * sizeAll, 0.);</div>
<div class="line"><span class="lineno">  959</span>      bM[0].assign(sizeAll * sizeAll, 0.);</div>
<div class="line"><span class="lineno">  960</span>      bM[1].assign(sizeAll * sizeAll, 0.);</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>      aL.assign(sizeAll * sizeAll, 0.);</div>
<div class="line"><span class="lineno">  963</span>      bL[0].assign(sizeAll * sizeAll, 0.);</div>
<div class="line"><span class="lineno">  964</span>      bL[1].assign(sizeAll * sizeAll, 0.);</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  967</span>        x[k].resize(nDofu);  <span class="comment">// Now we</span></div>
<div class="line"><span class="lineno">  968</span>      }</div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  971</span>        <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, 2);    <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  972</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  973</span>          x[k][i] = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k])(xDof);      <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  974</span>        }</div>
<div class="line"><span class="lineno">  975</span>      }</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>      <span class="comment">//bulk1</span></div>
<div class="line"><span class="lineno">  978</span>      <span class="keywordflow">while</span>(imarker1 &lt; markerOffset1[iproc + 1] &amp;&amp; iel == particle1[imarker1]-&gt;GetMarkerElement()) {</div>
<div class="line"><span class="lineno">  979</span> </div>
<div class="line"><span class="lineno">  980</span>        <span class="comment">// the local coordinates of the particles are the Gauss points in this context</span></div>
<div class="line"><span class="lineno">  981</span>        std::vector &lt;double&gt; <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a> = particle1[imarker1]-&gt;GetMarkerLocalCoordinates();</div>
<div class="line"><span class="lineno">  982</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x, <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno">  983</span>        <span class="keywordtype">double</span> weight = particle1[imarker1]-&gt;GetMarkerMass();</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span>        <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  988</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  989</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l = 0; l &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l++) {</div>
<div class="line"><span class="lineno">  990</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofu; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  991</span>                bM[0][((nDofu * k) + i) * sizeAll + (k * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += 0.5 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * weight;</div>
<div class="line"><span class="lineno">  992</span>                bM[0][((nDofu * k) + i) * sizeAll + (l * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += 0.5 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] * weight;</div>
<div class="line"><span class="lineno">  993</span> </div>
<div class="line"><span class="lineno">  994</span>                bL[0][((nDofu * k) + i) * sizeAll + (l * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] * phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * weight;</div>
<div class="line"><span class="lineno">  995</span> </div>
<div class="line"><span class="lineno">  996</span>              }</div>
<div class="line"><span class="lineno">  997</span>            }</div>
<div class="line"><span class="lineno">  998</span>          }</div>
<div class="line"><span class="lineno">  999</span>        }</div>
<div class="line"><span class="lineno"> 1000</span>        imarker1++;</div>
<div class="line"><span class="lineno"> 1001</span>      }</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>      <span class="comment">//bulk2</span></div>
<div class="line"><span class="lineno"> 1004</span>      <span class="keywordflow">while</span>(imarker2 &lt; markerOffset2[iproc + 1] &amp;&amp; iel == particle2[imarker2]-&gt;GetMarkerElement()) {</div>
<div class="line"><span class="lineno"> 1005</span> </div>
<div class="line"><span class="lineno"> 1006</span>        <span class="comment">// the local coordinates of the particles are the Gauss points in this context</span></div>
<div class="line"><span class="lineno"> 1007</span>        std::vector &lt;double&gt; <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a> = particle2[imarker2]-&gt;GetMarkerLocalCoordinates();</div>
<div class="line"><span class="lineno"> 1008</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x, <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno"> 1009</span>        <span class="keywordtype">double</span> weight = particle2[imarker2]-&gt;GetMarkerMass();</div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>        <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno"> 1012</span> </div>
<div class="line"><span class="lineno"> 1013</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1014</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno"> 1015</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l = 0; l &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l++) {</div>
<div class="line"><span class="lineno"> 1016</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofu; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1017</span>                bM[1][((nDofu * k) + i) * sizeAll + (k * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += 0.5 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * weight;</div>
<div class="line"><span class="lineno"> 1018</span>                bM[1][((nDofu * k) + i) * sizeAll + (l * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += 0.5 * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] * weight;</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>                bL[1][((nDofu * k) + i) * sizeAll + (l * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] * phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * weight;</div>
<div class="line"><span class="lineno"> 1021</span>              }</div>
<div class="line"><span class="lineno"> 1022</span>            }</div>
<div class="line"><span class="lineno"> 1023</span>          }</div>
<div class="line"><span class="lineno"> 1024</span>        }</div>
<div class="line"><span class="lineno"> 1025</span>        imarker2++;</div>
<div class="line"><span class="lineno"> 1026</span>      }</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>      <span class="comment">// interface</span></div>
<div class="line"><span class="lineno"> 1029</span>      <span class="keywordflow">while</span>(imarkerI &lt; markerOffsetI[iproc + 1] &amp;&amp; iel == particleI[imarkerI]-&gt;GetMarkerElement()) {</div>
<div class="line"><span class="lineno"> 1030</span> </div>
<div class="line"><span class="lineno"> 1031</span>        <span class="comment">// the local coordinates of the particles are the Gauss points in this context</span></div>
<div class="line"><span class="lineno"> 1032</span>        std::vector &lt;double&gt; <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a> = particleI[imarkerI]-&gt;GetMarkerLocalCoordinates();</div>
<div class="line"><span class="lineno"> 1033</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x, <a class="code hl_variable" href="../../d5/d0f/_refinement_2ex2_2ex2_8cpp.html#a520a4554f772168e7d5b94a7947c8d87">xi</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>        std::vector &lt;std::vector &lt; double &gt; &gt; T;</div>
<div class="line"><span class="lineno"> 1036</span>        particleI[imarkerI]-&gt;GetMarkerTangent(T);</div>
<div class="line"><span class="lineno"> 1037</span> </div>
<div class="line"><span class="lineno"> 1038</span>        <span class="keywordtype">double</span> weight;</div>
<div class="line"><span class="lineno"> 1039</span>        std::vector &lt; double &gt; <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1040</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 2) {</div>
<div class="line"><span class="lineno"> 1041</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] =  T[0][1];</div>
<div class="line"><span class="lineno"> 1042</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] = -T[0][0];</div>
<div class="line"><span class="lineno"> 1043</span>          weight = sqrt(<a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] + <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1]);</div>
<div class="line"><span class="lineno"> 1044</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] /= weight;</div>
<div class="line"><span class="lineno"> 1045</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] /= weight;</div>
<div class="line"><span class="lineno"> 1046</span>        }</div>
<div class="line"><span class="lineno"> 1047</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1048</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] = T[0][1] * T[1][2] - T[0][2] * T[1][1];</div>
<div class="line"><span class="lineno"> 1049</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] = T[0][2] * T[1][0] - T[0][0] * T[1][2];</div>
<div class="line"><span class="lineno"> 1050</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2] = T[0][0] * T[1][1] - T[0][1] * T[1][0];</div>
<div class="line"><span class="lineno"> 1051</span>          weight = sqrt(<a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] + <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] + <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2]);</div>
<div class="line"><span class="lineno"> 1052</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[0] /= weight;</div>
<div class="line"><span class="lineno"> 1053</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[1] /= weight;</div>
<div class="line"><span class="lineno"> 1054</span>          <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[2] /= weight;</div>
<div class="line"><span class="lineno"> 1055</span>        }</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>        <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1060</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>            <span class="keywordtype">double</span> gradPhiiDotN = 0.;</div>
<div class="line"><span class="lineno"> 1063</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l = 0; l &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l++) {</div>
<div class="line"><span class="lineno"> 1064</span>              gradPhiiDotN += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[l];</div>
<div class="line"><span class="lineno"> 1065</span>            }</div>
<div class="line"><span class="lineno"> 1066</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofu; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1067</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l = 0; l &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l++) {</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>                aM[((nDofu * k) + i) * sizeAll + (k * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ] += 0.5 * gradPhiiDotN * 0.5 * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[l] *  phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l]  * weight;</div>
<div class="line"><span class="lineno"> 1070</span>                aM[((nDofu * k) + i) * sizeAll + (l * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ] += 0.5 * gradPhiiDotN * 0.5 * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[l] *  phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k]  * weight;</div>
<div class="line"><span class="lineno"> 1071</span> </div>
<div class="line"><span class="lineno"> 1072</span>                aL[((nDofu * k) + i) * sizeAll + (l * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + k] * phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l] * weight;</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>              }</div>
<div class="line"><span class="lineno"> 1075</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l1 = 0; l1 &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l1++) {</div>
<div class="line"><span class="lineno"> 1076</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> l2 = 0; l2 &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l2++) {</div>
<div class="line"><span class="lineno"> 1077</span>                  aM[((nDofu * k) + i) * sizeAll + (l1 * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += 0.5 * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[k] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l1] * 0.5 * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[l2] *  phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l2]  * weight;</div>
<div class="line"><span class="lineno"> 1078</span>                  aM[((nDofu * k) + i) * sizeAll + (l2 * nDofu + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)] += 0.5 * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[k] * phi_x[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l1] * 0.5 * <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>[l2] *  phi_x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + l1]  * weight;</div>
<div class="line"><span class="lineno"> 1079</span>                }</div>
<div class="line"><span class="lineno"> 1080</span>              }</div>
<div class="line"><span class="lineno"> 1081</span> </div>
<div class="line"><span class="lineno"> 1082</span>            }</div>
<div class="line"><span class="lineno"> 1083</span>          } <span class="comment">// end phi_i loop</span></div>
<div class="line"><span class="lineno"> 1084</span>        }</div>
<div class="line"><span class="lineno"> 1085</span>        imarkerI++;</div>
<div class="line"><span class="lineno"> 1086</span>      }</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>      <span class="keywordtype">unsigned</span> sizeAll0 = sizeAll;</div>
<div class="line"><span class="lineno"> 1089</span>      aM0 = aM;</div>
<div class="line"><span class="lineno"> 1090</span>      aL0 = aL;</div>
<div class="line"><span class="lineno"> 1091</span> </div>
<div class="line"><span class="lineno"> 1092</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> &lt; 2; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>++) {</div>
<div class="line"><span class="lineno"> 1093</span>        </div>
<div class="line"><span class="lineno"> 1094</span>        sizeAll = sizeAll0;</div>
<div class="line"><span class="lineno"> 1095</span> </div>
<div class="line"><span class="lineno"> 1096</span>        <span class="comment">//BEGIN DEFLATION</span></div>
<div class="line"><span class="lineno"> 1097</span> </div>
<div class="line"><span class="lineno"> 1098</span>        <span class="keywordtype">unsigned</span> sizeAll1 = <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> * (nDofu - 1);</div>
<div class="line"><span class="lineno"> 1099</span>        aM1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1100</span>        bM1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span>        MatCreateSeqDense(PETSC_COMM_SELF, sizeAll1, sizeAll1, NULL, &amp;B);</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1105</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nDofu - 1; i++) {</div>
<div class="line"><span class="lineno"> 1106</span> </div>
<div class="line"><span class="lineno"> 1107</span>            <span class="keywordtype">int</span> ip = i + 1;</div>
<div class="line"><span class="lineno"> 1108</span>            <span class="keywordtype">int</span> i1 = (nDofu - 1) * k + i;</div>
<div class="line"><span class="lineno"> 1109</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l = 0; l &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l++) {</div>
<div class="line"><span class="lineno"> 1110</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofu - 1; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1111</span>                <span class="keywordtype">int</span> jp = <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> + 1;</div>
<div class="line"><span class="lineno"> 1112</span>                <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a> = (nDofu - 1) * l + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>;</div>
<div class="line"><span class="lineno"> 1113</span>                <span class="keywordtype">double</span> <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1114</span>                <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = aM0[((nDofu * k) + ip) * sizeAll0 + (nDofu * l + jp)] - aM0[(nDofu * k) * sizeAll0 + (nDofu * l + jp)];</div>
<div class="line"><span class="lineno"> 1115</span>                aM1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1116</span> </div>
<div class="line"><span class="lineno"> 1117</span>                <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = bM[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][((nDofu * k) + ip) * sizeAll0 + (nDofu * l + jp)] - bM[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][(nDofu * k) * sizeAll0 + (nDofu * l + jp)];</div>
<div class="line"><span class="lineno"> 1118</span>                bM1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1119</span>                MatSetValues(B, 1, &amp;i1, 1, &amp;<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>, &amp;value, INSERT_VALUES);</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>              }</div>
<div class="line"><span class="lineno"> 1122</span>            }</div>
<div class="line"><span class="lineno"> 1123</span>          }</div>
<div class="line"><span class="lineno"> 1124</span>        }</div>
<div class="line"><span class="lineno"> 1125</span> </div>
<div class="line"><span class="lineno"> 1126</span>        MatAssemblyBegin(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1127</span>        MatAssemblyEnd(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>        sizeAll = sizeAll1;</div>
<div class="line"><span class="lineno"> 1130</span>        aM.swap(aM1);</div>
<div class="line"><span class="lineno"> 1131</span>        bM[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>].swap(bM1);</div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>        <span class="keywordtype">double</span> real = 0.;</div>
<div class="line"><span class="lineno"> 1134</span>        <span class="keywordflow">while</span>(fabs(real) &lt; 1.0e-12) {</div>
<div class="line"><span class="lineno"> 1135</span> </div>
<div class="line"><span class="lineno"> 1136</span>          MatCreateVecs(B, &amp;v, NULL);</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>          EPSCreate(PETSC_COMM_SELF, &amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1139</span>          EPSSetOperators(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, B, NULL);</div>
<div class="line"><span class="lineno"> 1140</span>          EPSSetFromOptions(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1141</span>          EPSSetWhichEigenpairs(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, EPS_SMALLEST_MAGNITUDE);</div>
<div class="line"><span class="lineno"> 1142</span>          EPSSolve(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>          <span class="keywordtype">double</span> imaginary;</div>
<div class="line"><span class="lineno"> 1145</span>          EPSGetEigenpair(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, 0, &amp;real, &amp;imaginary, v, NULL);</div>
<div class="line"><span class="lineno"> 1146</span>          EPSDestroy(&amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>          <span class="keywordflow">if</span>(fabs(real) &lt; 1.0e-12) {</div>
<div class="line"><span class="lineno"> 1149</span>            PetscScalar *pv;</div>
<div class="line"><span class="lineno"> 1150</span>            VecGetArray(v, &amp;pv);</div>
<div class="line"><span class="lineno"> 1151</span>            <span class="keywordtype">unsigned</span> ii = 0;</div>
<div class="line"><span class="lineno"> 1152</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 1; i &lt; sizeAll; i++){</div>
<div class="line"><span class="lineno"> 1153</span>              <span class="keywordflow">if</span>(fabs(pv[i]) &gt; fabs(pv[ii])) ii = i;</div>
<div class="line"><span class="lineno"> 1154</span>            }</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>            <span class="keywordtype">unsigned</span> sizeAll1 = sizeAll - 1;</div>
<div class="line"><span class="lineno"> 1157</span> </div>
<div class="line"><span class="lineno"> 1158</span>            aM1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1159</span>            bM1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>            MatDestroy(&amp;B);</div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>            MatCreateSeqDense(PETSC_COMM_SELF, sizeAll1, sizeAll1, NULL, &amp;B);</div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; sizeAll; i++) {</div>
<div class="line"><span class="lineno"> 1166</span>              <span class="keywordflow">if</span>(i != ii) {</div>
<div class="line"><span class="lineno"> 1167</span>                <span class="keywordtype">int</span> i1 = (i &lt; ii) ? i : i - 1;</div>
<div class="line"><span class="lineno"> 1168</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; sizeAll; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1169</span>                  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> != ii) {</div>
<div class="line"><span class="lineno"> 1170</span>                    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a> = (<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; ii) ? <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> : <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> - 1;</div>
<div class="line"><span class="lineno"> 1171</span>                    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1172</span>                    <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = aM[i * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - 1. / pv[ii] * pv[i] * aM[ii * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1173</span>                    aM1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span>                    <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = bM[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][i * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - 1. / pv[ii] * pv[i] * bM[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][ii * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1176</span>                    bM1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1177</span>                    MatSetValues(B, 1, &amp;i1, 1, &amp;<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>, &amp;value, INSERT_VALUES);</div>
<div class="line"><span class="lineno"> 1178</span>                  }</div>
<div class="line"><span class="lineno"> 1179</span>                }</div>
<div class="line"><span class="lineno"> 1180</span>              }</div>
<div class="line"><span class="lineno"> 1181</span>            }</div>
<div class="line"><span class="lineno"> 1182</span>            MatAssemblyBegin(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1183</span>            MatAssemblyEnd(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1184</span>            VecRestoreArray(v, &amp;pv);</div>
<div class="line"><span class="lineno"> 1185</span> </div>
<div class="line"><span class="lineno"> 1186</span>            sizeAll = sizeAll1;</div>
<div class="line"><span class="lineno"> 1187</span>            aM.swap(aM1);</div>
<div class="line"><span class="lineno"> 1188</span>            bM[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>].swap(bM1);</div>
<div class="line"><span class="lineno"> 1189</span>          }</div>
<div class="line"><span class="lineno"> 1190</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1191</span>            MatCreateSeqDense(PETSC_COMM_SELF, sizeAll, sizeAll, NULL, &amp;<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>);</div>
<div class="line"><span class="lineno"> 1192</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; sizeAll; i++) {</div>
<div class="line"><span class="lineno"> 1193</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; sizeAll; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1194</span>                MatSetValues(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, 1, &amp;i, 1, &amp;<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, &amp;aM[i * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], INSERT_VALUES);</div>
<div class="line"><span class="lineno"> 1195</span>              }</div>
<div class="line"><span class="lineno"> 1196</span>            }</div>
<div class="line"><span class="lineno"> 1197</span>            MatAssemblyBegin(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1198</span>            MatAssemblyEnd(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1199</span>          }</div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span>          VecDestroy(&amp;v);</div>
<div class="line"><span class="lineno"> 1202</span>        }</div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>        <span class="comment">//END DEFLATION</span></div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>        EPSCreate(PETSC_COMM_SELF, &amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1207</span>        EPSSetOperators(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, B);</div>
<div class="line"><span class="lineno"> 1208</span>        EPSSetFromOptions(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1209</span>        EPSSetWhichEigenpairs(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, EPS_LARGEST_MAGNITUDE);</div>
<div class="line"><span class="lineno"> 1210</span>        EPSSolve(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1211</span> </div>
<div class="line"><span class="lineno"> 1212</span>        EPSGetEigenpair(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, 0, &amp;real, NULL, NULL, NULL);</div>
<div class="line"><span class="lineno"> 1213</span>        std::cout &lt;&lt; real &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>        sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CMIndex[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>]]-&gt;set(iel, real);</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>        EPSDestroy(&amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1218</span>        MatDestroy(&amp;<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>);</div>
<div class="line"><span class="lineno"> 1219</span>        MatDestroy(&amp;B);</div>
<div class="line"><span class="lineno"> 1220</span> </div>
<div class="line"><span class="lineno"> 1221</span>      }</div>
<div class="line"><span class="lineno"> 1222</span> </div>
<div class="line"><span class="lineno"> 1223</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> &lt; 2; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>++) {</div>
<div class="line"><span class="lineno"> 1224</span>        </div>
<div class="line"><span class="lineno"> 1225</span>        sizeAll = sizeAll0;</div>
<div class="line"><span class="lineno"> 1226</span>   </div>
<div class="line"><span class="lineno"> 1227</span>        <span class="comment">//BEGIN DEFLATION</span></div>
<div class="line"><span class="lineno"> 1228</span> </div>
<div class="line"><span class="lineno"> 1229</span>        <span class="keywordtype">unsigned</span> sizeAll1 = <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> * (nDofu - 1);</div>
<div class="line"><span class="lineno"> 1230</span>        aL1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1231</span>        bL1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span>        MatCreateSeqDense(PETSC_COMM_SELF, sizeAll1, sizeAll1, NULL, &amp;B);</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1236</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; nDofu - 1; i++) {</div>
<div class="line"><span class="lineno"> 1237</span> </div>
<div class="line"><span class="lineno"> 1238</span>            <span class="keywordtype">int</span> ip = i + 1;</div>
<div class="line"><span class="lineno"> 1239</span>            <span class="keywordtype">int</span> i1 = (nDofu - 1) * k + i;</div>
<div class="line"><span class="lineno"> 1240</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> l = 0; l &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; l++) {</div>
<div class="line"><span class="lineno"> 1241</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofu - 1; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1242</span>                <span class="keywordtype">int</span> jp = <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> + 1;</div>
<div class="line"><span class="lineno"> 1243</span>                <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a> = (nDofu - 1) * l + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>;</div>
<div class="line"><span class="lineno"> 1244</span>                <span class="keywordtype">double</span> <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1245</span>                <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = aL0[((nDofu * k) + ip) * sizeAll0 + (nDofu * l + jp)] - aL0[(nDofu * k) * sizeAll0 + (nDofu * l + jp)];</div>
<div class="line"><span class="lineno"> 1246</span>                aL1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>                <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = bL[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][((nDofu * k) + ip) * sizeAll0 + (nDofu * l + jp)] - bL[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][(nDofu * k) * sizeAll0 + (nDofu * l + jp)];</div>
<div class="line"><span class="lineno"> 1249</span>                bL1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1250</span>                MatSetValues(B, 1, &amp;i1, 1, &amp;<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>, &amp;value, INSERT_VALUES);</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>              }</div>
<div class="line"><span class="lineno"> 1253</span>            }</div>
<div class="line"><span class="lineno"> 1254</span>          }</div>
<div class="line"><span class="lineno"> 1255</span>        }</div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span>        MatAssemblyBegin(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1258</span>        MatAssemblyEnd(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span>        sizeAll = sizeAll1;</div>
<div class="line"><span class="lineno"> 1261</span>        aL.swap(aL1);</div>
<div class="line"><span class="lineno"> 1262</span>        bL[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>].swap(bL1);</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>        <span class="keywordtype">double</span> real = 0.;</div>
<div class="line"><span class="lineno"> 1265</span>        <span class="keywordflow">while</span>(fabs(real) &lt; 1.0e-10) {</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span>          MatCreateVecs(B, &amp;v, NULL);</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>          EPSCreate(PETSC_COMM_SELF, &amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1270</span>          EPSSetOperators(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, B, NULL);</div>
<div class="line"><span class="lineno"> 1271</span>          EPSSetFromOptions(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1272</span>          EPSSetWhichEigenpairs(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, EPS_SMALLEST_MAGNITUDE);</div>
<div class="line"><span class="lineno"> 1273</span>          EPSSolve(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1274</span> </div>
<div class="line"><span class="lineno"> 1275</span>          <span class="keywordtype">double</span> imaginary;</div>
<div class="line"><span class="lineno"> 1276</span>          EPSGetEigenpair(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, 0, &amp;real, &amp;imaginary, v, NULL);</div>
<div class="line"><span class="lineno"> 1277</span>          EPSDestroy(&amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1278</span> </div>
<div class="line"><span class="lineno"> 1279</span>          <span class="keywordflow">if</span>(fabs(real) &lt; 1.0e-10) {</div>
<div class="line"><span class="lineno"> 1280</span>            PetscScalar *pv;</div>
<div class="line"><span class="lineno"> 1281</span>            VecGetArray(v, &amp;pv);</div>
<div class="line"><span class="lineno"> 1282</span>            <span class="keywordtype">unsigned</span> ii = 0;</div>
<div class="line"><span class="lineno"> 1283</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 1; i &lt; sizeAll; i++){</div>
<div class="line"><span class="lineno"> 1284</span>              <span class="keywordflow">if</span>(fabs(pv[i]) &gt; fabs(pv[ii])) ii = i;</div>
<div class="line"><span class="lineno"> 1285</span>            }</div>
<div class="line"><span class="lineno"> 1286</span> </div>
<div class="line"><span class="lineno"> 1287</span>            <span class="keywordtype">unsigned</span> sizeAll1 = sizeAll - 1;</div>
<div class="line"><span class="lineno"> 1288</span> </div>
<div class="line"><span class="lineno"> 1289</span>            aL1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1290</span>            bL1.resize(sizeAll1 * sizeAll1);</div>
<div class="line"><span class="lineno"> 1291</span> </div>
<div class="line"><span class="lineno"> 1292</span>            MatDestroy(&amp;B);</div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>            MatCreateSeqDense(PETSC_COMM_SELF, sizeAll1, sizeAll1, NULL, &amp;B);</div>
<div class="line"><span class="lineno"> 1295</span> </div>
<div class="line"><span class="lineno"> 1296</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; sizeAll; i++) {</div>
<div class="line"><span class="lineno"> 1297</span>              <span class="keywordflow">if</span>(i != ii) {</div>
<div class="line"><span class="lineno"> 1298</span>                <span class="keywordtype">int</span> i1 = (i &lt; ii) ? i : i - 1;</div>
<div class="line"><span class="lineno"> 1299</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; sizeAll; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1300</span>                  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> != ii) {</div>
<div class="line"><span class="lineno"> 1301</span>                    <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a> = (<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; ii) ? <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> : <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> - 1;</div>
<div class="line"><span class="lineno"> 1302</span>                    <span class="keywordtype">double</span> <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1303</span>                    <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = aL[i * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - 1. / pv[ii] * pv[i] * aL[ii * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1304</span>                    aL1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span>                    <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = bL[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][i * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - 1. / pv[ii] * pv[i] * bL[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>][ii * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1307</span>                    bL1[i1 * sizeAll1 + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>] = <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a>;</div>
<div class="line"><span class="lineno"> 1308</span>                    MatSetValues(B, 1, &amp;i1, 1, &amp;<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a>, &amp;value, INSERT_VALUES);</div>
<div class="line"><span class="lineno"> 1309</span>                  }</div>
<div class="line"><span class="lineno"> 1310</span>                }</div>
<div class="line"><span class="lineno"> 1311</span>              }</div>
<div class="line"><span class="lineno"> 1312</span>            }</div>
<div class="line"><span class="lineno"> 1313</span>            MatAssemblyBegin(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1314</span>            MatAssemblyEnd(B, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1315</span>            VecRestoreArray(v, &amp;pv);</div>
<div class="line"><span class="lineno"> 1316</span> </div>
<div class="line"><span class="lineno"> 1317</span>            sizeAll = sizeAll1;</div>
<div class="line"><span class="lineno"> 1318</span>            aL.swap(aL1);</div>
<div class="line"><span class="lineno"> 1319</span>            bL[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>].swap(bL1);</div>
<div class="line"><span class="lineno"> 1320</span>          }</div>
<div class="line"><span class="lineno"> 1321</span>          <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1322</span>            MatCreateSeqDense(PETSC_COMM_SELF, sizeAll, sizeAll, NULL, &amp;<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>);</div>
<div class="line"><span class="lineno"> 1323</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; sizeAll; i++) {</div>
<div class="line"><span class="lineno"> 1324</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; sizeAll; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1325</span>                MatSetValues(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, 1, &amp;i, 1, &amp;<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, &amp;aL[i * sizeAll + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], INSERT_VALUES);</div>
<div class="line"><span class="lineno"> 1326</span>              }</div>
<div class="line"><span class="lineno"> 1327</span>            }</div>
<div class="line"><span class="lineno"> 1328</span>            MatAssemblyBegin(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1329</span>            MatAssemblyEnd(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, MAT_FINAL_ASSEMBLY);</div>
<div class="line"><span class="lineno"> 1330</span>          }</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>          VecDestroy(&amp;v);</div>
<div class="line"><span class="lineno"> 1333</span>        }</div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>        <span class="comment">//END DEFLATION</span></div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>        EPSCreate(PETSC_COMM_SELF, &amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1338</span>        EPSSetOperators(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>, B);</div>
<div class="line"><span class="lineno"> 1339</span>        EPSSetFromOptions(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1340</span>        EPSSetWhichEigenpairs(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, EPS_LARGEST_MAGNITUDE);</div>
<div class="line"><span class="lineno"> 1341</span>        EPSSolve(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1342</span> </div>
<div class="line"><span class="lineno"> 1343</span>        EPSGetEigenpair(<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>, 0, &amp;real, NULL, NULL, NULL);</div>
<div class="line"><span class="lineno"> 1344</span>        std::cout &lt;&lt; real &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span>        sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CLIndex[<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>]]-&gt;set(iel, real);</div>
<div class="line"><span class="lineno"> 1347</span> </div>
<div class="line"><span class="lineno"> 1348</span>        EPSDestroy(&amp;<a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a>);</div>
<div class="line"><span class="lineno"> 1349</span>        MatDestroy(&amp;<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>);</div>
<div class="line"><span class="lineno"> 1350</span>        MatDestroy(&amp;B);</div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>      }</div>
<div class="line"><span class="lineno"> 1353</span>    }</div>
<div class="line"><span class="lineno"> 1354</span>  }</div>
<div class="line"><span class="lineno"> 1355</span> </div>
<div class="line"><span class="lineno"> 1356</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CMIndex[0]]-&gt;close();</div>
<div class="line"><span class="lineno"> 1357</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CMIndex[1]]-&gt;close();</div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CLIndex[0]]-&gt;close();</div>
<div class="line"><span class="lineno"> 1360</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[CLIndex[1]]-&gt;close();</div>
<div class="line"><span class="lineno"> 1361</span>}</div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_abff9cb505c7723e84955a4cdb4b67e0e"><div class="ttname"><a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#abff9cb505c7723e84955a4cdb4b67e0e">j1</a></div><div class="ttdeci">% % for j1</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00105">MG_precond.m:105</a></div></div>
<div class="ttc" id="a_willmore_2_willmore_surface_2ex1_2ex1_8cpp_html_a3d8c24629d725b9ef8c238cf27c9b158"><div class="ttname"><a href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a3d8c24629d725b9ef8c238cf27c9b158">eps</a></div><div class="ttdeci">const double eps</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp_source.html#l00040">ex1.cpp:40</a></div></div>
<div class="ttc" id="ainternal__waves__zlevel_8cpp_html_a2941385b1be5280d3b1f546356f7ec99"><div class="ttname"><a href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a></div><div class="ttdeci">double A</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d97/internal__waves__zlevel_8cpp_source.html#l00043">internal_waves_zlevel.cpp:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a29781a20c5dd4153c3c1cecf0ff328" name="a7a29781a20c5dd4153c3c1cecf0ff328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a29781a20c5dd4153c3c1cecf0ff328">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00051">51</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>                                {</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> != 2 &amp;&amp; <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> != 3) {</div>
<div class="line"><span class="lineno">   54</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Wrong Dimension!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   55</span>    <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   56</span>  }</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">// init Petsc-MPI communicator</span></div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>  SlepcInitialize(&amp;argc, &amp;args, PETSC_NULL, PETSC_NULL);</div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_class" href="../../da/d5e/classfemus_1_1_femus_init.html">FemusInit</a> mpinit(argc, args, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  <span class="comment">// define multilevel mesh</span></div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> mlMsh;</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordtype">double</span> scalingFactor = 1.;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> = 1;</div>
<div class="line"><span class="lineno">   68</span>  <span class="keywordtype">unsigned</span> numberOfSelectiveLevels = 0;</div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordtype">unsigned</span> nx = 11; <span class="comment">// this should always be a odd number</span></div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordtype">unsigned</span> ny = 11; <span class="comment">// this should always be a odd number</span></div>
<div class="line"><span class="lineno">   72</span>  <span class="keywordtype">unsigned</span> nz = 1;</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordtype">double</span> length = 1.;</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordtype">double</span> lengthx = 0.1;</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 2) {</div>
<div class="line"><span class="lineno">   78</span>    mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(nx, ny, 0, -lengthx / 2, lengthx / 2, -length / 2, length / 2, 0., 0., <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a>, <span class="stringliteral">&quot;seventh&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span>  }</div>
<div class="line"><span class="lineno">   80</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) {</div>
<div class="line"><span class="lineno">   81</span>    nz = ny;</div>
<div class="line"><span class="lineno">   82</span>    mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(nx, ny, nz, -lengthx / 2, lengthx / 2, -length / 2, length / 2, -length / 2, length / 2, <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27">HEX27</a>, <span class="stringliteral">&quot;seventh&quot;</span>);</div>
<div class="line"><span class="lineno">   83</span>  }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <span class="keywordtype">double</span> Lref = 1.;</div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordtype">double</span> Uref = 1.;</div>
<div class="line"><span class="lineno">   87</span>  <span class="keywordtype">double</span> rhos1 = 7850;</div>
<div class="line"><span class="lineno">   88</span>  <span class="keywordtype">double</span> rhos2 = 7850;</div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordtype">double</span> E1 = 2.e06;</div>
<div class="line"><span class="lineno">   90</span>  <span class="keywordtype">double</span> E2 = 2.e07;</div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordtype">double</span> nu1 = 0.4;</div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordtype">double</span> nu2 = 0.4;</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>  <a class="code hl_class" href="../../d7/d3c/classfemus_1_1_parameter.html">Parameter</a> par(Lref, Uref);</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>  <span class="comment">// Generate Solid Object</span></div>
<div class="line"><span class="lineno">   97</span>  <a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a> solid1(par, E1, nu1, rhos1, <span class="stringliteral">&quot;Neo-Hookean&quot;</span>);</div>
<div class="line"><span class="lineno">   98</span>  <a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a> solid2(par, E2, nu2, rhos2, <span class="stringliteral">&quot;Neo-Hookean&quot;</span>);</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>  <span class="comment">//mlMsh.RefineMesh(numberOfUniformLevels + numberOfSelectiveLevels, numberOfUniformLevels , NULL);</span></div>
<div class="line"><span class="lineno">  102</span>  mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>  <span class="comment">// define the multilevel solution and attach the mlMsh object to it</span></div>
<div class="line"><span class="lineno">  105</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> mlSol(&amp;mlMsh);</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  <a class="code hl_enumeration" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3ba">FEOrder</a> femOrder = <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>;</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  mlSol.AddSolution(<span class="stringliteral">&quot;DX1&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, femOrder);</div>
<div class="line"><span class="lineno">  110</span>  mlSol.AddSolution(<span class="stringliteral">&quot;DY1&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, femOrder);</div>
<div class="line"><span class="lineno">  111</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) mlSol.AddSolution(<span class="stringliteral">&quot;DZ1&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, femOrder);</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  mlSol.AddSolution(<span class="stringliteral">&quot;DX2&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, femOrder);</div>
<div class="line"><span class="lineno">  114</span>  mlSol.AddSolution(<span class="stringliteral">&quot;DY2&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, femOrder);</div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) mlSol.AddSolution(<span class="stringliteral">&quot;DZ2&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, femOrder);</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>  mlSol.AddSolution(<span class="stringliteral">&quot;eflag&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 0, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  118</span>  mlSol.AddSolution(<span class="stringliteral">&quot;nflag&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, femOrder, 0, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>  mlSol.AddSolution(<span class="stringliteral">&quot;CM1&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 0, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  121</span>  mlSol.AddSolution(<span class="stringliteral">&quot;CM2&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 0, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  mlSol.AddSolution(<span class="stringliteral">&quot;CL1&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 0, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  124</span>  mlSol.AddSolution(<span class="stringliteral">&quot;CL2&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 0, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>  mlSol.Initialize(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  mlSol.AttachSetBoundaryConditionFunction(<a class="code hl_function" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a>);</div>
<div class="line"><span class="lineno">  130</span>  mlSol.GenerateBdc(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  131</span> </div>
<div class="line"><span class="lineno">  132</span>  <a class="code hl_function" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a0b05575316919a4fd6d7cb0f2daaa7cd">BuildFlag</a>(mlSol);</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob(&amp;mlSol);</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  ml_prob.parameters.set&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid1&quot;</span>) = solid1;</div>
<div class="line"><span class="lineno">  137</span>  ml_prob.parameters.set&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt; (<span class="stringliteral">&quot;Solid2&quot;</span>) = solid2;</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <span class="comment">// ******* Add FEM system to the MultiLevel problem *******</span></div>
<div class="line"><span class="lineno">  141</span>  <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&amp; system = ml_prob.add_system &lt; <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a> &gt; (<span class="stringliteral">&quot;Nitsche&quot;</span>);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  <span class="comment">// add solution &quot;u&quot; to system</span></div>
<div class="line"><span class="lineno">  144</span>  system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;DX1&quot;</span>);</div>
<div class="line"><span class="lineno">  145</span>  system.AddSolutionToSystemPDE(<span class="stringliteral">&quot;DY1&quot;</span>);</div>
<div class="line"><span class="lineno">  146</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) system.AddSolutionToSystemPDE(<span class="stringliteral">&quot;DZ1&quot;</span>);</div>
<div class="line"><span class="lineno">  147</span>  system.AddSolutionToSystemPDE(<span class="stringliteral">&quot;DX2&quot;</span>);</div>
<div class="line"><span class="lineno">  148</span>  system.AddSolutionToSystemPDE(<span class="stringliteral">&quot;DY2&quot;</span>);</div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) system.AddSolutionToSystemPDE(<span class="stringliteral">&quot;DZ2&quot;</span>);</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span> </div>
<div class="line"><span class="lineno">  152</span>  <span class="comment">// attach the assembling function to system</span></div>
<div class="line"><span class="lineno">  153</span>  system.SetAssembleFunction(<a class="code hl_function" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2e46d3d6a029c1cf6ccbcf0f4b84b2db">AssembleNitscheProblem_AD</a>);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>  <span class="comment">// time loop parameter</span></div>
<div class="line"><span class="lineno">  156</span>  system.SetMaxNumberOfLinearIterations(1);</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  system.init();</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>  <span class="comment">//init marker</span></div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>  <span class="keywordtype">unsigned</span> Ne = 4;</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>  <span class="keywordtype">double</span> Lx = lengthx / nx;</div>
<div class="line"><span class="lineno">  165</span>  <span class="keywordtype">double</span> Lx1 = 0.025 * Lx; <span class="comment">//beam dimensions</span></div>
<div class="line"><span class="lineno">  166</span>  <span class="keywordtype">double</span> Lx2 = Lx - Lx1; <span class="comment">//beam dimensions</span></div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="keywordtype">double</span> Ly = length;</div>
<div class="line"><span class="lineno">  169</span>  <span class="keywordtype">double</span> Lz = (<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) ? length : 1.;</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordtype">unsigned</span> rowy = ny * Ne;</div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordtype">unsigned</span> rowz = (<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) ?  nz * Ne : 1.;</div>
<div class="line"><span class="lineno">  173</span>  <span class="keywordtype">double</span> dy = length / rowy; <span class="comment">// size in y of each row</span></div>
<div class="line"><span class="lineno">  174</span>  <span class="keywordtype">double</span> dz = Lz / rowz; <span class="comment">// size in y of each row</span></div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>  <span class="keywordtype">unsigned</span> columns = Ne;</div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordtype">double</span> dx1 = Lx1 / Ne; <span class="comment">// size in x of each column</span></div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordtype">double</span> dx2 = Lx2 / Ne; <span class="comment">// size in x of each column</span></div>
<div class="line"><span class="lineno">  179</span>  <span class="keywordtype">unsigned</span> size = rowy * rowz * columns;</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>  std::vector &lt; std::vector &lt; double &gt; &gt; x; <span class="comment">// marker</span></div>
<div class="line"><span class="lineno">  182</span>  std::vector &lt; MarkerType &gt; markerType;</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  x.resize(size);</div>
<div class="line"><span class="lineno">  185</span>  markerType.resize(size);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; size; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  188</span>    x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].assign(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a>, 0.);</div>
<div class="line"><span class="lineno">  189</span>    markerType[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = <a class="code hl_enumvalue" href="../../d7/d4e/_marker_type_enum_8hpp.html#ade22213fff69cfb37d8238e8fd3073dfa9d326c2efb1f1ef1840d474c0f9b8a48">VOLUME</a>;</div>
<div class="line"><span class="lineno">  190</span>  }</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span> </div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>  <span class="comment">//   double xc = 1.e-04 + 0.5 * H ; //should be this one to do COMSOL benchmark</span></div>
<div class="line"><span class="lineno">  195</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#ae553c80321ef2d7c454cc4f62b42d0d1">x0</a> = -0.5 * Lx; <span class="comment">//we are using this not to have markers on edges of elements from the beginning</span></div>
<div class="line"><span class="lineno">  196</span>  <span class="keywordtype">double</span> y0 = -Ly / 2.;</div>
<div class="line"><span class="lineno">  197</span>  <span class="keywordtype">double</span> z0 = -Lz / 2.;</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>  <span class="comment">//BEGIN initialization</span></div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; columns; i++) {</div>
<div class="line"><span class="lineno">  201</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; rowy; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  202</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; rowz; k++) {</div>
<div class="line"><span class="lineno">  203</span>        x[ i * rowy * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * rowz + k][0] = <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#ae553c80321ef2d7c454cc4f62b42d0d1">x0</a> + 0.5 * dx1 + i * dx1;</div>
<div class="line"><span class="lineno">  204</span>        x[ i * rowy * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * rowz + k][1] = y0 + 0.5 * dy + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * dy;</div>
<div class="line"><span class="lineno">  205</span>        <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) x[i * rowy * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * rowz + k][2] = z0 + 0.5 * dz + k * dz;</div>
<div class="line"><span class="lineno">  206</span>      }</div>
<div class="line"><span class="lineno">  207</span>    }</div>
<div class="line"><span class="lineno">  208</span>  }</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>  <span class="keywordtype">unsigned</span> solType = 2;</div>
<div class="line"><span class="lineno">  213</span>  std::vector &lt; double &gt; volume(x.size(), Lx1 * Ly * Lz / x.size());  <span class="comment">// uniform marker volume</span></div>
<div class="line"><span class="lineno">  214</span>  <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a> = <span class="keyword">new</span> <a class="code hl_class" href="../../dc/d42/classfemus_1_1_line.html">Line</a>(x, volume, markerType, mlSol.GetLevel(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1), solType);</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>  std::vector &lt; std::vector &lt; std::vector &lt; double &gt; &gt; &gt;  line1Points(1);</div>
<div class="line"><span class="lineno">  217</span>  <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a1586fa1c4660de16b0d05493354e992a">line1</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a0623915f9f27153ef5e477b3a566256d">GetLine</a>(line1Points[0]);</div>
<div class="line"><span class="lineno">  218</span>  <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ab218007e286871c1b8c469f8e78a96b4">PrintLine</a>(<a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;bulk1&quot;</span>, line1Points, 0);</div>
<div class="line"><span class="lineno">  219</span>  <span class="comment">//PrintLine(&quot;./output1&quot;, &quot;bulk1&quot;, line1Points, 0);</span></div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>  <span class="comment">//BEGIN initialization bulk2 points</span></div>
<div class="line"><span class="lineno">  223</span>  <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#ae553c80321ef2d7c454cc4f62b42d0d1">x0</a> = -0.5 * Lx + Lx1; <span class="comment">//we are using this not to have markers on edges of elements from the beginning</span></div>
<div class="line"><span class="lineno">  224</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; columns; i++) {</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; rowy; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  226</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; rowz; k++) {</div>
<div class="line"><span class="lineno">  227</span>        x[ i * rowy * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * rowz + k][0] = <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#ae553c80321ef2d7c454cc4f62b42d0d1">x0</a> + 0.5 * dx2 + i * dx2;</div>
<div class="line"><span class="lineno">  228</span>      }</div>
<div class="line"><span class="lineno">  229</span>    }</div>
<div class="line"><span class="lineno">  230</span>  }</div>
<div class="line"><span class="lineno">  231</span>  volume.assign(x.size(), Lx2 * Ly * Lz / x.size());  <span class="comment">// uniform marker volume</span></div>
<div class="line"><span class="lineno">  232</span>  <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a> = <span class="keyword">new</span> <a class="code hl_class" href="../../dc/d42/classfemus_1_1_line.html">Line</a>(x, volume, markerType, mlSol.GetLevel(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1), solType);</div>
<div class="line"><span class="lineno">  233</span>  <span class="comment">//END initialization bulk2 points</span></div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>  std::vector &lt; std::vector &lt; std::vector &lt; double &gt; &gt; &gt; line2Points(1);</div>
<div class="line"><span class="lineno">  236</span>  <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#aed2973510af2dd9ff93ef05465ed515f">line2</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a0623915f9f27153ef5e477b3a566256d">GetLine</a>(line2Points[0]);</div>
<div class="line"><span class="lineno">  237</span>  <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ab218007e286871c1b8c469f8e78a96b4">PrintLine</a>(<a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;bulk2&quot;</span>, line2Points, 0);</div>
<div class="line"><span class="lineno">  238</span>  <span class="comment">//PrintLine(&quot;./output1&quot;, &quot;bulk2&quot;, line2Points, 0);</span></div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>  <span class="comment">//interface marker initialization</span></div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>  size = rowy * rowz;</div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>  x.resize(size);</div>
<div class="line"><span class="lineno">  245</span>  markerType.resize(size);</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; size; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  248</span>    x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].assign(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a>, 0.);</div>
<div class="line"><span class="lineno">  249</span>    markerType[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = <a class="code hl_enumvalue" href="../../d7/d4e/_marker_type_enum_8hpp.html#ade22213fff69cfb37d8238e8fd3073dfa56690e5e62dbaca19fd78dcfe5d78544">INTERFACE</a>;</div>
<div class="line"><span class="lineno">  250</span>  }</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>  std::vector &lt; double &gt; area(x.size(), Ly * Lz / x.size());  <span class="comment">// uniform marker volume</span></div>
<div class="line"><span class="lineno">  253</span>  <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#ae553c80321ef2d7c454cc4f62b42d0d1">x0</a> = -0.5 * Lx + Lx1;; <span class="comment">//we are using this not to have markers on edges of elements from the beginning</span></div>
<div class="line"><span class="lineno">  254</span>  std::vector &lt; std::vector &lt; std::vector &lt; double &gt; &gt; &gt; T;</div>
<div class="line"><span class="lineno">  255</span>  T.resize(x.size());</div>
<div class="line"><span class="lineno">  256</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; x.size(); i++) {</div>
<div class="line"><span class="lineno">  257</span>    T[i].resize(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> - 1);</div>
<div class="line"><span class="lineno">  258</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> - 1; k++) {</div>
<div class="line"><span class="lineno">  259</span>      T[i][k].resize(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a>, 0.);</div>
<div class="line"><span class="lineno">  260</span>    }</div>
<div class="line"><span class="lineno">  261</span>  }</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span> </div>
<div class="line"><span class="lineno">  264</span>  <span class="comment">//BEGIN initialization</span></div>
<div class="line"><span class="lineno">  265</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; rowy; i++) {</div>
<div class="line"><span class="lineno">  266</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; rowz; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  267</span>      x[ i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0] = <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#ae553c80321ef2d7c454cc4f62b42d0d1">x0</a>;</div>
<div class="line"><span class="lineno">  268</span>      x[ i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1] = y0 + 0.5 * dy + i * dy;</div>
<div class="line"><span class="lineno">  269</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) x[ i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][2] = z0 + 0.5 * dz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * dz;</div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>      T[i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0][0] = 0.;</div>
<div class="line"><span class="lineno">  272</span>      T[i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0][1] = -dy;</div>
<div class="line"><span class="lineno">  273</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) {</div>
<div class="line"><span class="lineno">  274</span>        T[i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0][2] = 0.;</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>        T[i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1][0] = 0.;</div>
<div class="line"><span class="lineno">  277</span>        T[i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1][1] = 0.;</div>
<div class="line"><span class="lineno">  278</span>        T[i * rowz + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1][2] = dz;</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>      }</div>
<div class="line"><span class="lineno">  281</span>    }</div>
<div class="line"><span class="lineno">  282</span>  }</div>
<div class="line"><span class="lineno">  283</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>  <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a> = <span class="keyword">new</span> <a class="code hl_class" href="../../dc/d42/classfemus_1_1_line.html">Line</a>(x, T, markerType, mlSol.GetLevel(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1), solType);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>  std::vector &lt; std::vector &lt; std::vector &lt; double &gt; &gt; &gt; lineIPoints(1);</div>
<div class="line"><span class="lineno">  288</span>  <a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a9c7f4646f2d0019cf0f5d26738922a6e">lineI</a>-&gt;<a class="code hl_function" href="../../dc/d42/classfemus_1_1_line.html#a0623915f9f27153ef5e477b3a566256d">GetLine</a>(lineIPoints[0]);</div>
<div class="line"><span class="lineno">  289</span>  <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ab218007e286871c1b8c469f8e78a96b4">PrintLine</a>(<a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;interfaceLine&quot;</span>, lineIPoints, 0);</div>
<div class="line"><span class="lineno">  290</span>  <span class="comment">//PrintLine(&quot;./output1&quot;, &quot;interfaceLine&quot;, lineIPoints, 0);</span></div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">//END interface markers</span></div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>  <span class="comment">// ******* Print solution *******</span></div>
<div class="line"><span class="lineno">  295</span>  mlSol.SetWriter(<a class="code hl_enumvalue" href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);</div>
<div class="line"><span class="lineno">  296</span>  mlSol.GetWriter()-&gt;SetDebugOutput(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span>  std::vector&lt;std::string&gt; print_vars;</div>
<div class="line"><span class="lineno">  299</span>  print_vars.push_back(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>  <a class="code hl_function" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a7d8e300019ed90d788a45877936a66ed">GetInterfaceElementEigenvalues</a>(mlSol);</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>  system.MGsolve();</div>
<div class="line"><span class="lineno">  304</span>  </div>
<div class="line"><span class="lineno">  305</span>  </div>
<div class="line"><span class="lineno">  306</span>  mlSol.GetWriter()-&gt;Write(<span class="stringliteral">&quot;./output&quot;</span>, <span class="stringliteral">&quot;linear&quot;</span>, print_vars, 0);</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  std::vector&lt;std::string&gt; mov_vars1;</div>
<div class="line"><span class="lineno">  309</span>  mov_vars1.push_back(<span class="stringliteral">&quot;DX1&quot;</span>);</div>
<div class="line"><span class="lineno">  310</span>  mov_vars1.push_back(<span class="stringliteral">&quot;DY1&quot;</span>);</div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) mov_vars1.push_back(<span class="stringliteral">&quot;DZ1&quot;</span>);</div>
<div class="line"><span class="lineno">  312</span>  mlSol.GetWriter()-&gt;SetMovingMesh(mov_vars1);</div>
<div class="line"><span class="lineno">  313</span>  mlSol.GetWriter()-&gt;Write(<span class="stringliteral">&quot;./outputD1&quot;</span>, <span class="stringliteral">&quot;linear&quot;</span>, print_vars, 0);</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  std::vector&lt;std::string&gt; mov_vars2;</div>
<div class="line"><span class="lineno">  317</span>  mov_vars2.push_back(<span class="stringliteral">&quot;DX2&quot;</span>);</div>
<div class="line"><span class="lineno">  318</span>  mov_vars2.push_back(<span class="stringliteral">&quot;DY2&quot;</span>);</div>
<div class="line"><span class="lineno">  319</span>  <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2d74540095f3eb8232f3cdefa65b6c61">DIM</a> == 3) mov_vars2.push_back(<span class="stringliteral">&quot;DZ2&quot;</span>);</div>
<div class="line"><span class="lineno">  320</span>  mlSol.GetWriter()-&gt;SetMovingMesh(mov_vars2);</div>
<div class="line"><span class="lineno">  321</span>  mlSol.GetWriter()-&gt;Write(<span class="stringliteral">&quot;./outputD2&quot;</span>, <span class="stringliteral">&quot;linear&quot;</span>, print_vars, 0);</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  ml_prob.clear();</div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  327</span>}</div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27">HEX27</a></div><div class="ttdeci">@ HEX27</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00023">ElemTypeEnum.hpp:23</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a></div><div class="ttdeci">@ QUAD9</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00016">ElemTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3ba"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3ba">FEOrder</a></div><div class="ttdeci">FEOrder</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00013">FElemTypeEnum.hpp:13</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00018">FElemTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a></div><div class="ttdeci">@ ZERO</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00014">FElemTypeEnum.hpp:14</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a></div><div class="ttdeci">@ DISCONTINUOUS_POLYNOMIAL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00006">FElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_af12829f27afb4207fd7c58ef847b9d8b"><div class="ttname"><a href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a></div><div class="ttdeci">#define DEFAULT_OUTPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="../../de/df8/_femus_default_8hpp_source.html#l00041">FemusDefault.hpp:41</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_a0aca793820b6ff7705450e2043256938"><div class="ttname"><a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a></div><div class="ttdeci">unsigned numberOfUniformLevels</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp_source.html#l00089">ex4.cpp:89</a></div></div>
<div class="ttc" id="a_marker_type_enum_8hpp_html_ade22213fff69cfb37d8238e8fd3073dfa56690e5e62dbaca19fd78dcfe5d78544"><div class="ttname"><a href="../../d7/d4e/_marker_type_enum_8hpp.html#ade22213fff69cfb37d8238e8fd3073dfa56690e5e62dbaca19fd78dcfe5d78544">INTERFACE</a></div><div class="ttdeci">@ INTERFACE</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d4e/_marker_type_enum_8hpp_source.html#l00011">MarkerTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_marker_type_enum_8hpp_html_ade22213fff69cfb37d8238e8fd3073dfa9d326c2efb1f1ef1840d474c0f9b8a48"><div class="ttname"><a href="../../d7/d4e/_marker_type_enum_8hpp.html#ade22213fff69cfb37d8238e8fd3073dfa9d326c2efb1f1ef1840d474c0f9b8a48">VOLUME</a></div><div class="ttdeci">@ VOLUME</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d4e/_marker_type_enum_8hpp_source.html#l00005">MarkerTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_a0b05575316919a4fd6d7cb0f2daaa7cd"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a0b05575316919a4fd6d7cb0f2daaa7cd">BuildFlag</a></div><div class="ttdeci">void BuildFlag(MultiLevelSolution &amp;mlSol)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00814">ex3.cpp:814</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_a2e46d3d6a029c1cf6ccbcf0f4b84b2db"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a2e46d3d6a029c1cf6ccbcf0f4b84b2db">AssembleNitscheProblem_AD</a></div><div class="ttdeci">void AssembleNitscheProblem_AD(MultiLevelProblem &amp;mlProb)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00330">ex3.cpp:330</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_a7d8e300019ed90d788a45877936a66ed"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#a7d8e300019ed90d788a45877936a66ed">GetInterfaceElementEigenvalues</a></div><div class="ttdeci">void GetInterfaceElementEigenvalues(MultiLevelSolution &amp;mlSol)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00877">ex3.cpp:877</a></div></div>
<div class="ttc" id="a_nitsche_2ex3_2ex3_8cpp_html_ab8b0d45993b678f2b4a8aea9fff7fc87"><div class="ttname"><a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00043">ex3.cpp:43</a></div></div>
<div class="ttc" id="a_writer_enum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition</b> <a href="../../db/d1c/_writer_enum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html"><div class="ttname"><a href="../../dc/d42/classfemus_1_1_line.html">femus::Line</a></div><div class="ttdef"><b>Definition</b> <a href="../../d5/d3a/_line_8hpp_source.html#l00034">Line.hpp:34</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html_a0623915f9f27153ef5e477b3a566256d"><div class="ttname"><a href="../../dc/d42/classfemus_1_1_line.html#a0623915f9f27153ef5e477b3a566256d">femus::Line::GetLine</a></div><div class="ttdeci">void GetLine(std::vector&lt; std::vector&lt; double &gt; &gt; &amp;line)</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d3a/_line_8hpp_source.html#l00055">Line.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a09c12975f18035d5369ae411c0208648"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">femus::MultiLevelMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo()</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00462">MultiLevelMesh.cpp:462</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parameter_html"><div class="ttname"><a href="../../d7/d3c/classfemus_1_1_parameter.html">femus::Parameter</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/d1d/_parameter_8hpp_source.html#l00028">Parameter.hpp:28</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a606e07526d7a0d31eed638404ee2ed24"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">femus::System::AddSolutionToSystemPDE</a></div><div class="ttdeci">virtual void AddSolutionToSystemPDE(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00075">System.cpp:75</a></div></div>
<div class="ttc" id="ainternal__waves__zlevel_8cpp_html_ae553c80321ef2d7c454cc4f62b42d0d1"><div class="ttname"><a href="../../dc/d97/internal__waves__zlevel_8cpp.html#ae553c80321ef2d7c454cc4f62b42d0d1">x0</a></div><div class="ttdeci">double x0</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d97/internal__waves__zlevel_8cpp_source.html#l00046">internal_waves_zlevel.cpp:46</a></div></div>
<div class="ttc" id="anamespacefemus_html_ab218007e286871c1b8c469f8e78a96b4"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#ab218007e286871c1b8c469f8e78a96b4">femus::PrintLine</a></div><div class="ttdeci">void PrintLine(const std::string output_path, const std::string file, const std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &amp;xn, const unsigned &amp;step)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d29/_polynomial_bases_8cpp_source.html#l01952">PolynomialBases.cpp:1952</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8b0d45993b678f2b4a8aea9fff7fc87" name="ab8b0d45993b678f2b4a8aea9fff7fc87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b0d45993b678f2b4a8aea9fff7fc87">&#9670;&#160;</a></span>SetBoundaryCondition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryCondition </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>SolName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00043">43</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>                                                                                                                                     {</div>
<div class="line"><span class="lineno">   44</span>  <span class="keywordtype">bool</span> dirichlet = <span class="keyword">false</span>; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordflow">if</span>(facename == 1)  dirichlet = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = 0.;</div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><span class="lineno">   48</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a2d74540095f3eb8232f3cdefa65b6c61" name="a2d74540095f3eb8232f3cdefa65b6c61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2d74540095f3eb8232f3cdefa65b6c61">&#9670;&#160;</a></span>DIM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned DIM = 2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00036">36</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>

</div>
</div>
<a id="a1586fa1c4660de16b0d05493354e992a" name="a1586fa1c4660de16b0d05493354e992a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1586fa1c4660de16b0d05493354e992a">&#9670;&#160;</a></span>line1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d42/classfemus_1_1_line.html">Line</a>* line1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00032">32</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>

</div>
</div>
<a id="aed2973510af2dd9ff93ef05465ed515f" name="aed2973510af2dd9ff93ef05465ed515f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aed2973510af2dd9ff93ef05465ed515f">&#9670;&#160;</a></span>line2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d42/classfemus_1_1_line.html">Line</a>* line2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00033">33</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>

</div>
</div>
<a id="a9c7f4646f2d0019cf0f5d26738922a6e" name="a9c7f4646f2d0019cf0f5d26738922a6e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c7f4646f2d0019cf0f5d26738922a6e">&#9670;&#160;</a></span>lineI</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d42/classfemus_1_1_line.html">Line</a>* lineI</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html#l00034">34</a> of file <a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp_source.html">ex3.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_bece3cabca3eaeb038d998ae8d6d02ac.html">Nitsche</a></li><li class="navelem"><a class="el" href="../../dir_03ee32e35d6da0f3e984bbe0179e9bff.html">ex3</a></li><li class="navelem"><a class="el" href="../../d3/dd9/_nitsche_2ex3_2ex3_8cpp.html">ex3.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
