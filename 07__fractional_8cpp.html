<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/applications/OptimalControl/07_fractional/07_fractional.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('07__fractional_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">07_fractional.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_multi_level_solution_8hpp_source.html">MultiLevelSolution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_transient_system_8hpp_source.html">TransientSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_linear_implicit_system_8hpp_source.html">LinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_non_linear_implicit_system_8hpp_source.html">NonLinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_numeric_vector_8hpp_source.html">NumericVector.hpp</a>&quot;</code><br />
<code>#include &quot;adept.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_current_elem_8hpp_source.html">CurrentElem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_elem_type__template_8hpp_source.html">ElemType_template.hpp</a>&quot;</code><br />
<code>#include &quot;petsc.h&quot;</code><br />
<code>#include &quot;petscmat.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_petsc_matrix_8hpp_source.html">PetscMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_assemble__jacobian_8hpp_source.html">Assemble_jacobian.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="fractional__functions_8hpp_source.html">../fractional_functions.hpp</a>&quot;</code><br />
</div>
<p><a href="07__fractional_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:a120d118c3e901df3fd09add0c10ad91f"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a120d118c3e901df3fd09add0c10ad91f">N_UNIFORM_LEVELS</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a120d118c3e901df3fd09add0c10ad91f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6cf2919927f47ad5f49ed95eaef8add9"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a6cf2919927f47ad5f49ed95eaef8add9">N_ERASED_LEVELS</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a6cf2919927f47ad5f49ed95eaef8add9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb5589fe79c9c11abbbb2a2a52d0ba7"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a7eb5589fe79c9c11abbbb2a2a52d0ba7">RHS_ONE</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a7eb5589fe79c9c11abbbb2a2a52d0ba7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7eb16be80e7f4c50bdf6f65e04b310ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a7eb16be80e7f4c50bdf6f65e04b310ff">S_FRAC</a>&#160;&#160;&#160;0.5</td></tr>
<tr class="separator:a7eb16be80e7f4c50bdf6f65e04b310ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab33c985fc96acde267a7bf1a54b0a1e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:aab33c985fc96acde267a7bf1a54b0a1e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b20da92637cd95fc41f37f3b0823724"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a2b20da92637cd95fc41f37f3b0823724"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac040470a806bb6f4f879015d8f04fd61"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ac040470a806bb6f4f879015d8f04fd61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af17df4d5d5bad0ea1d48fa796a91d4ce"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#af17df4d5d5bad0ea1d48fa796a91d4ce">UNBOUNDED</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:af17df4d5d5bad0ea1d48fa796a91d4ce"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a77fcfcb56b6df13876acd5f0336aada0"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a77fcfcb56b6df13876acd5f0336aada0">USE_Cns</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:a77fcfcb56b6df13876acd5f0336aada0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249cc0a8805d02135da257cb5bcdd4c6"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a249cc0a8805d02135da257cb5bcdd4c6">EX_1</a>&#160;&#160;&#160;-1</td></tr>
<tr class="separator:a249cc0a8805d02135da257cb5bcdd4c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec14a389f0ca0850c6e3f8335469a059"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#aec14a389f0ca0850c6e3f8335469a059">EX_2</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:aec14a389f0ca0850c6e3f8335469a059"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af772aaeb5b072fa4fbe5ebdca0ff34ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#af772aaeb5b072fa4fbe5ebdca0ff34ed">EY_1</a>&#160;&#160;&#160;-1</td></tr>
<tr class="separator:af772aaeb5b072fa4fbe5ebdca0ff34ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad07e55e73704a110451c3fbad7b402ed"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#ad07e55e73704a110451c3fbad7b402ed">EY_2</a>&#160;&#160;&#160;1</td></tr>
<tr class="separator:ad07e55e73704a110451c3fbad7b402ed"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1657662a81b61879c06d4916549f8517"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a1657662a81b61879c06d4916549f8517">DOMAIN_DIM</a>&#160;&#160;&#160;2</td></tr>
<tr class="separator:a1657662a81b61879c06d4916549f8517"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c634d703dcf88c5b98f854de3c0b0ff"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a3c634d703dcf88c5b98f854de3c0b0ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2127932b519fbf2a043dac81759ce444"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a2127932b519fbf2a043dac81759ce444">N_DIV_FACE_OF_FACE_FOR_UNBOUNDED_INTEGRAL</a>&#160;&#160;&#160;10</td></tr>
<tr class="separator:a2127932b519fbf2a043dac81759ce444"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a546143b57a5fa249592941c2b7be629d"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a546143b57a5fa249592941c2b7be629d">InitialValueU</a> (const std::vector&lt; double &gt; &amp;x)</td></tr>
<tr class="separator:a546143b57a5fa249592941c2b7be629d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a> (const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa90ba84bd5f3c82ef6584676659c53f3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#aa90ba84bd5f3c82ef6584676659c53f3">GetHsNorm</a> (const unsigned level, <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:aa90ba84bd5f3c82ef6584676659c53f3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8d2b7ad817b979696acdbe1f3a2c5d35"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a8d2b7ad817b979696acdbe1f3a2c5d35">AssembleFracProblem</a> (<a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:a8d2b7ad817b979696acdbe1f3a2c5d35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="07__fractional_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a1657662a81b61879c06d4916549f8517" name="a1657662a81b61879c06d4916549f8517"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1657662a81b61879c06d4916549f8517">&#9670;&#160;</a></span>DOMAIN_DIM</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define DOMAIN_DIM&#160;&#160;&#160;2</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00051">51</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a249cc0a8805d02135da257cb5bcdd4c6" name="a249cc0a8805d02135da257cb5bcdd4c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249cc0a8805d02135da257cb5bcdd4c6">&#9670;&#160;</a></span>EX_1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EX_1&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00046">46</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="aec14a389f0ca0850c6e3f8335469a059" name="aec14a389f0ca0850c6e3f8335469a059"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec14a389f0ca0850c6e3f8335469a059">&#9670;&#160;</a></span>EX_2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EX_2&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00047">47</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="af772aaeb5b072fa4fbe5ebdca0ff34ed" name="af772aaeb5b072fa4fbe5ebdca0ff34ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af772aaeb5b072fa4fbe5ebdca0ff34ed">&#9670;&#160;</a></span>EY_1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EY_1&#160;&#160;&#160;-1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00048">48</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="ad07e55e73704a110451c3fbad7b402ed" name="ad07e55e73704a110451c3fbad7b402ed"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad07e55e73704a110451c3fbad7b402ed">&#9670;&#160;</a></span>EY_2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define EY_2&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00049">49</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a2127932b519fbf2a043dac81759ce444" name="a2127932b519fbf2a043dac81759ce444"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2127932b519fbf2a043dac81759ce444">&#9670;&#160;</a></span>N_DIV_FACE_OF_FACE_FOR_UNBOUNDED_INTEGRAL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N_DIV_FACE_OF_FACE_FOR_UNBOUNDED_INTEGRAL&#160;&#160;&#160;10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00062">62</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a6cf2919927f47ad5f49ed95eaef8add9" name="a6cf2919927f47ad5f49ed95eaef8add9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6cf2919927f47ad5f49ed95eaef8add9">&#9670;&#160;</a></span>N_ERASED_LEVELS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N_ERASED_LEVELS&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00027">27</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a120d118c3e901df3fd09add0c10ad91f" name="a120d118c3e901df3fd09add0c10ad91f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a120d118c3e901df3fd09add0c10ad91f">&#9670;&#160;</a></span>N_UNIFORM_LEVELS</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define N_UNIFORM_LEVELS&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00026">26</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a3c634d703dcf88c5b98f854de3c0b0ff" name="a3c634d703dcf88c5b98f854de3c0b0ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c634d703dcf88c5b98f854de3c0b0ff">&#9670;&#160;</a></span>Nsplit</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define Nsplit&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00060">60</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a2b20da92637cd95fc41f37f3b0823724" name="a2b20da92637cd95fc41f37f3b0823724"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b20da92637cd95fc41f37f3b0823724">&#9670;&#160;</a></span>OP_H1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OP_H1&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00036">36</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="ac040470a806bb6f4f879015d8f04fd61" name="ac040470a806bb6f4f879015d8f04fd61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac040470a806bb6f4f879015d8f04fd61">&#9670;&#160;</a></span>OP_Hhalf</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OP_Hhalf&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00037">37</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="aab33c985fc96acde267a7bf1a54b0a1e" name="aab33c985fc96acde267a7bf1a54b0a1e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab33c985fc96acde267a7bf1a54b0a1e">&#9670;&#160;</a></span>OP_L2</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define OP_L2&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00035">35</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a7eb5589fe79c9c11abbbb2a2a52d0ba7" name="a7eb5589fe79c9c11abbbb2a2a52d0ba7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb5589fe79c9c11abbbb2a2a52d0ba7">&#9670;&#160;</a></span>RHS_ONE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define RHS_ONE&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00031">31</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a7eb16be80e7f4c50bdf6f65e04b310ff" name="a7eb16be80e7f4c50bdf6f65e04b310ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7eb16be80e7f4c50bdf6f65e04b310ff">&#9670;&#160;</a></span>S_FRAC</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define S_FRAC&#160;&#160;&#160;0.5</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00033">33</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="af17df4d5d5bad0ea1d48fa796a91d4ce" name="af17df4d5d5bad0ea1d48fa796a91d4ce"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af17df4d5d5bad0ea1d48fa796a91d4ce">&#9670;&#160;</a></span>UNBOUNDED</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define UNBOUNDED&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00039">39</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<a id="a77fcfcb56b6df13876acd5f0336aada0" name="a77fcfcb56b6df13876acd5f0336aada0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a77fcfcb56b6df13876acd5f0336aada0">&#9670;&#160;</a></span>USE_Cns</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define USE_Cns&#160;&#160;&#160;1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00041">41</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8d2b7ad817b979696acdbe1f3a2c5d35" name="a8d2b7ad817b979696acdbe1f3a2c5d35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8d2b7ad817b979696acdbe1f3a2c5d35">&#9670;&#160;</a></span>AssembleFracProblem()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AssembleFracProblem </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>( sin(2 * acos(0.0) * x1[0][i])) * ( sin(2 * acos(0.0) * x1[1][i]))</p>
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000151">Todo:</a></b></dt><dd>is there a way to put this outside of the ig loop? </dd></dl>

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00300">300</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  301</span>{</div>
<div class="line"><span class="lineno">  302</span><span class="comment">//void GetEigenPair(MultiLevelProblem &amp; ml_prob, Mat &amp;CCSLEPc, Mat &amp;MMSLEPc) {</span></div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>  <a class="code hl_class" href="classfemus_1_1_non_linear_implicit_system.html">NonLinearImplicitSystem</a>* mlPdeSys  = &amp;ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; <a class="code hl_class" href="classfemus_1_1_non_linear_implicit_system.html">NonLinearImplicitSystem</a> &gt; (<span class="stringliteral">&quot;FracProblem&quot;</span>);</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = <a class="code hl_define" href="07__fractional_8cpp.html#a120d118c3e901df3fd09add0c10ad91f">N_UNIFORM_LEVELS</a> - <a class="code hl_define" href="07__fractional_8cpp.html#a6cf2919927f47ad5f49ed95eaef8add9">N_ERASED_LEVELS</a> - 1;</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>*                    msh = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);    <span class="comment">// pointer to the mesh (level) object</span></div>
<div class="line"><span class="lineno">  310</span>  <a class="code hl_class" href="classfemus_1_1elem.html">elem</a>*                     el = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;  <span class="comment">// pointer to the elem object in msh (level)</span></div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>*    ml_sol = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;  <span class="comment">// pointer to the multilevel solution object</span></div>
<div class="line"><span class="lineno">  313</span>  <a class="code hl_class" href="classfemus_1_1_solution.html">Solution</a>*                sol = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level);    <span class="comment">// pointer to the solution (level) object</span></div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>  <a class="code hl_class" href="classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>* pdeSys = mlPdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[level]; <span class="comment">// pointer to the equation (level) object</span></div>
<div class="line"><span class="lineno">  316</span>  <a class="code hl_class" href="classfemus_1_1_sparse_matrix.html">SparseMatrix</a>*             <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;  <span class="comment">// pointer to the global stifness matrix object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  317</span>  <a class="code hl_class" href="classfemus_1_1_numeric_vector.html">NumericVector</a>*           RES = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>;</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>(); <span class="comment">// get the domain dimension of the problem</span></div>
<div class="line"><span class="lineno">  320</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> maxSize = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  323</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span> </div>
<div class="line"><span class="lineno">  326</span>  CurrentElem &lt; double &gt; geom_element1(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, msh);            <span class="comment">// must be adept if the domain is moving, otherwise double</span></div>
<div class="line"><span class="lineno">  327</span>  CurrentElem &lt; double &gt; geom_element2(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, msh);            <span class="comment">// must be adept if the domain is moving, otherwise double</span></div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>  <span class="keyword">constexpr</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> space_dim = 3;</div>
<div class="line"><span class="lineno">  330</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno">  331</span>  <span class="comment">//prepare Abstract quantities for all fe fams for all geom elems: all quadrature evaluations are performed beforehand in the main function</span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno">  333</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  JacI_jqp(space_dim);</div>
<div class="line"><span class="lineno">  334</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  Jac_jqp(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  335</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno">  336</span>    Jac_jqp[d].resize(space_dim);</div>
<div class="line"><span class="lineno">  337</span>  }</div>
<div class="line"><span class="lineno">  338</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; space_dim; d++) {</div>
<div class="line"><span class="lineno">  339</span>    JacI_jqp[d].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  340</span>  }</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <span class="keywordtype">double</span> detJac_jqp;</div>
<div class="line"><span class="lineno">  343</span>  std::vector &lt; std::vector &lt; <span class="comment">/*const*/</span> <a class="code hl_class" href="classfemus_1_1elem__type__templ__base.html">elem_type_templ_base&lt; double, double &gt;</a> *  &gt; &gt; elem_all;</div>
<div class="line"><span class="lineno">  344</span>  ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a1a9383619526e04fe6fac99acb7cfab9">get_all_abstract_fe</a>(elem_all);</div>
<div class="line"><span class="lineno">  345</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>  <span class="comment">//solution variable</span></div>
<div class="line"><span class="lineno">  348</span>  <span class="keywordtype">unsigned</span> soluIndex = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;u&quot;</span>);    <span class="comment">// get the position of &quot;u&quot; in the ml_sol object</span></div>
<div class="line"><span class="lineno">  349</span>  <span class="keywordtype">unsigned</span> solType   = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(soluIndex);    <span class="comment">// get the finite element type for &quot;u&quot;</span></div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>  std::vector &lt; double &gt; solu1;</div>
<div class="line"><span class="lineno">  352</span>  std::vector &lt; double &gt; solu2;</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> soluPdeIndex = mlPdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;u&quot;</span>);    <span class="comment">// get the position of &quot;u&quot; in the pdeSys object</span></div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>  <span class="keywordtype">unsigned</span> xType = 2; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE QUADRATIC)</span></div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>  vector &lt; vector &lt; double &gt; &gt; x1(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);    <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  359</span>  vector &lt; vector &lt; double &gt; &gt; x2(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);    <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  360</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  361</span>    x1[k].reserve(maxSize);</div>
<div class="line"><span class="lineno">  362</span>    x2[k].reserve(maxSize);</div>
<div class="line"><span class="lineno">  363</span>  }</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>  vector &lt; double &gt; <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line"><span class="lineno">  366</span>  vector &lt; double &gt; phi_x;</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>  <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.reserve(maxSize);</div>
<div class="line"><span class="lineno">  369</span>  phi_x.reserve(maxSize * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  vector&lt; int &gt; l2GMap1; <span class="comment">// local to global mapping</span></div>
<div class="line"><span class="lineno">  372</span>  vector&lt; int &gt; l2GMap2; <span class="comment">// local to global mapping</span></div>
<div class="line"><span class="lineno">  373</span>  l2GMap1.reserve(maxSize);</div>
<div class="line"><span class="lineno">  374</span>  l2GMap2.reserve(maxSize);</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span><span class="comment">//   Local matrices and rhs for laplacian and mass matrix</span></div>
<div class="line"><span class="lineno">  377</span>  vector &lt; double &gt; KK_local;  KK_local.reserve(maxSize * maxSize);</div>
<div class="line"><span class="lineno">  378</span>  vector &lt; double &gt; Res_local; Res_local.reserve(maxSize);</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span><span class="comment">//   Local matrices and rhs for adaptive quadrature</span></div>
<div class="line"><span class="lineno">  381</span>  vector &lt; double &gt; Res_local_refined; Res_local_refined.reserve(maxSize);</div>
<div class="line"><span class="lineno">  382</span>  vector &lt; double &gt; CClocal_refined;   CClocal_refined.reserve(maxSize * maxSize);</div>
<div class="line"><span class="lineno">  383</span> </div>
<div class="line"><span class="lineno">  384</span>  vector &lt; double &gt; KK_local_mixed_num;   KK_local_mixed_num.reserve(maxSize * maxSize);</div>
<div class="line"><span class="lineno">  385</span>  vector &lt; double &gt; Res_local_mixed_num;  Res_local_mixed_num.reserve(maxSize);</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span><span class="comment">//   Non local matrices and vectors for H^s laplacian operator</span></div>
<div class="line"><span class="lineno">  388</span><span class="comment">//   vector&lt; double &gt;         Res_nonlocal;</span></div>
<div class="line"><span class="lineno">  389</span><span class="comment">//   Res_nonlocal.reserve(maxSize);  // local residual vector</span></div>
<div class="line"><span class="lineno">  390</span>  vector&lt; double &gt;         Res_nonlocalI;  Res_nonlocalI.reserve(maxSize);</div>
<div class="line"><span class="lineno">  391</span>  vector&lt; double &gt;         Res_nonlocalJ;  Res_nonlocalJ.reserve(maxSize);</div>
<div class="line"><span class="lineno">  392</span><span class="comment">//   vector &lt; double &gt; CClocal;</span></div>
<div class="line"><span class="lineno">  393</span><span class="comment">//   CClocal.reserve(maxSize * maxSize);</span></div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>  vector &lt; double &gt; CC_nonlocal_II;  CC_nonlocal_II.reserve(maxSize * maxSize);</div>
<div class="line"><span class="lineno">  396</span>  vector &lt; double &gt; CC_nonlocal_IJ;  CC_nonlocal_IJ.reserve(maxSize * maxSize);</div>
<div class="line"><span class="lineno">  397</span>  vector &lt; double &gt; CC_nonlocal_JI;  CC_nonlocal_JI.reserve(maxSize * maxSize);</div>
<div class="line"><span class="lineno">  398</span>  vector &lt; double &gt; CC_nonlocal_JJ;  CC_nonlocal_JJ.reserve(maxSize * maxSize);</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;zero(); <span class="comment">// Set to zero all the entries of the Global Matrix</span></div>
<div class="line"><span class="lineno">  401</span>  RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span><span class="comment">//   int KK_size = msh-&gt;_dofOffset[solType][nprocs];</span></div>
<div class="line"><span class="lineno">  404</span><span class="comment">//   int KK_local_size = msh-&gt;_dofOffset[solType][iproc + 1] - msh-&gt;_dofOffset[solType][iproc];</span></div>
<div class="line"><span class="lineno">  405</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  406</span><span class="comment">//   SparseMatrix* CC;</span></div>
<div class="line"><span class="lineno">  407</span><span class="comment">//   CC = SparseMatrix::build().release();</span></div>
<div class="line"><span class="lineno">  408</span><span class="comment">//   CC-&gt;init(KK_size, KK_size, KK_local_size, KK_local_size, KK_local_size, KK_size - KK_local_size);</span></div>
<div class="line"><span class="lineno">  409</span><span class="comment">//   CC-&gt;zero();</span></div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span><span class="comment">// The macro structure of the loops is </span></div>
<div class="line"><span class="lineno">  412</span>   <span class="comment">// jel - iel  - ig - jg </span></div>
<div class="line"><span class="lineno">  413</span>  </div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> s_frac = <a class="code hl_define" href="07__fractional_8cpp.html#a7eb16be80e7f4c50bdf6f65e04b310ff">S_FRAC</a>;</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> check_limits = 1.;<span class="comment">//1./(1. - s_frac); // - s_frac;</span></div>
<div class="line"><span class="lineno">  418</span> </div>
<div class="line"><span class="lineno">  419</span>  <span class="keywordtype">double</span> C_ns = 2 * (1 - <a class="code hl_define" href="07__fractional_8cpp.html#a77fcfcb56b6df13876acd5f0336aada0">USE_Cns</a>) + <a class="code hl_define" href="07__fractional_8cpp.html#a77fcfcb56b6df13876acd5f0336aada0">USE_Cns</a> * s_frac * pow(2, (2. * s_frac)) * tgamma((<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 2. * s_frac) / 2.) / (pow(M_PI, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> / 2.) * tgamma(1 -  s_frac)) ;</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>  </div>
<div class="line"><span class="lineno">  422</span>  </div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kproc = 0; kproc &lt; nprocs; kproc++) {</div>
<div class="line"><span class="lineno">  424</span>      </div>
<div class="line"><span class="lineno">  425</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[kproc]; jel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[kproc + 1]; jel++) {</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>      <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom2;</div>
<div class="line"><span class="lineno">  428</span>      <span class="keywordtype">unsigned</span> nDof2;</div>
<div class="line"><span class="lineno">  429</span>      <span class="keywordtype">unsigned</span> nDofx2;</div>
<div class="line"><span class="lineno">  430</span>      <span class="keywordtype">unsigned</span> nDofu2;</div>
<div class="line"><span class="lineno">  431</span>      <span class="comment">//unsigned n_face;</span></div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno">  434</span>        ielGeom2 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(jel);</div>
<div class="line"><span class="lineno">  435</span>        nDof2  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(jel, solType);    <span class="comment">// number of solution element dofs</span></div>
<div class="line"><span class="lineno">  436</span>        nDofx2 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(jel, xType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>      }</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>      MPI_Bcast(&amp;ielGeom2, 1, MPI_UNSIGNED_SHORT, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  441</span>      MPI_Bcast(&amp;nDof2, 1, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  442</span>      MPI_Bcast(&amp;nDofx2, 1, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  443</span>      <span class="comment">//MPI_Bcast(&amp;n_face, 1, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</span></div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>      <span class="comment">// resize local arrays</span></div>
<div class="line"><span class="lineno">  446</span>      l2GMap2.resize(nDof2);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  450</span>        x2[k].resize(nDofx2);</div>
<div class="line"><span class="lineno">  451</span>      }</div>
<div class="line"><span class="lineno">  452</span>      solu2.resize(nDof2);</div>
<div class="line"><span class="lineno">  453</span> </div>
<div class="line"><span class="lineno">  454</span>      <span class="comment">// local storage of global mapping and solution ********************</span></div>
<div class="line"><span class="lineno">  455</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno">  456</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  457</span>          l2GMap2[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(soluIndex, soluPdeIndex, <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, jel);  <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><span class="lineno">  458</span>        }</div>
<div class="line"><span class="lineno">  459</span>      }</div>
<div class="line"><span class="lineno">  460</span>      MPI_Bcast(&amp;l2GMap2[0], nDof2, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  461</span>      <span class="comment">// ******************************************************************</span></div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>      <span class="comment">// local storage of coordinates  #######################################</span></div>
<div class="line"><span class="lineno">  464</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno">  465</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofx2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  466</span>          <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, jel, xType);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  467</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  468</span>            x2[k][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k])(xDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  469</span>          }</div>
<div class="line"><span class="lineno">  470</span>        }</div>
<div class="line"><span class="lineno">  471</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  472</span>          <span class="keywordtype">unsigned</span> jDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, jel, solType);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  473</span>          solu2[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndex])(jDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  474</span>        }</div>
<div class="line"><span class="lineno">  475</span>      }</div>
<div class="line"><span class="lineno">  476</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  477</span>        MPI_Bcast(&amp; x2[k][0], nDofx2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  478</span>      }</div>
<div class="line"><span class="lineno">  479</span>      MPI_Bcast(&amp; solu2[0], nDof2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  480</span>      <span class="comment">// ######################################################################</span></div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>      <span class="comment">// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></div>
<div class="line"><span class="lineno">  483</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno">  484</span>        geom_element2.set_coords_at_dofs_and_geom_type(jel, xType);</div>
<div class="line"><span class="lineno">  485</span>      }</div>
<div class="line"><span class="lineno">  486</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  487</span>        MPI_Bcast(&amp; geom_element2.get_coords_at_dofs()[k][0], nDofx2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  488</span>      }</div>
<div class="line"><span class="lineno">  489</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; space_dim; k++) {</div>
<div class="line"><span class="lineno">  490</span>        MPI_Bcast(&amp; geom_element2.get_coords_at_dofs_3d()[k][0], nDofx2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  491</span>      }</div>
<div class="line"><span class="lineno">  492</span>      <span class="comment">// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span><span class="comment">//       const unsigned jgNumber = msh-&gt;_finiteElement[ielGeom2][solType]-&gt;GetGaussPointNumber();</span></div>
<div class="line"><span class="lineno">  495</span>      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> jgNumber = ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom2).<a class="code hl_function" href="classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>      vector &lt; vector &lt; double &gt; &gt; xg2(jgNumber);</div>
<div class="line"><span class="lineno">  498</span>      vector &lt;double&gt; weight2(jgNumber);</div>
<div class="line"><span class="lineno">  499</span>      vector &lt; vector &lt;double&gt; &gt; phi2(jgNumber);  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno">  500</span>      std::vector&lt; double &gt; solY(jgNumber, 0.);</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span><span class="comment">// ---- jg stored computations ---- </span></div>
<div class="line"><span class="lineno">  503</span><span class="comment">// you store all that happens at the jg points so that it is computed only once      </span></div>
<div class="line"><span class="lineno">  504</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jg = 0; jg &lt; jgNumber; jg++) {</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span><span class="comment">//         msh-&gt;_finiteElement[ielGeom2][solType]-&gt;Jacobian(x2, jg, weight2[jg], phi2[jg], phi_x);</span></div>
<div class="line"><span class="lineno">  507</span> </div>
<div class="line"><span class="lineno">  508</span>        elem_all[ielGeom2][xType]-&gt;JacJacInv(<span class="comment">/*x2*/</span>geom_element2.get_coords_at_dofs_3d(), jg, Jac_jqp, JacI_jqp, detJac_jqp, space_dim);</div>
<div class="line"><span class="lineno">  509</span>        weight2[jg] = detJac_jqp * ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom2).<a class="code hl_function" href="classfemus_1_1_gauss.html#a20c1596b027c605731549535cd1b41c7">GetGaussWeightsPointer</a>()[jg];</div>
<div class="line"><span class="lineno">  510</span>        elem_all[ielGeom2][solType]-&gt;shape_funcs_current_elem(jg, JacI_jqp, phi2[jg], phi_x <span class="comment">/*boost::none*/</span>, boost::none <span class="comment">/*phi_u_xx*/</span>, space_dim);</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>        xg2[jg].assign(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  516</span>        solY[jg] = 0.;</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  519</span>          solY[jg] += solu2[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * phi2[jg][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  520</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  521</span>            xg2[jg][k] += x2[k][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * phi2[jg][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  522</span>          }</div>
<div class="line"><span class="lineno">  523</span>        }</div>
<div class="line"><span class="lineno">  524</span>      }</div>
<div class="line"><span class="lineno">  525</span><span class="comment">// ---- jg stored computations ----    </span></div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span> </div>
<div class="line"><span class="lineno">  529</span><span class="comment">// ---- boundary faces in jel: compute and broadcast - BEGIN ----    </span></div>
<div class="line"><span class="lineno">  530</span>      std::vector &lt;int&gt; bd_face(0);</div>
<div class="line"><span class="lineno">  531</span>      <span class="keywordtype">unsigned</span> nFaces;</div>
<div class="line"><span class="lineno">  532</span>      <span class="comment">//std::vector &lt;unsigned&gt; faceDofs(n_face, 0);</span></div>
<div class="line"><span class="lineno">  533</span>      <span class="comment">//vector &lt; vector &lt;unsigned&gt; &gt; inode(n_face);</span></div>
<div class="line"><span class="lineno">  534</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno">  535</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface = 0; jface &lt; msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a5a0c1124aca095fd4327252ebac3660f">GetElementFaceNumber</a>(jel); jface++) {</div>
<div class="line"><span class="lineno">  536</span>          <span class="keywordtype">int</span> faceIndex = el-&gt;<a class="code hl_function" href="classfemus_1_1elem.html#a54ac1afbd613fe46b8c98be14a1c896f">GetBoundaryIndex</a>(jel, jface);</div>
<div class="line"><span class="lineno">  537</span><span class="comment">//           faceDofs[jface] = msh-&gt;GetElementFaceDofNumber(jel, jface, solType);</span></div>
<div class="line"><span class="lineno">  538</span><span class="comment">//           inode[jface].resize(faceDofs[jface]);</span></div>
<div class="line"><span class="lineno">  539</span><span class="comment">// //       inode[jface].assign(faceDofs[jface], 0);</span></div>
<div class="line"><span class="lineno">  540</span><span class="comment">//           for(unsigned i = 0; i &lt; faceDofs[jface]; i++) {</span></div>
<div class="line"><span class="lineno">  541</span><span class="comment">//             inode[jface][i] = msh-&gt;GetLocalFaceVertexIndex(jel, jface, i);    // face-to-element local node mapping.</span></div>
<div class="line"><span class="lineno">  542</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  543</span><span class="comment">//           MPI_Bcast(&amp; inode[jface][0], faceDofs[jface], MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</span></div>
<div class="line"><span class="lineno">  544</span> </div>
<div class="line"><span class="lineno">  545</span>          <span class="comment">// look for boundary faces</span></div>
<div class="line"><span class="lineno">  546</span>          <span class="keywordflow">if</span>(faceIndex &gt;= 1) {</div>
<div class="line"><span class="lineno">  547</span>            <span class="keywordtype">unsigned</span> i = bd_face.size();</div>
<div class="line"><span class="lineno">  548</span>            bd_face.resize(i + 1);</div>
<div class="line"><span class="lineno">  549</span>            bd_face[i] = jface;</div>
<div class="line"><span class="lineno">  550</span>          }</div>
<div class="line"><span class="lineno">  551</span>        }</div>
<div class="line"><span class="lineno">  552</span>        nFaces = bd_face.size();</div>
<div class="line"><span class="lineno">  553</span>      }</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>      MPI_Bcast(&amp; nFaces, 1, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>      bd_face.resize(nFaces);</div>
<div class="line"><span class="lineno">  558</span>      MPI_Bcast(&amp; bd_face[0], nFaces, MPI_INT, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  559</span><span class="comment">// ---- boundary faces in jel: compute and broadcast - END ----    </span></div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>        <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom1 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  567</span> </div>
<div class="line"><span class="lineno">  568</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  569</span>        <span class="keywordtype">unsigned</span> nDof1  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, solType);    <span class="comment">// number of solution element dofs</span></div>
<div class="line"><span class="lineno">  570</span>        <span class="comment">// resize local arrays</span></div>
<div class="line"><span class="lineno">  571</span>        l2GMap1.resize(nDof1);</div>
<div class="line"><span class="lineno">  572</span>        <span class="comment">//std::vector&lt;bool&gt;bdcDirichlet(nDof1);</span></div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>        <span class="comment">// local storage of global mapping and solution</span></div>
<div class="line"><span class="lineno">  575</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  576</span>          l2GMap1[i] = pdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(soluIndex, soluPdeIndex, i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><span class="lineno">  577</span>          <span class="comment">//unsigned solDof = msh-&gt;GetSolutionDof(i, iel, solType);    // global to global mapping between solution node and solution dof</span></div>
<div class="line"><span class="lineno">  578</span>          <span class="comment">//bdcDirichlet[i] = ( (*sol-&gt;_Bdc[soluIndex])(solDof) &lt; 1.5)? false:false;</span></div>
<div class="line"><span class="lineno">  579</span>        }</div>
<div class="line"><span class="lineno">  580</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  583</span>        <span class="keywordtype">unsigned</span> nDofx1 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, xType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno">  584</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  585</span>          x1[k].resize(nDofx1);</div>
<div class="line"><span class="lineno">  586</span>        }</div>
<div class="line"><span class="lineno">  587</span>        <span class="comment">// local storage of coordinates</span></div>
<div class="line"><span class="lineno">  588</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx1; i++) {</div>
<div class="line"><span class="lineno">  589</span>          <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, xType);    <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  590</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  591</span>            x1[k][i] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k])(xDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  592</span>          }</div>
<div class="line"><span class="lineno">  593</span>        }</div>
<div class="line"><span class="lineno">  594</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  598</span>        solu1.resize(nDof1);</div>
<div class="line"><span class="lineno">  599</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  600</span>          <span class="keywordtype">unsigned</span> iDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, solType);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  601</span>          solu1[i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndex])(iDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  602</span>        }</div>
<div class="line"><span class="lineno">  603</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span> </div>
<div class="line"><span class="lineno">  607</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  608</span><span class="comment">//         CClocal.assign(nDof1 * nDof2, 0.);   //resize</span></div>
<div class="line"><span class="lineno">  609</span>        CC_nonlocal_II.assign(nDof1 * nDof2, 0.);   <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  610</span>        CC_nonlocal_IJ.assign(nDof1 * nDof2, 0.);   <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  611</span>        CC_nonlocal_JI.assign(nDof1 * nDof2, 0.);   <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  612</span>        CC_nonlocal_JJ.assign(nDof1 * nDof2, 0.);   <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  613</span><span class="comment">//         Res_nonlocal.assign(nDof1, 0);    //resize</span></div>
<div class="line"><span class="lineno">  614</span>        Res_nonlocalI.assign(nDof1, 0);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  615</span>        Res_nonlocalJ.assign(nDof1, 0);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>        Res_local_mixed_num.assign(nDof1, 0);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  618</span>        KK_local_mixed_num.assign(nDof1 * nDof1, 0.);</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span>        <span class="keywordflow">if</span>(iel == jel) {</div>
<div class="line"><span class="lineno">  621</span>          Res_local.assign(nDof1, 0);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  622</span>          KK_local.assign(nDof1 * nDof1, 0.);</div>
<div class="line"><span class="lineno">  623</span>          <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a> != 0) {</div>
<div class="line"><span class="lineno">  624</span><span class="comment">//             Vectors and matrices for adaptive quadrature</span></div>
<div class="line"><span class="lineno">  625</span>            Res_local_refined.assign(nDof1, 0);    <span class="comment">//resize</span></div>
<div class="line"><span class="lineno">  626</span>            CClocal_refined.assign(nDof1 * nDof1, 0.);</div>
<div class="line"><span class="lineno">  627</span>          }</div>
<div class="line"><span class="lineno">  628</span>        }</div>
<div class="line"><span class="lineno">  629</span><span class="comment">// ---</span></div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span> </div>
<div class="line"><span class="lineno">  633</span>        <span class="comment">// *** ig loop ***</span></div>
<div class="line"><span class="lineno">  634</span>        </div>
<div class="line"><span class="lineno">  635</span>        <span class="comment">// *** ig initialization - BEGIN  ***</span></div>
<div class="line"><span class="lineno">  636</span>        <span class="keywordtype">double</span> weight1;</div>
<div class="line"><span class="lineno">  637</span>        vector &lt; double &gt; phi1;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>        <span class="keywordtype">double</span> solX = 0.;</div>
<div class="line"><span class="lineno">  640</span>        std::vector&lt;double&gt; sol_u_x(space_dim);</div>
<div class="line"><span class="lineno">  641</span>        std::fill(sol_u_x.begin(), sol_u_x.end(), 0.);</div>
<div class="line"><span class="lineno">  642</span>        <span class="comment">// *** ig initialization - END ***</span></div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>     <span class="comment">//**** Adaptive preparation - BEGIN ********  </span></div>
<div class="line"><span class="lineno">  646</span>        <span class="keywordtype">double</span> weight3;</div>
<div class="line"><span class="lineno">  647</span>        vector &lt; double &gt; phi3;</div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>        std::vector &lt; std::vector &lt; std::vector &lt;double &gt; &gt; &gt; aP(3);</div>
<div class="line"><span class="lineno">  650</span>        <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a> &gt; 0) {</div>
<div class="line"><span class="lineno">  651</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jtype = 0; jtype &lt; solType + 1; jtype++) {</div>
<div class="line"><span class="lineno">  652</span>            <a class="code hl_function" href="namespacefemus.html#afdac57fc6d063ef9ea0b54b401222bc0">ProjectNodalToPolynomialCoefficients</a>(aP[jtype], x1, ielGeom1, jtype) ;</div>
<div class="line"><span class="lineno">  653</span>          }</div>
<div class="line"><span class="lineno">  654</span>        }</div>
<div class="line"><span class="lineno">  655</span>     <span class="comment">//**** Adaptive preparation - END ********  </span></div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> igNumber = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom1][solType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>();</div>
<div class="line"><span class="lineno">  658</span><span class="comment">//         const unsigned jgNumber = msh-&gt;_finiteElement[ielGeom2][solType]-&gt;GetGaussPointNumber();</span></div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; igNumber<span class="comment">/*@todo error*/</span>; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  661</span> </div>
<div class="line"><span class="lineno">  662</span>          msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom1][solType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x1, <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight1, phi1, phi_x);</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>          <span class="comment">// evaluate the solution, the solution derivatives and the coordinates in the gauss point</span></div>
<div class="line"><span class="lineno">  665</span>          vector &lt; double &gt; xg1(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  666</span>          solX = 0.;</div>
<div class="line"><span class="lineno">  667</span> </div>
<div class="line"><span class="lineno">  668</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  669</span>            solX += solu1[i] * phi1[i];</div>
<div class="line"><span class="lineno">  670</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; sol_u_x.size(); d++)   sol_u_x[d] += solu1[i] * phi_x[i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];</div>
<div class="line"><span class="lineno">  671</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  672</span>              xg1[k] += x1[k][i] * phi1[i];</div>
<div class="line"><span class="lineno">  673</span>            }</div>
<div class="line"><span class="lineno">  674</span>          }</div>
<div class="line"><span class="lineno">  675</span>          </div>
<div class="line"><span class="lineno">  676</span>          </div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>          <span class="keywordflow">if</span>(iel == jel) {</div>
<div class="line"><span class="lineno">  679</span> </div>
<div class="line"><span class="lineno">  680</span> <span class="comment">//============  Mass assembly - BEGIN ==================</span></div>
<div class="line"><span class="lineno">  681</span>           <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  682</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof1; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  683</span>                KK_local[ i * nDof1 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] += <a class="code hl_define" href="07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a> * phi1[i] * phi1[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * weight1;</div>
<div class="line"><span class="lineno">  684</span>              }</div>
<div class="line"><span class="lineno">  685</span>              <span class="keywordtype">double</span> mass_res_i = phi1[i] * solX ;</div>
<div class="line"><span class="lineno">  686</span>              Res_local[ i ] += <a class="code hl_define" href="07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a> * weight1 * mass_res_i ;</div>
<div class="line"><span class="lineno">  687</span>              Res_local[ i ] += - <a class="code hl_define" href="07__fractional_8cpp.html#a7eb5589fe79c9c11abbbb2a2a52d0ba7">RHS_ONE</a> * weight1 * (phi1[i] * (-1.) );</div>
<div class="line"><span class="lineno">  688</span>            }</div>
<div class="line"><span class="lineno">  689</span> <span class="comment">//============  Mass assembly - END ==================</span></div>
<div class="line"><span class="lineno">  690</span> </div>
<div class="line"><span class="lineno">  691</span><span class="comment">//============  Laplacian assembly - BEGIN ==================</span></div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span><span class="comment">//          Residual</span></div>
<div class="line"><span class="lineno">  694</span>            std::fill(sol_u_x.begin(), sol_u_x.end(), 0.);</div>
<div class="line"><span class="lineno">  695</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  696</span>              <span class="keywordtype">double</span> laplace_res_du_u_i = 0.;</div>
<div class="line"><span class="lineno">  697</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno">  698</span>                laplace_res_du_u_i  +=  phi_x   [i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_u_x[kdim];</div>
<div class="line"><span class="lineno">  699</span>              }</div>
<div class="line"><span class="lineno">  700</span>              Res_local[ i ] += - <a class="code hl_define" href="07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a> * weight1 * (- laplace_res_du_u_i);</div>
<div class="line"><span class="lineno">  701</span> </div>
<div class="line"><span class="lineno">  702</span><span class="comment">//          Matrix</span></div>
<div class="line"><span class="lineno">  703</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof1; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>                <span class="keywordtype">double</span> laplace_mat_i_j = 0.;</div>
<div class="line"><span class="lineno">  706</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno">  707</span>                  laplace_mat_i_j    += phi_x   [i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] *</div>
<div class="line"><span class="lineno">  708</span>                                        phi_x   [<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim];</div>
<div class="line"><span class="lineno">  709</span>                }</div>
<div class="line"><span class="lineno">  710</span>                KK_local[ i * nDof1 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ]  += <a class="code hl_define" href="07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a> * weight1 *  laplace_mat_i_j;</div>
<div class="line"><span class="lineno">  711</span>              }</div>
<div class="line"><span class="lineno">  712</span>            }</div>
<div class="line"><span class="lineno">  713</span><span class="comment">//============  Laplacian assembly - END ==================</span></div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span><span class="comment">//============  Mixed integral - Analytical ((Rn-Omega) x Omega) assembly (based on the analytic result of integrals) ==================</span></div>
<div class="line"><span class="lineno">  716</span><span class="comment">//             if(dim == 1 &amp;&amp; UNBOUNDED == 1) {</span></div>
<div class="line"><span class="lineno">  717</span><span class="comment">//               double ex_1 = EX_1;</span></div>
<div class="line"><span class="lineno">  718</span><span class="comment">//               double ex_2 = EX_2;</span></div>
<div class="line"><span class="lineno">  719</span><span class="comment">//               double dist_1 = 0.;</span></div>
<div class="line"><span class="lineno">  720</span><span class="comment">//               double dist_2 = 0.;</span></div>
<div class="line"><span class="lineno">  721</span><span class="comment">//               for(int k = 0; k &lt; dim; k++) {</span></div>
<div class="line"><span class="lineno">  722</span><span class="comment">//                 dist_1 += sqrt((xg1[k] - ex_1) * (xg1[k] - ex_1));</span></div>
<div class="line"><span class="lineno">  723</span><span class="comment">//                 dist_2 += sqrt((xg1[k] - ex_2) * (xg1[k] - ex_2));</span></div>
<div class="line"><span class="lineno">  724</span><span class="comment">//               }</span></div>
<div class="line"><span class="lineno">  725</span><span class="comment">//               double mixed_term = pow(dist_1, -2. * s_frac) + pow(dist_2, - 2. * s_frac);</span></div>
<div class="line"><span class="lineno">  726</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  727</span><span class="comment">//               for(unsigned i = 0; i &lt; nDof1; i++) {</span></div>
<div class="line"><span class="lineno">  728</span><span class="comment">//                 for(unsigned j = 0; j &lt; nDof1; j++) {</span></div>
<div class="line"><span class="lineno">  729</span><span class="comment">//                   KK_local[ i * nDof1 + j ] += (C_ns / 2.) * check_limits * (1. / s_frac) * OP_Hhalf * phi1[i] * phi1[j] * weight1 * mixed_term;</span></div>
<div class="line"><span class="lineno">  730</span><span class="comment">//                 }</span></div>
<div class="line"><span class="lineno">  731</span><span class="comment">//                 Res_local[ i ] += (C_ns / 2.) * check_limits * (1. / s_frac) * OP_Hhalf * weight1 * phi1[i] * solX * mixed_term;</span></div>
<div class="line"><span class="lineno">  732</span><span class="comment">//               }</span></div>
<div class="line"><span class="lineno">  733</span><span class="comment">//             }</span></div>
<div class="line"><span class="lineno">  734</span><span class="comment">//             if(dim == 2 &amp;&amp; UNBOUNDED == 1) {</span></div>
<div class="line"><span class="lineno">  735</span><span class="comment">//               double ex[4] = {EX_1 - xg1[0], EX_2 - xg1[0], EY_1 - xg1[1], EY_2 - xg1[1]};</span></div>
<div class="line"><span class="lineno">  736</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  737</span><span class="comment">//               double teta[4], CCC[4];</span></div>
<div class="line"><span class="lineno">  738</span><span class="comment">//               teta[0] = atan2(ex[3], ex[1]);</span></div>
<div class="line"><span class="lineno">  739</span><span class="comment">//               teta[1] = atan2(ex[3], ex[0]);</span></div>
<div class="line"><span class="lineno">  740</span><span class="comment">//               teta[2] = atan2(ex[2], ex[0]) + 2 * M_PI;</span></div>
<div class="line"><span class="lineno">  741</span><span class="comment">//               teta[3] = atan2(ex[2], ex[1]) + 2 * M_PI;</span></div>
<div class="line"><span class="lineno">  742</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  743</span><span class="comment">//               double mixed_term = 0.;</span></div>
<div class="line"><span class="lineno">  744</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  745</span><span class="comment">//               for(unsigned qq = 0; qq &lt; 4; qq++) {</span></div>
<div class="line"><span class="lineno">  746</span><span class="comment">//                 if(qq == 3) teta[3] -= 2. * M_PI ;</span></div>
<div class="line"><span class="lineno">  747</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  748</span><span class="comment">//                 if(qq == 0)</span></div>
<div class="line"><span class="lineno">  749</span><span class="comment">//                   mixed_term += 2.* (Antiderivative1(teta[1], s_frac, ex[3]) -</span></div>
<div class="line"><span class="lineno">  750</span><span class="comment">//                                      Antiderivative1(teta[0], s_frac, ex[3]));</span></div>
<div class="line"><span class="lineno">  751</span><span class="comment">//                 else if(qq  == 2)</span></div>
<div class="line"><span class="lineno">  752</span><span class="comment">//                   mixed_term += 2.* (Antiderivative1(teta[3], s_frac, ex[2]) -</span></div>
<div class="line"><span class="lineno">  753</span><span class="comment">//                                      Antiderivative1(teta[2], s_frac, ex[2]));</span></div>
<div class="line"><span class="lineno">  754</span><span class="comment">//                 else if(qq  == 1)</span></div>
<div class="line"><span class="lineno">  755</span><span class="comment">//                   mixed_term += 2. * (Antiderivative2(teta[2], s_frac, ex[0]) -</span></div>
<div class="line"><span class="lineno">  756</span><span class="comment">//                                       Antiderivative2(teta[1], s_frac, ex[0]));</span></div>
<div class="line"><span class="lineno">  757</span><span class="comment">//                 else</span></div>
<div class="line"><span class="lineno">  758</span><span class="comment">//                   mixed_term += 2. * (Antiderivative2(teta[0], s_frac, ex[1]) -</span></div>
<div class="line"><span class="lineno">  759</span><span class="comment">//                                       Antiderivative2(teta[3], s_frac, ex[1]));</span></div>
<div class="line"><span class="lineno">  760</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  761</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  762</span><span class="comment">//               }</span></div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span><span class="comment">// //               if(iel == 0 &amp;&amp; ig == 4)   sum_int += mixed_term;</span></div>
<div class="line"><span class="lineno">  765</span><span class="comment">// //               std::cout&lt;&lt;&quot;sum_int = &quot; &lt;&lt; sum_int &lt;&lt; &quot;\n&quot;;</span></div>
<div class="line"><span class="lineno">  766</span> </div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span><span class="comment">//               for(unsigned i = 0; i &lt; nDof1; i++) {</span></div>
<div class="line"><span class="lineno">  769</span><span class="comment">//                 for(unsigned j = 0; j &lt; nDof1; j++) {</span></div>
<div class="line"><span class="lineno">  770</span><span class="comment">//                   KK_local[ i * nDof1 + j ] += (C_ns / 2.) * check_limits * OP_Hhalf * phi1[i] * phi1[j] * weight1 * mixed_term;</span></div>
<div class="line"><span class="lineno">  771</span><span class="comment">//                 }</span></div>
<div class="line"><span class="lineno">  772</span><span class="comment">//                 Res_local[ i ] += (C_ns / 2.) * check_limits * OP_Hhalf * weight1 * phi1[i] * solX * mixed_term;</span></div>
<div class="line"><span class="lineno">  773</span><span class="comment">//               }</span></div>
<div class="line"><span class="lineno">  774</span><span class="comment">//             }</span></div>
<div class="line"><span class="lineno">  775</span><span class="comment">//============  Mixed integral - Analytical ((Rn-Omega) x Omega) assembly (based on the analytic result of integrals) ==================</span></div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span><span class="comment">//============ Adaptive quadrature for iel == jel - BEGIN ==================</span></div>
<div class="line"><span class="lineno">  778</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> != 0) {</div>
<div class="line"><span class="lineno">  779</span>            <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a> != 0) {</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span>              std::cout.precision(14);</div>
<div class="line"><span class="lineno">  782</span>              std::vector&lt; std::vector&lt;std::vector&lt;double&gt;&gt;&gt; x3;</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> split = 0; split &lt;= <a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a>; split++) {</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span><span class="comment">//                 unsigned size_part;</span></div>
<div class="line"><span class="lineno">  787</span><span class="comment">//                 if(dim == 1) size_part = 2;</span></div>
<div class="line"><span class="lineno">  788</span><span class="comment">//                 else size_part = (split != Nsplit) ? 12 : 4;</span></div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 1) <a class="code hl_function" href="fractional__functions_8hpp.html#af057d335d5ff979f59d72742fed6f683">GetElementPartition1D</a>(xg1, x1, split, <a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a>, x3, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  791</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 2) {</div>
<div class="line"><span class="lineno">  792</span>                  <span class="comment">//GetElementPartition2D(xg1, x1, split, Nsplit, x3);</span></div>
<div class="line"><span class="lineno">  793</span>                  <a class="code hl_function" href="fractional__functions_8hpp.html#a8495a4922fe3179f6db210e024338ba4">GetElementPartitionQuad</a>(xg1, x1, split, <a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a>, x3);</div>
<div class="line"><span class="lineno">  794</span>                }</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>                <span class="comment">//for(unsigned r = 0; r &lt; size_part; r++) {</span></div>
<div class="line"><span class="lineno">  797</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> r = 0; r &lt; x3.size(); r++) {</div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jg = 0; jg &lt; igNumber; jg++) {</div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>                    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom1][solType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x3[r], jg, weight3, phi3, phi_x);</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>                    vector &lt; double &gt; xg3(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  808</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  809</span>                        xg3[k] += x3[r][k][i] * phi3[i];</div>
<div class="line"><span class="lineno">  810</span>                      }</div>
<div class="line"><span class="lineno">  811</span>                    }</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>                    std::vector&lt;double&gt; xi3(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>                    <a class="code hl_function" href="namespacefemus.html#a26952845941ad3ab68f35f0dc647e464">GetClosestPointInReferenceElement</a>(x1, xg3, ielGeom1, xi3);</div>
<div class="line"><span class="lineno">  816</span>                    <a class="code hl_function" href="namespacefemus.html#a434f4672190f9d15cbc5e65705836bda">GetInverseMapping</a>(solType, ielGeom1, aP, xg3, xi3, 1000);</div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>                    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom1][solType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#af9c2379b41e7c7228229d82968959b23">GetPhi</a>(phi3, xi3);</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>                    <span class="keywordtype">double</span> solY3 = 0.;</div>
<div class="line"><span class="lineno">  821</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  822</span>                      solY3 += solu1[i] * phi3[i];</div>
<div class="line"><span class="lineno">  823</span>                    }</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span><span class="comment">// ********* BOUNDED PART - BEGIN ***************</span></div>
<div class="line"><span class="lineno">  826</span>                    <span class="keywordtype">double</span> dist_xyz3 = 0;</div>
<div class="line"><span class="lineno">  827</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  828</span>                      dist_xyz3 += (xg1[k] - xg3[k]) * (xg1[k] - xg3[k]);</div>
<div class="line"><span class="lineno">  829</span>                    }</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>                    <span class="keyword">const</span> <span class="keywordtype">double</span> denom3 = pow(dist_xyz3, (<span class="keywordtype">double</span>)((<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> / 2.) + s_frac));</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>                      Res_local_refined[ i ]    +=      - (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * check_limits *</div>
<div class="line"><span class="lineno">  836</span>                                                        ((solX - solY3) * (phi1[i] - phi3[i]) * weight3 / denom3</div>
<div class="line"><span class="lineno">  837</span>                                                        ) * weight1 ;</div>
<div class="line"><span class="lineno">  838</span> </div>
<div class="line"><span class="lineno">  839</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  840</span>                        CClocal_refined[ i * nDof2 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] += (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * check_limits *</div>
<div class="line"><span class="lineno">  841</span>                                                            ((phi1[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - phi3[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * (phi1[i] - phi3[i]) * weight3 / denom3</div>
<div class="line"><span class="lineno">  842</span>                                                            ) * weight1 ;</div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span>                      }</div>
<div class="line"><span class="lineno">  845</span>                    }</div>
<div class="line"><span class="lineno">  846</span><span class="comment">// ********* BOUNDED PART - END ***************</span></div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span><span class="comment">// ********* UNBOUNDED PART - BEGIN ***************</span></div>
<div class="line"><span class="lineno">  849</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> == 0) { </div>
<div class="line"><span class="lineno">  850</span>              <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#af17df4d5d5bad0ea1d48fa796a91d4ce">UNBOUNDED</a> == 1) {</div>
<div class="line"><span class="lineno">  851</span><span class="comment">//============ Mixed integral 1D - Analytical ==================</span></div>
<div class="line"><span class="lineno">  852</span>                <span class="keywordflow">if</span>(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 1) {</div>
<div class="line"><span class="lineno">  853</span>                  <span class="keywordtype">double</span> ex_1 = <a class="code hl_define" href="07__fractional_8cpp.html#a249cc0a8805d02135da257cb5bcdd4c6">EX_1</a>;</div>
<div class="line"><span class="lineno">  854</span>                  <span class="keywordtype">double</span> ex_2 = <a class="code hl_define" href="07__fractional_8cpp.html#aec14a389f0ca0850c6e3f8335469a059">EX_2</a>;</div>
<div class="line"><span class="lineno">  855</span>                  <span class="keywordtype">double</span> dist_1 = 0.;</div>
<div class="line"><span class="lineno">  856</span>                  <span class="keywordtype">double</span> dist_2 = 0.;</div>
<div class="line"><span class="lineno">  857</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  858</span>                    dist_1 += sqrt((xg3[k] - ex_1) * (xg3[k] - ex_1));</div>
<div class="line"><span class="lineno">  859</span>                    dist_2 += sqrt((xg3[k] - ex_2) * (xg3[k] - ex_2));</div>
<div class="line"><span class="lineno">  860</span>                  }</div>
<div class="line"><span class="lineno">  861</span>                  <span class="keywordtype">double</span> mixed_term = (pow(dist_1, -2. * s_frac) + pow(dist_2, - 2. * s_frac)) * (1. / s_frac) ;</div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  864</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof1; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  865</span>                      KK_local[ i * nDof1 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] +=   (C_ns / 2.) * check_limits * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight3 * phi3[i] * phi3[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * mixed_term;</div>
<div class="line"><span class="lineno">  866</span>                    }</div>
<div class="line"><span class="lineno">  867</span>                                 Res_local[ i ] += - (C_ns / 2.) * check_limits * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight3 * phi3[i] * solY3 * mixed_term;</div>
<div class="line"><span class="lineno">  868</span>                  }</div>
<div class="line"><span class="lineno">  869</span>                }</div>
<div class="line"><span class="lineno">  870</span><span class="comment">//============ Mixed integral 1D - Analytical ==================</span></div>
<div class="line"><span class="lineno">  871</span><span class="comment">//============ Mixed Integral 2D - Numerical ==================</span></div>
<div class="line"><span class="lineno">  872</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 2) {</div>
<div class="line"><span class="lineno">  873</span>                  <span class="keywordtype">double</span> mixed_term1 = 0;</div>
<div class="line"><span class="lineno">  874</span><span class="comment">//     for(int kel = msh-&gt;_elementOffset[iproc]; kel &lt; msh-&gt;_elementOffset[iproc + 1]; kel++) {</span></div>
<div class="line"><span class="lineno">  875</span>            <span class="comment">// *** Face Gauss point loop (boundary Integral) ***</span></div>
<div class="line"><span class="lineno">  876</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jj = 0; jj &lt; bd_face.size(); jj++) {</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>                    <span class="keywordtype">int</span> jface = bd_face[jj];</div>
<div class="line"><span class="lineno">  879</span>                    </div>
<div class="line"><span class="lineno">  880</span>                    <span class="comment">// look for boundary faces</span></div>
<div class="line"><span class="lineno">  881</span>                    <span class="keywordtype">unsigned</span> faceDofs = el-&gt;<a class="code hl_function" href="classfemus_1_1elem.html#add93a6ef1b8c8c3ca75b77c5ba9b5c01">GetNFACENODES</a>(ielGeom2, jface, solType);</div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>                    vector  &lt; vector  &lt;  double&gt; &gt; faceCoordinates(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);    <span class="comment">// A matrix holding the face coordinates rowwise.</span></div>
<div class="line"><span class="lineno">  885</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  886</span>                      faceCoordinates[k].resize(faceDofs);</div>
<div class="line"><span class="lineno">  887</span>                    }</div>
<div class="line"><span class="lineno">  888</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; faceDofs; i++) {</div>
<div class="line"><span class="lineno">  889</span>                      <span class="keywordtype">unsigned</span> inode = el-&gt;<a class="code hl_function" href="classfemus_1_1elem.html#a9b4bb98c0365d283a502ed4dc3c43db7">GetIG</a>(ielGeom2, jface, i);  <span class="comment">// face-to-element local node mapping.</span></div>
<div class="line"><span class="lineno">  890</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  891</span>                        faceCoordinates[k][i] =  x2[k][inode] - xg3[k]; <span class="comment">// We extract the local coordinates on the face from local coordinates on the element.</span></div>
<div class="line"><span class="lineno">  892</span>                      }</div>
<div class="line"><span class="lineno">  893</span>                    }</div>
<div class="line"><span class="lineno">  894</span>                    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> div = <a class="code hl_define" href="07__fractional_8cpp.html#a2127932b519fbf2a043dac81759ce444">N_DIV_FACE_OF_FACE_FOR_UNBOUNDED_INTEGRAL</a>;</div>
<div class="line"><span class="lineno">  895</span>                    vector  &lt; vector  &lt;  double&gt; &gt; interpCoordinates(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  896</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  897</span>                      interpCoordinates[k].resize(div + 1); <span class="comment">// set &quot;4&quot; as a parameter</span></div>
<div class="line"><span class="lineno">  898</span>                    }</div>
<div class="line"><span class="lineno">  899</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n = 0; n &lt;= div; n++) {</div>
<div class="line"><span class="lineno">  900</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  901</span>                        interpCoordinates[k][n] = faceCoordinates[k][0] + n * (faceCoordinates[k][1] - faceCoordinates[k][0]) /  div ;</div>
<div class="line"><span class="lineno">  902</span>                      }</div>
<div class="line"><span class="lineno">  903</span>                    }</div>
<div class="line"><span class="lineno">  904</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n = 0; n &lt; div; n++) {</div>
<div class="line"><span class="lineno">  905</span>                      <span class="keywordtype">double</span> teta2 = atan2(interpCoordinates[1][n + 1], interpCoordinates[0][n + 1]);</div>
<div class="line"><span class="lineno">  906</span>                      <span class="keywordtype">double</span> teta1 = atan2(interpCoordinates[1][n], interpCoordinates[0][n]);</div>
<div class="line"><span class="lineno">  907</span> </div>
<div class="line"><span class="lineno">  908</span>                      <span class="keywordflow">if</span>(teta2 &lt; teta1) teta2 += 2. * M_PI;</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>                      <span class="keywordtype">double</span> delta_teta = teta2 - teta1;</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span> </div>
<div class="line"><span class="lineno">  913</span>                      vector &lt;double&gt; mid_point;</div>
<div class="line"><span class="lineno">  914</span>                      mid_point.resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  915</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  916</span>                        mid_point[k] = (interpCoordinates[k][n + 1] + interpCoordinates[k][n]) * 0.5;</div>
<div class="line"><span class="lineno">  917</span>                      }</div>
<div class="line"><span class="lineno">  918</span>                      <span class="keywordtype">double</span> dist2 = 0;</div>
<div class="line"><span class="lineno">  919</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  920</span>                        dist2 += mid_point[k] * mid_point[k];</div>
<div class="line"><span class="lineno">  921</span>                      }</div>
<div class="line"><span class="lineno">  922</span>                      <span class="keywordtype">double</span> dist = sqrt(dist2);</div>
<div class="line"><span class="lineno">  923</span>                      mixed_term1 += 2. * pow(dist, -  2. * s_frac) * (1. / (2. * s_frac)) * delta_teta;</div>
<div class="line"><span class="lineno">  924</span>                    }</div>
<div class="line"><span class="lineno">  925</span>                  }</div>
<div class="line"><span class="lineno">  926</span> </div>
<div class="line"><span class="lineno">  927</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  928</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof1; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  929</span>                      KK_local_mixed_num[ i * nDof1 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] +=   (C_ns / 2.) * check_limits * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight3 * phi3[i] * phi3[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * mixed_term1;</div>
<div class="line"><span class="lineno">  930</span>                    }</div>
<div class="line"><span class="lineno">  931</span>                                 Res_local_mixed_num[ i ] += - (C_ns / 2.) * check_limits * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight3 * phi3[i] * solX * mixed_term1;</div>
<div class="line"><span class="lineno">  932</span>                  }</div>
<div class="line"><span class="lineno">  933</span>                }</div>
<div class="line"><span class="lineno">  934</span><span class="comment">//============ Mixed Integral 2D - Numerical ==================</span></div>
<div class="line"><span class="lineno">  935</span>             } <span class="comment">//end unbounded</span></div>
<div class="line"><span class="lineno">  936</span>            } <span class="comment">//end ig == 0</span></div>
<div class="line"><span class="lineno">  937</span><span class="comment">// ********* UNBOUNDED PART - END ***************</span></div>
<div class="line"><span class="lineno">  938</span>              </div>
<div class="line"><span class="lineno">  939</span>            } <span class="comment">//end jg</span></div>
<div class="line"><span class="lineno">  940</span>          } <span class="comment">//end r</span></div>
<div class="line"><span class="lineno">  941</span>        }  <span class="comment">//end split</span></div>
<div class="line"><span class="lineno">  942</span>              }  <span class="comment">//end if Nsplit != 0</span></div>
<div class="line"><span class="lineno">  943</span>            }  <span class="comment">//end  OP_Hhalf != 0</span></div>
<div class="line"><span class="lineno">  944</span><span class="comment">//============ Adaptive quadrature for iel == jel - END ==================</span></div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>    } <span class="comment">// end iel == jel loop</span></div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>      <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> != 0) {</div>
<div class="line"><span class="lineno">  950</span>          <span class="keywordflow">if</span>(iel != jel || <a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a> == 0) {</div>
<div class="line"><span class="lineno">  951</span>            </div>
<div class="line"><span class="lineno">  952</span><span class="comment">// ********* UNBOUNDED PART - BEGIN ***************</span></div>
<div class="line"><span class="lineno">  953</span>          <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#af17df4d5d5bad0ea1d48fa796a91d4ce">UNBOUNDED</a> == 1 <span class="comment">/*&amp;&amp; iel == jel*/</span>) {</div>
<div class="line"><span class="lineno">  954</span>    <span class="comment">//============  Mixed integral 1D - Analytical  ==================</span></div>
<div class="line"><span class="lineno">  955</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 1 &amp;&amp; iel == jel) {</div>
<div class="line"><span class="lineno">  956</span>              <span class="keywordtype">double</span> ex_1 = <a class="code hl_define" href="07__fractional_8cpp.html#a249cc0a8805d02135da257cb5bcdd4c6">EX_1</a>;</div>
<div class="line"><span class="lineno">  957</span>              <span class="keywordtype">double</span> ex_2 = <a class="code hl_define" href="07__fractional_8cpp.html#aec14a389f0ca0850c6e3f8335469a059">EX_2</a>;</div>
<div class="line"><span class="lineno">  958</span>              <span class="keywordtype">double</span> dist_1 = 0.;</div>
<div class="line"><span class="lineno">  959</span>              <span class="keywordtype">double</span> dist_2 = 0.;</div>
<div class="line"><span class="lineno">  960</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  961</span>                dist_1 += sqrt((xg1[k] - ex_1) * (xg1[k] - ex_1));</div>
<div class="line"><span class="lineno">  962</span>                dist_2 += sqrt((xg1[k] - ex_2) * (xg1[k] - ex_2));</div>
<div class="line"><span class="lineno">  963</span>              }</div>
<div class="line"><span class="lineno">  964</span>              <span class="keywordtype">double</span> mixed_term = pow(dist_1, -2. * s_frac) + pow(dist_2, - 2. * s_frac);</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno">  967</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof1; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  968</span>                  KK_local[ i * nDof1 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] +=   (C_ns / 2.) * check_limits * (1. / s_frac) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight1 * phi1[i] * phi1[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * mixed_term;</div>
<div class="line"><span class="lineno">  969</span>                }</div>
<div class="line"><span class="lineno">  970</span>                             Res_local[ i ] += - (C_ns / 2.) * check_limits * (1. / s_frac) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight1 * phi1[i] * solX * mixed_term;</div>
<div class="line"><span class="lineno">  971</span>              }</div>
<div class="line"><span class="lineno">  972</span>            }</div>
<div class="line"><span class="lineno">  973</span>    <span class="comment">//============  Mixed integral 1D - Analytical ==================        </span></div>
<div class="line"><span class="lineno">  974</span>    </div>
<div class="line"><span class="lineno">  975</span>    <span class="comment">//============ Mixed Integral 2D - Numerical ==================      </span></div>
<div class="line"><span class="lineno">  976</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span>( <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> == 2 ) {</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>            <span class="keywordtype">double</span> mixed_term1 = 0;</div>
<div class="line"><span class="lineno">  979</span><span class="comment">//     for(int kel = msh-&gt;_elementOffset[iproc]; kel &lt; msh-&gt;_elementOffset[iproc + 1]; kel++) {</span></div>
<div class="line"><span class="lineno">  980</span>            <span class="comment">// *** Face Gauss point loop (boundary Integral) ***</span></div>
<div class="line"><span class="lineno">  981</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jj = 0; jj &lt; bd_face.size(); jj++) {</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>              <span class="keywordtype">int</span> jface = bd_face[jj];</div>
<div class="line"><span class="lineno">  984</span>              <span class="comment">// look for boundary faces</span></div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span>              <span class="keywordtype">unsigned</span> faceDofs = el-&gt;<a class="code hl_function" href="classfemus_1_1elem.html#add93a6ef1b8c8c3ca75b77c5ba9b5c01">GetNFACENODES</a>(ielGeom2, jface, solType);</div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>              vector  &lt; vector  &lt;  double&gt; &gt; faceCoordinates(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);    <span class="comment">// A matrix holding the face coordinates rowwise.</span></div>
<div class="line"><span class="lineno">  989</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  990</span>                faceCoordinates[k].resize(faceDofs);</div>
<div class="line"><span class="lineno">  991</span>              }</div>
<div class="line"><span class="lineno">  992</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; faceDofs; i++) {</div>
<div class="line"><span class="lineno">  993</span>                <span class="keywordtype">unsigned</span> inode = el-&gt;<a class="code hl_function" href="classfemus_1_1elem.html#a9b4bb98c0365d283a502ed4dc3c43db7">GetIG</a>(ielGeom2, jface, i);  <span class="comment">// face-to-element local node mapping.</span></div>
<div class="line"><span class="lineno">  994</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  995</span>                  faceCoordinates[k][i] =  x2[k][inode] - xg1[k];  <span class="comment">// We extract the local coordinates on the face from local coordinates on the element.</span></div>
<div class="line"><span class="lineno">  996</span>                }</div>
<div class="line"><span class="lineno">  997</span>              }</div>
<div class="line"><span class="lineno">  998</span>              </div>
<div class="line"><span class="lineno">  999</span>              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> div = <a class="code hl_define" href="07__fractional_8cpp.html#a2127932b519fbf2a043dac81759ce444">N_DIV_FACE_OF_FACE_FOR_UNBOUNDED_INTEGRAL</a>;</div>
<div class="line"><span class="lineno"> 1000</span>              vector  &lt; vector  &lt;  double&gt; &gt; interpCoordinates(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1001</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1002</span>                interpCoordinates[k].resize(div + 1); <span class="comment">// set &quot;4&quot; as a parameter</span></div>
<div class="line"><span class="lineno"> 1003</span>              }</div>
<div class="line"><span class="lineno"> 1004</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n = 0; n &lt;= div; n++) {</div>
<div class="line"><span class="lineno"> 1005</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1006</span>                  interpCoordinates[k][n] = faceCoordinates[k][0] + n * (faceCoordinates[k][1] - faceCoordinates[k][0]) /  div ;</div>
<div class="line"><span class="lineno"> 1007</span>                }</div>
<div class="line"><span class="lineno"> 1008</span>              }</div>
<div class="line"><span class="lineno"> 1009</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> n = 0; n &lt; div; n++) {</div>
<div class="line"><span class="lineno"> 1010</span>                <span class="keywordtype">double</span> teta2 = atan2(interpCoordinates[1][n + 1], interpCoordinates[0][n + 1]);</div>
<div class="line"><span class="lineno"> 1011</span>                <span class="keywordtype">double</span> teta1 = atan2(interpCoordinates[1][n], interpCoordinates[0][n]);</div>
<div class="line"><span class="lineno"> 1012</span>                </div>
<div class="line"><span class="lineno"> 1013</span>                <span class="keywordflow">if</span>(teta2 &lt; teta1) teta2 += 2. * M_PI;</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>                <span class="keywordtype">double</span> delta_teta = teta2 - teta1;</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>                vector &lt;double&gt; mid_point;</div>
<div class="line"><span class="lineno"> 1018</span>                mid_point.resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1019</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1020</span>                  mid_point[k] = (interpCoordinates[k][n + 1] + interpCoordinates[k][n]) * 0.5;</div>
<div class="line"><span class="lineno"> 1021</span>                }</div>
<div class="line"><span class="lineno"> 1022</span>                <span class="keywordtype">double</span> dist2 = 0;</div>
<div class="line"><span class="lineno"> 1023</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1024</span>                  dist2 += mid_point[k] * mid_point[k];</div>
<div class="line"><span class="lineno"> 1025</span>                }</div>
<div class="line"><span class="lineno"> 1026</span>                <span class="keywordtype">double</span> dist = sqrt(dist2);</div>
<div class="line"><span class="lineno"> 1027</span>                mixed_term1 += 2. * pow(dist, -  2. * s_frac) * (1. / (2. * s_frac)) * delta_teta;</div>
<div class="line"><span class="lineno"> 1028</span>              }</div>
<div class="line"><span class="lineno"> 1029</span>            }</div>
<div class="line"><span class="lineno"> 1030</span> </div>
<div class="line"><span class="lineno"> 1031</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno"> 1032</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof1; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1033</span>                KK_local_mixed_num[ i * nDof1 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] +=  (C_ns / 2.) * check_limits * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight1 * phi1[i] * phi1[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * mixed_term1;</div>
<div class="line"><span class="lineno"> 1034</span>              }</div>
<div class="line"><span class="lineno"> 1035</span>              </div>
<div class="line"><span class="lineno"> 1036</span>              Res_local_mixed_num[ i ] += - (C_ns / 2.) * check_limits * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * weight1 * phi1[i] * solX * mixed_term1;</div>
<div class="line"><span class="lineno"> 1037</span>            }</div>
<div class="line"><span class="lineno"> 1038</span>           }</div>
<div class="line"><span class="lineno"> 1039</span><span class="comment">//============ Mixed Integral - Numerical ==================</span></div>
<div class="line"><span class="lineno"> 1040</span>         }</div>
<div class="line"><span class="lineno"> 1041</span><span class="comment">// ********* UNBOUNDED PART - END ***************</span></div>
<div class="line"><span class="lineno"> 1042</span> </div>
<div class="line"><span class="lineno"> 1043</span>             </div>
<div class="line"><span class="lineno"> 1044</span><span class="comment">// ********* BOUNDED PART - BEGIN ***************</span></div>
<div class="line"><span class="lineno"> 1045</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jg = 0; jg &lt; jgNumber; jg++) {</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>              <span class="keywordtype">double</span> dist_xyz = 0.;</div>
<div class="line"><span class="lineno"> 1048</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1049</span>                dist_xyz += (xg1[k] - xg2[jg][k]) * (xg1[k] - xg2[jg][k]);</div>
<div class="line"><span class="lineno"> 1050</span>              }</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>              <span class="keyword">const</span> <span class="keywordtype">double</span> denom = pow(dist_xyz, (<span class="keywordtype">double</span>)((<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> / 2.) + s_frac));</div>
<div class="line"><span class="lineno"> 1053</span>              </div>
<div class="line"><span class="lineno"> 1054</span>              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno"> 1055</span> </div>
<div class="line"><span class="lineno"> 1056</span>                Res_nonlocalI[ i ]         +=      - (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> *  check_limits * (solX - solY[jg]) * (phi1[i]) * weight1 * weight2[jg]  / denom;</div>
<div class="line"><span class="lineno"> 1057</span> </div>
<div class="line"><span class="lineno"> 1058</span>                Res_nonlocalJ[ i ]         +=      - (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> *  check_limits * (solX - solY[jg]) * (- phi2[jg][i]) * weight1 * weight2[jg]  / denom;</div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>                  CC_nonlocal_II[ i * nDof2 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] += (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * check_limits * phi1[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]  * phi1[i] * weight1 * weight2[jg] / denom;</div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>                  CC_nonlocal_IJ[ i * nDof2 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] += (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * check_limits * (- phi2[jg][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * phi1[i] * weight1 * weight2[jg] / denom;</div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>                  CC_nonlocal_JI[ i * nDof2 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] += (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * check_limits * (phi1[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * (- phi2[jg][i]) * weight1 * weight2[jg] / denom;</div>
<div class="line"><span class="lineno"> 1067</span> </div>
<div class="line"><span class="lineno"> 1068</span>                  CC_nonlocal_JJ[ i * nDof2 + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ] += (C_ns / 2.) * <a class="code hl_define" href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a> * check_limits * (- phi2[jg][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) * (- phi2[jg][i]) * weight1 * weight2[jg] / denom;</div>
<div class="line"><span class="lineno"> 1069</span> </div>
<div class="line"><span class="lineno"> 1070</span>                  }</div>
<div class="line"><span class="lineno"> 1071</span>                }</div>
<div class="line"><span class="lineno"> 1072</span>              } <span class="comment">//endl jg loop</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="comment">// ********* BOUNDED PART - END ***************</span></div>
<div class="line"><span class="lineno"> 1074</span> </div>
<div class="line"><span class="lineno"> 1075</span>            } <span class="comment">//end if(iel != jel || Nsplit == 0)</span></div>
<div class="line"><span class="lineno"> 1076</span>          } </div>
<div class="line"><span class="lineno"> 1077</span>          </div>
<div class="line"><span class="lineno"> 1078</span>        } <span class="comment">//endl ig loop</span></div>
<div class="line"><span class="lineno"> 1079</span>        </div>
<div class="line"><span class="lineno"> 1080</span><span class="comment">//         std::vector&lt;unsigned&gt; Sol_n_el_dofs_Mat_vol2(1, 9);</span></div>
<div class="line"><span class="lineno"> 1081</span><span class="comment">//          assemble_jacobian&lt;double,double&gt;::print_element_residual(iel, Res, Sol_n_el_dofs_Mat_vol, 10, 5);</span></div>
<div class="line"><span class="lineno"> 1082</span><span class="comment">//          assemble_jacobian&lt;double,double&gt;::print_element_jacobian(iel, KK_local_mixed_num, Sol_n_el_dofs_Mat_vol2, 10, 10);</span></div>
<div class="line"><span class="lineno"> 1083</span> </div>
<div class="line"><span class="lineno"> 1084</span>        <span class="keywordflow">if</span>(iel == jel) {</div>
<div class="line"><span class="lineno"> 1085</span>          <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(KK_local, l2GMap1, l2GMap1);</div>
<div class="line"><span class="lineno"> 1086</span>          RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_local, l2GMap1);</div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>          <span class="keywordflow">if</span>(<a class="code hl_define" href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a> != 0) {</div>
<div class="line"><span class="lineno"> 1089</span>            <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(CClocal_refined, l2GMap1, l2GMap1);</div>
<div class="line"><span class="lineno"> 1090</span>            RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_local_refined, l2GMap1);</div>
<div class="line"><span class="lineno"> 1091</span>          }</div>
<div class="line"><span class="lineno"> 1092</span>        }</div>
<div class="line"><span class="lineno"> 1093</span><span class="comment">//        KK-&gt;add_matrix_blocked(CClocal, l2GMap1, l2GMap2);</span></div>
<div class="line"><span class="lineno"> 1094</span>        <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(KK_local_mixed_num, l2GMap1, l2GMap1);</div>
<div class="line"><span class="lineno"> 1095</span>        RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_local_mixed_num, l2GMap1);</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>        <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(CC_nonlocal_II, l2GMap1, l2GMap1);</div>
<div class="line"><span class="lineno"> 1098</span>        <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(CC_nonlocal_IJ, l2GMap1, l2GMap2);</div>
<div class="line"><span class="lineno"> 1099</span>        <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(CC_nonlocal_JI, l2GMap2, l2GMap1);</div>
<div class="line"><span class="lineno"> 1100</span>        <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked(CC_nonlocal_JJ, l2GMap2, l2GMap2);</div>
<div class="line"><span class="lineno"> 1101</span> </div>
<div class="line"><span class="lineno"> 1102</span><span class="comment">//        RES-&gt;add_vector_blocked(Res_nonlocal, l2GMap1);</span></div>
<div class="line"><span class="lineno"> 1103</span>        RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_nonlocalI, l2GMap1);</div>
<div class="line"><span class="lineno"> 1104</span>        RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_nonlocalJ, l2GMap2);</div>
<div class="line"><span class="lineno"> 1105</span>        </div>
<div class="line"><span class="lineno"> 1106</span>      } <span class="comment">// end iel loop</span></div>
<div class="line"><span class="lineno"> 1107</span> </div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>    } <span class="comment">//end jel loop</span></div>
<div class="line"><span class="lineno"> 1110</span>  } <span class="comment">//end kproc loop</span></div>
<div class="line"><span class="lineno"> 1111</span> </div>
<div class="line"><span class="lineno"> 1112</span>  <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;close();</div>
<div class="line"><span class="lineno"> 1113</span>  RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span><span class="comment">//--- print matrix on file</span></div>
<div class="line"><span class="lineno"> 1116</span>  <span class="comment">//this shows that the matrix is full, because each row has all columns (see the output file)</span></div>
<div class="line"><span class="lineno"> 1117</span><span class="keyword">const</span> <span class="keywordtype">unsigned</span> nonlin_iter = 0<span class="comment">/*mlPdeSys-&gt;GetNonlinearIt()*/</span>;</div>
<div class="line"><span class="lineno"> 1118</span>    <a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a0504cb0eca4695ba727b5823cca30369">assemble_jacobian&lt; double, double &gt;::print_global_jacobian</a>(<span class="comment">/*assemble_matrix*/</span><span class="keyword">true</span>, ml_prob, <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>, nonlin_iter);</div>
<div class="line"><span class="lineno"> 1119</span><span class="comment">//     assemble_jacobian&lt; double, double &gt;::print_global_residual(ml_prob, RES, nonlin_iter);</span></div>
<div class="line"><span class="lineno"> 1120</span>    std::ostringstream res_out; res_out &lt;&lt; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a274e91e352c0d6b69c5925fdfca67d1f">GetFilesHandler</a>()-&gt;<a class="code hl_function" href="classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>() &lt;&lt; <span class="stringliteral">&quot;./&quot;</span> &lt;&lt; <span class="stringliteral">&quot;res_&quot;</span> &lt;&lt; mlPdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_non_linear_implicit_system.html#a036abf737ef5a4dcfa1d26db3bc35bca">GetNonlinearIt</a>()  &lt;&lt; <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><span class="lineno"> 1121</span>    pdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_linear_equation.html#a0f0ff6417d3a09a1c28c3d803ec9d885">print_with_structure_matlab_friendly</a>(iproc, res_out.str().c_str(), RES);</div>
<div class="line"><span class="lineno"> 1122</span><span class="comment">//--- print matrix on file</span></div>
<div class="line"><span class="lineno"> 1123</span> </div>
<div class="line"><span class="lineno"> 1124</span> </div>
<div class="line"><span class="lineno"> 1125</span><span class="comment">//   PetscViewer    viewer;</span></div>
<div class="line"><span class="lineno"> 1126</span><span class="comment">//   PetscViewerDrawOpen(PETSC_COMM_WORLD, NULL, NULL, 0, 0, 900, 900, &amp;viewer);</span></div>
<div class="line"><span class="lineno"> 1127</span><span class="comment">//   PetscObjectSetName((PetscObject)viewer, &quot;FSI matrix&quot;);</span></div>
<div class="line"><span class="lineno"> 1128</span><span class="comment">//   PetscViewerPushFormat(viewer, PETSC_VIEWER_DRAW_LG);</span></div>
<div class="line"><span class="lineno"> 1129</span><span class="comment">//   MatView((static_cast&lt;PetscMatrix*&gt;(KK))-&gt;mat(), viewer);</span></div>
<div class="line"><span class="lineno"> 1130</span><span class="comment">// //   MatView((static_cast&lt;PetscMatrix*&gt; (KK))-&gt;mat(),  PETSC_VIEWER_STDOUT_WORLD );</span></div>
<div class="line"><span class="lineno"> 1131</span><span class="comment">//   double a;</span></div>
<div class="line"><span class="lineno"> 1132</span><span class="comment">//   std::cin &gt;&gt; a;</span></div>
<div class="line"><span class="lineno"> 1133</span> </div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span><span class="comment">//     PetscViewer    viewer;</span></div>
<div class="line"><span class="lineno"> 1136</span><span class="comment">//   PetscViewerDrawOpen(PETSC_COMM_WORLD,NULL,NULL,0,0,900,900,&amp;viewer);</span></div>
<div class="line"><span class="lineno"> 1137</span><span class="comment">//   PetscObjectSetName((PetscObject)viewer,&quot;FSI matrix&quot;);</span></div>
<div class="line"><span class="lineno"> 1138</span><span class="comment">//   PetscViewerPushFormat(viewer,PETSC_VIEWER_DRAW_LG);</span></div>
<div class="line"><span class="lineno"> 1139</span><span class="comment">//   MatView((static_cast&lt;PetscMatrix*&gt; (KK))-&gt;mat(),viewer);</span></div>
<div class="line"><span class="lineno"> 1140</span><span class="comment">// //   MatView((static_cast&lt;PetscMatrix*&gt; (KK))-&gt;mat(),  PETSC_VIEWER_STDOUT_WORLD );</span></div>
<div class="line"><span class="lineno"> 1141</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1142</span><span class="comment">//   VecView((static_cast&lt;PetscVector*&gt; (RES))-&gt;vec(),  PETSC_VIEWER_STDOUT_WORLD );</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="comment">//   double a;</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="comment">//   std::cin&gt;&gt;a;</span></div>
<div class="line"><span class="lineno"> 1145</span> </div>
<div class="line"><span class="lineno"> 1146</span>  <span class="comment">// ***************** END ASSEMBLY *******************</span></div>
<div class="line"><span class="lineno"> 1147</span>}</div>
<div class="ttc" id="a07__fractional_8cpp_html_a120d118c3e901df3fd09add0c10ad91f"><div class="ttname"><a href="07__fractional_8cpp.html#a120d118c3e901df3fd09add0c10ad91f">N_UNIFORM_LEVELS</a></div><div class="ttdeci">#define N_UNIFORM_LEVELS</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00026">07_fractional.cpp:26</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a2127932b519fbf2a043dac81759ce444"><div class="ttname"><a href="07__fractional_8cpp.html#a2127932b519fbf2a043dac81759ce444">N_DIV_FACE_OF_FACE_FOR_UNBOUNDED_INTEGRAL</a></div><div class="ttdeci">#define N_DIV_FACE_OF_FACE_FOR_UNBOUNDED_INTEGRAL</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00062">07_fractional.cpp:62</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a249cc0a8805d02135da257cb5bcdd4c6"><div class="ttname"><a href="07__fractional_8cpp.html#a249cc0a8805d02135da257cb5bcdd4c6">EX_1</a></div><div class="ttdeci">#define EX_1</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00046">07_fractional.cpp:46</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a2b20da92637cd95fc41f37f3b0823724"><div class="ttname"><a href="07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a></div><div class="ttdeci">#define OP_H1</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00036">07_fractional.cpp:36</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a3c634d703dcf88c5b98f854de3c0b0ff"><div class="ttname"><a href="07__fractional_8cpp.html#a3c634d703dcf88c5b98f854de3c0b0ff">Nsplit</a></div><div class="ttdeci">#define Nsplit</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00060">07_fractional.cpp:60</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a6cf2919927f47ad5f49ed95eaef8add9"><div class="ttname"><a href="07__fractional_8cpp.html#a6cf2919927f47ad5f49ed95eaef8add9">N_ERASED_LEVELS</a></div><div class="ttdeci">#define N_ERASED_LEVELS</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00027">07_fractional.cpp:27</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a77fcfcb56b6df13876acd5f0336aada0"><div class="ttname"><a href="07__fractional_8cpp.html#a77fcfcb56b6df13876acd5f0336aada0">USE_Cns</a></div><div class="ttdeci">#define USE_Cns</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00041">07_fractional.cpp:41</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a7eb16be80e7f4c50bdf6f65e04b310ff"><div class="ttname"><a href="07__fractional_8cpp.html#a7eb16be80e7f4c50bdf6f65e04b310ff">S_FRAC</a></div><div class="ttdeci">#define S_FRAC</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00033">07_fractional.cpp:33</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a7eb5589fe79c9c11abbbb2a2a52d0ba7"><div class="ttname"><a href="07__fractional_8cpp.html#a7eb5589fe79c9c11abbbb2a2a52d0ba7">RHS_ONE</a></div><div class="ttdeci">#define RHS_ONE</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00031">07_fractional.cpp:31</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_aab33c985fc96acde267a7bf1a54b0a1e"><div class="ttname"><a href="07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a></div><div class="ttdeci">#define OP_L2</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00035">07_fractional.cpp:35</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_ac040470a806bb6f4f879015d8f04fd61"><div class="ttname"><a href="07__fractional_8cpp.html#ac040470a806bb6f4f879015d8f04fd61">OP_Hhalf</a></div><div class="ttdeci">#define OP_Hhalf</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00037">07_fractional.cpp:37</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_aec14a389f0ca0850c6e3f8335469a059"><div class="ttname"><a href="07__fractional_8cpp.html#aec14a389f0ca0850c6e3f8335469a059">EX_2</a></div><div class="ttdeci">#define EX_2</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00047">07_fractional.cpp:47</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_af17df4d5d5bad0ea1d48fa796a91d4ce"><div class="ttname"><a href="07__fractional_8cpp.html#af17df4d5d5bad0ea1d48fa796a91d4ce">UNBOUNDED</a></div><div class="ttdeci">#define UNBOUNDED</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00039">07_fractional.cpp:39</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a></div><div class="ttdeci">@ KK</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_s_w_2ex2_2ex2_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">double phi</div><div class="ttdef"><b>Definition</b> <a href="_s_w_2ex2_2ex2_8cpp_source.html#l00038">ex2.cpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition</b> <a href="_files_8hpp_source.html#l00064">Files.hpp:64</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gauss_html_a20c1596b027c605731549535cd1b41c7"><div class="ttname"><a href="classfemus_1_1_gauss.html#a20c1596b027c605731549535cd1b41c7">femus::Gauss::GetGaussWeightsPointer</a></div><div class="ttdeci">const double * GetGaussWeightsPointer() const</div><div class="ttdef"><b>Definition</b> <a href="_gauss_points_8hpp_source.html#l00123">GaussPoints.hpp:123</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gauss_html_ab1eb96997b69ce4ebec7283eb3bf1c01"><div class="ttname"><a href="classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">femus::Gauss::GetGaussPointsNumber</a></div><div class="ttdeci">const unsigned GetGaussPointsNumber() const</div><div class="ttdef"><b>Definition</b> <a href="_gauss_points_8hpp_source.html#l00136">GaussPoints.hpp:136</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a0f0ff6417d3a09a1c28c3d803ec9d885"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#a0f0ff6417d3a09a1c28c3d803ec9d885">femus::LinearEquation::print_with_structure_matlab_friendly</a></div><div class="ttdeci">void print_with_structure_matlab_friendly(const unsigned iproc, const std::string filename_base, NumericVector *num_vec_in) const</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8cpp_source.html#l00108">LinearEquation.cpp:108</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a20ac8999e714492516cd8a2be53fb54f"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8cpp_source.html#l00071">LinearEquation.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8hpp_source.html#l00118">LinearEquation.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html"><div class="ttname"><a href="classfemus_1_1_linear_equation_solver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_solver_8hpp_source.html#l00055">LinearEquationSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a58ebbec8ab1f2eb863cba438f30404e0"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">femus::LinearImplicitSystem::_LinSolver</a></div><div class="ttdeci">vector&lt; LinearEquationSolver * &gt; _LinSolver</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8hpp_source.html#l00077">LinearImplicitSystem.hpp:77</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a555c4982e81fc0042426c6741a792ca2"><div class="ttname"><a href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">femus::Mesh::_finiteElement</a></div><div class="ttdeci">const elem_type * _finiteElement[N_GEOM_ELS][5]</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00321">Mesh.hpp:321</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a5a0c1124aca095fd4327252ebac3660f"><div class="ttname"><a href="classfemus_1_1_mesh.html#a5a0c1124aca095fd4327252ebac3660f">femus::Mesh::GetElementFaceNumber</a></div><div class="ttdeci">unsigned GetElementFaceNumber(const unsigned &amp;iel, const unsigned &amp;type=1) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l01252">Mesh.cpp:1252</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l01222">Mesh.cpp:1222</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00162">Mesh.hpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l01212">Mesh.cpp:1212</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a1a9383619526e04fe6fac99acb7cfab9"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a1a9383619526e04fe6fac99acb7cfab9">femus::MultiLevelProblem::get_all_abstract_fe</a></div><div class="ttdeci">void get_all_abstract_fe(std::vector&lt; std::vector&lt; elem_type_templ_base&lt; double, double &gt; * &gt; &gt; &amp;elem_all_in)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00298">MultiLevelProblem.hpp:298</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a274e91e352c0d6b69c5925fdfca67d1f"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a274e91e352c0d6b69c5925fdfca67d1f">femus::MultiLevelProblem::GetFilesHandler</a></div><div class="ttdeci">const Files * GetFilesHandler() const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00425">MultiLevelProblem.hpp:425</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a34890e6aa9d88946571fa050ee544c39"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">femus::MultiLevelProblem::GetQuadratureRule</a></div><div class="ttdeci">const Gauss &amp; GetQuadratureRule(const unsigned geom_elem_type) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00282">MultiLevelProblem.hpp:282</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a6dd8fec26a0ffbaae07e6df7ea42d12b"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">femus::MultiLevelProblem::_ml_sol</a></div><div class="ttdeci">MultiLevelSolution * _ml_sol</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00079">MultiLevelProblem.hpp:79</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00116">MultiLevelProblem.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1_non_linear_implicit_system_html"><div class="ttname"><a href="classfemus_1_1_non_linear_implicit_system.html">femus::NonLinearImplicitSystem</a></div><div class="ttdef"><b>Definition</b> <a href="_non_linear_implicit_system_8hpp_source.html#l00035">NonLinearImplicitSystem.hpp:35</a></div></div>
<div class="ttc" id="aclassfemus_1_1_non_linear_implicit_system_html_a036abf737ef5a4dcfa1d26db3bc35bca"><div class="ttname"><a href="classfemus_1_1_non_linear_implicit_system.html#a036abf737ef5a4dcfa1d26db3bc35bca">femus::NonLinearImplicitSystem::GetNonlinearIt</a></div><div class="ttdeci">const unsigned GetNonlinearIt() const</div><div class="ttdef"><b>Definition</b> <a href="_non_linear_implicit_system_8hpp_source.html#l00065">NonLinearImplicitSystem.hpp:65</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition</b> <a href="_numeric_vector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a0440021963af01ac49a6f02df562e44b"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">femus::NumericVector::add_vector_blocked</a></div><div class="ttdeci">virtual void add_vector_blocked(const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)=0</div><div class="ttdoc">where v is a std::vector !!!fast</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_af6629fca51be192be664c76eb8aecc79"><div class="ttname"><a href="classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">femus::ParallelObject::n_processors</a></div><div class="ttdeci">int n_processors() const</div><div class="ttdef"><b>Definition</b> <a href="_parallel_object_8hpp_source.html#l00048">ParallelObject.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="_sparse_matrix_8hpp_source.html#l00047">SparseMatrix.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a4ebc859deb32b54c9936fa28f1485a93"><div class="ttname"><a href="classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">femus::System::GetSolPdeIndex</a></div><div class="ttdeci">unsigned GetSolPdeIndex(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="_system_8cpp_source.html#l00087">System.cpp:87</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a0504cb0eca4695ba727b5823cca30369"><div class="ttname"><a href="classfemus_1_1assemble__jacobian.html#a0504cb0eca4695ba727b5823cca30369">femus::assemble_jacobian::print_global_jacobian</a></div><div class="ttdeci">static void print_global_jacobian(const bool assemble_matrix, const MultiLevelProblem &amp;ml_prob, const SparseMatrix *JAC, const unsigned int nonlin_iteration)</div><div class="ttdef"><b>Definition</b> <a href="_assemble__jacobian_8hpp_source.html#l00314">Assemble_jacobian.hpp:314</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type__templ__base_html"><div class="ttname"><a href="classfemus_1_1elem__type__templ__base.html">femus::elem_type_templ_base</a></div><div class="ttdef"><b>Definition</b> <a href="_elem_type__template__base_8hpp_source.html#l00016">ElemType_template_base.hpp:16</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a3fa8f889f9ae97586b3db574acb4448e"><div class="ttname"><a href="classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">femus::elem_type::GetGaussPointNumber</a></div><div class="ttdeci">unsigned GetGaussPointNumber() const</div><div class="ttdef"><b>Definition</b> <a href="_elem_type_8hpp_source.html#l00208">ElemType.hpp:208</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_af9c2379b41e7c7228229d82968959b23"><div class="ttname"><a href="classfemus_1_1elem__type.html#af9c2379b41e7c7228229d82968959b23">femus::elem_type::GetPhi</a></div><div class="ttdeci">virtual double * GetPhi(const unsigned &amp;ig) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="_elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem_html_a54ac1afbd613fe46b8c98be14a1c896f"><div class="ttname"><a href="classfemus_1_1elem.html#a54ac1afbd613fe46b8c98be14a1c896f">femus::elem::GetBoundaryIndex</a></div><div class="ttdeci">int GetBoundaryIndex(const unsigned &amp;iel, const unsigned &amp;iface)</div><div class="ttdef"><b>Definition</b> <a href="_elem_8cpp_source.html#l00314">Elem.cpp:314</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem_html_a9b4bb98c0365d283a502ed4dc3c43db7"><div class="ttname"><a href="classfemus_1_1elem.html#a9b4bb98c0365d283a502ed4dc3c43db7">femus::elem::GetIG</a></div><div class="ttdeci">const unsigned GetIG(const unsigned &amp;elementType, const unsigned &amp;iface, const unsigned &amp;jnode) const</div><div class="ttdef"><b>Definition</b> <a href="_elem_8cpp_source.html#l00625">Elem.cpp:625</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem_html_add93a6ef1b8c8c3ca75b77c5ba9b5c01"><div class="ttname"><a href="classfemus_1_1elem.html#add93a6ef1b8c8c3ca75b77c5ba9b5c01">femus::elem::GetNFACENODES</a></div><div class="ttdeci">const unsigned GetNFACENODES(const unsigned &amp;elementType, const unsigned &amp;jface, const unsigned &amp;dof) const</div><div class="ttdef"><b>Definition</b> <a href="_elem_8cpp_source.html#l00615">Elem.cpp:615</a></div></div>
<div class="ttc" id="afractional__functions_8hpp_html_a8495a4922fe3179f6db210e024338ba4"><div class="ttname"><a href="fractional__functions_8hpp.html#a8495a4922fe3179f6db210e024338ba4">GetElementPartitionQuad</a></div><div class="ttdeci">void GetElementPartitionQuad(const std::vector&lt; double &gt; &amp;xg1, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;xNodes, const unsigned &amp;split, const unsigned &amp;totalNumberofSplits, std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="fractional__functions_8hpp_source.html#l00213">fractional_functions.hpp:213</a></div></div>
<div class="ttc" id="afractional__functions_8hpp_html_af057d335d5ff979f59d72742fed6f683"><div class="ttname"><a href="fractional__functions_8hpp.html#af057d335d5ff979f59d72742fed6f683">GetElementPartition1D</a></div><div class="ttdeci">void GetElementPartition1D(const std::vector&lt; double &gt; &amp;xg1, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;x1, const unsigned &amp;split, const unsigned int Nsplit_in, std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &amp;x, const unsigned dim)</div><div class="ttdef"><b>Definition</b> <a href="fractional__functions_8hpp_source.html#l00047">fractional_functions.hpp:47</a></div></div>
<div class="ttc" id="anamespacefemus_html_a26952845941ad3ab68f35f0dc647e464"><div class="ttname"><a href="namespacefemus.html#a26952845941ad3ab68f35f0dc647e464">femus::GetClosestPointInReferenceElement</a></div><div class="ttdeci">void GetClosestPointInReferenceElement(const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;xv, const std::vector&lt; double &gt; &amp;x, const short unsigned &amp;ieltype, std::vector&lt; double &gt; &amp;xi)</div><div class="ttdef"><b>Definition</b> <a href="_polynomial_bases_8cpp_source.html#l01929">PolynomialBases.cpp:1929</a></div></div>
<div class="ttc" id="anamespacefemus_html_a434f4672190f9d15cbc5e65705836bda"><div class="ttname"><a href="namespacefemus.html#a434f4672190f9d15cbc5e65705836bda">femus::GetInverseMapping</a></div><div class="ttdeci">void GetInverseMapping(const unsigned &amp;solType, short unsigned &amp;ielType, const std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &amp;aP, const std::vector&lt; double &gt; &amp;xl, std::vector&lt; double &gt; &amp;xi)</div><div class="ttdef"><b>Definition</b> <a href="_polynomial_bases_8cpp_source.html#l01860">PolynomialBases.cpp:1860</a></div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition</b> <a href="_elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
<div class="ttc" id="anamespacefemus_html_afdac57fc6d063ef9ea0b54b401222bc0"><div class="ttname"><a href="namespacefemus.html#afdac57fc6d063ef9ea0b54b401222bc0">femus::ProjectNodalToPolynomialCoefficients</a></div><div class="ttdeci">void ProjectNodalToPolynomialCoefficients(std::vector&lt; std::vector&lt; double &gt; &gt; &amp;aP, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;aN, const short unsigned &amp;ielType, const unsigned &amp;solType)</div><div class="ttdef"><b>Definition</b> <a href="_polynomial_bases_8cpp_source.html#l00026">PolynomialBases.cpp:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa90ba84bd5f3c82ef6584676659c53f3" name="aa90ba84bd5f3c82ef6584676659c53f3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa90ba84bd5f3c82ef6584676659c53f3">&#9670;&#160;</a></span>GetHsNorm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetHsNorm </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l01158">1158</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1159</span>{</div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>*                    msh = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);    <span class="comment">// pointer to the mesh (level) object</span></div>
<div class="line"><span class="lineno"> 1163</span>  <a class="code hl_class" href="classfemus_1_1elem.html">elem</a>*                     el = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;  <span class="comment">// pointer to the elem object in msh (level)</span></div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>*    ml_sol = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;  <span class="comment">// pointer to the multilevel solution object</span></div>
<div class="line"><span class="lineno"> 1166</span>  <a class="code hl_class" href="classfemus_1_1_solution.html">Solution</a>*                sol = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level);    <span class="comment">// pointer to the solution (level) object</span></div>
<div class="line"><span class="lineno"> 1167</span> </div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>(); <span class="comment">// get the domain dimension of the problem</span></div>
<div class="line"><span class="lineno"> 1170</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> maxSize = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><span class="lineno"> 1171</span> </div>
<div class="line"><span class="lineno"> 1172</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno"> 1173</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span> </div>
<div class="line"><span class="lineno"> 1176</span>  CurrentElem &lt; double &gt; geom_element1(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, msh);            <span class="comment">// must be adept if the domain is moving, otherwise double</span></div>
<div class="line"><span class="lineno"> 1177</span>  CurrentElem &lt; double &gt; geom_element2(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, msh);            <span class="comment">// must be adept if the domain is moving, otherwise double</span></div>
<div class="line"><span class="lineno"> 1178</span> </div>
<div class="line"><span class="lineno"> 1179</span>  <span class="keyword">constexpr</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> space_dim = 3;</div>
<div class="line"><span class="lineno"> 1180</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 1181</span>  <span class="comment">//prepare Abstract quantities for all fe fams for all geom elems: all quadrature evaluations are performed beforehand in the main function</span></div>
<div class="line"><span class="lineno"> 1182</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 1183</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  JacI_iqp(space_dim);</div>
<div class="line"><span class="lineno"> 1184</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  Jac_iqp(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1185</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 1186</span>    Jac_iqp[d].resize(space_dim);</div>
<div class="line"><span class="lineno"> 1187</span>  }</div>
<div class="line"><span class="lineno"> 1188</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; space_dim; d++) {</div>
<div class="line"><span class="lineno"> 1189</span>    JacI_iqp[d].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1190</span>  }</div>
<div class="line"><span class="lineno"> 1191</span> </div>
<div class="line"><span class="lineno"> 1192</span>  <span class="keywordtype">double</span> detJac_iqp;</div>
<div class="line"><span class="lineno"> 1193</span>  </div>
<div class="line"><span class="lineno"> 1194</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  JacI_jqp(space_dim);</div>
<div class="line"><span class="lineno"> 1195</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  Jac_jqp(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1196</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 1197</span>    Jac_jqp[d].resize(space_dim);</div>
<div class="line"><span class="lineno"> 1198</span>  }</div>
<div class="line"><span class="lineno"> 1199</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; space_dim; d++) {</div>
<div class="line"><span class="lineno"> 1200</span>    JacI_jqp[d].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1201</span>  }</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span>  <span class="keywordtype">double</span> detJac_jqp;  </div>
<div class="line"><span class="lineno"> 1204</span>  </div>
<div class="line"><span class="lineno"> 1205</span>  std::vector &lt; std::vector &lt; <span class="comment">/*const*/</span> <a class="code hl_class" href="classfemus_1_1elem__type__templ__base.html">elem_type_templ_base&lt; double, double &gt;</a> *  &gt; &gt; elem_all;</div>
<div class="line"><span class="lineno"> 1206</span>  ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a1a9383619526e04fe6fac99acb7cfab9">get_all_abstract_fe</a>(elem_all);</div>
<div class="line"><span class="lineno"> 1207</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 1208</span> </div>
<div class="line"><span class="lineno"> 1209</span>  <span class="comment">//solution variable</span></div>
<div class="line"><span class="lineno"> 1210</span>  <span class="keywordtype">unsigned</span> soluIndex;</div>
<div class="line"><span class="lineno"> 1211</span>  soluIndex = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;u&quot;</span>);    <span class="comment">// get the position of &quot;u&quot; in the ml_sol object</span></div>
<div class="line"><span class="lineno"> 1212</span>  <span class="keywordtype">unsigned</span> solType = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(soluIndex);    <span class="comment">// get the finite element type for &quot;u&quot;</span></div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span>  std::vector &lt; double &gt; solu1;</div>
<div class="line"><span class="lineno"> 1215</span>  std::vector &lt; double &gt; solu2;</div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span> </div>
<div class="line"><span class="lineno"> 1218</span>  <span class="keywordtype">unsigned</span> xType = 2; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE QUADRATIC)</span></div>
<div class="line"><span class="lineno"> 1219</span> </div>
<div class="line"><span class="lineno"> 1220</span>  vector &lt; vector &lt; double &gt; &gt; x1(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);    <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno"> 1221</span>  vector &lt; vector &lt; double &gt; &gt; x2(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);    <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno"> 1222</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1223</span>    x1[k].reserve(maxSize);</div>
<div class="line"><span class="lineno"> 1224</span>    x2[k].reserve(maxSize);</div>
<div class="line"><span class="lineno"> 1225</span>  }</div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span>  vector &lt; double &gt; <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line"><span class="lineno"> 1228</span>  vector &lt; double &gt; phi_x;</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>  <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.reserve(maxSize);</div>
<div class="line"><span class="lineno"> 1231</span>  phi_x.reserve(maxSize * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span> </div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> s_frac = <a class="code hl_define" href="07__fractional_8cpp.html#a7eb16be80e7f4c50bdf6f65e04b310ff">S_FRAC</a>;</div>
<div class="line"><span class="lineno"> 1236</span> </div>
<div class="line"><span class="lineno"> 1237</span>  <span class="keywordtype">double</span> sol_qp = 0.;</div>
<div class="line"><span class="lineno"> 1238</span>  std::vector&lt; double &gt; sol_x_qp(space_dim);</div>
<div class="line"><span class="lineno"> 1239</span>  std::fill(sol_x_qp.begin(), sol_x_qp.end(), 0.);</div>
<div class="line"><span class="lineno"> 1240</span>  <span class="keywordtype">double</span> JxWeight = 0.;</div>
<div class="line"><span class="lineno"> 1241</span> </div>
<div class="line"><span class="lineno"> 1242</span>  <span class="keywordtype">double</span> integral_iproc_L2 = 0.;</div>
<div class="line"><span class="lineno"> 1243</span>  <span class="keywordtype">double</span> integral_iproc_H1 = 0.;</div>
<div class="line"><span class="lineno"> 1244</span> </div>
<div class="line"><span class="lineno"> 1245</span> </div>
<div class="line"><span class="lineno"> 1246</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span>    geom_element1.set_coords_at_dofs_and_geom_type(iel, xType);</div>
<div class="line"><span class="lineno"> 1249</span> </div>
<div class="line"><span class="lineno"> 1250</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom1 = geom_element1.geom_type();</div>
<div class="line"><span class="lineno"> 1251</span> </div>
<div class="line"><span class="lineno"> 1252</span>    <span class="keywordtype">unsigned</span> nDof_u  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, solType);</div>
<div class="line"><span class="lineno"> 1253</span>    solu1.resize(nDof_u);</div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; solu1.size(); i++) {</div>
<div class="line"><span class="lineno"> 1256</span>      <span class="keywordtype">unsigned</span> iDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, solType);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno"> 1257</span>      solu1[i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndex])(iDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno"> 1258</span>    }</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span> </div>
<div class="line"><span class="lineno"> 1262</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> igNumber = ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom1).<a class="code hl_function" href="classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span> </div>
<div class="line"><span class="lineno"> 1265</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; igNumber; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno"> 1266</span> </div>
<div class="line"><span class="lineno"> 1267</span>      elem_all[ielGeom1][xType]-&gt;JacJacInv(geom_element1.get_coords_at_dofs_3d(), <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, Jac_iqp, JacI_iqp, detJac_iqp, space_dim);</div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>      JxWeight = detJac_iqp * ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom1).<a class="code hl_function" href="classfemus_1_1_gauss.html#a20c1596b027c605731549535cd1b41c7">GetGaussWeightsPointer</a>()[<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>];</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span>      elem_all[ielGeom1][solType]-&gt;shape_funcs_current_elem(<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, JacI_iqp, <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x <span class="comment">/*boost::none*/</span>, boost::none <span class="comment">/*phi_xx*/</span>, space_dim);</div>
<div class="line"><span class="lineno"> 1272</span> </div>
<div class="line"><span class="lineno"> 1273</span> </div>
<div class="line"><span class="lineno"> 1274</span>      sol_qp = 0.;</div>
<div class="line"><span class="lineno"> 1275</span>      std::fill(sol_x_qp.begin(), sol_x_qp.end(), 0.);</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt;  solu1.size(); i++) {</div>
<div class="line"><span class="lineno"> 1278</span>        sol_qp += solu1[i] * <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i];</div>
<div class="line"><span class="lineno"> 1279</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; sol_x_qp.size(); d++)   sol_x_qp[d] += solu1[i] * phi_x[i * space_dim + d];</div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>      }</div>
<div class="line"><span class="lineno"> 1282</span> </div>
<div class="line"><span class="lineno"> 1283</span>      integral_iproc_L2 += JxWeight * sol_qp * sol_qp;</div>
<div class="line"><span class="lineno"> 1284</span> </div>
<div class="line"><span class="lineno"> 1285</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; sol_x_qp.size(); d++) integral_iproc_H1 += JxWeight * sol_x_qp[d] * sol_x_qp[d];</div>
<div class="line"><span class="lineno"> 1286</span> </div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span>    }</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span> </div>
<div class="line"><span class="lineno"> 1291</span>  }</div>
<div class="line"><span class="lineno"> 1292</span> </div>
<div class="line"><span class="lineno"> 1293</span> </div>
<div class="line"><span class="lineno"> 1294</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 integral on processor &quot;</span> &lt;&lt; iproc &lt;&lt; std::setprecision(40) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; integral_iproc_L2 &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1295</span> </div>
<div class="line"><span class="lineno"> 1296</span>  <span class="keywordtype">double</span> J_L2 = 0.;</div>
<div class="line"><span class="lineno"> 1297</span>  MPI_Allreduce(&amp;integral_iproc_L2, &amp;J_L2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);     <span class="comment">//THIS IS THE RIGHT ONE!!</span></div>
<div class="line"><span class="lineno"> 1298</span> </div>
<div class="line"><span class="lineno"> 1299</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 integral after Allreduce: &quot;</span> &lt;&lt; sqrt(J_L2) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1300</span> </div>
<div class="line"><span class="lineno"> 1301</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;H1 integral on processor &quot;</span> &lt;&lt; iproc &lt;&lt; std::setprecision(40) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; integral_iproc_H1 &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1302</span> </div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>  <span class="keywordtype">double</span> J_H1 = 0.;</div>
<div class="line"><span class="lineno"> 1305</span>  MPI_Allreduce(&amp;integral_iproc_H1, &amp;J_H1, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);     <span class="comment">//THIS IS THE RIGHT ONE!!</span></div>
<div class="line"><span class="lineno"> 1306</span> </div>
<div class="line"><span class="lineno"> 1307</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;H1 integral after Allreduce: &quot;</span> &lt;&lt; sqrt(J_H1) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1308</span> </div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span> </div>
<div class="line"><span class="lineno"> 1312</span>  <span class="keywordtype">double</span> integral_iproc_Hhalf = 0.;</div>
<div class="line"><span class="lineno"> 1313</span> </div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kproc = 0; kproc &lt; nprocs; kproc++) {</div>
<div class="line"><span class="lineno"> 1316</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[kproc]; jel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[kproc + 1]; jel++) {</div>
<div class="line"><span class="lineno"> 1317</span> </div>
<div class="line"><span class="lineno"> 1318</span>      <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom2;</div>
<div class="line"><span class="lineno"> 1319</span>      <span class="keywordtype">unsigned</span> nDof2;</div>
<div class="line"><span class="lineno"> 1320</span>      <span class="keywordtype">unsigned</span> nDofx2;</div>
<div class="line"><span class="lineno"> 1321</span>      <span class="keywordtype">unsigned</span> nDofu2;</div>
<div class="line"><span class="lineno"> 1322</span> </div>
<div class="line"><span class="lineno"> 1323</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno"> 1324</span>        ielGeom2 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(jel);</div>
<div class="line"><span class="lineno"> 1325</span>        nDof2  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(jel, solType);    <span class="comment">// number of solution element dofs</span></div>
<div class="line"><span class="lineno"> 1326</span>        nDofx2 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(jel, xType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno"> 1327</span>      }</div>
<div class="line"><span class="lineno"> 1328</span> </div>
<div class="line"><span class="lineno"> 1329</span>      MPI_Bcast(&amp;ielGeom2, 1, MPI_UNSIGNED_SHORT, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1330</span>      MPI_Bcast(&amp;nDof2, 1, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1331</span>      MPI_Bcast(&amp;nDofx2, 1, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span> </div>
<div class="line"><span class="lineno"> 1335</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1336</span>        x2[k].resize(nDofx2);</div>
<div class="line"><span class="lineno"> 1337</span>      }</div>
<div class="line"><span class="lineno"> 1338</span>      solu2.resize(nDof2);</div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span>      <span class="comment">// local storage of coordinates  #######################################</span></div>
<div class="line"><span class="lineno"> 1342</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno"> 1343</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofx2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1344</span>          <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, jel, xType);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno"> 1345</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1346</span>            x2[k][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k])(xDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno"> 1347</span>          }</div>
<div class="line"><span class="lineno"> 1348</span>        }</div>
<div class="line"><span class="lineno"> 1349</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1350</span>          <span class="keywordtype">unsigned</span> jDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, jel, solType);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno"> 1351</span>          solu2[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndex])(jDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno"> 1352</span>        }</div>
<div class="line"><span class="lineno"> 1353</span>      }</div>
<div class="line"><span class="lineno"> 1354</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1355</span>        MPI_Bcast(&amp; x2[k][0], nDofx2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1356</span>      }</div>
<div class="line"><span class="lineno"> 1357</span>      MPI_Bcast(&amp; solu2[0], nDof2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1358</span>      <span class="comment">// ######################################################################</span></div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span>      <span class="comment">// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></div>
<div class="line"><span class="lineno"> 1361</span>      <span class="keywordflow">if</span>(iproc == kproc) {</div>
<div class="line"><span class="lineno"> 1362</span>        geom_element2.set_coords_at_dofs_and_geom_type(jel, xType);</div>
<div class="line"><span class="lineno"> 1363</span>      }</div>
<div class="line"><span class="lineno"> 1364</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1365</span>        MPI_Bcast(&amp; geom_element2.get_coords_at_dofs()[k][0], nDofx2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1366</span>      }</div>
<div class="line"><span class="lineno"> 1367</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; space_dim; k++) {</div>
<div class="line"><span class="lineno"> 1368</span>        MPI_Bcast(&amp; geom_element2.get_coords_at_dofs_3d()[k][0], nDofx2, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1369</span>      }</div>
<div class="line"><span class="lineno"> 1370</span>      <span class="comment">// $$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$$</span></div>
<div class="line"><span class="lineno"> 1371</span> </div>
<div class="line"><span class="lineno"> 1372</span>      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> jgNumber = ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom2).<a class="code hl_function" href="classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>      vector &lt; vector &lt; double &gt; &gt; xg2(jgNumber);</div>
<div class="line"><span class="lineno"> 1375</span>      vector &lt;double&gt; weight2(jgNumber);</div>
<div class="line"><span class="lineno"> 1376</span>      vector &lt; vector &lt;double&gt; &gt; phi2(jgNumber);  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno"> 1377</span>      std::vector&lt; double &gt; solY(jgNumber, 0.);</div>
<div class="line"><span class="lineno"> 1378</span> </div>
<div class="line"><span class="lineno"> 1379</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jg = 0; jg &lt; jgNumber; jg++) {</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span><span class="comment">//          msh-&gt;_finiteElement[ielGeom2][solType]-&gt;Jacobian(x2, jg, weight2[jg], phi2[jg], phi_x);</span></div>
<div class="line"><span class="lineno"> 1382</span> </div>
<div class="line"><span class="lineno"> 1383</span>        elem_all[ielGeom2][xType]-&gt;JacJacInv(<span class="comment">/*x2*/</span>geom_element2.get_coords_at_dofs_3d(), jg, Jac_jqp, JacI_jqp, detJac_jqp, space_dim);</div>
<div class="line"><span class="lineno"> 1384</span>        weight2[jg] = detJac_jqp * ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom2).<a class="code hl_function" href="classfemus_1_1_gauss.html#a20c1596b027c605731549535cd1b41c7">GetGaussWeightsPointer</a>()[jg];</div>
<div class="line"><span class="lineno"> 1385</span>        elem_all[ielGeom2][solType]-&gt;shape_funcs_current_elem(jg, JacI_jqp, phi2[jg], phi_x <span class="comment">/*boost::none*/</span>, boost::none <span class="comment">/*phi_u_xx*/</span>, space_dim);</div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span>        xg2[jg].assign(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno"> 1388</span>        solY[jg] = 0.;</div>
<div class="line"><span class="lineno"> 1389</span> </div>
<div class="line"><span class="lineno"> 1390</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1391</span>          solY[jg] += solu2[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * phi2[jg][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1392</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1393</span>            xg2[jg][k] += x2[k][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * phi2[jg][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1394</span>          }</div>
<div class="line"><span class="lineno"> 1395</span>        }</div>
<div class="line"><span class="lineno"> 1396</span>      }</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span>      <span class="comment">// element loop: each process loops only on the elements that owns</span></div>
<div class="line"><span class="lineno"> 1399</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>        <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom1 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno"> 1402</span>        <span class="keywordtype">unsigned</span> nDof1  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, solType);    <span class="comment">// number of solution element dofs</span></div>
<div class="line"><span class="lineno"> 1403</span>        <span class="keywordtype">unsigned</span> nDofx1 = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, xType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno"> 1404</span> </div>
<div class="line"><span class="lineno"> 1405</span>        <span class="comment">// resize local arrays</span></div>
<div class="line"><span class="lineno"> 1406</span><span class="comment">//         l2GMap1.resize(nDof1);</span></div>
<div class="line"><span class="lineno"> 1407</span>        <span class="comment">//std::vector&lt;bool&gt;bdcDirichlet(nDof1);</span></div>
<div class="line"><span class="lineno"> 1408</span> </div>
<div class="line"><span class="lineno"> 1409</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1410</span>          x1[k].resize(nDofx1);</div>
<div class="line"><span class="lineno"> 1411</span>        }</div>
<div class="line"><span class="lineno"> 1412</span>        solu1.resize(nDof1);</div>
<div class="line"><span class="lineno"> 1413</span> </div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>        <span class="comment">// local storage of coordinates</span></div>
<div class="line"><span class="lineno"> 1416</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx1; i++) {</div>
<div class="line"><span class="lineno"> 1417</span>          <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, xType);    <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno"> 1418</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1419</span>            x1[k][i] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k])(xDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno"> 1420</span>          }</div>
<div class="line"><span class="lineno"> 1421</span>        }</div>
<div class="line"><span class="lineno"> 1422</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno"> 1423</span>          <span class="keywordtype">unsigned</span> iDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, solType);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno"> 1424</span>          solu1[i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndex])(iDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno"> 1425</span>        }</div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span> </div>
<div class="line"><span class="lineno"> 1428</span>        <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno"> 1429</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> igNumber = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom1][solType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>();</div>
<div class="line"><span class="lineno"> 1430</span><span class="comment">//         const unsigned igNumber = ml_prob.GetQuadratureRule(ielGeom1).GetGaussPointsNumber();</span></div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span>        <span class="keywordtype">double</span> weight1;</div>
<div class="line"><span class="lineno"> 1433</span>        vector &lt; double &gt; phi1;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno"> 1434</span>        <span class="keywordtype">double</span>  solX = 0.;</div>
<div class="line"><span class="lineno"> 1435</span> </div>
<div class="line"><span class="lineno"> 1436</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; igNumber; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno"> 1437</span> </div>
<div class="line"><span class="lineno"> 1438</span>          msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom1][solType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(x1, <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight1, phi1, phi_x);</div>
<div class="line"><span class="lineno"> 1439</span> </div>
<div class="line"><span class="lineno"> 1440</span>          <span class="comment">// evaluate the solution, the solution derivatives and the coordinates in the gauss point</span></div>
<div class="line"><span class="lineno"> 1441</span>          vector &lt; double &gt; xg1(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno"> 1442</span>          solX = 0.;</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof1; i++) {</div>
<div class="line"><span class="lineno"> 1445</span>            solX += solu1[i] * phi1[i];</div>
<div class="line"><span class="lineno"> 1446</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1447</span>              xg1[k] += x1[k][i] * phi1[i];</div>
<div class="line"><span class="lineno"> 1448</span>            }</div>
<div class="line"><span class="lineno"> 1449</span>          }</div>
<div class="line"><span class="lineno"> 1450</span> </div>
<div class="line"><span class="lineno"> 1451</span> </div>
<div class="line"><span class="lineno"> 1452</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jg = 0; jg &lt; jgNumber; jg++) {</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span>            <span class="keywordtype">double</span> dist_xyz = 0;</div>
<div class="line"><span class="lineno"> 1455</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1456</span>              dist_xyz += (xg1[k] - xg2[jg][k]) * (xg1[k] - xg2[jg][k]);</div>
<div class="line"><span class="lineno"> 1457</span>            }</div>
<div class="line"><span class="lineno"> 1458</span> </div>
<div class="line"><span class="lineno"> 1459</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> denom = pow(dist_xyz, (<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> / 2.) + s_frac);</div>
<div class="line"><span class="lineno"> 1460</span> </div>
<div class="line"><span class="lineno"> 1461</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> sol_diff = (solX - solY[jg]);</div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span><span class="comment">//             integral_iproc_Hhalf +=  weight1 *  weight2[jg];</span></div>
<div class="line"><span class="lineno"> 1464</span>            integral_iproc_Hhalf +=  weight1 * weight2[jg] * (sol_diff * sol_diff) / denom;</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span> </div>
<div class="line"><span class="lineno"> 1467</span>          } <span class="comment">//endl jg loop</span></div>
<div class="line"><span class="lineno"> 1468</span>        } <span class="comment">//endl ig loop</span></div>
<div class="line"><span class="lineno"> 1469</span> </div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span>      } <span class="comment">// end iel loop</span></div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span> </div>
<div class="line"><span class="lineno"> 1474</span>    } <span class="comment">//end jel loop</span></div>
<div class="line"><span class="lineno"> 1475</span>  } <span class="comment">//end kproc loop</span></div>
<div class="line"><span class="lineno"> 1476</span> </div>
<div class="line"><span class="lineno"> 1478</span> </div>
<div class="line"><span class="lineno"> 1479</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;H-1/2 integral on processor &quot;</span> &lt;&lt; iproc  &lt;&lt; std::setprecision(40) &lt;&lt; <span class="stringliteral">&quot;: &quot;</span> &lt;&lt; integral_iproc_Hhalf &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>  <span class="keywordtype">double</span> J = 0.;</div>
<div class="line"><span class="lineno"> 1482</span>  MPI_Allreduce(&amp;integral_iproc_Hhalf, &amp;J, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1483</span> </div>
<div class="line"><span class="lineno"> 1484</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;H-1/2 integral after Allreduce squared: &quot;</span> &lt;&lt; J &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1485</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;H-1/2 integral after Allreduce: &quot;</span> &lt;&lt; sqrt(J) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1486</span> </div>
<div class="line"><span class="lineno"> 1487</span>  <span class="comment">//return;                                                  //ignore the rest</span></div>
<div class="line"><span class="lineno"> 1488</span> </div>
<div class="line"><span class="lineno"> 1489</span>  <span class="comment">// ***************** END ASSEMBLY *******************</span></div>
<div class="line"><span class="lineno"> 1490</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a546143b57a5fa249592941c2b7be629d" name="a546143b57a5fa249592941c2b7be629d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a546143b57a5fa249592941c2b7be629d">&#9670;&#160;</a></span>InitialValueU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double InitialValueU </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00068">68</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>{</div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordflow">return</span> 0. * x[0] * x[0];</div>
<div class="line"><span class="lineno">   71</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00097">97</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>{</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>  <span class="comment">//quadr rule order</span></div>
<div class="line"><span class="lineno">  102</span><span class="comment">//   const std::string fe_quad_rule_1 = &quot;fifth&quot;;</span></div>
<div class="line"><span class="lineno">  103</span><span class="comment">//   const std::string fe_quad_rule_2 = &quot;sixth&quot;;</span></div>
<div class="line"><span class="lineno">  104</span>  <span class="keyword">const</span> std::string fe_quad_rule_1 = <span class="stringliteral">&quot;seventh&quot;</span>;</div>
<div class="line"><span class="lineno">  105</span>  <span class="keyword">const</span> std::string fe_quad_rule_2 = <span class="stringliteral">&quot;eighth&quot;</span>;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <span class="comment">// ======= Init ========================</span></div>
<div class="line"><span class="lineno">  110</span>  <a class="code hl_class" href="classfemus_1_1_femus_init.html">FemusInit</a> mpinit(argc, argv, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span>  <span class="comment">// ======= Files ========================</span></div>
<div class="line"><span class="lineno">  113</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="namespacefemus_1_1ctrl.html#a8b017d48301210dc5d5b3e72566dacb2">use_output_time_folder</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  114</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> <a class="code hl_variable" href="namespacefemus_1_1ctrl.html#ad6eda0ca8eda8c465a2e3ae5b57f77fe">redirect_cout_to_file</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  115</span>  <a class="code hl_class" href="classfemus_1_1_files.html">Files</a> files; </div>
<div class="line"><span class="lineno">  116</span>        files.<a class="code hl_function" href="classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">CheckIODirectories</a>(use_output_time_folder);</div>
<div class="line"><span class="lineno">  117</span>        files.<a class="code hl_function" href="classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">RedirectCout</a>(redirect_cout_to_file);</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> = <a class="code hl_define" href="07__fractional_8cpp.html#a120d118c3e901df3fd09add0c10ad91f">N_UNIFORM_LEVELS</a>;</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>  <span class="comment">// ======= Mesh  ==================</span></div>
<div class="line"><span class="lineno">  123</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_mesh;</div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordtype">double</span> scalingFactor = 1.;</div>
<div class="line"><span class="lineno">  125</span>  <span class="keywordtype">unsigned</span> numberOfSelectiveLevels = 0;</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>  <span class="keywordflow">if</span> (<a class="code hl_define" href="07__fractional_8cpp.html#a1657662a81b61879c06d4916549f8517">DOMAIN_DIM</a> == 1) {</div>
<div class="line"><span class="lineno">  128</span><span class="comment">//   const std::string mesh_file = &quot;./input/Mesh_1_x.med&quot;;</span></div>
<div class="line"><span class="lineno">  129</span><span class="comment">//   ml_mesh.ReadCoarseMesh(mesh_file.c_str(), fe_quad_rule_1.c_str(), scalingFactor);</span></div>
<div class="line"><span class="lineno">  130</span><span class="comment">//   const std::string mesh_file = &quot;./input/Mesh_1_x_dir_neu_200_elem.med&quot;;</span></div>
<div class="line"><span class="lineno">  131</span><span class="comment">//const std::string mesh_file = &quot;./input/Mesh_1_x_dir_neu.med&quot;;</span></div>
<div class="line"><span class="lineno">  132</span>      ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(2, 0, 0, <a class="code hl_define" href="07__fractional_8cpp.html#a249cc0a8805d02135da257cb5bcdd4c6">EX_1</a>, <a class="code hl_define" href="07__fractional_8cpp.html#aec14a389f0ca0850c6e3f8335469a059">EX_2</a>, 0., 0., 0., 0., <a class="code hl_enumvalue" href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a>, fe_quad_rule_1.c_str());</div>
<div class="line"><span class="lineno">  133</span>    }</div>
<div class="line"><span class="lineno">  134</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (<a class="code hl_define" href="07__fractional_8cpp.html#a1657662a81b61879c06d4916549f8517">DOMAIN_DIM</a> == 2)  { </div>
<div class="line"><span class="lineno">  135</span><span class="comment">// //   const std::string mesh_file = &quot;./input/parametric_rectangle.med&quot;;</span></div>
<div class="line"><span class="lineno">  136</span>  <span class="keyword">const</span> std::string mesh_file = <span class="stringliteral">&quot;./input/parametric_rectangle_par_la_longa.med&quot;</span>;</div>
<div class="line"><span class="lineno">  137</span>  ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a29d0d0f9463c9417d390da6149ffc24d">ReadCoarseMesh</a>(mesh_file.c_str(), fe_quad_rule_1.c_str(), scalingFactor);</div>
<div class="line"><span class="lineno">  138</span><span class="comment">//       ml_mesh.GenerateCoarseBoxMesh(2, 2, 0, EX_1, EX_2, EY_1, EY_2, 0., 0., QUAD9, fe_quad_rule_1.c_str());</span></div>
<div class="line"><span class="lineno">  139</span>    }</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>  ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">RefineMesh</a>(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> + numberOfSelectiveLevels, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a>, NULL);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  </div>
<div class="line"><span class="lineno">  144</span>  <span class="comment">// erase all the coarse mesh levels</span></div>
<div class="line"><span class="lineno">  145</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> erased_levels = <a class="code hl_define" href="07__fractional_8cpp.html#a6cf2919927f47ad5f49ed95eaef8add9">N_ERASED_LEVELS</a>;</div>
<div class="line"><span class="lineno">  146</span>  ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#ac474afe18c6be4e181b2bb72695f57e9">EraseCoarseLevels</a>(erased_levels);</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>  <span class="comment">// ======= Solution  ==================</span></div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> ml_sol(&amp;ml_mesh);</div>
<div class="line"><span class="lineno">  152</span>  </div>
<div class="line"><span class="lineno">  153</span>  ml_sol.SetWriter(<a class="code hl_enumvalue" href="_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);</div>
<div class="line"><span class="lineno">  154</span>  ml_sol.GetWriter()-&gt;SetDebugOutput(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <span class="comment">// add variables to ml_sol</span></div>
<div class="line"><span class="lineno">  157</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;u&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <span class="comment">/*FIRST*/</span><a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 2);</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>  ml_sol.Initialize(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  161</span>  ml_sol.Initialize(<span class="stringliteral">&quot;u&quot;</span>, <a class="code hl_function" href="07__fractional_8cpp.html#a546143b57a5fa249592941c2b7be629d">InitialValueU</a>);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  ml_sol.AttachSetBoundaryConditionFunction(<a class="code hl_function" href="07__fractional_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a>);</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <span class="comment">// ******* Set boundary conditions *******</span></div>
<div class="line"><span class="lineno">  166</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  </div>
<div class="line"><span class="lineno">  169</span>  </div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  <span class="comment">// ========= Problem ==========================</span></div>
<div class="line"><span class="lineno">  172</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob(&amp;ml_sol);</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>  ml_prob.SetFilesHandler(&amp;files);</div>
<div class="line"><span class="lineno">  175</span>  ml_prob.SetQuadratureRuleAllGeomElems(fe_quad_rule_2);</div>
<div class="line"><span class="lineno">  176</span>  ml_prob.set_all_abstract_fe_multiple();</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>  <span class="comment">// ========= System ==========================</span></div>
<div class="line"><span class="lineno">  180</span>  <a class="code hl_class" href="classfemus_1_1_non_linear_implicit_system.html">NonLinearImplicitSystem</a>&amp; system = ml_prob.add_system &lt; <a class="code hl_class" href="classfemus_1_1_non_linear_implicit_system.html">NonLinearImplicitSystem</a> &gt; (<span class="stringliteral">&quot;FracProblem&quot;</span>);</div>
<div class="line"><span class="lineno">  181</span>  </div>
<div class="line"><span class="lineno">  182</span>  system.<a class="code hl_function" href="classfemus_1_1_non_linear_implicit_system.html#ad263ecc83efc0d9ea26200bfa3c4cadf">SetDebugNonlinear</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>  system.<a class="code hl_function" href="classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>  <span class="comment">// ******* System FEM Assembly *******</span></div>
<div class="line"><span class="lineno">  187</span>  </div>
<div class="line"><span class="lineno">  188</span>  system.<a class="code hl_function" href="classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="07__fractional_8cpp.html#a8d2b7ad817b979696acdbe1f3a2c5d35">AssembleFracProblem</a>);</div>
<div class="line"><span class="lineno">  189</span><span class="comment">//   system.SetMaxNumberOfLinearIterations(1);</span></div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>  <span class="comment">// ******* set MG-Solver *******</span></div>
<div class="line"><span class="lineno">  192</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">SetMgType</a>(<a class="code hl_enumvalue" href="_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a>);</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">SetAbsoluteLinearConvergenceTolerance</a>(1.e-50);</div>
<div class="line"><span class="lineno">  195</span>  <span class="comment">//   system.SetNonLinearConvergenceTolerance(1.e-9);</span></div>
<div class="line"><span class="lineno">  196</span><span class="comment">//   system.SetMaxNumberOfNonLinearIterations(20);</span></div>
<div class="line"><span class="lineno">  197</span> </div>
<div class="line"><span class="lineno">  198</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">SetNumberPreSmoothingStep</a>(1);</div>
<div class="line"><span class="lineno">  199</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">SetNumberPostSmoothingStep</a>(1);</div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>  <span class="comment">// ******* Set Preconditioner *******</span></div>
<div class="line"><span class="lineno">  202</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">SetLinearEquationSolverType</a>(<a class="code hl_enumvalue" href="_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a>);</div>
<div class="line"><span class="lineno">  203</span>  </div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordtype">unsigned</span> n_levels = <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - erased_levels;</div>
<div class="line"><span class="lineno">  205</span>  </div>
<div class="line"><span class="lineno">  206</span><span class="comment">// Method 1  </span></div>
<div class="line"><span class="lineno">  207</span><span class="comment">//   unsigned column_max_length = ml_mesh.GetLevel(n_levels - 1)-&gt;GetNumberOfNodes();  //bad, works only for tensor-product quadratic</span></div>
<div class="line"><span class="lineno">  208</span>  </div>
<div class="line"><span class="lineno">  209</span><span class="comment">// Method 2  </span></div>
<div class="line"><span class="lineno">  210</span>  <span class="keywordtype">unsigned</span> dimension = pow ( pow(2, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a>) * 2 + 1, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> ); <span class="comment">// (2^{l+1} + 1)^{dim} //bad, works only for tensor-product quadratic</span></div>
<div class="line"><span class="lineno">  211</span>  </div>
<div class="line"><span class="lineno">  212</span><span class="comment">// Method 3  </span></div>
<div class="line"><span class="lineno">  213</span>  std::string variable_string = <span class="stringliteral">&quot;u&quot;</span>;</div>
<div class="line"><span class="lineno">  214</span>  <span class="keywordtype">unsigned</span> variable_index = system.<a class="code hl_function" href="classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(variable_string.c_str());</div>
<div class="line"><span class="lineno">  215</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>* msh = ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(n_levels - 1);</div>
<div class="line"><span class="lineno">  216</span>  <span class="keywordtype">unsigned</span> nprocs = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>();</div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordtype">unsigned</span> iproc = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  218</span>    </div>
<div class="line"><span class="lineno">  219</span>  system.<a class="code hl_function" href="classfemus_1_1_non_linear_implicit_system.html#ad2d20975e0c919a9d99bdd9368a0212a">init</a>();  <span class="comment">//it takes a double init because I need some stuff below, I would like to split that</span></div>
<div class="line"><span class="lineno">  220</span>  </div>
<div class="line"><span class="lineno">  221</span>  std::ostringstream sp_out_base; sp_out_base &lt;&lt; ml_prob.GetFilesHandler()-&gt;GetOutputPath() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;sp_&quot;</span>;</div>
<div class="line"><span class="lineno">  222</span>  system.<a class="code hl_variable" href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[n_levels - 1]-&gt;sparsity_pattern_print_nonzeros(sp_out_base.str(), <span class="stringliteral">&quot;on&quot;</span>);</div>
<div class="line"><span class="lineno">  223</span>  system.<a class="code hl_variable" href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[n_levels - 1]-&gt;sparsity_pattern_print_nonzeros(sp_out_base.str(), <span class="stringliteral">&quot;off&quot;</span>);</div>
<div class="line"><span class="lineno">  224</span>  </div>
<div class="line"><span class="lineno">  225</span>  <span class="keywordtype">unsigned</span> n_dofs_var_all_procs = 0;</div>
<div class="line"><span class="lineno">  226</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ip = 0; ip &lt; nprocs; ip++) {</div>
<div class="line"><span class="lineno">  227</span>     n_dofs_var_all_procs += system.<a class="code hl_variable" href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[n_levels - 1]-&gt;KKoffset[variable_index + 1][ip] - system.<a class="code hl_variable" href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[n_levels - 1]-&gt;KKoffset[variable_index][ip];</div>
<div class="line"><span class="lineno">  228</span>  <span class="comment">// how does this depend on the number of levels and the number of processors? </span></div>
<div class="line"><span class="lineno">  229</span>  <span class="comment">// For the processors I summed over them and it seems to work fine</span></div>
<div class="line"><span class="lineno">  230</span>  <span class="comment">// For the levels... should I pick the coarsest level instead of the finest one, or is it the same?</span></div>
<div class="line"><span class="lineno">  231</span>} </div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#a7ce98d965ba0ccc8fe4c103052a04e6c">SetSparsityPatternMinimumSize</a> (n_dofs_var_all_procs<span class="comment">/*column_max_length*/</span><span class="comment">/*dimension*/</span>, variable_string);</div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>  </div>
<div class="line"><span class="lineno">  236</span>   system.<a class="code hl_function" href="classfemus_1_1_non_linear_implicit_system.html#ad2d20975e0c919a9d99bdd9368a0212a">init</a>();</div>
<div class="line"><span class="lineno">  237</span>   </div>
<div class="line"><span class="lineno">  238</span>   sp_out_base &lt;&lt; <span class="stringliteral">&quot;after_second_init_&quot;</span>;</div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span>  system.<a class="code hl_variable" href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[n_levels - 1]-&gt;sparsity_pattern_print_nonzeros(sp_out_base.str(), <span class="stringliteral">&quot;on&quot;</span>);</div>
<div class="line"><span class="lineno">  241</span>  system.<a class="code hl_variable" href="classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[n_levels - 1]-&gt;sparsity_pattern_print_nonzeros(sp_out_base.str(), <span class="stringliteral">&quot;off&quot;</span>);</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span>  <span class="comment">//dense =============</span></div>
<div class="line"><span class="lineno">  244</span>  <span class="comment">//dense =============</span></div>
<div class="line"><span class="lineno">  245</span>  <span class="comment">//dense =============</span></div>
<div class="line"><span class="lineno">  246</span>  </div>
<div class="line"><span class="lineno">  247</span>  </div>
<div class="line"><span class="lineno">  248</span>  </div>
<div class="line"><span class="lineno">  249</span><span class="comment">//  const unsigned solType = ml_sol.GetSolutionType(&quot;u&quot;);</span></div>
<div class="line"><span class="lineno">  250</span><span class="comment">//   for(int level = 0; level &lt; ml_mesh.GetNumberOfLevels(); level++) {</span></div>
<div class="line"><span class="lineno">  251</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  252</span><span class="comment">//     Mesh* msh = ml_mesh.GetLevel(level);</span></div>
<div class="line"><span class="lineno">  253</span><span class="comment">//     unsigned nprocs = msh-&gt;n_processors();</span></div>
<div class="line"><span class="lineno">  254</span><span class="comment">//     unsigned iproc = msh-&gt;processor_id();</span></div>
<div class="line"><span class="lineno">  255</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  256</span><span class="comment">//     int KK_size = msh-&gt;_dofOffset[solType][nprocs];</span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">//     int KK_local_size = msh-&gt;_dofOffset[solType][iproc + 1] - msh-&gt;_dofOffset[solType][iproc];</span></div>
<div class="line"><span class="lineno">  258</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  259</span><span class="comment">// //   SparseMatrix* CC;</span></div>
<div class="line"><span class="lineno">  260</span><span class="comment">// //   CC = SparseMatrix::build().release();</span></div>
<div class="line"><span class="lineno">  261</span><span class="comment">//     system._LinSolver[level]-&gt;_KK-&gt;init(KK_size, KK_size, KK_local_size, KK_local_size, KK_local_size, KK_size - KK_local_size);</span></div>
<div class="line"><span class="lineno">  262</span><span class="comment">//     system._LinSolver[level]-&gt;_KK-&gt;zero();</span></div>
<div class="line"><span class="lineno">  263</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  264</span>  <span class="comment">//dense =============</span></div>
<div class="line"><span class="lineno">  265</span>  <span class="comment">//dense =============</span></div>
<div class="line"><span class="lineno">  266</span>  <span class="comment">//dense =============</span></div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>  <span class="comment">// ******* Set Smoother *******</span></div>
<div class="line"><span class="lineno">  270</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">SetSolverFineGrids</a>(<a class="code hl_enumvalue" href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>);</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">SetPreconditionerFineGrids</a>(<a class="code hl_enumvalue" href="_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a>);</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>  system.<a class="code hl_function" href="classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">SetTolerances</a>(1.e-20, 1.e-20, 1.e+50, 100);</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>  system.<a class="code hl_function" href="classfemus_1_1_non_linear_implicit_system.html#a438462e18c01e8fb08358526c04c50b5">MGsolve</a>();</div>
<div class="line"><span class="lineno">  277</span><span class="comment">//   system.assemble_call_before_boundary_conditions(1);  //to only call the assemble function</span></div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>  <span class="comment">//solve the generalized eigenvalue problem and compute the eigenpairs</span></div>
<div class="line"><span class="lineno">  280</span>  <a class="code hl_function" href="07__fractional_8cpp.html#aa90ba84bd5f3c82ef6584676659c53f3">GetHsNorm</a>(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a>  - erased_levels - 1, ml_prob);</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span> </div>
<div class="line"><span class="lineno">  283</span>  <span class="comment">// ******* Print solution *******</span></div>
<div class="line"><span class="lineno">  284</span>  ml_sol.SetWriter(<a class="code hl_enumvalue" href="_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);</div>
<div class="line"><span class="lineno">  285</span>  std::vector&lt;std::string&gt; print_vars;</div>
<div class="line"><span class="lineno">  286</span>  print_vars.push_back(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  287</span>  ml_sol.GetWriter()-&gt;SetDebugOutput(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  288</span>  ml_sol.GetWriter()-&gt;Write(files.<a class="code hl_function" href="classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(), <span class="stringliteral">&quot;biquadratic&quot;</span>, print_vars, 0);</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <span class="comment">//ierr = SlepcFinalize();</span></div>
<div class="line"><span class="lineno">  291</span>  <span class="comment">//CHKERRQ(ierr);</span></div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>} <span class="comment">//end main</span></div>
<div class="ttc" id="a07__fractional_8cpp_html_a1657662a81b61879c06d4916549f8517"><div class="ttname"><a href="07__fractional_8cpp.html#a1657662a81b61879c06d4916549f8517">DOMAIN_DIM</a></div><div class="ttdeci">#define DOMAIN_DIM</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00051">07_fractional.cpp:51</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a546143b57a5fa249592941c2b7be629d"><div class="ttname"><a href="07__fractional_8cpp.html#a546143b57a5fa249592941c2b7be629d">InitialValueU</a></div><div class="ttdeci">double InitialValueU(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00068">07_fractional.cpp:68</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a8d2b7ad817b979696acdbe1f3a2c5d35"><div class="ttname"><a href="07__fractional_8cpp.html#a8d2b7ad817b979696acdbe1f3a2c5d35">AssembleFracProblem</a></div><div class="ttdeci">void AssembleFracProblem(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00300">07_fractional.cpp:300</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_aa90ba84bd5f3c82ef6584676659c53f3"><div class="ttname"><a href="07__fractional_8cpp.html#aa90ba84bd5f3c82ef6584676659c53f3">GetHsNorm</a></div><div class="ttdeci">void GetHsNorm(const unsigned level, MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l01158">07_fractional.cpp:1158</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_ab8b0d45993b678f2b4a8aea9fff7fc87"><div class="ttname"><a href="07__fractional_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="07__fractional_8cpp_source.html#l00073">07_fractional.cpp:73</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134"><div class="ttname"><a href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a></div><div class="ttdeci">@ EDGE3</div><div class="ttdef"><b>Definition</b> <a href="_elem_type_enum_8hpp_source.html#l00008">ElemTypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00018">FElemTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_a0aca793820b6ff7705450e2043256938"><div class="ttname"><a href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a></div><div class="ttdeci">unsigned numberOfUniformLevels</div><div class="ttdef"><b>Definition</b> <a href="_i_s_m_2ex4_2ex4_8cpp_source.html#l00089">ex4.cpp:89</a></div></div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0"><div class="ttname"><a href="_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a></div><div class="ttdeci">@ FEMuS_DEFAULT</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_solver_enum_8hpp_source.html#l00005">LinearEquationSolverEnum.hpp:5</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb"><div class="ttname"><a href="_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a></div><div class="ttdeci">@ V_CYCLE</div><div class="ttdef"><b>Definition</b> <a href="_mg_type_enum_8hpp_source.html#l00006">MgTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea"><div class="ttname"><a href="_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a></div><div class="ttdeci">@ ILU_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="_precondtype_enum_8hpp_source.html#l00016">PrecondtypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2"><div class="ttname"><a href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a></div><div class="ttdeci">@ GMRES</div><div class="ttdef"><b>Definition</b> <a href="_solvertype_enum_8hpp_source.html#l00016">SolvertypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_writer_enum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition</b> <a href="_writer_enum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html"><div class="ttname"><a href="classfemus_1_1_files.html">femus::Files</a></div><div class="ttdef"><b>Definition</b> <a href="_files_8hpp_source.html#l00040">Files.hpp:40</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_aac199200ffda7ba50611cc41f6a874bc"><div class="ttname"><a href="classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">femus::Files::RedirectCout</a></div><div class="ttdeci">void RedirectCout(const bool redirect_cout_to_file) const</div><div class="ttdef"><b>Definition</b> <a href="_files_8cpp_source.html#l00553">Files.cpp:553</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab8c41974c4980d87c7e1467b153854e6"><div class="ttname"><a href="classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">femus::Files::CheckIODirectories</a></div><div class="ttdeci">void CheckIODirectories(const bool use_output_time_folder)</div><div class="ttdef"><b>Definition</b> <a href="_files_8cpp_source.html#l00515">Files.cpp:515</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a03b082409d094d87e46e023356c4cb8e"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">femus::LinearImplicitSystem::SetSolverFineGrids</a></div><div class="ttdeci">void SetSolverFineGrids(const SolverType &amp;solvertype)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8cpp_source.html#l01029">LinearImplicitSystem.cpp:1029</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a3e3ca74a8990338254d7907397402bac"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">femus::LinearImplicitSystem::SetMgType</a></div><div class="ttdeci">void SetMgType(const MgType mgtype)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8hpp_source.html#l00110">LinearImplicitSystem.hpp:110</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a4c8a469ba9b68aa14c0780f3a7b61d58"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">femus::LinearImplicitSystem::SetAbsoluteLinearConvergenceTolerance</a></div><div class="ttdeci">void SetAbsoluteLinearConvergenceTolerance(const double &amp;absolute_convergence_tolerance)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8hpp_source.html#l00102">LinearImplicitSystem.hpp:102</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a7ce98d965ba0ccc8fe4c103052a04e6c"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#a7ce98d965ba0ccc8fe4c103052a04e6c">femus::LinearImplicitSystem::SetSparsityPatternMinimumSize</a></div><div class="ttdeci">void SetSparsityPatternMinimumSize(const unsigned &amp;minimumSize, const std::string variableName=&quot;All&quot;)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8cpp_source.html#l00114">LinearImplicitSystem.cpp:114</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a85fc9c2a6bb9b384c298b1d42d2fba59"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">femus::LinearImplicitSystem::SetNumberPreSmoothingStep</a></div><div class="ttdeci">void SetNumberPreSmoothingStep(const unsigned &amp;npre)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8hpp_source.html#l00204">LinearImplicitSystem.hpp:204</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aaff342b69e3dd0e77a1bc084030f795c"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">femus::LinearImplicitSystem::SetPreconditionerFineGrids</a></div><div class="ttdeci">void SetPreconditionerFineGrids(const PreconditionerType &amp;preconditioner_type)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8cpp_source.html#l01047">LinearImplicitSystem.cpp:1047</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aba6bff678d322a8d98c38360e93dab14"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">femus::LinearImplicitSystem::SetLinearEquationSolverType</a></div><div class="ttdeci">void SetLinearEquationSolverType(const LinearEquationSolverType LinearEquationSolverType, const CoarseLevelInclude &amp;includeCoarseLevel=INCLUDE_COARSE_LEVEL_FALSE)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8cpp_source.html#l00981">LinearImplicitSystem.cpp:981</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_abee928911384fcf422b7df9e89bd192c"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">femus::LinearImplicitSystem::SetTolerances</a></div><div class="ttdeci">void SetTolerances(const double &amp;rtol, const double &amp;atol, const double &amp;divtol, const unsigned &amp;maxits, const unsigned &amp;restart=30)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8cpp_source.html#l01057">LinearImplicitSystem.cpp:1057</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_ac02a64ba83b4d1a33a889a677da875fb"><div class="ttname"><a href="classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">femus::LinearImplicitSystem::SetNumberPostSmoothingStep</a></div><div class="ttdeci">void SetNumberPostSmoothingStep(const unsigned &amp;npost)</div><div class="ttdef"><b>Definition</b> <a href="_linear_implicit_system_8hpp_source.html#l00213">LinearImplicitSystem.hpp:213</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a06c4fe014434c2bafdd2c6e94e018620"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">femus::MultiLevelMesh::RefineMesh</a></div><div class="ttdeci">void RefineMesh(const unsigned short &amp;igridn, const unsigned short &amp;igridr, bool(*SetRefinementFlag)(const std::vector&lt; double &gt; &amp;x, const int &amp;ElemGroupNumber, const int &amp;level))</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00495">MultiLevelMesh.cpp:495</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a29d0d0f9463c9417d390da6149ffc24d"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a29d0d0f9463c9417d390da6149ffc24d">femus::MultiLevelMesh::ReadCoarseMesh</a></div><div class="ttdeci">void ReadCoarseMesh(const char mesh_file[], const char GaussOrder[], const double Lref)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00389">MultiLevelMesh.cpp:389</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a65dabdf1e308c1a44ebe5c6a41d09284"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">femus::MultiLevelMesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00541">MultiLevelMesh.cpp:541</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_ac474afe18c6be4e181b2bb72695f57e9"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#ac474afe18c6be4e181b2bb72695f57e9">femus::MultiLevelMesh::EraseCoarseLevels</a></div><div class="ttdeci">void EraseCoarseLevels(unsigned levels_to_be_erased)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00449">MultiLevelMesh.cpp:449</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_non_linear_implicit_system_html_a438462e18c01e8fb08358526c04c50b5"><div class="ttname"><a href="classfemus_1_1_non_linear_implicit_system.html#a438462e18c01e8fb08358526c04c50b5">femus::NonLinearImplicitSystem::MGsolve</a></div><div class="ttdeci">virtual void MGsolve(const MgSmootherType &amp;mgSmootherType=MULTIPLICATIVE)</div><div class="ttdef"><b>Definition</b> <a href="_non_linear_implicit_system_8cpp_source.html#l00155">NonLinearImplicitSystem.cpp:155</a></div></div>
<div class="ttc" id="aclassfemus_1_1_non_linear_implicit_system_html_ad263ecc83efc0d9ea26200bfa3c4cadf"><div class="ttname"><a href="classfemus_1_1_non_linear_implicit_system.html#ad263ecc83efc0d9ea26200bfa3c4cadf">femus::NonLinearImplicitSystem::SetDebugNonlinear</a></div><div class="ttdeci">void SetDebugNonlinear(const bool my_value)</div><div class="ttdef"><b>Definition</b> <a href="_non_linear_implicit_system_8cpp_source.html#l00101">NonLinearImplicitSystem.cpp:101</a></div></div>
<div class="ttc" id="aclassfemus_1_1_non_linear_implicit_system_html_ad2d20975e0c919a9d99bdd9368a0212a"><div class="ttname"><a href="classfemus_1_1_non_linear_implicit_system.html#ad2d20975e0c919a9d99bdd9368a0212a">femus::NonLinearImplicitSystem::init</a></div><div class="ttdeci">virtual void init()</div><div class="ttdef"><b>Definition</b> <a href="_non_linear_implicit_system_8cpp_source.html#l00047">NonLinearImplicitSystem.cpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a42a5b5b5d2c7673b1d4c896762d8db9e"><div class="ttname"><a href="classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">femus::System::SetAssembleFunction</a></div><div class="ttdeci">void SetAssembleFunction(AssembleFunctionType)</div><div class="ttdef"><b>Definition</b> <a href="_system_8cpp_source.html#l00058">System.cpp:58</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a606e07526d7a0d31eed638404ee2ed24"><div class="ttname"><a href="classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">femus::System::AddSolutionToSystemPDE</a></div><div class="ttdeci">virtual void AddSolutionToSystemPDE(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="_system_8cpp_source.html#l00075">System.cpp:75</a></div></div>
<div class="ttc" id="anamespacefemus_1_1ctrl_html_a8b017d48301210dc5d5b3e72566dacb2"><div class="ttname"><a href="namespacefemus_1_1ctrl.html#a8b017d48301210dc5d5b3e72566dacb2">femus::ctrl::use_output_time_folder</a></div><div class="ttdeci">const bool use_output_time_folder</div><div class="ttdef"><b>Definition</b> <a href="param_8hpp_source.html#l00055">param.hpp:55</a></div></div>
<div class="ttc" id="anamespacefemus_1_1ctrl_html_ad6eda0ca8eda8c465a2e3ae5b57f77fe"><div class="ttname"><a href="namespacefemus_1_1ctrl.html#ad6eda0ca8eda8c465a2e3ae5b57f77fe">femus::ctrl::redirect_cout_to_file</a></div><div class="ttdeci">const bool redirect_cout_to_file</div><div class="ttdef"><b>Definition</b> <a href="param_8hpp_source.html#l00056">param.hpp:56</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8b0d45993b678f2b4a8aea9fff7fc87" name="ab8b0d45993b678f2b4a8aea9fff7fc87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b0d45993b678f2b4a8aea9fff7fc87">&#9670;&#160;</a></span>SetBoundaryCondition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryCondition </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>SolName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="07__fractional_8cpp_source.html#l00073">73</a> of file <a class="el" href="07__fractional_8cpp_source.html">07_fractional.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   74</span>{</div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordtype">bool</span> dirichlet = <span class="keyword">true</span>; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">   76</span>  value = 0.;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span><span class="comment">//   if(facename == 1) {</span></div>
<div class="line"><span class="lineno">   79</span><span class="comment">//     dirichlet = true; //dirichlet</span></div>
<div class="line"><span class="lineno">   80</span><span class="comment">//     value = 0.;</span></div>
<div class="line"><span class="lineno">   81</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">   82</span><span class="comment">//   else if(facename == 2) {</span></div>
<div class="line"><span class="lineno">   83</span><span class="comment">//     dirichlet = true; //dirichlet</span></div>
<div class="line"><span class="lineno">   84</span><span class="comment">//     value = 0.;</span></div>
<div class="line"><span class="lineno">   85</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>  <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><span class="lineno">   88</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="dir_0011fd9907a18ae0e94bfb1b854040dc.html">OptimalControl</a></li><li class="navelem"><a class="el" href="dir_294b2a7fc77bdcc85da47c7c0d51e7a5.html">07_fractional</a></li><li class="navelem"><a class="el" href="07__fractional_8cpp.html">07_fractional.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
