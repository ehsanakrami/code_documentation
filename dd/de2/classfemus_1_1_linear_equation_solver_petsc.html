<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: femus::LinearEquationSolverPetsc Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dd/de2/classfemus_1_1_linear_equation_solver_petsc.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d8/d6e/classfemus_1_1_linear_equation_solver_petsc-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">femus::LinearEquationSolverPetsc Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for femus::LinearEquationSolverPetsc:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.png" usemap="#femus::LinearEquationSolverPetsc_map" alt=""/>
  <map id="femus::LinearEquationSolverPetsc_map" name="femus::LinearEquationSolverPetsc_map">
<area href="../../da/d1a/classfemus_1_1_linear_equation_solver.html" alt="femus::LinearEquationSolver" shape="rect" coords="132,112,387,136"/>
<area href="../../da/de0/classfemus_1_1_linear_equation.html" alt="femus::LinearEquation" shape="rect" coords="132,56,387,80"/>
<area href="../../dd/d90/classfemus_1_1_parallel_object.html" alt="femus::ParallelObject" shape="rect" coords="132,0,387,24"/>
<area href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html" alt="femus::LinearEquationSolverPetscAsm" shape="rect" coords="0,224,255,248"/>
<area href="../../dd/dfa/classfemus_1_1_linear_equation_solver_petsc_field_split.html" alt="femus::LinearEquationSolverPetscFieldSplit" shape="rect" coords="265,224,520,248"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a8a7d232b7f2caacdf6d75e3a3e2161c0"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a8a7d232b7f2caacdf6d75e3a3e2161c0">LinearEquationSolverPetsc</a> (const unsigned &amp;igrid, <a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> *other_solution)</td></tr>
<tr class="separator:a8a7d232b7f2caacdf6d75e3a3e2161c0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16e2dd50e43de7f469ed60babd08b837"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a16e2dd50e43de7f469ed60babd08b837">~LinearEquationSolverPetsc</a> ()</td></tr>
<tr class="memdesc:a16e2dd50e43de7f469ed60babd08b837"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor.  <br /></td></tr>
<tr class="separator:a16e2dd50e43de7f469ed60babd08b837"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76babcafc38f42ee0137d571fb994637"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a76babcafc38f42ee0137d571fb994637">initialized</a> () const</td></tr>
<tr class="separator:a76babcafc38f42ee0137d571fb994637"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaa2b64c70fa22d84a2d2aeb7aba62bf3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aaa2b64c70fa22d84a2d2aeb7aba62bf3">SetPrintSolverInfo</a> (const bool &amp;printInfo)</td></tr>
<tr class="separator:aaa2b64c70fa22d84a2d2aeb7aba62bf3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8806dab2868fc1b793cb6607920bcd09"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a8806dab2868fc1b793cb6607920bcd09">set_solver_type</a> (const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> st)</td></tr>
<tr class="separator:a8806dab2868fc1b793cb6607920bcd09"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a324c2db823c76cbafd00a94e04c99aad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a324c2db823c76cbafd00a94e04c99aad">solver_type</a> () const</td></tr>
<tr class="separator:a324c2db823c76cbafd00a94e04c99aad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43f59d053804f858ca075c8f5e39834c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a43f59d053804f858ca075c8f5e39834c">set_preconditioner_type</a> (const <a class="el" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cf">PreconditionerType</a> pct)</td></tr>
<tr class="separator:a43f59d053804f858ca075c8f5e39834c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6beb9feba179b5443d4cdd05e2fd46f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a6beb9feba179b5443d4cdd05e2fd46f4">attach_preconditioner</a> (<a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a> *<a class="el" href="../../d2/d9c/ex11__2_8cpp.html#a36a5c6ba3526e148ea73529d031cfe7b">preconditioner</a>)</td></tr>
<tr class="separator:a6beb9feba179b5443d4cdd05e2fd46f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a23b3ae3499f28474a3e97495ef711d65"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cf">PreconditionerType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a23b3ae3499f28474a3e97495ef711d65">preconditioner_type</a> () const</td></tr>
<tr class="separator:a23b3ae3499f28474a3e97495ef711d65"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af467f11da786efe6d12b230a58b54eb7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#af467f11da786efe6d12b230a58b54eb7">SetElementBlockNumber</a> (const unsigned &amp;block_elemet_number)</td></tr>
<tr class="separator:af467f11da786efe6d12b230a58b54eb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa54d0fc18a6ca183b89d038495a7f8f1"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aa54d0fc18a6ca183b89d038495a7f8f1">SetElementBlockNumber</a> (const char all[], const unsigned &amp;overlap=1)</td></tr>
<tr class="separator:aa54d0fc18a6ca183b89d038495a7f8f1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66952f3530ccf677bac20da7ef3b15e0"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a66952f3530ccf677bac20da7ef3b15e0">SetElementBlockNumberFluid</a> (const unsigned &amp;block_elemet_number, const unsigned &amp;overlap)</td></tr>
<tr class="separator:a66952f3530ccf677bac20da7ef3b15e0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aad722059ff7cecc7de89a470c831351f"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aad722059ff7cecc7de89a470c831351f">SetElementBlockNumberSolid</a> (const unsigned &amp;block_elemet_number, const unsigned &amp;overlap)</td></tr>
<tr class="separator:aad722059ff7cecc7de89a470c831351f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7cfb02af590c30fe0437ee89aed2daf7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a7cfb02af590c30fe0437ee89aed2daf7">SetElementBlockNumberPorous</a> (const unsigned &amp;block_elemet_number, const unsigned &amp;overlap)</td></tr>
<tr class="separator:a7cfb02af590c30fe0437ee89aed2daf7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a09c6e1700ba25b46e3195ea2f7a602c5"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a09c6e1700ba25b46e3195ea2f7a602c5">SetNumberOfSchurVariables</a> (const unsigned short &amp;NSchurVar)</td></tr>
<tr class="separator:a09c6e1700ba25b46e3195ea2f7a602c5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62683a501b58f6bbda90f7b1d15b1f5a"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a62683a501b58f6bbda90f7b1d15b1f5a">SetFieldSplitTree</a> (<a class="el" href="../../d9/d1f/classfemus_1_1_field_split_tree.html">FieldSplitTree</a> *fieldSplitTree)</td></tr>
<tr class="separator:a62683a501b58f6bbda90f7b1d15b1f5a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0225c6bdb0c0a648df9fff0597b41a8b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a0225c6bdb0c0a648df9fff0597b41a8b">InitPde</a> (const std::vector&lt; unsigned &gt; &amp;<a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>, const std::vector&lt; unsigned &gt; &amp;SolType, const std::vector&lt; char * &gt; &amp;SolName, std::vector&lt; <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> * &gt; *Bdc_other, const unsigned &amp;other_gridn, std::vector&lt; bool &gt; &amp;SparsityPattern_other)</td></tr>
<tr class="separator:a0225c6bdb0c0a648df9fff0597b41a8b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a860b182e81b87527451d0dce8d80a50e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a860b182e81b87527451d0dce8d80a50e">DeletePde</a> ()</td></tr>
<tr class="separator:a860b182e81b87527451d0dce8d80a50e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a371874e189850ea153741747a5257343"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a371874e189850ea153741747a5257343">AddLevel</a> ()</td></tr>
<tr class="separator:a371874e189850ea153741747a5257343"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e339f53ed51e108cd33e1577dae9c18"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> (const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</td></tr>
<tr class="separator:a4e339f53ed51e108cd33e1577dae9c18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a97d5328122e7841e3edd0713947b2031"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a97d5328122e7841e3edd0713947b2031">GetSystemDof</a> (const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;ielc, const unsigned &amp;i0, const unsigned &amp;i1, const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *mshc) const</td></tr>
<tr class="separator:a97d5328122e7841e3edd0713947b2031"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ff186621626e25f0001b00e493dc3cc"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a3ff186621626e25f0001b00e493dc3cc">GetSystemDof</a> (const unsigned &amp;soltype, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel, const std::vector&lt; std::vector&lt; unsigned &gt; &gt; &amp;otherKKoffset) const</td></tr>
<tr class="separator:a3ff186621626e25f0001b00e493dc3cc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a220ecdfa001bbb23c8aabe40139620e2"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a> () const</td></tr>
<tr class="separator:a220ecdfa001bbb23c8aabe40139620e2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3aa325f74068742d2c4b235ee6578e69"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a3aa325f74068742d2c4b235ee6578e69">SwapMatrices</a> ()</td></tr>
<tr class="separator:a3aa325f74068742d2c4b235ee6578e69"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad3053db3500d06e996703acf43efbcd7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ad3053db3500d06e996703acf43efbcd7">GetSparsityPatternSize</a> ()</td></tr>
<tr class="separator:ad3053db3500d06e996703acf43efbcd7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a84e6b95a07737bc62ce4aff323c83ae8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a84e6b95a07737bc62ce4aff323c83ae8">SetSparsityPatternMinimumSize</a> (const std::vector&lt; unsigned &gt; &amp;minimumSize, const std::vector&lt; unsigned &gt; &amp;variableIndex)</td></tr>
<tr class="separator:a84e6b95a07737bc62ce4aff323c83ae8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68c86878db3eacf62e0fef5ee907470a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a68c86878db3eacf62e0fef5ee907470a">sparsity_pattern_print_nonzeros</a> (const std::string filename_base, const std::string on_or_off)</td></tr>
<tr class="separator:a68c86878db3eacf62e0fef5ee907470a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2f47f968a0f140be0a127d20f5476ac"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ab2f47f968a0f140be0a127d20f5476ac">print_residual_with_structure_matlab_friendly</a> (const unsigned iproc, const std::string filename_base, <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> *num_vec_in) const</td></tr>
<tr class="separator:ab2f47f968a0f140be0a127d20f5476ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a81de0961933510a8e2e035be1cfb4730"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a81de0961933510a8e2e035be1cfb4730">SetResZero</a> ()</td></tr>
<tr class="separator:a81de0961933510a8e2e035be1cfb4730"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adeac6aca70228a86f274b8589d464207"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#adeac6aca70228a86f274b8589d464207">UpdateResidual</a> ()</td></tr>
<tr class="separator:adeac6aca70228a86f274b8589d464207"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1beb93193b619ce9d6adae4977c2e993"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a1beb93193b619ce9d6adae4977c2e993">SetEpsZero</a> ()</td></tr>
<tr class="separator:a1beb93193b619ce9d6adae4977c2e993"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab6c32f709a8f531e108109faaf440fef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ab6c32f709a8f531e108109faaf440fef">SumEpsCToEps</a> ()</td></tr>
<tr class="separator:ab6c32f709a8f531e108109faaf440fef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8807dc8b1f49964bf5fd86ea9404751"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#aa8807dc8b1f49964bf5fd86ea9404751">SetNumberOfGlobalVariables</a> (const unsigned &amp;numberOfGlobalVariables)</td></tr>
<tr class="separator:aa8807dc8b1f49964bf5fd86ea9404751"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6629fca51be192be664c76eb8aecc79"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a> () const</td></tr>
<tr class="separator:af6629fca51be192be664c76eb8aecc79"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6438b3ffcc8cde2d6ccfb4ec563dfce1"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a> () const</td></tr>
<tr class="separator:a6438b3ffcc8cde2d6ccfb4ec563dfce1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a5dfc029bb5b3b20d9687b11c376cc473"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a5dfc029bb5b3b20d9687b11c376cc473">SetPetscSolverType</a> (KSP &amp;ksp, const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> &amp;<a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a324c2db823c76cbafd00a94e04c99aad">solver_type</a>, const double *parameter)</td></tr>
<tr class="memdesc:a5dfc029bb5b3b20d9687b11c376cc473"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set PETSC solver.  <br /></td></tr>
<tr class="separator:a5dfc029bb5b3b20d9687b11c376cc473"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55adbde126e5101c253c518e3da65afd"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a55adbde126e5101c253c518e3da65afd">build</a> (const unsigned &amp;igrid, <a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> *other_solution, const <a class="el" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9">LinearEquationSolverType</a> &amp;smoother_type, const <a class="el" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fe">SolverPackage</a> solver_package=LSOLVER)</td></tr>
<tr class="separator:a55adbde126e5101c253c518e3da65afd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ae3ec0b2dd39e7527448bc35f108f6093"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; unsigned &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a></td></tr>
<tr class="separator:ae3ec0b2dd39e7527448bc35f108f6093"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5f1126279cb193c88f8bd2e85341f31e"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a></td></tr>
<tr class="separator:a5f1126279cb193c88f8bd2e85341f31e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa10eb0eb318cf0d449f5ecdcec2823bc"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a></td></tr>
<tr class="separator:aa10eb0eb318cf0d449f5ecdcec2823bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab824eb4b9859c3dff871f537d702d987"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">_KKamr</a></td></tr>
<tr class="separator:ab824eb4b9859c3dff871f537d702d987"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae819a67a7c62b49373dd257e11466e5e"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a></td></tr>
<tr class="separator:ae819a67a7c62b49373dd257e11466e5e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22675b9d542dc58b67f4d2cba10a4c0d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a></td></tr>
<tr class="separator:a22675b9d542dc58b67f4d2cba10a4c0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f79930715e7e6c8b0ec81ee506a4ef0"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a></td></tr>
<tr class="separator:a7f79930715e7e6c8b0ec81ee506a4ef0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5248622081d9f5559ae84074d6fb4f30"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a></td></tr>
<tr class="separator:a5248622081d9f5559ae84074d6fb4f30"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:acb9a9f48db723e8a4700b1e78dbe93c8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acb9a9f48db723e8a4700b1e78dbe93c8">Clear</a> ()</td></tr>
<tr class="memdesc:acb9a9f48db723e8a4700b1e78dbe93c8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Release all memory and clear data structures.  <br /></td></tr>
<tr class="separator:acb9a9f48db723e8a4700b1e78dbe93c8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08129728358297604c33b670372e1e5c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a08129728358297604c33b670372e1e5c">SetTolerances</a> (const double &amp;rtol, const double &amp;atol, const double &amp;divtol, const unsigned &amp;maxits, const unsigned &amp;restart)</td></tr>
<tr class="separator:a08129728358297604c33b670372e1e5c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a13cb95513c710a4445ae179e981663d1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a13cb95513c710a4445ae179e981663d1">Init</a> (Mat &amp;Amat, Mat &amp;Pmat)</td></tr>
<tr class="separator:a13cb95513c710a4445ae179e981663d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6dbbb65cbcf869df47bc73ebb19689ba"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a6dbbb65cbcf869df47bc73ebb19689ba">Solve</a> (const std::vector&lt; unsigned &gt; &amp;variable_to_be_solved, const bool &amp;ksp_clean)</td></tr>
<tr class="separator:a6dbbb65cbcf869df47bc73ebb19689ba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2a3d5db15d339ecbd4181ba42965568"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ab2a3d5db15d339ecbd4181ba42965568">MGInit</a> (const <a class="el" href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8">MgSmootherType</a> &amp;mg_smoother_type, const unsigned &amp;levelMax, const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> &amp;mgSolverType)</td></tr>
<tr class="separator:ab2a3d5db15d339ecbd4181ba42965568"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a19998642dc1a8853d8a36cccae3f2224"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a19998642dc1a8853d8a36cccae3f2224">MGSetLevel</a> (<a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a> *LinSolver, const unsigned &amp;maxlevel, const std::vector&lt; unsigned &gt; &amp;variable_to_be_solved, <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *PP, <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *RR, const unsigned &amp;npre, const unsigned &amp;npost)</td></tr>
<tr class="separator:a19998642dc1a8853d8a36cccae3f2224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:affda1228209a0acafbbaa4e179d4d516"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#affda1228209a0acafbbaa4e179d4d516">RemoveNullSpace</a> ()</td></tr>
<tr class="separator:affda1228209a0acafbbaa4e179d4d516"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d6585056575a152842422596e64a0f4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a3d6585056575a152842422596e64a0f4">GetNullSpaceBase</a> (std::vector&lt; Vec &gt; &amp;nullspBase)</td></tr>
<tr class="separator:a3d6585056575a152842422596e64a0f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aba7244a1ff374a9a2099d1109d97f28f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aba7244a1ff374a9a2099d1109d97f28f">ZerosBoundaryResiduals</a> ()</td></tr>
<tr class="separator:aba7244a1ff374a9a2099d1109d97f28f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aae35adda9653bd3682791e00539edefc"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aae35adda9653bd3682791e00539edefc">SetPenalty</a> ()</td></tr>
<tr class="separator:aae35adda9653bd3682791e00539edefc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad29078ec2004ac2de5f6ee9c8d2eab78"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ad29078ec2004ac2de5f6ee9c8d2eab78">SetRichardsonScaleFactor</a> (const double &amp;richardsonScaleFactor)</td></tr>
<tr class="separator:ad29078ec2004ac2de5f6ee9c8d2eab78"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad64712ae2d655fc49c58814f7411c334"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ad64712ae2d655fc49c58814f7411c334">BuildBdcIndex</a> (const std::vector&lt; unsigned &gt; &amp;variable_to_be_solved)</td></tr>
<tr class="separator:ad64712ae2d655fc49c58814f7411c334"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a716f7336380f1a4093d3c5657284fde7"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a716f7336380f1a4093d3c5657284fde7">SetPreconditioner</a> (KSP &amp;subksp, PC &amp;subpc)</td></tr>
<tr class="separator:a716f7336380f1a4093d3c5657284fde7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abb2f6b45aba268e628d8bd928cc267c7"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#abb2f6b45aba268e628d8bd928cc267c7">MGSolve</a> (const bool ksp_clean)</td></tr>
<tr class="separator:abb2f6b45aba268e628d8bd928cc267c7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a30aa95e533fef8ca0e123f0aecefe557"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a30aa95e533fef8ca0e123f0aecefe557">MGClear</a> ()</td></tr>
<tr class="separator:a30aa95e533fef8ca0e123f0aecefe557"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e0ac73808d4973cc54af92605e11421"><td class="memItemLeft" align="right" valign="top">KSP *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a7e0ac73808d4973cc54af92605e11421">GetKSP</a> ()</td></tr>
<tr class="separator:a7e0ac73808d4973cc54af92605e11421"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a411eac388d69b468ca820cf252c06dad"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a411eac388d69b468ca820cf252c06dad">SetSolver</a> (KSP &amp;ksp, const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> &amp;<a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a324c2db823c76cbafd00a94e04c99aad">solver_type</a>)</td></tr>
<tr class="separator:a411eac388d69b468ca820cf252c06dad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef570270d97edc107a2957ea99a49398"><td class="memItemLeft" align="right" valign="top">std::pair&lt; unsigned int, double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aef570270d97edc107a2957ea99a49398">solve</a> (<a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;matrix_in, <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;precond_in, <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;solution_in, <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;rhs_in, const double tol, const unsigned int m_its)</td></tr>
<tr class="separator:aef570270d97edc107a2957ea99a49398"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afbc6834611d0a447a5fa3e2c7f7ffabf"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#afbc6834611d0a447a5fa3e2c7f7ffabf">init</a> (<a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *<a class="el" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a>)</td></tr>
<tr class="separator:afbc6834611d0a447a5fa3e2c7f7ffabf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6f9872dad722bd16c70bc054c3dc618"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ae6f9872dad722bd16c70bc054c3dc618">GetIndex</a> (const char name[])</td></tr>
<tr class="separator:ae6f9872dad722bd16c70bc054c3dc618"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:ac5bf225db84f5c6f1fd81e927f7c61b1"><td class="memItemLeft" align="right" valign="top">KSP&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a></td></tr>
<tr class="memdesc:ac5bf225db84f5c6f1fd81e927f7c61b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Krylov subspace context.  <br /></td></tr>
<tr class="separator:ac5bf225db84f5c6f1fd81e927f7c61b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f1863719353c8ca3a9d7f9ba5723875"><td class="memItemLeft" align="right" valign="top">PC&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a></td></tr>
<tr class="memdesc:a2f1863719353c8ca3a9d7f9ba5723875"><td class="mdescLeft">&#160;</td><td class="mdescRight"><a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a> context.  <br /></td></tr>
<tr class="separator:a2f1863719353c8ca3a9d7f9ba5723875"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12be6e63b0980ad661ac0b5f1db07677"><td class="memItemLeft" align="right" valign="top">PetscReal&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a12be6e63b0980ad661ac0b5f1db07677">_rtol</a></td></tr>
<tr class="separator:a12be6e63b0980ad661ac0b5f1db07677"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acc02d3a5864f2c8534190b109fdcf0a1"><td class="memItemLeft" align="right" valign="top">PetscReal&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acc02d3a5864f2c8534190b109fdcf0a1">_abstol</a></td></tr>
<tr class="separator:acc02d3a5864f2c8534190b109fdcf0a1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a099f48f80b5eca34c976a932bcac5243"><td class="memItemLeft" align="right" valign="top">PetscReal&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a099f48f80b5eca34c976a932bcac5243">_dtol</a></td></tr>
<tr class="separator:a099f48f80b5eca34c976a932bcac5243"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2da36631345b3bf33696f6c8f5882dc4"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2da36631345b3bf33696f6c8f5882dc4">_maxits</a></td></tr>
<tr class="separator:a2da36631345b3bf33696f6c8f5882dc4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a595c4b08e58212f1d93c1518e51bdb43"><td class="memItemLeft" align="right" valign="top">PetscInt&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a595c4b08e58212f1d93c1518e51bdb43">_restart</a></td></tr>
<tr class="separator:a595c4b08e58212f1d93c1518e51bdb43"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a14805f7b09557f9cf35a73a72e3c82d1"><td class="memItemLeft" align="right" valign="top">std::vector&lt; PetscInt &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a></td></tr>
<tr class="separator:a14805f7b09557f9cf35a73a72e3c82d1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab048018b0a8274ee43ae0b59977f591b"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ab048018b0a8274ee43ae0b59977f591b">_bdcIndexIsInitialized</a></td></tr>
<tr class="separator:ab048018b0a8274ee43ae0b59977f591b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a853956e789f4855a80e2f96359ba0b60"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a></td></tr>
<tr class="separator:a853956e789f4855a80e2f96359ba0b60"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a17783185d47a441d545cf1427d2624ee"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a17783185d47a441d545cf1427d2624ee">_is_initialized</a></td></tr>
<tr class="separator:a17783185d47a441d545cf1427d2624ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7058888fb57ea520cce21647a69db329"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a7058888fb57ea520cce21647a69db329">_printSolverInfo</a></td></tr>
<tr class="separator:a7058888fb57ea520cce21647a69db329"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab379639fae0d6cf1783d1ffa6a1f6a0a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a></td></tr>
<tr class="separator:ab379639fae0d6cf1783d1ffa6a1f6a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a610f329a44512e94e0794c2e85bca1ee"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a610f329a44512e94e0794c2e85bca1ee">_mgSolverType</a></td></tr>
<tr class="separator:a610f329a44512e94e0794c2e85bca1ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeb95e2f8a6a1c23b54278252f4f418ad"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cf">PreconditionerType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a></td></tr>
<tr class="separator:aeb95e2f8a6a1c23b54278252f4f418ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae7d568d4a992a82d1b06903cb7e384fb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a></td></tr>
<tr class="separator:ae7d568d4a992a82d1b06903cb7e384fb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0a3207fb3cca0f45b8909812f64f6efa"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a0a3207fb3cca0f45b8909812f64f6efa">same_preconditioner</a></td></tr>
<tr class="memdesc:a0a3207fb3cca0f45b8909812f64f6efa"><td class="mdescLeft">&#160;</td><td class="mdescRight">Boolean flag to indicate whether we want to use an identical preconditioner to the previous solve.  <br /></td></tr>
<tr class="separator:a0a3207fb3cca0f45b8909812f64f6efa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9e44f8c783de0cfd5dae745305882f21"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a9e44f8c783de0cfd5dae745305882f21">_gridn</a></td></tr>
<tr class="separator:a9e44f8c783de0cfd5dae745305882f21"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a59a6274d7ad89115708f2e654dca326b"><td class="memItemLeft" align="right" valign="top">std::vector&lt; bool &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a></td></tr>
<tr class="separator:a59a6274d7ad89115708f2e654dca326b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ada4422410129b056d30d9bec6373398a"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">_sparsityPatternMinimumSize</a></td></tr>
<tr class="separator:ada4422410129b056d30d9bec6373398a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8585849c6da7f7415bc2939e86476f2"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ae8585849c6da7f7415bc2939e86476f2">_sparsityPatternVariableIndex</a></td></tr>
<tr class="separator:ae8585849c6da7f7415bc2939e86476f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5dd44a3538606bda13d2fcdfea5c2b35"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a></td></tr>
<tr class="separator:a5dd44a3538606bda13d2fcdfea5c2b35"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad42d4d0d6a54f6df97afa82f4eec7a0c"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">_numberOfGlobalVariables</a></td></tr>
<tr class="separator:ad42d4d0d6a54f6df97afa82f4eec7a0c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a453ddac90679e3447fa774a52e3d2214"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a453ddac90679e3447fa774a52e3d2214">_solution</a></td></tr>
<tr class="separator:a453ddac90679e3447fa774a52e3d2214"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a777130e1a7e1342528f816e09c56be01"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a></td></tr>
<tr class="separator:a777130e1a7e1342528f816e09c56be01"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a25739bd6cc78282815fa4dfe79ed3885"><td class="memItemLeft" align="right" valign="top">std::vector&lt; char * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a25739bd6cc78282815fa4dfe79ed3885">_SolName</a></td></tr>
<tr class="separator:a25739bd6cc78282815fa4dfe79ed3885"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afa321f16b5b88902150fddb437a1745b"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> * &gt; *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#afa321f16b5b88902150fddb437a1745b">_Bdc</a></td></tr>
<tr class="separator:afa321f16b5b88902150fddb437a1745b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ee45f5bc96766fa25c736a40674e551"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a></td></tr>
<tr class="separator:a0ee45f5bc96766fa25c736a40674e551"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15b46748a2e26bc263e3e6e4690e8a3b"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dd/d90/classfemus_1_1_parallel_object.html#a15b46748a2e26bc263e3e6e4690e8a3b">_iproc</a></td></tr>
<tr class="separator:a15b46748a2e26bc263e3e6e4690e8a3b"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:aea3bb5e946dca1be0fa0bf40e2ccae73"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a></td></tr>
<tr class="separator:aea3bb5e946dca1be0fa0bf40e2ccae73"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6ce9ed56da9e3475fcd4926bb5d782d"><td class="memItemLeft" align="right" valign="top">std::vector&lt; unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#af6ce9ed56da9e3475fcd4926bb5d782d">KKghostsize</a></td></tr>
<tr class="separator:af6ce9ed56da9e3475fcd4926bb5d782d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a541098ff691f1c1268d071581426eddf"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::vector&lt; int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a541098ff691f1c1268d071581426eddf">KKghost_nd</a></td></tr>
<tr class="separator:a541098ff691f1c1268d071581426eddf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a62a2a1ed0ecb5758eedb242fa5fdd461"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a></td></tr>
<tr class="separator:a62a2a1ed0ecb5758eedb242fa5fdd461"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4613cf9a418f8a61220a705e30843ade"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a></td></tr>
<tr class="separator:a4613cf9a418f8a61220a705e30843ade"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>This class inherits the abstract class <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>. In this class the solver is implemented using the PETSc package </p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00038">38</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a8a7d232b7f2caacdf6d75e3a3e2161c0" name="a8a7d232b7f2caacdf6d75e3a3e2161c0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a7d232b7f2caacdf6d75e3a3e2161c0">&#9670;&#160;</a></span>LinearEquationSolverPetsc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::LinearEquationSolverPetsc::LinearEquationSolverPetsc </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>igrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> *&#160;</td>
          <td class="paramname"><em>other_solution</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor. Initializes Petsc data structures </p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00128">128</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  129</span>    : <a class="code hl_function" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#afa8a2758d8652ab34789d9e9d06251fa">LinearEquationSolver</a> (igrid, other_solution) {</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>    <span class="keywordflow">if</span> (igrid == 0) {</div>
<div class="line"><span class="lineno">  132</span>      this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a> = <a class="code hl_enumvalue" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da">MLU_PRECOND</a>;</div>
<div class="line"><span class="lineno">  133</span>      this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a>         = <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>;</div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  136</span>      this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a> = <a class="code hl_enumvalue" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a>;</div>
<div class="line"><span class="lineno">  137</span>      this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a>         = <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>;</div>
<div class="line"><span class="lineno">  138</span>    }</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a12be6e63b0980ad661ac0b5f1db07677">_rtol</a>   = 1.e-5;</div>
<div class="line"><span class="lineno">  141</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acc02d3a5864f2c8534190b109fdcf0a1">_abstol</a> = 1.e-50;</div>
<div class="line"><span class="lineno">  142</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a099f48f80b5eca34c976a932bcac5243">_dtol</a>   = 1.e+5;</div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2da36631345b3bf33696f6c8f5882dc4">_maxits</a> = 1000;</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a595c4b08e58212f1d93c1518e51bdb43">_restart</a> = 30;</div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a> = 0.5;</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ab048018b0a8274ee43ae0b59977f591b">_bdcIndexIsInitialized</a> = 0;</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a7058888fb57ea520cce21647a69db329">_printSolverInfo</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>  }</div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da"><div class="ttname"><a href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da">MLU_PRECOND</a></div><div class="ttdeci">@ MLU_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d70/_precondtype_enum_8hpp_source.html#l00024">PrecondtypeEnum.hpp:24</a></div></div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea"><div class="ttname"><a href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a></div><div class="ttdeci">@ ILU_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d70/_precondtype_enum_8hpp_source.html#l00016">PrecondtypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a></div><div class="ttdeci">@ PREONLY</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00028">SolvertypeEnum.hpp:27</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a></div><div class="ttdeci">@ GMRES</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00016">SolvertypeEnum.hpp:16</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_a7058888fb57ea520cce21647a69db329"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a7058888fb57ea520cce21647a69db329">femus::LinearEquationSolver::_printSolverInfo</a></div><div class="ttdeci">bool _printSolverInfo</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00104">LinearEquationSolver.hpp:104</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_ab379639fae0d6cf1783d1ffa6a1f6a0a"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">femus::LinearEquationSolver::_levelSolverType</a></div><div class="ttdeci">SolverType _levelSolverType</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00150">LinearEquationSolver.hpp:150</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_aeb95e2f8a6a1c23b54278252f4f418ad"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">femus::LinearEquationSolver::_preconditioner_type</a></div><div class="ttdeci">PreconditionerType _preconditioner_type</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00202">LinearEquationSolver.hpp:202</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_afa8a2758d8652ab34789d9e9d06251fa"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#afa8a2758d8652ab34789d9e9d06251fa">femus::LinearEquationSolver::LinearEquationSolver</a></div><div class="ttdeci">LinearEquationSolver(const unsigned &amp;igrid, Solution *other_solution)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00267">LinearEquationSolver.hpp:267</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a099f48f80b5eca34c976a932bcac5243"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a099f48f80b5eca34c976a932bcac5243">femus::LinearEquationSolverPetsc::_dtol</a></div><div class="ttdeci">PetscReal _dtol</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00115">LinearEquationSolverPetsc.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a12be6e63b0980ad661ac0b5f1db07677"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a12be6e63b0980ad661ac0b5f1db07677">femus::LinearEquationSolverPetsc::_rtol</a></div><div class="ttdeci">PetscReal _rtol</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00113">LinearEquationSolverPetsc.hpp:113</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a2da36631345b3bf33696f6c8f5882dc4"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2da36631345b3bf33696f6c8f5882dc4">femus::LinearEquationSolverPetsc::_maxits</a></div><div class="ttdeci">PetscInt _maxits</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00116">LinearEquationSolverPetsc.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a595c4b08e58212f1d93c1518e51bdb43"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a595c4b08e58212f1d93c1518e51bdb43">femus::LinearEquationSolverPetsc::_restart</a></div><div class="ttdeci">PetscInt _restart</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00117">LinearEquationSolverPetsc.hpp:117</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a853956e789f4855a80e2f96359ba0b60"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">femus::LinearEquationSolverPetsc::_richardsonScaleFactor</a></div><div class="ttdeci">double _richardsonScaleFactor</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00122">LinearEquationSolverPetsc.hpp:122</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_ab048018b0a8274ee43ae0b59977f591b"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ab048018b0a8274ee43ae0b59977f591b">femus::LinearEquationSolverPetsc::_bdcIndexIsInitialized</a></div><div class="ttdeci">bool _bdcIndexIsInitialized</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00120">LinearEquationSolverPetsc.hpp:120</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_acc02d3a5864f2c8534190b109fdcf0a1"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acc02d3a5864f2c8534190b109fdcf0a1">femus::LinearEquationSolverPetsc::_abstol</a></div><div class="ttdeci">PetscReal _abstol</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00114">LinearEquationSolverPetsc.hpp:114</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16e2dd50e43de7f469ed60babd08b837" name="a16e2dd50e43de7f469ed60babd08b837"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16e2dd50e43de7f469ed60babd08b837">&#9670;&#160;</a></span>~LinearEquationSolverPetsc()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::LinearEquationSolverPetsc::~LinearEquationSolverPetsc </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00155">155</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  155</span>                                                               {</div>
<div class="line"><span class="lineno">  156</span>    this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acb9a9f48db723e8a4700b1e78dbe93c8">Clear</a>();</div>
<div class="line"><span class="lineno">  157</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_acb9a9f48db723e8a4700b1e78dbe93c8"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acb9a9f48db723e8a4700b1e78dbe93c8">femus::LinearEquationSolverPetsc::Clear</a></div><div class="ttdeci">void Clear()</div><div class="ttdoc">Release all memory and clear data structures.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00161">LinearEquationSolverPetsc.hpp:161</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a371874e189850ea153741747a5257343" name="a371874e189850ea153741747a5257343"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a371874e189850ea153741747a5257343">&#9670;&#160;</a></span>AddLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::AddLevel </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>AddLevel </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00351">351</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  351</span>                                {</div>
<div class="line"><span class="lineno">  352</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a9e44f8c783de0cfd5dae745305882f21">_gridn</a>++;</div>
<div class="line"><span class="lineno">  353</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a9e44f8c783de0cfd5dae745305882f21"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a9e44f8c783de0cfd5dae745305882f21">femus::LinearEquation::_gridn</a></div><div class="ttdeci">unsigned _gridn</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00082">LinearEquation.hpp:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6beb9feba179b5443d4cdd05e2fd46f4" name="a6beb9feba179b5443d4cdd05e2fd46f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6beb9feba179b5443d4cdd05e2fd46f4">&#9670;&#160;</a></span>attach_preconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolver::attach_preconditioner </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a> *&#160;</td>
          <td class="paramname"><em>preconditioner</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Attaches a <a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a> object to be used </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html#l00091">91</a> of file <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html">LinearEquationSolver.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   92</span>  {</div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordflow">if</span>(this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a17783185d47a441d545cf1427d2624ee">_is_initialized</a>)  {</div>
<div class="line"><span class="lineno">   94</span>      std::cerr &lt;&lt; <span class="stringliteral">&quot;Preconditioner must be attached before the solver is initialized!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   95</span>      abort();</div>
<div class="line"><span class="lineno">   96</span>    }</div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a> = <a class="code hl_enumvalue" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfac2b6f66fa0da27da562ef32376677d63">SHELL_PRECOND</a>;</div>
<div class="line"><span class="lineno">   98</span>    <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a> = <a class="code hl_variable" href="../../d2/d9c/ex11__2_8cpp.html#a36a5c6ba3526e148ea73529d031cfe7b">preconditioner</a>;</div>
<div class="line"><span class="lineno">   99</span>  }</div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfac2b6f66fa0da27da562ef32376677d63"><div class="ttname"><a href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfac2b6f66fa0da27da562ef32376677d63">SHELL_PRECOND</a></div><div class="ttdeci">@ SHELL_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d70/_precondtype_enum_8hpp_source.html#l00019">PrecondtypeEnum.hpp:19</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_a17783185d47a441d545cf1427d2624ee"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a17783185d47a441d545cf1427d2624ee">femus::LinearEquationSolver::_is_initialized</a></div><div class="ttdeci">bool _is_initialized</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00088">LinearEquationSolver.hpp:88</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_ae7d568d4a992a82d1b06903cb7e384fb"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">femus::LinearEquationSolver::_preconditioner</a></div><div class="ttdeci">Preconditioner * _preconditioner</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00205">LinearEquationSolver.hpp:205</a></div></div>
<div class="ttc" id="aex11__2_8cpp_html_a36a5c6ba3526e148ea73529d031cfe7b"><div class="ttname"><a href="../../d2/d9c/ex11__2_8cpp.html#a36a5c6ba3526e148ea73529d031cfe7b">preconditioner</a></div><div class="ttdeci">unsigned preconditioner</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d9c/ex11__2_8cpp_source.html#l00075">ex11_2.cpp:75</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a55adbde126e5101c253c518e3da65afd" name="a55adbde126e5101c253c518e3da65afd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55adbde126e5101c253c518e3da65afd">&#9670;&#160;</a></span>build()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a> &gt; femus::LinearEquationSolver::build </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>igrid</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> *&#160;</td>
          <td class="paramname"><em>other_solution</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9">LinearEquationSolverType</a> &amp;&#160;</td>
          <td class="paramname"><em>smoother_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fe">SolverPackage</a>&#160;</td>
          <td class="paramname"><em>solver_package</em> = <code>LSOLVER</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Builds a <code><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a></code> using the linear solver in <code>solver_package</code> </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html#l00040">40</a> of file <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html">LinearEquationSolver.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>  {</div>
<div class="line"><span class="lineno">   42</span>    <span class="comment">// Build the appropriate solver</span></div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">switch</span>(solver_package)  {</div>
<div class="line"><span class="lineno">   45</span><span class="preprocessor">#ifdef HAVE_PETSC</span></div>
<div class="line"><span class="lineno">   46</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea0c85f2467c937723b91a9219b0b55399">PETSC_SOLVERS</a>:  {</div>
<div class="line"><span class="lineno">   47</span>          <span class="keywordflow">switch</span>(smoother_type) {</div>
<div class="line"><span class="lineno">   48</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a>: {</div>
<div class="line"><span class="lineno">   49</span>                std::unique_ptr&lt;LinearEquationSolver&gt; <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>(<span class="keyword">new</span> LinearEquationSolverPetsc(igrid, other_solution));</div>
<div class="line"><span class="lineno">   50</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>;</div>
<div class="line"><span class="lineno">   51</span>              }</div>
<div class="line"><span class="lineno">   52</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e">FEMuS_ASM</a>: {</div>
<div class="line"><span class="lineno">   53</span>                std::unique_ptr&lt;LinearEquationSolver&gt; <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>(<span class="keyword">new</span> LinearEquationSolverPetscAsm(igrid, other_solution));</div>
<div class="line"><span class="lineno">   54</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>;</div>
<div class="line"><span class="lineno">   55</span>              }</div>
<div class="line"><span class="lineno">   56</span>            <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ae3253e9bd449a5d8e1395d58e0bca946">FEMuS_FIELDSPLIT</a>: {</div>
<div class="line"><span class="lineno">   57</span>                std::unique_ptr&lt;LinearEquationSolver&gt; <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>(<span class="keyword">new</span> LinearEquationSolverPetscFieldSplit(igrid, other_solution));</div>
<div class="line"><span class="lineno">   58</span>                <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>;</div>
<div class="line"><span class="lineno">   59</span>              }</div>
<div class="line"><span class="lineno">   60</span>          }</div>
<div class="line"><span class="lineno">   61</span>        }</div>
<div class="line"><span class="lineno">   62</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   63</span><span class="preprocessor">#ifdef HAVE_TRILINOS</span></div>
<div class="line"><span class="lineno">   64</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea4ab73e197d88ce3b742bcd4bcc0bd5e4">TRILINOS_SOLVERS</a>:  {</div>
<div class="line"><span class="lineno">   65</span>          std::unique_ptr&lt;LinearEquationSolver&gt; <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>(<span class="keyword">new</span> AztecLinearEquationSolver);</div>
<div class="line"><span class="lineno">   66</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>;</div>
<div class="line"><span class="lineno">   67</span>        }</div>
<div class="line"><span class="lineno">   68</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   69</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">   70</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR:  Unrecognized solver package: &quot;</span></div>
<div class="line"><span class="lineno">   71</span>                  &lt;&lt; solver_package &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   72</span>        abort();</div>
<div class="line"><span class="lineno">   73</span>    }</div>
<div class="line"><span class="lineno">   74</span>  }</div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0"><div class="ttname"><a href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a></div><div class="ttdeci">@ FEMuS_DEFAULT</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db5/_linear_equation_solver_enum_8hpp_source.html#l00005">LinearEquationSolverEnum.hpp:5</a></div></div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e"><div class="ttname"><a href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e">FEMuS_ASM</a></div><div class="ttdeci">@ FEMuS_ASM</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db5/_linear_equation_solver_enum_8hpp_source.html#l00006">LinearEquationSolverEnum.hpp:6</a></div></div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9ae3253e9bd449a5d8e1395d58e0bca946"><div class="ttname"><a href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ae3253e9bd449a5d8e1395d58e0bca946">FEMuS_FIELDSPLIT</a></div><div class="ttdeci">@ FEMuS_FIELDSPLIT</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db5/_linear_equation_solver_enum_8hpp_source.html#l00007">LinearEquationSolverEnum.hpp:7</a></div></div>
<div class="ttc" id="a_solver_package_enum_8hpp_html_a32541e934c944770722653e69abe38fea0c85f2467c937723b91a9219b0b55399"><div class="ttname"><a href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea0c85f2467c937723b91a9219b0b55399">PETSC_SOLVERS</a></div><div class="ttdeci">@ PETSC_SOLVERS</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d99/_solver_package_enum_8hpp_source.html#l00005">SolverPackageEnum.hpp:5</a></div></div>
<div class="ttc" id="a_solver_package_enum_8hpp_html_a32541e934c944770722653e69abe38fea4ab73e197d88ce3b742bcd4bcc0bd5e4"><div class="ttname"><a href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea4ab73e197d88ce3b742bcd4bcc0bd5e4">TRILINOS_SOLVERS</a></div><div class="ttdeci">@ TRILINOS_SOLVERS</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d99/_solver_package_enum_8hpp_source.html#l00006">SolverPackageEnum.hpp:6</a></div></div>
<div class="ttc" id="a_willmore_2_willmore_surface_2ex1_2ex1_8cpp_html_a8d72c06f81fac2023cddbaf79c968a51"><div class="ttname"><a href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a></div><div class="ttdeci">const double ap[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp_source.html#l00035">ex1.cpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad64712ae2d655fc49c58814f7411c334" name="ad64712ae2d655fc49c58814f7411c334"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad64712ae2d655fc49c58814f7411c334">&#9670;&#160;</a></span>BuildBdcIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::BuildBdcIndex </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>variable_to_be_solved</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#aebc7f718951cfbfd25e1629f85358c6c">femus::LinearEquationSolverPetscAsm</a>, and <a class="el" href="../../dd/dfa/classfemus_1_1_linear_equation_solver_petsc_field_split.html#a7f992b5f8c53d83526da54e3ae9ff6fd">femus::LinearEquationSolverPetscFieldSplit</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00053">53</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                                                                                                  {</div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ab048018b0a8274ee43ae0b59977f591b">_bdcIndexIsInitialized</a> = 1;</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="keywordtype">unsigned</span> BDCIndexSize = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()];</div>
<div class="line"><span class="lineno">   58</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>.resize (BDCIndexSize);</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span>    std::vector &lt;bool&gt; ThisSolutionIsIncluded (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(), <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iind = 0; iind &lt; variable_to_be_solved.size(); iind++) {</div>
<div class="line"><span class="lineno">   63</span>      <span class="keywordtype">unsigned</span> PdeIndexSol = variable_to_be_solved[iind];</div>
<div class="line"><span class="lineno">   64</span>      ThisSolutionIsIncluded[PdeIndexSol] = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   65</span>    }</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="keywordtype">unsigned</span> count0 = 0;</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); k++) {</div>
<div class="line"><span class="lineno">   70</span>      <span class="keywordtype">unsigned</span> indexSol = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[k];</div>
<div class="line"><span class="lineno">   71</span>      <span class="keywordtype">unsigned</span> soltype = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol];</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> inode_mts = <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;_dofOffset[soltype][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()];</div>
<div class="line"><span class="lineno">   74</span>           inode_mts &lt; <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>() + 1]; inode_mts++) {</div>
<div class="line"><span class="lineno">   75</span>        <span class="keywordtype">int</span> local_mts = inode_mts - <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()];</div>
<div class="line"><span class="lineno">   76</span>        <span class="keywordtype">int</span> idof_kk = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[k][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] + local_mts;</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">if</span> (!ThisSolutionIsIncluded[k] || (* (*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#afa321f16b5b88902150fddb437a1745b">_Bdc</a>) [indexSol]) (inode_mts) &lt; 1.5) {</div>
<div class="line"><span class="lineno">   79</span>          <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>[count0] = idof_kk;</div>
<div class="line"><span class="lineno">   80</span>          count0++;</div>
<div class="line"><span class="lineno">   81</span>        }</div>
<div class="line"><span class="lineno">   82</span>      }</div>
<div class="line"><span class="lineno">   83</span>    }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>.resize (count0);</div>
<div class="line"><span class="lineno">   86</span>    std::vector &lt; PetscInt &gt; (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>).swap (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>);</div>
<div class="line"><span class="lineno">   87</span>    std::sort (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>.begin(), <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>.end());</div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   90</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a220ecdfa001bbb23c8aabe40139620e2"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">femus::LinearEquation::GetMeshFromLinEq</a></div><div class="ttdeci">const Mesh * GetMeshFromLinEq() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00105">LinearEquation.hpp:105</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a5dd44a3538606bda13d2fcdfea5c2b35"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">femus::LinearEquation::_SolPdeIndex</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _SolPdeIndex</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00223">LinearEquation.hpp:223</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a5f1126279cb193c88f8bd2e85341f31e"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">femus::LinearEquation::KKIndex</a></div><div class="ttdeci">std::vector&lt; int &gt; KKIndex</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00125">LinearEquation.hpp:125</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a777130e1a7e1342528f816e09c56be01"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">femus::LinearEquation::_SolType</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _SolType</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00255">LinearEquation.hpp:255</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ae3ec0b2dd39e7527448bc35f108f6093"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">femus::LinearEquation::KKoffset</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned &gt; &gt; KKoffset</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00122">LinearEquation.hpp:122</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_afa321f16b5b88902150fddb437a1745b"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#afa321f16b5b88902150fddb437a1745b">femus::LinearEquation::_Bdc</a></div><div class="ttdeci">const std::vector&lt; NumericVector * &gt; * _Bdc</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00268">LinearEquation.hpp:268</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a14805f7b09557f9cf35a73a72e3c82d1"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">femus::LinearEquationSolverPetsc::_bdcIndex</a></div><div class="ttdeci">std::vector&lt; PetscInt &gt; _bdcIndex</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00119">LinearEquationSolverPetsc.hpp:119</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a4a5e4c71c752f353ee47c2923c95b7f8"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">femus::Mesh::_dofOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _dofOffset[NFE_FAMS]</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00520">Mesh.hpp:520</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acb9a9f48db723e8a4700b1e78dbe93c8" name="acb9a9f48db723e8a4700b1e78dbe93c8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acb9a9f48db723e8a4700b1e78dbe93c8">&#9670;&#160;</a></span>Clear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::Clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Release all memory and clear data structures. </p>

<p>Reimplemented from <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a81ebc19b503dbfc0620f2ca80c1406fa">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00161">161</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  161</span>                                               {</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a76babcafc38f42ee0137d571fb994637">initialized</a>()) {</div>
<div class="line"><span class="lineno">  166</span>      this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a17783185d47a441d545cf1427d2624ee">_is_initialized</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  167</span>      KSPDestroy (&amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  168</span>    }</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_a76babcafc38f42ee0137d571fb994637"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a76babcafc38f42ee0137d571fb994637">femus::LinearEquationSolver::initialized</a></div><div class="ttdeci">bool initialized() const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00081">LinearEquationSolver.hpp:81</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_ac5bf225db84f5c6f1fd81e927f7c61b1"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">femus::LinearEquationSolverPetsc::_ksp</a></div><div class="ttdeci">KSP _ksp</div><div class="ttdoc">Krylov subspace context.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00110">LinearEquationSolverPetsc.hpp:110</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a860b182e81b87527451d0dce8d80a50e" name="a860b182e81b87527451d0dce8d80a50e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a860b182e81b87527451d0dce8d80a50e">&#9670;&#160;</a></span>DeletePde()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::DeletePde </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00378">378</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  378</span>                                 {</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>)</div>
<div class="line"><span class="lineno">  381</span>      <span class="keyword">delete</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">_KKamr</a>)</div>
<div class="line"><span class="lineno">  384</span>      <span class="keyword">delete</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">_KKamr</a>;</div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>)</div>
<div class="line"><span class="lineno">  387</span>      <span class="keyword">delete</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>;</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>)</div>
<div class="line"><span class="lineno">  390</span>      <span class="keyword">delete</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>;</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>)</div>
<div class="line"><span class="lineno">  393</span>      <span class="keyword">delete</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>;</div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>)</div>
<div class="line"><span class="lineno">  396</span>      <span class="keyword">delete</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>;</div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a> = NULL;</div>
<div class="line"><span class="lineno">  399</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a> = NULL;</div>
<div class="line"><span class="lineno">  400</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a> = NULL;</div>
<div class="line"><span class="lineno">  401</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a> = NULL;</div>
<div class="line"><span class="lineno">  402</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a> = NULL;</div>
<div class="line"><span class="lineno">  403</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">_KKamr</a> = NULL;</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a22675b9d542dc58b67f4d2cba10a4c0d"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">femus::LinearEquation::_RESC</a></div><div class="ttdeci">NumericVector * _RESC</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00200">LinearEquation.hpp:200</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a5248622081d9f5559ae84074d6fb4f30"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">femus::LinearEquation::_EPSC</a></div><div class="ttdeci">NumericVector * _EPSC</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00217">LinearEquation.hpp:217</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a7f79930715e7e6c8b0ec81ee506a4ef0"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">femus::LinearEquation::_EPS</a></div><div class="ttdeci">NumericVector * _EPS</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00217">LinearEquation.hpp:217</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00149">LinearEquation.hpp:149</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ab824eb4b9859c3dff871f537d702d987"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">femus::LinearEquation::_KKamr</a></div><div class="ttdeci">SparseMatrix * _KKamr</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00152">LinearEquation.hpp:152</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ae819a67a7c62b49373dd257e11466e5e"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00200">LinearEquation.hpp:200</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6f9872dad722bd16c70bc054c3dc618" name="ae6f9872dad722bd16c70bc054c3dc618"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6f9872dad722bd16c70bc054c3dc618">&#9670;&#160;</a></span>GetIndex()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned femus::LinearEquation::GetIndex </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[]</td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00063">63</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   63</span>                                                     {</div>
<div class="line"><span class="lineno">   64</span>    <span class="keywordtype">unsigned</span> index = 0;</div>
<div class="line"><span class="lineno">   65</span>    <span class="keywordflow">while</span>(strcmp(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a25739bd6cc78282815fa4dfe79ed3885">_SolName</a>[index], name)) {</div>
<div class="line"><span class="lineno">   66</span>      index++;</div>
<div class="line"><span class="lineno">   67</span>      <span class="keywordflow">if</span>(index == <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>.size()) {</div>
<div class="line"><span class="lineno">   68</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;error! invalid name entry GetIndex(...)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   69</span>        exit(0);</div>
<div class="line"><span class="lineno">   70</span>      }</div>
<div class="line"><span class="lineno">   71</span>    }</div>
<div class="line"><span class="lineno">   72</span>    <span class="keywordflow">return</span> index;</div>
<div class="line"><span class="lineno">   73</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a25739bd6cc78282815fa4dfe79ed3885"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a25739bd6cc78282815fa4dfe79ed3885">femus::LinearEquation::_SolName</a></div><div class="ttdeci">std::vector&lt; char * &gt; _SolName</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00257">LinearEquation.hpp:257</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e0ac73808d4973cc54af92605e11421" name="a7e0ac73808d4973cc54af92605e11421"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e0ac73808d4973cc54af92605e11421">&#9670;&#160;</a></span>GetKSP()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">KSP * femus::LinearEquationSolverPetsc::GetKSP </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a3bb445944cefd4197eb64dca6a217600">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00090">90</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>                           {</div>
<div class="line"><span class="lineno">   91</span>        <span class="keywordflow">return</span> &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>;</div>
<div class="line"><span class="lineno">   92</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a220ecdfa001bbb23c8aabe40139620e2" name="a220ecdfa001bbb23c8aabe40139620e2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a220ecdfa001bbb23c8aabe40139620e2">&#9670;&#160;</a></span>GetMeshFromLinEq()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> * femus::LinearEquation::GetMeshFromLinEq </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00105">105</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  105</span>{ <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>; }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aea3bb5e946dca1be0fa0bf40e2ccae73"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">femus::LinearEquation::_msh</a></div><div class="ttdeci">const Mesh * _msh</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00110">LinearEquation.hpp:110</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d6585056575a152842422596e64a0f4" name="a3d6585056575a152842422596e64a0f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d6585056575a152842422596e64a0f4">&#9670;&#160;</a></span>GetNullSpaceBase()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::GetNullSpaceBase </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; Vec &gt; &amp;&#160;</td>
          <td class="paramname"><em>nullspBase</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00384">384</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  384</span>                                                                                 {</div>
<div class="line"><span class="lineno">  385</span>      </div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); k++) {</div>
<div class="line"><span class="lineno">  387</span>      <span class="keywordtype">unsigned</span> indexSol = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[k];</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a453ddac90679e3447fa774a52e3d2214">_solution</a>-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a412a8bcce558cb1b840675b7d913184a">GetIfRemoveNullSpace</a> (indexSol)) {</div>
<div class="line"><span class="lineno">  390</span>        Vec EPS = (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>))-&gt;vec();</div>
<div class="line"><span class="lineno">  391</span>        <span class="keywordtype">unsigned</span> nullspSize = nullspBase.size();</div>
<div class="line"><span class="lineno">  392</span>        nullspBase.resize (nullspSize + 1);</div>
<div class="line"><span class="lineno">  393</span>        VecDuplicate (EPS, &amp;nullspBase[nullspSize]);</div>
<div class="line"><span class="lineno">  394</span>        </div>
<div class="line"><span class="lineno">  395</span>        <span class="keywordtype">unsigned</span> soltype = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol];</div>
<div class="line"><span class="lineno">  396</span>        <span class="keywordtype">unsigned</span> owndofs = <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>() + 1] - <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()];</div>
<div class="line"><span class="lineno">  397</span>        <span class="keywordflow">if</span> (soltype == <a class="code hl_enumvalue" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550a14c61c22daa32c9427d28419607a3660">DISCONTINUOUS_LINEAR</a> ) owndofs /= (<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>() + 1);</div>
<div class="line"><span class="lineno">  398</span>        </div>
<div class="line"><span class="lineno">  399</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; owndofs; i++) {</div>
<div class="line"><span class="lineno">  400</span>          <span class="keywordtype">int</span> idof_kk = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[k][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] + i;</div>
<div class="line"><span class="lineno">  401</span>          <span class="keywordtype">unsigned</span> inode_mts = <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] + i;</div>
<div class="line"><span class="lineno">  402</span>          <span class="keywordflow">if</span> ( (* (*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#afa321f16b5b88902150fddb437a1745b">_Bdc</a>) [indexSol]) (inode_mts) &gt; 1.9) {</div>
<div class="line"><span class="lineno">  403</span>            VecSetValue (nullspBase[nullspSize], idof_kk, 1., INSERT_VALUES);</div>
<div class="line"><span class="lineno">  404</span>          }</div>
<div class="line"><span class="lineno">  405</span>        }</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>        VecAssemblyBegin (nullspBase[nullspSize]);</div>
<div class="line"><span class="lineno">  408</span>        VecAssemblyEnd (nullspBase[nullspSize]);</div>
<div class="line"><span class="lineno">  409</span>        VecNormalize (nullspBase[nullspSize], NULL);</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>        nullspSize++;</div>
<div class="line"><span class="lineno">  412</span>      }</div>
<div class="line"><span class="lineno">  413</span>    }</div>
<div class="line"><span class="lineno">  414</span>  }</div>
<div class="ttc" id="a_f_elem_type_enum__list_8hpp_html_aa3c13f1140f458a32182c3d9312b3550a14c61c22daa32c9427d28419607a3660"><div class="ttname"><a href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550a14c61c22daa32c9427d28419607a3660">DISCONTINUOUS_LINEAR</a></div><div class="ttdeci">@ DISCONTINUOUS_LINEAR</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d70/_f_elem_type_enum__list_8hpp_source.html#l00032">FElemTypeEnum_list.hpp:31</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a453ddac90679e3447fa774a52e3d2214"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a453ddac90679e3447fa774a52e3d2214">femus::LinearEquation::_solution</a></div><div class="ttdeci">Solution * _solution</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00249">LinearEquation.hpp:249</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00144">Mesh.hpp:144</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a412a8bcce558cb1b840675b7d913184a"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a412a8bcce558cb1b840675b7d913184a">femus::Solution::GetIfRemoveNullSpace</a></div><div class="ttdeci">bool GetIfRemoveNullSpace(const unsigned &amp;index) const</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00261">Solution.hpp:261</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad3053db3500d06e996703acf43efbcd7" name="ad3053db3500d06e996703acf43efbcd7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad3053db3500d06e996703acf43efbcd7">&#9670;&#160;</a></span>GetSparsityPatternSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::GetSparsityPatternSize </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00407">407</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  407</span>                                              {</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordtype">unsigned</span> SolPdeSize = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size();</div>
<div class="line"><span class="lineno">  410</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a>.size() == 0) {</div>
<div class="line"><span class="lineno">  411</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a>.resize(SolPdeSize * SolPdeSize);</div>
<div class="line"><span class="lineno">  412</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; SolPdeSize; i++) {</div>
<div class="line"><span class="lineno">  413</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; SolPdeSize; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  414</span>          <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a>[SolPdeSize * i + <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 1;</div>
<div class="line"><span class="lineno">  415</span>        }</div>
<div class="line"><span class="lineno">  416</span>      }</div>
<div class="line"><span class="lineno">  417</span>    }</div>
<div class="line"><span class="lineno">  418</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a>.size() != SolPdeSize * SolPdeSize) {</div>
<div class="line"><span class="lineno">  419</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Sparsity Pattern size ( &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a>.size() &lt;&lt; <span class="stringliteral">&quot; ) does not match system PDE size&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  420</span>      exit(0);</div>
<div class="line"><span class="lineno">  421</span>    }</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">int</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>    std::vector &lt; std::vector &lt; int &gt; &gt; dofsVAR(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size());</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  430</span>      dofsVAR[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  431</span>    }</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>    <span class="comment">// mesh and procs</span></div>
<div class="line"><span class="lineno">  434</span>    <span class="keywordtype">int</span> nel    = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">GetNumberOfElements</a>();</div>
<div class="line"><span class="lineno">  435</span>    <span class="keywordtype">int</span> igrid  = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>();</div>
<div class="line"><span class="lineno">  436</span>    <span class="keywordtype">int</span> this_proc  = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  437</span>    <span class="keywordtype">int</span> nprocs =       <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>();</div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>    <span class="comment">// *** element loop ***</span></div>
<div class="line"><span class="lineno">  440</span> </div>
<div class="line"><span class="lineno">  441</span>    <span class="keywordtype">int</span> IndexStart = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][this_proc];</div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordtype">int</span> IndexEnd  = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1][this_proc];</div>
<div class="line"><span class="lineno">  443</span>    <span class="keywordtype">int</span> owned_dofs    = IndexEnd - IndexStart;  <span class="comment">//all dofs of all vars of this_proc</span></div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>    std::vector &lt; std::map &lt; int, bool &gt; &gt; BlgToMe_d(owned_dofs); <span class="comment">//belong to me</span></div>
<div class="line"><span class="lineno">  446</span>    std::vector &lt; std::map &lt; int, bool &gt; &gt; BlgToMe_o(owned_dofs); <span class="comment">//belong to me</span></div>
<div class="line"><span class="lineno">  447</span>    std::map &lt; int, std::map &lt;int, bool &gt; &gt; DnBlgToMe_o;     <span class="comment">//don&#39;t belong to me </span></div>
<div class="line"><span class="lineno">  448</span>    std::map &lt; int, std::map &lt;int, bool &gt; &gt; DnBlgToMe_d;     <span class="comment">//don&#39;t belong to me</span></div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> kel = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[this_proc]; kel &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[this_proc + 1]; kel++) {</div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>      <span class="keywordtype">short</span> <span class="keywordtype">int</span> kelt = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(kel);</div>
<div class="line"><span class="lineno">  453</span>      std::vector &lt; int &gt; nve(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size());</div>
<div class="line"><span class="lineno">  454</span>      </div>
<div class="line"><span class="lineno">  455</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  456</span>        nve[i] = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(kel, <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[i]]);</div>
<div class="line"><span class="lineno">  457</span>      }</div>
<div class="line"><span class="lineno">  458</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  459</span>        dofsVAR[i].resize(nve[i]);</div>
<div class="line"><span class="lineno">  460</span>      }</div>
<div class="line"><span class="lineno">  461</span> </div>
<div class="line"><span class="lineno">  462</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  463</span>        <span class="keywordtype">int</span> ThisSolType = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[i]];</div>
<div class="line"><span class="lineno">  464</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nve[i]; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  465</span>          <span class="keywordtype">int</span> inode = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, kel, ThisSolType);</div>
<div class="line"><span class="lineno">  466</span>          dofsVAR[i][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[i], i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, kel);</div>
<div class="line"><span class="lineno">  467</span>        }</div>
<div class="line"><span class="lineno">  468</span>      }</div>
<div class="line"><span class="lineno">  469</span>      </div>
<div class="line"><span class="lineno">  470</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  471</span>          </div>
<div class="line"><span class="lineno">  472</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> inode = 0; inode &lt; nve[i]; inode++) {</div>
<div class="line"><span class="lineno">  473</span>          <span class="keywordtype">int</span> idof_local = dofsVAR[i][inode] - IndexStart;</div>
<div class="line"><span class="lineno">  474</span>          </div>
<div class="line"><span class="lineno">  475</span>          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  476</span>              </div>
<div class="line"><span class="lineno">  477</span>            <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size() *i + <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]) {</div>
<div class="line"><span class="lineno">  478</span>                </div>
<div class="line"><span class="lineno">  479</span>              <span class="keywordflow">for</span>(<span class="keywordtype">int</span> jnode = 0; jnode &lt; nve[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]; jnode++) {</div>
<div class="line"><span class="lineno">  480</span>                <span class="keywordtype">int</span> jdof_local = dofsVAR[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][jnode] - IndexStart;</div>
<div class="line"><span class="lineno">  481</span> </div>
<div class="line"><span class="lineno">  482</span>                <span class="keywordflow">if</span>(idof_local &gt;= 0) {  <span class="comment">// i-row belongs to this proc</span></div>
<div class="line"><span class="lineno">  483</span>                  <span class="keywordflow">if</span>(jdof_local &gt;= 0) {  <span class="comment">// j-row belongs to this proc (diagonal)</span></div>
<div class="line"><span class="lineno">  484</span>                    BlgToMe_d[ idof_local ][ jdof_local ] = 1;</div>
<div class="line"><span class="lineno">  485</span>                  }</div>
<div class="line"><span class="lineno">  486</span>                  <span class="keywordflow">else</span> { <span class="comment">// j-row does not belong to this proc (off-diagonal)</span></div>
<div class="line"><span class="lineno">  487</span>                    BlgToMe_o[ idof_local ][ dofsVAR[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][jnode] ] = 1;</div>
<div class="line"><span class="lineno">  488</span>                  }</div>
<div class="line"><span class="lineno">  489</span>                }</div>
<div class="line"><span class="lineno">  490</span>                <span class="keywordflow">else</span> { <span class="comment">// i-row does not belong to this proc</span></div>
<div class="line"><span class="lineno">  491</span>                  <span class="comment">// identify the process the i-row belongs to</span></div>
<div class="line"><span class="lineno">  492</span>                  <span class="keywordtype">int</span> iproc = 0;</div>
<div class="line"><span class="lineno">  493</span>                  <span class="keywordflow">while</span>(dofsVAR[i][inode] &gt;= <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1][iproc]) iproc++;</div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>                  <span class="comment">// identify the process the j-column belongs to</span></div>
<div class="line"><span class="lineno">  496</span>                  <span class="keywordtype">int</span> jproc = 0;</div>
<div class="line"><span class="lineno">  497</span>                  <span class="keywordflow">while</span>(dofsVAR[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][jnode] &gt;= <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1][jproc]) jproc++;</div>
<div class="line"><span class="lineno">  498</span>                  <span class="keywordflow">if</span>(iproc != jproc) {  <span class="comment">// if diagonal</span></div>
<div class="line"><span class="lineno">  499</span>                    DnBlgToMe_o[ dofsVAR[i][inode] ][ dofsVAR[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][jnode] ] = 1;</div>
<div class="line"><span class="lineno">  500</span>                  }</div>
<div class="line"><span class="lineno">  501</span>                  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(iproc == jproc) {  <span class="comment">// if off-diagonal</span></div>
<div class="line"><span class="lineno">  502</span>                    DnBlgToMe_d[ dofsVAR[i][inode] ][ dofsVAR[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][jnode] ] = 1;</div>
<div class="line"><span class="lineno">  503</span>                  }</div>
<div class="line"><span class="lineno">  504</span>                }</div>
<div class="line"><span class="lineno">  505</span>                </div>
<div class="line"><span class="lineno">  506</span>              }  <span class="comment">//ndofs jvar</span></div>
<div class="line"><span class="lineno">  507</span>              </div>
<div class="line"><span class="lineno">  508</span>            }  <span class="comment">//test if there is coupling between ivar and jvar</span></div>
<div class="line"><span class="lineno">  509</span>          } <span class="comment">//jvar</span></div>
<div class="line"><span class="lineno">  510</span>        }  <span class="comment">//ndofs ivar</span></div>
<div class="line"><span class="lineno">  511</span>      }  <span class="comment">//ivar</span></div>
<div class="line"><span class="lineno">  512</span>      </div>
<div class="line"><span class="lineno">  513</span>    } <span class="comment">//end el loop</span></div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>    NumericVector  *sizeDnBM_o = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  516</span>    sizeDnBM_o-&gt;init(*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>);</div>
<div class="line"><span class="lineno">  517</span>    sizeDnBM_o-&gt;zero();</div>
<div class="line"><span class="lineno">  518</span>    <span class="keywordflow">for</span>(std::map &lt; <span class="keywordtype">int</span>, std::map &lt;int, bool &gt; &gt;::iterator it = DnBlgToMe_o.begin(); it != DnBlgToMe_o.end(); ++it) {</div>
<div class="line"><span class="lineno">  519</span>      sizeDnBM_o-&gt;add(it-&gt;first, it-&gt;second.size());</div>
<div class="line"><span class="lineno">  520</span>    }</div>
<div class="line"><span class="lineno">  521</span>    sizeDnBM_o-&gt;close();</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>    NumericVector  *sizeDnBM_d = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  525</span>    sizeDnBM_d-&gt;init(*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>);</div>
<div class="line"><span class="lineno">  526</span>    sizeDnBM_d-&gt;zero();</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">for</span>(std::map &lt; <span class="keywordtype">int</span>, std::map &lt;int, bool &gt; &gt;::iterator it = DnBlgToMe_d.begin(); it != DnBlgToMe_d.end(); ++it) {</div>
<div class="line"><span class="lineno">  528</span>      sizeDnBM_d-&gt;add(it-&gt;first, it-&gt;second.size());</div>
<div class="line"><span class="lineno">  529</span>    }</div>
<div class="line"><span class="lineno">  530</span>    sizeDnBM_d-&gt;close();</div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span> </div>
<div class="line"><span class="lineno">  533</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>.resize(owned_dofs);</div>
<div class="line"><span class="lineno">  534</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>.resize(owned_dofs);</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    <span class="keywordtype">int</span> d_max = owned_dofs + <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">_numberOfGlobalVariables</a>;</div>
<div class="line"><span class="lineno">  537</span>    <span class="keywordtype">int</span> o_max = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1u] - owned_dofs + <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">_numberOfGlobalVariables</a>;</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; owned_dofs; i++) {</div>
<div class="line"><span class="lineno">  540</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>[i] = <span class="keyword">static_cast &lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((*sizeDnBM_d)(IndexStart + i)) + BlgToMe_d[i].size() + <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">_numberOfGlobalVariables</a>;</div>
<div class="line"><span class="lineno">  541</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>[i] &gt; d_max) <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>[i] = d_max;</div>
<div class="line"><span class="lineno">  542</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>[i] = <span class="keyword">static_cast &lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>((*sizeDnBM_o)(IndexStart + i)) + BlgToMe_o[i].size() + <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">_numberOfGlobalVariables</a>;</div>
<div class="line"><span class="lineno">  543</span>      <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>[i] &gt; o_max) <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>[i] = o_max;</div>
<div class="line"><span class="lineno">  544</span>    }</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>    <span class="keyword">delete</span> sizeDnBM_o;</div>
<div class="line"><span class="lineno">  547</span>    <span class="keyword">delete</span> sizeDnBM_d;</div>
<div class="line"><span class="lineno">  548</span>  }</div>
<div class="ttc" id="a_m_g_a_m_r_2ex6_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_navier_stokes___a_m_r_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp_source.html#l00034">NavierStokes_AMR.cpp:34</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4613cf9a418f8a61220a705e30843ade"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">femus::LinearEquation::o_nnz</a></div><div class="ttdeci">std::vector&lt; int &gt; o_nnz</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00183">LinearEquation.hpp:183</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d77/_linear_equation_8cpp_source.html#l00076">LinearEquation.cpp:76</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a59a6274d7ad89115708f2e654dca326b"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">femus::LinearEquation::_SparsityPattern</a></div><div class="ttdeci">std::vector&lt; bool &gt; _SparsityPattern</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00171">LinearEquation.hpp:171</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a62a2a1ed0ecb5758eedb242fa5fdd461"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">femus::LinearEquation::d_nnz</a></div><div class="ttdeci">std::vector&lt; int &gt; d_nnz</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00180">LinearEquation.hpp:180</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ad42d4d0d6a54f6df97afa82f4eec7a0c"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">femus::LinearEquation::_numberOfGlobalVariables</a></div><div class="ttdeci">unsigned _numberOfGlobalVariables</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00239">LinearEquation.hpp:239</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a24f5ab73a260d61b0ea9ff28f03bc815"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">femus::Mesh::GetLevel</a></div><div class="ttdeci">unsigned GetLevel() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00381">Mesh.hpp:381</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01157">Mesh.cpp:1157</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ab5bcfd4be738d47ae025a06eddc66f61"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">femus::Mesh::GetNumberOfElements</a></div><div class="ttdeci">unsigned GetNumberOfElements() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00211">Mesh.hpp:211</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00236">Mesh.hpp:236</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01012">Mesh.cpp:1012</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01147">Mesh.cpp:1147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_aa554690df717f373d2b51e564fc421d6"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">femus::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector &gt; build(const SolverPackage solver_package=LSOLVER)</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbc/_numeric_vector_8cpp_source.html#l00036">NumericVector.cpp:36</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_af6629fca51be192be664c76eb8aecc79"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">femus::ParallelObject::n_processors</a></div><div class="ttdeci">int n_processors() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00048">ParallelObject.hpp:48</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e339f53ed51e108cd33e1577dae9c18" name="a4e339f53ed51e108cd33e1577dae9c18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e339f53ed51e108cd33e1577dae9c18">&#9670;&#160;</a></span>GetSystemDof() <span class="overload">[1/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned femus::LinearEquation::GetSystemDof </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>index_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>kkindex_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>iel</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00076">76</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span>                                                                                      {</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordtype">unsigned</span> soltype =  <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[index_sol];</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordtype">unsigned</span> idof = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, soltype);</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>    <span class="keywordtype">unsigned</span> isubdom = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad0eaa40354f159fd15f336c39f7bfd3b">BisectionSearch_find_processor_of_dof</a>(idof, soltype);</div>
<div class="line"><span class="lineno">   83</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[kkindex_sol][isubdom] + idof - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][isubdom];</div>
<div class="line"><span class="lineno">   84</span>    </div>
<div class="line"><span class="lineno">   85</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ad0eaa40354f159fd15f336c39f7bfd3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ad0eaa40354f159fd15f336c39f7bfd3b">femus::Mesh::BisectionSearch_find_processor_of_dof</a></div><div class="ttdeci">unsigned BisectionSearch_find_processor_of_dof(const unsigned &amp;dof, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l00995">Mesh.cpp:995</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a97d5328122e7841e3edd0713947b2031" name="a97d5328122e7841e3edd0713947b2031"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97d5328122e7841e3edd0713947b2031">&#9670;&#160;</a></span>GetSystemDof() <span class="overload">[2/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned femus::LinearEquation::GetSystemDof </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>index_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>kkindex_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>ielc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>i0</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>i1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>mshc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00099">99</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  101</span>                                                                {</div>
<div class="line"><span class="lineno">  102</span>                                            </div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordtype">unsigned</span> soltype =  <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[index_sol];</div>
<div class="line"><span class="lineno">  104</span>    <span class="keywordtype">unsigned</span> idof = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(ielc, i0, i1, soltype, mshc);</div>
<div class="line"><span class="lineno">  105</span> </div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordtype">unsigned</span> isubdom = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad0eaa40354f159fd15f336c39f7bfd3b">BisectionSearch_find_processor_of_dof</a>(idof, soltype);</div>
<div class="line"><span class="lineno">  107</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[kkindex_sol][isubdom] + idof - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][isubdom];</div>
<div class="line"><span class="lineno">  108</span>    </div>
<div class="line"><span class="lineno">  109</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ff186621626e25f0001b00e493dc3cc" name="a3ff186621626e25f0001b00e493dc3cc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ff186621626e25f0001b00e493dc3cc">&#9670;&#160;</a></span>GetSystemDof() <span class="overload">[3/3]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned femus::LinearEquation::GetSystemDof </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>soltype</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>kkindex_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>iel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; unsigned &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>otherKKoffset</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00087">87</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   88</span>                                                                                                                                               {</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span>    <span class="comment">//unsigned soltype =  _SolType[index_sol];</span></div>
<div class="line"><span class="lineno">   91</span>    <span class="keywordtype">unsigned</span> idof = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, soltype);</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keywordtype">unsigned</span> isubdom = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad0eaa40354f159fd15f336c39f7bfd3b">BisectionSearch_find_processor_of_dof</a>(idof, soltype);</div>
<div class="line"><span class="lineno">   94</span>    <span class="keywordflow">return</span> otherKKoffset[kkindex_sol][isubdom] + idof - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[soltype][isubdom];</div>
<div class="line"><span class="lineno">   95</span>    </div>
<div class="line"><span class="lineno">   96</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a13cb95513c710a4445ae179e981663d1" name="a13cb95513c710a4445ae179e981663d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a13cb95513c710a4445ae179e981663d1">&#9670;&#160;</a></span>Init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::Init </td>
          <td>(</td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Amat</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">Mat &amp;&#160;</td>
          <td class="paramname"><em>Pmat</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00153">153</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  153</span>                                                            {</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>    <span class="keywordflow">if</span> (!this-&gt;<a class="code hl_function" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a76babcafc38f42ee0137d571fb994637">initialized</a>())    {</div>
<div class="line"><span class="lineno">  156</span>      this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a17783185d47a441d545cf1427d2624ee">_is_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>      KSPCreate (MPI_COMM_WORLD, &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  159</span>      KSPGetPC (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>      this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a411eac388d69b468ca820cf252c06dad">SetSolver</a> (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a>);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>      KSPSetOperators (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, Amat, Pmat);</div>
<div class="line"><span class="lineno">  164</span>      KSPSetTolerances (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a12be6e63b0980ad661ac0b5f1db07677">_rtol</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acc02d3a5864f2c8534190b109fdcf0a1">_abstol</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a099f48f80b5eca34c976a932bcac5243">_dtol</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2da36631345b3bf33696f6c8f5882dc4">_maxits</a>);</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a> != <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>) {</div>
<div class="line"><span class="lineno">  167</span>        KSPSetInitialGuessKnoll (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, PETSC_TRUE);</div>
<div class="line"><span class="lineno">  168</span>        KSPSetNormType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, KSP_NORM_PRECONDITIONED);</div>
<div class="line"><span class="lineno">  169</span>      }</div>
<div class="line"><span class="lineno">  170</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  171</span>        KSPSetInitialGuessKnoll (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, PETSC_FALSE);</div>
<div class="line"><span class="lineno">  172</span>        KSPSetNormType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, KSP_NORM_NONE);</div>
<div class="line"><span class="lineno">  173</span>      }</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>      KSPSetFromOptions (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  176</span>      KSPGMRESSetRestart (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a595c4b08e58212f1d93c1518e51bdb43">_restart</a>);</div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>      <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a716f7336380f1a4093d3c5657284fde7">SetPreconditioner</a> (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    }</div>
<div class="line"><span class="lineno">  181</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a2f1863719353c8ca3a9d7f9ba5723875"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">femus::LinearEquationSolverPetsc::_pc</a></div><div class="ttdeci">PC _pc</div><div class="ttdoc">Preconditioner context.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00111">LinearEquationSolverPetsc.hpp:111</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a411eac388d69b468ca820cf252c06dad"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a411eac388d69b468ca820cf252c06dad">femus::LinearEquationSolverPetsc::SetSolver</a></div><div class="ttdeci">void SetSolver(KSP &amp;ksp, const SolverType &amp;solver_type)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00094">LinearEquationSolverPetsc.hpp:94</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a716f7336380f1a4093d3c5657284fde7"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a716f7336380f1a4093d3c5657284fde7">femus::LinearEquationSolverPetsc::SetPreconditioner</a></div><div class="ttdeci">virtual void SetPreconditioner(KSP &amp;subksp, PC &amp;subpc)</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00440">LinearEquationSolverPetsc.cpp:440</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="afbc6834611d0a447a5fa3e2c7f7ffabf" name="afbc6834611d0a447a5fa3e2c7f7ffabf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afbc6834611d0a447a5fa3e2c7f7ffabf">&#9670;&#160;</a></span>init()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::init </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *&#160;</td>
          <td class="paramname"><em>matrix</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="../../da/d58/deprecated.html#_deprecated000014">Deprecated:</a></b></dt><dd>, remove soon </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00640">640</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  640</span>                                                            {</div>
<div class="line"><span class="lineno">  641</span> </div>
<div class="line"><span class="lineno">  642</span>    PetscMatrix* matrix_two   = femus::cast_ptr&lt;PetscMatrix*&gt; (<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a>);</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>    <span class="comment">// Initialize the data structures if not done so already.</span></div>
<div class="line"><span class="lineno">  645</span>    <span class="keywordflow">if</span> (!this-&gt;<a class="code hl_function" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a76babcafc38f42ee0137d571fb994637">initialized</a>())    {</div>
<div class="line"><span class="lineno">  646</span>      this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a17783185d47a441d545cf1427d2624ee">_is_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  647</span>      <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  648</span><span class="comment">// #if PETSC_VERSION_LESS_THAN(2,2,0)  // 2.1.x &amp; earlier style</span></div>
<div class="line"><span class="lineno">  649</span><span class="comment">//     // Create the linear solver context</span></div>
<div class="line"><span class="lineno">  650</span><span class="comment">//     ierr = SLESCreate(MPI_COMM_WORLD, &amp;_sles);</span></div>
<div class="line"><span class="lineno">  651</span><span class="comment">//     CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  652</span><span class="comment">//     // Create the Krylov subspace &amp; preconditioner contexts</span></div>
<div class="line"><span class="lineno">  653</span><span class="comment">//     ierr = SLESGetKSP(_sles, &amp;_ksp);</span></div>
<div class="line"><span class="lineno">  654</span><span class="comment">//     CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  655</span><span class="comment">//     ierr = SLESGetPC(_sles, &amp;_pc);</span></div>
<div class="line"><span class="lineno">  656</span><span class="comment">//     CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  657</span><span class="comment">//     // Have the Krylov subspace method use our good initial guess rather than 0</span></div>
<div class="line"><span class="lineno">  658</span><span class="comment">//     ierr = KSPSetInitialGuessNonzero(_ksp, PETSC_TRUE);</span></div>
<div class="line"><span class="lineno">  659</span><span class="comment">//     CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  660</span><span class="comment">//     // Set user-specified  solver and preconditioner types</span></div>
<div class="line"><span class="lineno">  661</span><span class="comment">//     this-&gt;set_petsc_solver_type();</span></div>
<div class="line"><span class="lineno">  662</span><span class="comment">//     // Set the options from user-input</span></div>
<div class="line"><span class="lineno">  663</span><span class="comment">//     // Set runtime options, e.g.,</span></div>
<div class="line"><span class="lineno">  664</span><span class="comment">//     //      -ksp_type &lt;type&gt; -pc_type &lt;type&gt; -ksp_monitor -ksp_rtol &lt;rtol&gt;</span></div>
<div class="line"><span class="lineno">  665</span><span class="comment">//     //  These options will override those specified above as long as</span></div>
<div class="line"><span class="lineno">  666</span><span class="comment">//     //  SLESSetFromOptions() is called _after_ any other customization</span></div>
<div class="line"><span class="lineno">  667</span><span class="comment">//     //  routines.</span></div>
<div class="line"><span class="lineno">  668</span><span class="comment">//     ierr = SLESSetFromOptions(_sles);</span></div>
<div class="line"><span class="lineno">  669</span><span class="comment">//     CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  670</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  671</span><span class="comment">// #else // 2.2.0 &amp; newer style</span></div>
<div class="line"><span class="lineno">  672</span>      <span class="comment">// Create the linear solver context</span></div>
<div class="line"><span class="lineno">  673</span>      ierr = KSPCreate (MPI_COMM_WORLD, &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  674</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  675</span>      <span class="comment">//ierr = PCCreate (MPI_COMM_WORLD, &amp;_pc); CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  676</span>      <span class="comment">// Create the preconditioner context</span></div>
<div class="line"><span class="lineno">  677</span>      ierr = KSPGetPC (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>);</div>
<div class="line"><span class="lineno">  678</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  679</span>      <span class="comment">// Set operators. The input matrix works as the preconditioning matrix</span></div>
<div class="line"><span class="lineno">  680</span>      <span class="comment">//ierr = KSPSetOperators(_ksp, matrix-&gt;mat(), matrix-&gt;mat(),SAME_NONZERO_PATTERN);</span></div>
<div class="line"><span class="lineno">  681</span>      ierr = KSPSetOperators (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, matrix_two-&gt;mat(), matrix_two-&gt;mat());   <span class="comment">//PETSC3p5</span></div>
<div class="line"><span class="lineno">  682</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  683</span>      <span class="comment">// Have the Krylov subspace method use our good initial guess rather than 0</span></div>
<div class="line"><span class="lineno">  684</span>      ierr = KSPSetInitialGuessNonzero (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, PETSC_TRUE);</div>
<div class="line"><span class="lineno">  685</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  686</span>      <span class="comment">// Set user-specified  solver and preconditioner types</span></div>
<div class="line"><span class="lineno">  687</span>      this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a411eac388d69b468ca820cf252c06dad">SetSolver</a> (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a>);</div>
<div class="line"><span class="lineno">  688</span>      <span class="comment">// Set the options from user-input</span></div>
<div class="line"><span class="lineno">  689</span>      <span class="comment">// Set runtime options, e.g., -ksp_type &lt;type&gt; -pc_type &lt;type&gt; -ksp_monitor -ksp_rtol &lt;rtol&gt;</span></div>
<div class="line"><span class="lineno">  690</span>      <span class="comment">//  These options will override those specified above as long as</span></div>
<div class="line"><span class="lineno">  691</span>      <span class="comment">//  KSPSetFromOptions() is called _after_ any other customization  routines.</span></div>
<div class="line"><span class="lineno">  692</span>      ierr = KSPSetFromOptions (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  693</span>      KSPGMRESSetRestart (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a595c4b08e58212f1d93c1518e51bdb43">_restart</a>);</div>
<div class="line"><span class="lineno">  694</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  695</span>      <span class="comment">// Not sure if this is necessary, or if it is already handled by KSPSetFromOptions?</span></div>
<div class="line"><span class="lineno">  696</span>      <span class="comment">//ierr = PCSetFromOptions (_pc);CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span><span class="comment">// #endif</span></div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>      <span class="comment">// Notify PETSc of location to store residual history.</span></div>
<div class="line"><span class="lineno">  701</span>      <span class="comment">// This needs to be called before any solves, since</span></div>
<div class="line"><span class="lineno">  702</span>      <span class="comment">// it sets the residual history length to zero.  The default</span></div>
<div class="line"><span class="lineno">  703</span>      <span class="comment">// behavior is for PETSc to allocate (internally) an array</span></div>
<div class="line"><span class="lineno">  704</span>      <span class="comment">// of size 1000 to hold the residual norm history.</span></div>
<div class="line"><span class="lineno">  705</span>      ierr = KSPSetResidualHistory (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>,</div>
<div class="line"><span class="lineno">  706</span>                                    PETSC_NULL,   <span class="comment">// pointer to the array which holds the history</span></div>
<div class="line"><span class="lineno">  707</span>                                    PETSC_DECIDE, <span class="comment">// size of the array holding the history</span></div>
<div class="line"><span class="lineno">  708</span>                                    PETSC_TRUE);  <span class="comment">// Whether or not to reset the history for each solve.</span></div>
<div class="line"><span class="lineno">  709</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>      <a class="code hl_function" href="../../d4/d01/classfemus_1_1_petsc_preconditioner.html#ae8e037e88852e97c0efd625f2764dcf5">PetscPreconditioner::set_petsc_preconditioner_type</a> (this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>);</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>      <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>) {</div>
<div class="line"><span class="lineno">  714</span>        this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>-&gt;<a class="code hl_function" href="../../d9/d80/classfemus_1_1_preconditioner.html#a1bc0544da19e5de757d83ae2e4fb90de">set_matrix</a> (*<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a>);</div>
<div class="line"><span class="lineno">  715</span>        PCShellSetContext (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, (<span class="keywordtype">void</span>*) this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>);</div>
<div class="line"><span class="lineno">  716</span>        PCShellSetSetUp (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, <a class="code hl_function" href="../../d8/dea/namespacefemus.html#a2b826b5e8671bc2f570f78b61de60d55">__libmesh_petsc_preconditioner_setup</a>);</div>
<div class="line"><span class="lineno">  717</span>        PCShellSetApply (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, <a class="code hl_function" href="../../d8/dea/namespacefemus.html#abbf7ae06606778e3dd164b5174dd540e">__libmesh_petsc_preconditioner_apply</a>);</div>
<div class="line"><span class="lineno">  718</span>      }</div>
<div class="line"><span class="lineno">  719</span>    }</div>
<div class="line"><span class="lineno">  720</span>  }</div>
<div class="ttc" id="a_m_g_a_m_r_2ex6_2_m_g__precond_8m_html_af439574c0feeeae882d3b65a7b2e88bf"><div class="ttname"><a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a></div><div class="ttdeci">matrix</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m_source.html#l00021">MG_precond.m:21</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_preconditioner_html_ae8e037e88852e97c0efd625f2764dcf5"><div class="ttname"><a href="../../d4/d01/classfemus_1_1_petsc_preconditioner.html#ae8e037e88852e97c0efd625f2764dcf5">femus::PetscPreconditioner::set_petsc_preconditioner_type</a></div><div class="ttdeci">static void set_petsc_preconditioner_type(const PreconditionerType &amp;preconditioner_type, PC &amp;pc, const int &amp;parallelOverlapping=0)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d05/_petsc_preconditioner_8cpp_source.html#l00070">PetscPreconditioner.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_preconditioner_html_a1bc0544da19e5de757d83ae2e4fb90de"><div class="ttname"><a href="../../d9/d80/classfemus_1_1_preconditioner.html#a1bc0544da19e5de757d83ae2e4fb90de">femus::Preconditioner::set_matrix</a></div><div class="ttdeci">void set_matrix(SparseMatrix &amp;mat)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/de4/_preconditioner_8hpp_source.html#l00116">Preconditioner.hpp:116</a></div></div>
<div class="ttc" id="anamespacefemus_html_a2b826b5e8671bc2f570f78b61de60d55"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a2b826b5e8671bc2f570f78b61de60d55">femus::__libmesh_petsc_preconditioner_setup</a></div><div class="ttdeci">PetscErrorCode __libmesh_petsc_preconditioner_setup(PC pc)</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00616">LinearEquationSolverPetsc.cpp:616</a></div></div>
<div class="ttc" id="anamespacefemus_html_abbf7ae06606778e3dd164b5174dd540e"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#abbf7ae06606778e3dd164b5174dd540e">femus::__libmesh_petsc_preconditioner_apply</a></div><div class="ttdeci">PetscErrorCode __libmesh_petsc_preconditioner_apply(PC pc, Vec x, Vec y)</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00627">LinearEquationSolverPetsc.cpp:627</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76babcafc38f42ee0137d571fb994637" name="a76babcafc38f42ee0137d571fb994637"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76babcafc38f42ee0137d571fb994637">&#9670;&#160;</a></span>initialized()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::LinearEquationSolver::initialized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if the data structures are </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00081">81</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>                               {</div>
<div class="line"><span class="lineno">   82</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a17783185d47a441d545cf1427d2624ee">_is_initialized</a>;</div>
<div class="line"><span class="lineno">   83</span>      }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0225c6bdb0c0a648df9fff0597b41a8b" name="a0225c6bdb0c0a648df9fff0597b41a8b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0225c6bdb0c0a648df9fff0597b41a8b">&#9670;&#160;</a></span>InitPde()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::InitPde </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>_SolPdeIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>SolType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; char * &gt; &amp;&#160;</td>
          <td class="paramname"><em>SolName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> * &gt; *&#160;</td>
          <td class="paramname"><em>Bdc_other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>other_gridn</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; bool &gt; &amp;&#160;</td>
          <td class="paramname"><em>SparsityPattern_other</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00196">196</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  201</span>                                                                        {</div>
<div class="line"><span class="lineno">  202</span>      </div>
<div class="line"><span class="lineno">  203</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a> = SolPdeIndex_other;</div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a9e44f8c783de0cfd5dae745305882f21">_gridn</a> = other_gridn;</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a> = SolType_other;</div>
<div class="line"><span class="lineno">  207</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a25739bd6cc78282815fa4dfe79ed3885">_SolName</a> = SolName_other;</div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#afa321f16b5b88902150fddb437a1745b">_Bdc</a> = Bdc_other;</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a59a6274d7ad89115708f2e654dca326b">_SparsityPattern</a> = SparsityPattern_other;</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">//--- Matrix and vectors offsets - BEGIN ---------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  213</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.resize(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size() + 1u);</div>
<div class="line"><span class="lineno">  214</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>[0] = 0;</div>
<div class="line"><span class="lineno">  215</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 1; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size(); i++)</div>
<div class="line"><span class="lineno">  216</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>[i] = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>[i - 1] + <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[i - 1]]][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>()];</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>.resize(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size() + 1);</div>
<div class="line"><span class="lineno">  219</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  220</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[i].resize(<a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>);</div>
<div class="line"><span class="lineno">  221</span>    }</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    <span class="comment">//KKoffset for each var, at processor 0</span></div>
<div class="line"><span class="lineno">  224</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][0] = 0;</div>
<div class="line"><span class="lineno">  225</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 1; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>.size(); <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  226</span>      <span class="keywordtype">unsigned</span> indexSol = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> - 1];</div>
<div class="line"><span class="lineno">  227</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0] = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> - 1][0] + (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol]][1] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol]][0]);</div>
<div class="line"><span class="lineno">  228</span>    }</div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    <span class="comment">//KKoffset for each var, for all other processors</span></div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>; i++) {</div>
<div class="line"><span class="lineno">  232</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][i] = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size()][i - 1];</div>
<div class="line"><span class="lineno">  233</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 1; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>.size(); <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  234</span>        <span class="keywordtype">unsigned</span> indexSol = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> - 1];</div>
<div class="line"><span class="lineno">  235</span>        <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i] = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> - 1][i] + (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol]][i + 1] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol]][i]);</div>
<div class="line"><span class="lineno">  236</span>      }</div>
<div class="line"><span class="lineno">  237</span>    }</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>    <span class="comment">//ghost size</span></div>
<div class="line"><span class="lineno">  240</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#af6ce9ed56da9e3475fcd4926bb5d782d">KKghostsize</a>.resize(<a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>, 0);</div>
<div class="line"><span class="lineno">  241</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>; i++) {</div>
<div class="line"><span class="lineno">  242</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  243</span>        <span class="keywordtype">unsigned</span> indexSol = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  244</span>        <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#af6ce9ed56da9e3475fcd4926bb5d782d">KKghostsize</a>[i] += <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a4f0b9dcbce8f00bd3e959cc3c3dfaf3b">dofmap_get_ghost_dofs</a>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol], i).size();</div>
<div class="line"><span class="lineno">  245</span>      }</div>
<div class="line"><span class="lineno">  246</span>    }</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span>    <span class="comment">//ghost nodes</span></div>
<div class="line"><span class="lineno">  249</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a541098ff691f1c1268d071581426eddf">KKghost_nd</a>.resize(<a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>);</div>
<div class="line"><span class="lineno">  250</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt; <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>; i++) {</div>
<div class="line"><span class="lineno">  251</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a541098ff691f1c1268d071581426eddf">KKghost_nd</a>[i].resize(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#af6ce9ed56da9e3475fcd4926bb5d782d">KKghostsize</a>[i]);</div>
<div class="line"><span class="lineno">  252</span>    }</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>; i++) {</div>
<div class="line"><span class="lineno">  256</span>      <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a528b2c16b23d4e442c2286fbcc2b120b">counter</a> = 0;</div>
<div class="line"><span class="lineno">  257</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  258</span>        <span class="keywordtype">unsigned</span> indexSol = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  259</span>        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a4f0b9dcbce8f00bd3e959cc3c3dfaf3b">dofmap_get_ghost_dofs</a>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol], i).size(); k++) {</div>
<div class="line"><span class="lineno">  260</span>          <span class="comment">// ghost node</span></div>
<div class="line"><span class="lineno">  261</span>          <span class="keywordtype">unsigned</span> idof_metis = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a4f0b9dcbce8f00bd3e959cc3c3dfaf3b">dofmap_get_ghost_dofs</a>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol], i)[k];</div>
<div class="line"><span class="lineno">  262</span>          <span class="keywordtype">unsigned</span> isubdom = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad0eaa40354f159fd15f336c39f7bfd3b">BisectionSearch_find_processor_of_dof</a>(idof_metis, <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol]);</div>
<div class="line"><span class="lineno">  263</span>          <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a541098ff691f1c1268d071581426eddf">KKghost_nd</a>[i][<a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a528b2c16b23d4e442c2286fbcc2b120b">counter</a>] = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][isubdom] + idof_metis - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aea3bb5e946dca1be0fa0bf40e2ccae73">_msh</a>-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a4a5e4c71c752f353ee47c2923c95b7f8">_dofOffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[indexSol]][isubdom];</div>
<div class="line"><span class="lineno">  264</span>          <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a528b2c16b23d4e442c2286fbcc2b120b">counter</a>++;</div>
<div class="line"><span class="lineno">  265</span>        }</div>
<div class="line"><span class="lineno">  266</span>      }</div>
<div class="line"><span class="lineno">  267</span>    }</div>
<div class="line"><span class="lineno">  268</span>    <span class="comment">//--- Matrix and vectors offsets - END ---------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  269</span>    </div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span>    <span class="comment">//--- Error and residual: build and init - BEGIN --------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordtype">int</span> EPSsize = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1];</div>
<div class="line"><span class="lineno">  273</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a> = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">if</span>(<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>() == 1) {  <span class="comment">// IF SERIAL</span></div>
<div class="line"><span class="lineno">  275</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(EPSsize, EPSsize, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>);</div>
<div class="line"><span class="lineno">  276</span>    }</div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordflow">else</span> { <span class="comment">// IF PARALLEL</span></div>
<div class="line"><span class="lineno">  278</span>      <span class="keywordtype">int</span> EPS_local_size = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()];</div>
<div class="line"><span class="lineno">  279</span>      <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(EPSsize, EPS_local_size, <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a541098ff691f1c1268d071581426eddf">KKghost_nd</a>[<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()], <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>);</div>
<div class="line"><span class="lineno">  280</span>    }</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a> = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  283</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>);</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a> = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  286</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>);</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a> = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  289</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>);</div>
<div class="line"><span class="lineno">  290</span>    <span class="comment">//--- Error and residual: build and init - END --------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>    <span class="comment">//--- Matrix: Sparsity pattern: fill it as if all variables were sparse - BEGIN  -----------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  294</span>    <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#ad3053db3500d06e996703acf43efbcd7">GetSparsityPatternSize</a>();</div>
<div class="line"><span class="lineno">  295</span>    <span class="comment">//--- Matrix: Sparsity pattern: fill it as if all variables were sparse - END  -----------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>    </div>
<div class="line"><span class="lineno">  298</span>    <span class="comment">//--- Matrix: Sparsity pattern: adjust it for dense variables - BEGIN -----------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">//     const unsigned dim = _msh-&gt;GetDimension();</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">//     int KK_UNIT_SIZE_ = pow(5, dim);</span></div>
<div class="line"><span class="lineno">  301</span>    <span class="keywordtype">int</span> KK_size = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1u];</div>
<div class="line"><span class="lineno">  302</span>    <span class="keywordtype">int</span> KK_local_size = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()]; <span class="comment">//sum of all vars</span></div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">_sparsityPatternMinimumSize</a>.size() &gt; 0) {</div>
<div class="line"><span class="lineno">  305</span>        </div>
<div class="line"><span class="lineno">  306</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae8585849c6da7f7415bc2939e86476f2">_sparsityPatternVariableIndex</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  307</span>                 </div>
<div class="line"><span class="lineno">  308</span>        <span class="keywordtype">unsigned</span> maxDiagSize    = (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">_sparsityPatternMinimumSize</a>[i] &lt; KK_local_size) ? <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">_sparsityPatternMinimumSize</a>[i] : KK_local_size; <span class="comment">//minimum between SPMinSize and the sum of all vars: I cannot clearly have a number of columns greater than the sum of all vars</span></div>
<div class="line"><span class="lineno">  309</span>        <span class="keywordtype">unsigned</span> maxOffDiagSize = (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">_sparsityPatternMinimumSize</a>[i] &lt; KK_size - KK_local_size) ? <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">_sparsityPatternMinimumSize</a>[i] : KK_size - KK_local_size;  </div>
<div class="line"><span class="lineno">  310</span>          </div>
<div class="line"><span class="lineno">  311</span>        <span class="keywordtype">unsigned</span> <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a> = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae8585849c6da7f7415bc2939e86476f2">_sparsityPatternVariableIndex</a>[i];   </div>
<div class="line"><span class="lineno">  312</span>        <span class="keywordtype">unsigned</span> jstart = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()];</div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordtype">unsigned</span> jend = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a> + 1][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>()];</div>
<div class="line"><span class="lineno">  314</span>        </div>
<div class="line"><span class="lineno">  315</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = jstart; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; jend; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  316</span>          <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] &gt; maxDiagSize) ? <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] : maxDiagSize;</div>
<div class="line"><span class="lineno">  317</span>          <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] &gt; maxOffDiagSize) ? <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] : maxOffDiagSize;</div>
<div class="line"><span class="lineno">  318</span>        }</div>
<div class="line"><span class="lineno">  319</span>      }</div>
<div class="line"><span class="lineno">  320</span>      </div>
<div class="line"><span class="lineno">  321</span>    }</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a15b46748a2e26bc263e3e6e4690e8a3b">_iproc</a> == 0) {</div>
<div class="line"><span class="lineno">  324</span>      <span class="keywordtype">unsigned</span> globalVariableStart = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 2][0];</div>
<div class="line"><span class="lineno">  325</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k = globalVariableStart; k &lt; globalVariableStart + <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">_numberOfGlobalVariables</a>; k++) {</div>
<div class="line"><span class="lineno">  326</span>        <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>[k] = KK_local_size;</div>
<div class="line"><span class="lineno">  327</span>        <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>[k] = KK_size - KK_local_size;</div>
<div class="line"><span class="lineno">  328</span>      }</div>
<div class="line"><span class="lineno">  329</span>    }</div>
<div class="line"><span class="lineno">  330</span>    <span class="comment">//--- Matrix: Sparsity pattern: adjust it for dense variables - END -----------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  331</span>    </div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <span class="comment">//--- Matrix: build and init - BEGIN --------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  334</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a> = <a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a350a92495af225cec7b898b9fe29d9d2">SparseMatrix::build</a>().release();</div>
<div class="line"><span class="lineno">  335</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a531f103b054502698cbe01767640861d">init</a>(KK_size, KK_size, KK_local_size, KK_local_size, <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>, <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>);</div>
<div class="line"><span class="lineno">  336</span>    <span class="comment">//--- Matrix: build and init - END  --------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="comment">//--- Matrix AMR: build - BEGIN --------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  339</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">_KKamr</a> = <a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a350a92495af225cec7b898b9fe29d9d2">SparseMatrix::build</a>().release();</div>
<div class="line"><span class="lineno">  340</span>    <span class="comment">//--- Matrix AMR: build - END --------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  }</div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a></div><div class="ttdeci">@ SERIAL</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00006">ParalleltypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a></div><div class="ttdeci">@ GHOSTED</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00008">ParalleltypeEnum.hpp:8</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a541098ff691f1c1268d071581426eddf"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a541098ff691f1c1268d071581426eddf">femus::LinearEquation::KKghost_nd</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; int &gt; &gt; KKghost_nd</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00133">LinearEquation.hpp:133</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ad3053db3500d06e996703acf43efbcd7"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ad3053db3500d06e996703acf43efbcd7">femus::LinearEquation::GetSparsityPatternSize</a></div><div class="ttdeci">void GetSparsityPatternSize()</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d77/_linear_equation_8cpp_source.html#l00407">LinearEquation.cpp:407</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ada4422410129b056d30d9bec6373398a"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">femus::LinearEquation::_sparsityPatternMinimumSize</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _sparsityPatternMinimumSize</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00173">LinearEquation.hpp:173</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ae8585849c6da7f7415bc2939e86476f2"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ae8585849c6da7f7415bc2939e86476f2">femus::LinearEquation::_sparsityPatternVariableIndex</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _sparsityPatternVariableIndex</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00175">LinearEquation.hpp:175</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_af6ce9ed56da9e3475fcd4926bb5d782d"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#af6ce9ed56da9e3475fcd4926bb5d782d">femus::LinearEquation::KKghostsize</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; KKghostsize</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00130">LinearEquation.hpp:130</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a4f0b9dcbce8f00bd3e959cc3c3dfaf3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a4f0b9dcbce8f00bd3e959cc3c3dfaf3b">femus::Mesh::dofmap_get_ghost_dofs</a></div><div class="ttdeci">std::vector&lt; int &gt; dofmap_get_ghost_dofs(const unsigned soltype, const unsigned proc_id) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00517">Mesh.hpp:517</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_abd17257b0b8aa9e09fd13cbd9c0bed08"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">femus::NumericVector::init</a></div><div class="ttdeci">virtual void init(const int, const int, const bool=false, const ParallelType=AUTOMATIC)=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a0ee45f5bc96766fa25c736a40674e551"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">femus::ParallelObject::_nprocs</a></div><div class="ttdeci">int _nprocs</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00060">ParallelObject.hpp:60</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a15b46748a2e26bc263e3e6e4690e8a3b"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a15b46748a2e26bc263e3e6e4690e8a3b">femus::ParallelObject::_iproc</a></div><div class="ttdeci">int _iproc</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00061">ParallelObject.hpp:61</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a350a92495af225cec7b898b9fe29d9d2"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a350a92495af225cec7b898b9fe29d9d2">femus::SparseMatrix::build</a></div><div class="ttdeci">static std::unique_ptr&lt; SparseMatrix &gt; build(const SolverPackage solver_package=LSOLVER)</div><div class="ttdef"><b>Definition</b> <a href="../../da/d75/_sparse_matrix_8cpp_source.html#l00042">SparseMatrix.cpp:42</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a531f103b054502698cbe01767640861d"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a531f103b054502698cbe01767640861d">femus::SparseMatrix::init</a></div><div class="ttdeci">virtual void init(const int m, const int n, const int m_l, const int n_l, const int nnz=30, const int noz=10)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d14/_sparse_matrix_8hpp_source.html#l00065">SparseMatrix.hpp:65</a></div></div>
<div class="ttc" id="anamespacefemus_1_1_mesh_tools_1_1_generation_1_1_private_html_aaf3a90632b9ae7f97dc126807a304603"><div class="ttname"><a href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">femus::MeshTools::Generation::Private::idx</a></div><div class="ttdeci">unsigned int idx(const ElemType type, const unsigned int nx, const unsigned int i, const unsigned int j)</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd7/_mesh_generation_8cpp_source.html#l00052">MeshGeneration.cpp:52</a></div></div>
<div class="ttc" id="anamespacefemus_html_a528b2c16b23d4e442c2286fbcc2b120b"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a528b2c16b23d4e442c2286fbcc2b120b">femus::counter</a></div><div class="ttdeci">unsigned counter</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d75/_f_s_i_time_dependent_assembly_supg___o_l_d_8hpp_source.html#l03071">FSITimeDependentAssemblySupg_OLD.hpp:3071</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a30aa95e533fef8ca0e123f0aecefe557" name="a30aa95e533fef8ca0e123f0aecefe557"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a30aa95e533fef8ca0e123f0aecefe557">&#9670;&#160;</a></span>MGClear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::MGClear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a66b4dbef5f62eef5619e4ea4e0b794bf">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00086">86</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   86</span>                            {</div>
<div class="line"><span class="lineno">   87</span>        KSPDestroy (&amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">   88</span>      }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2a3d5db15d339ecbd4181ba42965568" name="ab2a3d5db15d339ecbd4181ba42965568"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2a3d5db15d339ecbd4181ba42965568">&#9670;&#160;</a></span>MGInit()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::MGInit </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8">MgSmootherType</a> &amp;&#160;</td>
          <td class="paramname"><em>mg_smoother_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>levelMax</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> &amp;&#160;</td>
          <td class="paramname"><em>mgSolverType</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ad2e7e0bfe4119ba915fe547348e19c17">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00185">185</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  185</span>                                                                                                                                           {</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>    KSPCreate (PETSC_COMM_WORLD, &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>    <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a610f329a44512e94e0794c2e85bca1ee">_mgSolverType</a> = mgSolverType;</div>
<div class="line"><span class="lineno">  190</span>    <span class="keywordtype">double</span> otherRCF = <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a>;</div>
<div class="line"><span class="lineno">  191</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a> = .99999;</div>
<div class="line"><span class="lineno">  192</span>    <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a411eac388d69b468ca820cf252c06dad">SetSolver</a> (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a610f329a44512e94e0794c2e85bca1ee">_mgSolverType</a>);</div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a> = otherRCF;</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span>    KSPGetPC (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>);</div>
<div class="line"><span class="lineno">  196</span>    PCSetType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, PCMG);</div>
<div class="line"><span class="lineno">  197</span>    PCMGSetLevels (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, levelMax, NULL);</div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">if</span> (mg_smoother_type == <a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8ad08f8ac0aa8dfb59589824359772459e">FULL</a>) {</div>
<div class="line"><span class="lineno">  200</span>      PCMGSetType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, PC_MG_FULL);</div>
<div class="line"><span class="lineno">  201</span>    }</div>
<div class="line"><span class="lineno">  202</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mg_smoother_type == <a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8a2618be531dddb3647be5874ddcae5164">MULTIPLICATIVE</a>) {</div>
<div class="line"><span class="lineno">  203</span>      PCMGSetType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, PC_MG_MULTIPLICATIVE);</div>
<div class="line"><span class="lineno">  204</span>    }</div>
<div class="line"><span class="lineno">  205</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mg_smoother_type == <a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8ac0c02294c1fb924d8ee2ae11f9426c0e">ADDITIVE</a>) {</div>
<div class="line"><span class="lineno">  206</span>      PCMGSetType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, PC_MG_ADDITIVE);</div>
<div class="line"><span class="lineno">  207</span>    }</div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (mg_smoother_type == <a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8adcdabf60c1c9538aefec29b2a750ca71">KASKADE</a>) {</div>
<div class="line"><span class="lineno">  209</span>      PCMGSetType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2f1863719353c8ca3a9d7f9ba5723875">_pc</a>, PC_MG_KASKADE);</div>
<div class="line"><span class="lineno">  210</span>    }</div>
<div class="line"><span class="lineno">  211</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  212</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Wrong mg_type for PETSCsolve()&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  213</span>      abort();</div>
<div class="line"><span class="lineno">  214</span>    }</div>
<div class="line"><span class="lineno">  215</span>  };</div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_aec11e12c1f11a6ad959d3280ae0ee9a8a2618be531dddb3647be5874ddcae5164"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8a2618be531dddb3647be5874ddcae5164">MULTIPLICATIVE</a></div><div class="ttdeci">@ MULTIPLICATIVE</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00012">MgTypeEnum.hpp:12</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_aec11e12c1f11a6ad959d3280ae0ee9a8ac0c02294c1fb924d8ee2ae11f9426c0e"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8ac0c02294c1fb924d8ee2ae11f9426c0e">ADDITIVE</a></div><div class="ttdeci">@ ADDITIVE</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00013">MgTypeEnum.hpp:13</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_aec11e12c1f11a6ad959d3280ae0ee9a8ad08f8ac0aa8dfb59589824359772459e"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8ad08f8ac0aa8dfb59589824359772459e">FULL</a></div><div class="ttdeci">@ FULL</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00011">MgTypeEnum.hpp:11</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_aec11e12c1f11a6ad959d3280ae0ee9a8adcdabf60c1c9538aefec29b2a750ca71"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#aec11e12c1f11a6ad959d3280ae0ee9a8adcdabf60c1c9538aefec29b2a750ca71">KASKADE</a></div><div class="ttdeci">@ KASKADE</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00015">MgTypeEnum.hpp:14</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_a610f329a44512e94e0794c2e85bca1ee"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a610f329a44512e94e0794c2e85bca1ee">femus::LinearEquationSolver::_mgSolverType</a></div><div class="ttdeci">SolverType _mgSolverType</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00182">LinearEquationSolver.hpp:182</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a19998642dc1a8853d8a36cccae3f2224" name="a19998642dc1a8853d8a36cccae3f2224"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a19998642dc1a8853d8a36cccae3f2224">&#9670;&#160;</a></span>MGSetLevel()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::MGSetLevel </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a> *&#160;</td>
          <td class="paramname"><em>LinSolver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>maxlevel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>variable_to_be_solved</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *&#160;</td>
          <td class="paramname"><em>PP</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> *&#160;</td>
          <td class="paramname"><em>RR</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>npre</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>npost</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a3de70b289873d784ce68e602e36d5a51">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00219">219</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  222</span>                                                 {</div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>    <span class="keywordtype">unsigned</span> level = <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>();</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="comment">// ***************** NODE/ELEMENT SEARCH *******************</span></div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ab048018b0a8274ee43ae0b59977f591b">_bdcIndexIsInitialized</a> == 0) <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ad64712ae2d655fc49c58814f7411c334">BuildBdcIndex</a> (variable_to_be_solved);</div>
<div class="line"><span class="lineno">  228</span>    <span class="comment">// ***************** END NODE/ELEMENT SEARCH *******************</span></div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    KSP* kspMG = LinSolver-&gt;GetKSP();</div>
<div class="line"><span class="lineno">  231</span>    PC pcMG;</div>
<div class="line"><span class="lineno">  232</span>    KSPGetPC (*kspMG, &amp;pcMG);</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    KSP subksp;</div>
<div class="line"><span class="lineno">  235</span> </div>
<div class="line"><span class="lineno">  236</span>    <span class="keywordflow">if</span> (level == 0) {</div>
<div class="line"><span class="lineno">  237</span>      PCMGGetCoarseSolve (pcMG, &amp;subksp);</div>
<div class="line"><span class="lineno">  238</span>      KSPSetTolerances (subksp, PETSC_DEFAULT, PETSC_DEFAULT, PETSC_DEFAULT, npre);</div>
<div class="line"><span class="lineno">  239</span>    }</div>
<div class="line"><span class="lineno">  240</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  241</span>      PCMGGetSmoother (pcMG, level , &amp;subksp);</div>
<div class="line"><span class="lineno">  242</span>      KSPSetTolerances (subksp, PETSC_DEFAULT, PETSC_DEFAULT, PETSC_DEFAULT, npre);</div>
<div class="line"><span class="lineno">  243</span>    }</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>    <span class="keywordflow">if</span> (level != 0 &amp;&amp; <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a> == <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>) {</div>
<div class="line"><span class="lineno">  246</span>      <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a> = <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3">RICHARDSON</a>;</div>
<div class="line"><span class="lineno">  247</span>      <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a> = 1.;</div>
<div class="line"><span class="lineno">  248</span>    }</div>
<div class="line"><span class="lineno">  249</span>    </div>
<div class="line"><span class="lineno">  250</span>    this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a411eac388d69b468ca820cf252c06dad">SetSolver</a> (subksp, <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a>);</div>
<div class="line"><span class="lineno">  251</span>    std::ostringstream levelName;</div>
<div class="line"><span class="lineno">  252</span>    levelName &lt;&lt; <span class="stringliteral">&quot;level-&quot;</span> &lt;&lt; level;</div>
<div class="line"><span class="lineno">  253</span>    KSPSetOptionsPrefix (subksp, levelName.str().c_str());</div>
<div class="line"><span class="lineno">  254</span>    KSPSetFromOptions (subksp);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>    <span class="comment">//ZerosBoundaryResiduals();</span></div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>    <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aae35adda9653bd3682791e00539edefc">SetPenalty</a>();</div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#affda1228209a0acafbbaa4e179d4d516">RemoveNullSpace</a>();</div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span>    Mat <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>))-&gt;mat();</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>    KSPSetOperators (subksp, <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>, <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>    PC subpc;</div>
<div class="line"><span class="lineno">  266</span>    KSPGetPC (subksp, &amp;subpc);</div>
<div class="line"><span class="lineno">  267</span>    <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a716f7336380f1a4093d3c5657284fde7">SetPreconditioner</a> (subksp, subpc);</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>    <span class="keywordflow">if</span> (level &lt; levelMax) {</div>
<div class="line"><span class="lineno">  270</span>      PCMGSetX (pcMG, level, (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>))-&gt;vec());</div>
<div class="line"><span class="lineno">  271</span>      PCMGSetRhs (pcMG, level, (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>))-&gt;vec());</div>
<div class="line"><span class="lineno">  272</span>    }</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>    <span class="keywordflow">if</span> (level &gt; 0) {</div>
<div class="line"><span class="lineno">  275</span>      PCMGSetR (pcMG, level, (<span class="keyword">static_cast&lt;</span>PetscVector*<span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>))-&gt;vec());</div>
<div class="line"><span class="lineno">  276</span>      PCMGSetInterpolation (pcMG, level, (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (PP))-&gt;mat());</div>
<div class="line"><span class="lineno">  277</span>      PCMGSetRestriction (pcMG, level, (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (RR))-&gt;mat());</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>      <span class="keywordflow">if</span> (npre != npost) {</div>
<div class="line"><span class="lineno">  280</span>        KSP subkspUp;</div>
<div class="line"><span class="lineno">  281</span>        PCMGGetSmootherUp (pcMG, level , &amp;subkspUp);</div>
<div class="line"><span class="lineno">  282</span>        KSPSetTolerances (subkspUp, PETSC_DEFAULT, PETSC_DEFAULT, PETSC_DEFAULT, npost);</div>
<div class="line"><span class="lineno">  283</span>        this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a411eac388d69b468ca820cf252c06dad">SetSolver</a> (subkspUp, <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a>);</div>
<div class="line"><span class="lineno">  284</span>        KSPSetPC (subkspUp, subpc);</div>
<div class="line"><span class="lineno">  285</span>        PC subpcUp;</div>
<div class="line"><span class="lineno">  286</span>        KSPGetPC (subkspUp, &amp;subpcUp);</div>
<div class="line"><span class="lineno">  287</span>        KSPSetUp (subkspUp);</div>
<div class="line"><span class="lineno">  288</span>      }</div>
<div class="line"><span class="lineno">  289</span>    }</div>
<div class="line"><span class="lineno">  290</span>  }</div>
<div class="ttc" id="a_f_e_type_enum__deprecated_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451"><div class="ttname"><a href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a></div><div class="ttdeci">@ KK</div><div class="ttdef"><b>Definition</b> <a href="../../db/d1d/_f_e_type_enum__deprecated_8hpp_source.html#l00005">FETypeEnum_deprecated.hpp:5</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3">RICHARDSON</a></div><div class="ttdeci">@ RICHARDSON</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00023">SolvertypeEnum.hpp:23</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_aae35adda9653bd3682791e00539edefc"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aae35adda9653bd3682791e00539edefc">femus::LinearEquationSolverPetsc::SetPenalty</a></div><div class="ttdeci">void SetPenalty()</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00428">LinearEquationSolverPetsc.cpp:428</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_ad64712ae2d655fc49c58814f7411c334"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ad64712ae2d655fc49c58814f7411c334">femus::LinearEquationSolverPetsc::BuildBdcIndex</a></div><div class="ttdeci">virtual void BuildBdcIndex(const std::vector&lt; unsigned &gt; &amp;variable_to_be_solved)</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00053">LinearEquationSolverPetsc.cpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_affda1228209a0acafbbaa4e179d4d516"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#affda1228209a0acafbbaa4e179d4d516">femus::LinearEquationSolverPetsc::RemoveNullSpace</a></div><div class="ttdeci">void RemoveNullSpace()</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00357">LinearEquationSolverPetsc.cpp:357</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abb2f6b45aba268e628d8bd928cc267c7" name="abb2f6b45aba268e628d8bd928cc267c7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abb2f6b45aba268e628d8bd928cc267c7">&#9670;&#160;</a></span>MGSolve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::MGSolve </td>
          <td>(</td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>ksp_clean</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a6233a9978c862c966e9f7b9b5ab6c95a">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00294">294</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  294</span>                                                               {</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    PetscLogDouble t1;</div>
<div class="line"><span class="lineno">  297</span>    PetscLogDouble t2;</div>
<div class="line"><span class="lineno">  298</span>    PetscTime (&amp;t1);</div>
<div class="line"><span class="lineno">  299</span> </div>
<div class="line"><span class="lineno">  300</span>    <span class="keywordflow">if</span> (ksp_clean) {</div>
<div class="line"><span class="lineno">  301</span>      Mat <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>))-&gt;mat();</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>      KSPSetOperators (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>, <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>);</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>      KSPSetTolerances (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a12be6e63b0980ad661ac0b5f1db07677">_rtol</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acc02d3a5864f2c8534190b109fdcf0a1">_abstol</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a099f48f80b5eca34c976a932bcac5243">_dtol</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2da36631345b3bf33696f6c8f5882dc4">_maxits</a>);</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>      <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a610f329a44512e94e0794c2e85bca1ee">_mgSolverType</a> != <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>) {</div>
<div class="line"><span class="lineno">  308</span>        KSPSetInitialGuessKnoll (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, PETSC_TRUE);</div>
<div class="line"><span class="lineno">  309</span>      }</div>
<div class="line"><span class="lineno">  310</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  311</span>        KSPSetInitialGuessKnoll (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, PETSC_FALSE);</div>
<div class="line"><span class="lineno">  312</span>        KSPSetNormType (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, KSP_NORM_NONE);</div>
<div class="line"><span class="lineno">  313</span>      }</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>      KSPSetFromOptions (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  316</span>      KSPGMRESSetRestart (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a595c4b08e58212f1d93c1518e51bdb43">_restart</a>);</div>
<div class="line"><span class="lineno">  317</span>      KSPSetUp (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>);</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span><span class="comment">//       PetscViewer    viewer;</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">//       PetscViewerDrawOpen(PETSC_COMM_WORLD,NULL,NULL,0,0,1800,1800,&amp;viewer);</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">//       PetscObjectSetName((PetscObject)viewer,&quot;FSI matrix&quot;);</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">//       PetscViewerPushFormat(viewer,PETSC_VIEWER_DRAW_LG);</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">//       MatView(KK,viewer);</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">//       VecView((static_cast&lt; PetscVector* &gt;(_RES))-&gt;vec(),viewer);</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">//       double a;</span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">//       std::cin&gt;&gt;a;</span></div>
<div class="line"><span class="lineno">  328</span>    }</div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span>    <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aba7244a1ff374a9a2099d1109d97f28f">ZerosBoundaryResiduals</a>();</div>
<div class="line"><span class="lineno">  331</span>    KSPSolve (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>))-&gt;vec(), (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>))-&gt;vec());</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abc7a62c82d215dcc9e6b42f7bb4ee8eb">matrix_mult</a> (*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>, *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>);</div>
<div class="line"><span class="lineno">  334</span>    *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a> -= *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>;</div>
<div class="line"><span class="lineno">  335</span>    *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a> += *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>;</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a7058888fb57ea520cce21647a69db329">_printSolverInfo</a>) {</div>
<div class="line"><span class="lineno">  338</span>      <span class="keywordtype">int</span> its;</div>
<div class="line"><span class="lineno">  339</span>      KSPGetIterationNumber (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;its);</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>      KSPConvergedReason reason;</div>
<div class="line"><span class="lineno">  342</span>      KSPGetConvergedReason (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;reason);</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>      PetscReal rnorm;</div>
<div class="line"><span class="lineno">  345</span>      KSPGetResidualNorm (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;rnorm);</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>      PetscTime (&amp;t2);</div>
<div class="line"><span class="lineno">  348</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;       *************** MG linear solver time: %e \n&quot;</span>, t2 - t1);</div>
<div class="line"><span class="lineno">  349</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;       *************** Number of outer ksp solver iterations = %i \n&quot;</span>, its);</div>
<div class="line"><span class="lineno">  350</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;       *************** Convergence reason = %i \n&quot;</span>, reason);</div>
<div class="line"><span class="lineno">  351</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;       *************** Residual norm = %10.8g \n&quot;</span>, rnorm);</div>
<div class="line"><span class="lineno">  352</span>    }</div>
<div class="line"><span class="lineno">  353</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_aba7244a1ff374a9a2099d1109d97f28f"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aba7244a1ff374a9a2099d1109d97f28f">femus::LinearEquationSolverPetsc::ZerosBoundaryResiduals</a></div><div class="ttdeci">void ZerosBoundaryResiduals()</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00417">LinearEquationSolverPetsc.cpp:417</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_abc7a62c82d215dcc9e6b42f7bb4ee8eb"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#abc7a62c82d215dcc9e6b42f7bb4ee8eb">femus::NumericVector::matrix_mult</a></div><div class="ttdeci">virtual void matrix_mult(const NumericVector &amp;vec_in, const SparseMatrix &amp;mat_in)=0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af6629fca51be192be664c76eb8aecc79" name="af6629fca51be192be664c76eb8aecc79"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6629fca51be192be664c76eb8aecc79">&#9670;&#160;</a></span>n_processors()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::ParallelObject::n_processors </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the number of processors in the group. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html#l00048">48</a> of file <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html">ParallelObject.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   48</span>                             {</div>
<div class="line"><span class="lineno">   49</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>;</div>
<div class="line"><span class="lineno">   50</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a23b3ae3499f28474a3e97495ef711d65" name="a23b3ae3499f28474a3e97495ef711d65"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a23b3ae3499f28474a3e97495ef711d65">&#9670;&#160;</a></span>preconditioner_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cf">PreconditionerType</a> femus::LinearEquationSolver::preconditioner_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the type of preconditioner to use. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html#l00077">77</a> of file <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html">LinearEquationSolver.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   78</span>  {</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>)    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>-&gt;<a class="code hl_function" href="../../d9/d80/classfemus_1_1_preconditioner.html#a362032c26bed3a570fe8f55e17b99f61">type</a>();</div>
<div class="line"><span class="lineno">   80</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a>;</div>
<div class="line"><span class="lineno">   81</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_preconditioner_html_a362032c26bed3a570fe8f55e17b99f61"><div class="ttname"><a href="../../d9/d80/classfemus_1_1_preconditioner.html#a362032c26bed3a570fe8f55e17b99f61">femus::Preconditioner::type</a></div><div class="ttdeci">PreconditionerType type() const</div><div class="ttdef"><b>Definition</b> <a href="../../d7/de4/_preconditioner_8hpp_source.html#l00082">Preconditioner.hpp:82</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2f47f968a0f140be0a127d20f5476ac" name="ab2f47f968a0f140be0a127d20f5476ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2f47f968a0f140be0a127d20f5476ac">&#9670;&#160;</a></span>print_residual_with_structure_matlab_friendly()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::print_residual_with_structure_matlab_friendly </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>iproc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>filename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> *&#160;</td>
          <td class="paramname"><em>num_vec_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Print numeric vector with structure </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00113">113</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  113</span>                                                                                                                                                     {</div>
<div class="line"><span class="lineno">  114</span>      </div>
<div class="line"><span class="lineno">  115</span><span class="comment">//       if (iproc == 0) {</span></div>
<div class="line"><span class="lineno">  116</span>      </div>
<div class="line"><span class="lineno">  117</span>      std::ofstream file_pr;</div>
<div class="line"><span class="lineno">  118</span>      file_pr.open (filename);</div>
<div class="line"><span class="lineno">  119</span>      </div>
<div class="line"><span class="lineno">  120</span>      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> global_size_for_all_vars = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1];</div>
<div class="line"><span class="lineno">  121</span>      </div>
<div class="line"><span class="lineno">  122</span>      file_pr &lt;&lt; <span class="stringliteral">&quot;% &quot;</span> &lt;&lt; <span class="stringliteral">&quot;global size for all vars &quot;</span> &lt;&lt; global_size_for_all_vars &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  123</span>      </div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ip = 0; ip &lt; <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>; ip++) {</div>
<div class="line"><span class="lineno">  125</span>                 <span class="keyword">const</span> <span class="keywordtype">unsigned</span> local_size_for_all_vars = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5f1126279cb193c88f8bd2e85341f31e">KKIndex</a>.size() - 1][ip] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[0][ip];</div>
<div class="line"><span class="lineno">  126</span>                  file_pr &lt;&lt; <span class="stringliteral">&quot;% &quot;</span> &lt;&lt; <span class="stringliteral">&quot;in proc &quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot; local size for all vars &quot;</span>  &lt;&lt; local_size_for_all_vars &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  127</span>         }</div>
<div class="line"><span class="lineno">  128</span>         </div>
<div class="line"><span class="lineno">  129</span>      std::vector&lt; double &gt; v_global(global_size_for_all_vars);   </div>
<div class="line"><span class="lineno">  130</span>         </div>
<div class="line"><span class="lineno">  131</span>      num_vec_in-&gt;localize(v_global);</div>
<div class="line"><span class="lineno">  132</span><span class="comment">//       Since I want to print the NumericVectors, I need to read from them.</span></div>
<div class="line"><span class="lineno">  133</span><span class="comment">// The problem is that they don&#39;t have the structure of each var</span></div>
<div class="line"><span class="lineno">  134</span><span class="comment">// Since these vectors are filled by looping over elements for each proc, that&#39;s what we should do</span></div>
<div class="line"><span class="lineno">  135</span><span class="comment">// The problem is that we would repeat the visits of nodes, so we don&#39;t want to do that</span></div>
<div class="line"><span class="lineno">  136</span>      </div>
<div class="line"><span class="lineno">  137</span>      <span class="keywordtype">unsigned</span> running_index = 1;  <span class="comment">//to be consistent with potential future Matlab reading</span></div>
<div class="line"><span class="lineno">  138</span>     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ip = 0; ip &lt; <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a0ee45f5bc96766fa25c736a40674e551">_nprocs</a>; ip++) {</div>
<div class="line"><span class="lineno">  139</span>          file_pr &lt;&lt; <span class="stringliteral">&quot;% &quot;</span> &lt;&lt; <span class="stringliteral">&quot;--------- processor &quot;</span> &lt;&lt; ip &lt;&lt; <span class="stringliteral">&quot; ---------&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  140</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5dd44a3538606bda13d2fcdfea5c2b35">_SolPdeIndex</a>.size(); ivar++) {</div>
<div class="line"><span class="lineno">  141</span>                  file_pr  &lt;&lt; <span class="stringliteral">&quot;% &quot;</span> &lt;&lt; <span class="stringliteral">&quot;++++++ &quot;</span> &lt;&lt; ivar &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a25739bd6cc78282815fa4dfe79ed3885">_SolName</a>[ivar] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  142</span>                  file_pr &lt;&lt; <span class="stringliteral">&quot; FE type &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a777130e1a7e1342528f816e09c56be01">_SolType</a>[ivar] &lt;&lt; <span class="stringliteral">&quot;, &quot;</span>;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>                      <span class="keyword">const</span> <span class="keywordtype">unsigned</span> local_size_for_var = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[ivar + 1][ip] - <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[ivar][ip];</div>
<div class="line"><span class="lineno">  145</span>                  file_pr &lt;&lt; <span class="stringliteral">&quot; local size &quot;</span>  &lt;&lt; local_size_for_var &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  146</span>                  </div>
<div class="line"><span class="lineno">  147</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> loc_ind = 0; loc_ind &lt; local_size_for_var; loc_ind++) {</div>
<div class="line"><span class="lineno">  148</span>                  file_pr &lt;&lt; running_index &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; v_global[running_index-1] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  149</span>                 running_index ++;</div>
<div class="line"><span class="lineno">  150</span>            }</div>
<div class="line"><span class="lineno">  151</span>         }</div>
<div class="line"><span class="lineno">  152</span>      }</div>
<div class="line"><span class="lineno">  153</span>      </div>
<div class="line"><span class="lineno">  154</span>      file_pr &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  155</span>      </div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>      file_pr.close();          </div>
<div class="line"><span class="lineno">  158</span>      </div>
<div class="line"><span class="lineno">  159</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  160</span>      </div>
<div class="line"><span class="lineno">  161</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6438b3ffcc8cde2d6ccfb4ec563dfce1" name="a6438b3ffcc8cde2d6ccfb4ec563dfce1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6438b3ffcc8cde2d6ccfb4ec563dfce1">&#9670;&#160;</a></span>processor_id()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::ParallelObject::processor_id </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the rank of this processor in the group. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">53</a> of file <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html">ParallelObject.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                             {</div>
<div class="line"><span class="lineno">   54</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../dd/d90/classfemus_1_1_parallel_object.html#a15b46748a2e26bc263e3e6e4690e8a3b">_iproc</a>;</div>
<div class="line"><span class="lineno">   55</span>    }</div>
</div><!-- fragment -->
</div>
</div>
<a id="affda1228209a0acafbbaa4e179d4d516" name="affda1228209a0acafbbaa4e179d4d516"></a>
<h2 class="memtitle"><span class="permalink"><a href="#affda1228209a0acafbbaa4e179d4d516">&#9670;&#160;</a></span>RemoveNullSpace()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::RemoveNullSpace </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00357">357</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  357</span>                                                  {</div>
<div class="line"><span class="lineno">  358</span> </div>
<div class="line"><span class="lineno">  359</span>    <span class="keywordflow">if</span> ( <a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a220ecdfa001bbb23c8aabe40139620e2">GetMeshFromLinEq</a>()-&gt;GetLevel() != 0) {</div>
<div class="line"><span class="lineno">  360</span>      std::vector &lt; Vec &gt; nullspBase;</div>
<div class="line"><span class="lineno">  361</span>      <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a3d6585056575a152842422596e64a0f4">GetNullSpaceBase</a> (nullspBase);</div>
<div class="line"><span class="lineno">  362</span>      <span class="keywordflow">if</span> (nullspBase.size() != 0) {</div>
<div class="line"><span class="lineno">  363</span>        MatNullSpace   nullsp;</div>
<div class="line"><span class="lineno">  364</span>        MatNullSpaceCreate (PETSC_COMM_WORLD, PETSC_FALSE, nullspBase.size(), &amp;nullspBase[0], &amp;nullsp);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>        PetscBool  isNull;</div>
<div class="line"><span class="lineno">  367</span>        MatNullSpaceTest (nullsp, (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>))-&gt;mat(), &amp;isNull);</div>
<div class="line"><span class="lineno">  368</span>        <span class="keywordflow">if</span> (!isNull) std::cout &lt;&lt; <span class="stringliteral">&quot;The null space created for KK is not correct!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>        MatSetNullSpace ( (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>))-&gt;mat(), nullsp);</div>
<div class="line"><span class="lineno">  371</span>        MatSetTransposeNullSpace ( (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>))-&gt;mat(), nullsp);</div>
<div class="line"><span class="lineno">  372</span>        MatNullSpaceDestroy (&amp;nullsp);</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nullspBase.size(); i++) {</div>
<div class="line"><span class="lineno">  375</span>          VecDestroy (&amp;nullspBase[i]);</div>
<div class="line"><span class="lineno">  376</span>        }</div>
<div class="line"><span class="lineno">  377</span>      }</div>
<div class="line"><span class="lineno">  378</span>    }</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a3d6585056575a152842422596e64a0f4"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a3d6585056575a152842422596e64a0f4">femus::LinearEquationSolverPetsc::GetNullSpaceBase</a></div><div class="ttdeci">void GetNullSpaceBase(std::vector&lt; Vec &gt; &amp;nullspBase)</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00384">LinearEquationSolverPetsc.cpp:384</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a43f59d053804f858ca075c8f5e39834c" name="a43f59d053804f858ca075c8f5e39834c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a43f59d053804f858ca075c8f5e39834c">&#9670;&#160;</a></span>set_preconditioner_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolver::set_preconditioner_type </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cf">PreconditionerType</a>&#160;</td>
          <td class="paramname"><em>pct</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets the type of preconditioner to use. </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html#l00084">84</a> of file <a class="el" href="../../d8/d4c/_linear_equation_solver_8cpp_source.html">LinearEquationSolver.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   85</span>  {</div>
<div class="line"><span class="lineno">   86</span>    <span class="keywordflow">if</span>(<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>)    <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>-&gt;<a class="code hl_function" href="../../d9/d80/classfemus_1_1_preconditioner.html#a36dfaa704ced285ca06790eecc539739">set_type</a>(pct);</div>
<div class="line"><span class="lineno">   87</span>    <span class="keywordflow">else</span>    <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a> = pct;</div>
<div class="line"><span class="lineno">   88</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_preconditioner_html_a36dfaa704ced285ca06790eecc539739"><div class="ttname"><a href="../../d9/d80/classfemus_1_1_preconditioner.html#a36dfaa704ced285ca06790eecc539739">femus::Preconditioner::set_type</a></div><div class="ttdeci">void set_type(const PreconditionerType pct)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/de4/_preconditioner_8hpp_source.html#l00122">Preconditioner.hpp:122</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8806dab2868fc1b793cb6607920bcd09" name="a8806dab2868fc1b793cb6607920bcd09"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8806dab2868fc1b793cb6607920bcd09">&#9670;&#160;</a></span>set_solver_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolver::set_solver_type </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a>&#160;</td>
          <td class="paramname"><em>st</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sets the type of solver to use. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00138">138</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  138</span>                                                  {</div>
<div class="line"><span class="lineno">  139</span>        <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a> = st;</div>
<div class="line"><span class="lineno">  140</span>      }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa54d0fc18a6ca183b89d038495a7f8f1" name="aa54d0fc18a6ca183b89d038495a7f8f1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa54d0fc18a6ca183b89d038495a7f8f1">&#9670;&#160;</a></span>SetElementBlockNumber() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void femus::LinearEquationSolver::SetElementBlockNumber </td>
          <td>(</td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>all</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>overlap</em> = <code>1</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#a049f92774047b53af5916439b49a6ec6">femus::LinearEquationSolverPetscAsm</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00240">240</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  240</span>                                                                                         {</div>
<div class="line"><span class="lineno">  241</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Warning SetElementBlockNumber(const char [], const unsigned &amp; ) is not available for this smoother\n&quot;</span>;</div>
<div class="line"><span class="lineno">  242</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="af467f11da786efe6d12b230a58b54eb7" name="af467f11da786efe6d12b230a58b54eb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af467f11da786efe6d12b230a58b54eb7">&#9670;&#160;</a></span>SetElementBlockNumber() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void femus::LinearEquationSolver::SetElementBlockNumber </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>block_elemet_number</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the number of elements of the Vanka Block </p>

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#a7572d7b1b1482977729f345c27011482">femus::LinearEquationSolverPetscAsm</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00225">225</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  225</span>                                                                               {</div>
<div class="line"><span class="lineno">  226</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Warning SetElementBlockNumber(const unsigned &amp;) is not available for this smoother\n&quot;</span>;</div>
<div class="line"><span class="lineno">  227</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a66952f3530ccf677bac20da7ef3b15e0" name="a66952f3530ccf677bac20da7ef3b15e0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66952f3530ccf677bac20da7ef3b15e0">&#9670;&#160;</a></span>SetElementBlockNumberFluid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void femus::LinearEquationSolver::SetElementBlockNumberFluid </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>block_elemet_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>overlap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#a47d24163aac6f5e7ec2a3b77e053de18">femus::LinearEquationSolverPetscAsm</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00228">228</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  228</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  229</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Warning SetElementBlockNumberFluid(const unsigned &amp;) is not available for this smoother\n&quot;</span>;</div>
<div class="line"><span class="lineno">  230</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7cfb02af590c30fe0437ee89aed2daf7" name="a7cfb02af590c30fe0437ee89aed2daf7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7cfb02af590c30fe0437ee89aed2daf7">&#9670;&#160;</a></span>SetElementBlockNumberPorous()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void femus::LinearEquationSolver::SetElementBlockNumberPorous </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>block_elemet_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>overlap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#ad2b233db0321558b2a49102a49a1d242">femus::LinearEquationSolverPetscAsm</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00234">234</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  234</span>                                                                                                              {</div>
<div class="line"><span class="lineno">  235</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Warning SetElementBlockNumberPorous(const unsigned &amp;) is not available for this smoother\n&quot;</span>;</div>
<div class="line"><span class="lineno">  236</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aad722059ff7cecc7de89a470c831351f" name="aad722059ff7cecc7de89a470c831351f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad722059ff7cecc7de89a470c831351f">&#9670;&#160;</a></span>SetElementBlockNumberSolid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void femus::LinearEquationSolver::SetElementBlockNumberSolid </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>block_elemet_number</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>overlap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#ae3b1890777548ee832f17d08df7fc99c">femus::LinearEquationSolverPetscAsm</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00231">231</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  231</span>                                                                                                             {</div>
<div class="line"><span class="lineno">  232</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Warning SetElementBlockNumberSolid(const unsigned &amp;) is not available for this smoother\n&quot;</span>;</div>
<div class="line"><span class="lineno">  233</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1beb93193b619ce9d6adae4977c2e993" name="a1beb93193b619ce9d6adae4977c2e993"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1beb93193b619ce9d6adae4977c2e993">&#9670;&#160;</a></span>SetEpsZero()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::SetEpsZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00361">361</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  361</span>                                  {</div>
<div class="line"><span class="lineno">  362</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  363</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  364</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a62683a501b58f6bbda90f7b1d15b1f5a" name="a62683a501b58f6bbda90f7b1d15b1f5a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62683a501b58f6bbda90f7b1d15b1f5a">&#9670;&#160;</a></span>SetFieldSplitTree()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void femus::LinearEquationSolver::SetFieldSplitTree </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d9/d1f/classfemus_1_1_field_split_tree.html">FieldSplitTree</a> *&#160;</td>
          <td class="paramname"><em>fieldSplitTree</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../dd/dfa/classfemus_1_1_linear_equation_solver_petsc_field_split.html#ae88d535702542dc4cd25c8c6138ac64e">femus::LinearEquationSolverPetscFieldSplit</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00254">254</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  254</span>                                                                      {</div>
<div class="line"><span class="lineno">  255</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;SetFieldSplitTree(const FieldSpliTreeStructure &amp; fieldSplitTree) is not available for this smoother\n&quot;</span>;</div>
<div class="line"><span class="lineno">  256</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa8807dc8b1f49964bf5fd86ea9404751" name="aa8807dc8b1f49964bf5fd86ea9404751"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8807dc8b1f49964bf5fd86ea9404751">&#9670;&#160;</a></span>SetNumberOfGlobalVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::SetNumberOfGlobalVariables </td>
          <td>(</td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>numberOfGlobalVariables</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00232">232</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  232</span>                                                                           {</div>
<div class="line"><span class="lineno">  233</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ad42d4d0d6a54f6df97afa82f4eec7a0c">_numberOfGlobalVariables</a> = numberOfGlobalVariables;</div>
<div class="line"><span class="lineno">  234</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a09c6e1700ba25b46e3195ea2f7a602c5" name="a09c6e1700ba25b46e3195ea2f7a602c5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a09c6e1700ba25b46e3195ea2f7a602c5">&#9670;&#160;</a></span>SetNumberOfSchurVariables()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual void femus::LinearEquationSolver::SetNumberOfSchurVariables </td>
          <td>(</td>
          <td class="paramtype">const unsigned short &amp;&#160;</td>
          <td class="paramname"><em>NSchurVar</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#a40287f11110151e160bb558b3f3b505d">femus::LinearEquationSolverPetscAsm</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00245">245</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  245</span>                                                                               {</div>
<div class="line"><span class="lineno">  246</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Warning SetNumberOfSchurVariables(const unsigned short &amp;) is not available for this smoother\n&quot;</span>;</div>
<div class="line"><span class="lineno">  247</span>      };</div>
</div><!-- fragment -->
</div>
</div>
<a id="aae35adda9653bd3682791e00539edefc" name="aae35adda9653bd3682791e00539edefc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aae35adda9653bd3682791e00539edefc">&#9670;&#160;</a></span>SetPenalty()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::SetPenalty </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00428">428</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  428</span>                                             {</div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span>    Mat <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = (<span class="keyword">static_cast&lt;</span> PetscMatrix* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>))-&gt;mat();</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>    MatSetOption (<a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>, MAT_NO_OFF_PROC_ZERO_ROWS, PETSC_TRUE);</div>
<div class="line"><span class="lineno">  433</span>    MatSetOption (<a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>, MAT_KEEP_NONZERO_PATTERN, PETSC_TRUE);</div>
<div class="line"><span class="lineno">  434</span>    MatZeroRows (<a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>.size(), &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>[0], 1., 0, 0);</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5dfc029bb5b3b20d9687b11c376cc473" name="a5dfc029bb5b3b20d9687b11c376cc473"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dfc029bb5b3b20d9687b11c376cc473">&#9670;&#160;</a></span>SetPetscSolverType()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::SetPetscSolverType </td>
          <td>(</td>
          <td class="paramtype">KSP &amp;&#160;</td>
          <td class="paramname"><em>ksp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> &amp;&#160;</td>
          <td class="paramname"><em>solver_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double *&#160;</td>
          <td class="paramname"><em>parameter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set PETSC solver. </p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00452">452</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  452</span>                                                                                                                      {</div>
<div class="line"><span class="lineno">  453</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">switch</span> (solverType) {</div>
<div class="line"><span class="lineno">  456</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecab675143c1d974b79ec45f725a4963d60">CG</a>:</div>
<div class="line"><span class="lineno">  457</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPCG);</div>
<div class="line"><span class="lineno">  458</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  459</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaaaa8401b50cb34e3a0d58729f70494f0">CR</a>:</div>
<div class="line"><span class="lineno">  462</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPCR);</div>
<div class="line"><span class="lineno">  463</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  464</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca673b92f2acd7a6bd49e2adc8d70d955a">CGS</a>:</div>
<div class="line"><span class="lineno">  467</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPCGS);</div>
<div class="line"><span class="lineno">  468</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  469</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  470</span> </div>
<div class="line"><span class="lineno">  471</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca2c62ef7f983fdf1e3cf97e38fbc07a6e">BICG</a>:</div>
<div class="line"><span class="lineno">  472</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPBICG);</div>
<div class="line"><span class="lineno">  473</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  474</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca8aca53bff94facf51838780695087016">TCQMR</a>:</div>
<div class="line"><span class="lineno">  477</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPTCQMR);</div>
<div class="line"><span class="lineno">  478</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  479</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaa87e8a17213051349bb0e344e4e61e16">TFQMR</a>:</div>
<div class="line"><span class="lineno">  482</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPTFQMR);</div>
<div class="line"><span class="lineno">  483</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  484</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecab1ed1f4829a16b07e4eed950d95e9d40">LSQR</a>:</div>
<div class="line"><span class="lineno">  487</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPLSQR);</div>
<div class="line"><span class="lineno">  488</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  489</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca35bb27443a5135dd245916d00ac921c0">BICGSTAB</a>:</div>
<div class="line"><span class="lineno">  492</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPBCGS);</div>
<div class="line"><span class="lineno">  493</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  494</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca3bf0b3bd6144ea534f4d7a460594e973">MINRES</a>:</div>
<div class="line"><span class="lineno">  497</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPMINRES);</div>
<div class="line"><span class="lineno">  498</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  499</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>:</div>
<div class="line"><span class="lineno">  502</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPGMRES);</div>
<div class="line"><span class="lineno">  503</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  504</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca299bb791a6ea0692682aaa703242e646">FGMRES</a>:</div>
<div class="line"><span class="lineno">  507</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPFGMRES);</div>
<div class="line"><span class="lineno">  508</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  509</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca5dfa6fafcc84dd81ce0d3b83a9cdda3e">LGMRES</a>:</div>
<div class="line"><span class="lineno">  512</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPLGMRES);</div>
<div class="line"><span class="lineno">  513</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  514</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  515</span> </div>
<div class="line"><span class="lineno">  516</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3">RICHARDSON</a>:</div>
<div class="line"><span class="lineno">  517</span>        KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPRICHARDSON);</div>
<div class="line"><span class="lineno">  518</span>        KSPRichardsonSetScale (ksp, parameter[0]);</div>
<div class="line"><span class="lineno">  519</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  520</span> </div>
<div class="line"><span class="lineno">  521</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca241782cb3a92e9643a4f60e8d9205b7b">CHEBYSHEV</a>:</div>
<div class="line"><span class="lineno">  522</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPCHEBYSHEV);</div>
<div class="line"><span class="lineno">  523</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  524</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>:</div>
<div class="line"><span class="lineno">  527</span>        ierr = KSPSetType (ksp, (<span class="keywordtype">char</span>*) KSPPREONLY);</div>
<div class="line"><span class="lineno">  528</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">  532</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;ERROR:  Unsupported PETSC Solver: &quot;</span></div>
<div class="line"><span class="lineno">  533</span>                  &lt;&lt; solverType                       &lt;&lt; std::endl</div>
<div class="line"><span class="lineno">  534</span>                  &lt;&lt; <span class="stringliteral">&quot;Continuing with PETSC defaults&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  535</span>    }</div>
<div class="line"><span class="lineno">  536</span>  }</div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca241782cb3a92e9643a4f60e8d9205b7b"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca241782cb3a92e9643a4f60e8d9205b7b">CHEBYSHEV</a></div><div class="ttdeci">@ CHEBYSHEV</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00024">SolvertypeEnum.hpp:24</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca299bb791a6ea0692682aaa703242e646"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca299bb791a6ea0692682aaa703242e646">FGMRES</a></div><div class="ttdeci">@ FGMRES</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00015">SolvertypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca2c62ef7f983fdf1e3cf97e38fbc07a6e"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca2c62ef7f983fdf1e3cf97e38fbc07a6e">BICG</a></div><div class="ttdeci">@ BICG</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00012">SolvertypeEnum.hpp:12</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca35bb27443a5135dd245916d00ac921c0"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca35bb27443a5135dd245916d00ac921c0">BICGSTAB</a></div><div class="ttdeci">@ BICGSTAB</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00013">SolvertypeEnum.hpp:13</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca3bf0b3bd6144ea534f4d7a460594e973"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca3bf0b3bd6144ea534f4d7a460594e973">MINRES</a></div><div class="ttdeci">@ MINRES</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00014">SolvertypeEnum.hpp:14</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca5dfa6fafcc84dd81ce0d3b83a9cdda3e"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca5dfa6fafcc84dd81ce0d3b83a9cdda3e">LGMRES</a></div><div class="ttdeci">@ LGMRES</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00017">SolvertypeEnum.hpp:17</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca673b92f2acd7a6bd49e2adc8d70d955a"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca673b92f2acd7a6bd49e2adc8d70d955a">CGS</a></div><div class="ttdeci">@ CGS</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00007">SolvertypeEnum.hpp:7</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca8aca53bff94facf51838780695087016"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca8aca53bff94facf51838780695087016">TCQMR</a></div><div class="ttdeci">@ TCQMR</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00010">SolvertypeEnum.hpp:10</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecaa87e8a17213051349bb0e344e4e61e16"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaa87e8a17213051349bb0e344e4e61e16">TFQMR</a></div><div class="ttdeci">@ TFQMR</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00011">SolvertypeEnum.hpp:11</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecaaaa8401b50cb34e3a0d58729f70494f0"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaaaa8401b50cb34e3a0d58729f70494f0">CR</a></div><div class="ttdeci">@ CR</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00008">SolvertypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecab1ed1f4829a16b07e4eed950d95e9d40"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecab1ed1f4829a16b07e4eed950d95e9d40">LSQR</a></div><div class="ttdeci">@ LSQR</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00018">SolvertypeEnum.hpp:18</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecab675143c1d974b79ec45f725a4963d60"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecab675143c1d974b79ec45f725a4963d60">CG</a></div><div class="ttdeci">@ CG</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00005">SolvertypeEnum.hpp:5</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a716f7336380f1a4093d3c5657284fde7" name="a716f7336380f1a4093d3c5657284fde7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a716f7336380f1a4093d3c5657284fde7">&#9670;&#160;</a></span>SetPreconditioner()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::SetPreconditioner </td>
          <td>(</td>
          <td class="paramtype">KSP &amp;&#160;</td>
          <td class="paramname"><em>subksp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">PC &amp;&#160;</td>
          <td class="paramname"><em>subpc</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented in <a class="el" href="../../de/d5a/classfemus_1_1_linear_equation_solver_petsc_asm.html#af22ad8b70db248c5e0f95d69a451352b">femus::LinearEquationSolverPetscAsm</a>, and <a class="el" href="../../dd/dfa/classfemus_1_1_linear_equation_solver_petsc_field_split.html#a5996bf921bbb15bd538e4d7e7f713e0e">femus::LinearEquationSolverPetscFieldSplit</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00440">440</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  440</span>                                                                           {</div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>    <span class="keywordtype">int</span> parallelOverlapping = 0;</div>
<div class="line"><span class="lineno">  443</span>    <a class="code hl_function" href="../../d4/d01/classfemus_1_1_petsc_preconditioner.html#ae8e037e88852e97c0efd625f2764dcf5">PetscPreconditioner::set_petsc_preconditioner_type</a> (this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#aeb95e2f8a6a1c23b54278252f4f418ad">_preconditioner_type</a>, subpc, parallelOverlapping);</div>
<div class="line"><span class="lineno">  444</span>    PetscReal zero = 1.e-16;</div>
<div class="line"><span class="lineno">  445</span>    PCFactorSetZeroPivot (subpc, zero);</div>
<div class="line"><span class="lineno">  446</span>    PCFactorSetShiftType (subpc, MAT_SHIFT_NONZERO);</div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaa2b64c70fa22d84a2d2aeb7aba62bf3" name="aaa2b64c70fa22d84a2d2aeb7aba62bf3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaa2b64c70fa22d84a2d2aeb7aba62bf3">&#9670;&#160;</a></span>SetPrintSolverInfo()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolver::SetPrintSolverInfo </td>
          <td>(</td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>printInfo</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00097">97</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   97</span>                                                      {</div>
<div class="line"><span class="lineno">   98</span>        <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a7058888fb57ea520cce21647a69db329">_printSolverInfo</a> = printInfo;</div>
<div class="line"><span class="lineno">   99</span>      }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a81de0961933510a8e2e035be1cfb4730" name="a81de0961933510a8e2e035be1cfb4730"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a81de0961933510a8e2e035be1cfb4730">&#9670;&#160;</a></span>SetResZero()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::SetResZero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00356">356</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  356</span>                                  {</div>
<div class="line"><span class="lineno">  357</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  358</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad29078ec2004ac2de5f6ee9c8d2eab78" name="ad29078ec2004ac2de5f6ee9c8d2eab78"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad29078ec2004ac2de5f6ee9c8d2eab78">&#9670;&#160;</a></span>SetRichardsonScaleFactor()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::SetRichardsonScaleFactor </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>richardsonScaleFactor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a89e130ac674f653d568900238c9f1395">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00077">77</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   77</span>                                                                           {</div>
<div class="line"><span class="lineno">   78</span>        <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a> = richardsonScaleFactor;</div>
<div class="line"><span class="lineno">   79</span>      }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a411eac388d69b468ca820cf252c06dad" name="a411eac388d69b468ca820cf252c06dad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a411eac388d69b468ca820cf252c06dad">&#9670;&#160;</a></span>SetSolver()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::SetSolver </td>
          <td>(</td>
          <td class="paramtype">KSP &amp;&#160;</td>
          <td class="paramname"><em>ksp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> &amp;&#160;</td>
          <td class="paramname"><em>solver_type</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00094">94</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>                                                               {</div>
<div class="line"><span class="lineno">   95</span>        <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a5dfc029bb5b3b20d9687b11c376cc473">SetPetscSolverType</a> (ksp, <a class="code hl_function" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a324c2db823c76cbafd00a94e04c99aad">solver_type</a> , &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a853956e789f4855a80e2f96359ba0b60">_richardsonScaleFactor</a>);</div>
<div class="line"><span class="lineno">   96</span>      };</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_a324c2db823c76cbafd00a94e04c99aad"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a324c2db823c76cbafd00a94e04c99aad">femus::LinearEquationSolver::solver_type</a></div><div class="ttdeci">SolverType solver_type() const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00143">LinearEquationSolver.hpp:143</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a5dfc029bb5b3b20d9687b11c376cc473"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a5dfc029bb5b3b20d9687b11c376cc473">femus::LinearEquationSolverPetsc::SetPetscSolverType</a></div><div class="ttdeci">static void SetPetscSolverType(KSP &amp;ksp, const SolverType &amp;solver_type, const double *parameter)</div><div class="ttdoc">Set PETSC solver.</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00452">LinearEquationSolverPetsc.cpp:452</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a84e6b95a07737bc62ce4aff323c83ae8" name="a84e6b95a07737bc62ce4aff323c83ae8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a84e6b95a07737bc62ce4aff323c83ae8">&#9670;&#160;</a></span>SetSparsityPatternMinimumSize()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::SetSparsityPatternMinimumSize </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>minimumSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>variableIndex</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00344">344</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  344</span>                                                                                                                                          {</div>
<div class="line"><span class="lineno">  345</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ada4422410129b056d30d9bec6373398a">_sparsityPatternMinimumSize</a> = minimumSize;</div>
<div class="line"><span class="lineno">  346</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae8585849c6da7f7415bc2939e86476f2">_sparsityPatternVariableIndex</a> = variableIndex;</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a08129728358297604c33b670372e1e5c" name="a08129728358297604c33b670372e1e5c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08129728358297604c33b670372e1e5c">&#9670;&#160;</a></span>SetTolerances()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::SetTolerances </td>
          <td>(</td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>rtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>atol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>divtol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>maxits</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>restart</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Set the tolerance for the solver </p>

<p>Implements <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a84b5077395317b5e7201652a68aecb94">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00042">42</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>                                                                                                       {</div>
<div class="line"><span class="lineno">   44</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a12be6e63b0980ad661ac0b5f1db07677">_rtol</a>    = <span class="keyword">static_cast&lt;</span>PetscReal<span class="keyword">&gt;</span> (rtol);</div>
<div class="line"><span class="lineno">   45</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acc02d3a5864f2c8534190b109fdcf0a1">_abstol</a>  = <span class="keyword">static_cast&lt;</span>PetscReal<span class="keyword">&gt;</span> (atol);</div>
<div class="line"><span class="lineno">   46</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a099f48f80b5eca34c976a932bcac5243">_dtol</a>    = <span class="keyword">static_cast&lt;</span>PetscReal<span class="keyword">&gt;</span> (divtol);</div>
<div class="line"><span class="lineno">   47</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a2da36631345b3bf33696f6c8f5882dc4">_maxits</a>  = <span class="keyword">static_cast&lt;</span>PetscInt<span class="keyword">&gt;</span> (maxits);</div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a595c4b08e58212f1d93c1518e51bdb43">_restart</a> = <span class="keyword">static_cast&lt;</span>PetscInt<span class="keyword">&gt;</span> (restart);</div>
<div class="line"><span class="lineno">   49</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6dbbb65cbcf869df47bc73ebb19689ba" name="a6dbbb65cbcf869df47bc73ebb19689ba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6dbbb65cbcf869df47bc73ebb19689ba">&#9670;&#160;</a></span>Solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::Solve </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>VariableTobeSolved</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>ksp_clean</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Call the smoother-solver using the PetscLibrary. </p>

<p>Implements <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a58a6c9031c240dc61861ccae245d5b4b">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00094">94</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   94</span>                                                                                                                 {</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>    PetscLogDouble t1;</div>
<div class="line"><span class="lineno">   97</span>    PetscTime (&amp;t1);</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ab048018b0a8274ee43ae0b59977f591b">_bdcIndexIsInitialized</a> == 0) <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ad64712ae2d655fc49c58814f7411c334">BuildBdcIndex</a> (variable_to_be_solved);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <span class="comment">//BEGIN ASSEMBLE matrix with Dirichlet penalty BCs by penalty</span></div>
<div class="line"><span class="lineno">  102</span>    Mat <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = (<span class="keyword">static_cast&lt;</span>PetscMatrix*<span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>))-&gt;mat();</div>
<div class="line"><span class="lineno">  103</span>    <span class="keywordflow">if</span> (ksp_clean) {</div>
<div class="line"><span class="lineno">  104</span>      this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#acb9a9f48db723e8a4700b1e78dbe93c8">Clear</a>();</div>
<div class="line"><span class="lineno">  105</span>      <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aae35adda9653bd3682791e00539edefc">SetPenalty</a>();</div>
<div class="line"><span class="lineno">  106</span>      <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#affda1228209a0acafbbaa4e179d4d516">RemoveNullSpace</a>();</div>
<div class="line"><span class="lineno">  107</span>      this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a13cb95513c710a4445ae179e981663d1">Init</a> (KK, <a class="code hl_enumvalue" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>);</div>
<div class="line"><span class="lineno">  108</span>    }</div>
<div class="line"><span class="lineno">  109</span>    <span class="comment">//END ASSEMBLE</span></div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span><span class="comment">//     PetscViewer    viewer;</span></div>
<div class="line"><span class="lineno">  112</span><span class="comment">//     PetscViewerDrawOpen(PETSC_COMM_WORLD,NULL,NULL,0,0,900,900,&amp;viewer);</span></div>
<div class="line"><span class="lineno">  113</span><span class="comment">//     PetscObjectSetName((PetscObject)viewer,&quot;FSI matrix&quot;);</span></div>
<div class="line"><span class="lineno">  114</span><span class="comment">//     PetscViewerPushFormat(viewer,PETSC_VIEWER_DRAW_LG);</span></div>
<div class="line"><span class="lineno">  115</span><span class="comment">//     MatView(KK,viewer);</span></div>
<div class="line"><span class="lineno">  116</span><span class="comment">//     double a;</span></div>
<div class="line"><span class="lineno">  117</span><span class="comment">//     std::cin&gt;&gt;a;</span></div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    <span class="comment">//BEGIN SOLVE and UPDATE</span></div>
<div class="line"><span class="lineno">  121</span>    <a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#aba7244a1ff374a9a2099d1109d97f28f">ZerosBoundaryResiduals</a>();</div>
<div class="line"><span class="lineno">  122</span>    KSPSolve (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>))-&gt;vec(), (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>))-&gt;vec());</div>
<div class="line"><span class="lineno">  123</span>    *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a> += *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>;</div>
<div class="line"><span class="lineno">  124</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abc7a62c82d215dcc9e6b42f7bb4ee8eb">matrix_mult</a> (*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>, *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>);</div>
<div class="line"><span class="lineno">  125</span>    *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a> -= *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>;</div>
<div class="line"><span class="lineno">  126</span>    <span class="comment">//END SOLVE and UPDATE</span></div>
<div class="line"><span class="lineno">  127</span> </div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">//BEGIN PRINT Computational info</span></div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a7058888fb57ea520cce21647a69db329">_printSolverInfo</a>) {</div>
<div class="line"><span class="lineno">  130</span>      <span class="keywordtype">int</span> its;</div>
<div class="line"><span class="lineno">  131</span>      KSPGetIterationNumber (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;its);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>      KSPConvergedReason reason;</div>
<div class="line"><span class="lineno">  134</span>      KSPGetConvergedReason (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;reason);</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>      PetscReal rnorm;</div>
<div class="line"><span class="lineno">  137</span>      KSPGetResidualNorm (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;rnorm);</div>
<div class="line"><span class="lineno">  138</span> </div>
<div class="line"><span class="lineno">  139</span>      PetscLogDouble t2;</div>
<div class="line"><span class="lineno">  140</span>      PetscTime (&amp;t2);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;        *************** ML linear solver time: %e \n&quot;</span>, t2 - t1);</div>
<div class="line"><span class="lineno">  143</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;        *************** Number of outer ksp solver iterations = %i \n&quot;</span>, its);</div>
<div class="line"><span class="lineno">  144</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;        *************** Convergence reason = %i \n&quot;</span>, reason);</div>
<div class="line"><span class="lineno">  145</span>      PetscPrintf (PETSC_COMM_WORLD, <span class="stringliteral">&quot;        *************** Residual norm = %10.8g \n&quot;</span>, rnorm);</div>
<div class="line"><span class="lineno">  146</span>    }</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>    <span class="comment">//END PRINT</span></div>
<div class="line"><span class="lineno">  149</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_a13cb95513c710a4445ae179e981663d1"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a13cb95513c710a4445ae179e981663d1">femus::LinearEquationSolverPetsc::Init</a></div><div class="ttdeci">void Init(Mat &amp;Amat, Mat &amp;Pmat)</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00153">LinearEquationSolverPetsc.cpp:153</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef570270d97edc107a2957ea99a49398" name="aef570270d97edc107a2957ea99a49398"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef570270d97edc107a2957ea99a49398">&#9670;&#160;</a></span>solve()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::pair&lt; unsigned int, double &gt; femus::LinearEquationSolverPetsc::solve </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>matrix_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>precond_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>solution_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>tol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>m_its</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="deprecated"><dt><b><a class="el" href="../../da/d58/deprecated.html#_deprecated000013">Deprecated:</a></b></dt><dd>, remove soon </dd></dl>
<dl class="deprecated"><dt><b><a class="el" href="../../da/d58/deprecated.html#_deprecated000012">Deprecated:</a></b></dt><dd>, remove soon </dd></dl>

<p>Reimplemented from <a class="el" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a341ba35213d18b7e0730b2bdaa908467">femus::LinearEquationSolver</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00543">543</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  545</span>                                                                                                                       {</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span><span class="comment">//   START_LOG(&quot;solve()&quot;, &quot;PetscLinearSolverM&quot;);</span></div>
<div class="line"><span class="lineno">  548</span>    <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><span class="lineno">  549</span>    PetscMatrix* <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a>   = femus::cast_ptr&lt;PetscMatrix*&gt; (&amp;matrix_in);</div>
<div class="line"><span class="lineno">  550</span>    PetscMatrix* precond  = femus::cast_ptr&lt;PetscMatrix*&gt; (&amp;precond_in);</div>
<div class="line"><span class="lineno">  551</span>    PetscVector* solution = femus::cast_ptr&lt;PetscVector*&gt; (&amp;solution_in);</div>
<div class="line"><span class="lineno">  552</span>    PetscVector* rhs      = femus::cast_ptr&lt;PetscVector*&gt; (&amp;rhs_in);</div>
<div class="line"><span class="lineno">  553</span>    this-&gt;<a class="code hl_function" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#afbc6834611d0a447a5fa3e2c7f7ffabf">init</a> (matrix);</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordtype">int</span> its = 0, max_its = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (m_its);</div>
<div class="line"><span class="lineno">  557</span>    PetscReal final_resid = 0.;</div>
<div class="line"><span class="lineno">  558</span>    <span class="comment">// Close the matrices and vectors in case this wasn&#39;t already done.</span></div>
<div class="line"><span class="lineno">  559</span>    <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a>-&gt;close();</div>
<div class="line"><span class="lineno">  560</span>    precond-&gt;close();</div>
<div class="line"><span class="lineno">  561</span>    solution-&gt;close();</div>
<div class="line"><span class="lineno">  562</span>    rhs-&gt;close();</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span><span class="comment">//   // If matrix != precond, then this means we have specified a</span></div>
<div class="line"><span class="lineno">  565</span><span class="comment">//   // special preconditioner, so reset preconditioner type to PCMAT.</span></div>
<div class="line"><span class="lineno">  566</span><span class="comment">//   if (matrix != precond)</span></div>
<div class="line"><span class="lineno">  567</span><span class="comment">//     {</span></div>
<div class="line"><span class="lineno">  568</span><span class="comment">//       this-&gt;_preconditioner_type = USER_PRECOND;</span></div>
<div class="line"><span class="lineno">  569</span><span class="comment">//       this-&gt;set_petsc_preconditioner_type ();</span></div>
<div class="line"><span class="lineno">  570</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>) this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ae7d568d4a992a82d1b06903cb7e384fb">_preconditioner</a>-&gt;<a class="code hl_function" href="../../d9/d80/classfemus_1_1_preconditioner.html#a1bc0544da19e5de757d83ae2e4fb90de">set_matrix</a> (matrix_in);</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>    <span class="comment">// 2.2.1 &amp; newer style</span></div>
<div class="line"><span class="lineno">  574</span>    <span class="comment">// Set operators. The input matrix works as the preconditioning matrix</span></div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">if</span> (!this-&gt;<a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a0a3207fb3cca0f45b8909812f64f6efa">same_preconditioner</a>)  {</div>
<div class="line"><span class="lineno">  576</span>      <span class="comment">//ierr = KSPSetOperators(_ksp, matrix-&gt;mat(), precond-&gt;mat(),SAME_NONZERO_PATTERN);</span></div>
<div class="line"><span class="lineno">  577</span>      ierr = KSPSetOperators (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a>-&gt;mat(), precond-&gt;mat());   <span class="comment">//PETSC3p5</span></div>
<div class="line"><span class="lineno">  578</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  579</span>    }</div>
<div class="line"><span class="lineno">  580</span>    <span class="keywordflow">else</span>  {</div>
<div class="line"><span class="lineno">  581</span>      <span class="comment">//ierr = KSPSetOperators(_ksp, matrix-&gt;mat(), precond-&gt;mat(),SAME_PRECONDITIONER);</span></div>
<div class="line"><span class="lineno">  582</span>      ierr = KSPSetOperators (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#af439574c0feeeae882d3b65a7b2e88bf">matrix</a>-&gt;mat(), precond-&gt;mat());   <span class="comment">//PETSC3p5</span></div>
<div class="line"><span class="lineno">  583</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  584</span>    }</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    <span class="comment">// Set the tolerances for the iterative solver.  Use the user-supplied</span></div>
<div class="line"><span class="lineno">  587</span>    <span class="comment">// tolerance for the relative residual &amp; leave the others at default values.</span></div>
<div class="line"><span class="lineno">  588</span>    ierr = KSPSetTolerances (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, tol, PETSC_DEFAULT, PETSC_DEFAULT, max_its);</div>
<div class="line"><span class="lineno">  589</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  590</span>    <span class="comment">// Solve the linear system</span></div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span><span class="comment">//        PetscLogEvent USER_EVENT;</span></div>
<div class="line"><span class="lineno">  593</span><span class="comment">//      PetscLogDouble user_event_flops;</span></div>
<div class="line"><span class="lineno">  594</span><span class="comment">//      PetscLogEventRegister(&quot;User event&quot;,0,&amp;USER_EVENT);</span></div>
<div class="line"><span class="lineno">  595</span><span class="comment">//      PetscLogEventBegin(USER_EVENT,0,0,0,0);</span></div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>    ierr = KSPSolve (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, rhs-&gt;vec(), solution-&gt;vec());</div>
<div class="line"><span class="lineno">  599</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  600</span><span class="comment">//         PetscLogFlops(user_event_flops);</span></div>
<div class="line"><span class="lineno">  601</span><span class="comment">//      PetscLogEventEnd(USER_EVENT,0,0,0,0);</span></div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>    <span class="comment">// Get the number of iterations required for convergence</span></div>
<div class="line"><span class="lineno">  604</span>    ierr = KSPGetIterationNumber (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;its);</div>
<div class="line"><span class="lineno">  605</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  606</span>    <span class="comment">// Get the norm of the final residual to return to the user.</span></div>
<div class="line"><span class="lineno">  607</span>    ierr = KSPGetResidualNorm (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#ac5bf225db84f5c6f1fd81e927f7c61b1">_ksp</a>, &amp;final_resid);</div>
<div class="line"><span class="lineno">  608</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span><span class="comment">//   STOP_LOG(&quot;solve()&quot;, &quot;PetscLinearSolverM&quot;);</span></div>
<div class="line"><span class="lineno">  611</span>    <span class="keywordflow">return</span> std::make_pair (its, final_resid);</div>
<div class="line"><span class="lineno">  612</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html_a0a3207fb3cca0f45b8909812f64f6efa"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#a0a3207fb3cca0f45b8909812f64f6efa">femus::LinearEquationSolver::same_preconditioner</a></div><div class="ttdeci">bool same_preconditioner</div><div class="ttdoc">Boolean flag to indicate whether we want to use an identical preconditioner to the previous solve.</div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00208">LinearEquationSolver.hpp:208</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_petsc_html_afbc6834611d0a447a5fa3e2c7f7ffabf"><div class="ttname"><a href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#afbc6834611d0a447a5fa3e2c7f7ffabf">femus::LinearEquationSolverPetsc::init</a></div><div class="ttdeci">void init(SparseMatrix *matrix)</div><div class="ttdef"><b>Definition</b> <a href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00640">LinearEquationSolverPetsc.cpp:640</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a324c2db823c76cbafd00a94e04c99aad" name="a324c2db823c76cbafd00a94e04c99aad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a324c2db823c76cbafd00a94e04c99aad">&#9670;&#160;</a></span>solver_type()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> femus::LinearEquationSolver::solver_type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the type of solver to use. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00143">143</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  143</span>                                     {</div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html#ab379639fae0d6cf1783d1ffa6a1f6a0a">_levelSolverType</a>;</div>
<div class="line"><span class="lineno">  145</span>      }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a68c86878db3eacf62e0fef5ee907470a" name="a68c86878db3eacf62e0fef5ee907470a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68c86878db3eacf62e0fef5ee907470a">&#9670;&#160;</a></span>sparsity_pattern_print_nonzeros()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::sparsity_pattern_print_nonzeros </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>filename_base</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>on_or_off</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Sparsity pattern: print number of nonzeros per row </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00165">165</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  165</span>                                                                                                               {</div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>         </div>
<div class="line"><span class="lineno">  168</span>      <span class="keywordflow">if</span> (on_or_off != <span class="stringliteral">&quot;on&quot;</span> &amp;&amp; on_or_off != <span class="stringliteral">&quot;off&quot;</span>)</div>
<div class="line"><span class="lineno">  169</span>      { std::cout &lt;&lt; <span class="stringliteral">&quot;Must be either on or off diagonal&quot;</span> &lt;&lt; std::endl; abort(); }     </div>
<div class="line"><span class="lineno">  170</span>          </div>
<div class="line"><span class="lineno">  171</span>   std::string <a class="code hl_variable" href="../../da/da1/namespacebuild__edges__of__volumes.html#a8b9aa5b5b104ffacbc115e9ba3c22e6a">filename</a> =  filename_base + on_or_off + <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><span class="lineno">  172</span>      std::ofstream file_pr;</div>
<div class="line"><span class="lineno">  173</span>      file_pr.open (filename);</div>
<div class="line"><span class="lineno">  174</span>      </div>
<div class="line"><span class="lineno">  175</span>         std::vector&lt;int&gt; * nonzeros; </div>
<div class="line"><span class="lineno">  176</span>      <span class="keywordflow">if</span> (on_or_off == <span class="stringliteral">&quot;on&quot;</span>) {</div>
<div class="line"><span class="lineno">  177</span>          nonzeros = &amp;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a62a2a1ed0ecb5758eedb242fa5fdd461">d_nnz</a>;</div>
<div class="line"><span class="lineno">  178</span>      }</div>
<div class="line"><span class="lineno">  179</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (on_or_off == <span class="stringliteral">&quot;off&quot;</span>) {</div>
<div class="line"><span class="lineno">  180</span>          nonzeros = &amp;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a4613cf9a418f8a61220a705e30843ade">o_nnz</a>;</div>
<div class="line"><span class="lineno">  181</span>      }</div>
<div class="line"><span class="lineno">  182</span>      </div>
<div class="line"><span class="lineno">  183</span>      </div>
<div class="line"><span class="lineno">  184</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nonzeros-&gt;size(); <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  185</span>                  file_pr &lt;&lt; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt;&lt; <span class="stringliteral">&quot; &quot;</span> &lt;&lt; (*nonzeros)[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  186</span>                }</div>
<div class="line"><span class="lineno">  187</span>                </div>
<div class="line"><span class="lineno">  188</span>      </div>
<div class="line"><span class="lineno">  189</span>   file_pr.close();          </div>
<div class="line"><span class="lineno">  190</span>  </div>
<div class="line"><span class="lineno">  191</span>  </div>
<div class="line"><span class="lineno">  192</span>  }</div>
<div class="ttc" id="anamespacebuild__edges__of__volumes_html_a8b9aa5b5b104ffacbc115e9ba3c22e6a"><div class="ttname"><a href="../../da/da1/namespacebuild__edges__of__volumes.html#a8b9aa5b5b104ffacbc115e9ba3c22e6a">build_edges_of_volumes.filename</a></div><div class="ttdeci">filename</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dce/build__edges__of__volumes_8py_source.html#l00009">build_edges_of_volumes.py:9</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab6c32f709a8f531e108109faaf440fef" name="ab6c32f709a8f531e108109faaf440fef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab6c32f709a8f531e108109faaf440fef">&#9670;&#160;</a></span>SumEpsCToEps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::SumEpsCToEps </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00367">367</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  367</span>                                    {</div>
<div class="line"><span class="lineno">  368</span>    *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a> += *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>;</div>
<div class="line"><span class="lineno">  369</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3aa325f74068742d2c4b235ee6578e69" name="a3aa325f74068742d2c4b235ee6578e69"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3aa325f74068742d2c4b235ee6578e69">&#9670;&#160;</a></span>SwapMatrices()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::SwapMatrices </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00142">142</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  142</span>                      {</div>
<div class="line"><span class="lineno">  143</span>    SparseMatrix *Temp = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><span class="lineno">  144</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a> = <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">_KKamr</a>;</div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ab824eb4b9859c3dff871f537d702d987">_KKamr</a> = Temp;</div>
<div class="line"><span class="lineno">  146</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="adeac6aca70228a86f274b8589d464207" name="adeac6aca70228a86f274b8589d464207"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adeac6aca70228a86f274b8589d464207">&#9670;&#160;</a></span>UpdateResidual()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquation::UpdateResidual </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>To be Added </p>

<p class="definition">Definition at line <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html#l00372">372</a> of file <a class="el" href="../../d6/d77/_linear_equation_8cpp_source.html">LinearEquation.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  372</span>                                      {</div>
<div class="line"><span class="lineno">  373</span>    <a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abc7a62c82d215dcc9e6b42f7bb4ee8eb">matrix_mult</a>(*<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a5248622081d9f5559ae84074d6fb4f30">_EPSC</a>, *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>);</div>
<div class="line"><span class="lineno">  374</span>    *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a> -= *<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a22675b9d542dc58b67f4d2cba10a4c0d">_RESC</a>;</div>
<div class="line"><span class="lineno">  375</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aba7244a1ff374a9a2099d1109d97f28f" name="aba7244a1ff374a9a2099d1109d97f28f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aba7244a1ff374a9a2099d1109d97f28f">&#9670;&#160;</a></span>ZerosBoundaryResiduals()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::LinearEquationSolverPetsc::ZerosBoundaryResiduals </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html#l00417">417</a> of file <a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  417</span>                                                         {</div>
<div class="line"><span class="lineno">  418</span>    std::vector&lt; PetscScalar &gt; value (<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>.size(), 0.);</div>
<div class="line"><span class="lineno">  419</span>    Vec RES = (<span class="keyword">static_cast&lt;</span> PetscVector* <span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>))-&gt;vec();</div>
<div class="line"><span class="lineno">  420</span>    VecSetValues (RES, <a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>.size(), &amp;<a class="code hl_variable" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html#a14805f7b09557f9cf35a73a72e3c82d1">_bdcIndex</a>[0], &amp;value[0],  INSERT_VALUES);</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span>    VecAssemblyBegin (RES);</div>
<div class="line"><span class="lineno">  423</span>    VecAssemblyEnd (RES);</div>
<div class="line"><span class="lineno">  424</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="acc02d3a5864f2c8534190b109fdcf0a1" name="acc02d3a5864f2c8534190b109fdcf0a1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acc02d3a5864f2c8534190b109fdcf0a1">&#9670;&#160;</a></span>_abstol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscReal femus::LinearEquationSolverPetsc::_abstol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00114">114</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="afa321f16b5b88902150fddb437a1745b" name="afa321f16b5b88902150fddb437a1745b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afa321f16b5b88902150fddb437a1745b">&#9670;&#160;</a></span>_Bdc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt;<a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>*&gt;* femus::LinearEquation::_Bdc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size: number of Solutions </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00268">268</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a14805f7b09557f9cf35a73a72e3c82d1" name="a14805f7b09557f9cf35a73a72e3c82d1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a14805f7b09557f9cf35a73a72e3c82d1">&#9670;&#160;</a></span>_bdcIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;PetscInt&gt; femus::LinearEquationSolverPetsc::_bdcIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00119">119</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="ab048018b0a8274ee43ae0b59977f591b" name="ab048018b0a8274ee43ae0b59977f591b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab048018b0a8274ee43ae0b59977f591b">&#9670;&#160;</a></span>_bdcIndexIsInitialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::LinearEquationSolverPetsc::_bdcIndexIsInitialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00120">120</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="a099f48f80b5eca34c976a932bcac5243" name="a099f48f80b5eca34c976a932bcac5243"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a099f48f80b5eca34c976a932bcac5243">&#9670;&#160;</a></span>_dtol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscReal femus::LinearEquationSolverPetsc::_dtol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00115">115</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="a7f79930715e7e6c8b0ec81ee506a4ef0" name="a7f79930715e7e6c8b0ec81ee506a4ef0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f79930715e7e6c8b0ec81ee506a4ef0">&#9670;&#160;</a></span>_EPS</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* femus::LinearEquation::_EPS</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vectors for error <br  />
 </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00217">217</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a5248622081d9f5559ae84074d6fb4f30" name="a5248622081d9f5559ae84074d6fb4f30"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5248622081d9f5559ae84074d6fb4f30">&#9670;&#160;</a></span>_EPSC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> * femus::LinearEquation::_EPSC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00217">217</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a9e44f8c783de0cfd5dae745305882f21" name="a9e44f8c783de0cfd5dae745305882f21"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9e44f8c783de0cfd5dae745305882f21">&#9670;&#160;</a></span>_gridn</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned femus::LinearEquation::_gridn</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>number of levels </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00082">82</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a15b46748a2e26bc263e3e6e4690e8a3b" name="a15b46748a2e26bc263e3e6e4690e8a3b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a15b46748a2e26bc263e3e6e4690e8a3b">&#9670;&#160;</a></span>_iproc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::ParallelObject::_iproc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html#l00061">61</a> of file <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html">ParallelObject.hpp</a>.</p>

</div>
</div>
<a id="a17783185d47a441d545cf1427d2624ee" name="a17783185d47a441d545cf1427d2624ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17783185d47a441d545cf1427d2624ee">&#9670;&#160;</a></span>_is_initialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::LinearEquationSolver::_is_initialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag indicating if the data structures have been initialized. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00088">88</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>

</div>
</div>
<a id="aa10eb0eb318cf0d449f5ecdcec2823bc" name="aa10eb0eb318cf0d449f5ecdcec2823bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa10eb0eb318cf0d449f5ecdcec2823bc">&#9670;&#160;</a></span>_KK</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a>* femus::LinearEquation::_KK</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Matrix </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00149">149</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="ab824eb4b9859c3dff871f537d702d987" name="ab824eb4b9859c3dff871f537d702d987"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab824eb4b9859c3dff871f537d702d987">&#9670;&#160;</a></span>_KKamr</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a>* femus::LinearEquation::_KKamr</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>AMR Matrix </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00152">152</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="ac5bf225db84f5c6f1fd81e927f7c61b1" name="ac5bf225db84f5c6f1fd81e927f7c61b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac5bf225db84f5c6f1fd81e927f7c61b1">&#9670;&#160;</a></span>_ksp</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">KSP femus::LinearEquationSolverPetsc::_ksp</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Krylov subspace context. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00110">110</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="ab379639fae0d6cf1783d1ffa6a1f6a0a" name="ab379639fae0d6cf1783d1ffa6a1f6a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab379639fae0d6cf1783d1ffa6a1f6a0a">&#9670;&#160;</a></span>_levelSolverType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> femus::LinearEquationSolver::_levelSolverType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enum stating which type of iterative solver to use. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00150">150</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>

</div>
</div>
<a id="a2da36631345b3bf33696f6c8f5882dc4" name="a2da36631345b3bf33696f6c8f5882dc4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2da36631345b3bf33696f6c8f5882dc4">&#9670;&#160;</a></span>_maxits</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt femus::LinearEquationSolverPetsc::_maxits</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00116">116</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="a610f329a44512e94e0794c2e85bca1ee" name="a610f329a44512e94e0794c2e85bca1ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a610f329a44512e94e0794c2e85bca1ee">&#9670;&#160;</a></span>_mgSolverType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ec">SolverType</a> femus::LinearEquationSolver::_mgSolverType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00182">182</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>

</div>
</div>
<a id="aea3bb5e946dca1be0fa0bf40e2ccae73" name="aea3bb5e946dca1be0fa0bf40e2ccae73"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea3bb5e946dca1be0fa0bf40e2ccae73">&#9670;&#160;</a></span>_msh</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* femus::LinearEquation::_msh</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to underlying mesh </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00110">110</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a0ee45f5bc96766fa25c736a40674e551" name="a0ee45f5bc96766fa25c736a40674e551"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ee45f5bc96766fa25c736a40674e551">&#9670;&#160;</a></span>_nprocs</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::ParallelObject::_nprocs</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html#l00060">60</a> of file <a class="el" href="../../da/d3d/_parallel_object_8hpp_source.html">ParallelObject.hpp</a>.</p>

</div>
</div>
<a id="ad42d4d0d6a54f6df97afa82f4eec7a0c" name="ad42d4d0d6a54f6df97afa82f4eec7a0c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad42d4d0d6a54f6df97afa82f4eec7a0c">&#9670;&#160;</a></span>_numberOfGlobalVariables</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">unsigned femus::LinearEquation::_numberOfGlobalVariables</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00239">239</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a2f1863719353c8ca3a9d7f9ba5723875" name="a2f1863719353c8ca3a9d7f9ba5723875"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f1863719353c8ca3a9d7f9ba5723875">&#9670;&#160;</a></span>_pc</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PC femus::LinearEquationSolverPetsc::_pc</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a> context. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00111">111</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="ae7d568d4a992a82d1b06903cb7e384fb" name="ae7d568d4a992a82d1b06903cb7e384fb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae7d568d4a992a82d1b06903cb7e384fb">&#9670;&#160;</a></span>_preconditioner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a>* femus::LinearEquationSolver::_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Holds the <a class="el" href="../../d9/d80/classfemus_1_1_preconditioner.html">Preconditioner</a> object to be used for the linear solves. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00205">205</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>

</div>
</div>
<a id="aeb95e2f8a6a1c23b54278252f4f418ad" name="aeb95e2f8a6a1c23b54278252f4f418ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeb95e2f8a6a1c23b54278252f4f418ad">&#9670;&#160;</a></span>_preconditioner_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cf">PreconditionerType</a> femus::LinearEquationSolver::_preconditioner_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Enum statitng with type of preconditioner to use. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00202">202</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>

</div>
</div>
<a id="a7058888fb57ea520cce21647a69db329" name="a7058888fb57ea520cce21647a69db329"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7058888fb57ea520cce21647a69db329">&#9670;&#160;</a></span>_printSolverInfo</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::LinearEquationSolver::_printSolverInfo</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00104">104</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>

</div>
</div>
<a id="ae819a67a7c62b49373dd257e11466e5e" name="ae819a67a7c62b49373dd257e11466e5e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae819a67a7c62b49373dd257e11466e5e">&#9670;&#160;</a></span>_RES</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* femus::LinearEquation::_RES</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Vectors for residual </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00200">200</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a22675b9d542dc58b67f4d2cba10a4c0d" name="a22675b9d542dc58b67f4d2cba10a4c0d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22675b9d542dc58b67f4d2cba10a4c0d">&#9670;&#160;</a></span>_RESC</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> * femus::LinearEquation::_RESC</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00200">200</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a595c4b08e58212f1d93c1518e51bdb43" name="a595c4b08e58212f1d93c1518e51bdb43"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a595c4b08e58212f1d93c1518e51bdb43">&#9670;&#160;</a></span>_restart</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscInt femus::LinearEquationSolverPetsc::_restart</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00117">117</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="a853956e789f4855a80e2f96359ba0b60" name="a853956e789f4855a80e2f96359ba0b60"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a853956e789f4855a80e2f96359ba0b60">&#9670;&#160;</a></span>_richardsonScaleFactor</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::LinearEquationSolverPetsc::_richardsonScaleFactor</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00122">122</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="a12be6e63b0980ad661ac0b5f1db07677" name="a12be6e63b0980ad661ac0b5f1db07677"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12be6e63b0980ad661ac0b5f1db07677">&#9670;&#160;</a></span>_rtol</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscReal femus::LinearEquationSolverPetsc::_rtol</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html#l00113">113</a> of file <a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a>.</p>

</div>
</div>
<a id="a25739bd6cc78282815fa4dfe79ed3885" name="a25739bd6cc78282815fa4dfe79ed3885"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a25739bd6cc78282815fa4dfe79ed3885">&#9670;&#160;</a></span>_SolName</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;char*&gt; femus::LinearEquation::_SolName</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size: number of Solutions </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00257">257</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a5dd44a3538606bda13d2fcdfea5c2b35" name="a5dd44a3538606bda13d2fcdfea5c2b35"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dd44a3538606bda13d2fcdfea5c2b35">&#9670;&#160;</a></span>_SolPdeIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned&gt; femus::LinearEquation::_SolPdeIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size: number of Added Unknowns </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00223">223</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a777130e1a7e1342528f816e09c56be01" name="a777130e1a7e1342528f816e09c56be01"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a777130e1a7e1342528f816e09c56be01">&#9670;&#160;</a></span>_SolType</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned&gt; femus::LinearEquation::_SolType</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size: number of Solutions </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00255">255</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a453ddac90679e3447fa774a52e3d2214" name="a453ddac90679e3447fa774a52e3d2214"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a453ddac90679e3447fa774a52e3d2214">&#9670;&#160;</a></span>_solution</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>* femus::LinearEquation::_solution</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Only used in one place to retrieve RemoveNullSpace </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00249">249</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a59a6274d7ad89115708f2e654dca326b" name="a59a6274d7ad89115708f2e654dca326b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59a6274d7ad89115708f2e654dca326b">&#9670;&#160;</a></span>_SparsityPattern</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;bool&gt; femus::LinearEquation::_SparsityPattern</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size: number of unknowns </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00171">171</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="ada4422410129b056d30d9bec6373398a" name="ada4422410129b056d30d9bec6373398a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ada4422410129b056d30d9bec6373398a">&#9670;&#160;</a></span>_sparsityPatternMinimumSize</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; unsigned &gt; femus::LinearEquation::_sparsityPatternMinimumSize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size: number of unknowns </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00173">173</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="ae8585849c6da7f7415bc2939e86476f2" name="ae8585849c6da7f7415bc2939e86476f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8585849c6da7f7415bc2939e86476f2">&#9670;&#160;</a></span>_sparsityPatternVariableIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;unsigned&gt; femus::LinearEquation::_sparsityPatternVariableIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size: number of unknowns </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00175">175</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a62a2a1ed0ecb5758eedb242fa5fdd461" name="a62a2a1ed0ecb5758eedb242fa5fdd461"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a62a2a1ed0ecb5758eedb242fa5fdd461">&#9670;&#160;</a></span>d_nnz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; femus::LinearEquation::d_nnz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>number of non-zeros per row, on-diagonal </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00180">180</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a541098ff691f1c1268d071581426eddf" name="a541098ff691f1c1268d071581426eddf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a541098ff691f1c1268d071581426eddf">&#9670;&#160;</a></span>KKghost_nd</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector &lt; int&gt; &gt; femus::LinearEquation::KKghost_nd</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size [_nprocs][KKghostsize[i]] </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00133">133</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="af6ce9ed56da9e3475fcd4926bb5d782d" name="af6ce9ed56da9e3475fcd4926bb5d782d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6ce9ed56da9e3475fcd4926bb5d782d">&#9670;&#160;</a></span>KKghostsize</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; unsigned &gt; femus::LinearEquation::KKghostsize</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size [_nprocs] </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00130">130</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a5f1126279cb193c88f8bd2e85341f31e" name="a5f1126279cb193c88f8bd2e85341f31e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f1126279cb193c88f8bd2e85341f31e">&#9670;&#160;</a></span>KKIndex</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; femus::LinearEquation::KKIndex</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size [_SolPdeIndex.size() + 1] : number of dofs for each variable, summed over all processors (expressed in offset mode) </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00125">125</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="ae3ec0b2dd39e7527448bc35f108f6093" name="ae3ec0b2dd39e7527448bc35f108f6093"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae3ec0b2dd39e7527448bc35f108f6093">&#9670;&#160;</a></span>KKoffset</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector &lt;unsigned&gt; &gt; femus::LinearEquation::KKoffset</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>size [_SolPdeIndex.size() + 1][_nprocs] </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00122">122</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a4613cf9a418f8a61220a705e30843ade" name="a4613cf9a418f8a61220a705e30843ade"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4613cf9a418f8a61220a705e30843ade">&#9670;&#160;</a></span>o_nnz</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; int &gt; femus::LinearEquation::o_nnz</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>number of non-zeros per row, off-diagonal </p>

<p class="definition">Definition at line <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html#l00183">183</a> of file <a class="el" href="../../da/d41/_linear_equation_8hpp_source.html">LinearEquation.hpp</a>.</p>

</div>
</div>
<a id="a0a3207fb3cca0f45b8909812f64f6efa" name="a0a3207fb3cca0f45b8909812f64f6efa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0a3207fb3cca0f45b8909812f64f6efa">&#9670;&#160;</a></span>same_preconditioner</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::LinearEquationSolver::same_preconditioner</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Boolean flag to indicate whether we want to use an identical preconditioner to the previous solve. </p>

<p class="definition">Definition at line <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00208">208</a> of file <a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>D:/femusDoxygen/source/src/08_algebra_dependent_on_Mesh_and_Solution_but_independent_of_Systems/03_solvers_with_preconditioner/<a class="el" href="../../d3/ddc/_linear_equation_solver_petsc_8hpp_source.html">LinearEquationSolverPetsc.hpp</a></li>
<li>D:/femusDoxygen/source/src/08_algebra_dependent_on_Mesh_and_Solution_but_independent_of_Systems/03_solvers_with_preconditioner/<a class="el" href="../../db/db4/_linear_equation_solver_petsc_8cpp_source.html">LinearEquationSolverPetsc.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/dea/namespacefemus.html">femus</a></li><li class="navelem"><a class="el" href="../../dd/de2/classfemus_1_1_linear_equation_solver_petsc.html">LinearEquationSolverPetsc</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
