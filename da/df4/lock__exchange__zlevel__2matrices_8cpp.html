<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/applications/SW/lock_exchange_zlevel_2matrices/lock_exchange_zlevel_2matrices.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('da/df4/lock__exchange__zlevel__2matrices_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">lock_exchange_zlevel_2matrices.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../df/d7c/_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/dce/_multi_level_solution_8hpp_source.html">MultiLevelSolution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/dbc/_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df7/_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d84/_g_m_v_writer_8hpp_source.html">GMVWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d31/_petsc_matrix_8hpp_source.html">PetscMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d7f/_transient_system_8hpp_source.html">TransientSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d69/_linear_implicit_system_8hpp_source.html">LinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;slepceps.h&quot;</code><br />
<code>#include &lt;slepcmfn.h&gt;</code><br />
</div>
<p><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a3c511f31ed03c318ae5e8f4059130dc7"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a3c511f31ed03c318ae5e8f4059130dc7">InitalValueV</a> (const std::vector&lt; double &gt; &amp;x)</td></tr>
<tr class="separator:a3c511f31ed03c318ae5e8f4059130dc7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4e5f401ba6f89ef90709419b553449c2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a4e5f401ba6f89ef90709419b553449c2">InitalValueH</a> (const std::vector&lt; double &gt; &amp;x)</td></tr>
<tr class="separator:a4e5f401ba6f89ef90709419b553449c2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae45ae26f12d9a15818c6f894ca273a26"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae45ae26f12d9a15818c6f894ca273a26">InitalValueT</a> (const std::vector&lt; double &gt; &amp;x)</td></tr>
<tr class="separator:ae45ae26f12d9a15818c6f894ca273a26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa400609e27627c072ac486290fe0c578"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aa400609e27627c072ac486290fe0c578">InitalValueB</a> (const std::vector&lt; double &gt; &amp;x)</td></tr>
<tr class="separator:aa400609e27627c072ac486290fe0c578"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a> (const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5d7ff4fee461c0603de22f0a74f2db26"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a5d7ff4fee461c0603de22f0a74f2db26">ETDvh</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:a5d7ff4fee461c0603de22f0a74f2db26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef6fb1f9f1bf2c50c083708d81863629"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aef6fb1f9f1bf2c50c083708d81863629">ETDt</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:aef6fb1f9f1bf2c50c083708d81863629"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a> (int argc, char **args)</td></tr>
<tr class="separator:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a7adc750d395e26424054cf5d3794cd87"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a> [20] = {1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000}</td></tr>
<tr class="separator:a7adc750d395e26424054cf5d3794cd87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a03e28be41881b703c836edbfe9b51b17"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = 60.</td></tr>
<tr class="separator:a03e28be41881b703c836edbfe9b51b17"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abc71ccd436cc809f06b6c7d08cbccf24"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#abc71ccd436cc809f06b6c7d08cbccf24">ni_h</a> = 100.</td></tr>
<tr class="separator:abc71ccd436cc809f06b6c7d08cbccf24"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec5c8799058dca0be83e5a2eed7b16f2"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aec5c8799058dca0be83e5a2eed7b16f2">ni_v</a> = 0.0001</td></tr>
<tr class="separator:aec5c8799058dca0be83e5a2eed7b16f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bbed1516a6d7e1b00f660dd54e232c1"><td class="memItemLeft" align="right" valign="top">const unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a> = 20</td></tr>
<tr class="separator:a8bbed1516a6d7e1b00f660dd54e232c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8687ac9f3e6cab8f2e98e121ca69bb8"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a> [20] = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}</td></tr>
<tr class="separator:ae8687ac9f3e6cab8f2e98e121ca69bb8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aef6fb1f9f1bf2c50c083708d81863629" name="aef6fb1f9f1bf2c50c083708d81863629"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef6fb1f9f1bf2c50c083708d81863629">&#9670;&#160;</a></span>ETDt()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ETDt </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00802">802</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  802</span>                                         {</div>
<div class="line"><span class="lineno">  803</span> </div>
<div class="line"><span class="lineno">  804</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; NLayers = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>;</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>  adept::Stack&amp; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> = <a class="code hl_variable" href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;</div>
<div class="line"><span class="lineno">  807</span> </div>
<div class="line"><span class="lineno">  808</span>  <a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a>* mlPdeSys  = &amp;ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a>&gt; ( <span class="stringliteral">&quot;SWt&quot;</span> ); <span class="comment">// pointer to the linear implicit system named &quot;Poisson&quot;</span></div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span>  <span class="keywordtype">unsigned</span> level = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1u;</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* msh = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> ( level ); <span class="comment">// pointer to the mesh (level) object</span></div>
<div class="line"><span class="lineno">  813</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>* el = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;  <span class="comment">// pointer to the elem object in msh (level)</span></div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>* mlSol = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;  <span class="comment">// pointer to the multilevel solution object</span></div>
<div class="line"><span class="lineno">  816</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>* sol = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a> ( level ); <span class="comment">// pointer to the solution (level) object</span></div>
<div class="line"><span class="lineno">  817</span> </div>
<div class="line"><span class="lineno">  818</span>  <a class="code hl_class" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>* pdeSys = mlPdeSys-&gt;_LinSolver[level]; <span class="comment">// pointer to the equation (level) object</span></div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>  <a class="code hl_class" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a>* <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;  <span class="comment">// pointer to the global stifness matrix object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  821</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* RES = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>; <span class="comment">// pointer to the global residual vector object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  822</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* EPS = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>; <span class="comment">// pointer to the global residual vector object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>(); <span class="comment">// get the domain dimension of the problem</span></div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  827</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>  <span class="comment">//solution variable</span></div>
<div class="line"><span class="lineno">  831</span>  std::vector &lt; unsigned &gt; solIndexh ( NLayers );</div>
<div class="line"><span class="lineno">  832</span>  <span class="comment">//std::vector &lt; unsigned &gt; solPdeIndexh ( NLayers );</span></div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>  std::vector &lt; unsigned &gt; solIndexv ( NLayers );</div>
<div class="line"><span class="lineno">  835</span>  <span class="comment">//std::vector &lt; unsigned &gt; solPdeIndexv ( NLayers );</span></div>
<div class="line"><span class="lineno">  836</span> </div>
<div class="line"><span class="lineno">  837</span>  std::vector &lt; unsigned &gt; solIndexHT ( NLayers );</div>
<div class="line"><span class="lineno">  838</span>  std::vector &lt; unsigned &gt; solPdeIndexHT ( NLayers );</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span>  std::vector &lt; unsigned &gt; solIndexT ( NLayers );</div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span>  vector&lt; int &gt; l2GMapRow; <span class="comment">// local to global mapping</span></div>
<div class="line"><span class="lineno">  843</span>  vector&lt; int &gt; l2GMapColumn; <span class="comment">// local to global mapping</span></div>
<div class="line"><span class="lineno">  844</span> </div>
<div class="line"><span class="lineno">  845</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; NLayers; i++ ) {</div>
<div class="line"><span class="lineno">  846</span>    <span class="keywordtype">char</span> name[10];</div>
<div class="line"><span class="lineno">  847</span>    sprintf ( name, <span class="stringliteral">&quot;h%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  848</span>    solIndexh[i] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( name ); <span class="comment">// get the position of &quot;hi&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  849</span>    <span class="comment">//solPdeIndexh[i] = mlPdeSys-&gt;GetSolPdeIndex ( name ); // get the position of &quot;hi&quot; in the pdeSys object</span></div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>    sprintf ( name, <span class="stringliteral">&quot;v%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  852</span>    solIndexv[i] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( name ); <span class="comment">// get the position of &quot;vi&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  853</span>    <span class="comment">//solPdeIndexv[i] = mlPdeSys-&gt;GetSolPdeIndex ( name ); // get the position of &quot;vi&quot; in the pdeSys object</span></div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>    sprintf ( name, <span class="stringliteral">&quot;HT%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  856</span>    solIndexHT[i] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( name ); <span class="comment">// get the position of &quot;Ti&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  857</span>    solPdeIndexHT[i] = mlPdeSys-&gt;GetSolPdeIndex ( name ); <span class="comment">// get the position of &quot;Ti&quot; in the pdeSys object</span></div>
<div class="line"><span class="lineno">  858</span> </div>
<div class="line"><span class="lineno">  859</span>    sprintf ( name, <span class="stringliteral">&quot;T%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  860</span>    solIndexT[i] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( name ); <span class="comment">// get the position of &quot;Ti&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>  }</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>  <span class="keywordtype">unsigned</span> solTypeh = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> ( solIndexh[0] ); <span class="comment">// get the finite element type for &quot;hi&quot;</span></div>
<div class="line"><span class="lineno">  865</span>  <span class="keywordtype">unsigned</span> solTypev = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> ( solIndexv[0] ); <span class="comment">// get the finite element type for &quot;vi&quot;</span></div>
<div class="line"><span class="lineno">  866</span>  <span class="keywordtype">unsigned</span> solTypeHT = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> ( solIndexHT[0] ); <span class="comment">// get the finite element type for &quot;Ti&quot;</span></div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span>  <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;zero();</div>
<div class="line"><span class="lineno">  869</span>  RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>  MatSetOption ( ( <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="../../da/dcf/classfemus_1_1_petsc_matrix.html">PetscMatrix</a>*<span class="keyword">&gt;</span> ( <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> ) )-&gt;mat(), MAT_NEW_NONZERO_ALLOCATION_ERR, PETSC_FALSE );</div>
<div class="line"><span class="lineno">  872</span> </div>
<div class="line"><span class="lineno">  873</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; k++ ) {</div>
<div class="line"><span class="lineno">  874</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i =  msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeHT][iproc]; i &lt;  msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeHT][iproc + 1]; i++ ) {</div>
<div class="line"><span class="lineno">  875</span>      <span class="keywordtype">double</span> valueT = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexT[k]] ) ( i );</div>
<div class="line"><span class="lineno">  876</span>      <span class="keywordtype">double</span> valueH = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5a9e3b150f6202162de4e350c39f544c">_SolOld</a>[solIndexh[k]] ) ( i );</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>      <span class="keywordtype">double</span> valueHT = valueT * valueH;</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>      sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexHT[k]]-&gt;set ( i, valueHT );</div>
<div class="line"><span class="lineno">  881</span>    }</div>
<div class="line"><span class="lineno">  882</span>    sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexHT[k]]-&gt;close();</div>
<div class="line"><span class="lineno">  883</span>  }</div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>  <span class="keywordtype">unsigned</span> start = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeHT][iproc];</div>
<div class="line"><span class="lineno">  886</span>  <span class="keywordtype">unsigned</span> end = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeHT][iproc + 1];</div>
<div class="line"><span class="lineno">  887</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i =  start; i &lt;  end; i++ ) {</div>
<div class="line"><span class="lineno">  888</span> </div>
<div class="line"><span class="lineno">  889</span>    vector &lt; double &gt; solhm ( NLayers, 0. );</div>
<div class="line"><span class="lineno">  890</span>    vector &lt; double &gt; solh ( NLayers, 0. ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  891</span>    vector &lt; double &gt; solhp ( NLayers, 0. );</div>
<div class="line"><span class="lineno">  892</span>    vector &lt; double &gt; solvm ( NLayers, 0. ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  893</span>    vector &lt; double &gt; solvp ( NLayers, 0. ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  894</span>    vector &lt; adept::adouble &gt; solHTm ( NLayers, 0. ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  895</span>    vector &lt; adept::adouble &gt; solHT ( NLayers, 0. ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  896</span>    vector &lt; adept::adouble &gt; solHTp ( NLayers, 0. ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  897</span>    </div>
<div class="line"><span class="lineno">  898</span>    vector &lt; adept::adouble &gt; solHTmm(NLayers, 0.);    <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  899</span>    vector &lt; adept::adouble &gt; solHTpp(NLayers, 0.);    <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>    <span class="comment">//vector&lt; adept::adouble &gt; aResh ( NLayers );</span></div>
<div class="line"><span class="lineno">  902</span>    <span class="comment">//vector&lt; adept::adouble &gt; aResv ( NLayers );</span></div>
<div class="line"><span class="lineno">  903</span>    vector&lt; adept::adouble &gt; aResHT ( NLayers );</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>    <span class="keywordtype">unsigned</span> bc1 = ( i == start ) ? 0 : 1;</div>
<div class="line"><span class="lineno">  906</span>    <span class="keywordtype">unsigned</span> bc2 = ( i == end - 1 ) ? 0 : 1;</div>
<div class="line"><span class="lineno">  907</span>    </div>
<div class="line"><span class="lineno">  908</span>    <span class="keywordtype">unsigned</span> bc3 = ( i &gt; start + 1) ? 1 : 0;</div>
<div class="line"><span class="lineno">  909</span>    <span class="keywordtype">unsigned</span> bc4 = ( i &lt; end - 2 ) ? 1 : 0;</div>
<div class="line"><span class="lineno">  910</span> </div>
<div class="line"><span class="lineno">  911</span>    l2GMapRow.resize ( NLayers );</div>
<div class="line"><span class="lineno">  912</span>    l2GMapColumn.resize ( ( 1 + bc1 + bc2 ) * NLayers );</div>
<div class="line"><span class="lineno">  913</span>    <span class="comment">//l2GMapColumn.resize ( ( 1 + bc1 + bc2 + bc3 + bc4) * NLayers );</span></div>
<div class="line"><span class="lineno">  914</span> </div>
<div class="line"><span class="lineno">  915</span>    <span class="comment">//std::fill ( aResh.begin(), aResh.end(), 0 ); //set aRes to zero</span></div>
<div class="line"><span class="lineno">  916</span>    std::fill ( aResHT.begin(), aResHT.end(), 0 ); <span class="comment">//set aRes to zero</span></div>
<div class="line"><span class="lineno">  917</span> </div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; NLayers; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span>      solh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  921</span>      solHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  922</span>      </div>
<div class="line"><span class="lineno">  923</span>      l2GMapRow[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  924</span> </div>
<div class="line"><span class="lineno">  925</span>      </div>
<div class="line"><span class="lineno">  926</span>      l2GMapColumn[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  927</span> </div>
<div class="line"><span class="lineno">  928</span>      solvm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  929</span>      solvp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i + 1 );</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>      <span class="keywordflow">if</span> ( bc1) { </div>
<div class="line"><span class="lineno">  933</span>        solhm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i - 1 );</div>
<div class="line"><span class="lineno">  934</span>        solHTm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i - 1 );</div>
<div class="line"><span class="lineno">  935</span>       </div>
<div class="line"><span class="lineno">  936</span>        l2GMapColumn[NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i - 1 );</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>      }</div>
<div class="line"><span class="lineno">  939</span> </div>
<div class="line"><span class="lineno">  940</span>      <span class="keywordflow">if</span> ( bc2 ) {</div>
<div class="line"><span class="lineno">  941</span>        solhp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i + 1 );</div>
<div class="line"><span class="lineno">  942</span>        solHTp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i + 1 );</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>        l2GMapColumn[ ( 1 + bc1) * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexHT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i + 1 );</div>
<div class="line"><span class="lineno">  945</span>      }</div>
<div class="line"><span class="lineno">  946</span>      </div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span><span class="comment">//       if ( bc3 ) {</span></div>
<div class="line"><span class="lineno">  949</span><span class="comment">//         solHTmm[j] = ( *sol-&gt;_Sol[solIndexHT[j]] ) ( i - 2 );</span></div>
<div class="line"><span class="lineno">  950</span><span class="comment">//         l2GMapColumn[( 1 + bc1 + bc2 ) * NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i - 2 );</span></div>
<div class="line"><span class="lineno">  951</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  952</span><span class="comment">//     </span></div>
<div class="line"><span class="lineno">  953</span><span class="comment">//       if ( bc4 ) {</span></div>
<div class="line"><span class="lineno">  954</span><span class="comment">//         solHTpp[j] = ( *sol-&gt;_Sol[solIndexHT[j]] ) ( i + 2 );</span></div>
<div class="line"><span class="lineno">  955</span><span class="comment">//         l2GMapColumn[( 1 + bc1 + bc2 + bc3 ) * NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i + 2 );</span></div>
<div class="line"><span class="lineno">  956</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>    }</div>
<div class="line"><span class="lineno">  959</span>    </div>
<div class="line"><span class="lineno">  960</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.new_recording();</div>
<div class="line"><span class="lineno">  961</span> </div>
<div class="line"><span class="lineno">  962</span>    vector &lt; double &gt; x ( 2 ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  963</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 2; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  964</span>      <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> ( <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, i, 2 ); <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  965</span>      x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0] ) ( xDof ); <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  966</span>    }</div>
<div class="line"><span class="lineno">  967</span>    <span class="keywordtype">double</span> dx = x[1] - x[0];</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = 20; <span class="comment">//( H_shelf + H_0 / 2 * (1 + tanh(hh / phi)) );</span></div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>    <span class="keywordtype">double</span> hTot = 0.;</div>
<div class="line"><span class="lineno">  972</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  973</span>      hTot += solh[k]<span class="comment">/*.value()*/</span>;</div>
<div class="line"><span class="lineno">  974</span>    }</div>
<div class="line"><span class="lineno">  975</span> </div>
<div class="line"><span class="lineno">  976</span>    std::vector &lt; double &gt; hALE ( NLayers, 0. );</div>
<div class="line"><span class="lineno">  977</span> </div>
<div class="line"><span class="lineno">  978</span>    hALE[0] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[0] + ( hTot - <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> );</div>
<div class="line"><span class="lineno">  979</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 1; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  980</span>      hALE[k] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[k];</div>
<div class="line"><span class="lineno">  981</span>    }</div>
<div class="line"><span class="lineno">  982</span> </div>
<div class="line"><span class="lineno">  983</span>    std::vector &lt; double &gt; w ( NLayers + 1, 0. );</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span><span class="comment">//     for ( unsigned k = NLayers; k &gt; 1; k-- ) {</span></div>
<div class="line"><span class="lineno">  986</span><span class="comment">//       w[k - 1] = w[k] - ( 0.5 * ( solh[k - 1]/*.value()*/ + solhp[k - 1]/*.value()*/ ) * solvp[k - 1]/*.value()*/</span></div>
<div class="line"><span class="lineno">  987</span><span class="comment">//                           - 0.5 * ( solh[k - 1]/*.value()*/ + solhm[k - 1]/*.value()*/ ) * solvm[k - 1] ) / dx</span></div>
<div class="line"><span class="lineno">  988</span><span class="comment">//                  - ( hALE[k - 1] - solh[k - 1]/*.value()*/ ) / dt; //TODO</span></div>
<div class="line"><span class="lineno">  989</span><span class="comment">//       //std::cout&lt;&lt;&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;&lt;&lt;w[k-1]&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  990</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  991</span>    </div>
<div class="line"><span class="lineno">  992</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = NLayers; k &gt; 1; k-- ) {</div>
<div class="line"><span class="lineno">  993</span>      w[k - 1] = w[k] - ( hALE[k - 1] - solh[k - 1]) / <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>; </div>
<div class="line"><span class="lineno">  994</span>      <span class="keywordflow">if</span>(bc2){ </div>
<div class="line"><span class="lineno">  995</span>        w[k - 1] -=   0.5 * ( solh[k - 1] + solhp[k - 1] ) * solvp[k - 1] /dx;</div>
<div class="line"><span class="lineno">  996</span>      }</div>
<div class="line"><span class="lineno">  997</span>      <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  998</span>        <span class="comment">//w[k - 1] -=   solh[k - 1] * 0. /dx;  </span></div>
<div class="line"><span class="lineno">  999</span>      }</div>
<div class="line"><span class="lineno"> 1000</span>      <span class="keywordflow">if</span>(bc1){</div>
<div class="line"><span class="lineno"> 1001</span>        w[k - 1] +=   0.5 * ( solh[k - 1] + solhm[k - 1] ) * solvm[k - 1] /dx;</div>
<div class="line"><span class="lineno"> 1002</span>      }</div>
<div class="line"><span class="lineno"> 1003</span>      <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno"> 1004</span>        <span class="comment">//w[k - 1] +=   solh[k - 1] * 0. /dx;   </span></div>
<div class="line"><span class="lineno"> 1005</span>      }</div>
<div class="line"><span class="lineno"> 1006</span>      <span class="comment">//std::cout&lt;&lt; w[k-1] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1007</span>    }</div>
<div class="line"><span class="lineno"> 1008</span>    </div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span><span class="comment">//     for(unsigned k = 1; k &lt; NLayers; k++){</span></div>
<div class="line"><span class="lineno"> 1011</span><span class="comment">//       w[k] = w[k-1] + (  0.5 * ( solh[k-1].value() + solhp[k-1].value() ) * solvp[k-1].value()</span></div>
<div class="line"><span class="lineno"> 1012</span><span class="comment">//                     - 0.5 * ( solh[k-1].value() + solhm[k-1].value() ) * solvm[k-1].value() )/dx</span></div>
<div class="line"><span class="lineno"> 1013</span><span class="comment">//                  + ( hALE[k-1] - solh[k-1].value()) / dt;//TODO</span></div>
<div class="line"><span class="lineno"> 1014</span><span class="comment">//                  //std::cout&lt;&lt;&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;&lt;&lt;w[k-1]&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1015</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>    <span class="comment">//FINO A QUI</span></div>
<div class="line"><span class="lineno"> 1018</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span><span class="comment">//       if ( i &gt; start ) {</span></div>
<div class="line"><span class="lineno"> 1021</span><span class="comment">//         aResh[k] += 0.5 * ( solhm[k] + solh[k] ) * solvm[k] / dx;</span></div>
<div class="line"><span class="lineno"> 1022</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno"> 1023</span><span class="comment">//       if ( i &lt; end - 1 ) {</span></div>
<div class="line"><span class="lineno"> 1024</span><span class="comment">//         aResh[k] -= 0.5 * ( solh[k] + solhp[k] ) * solvp[k] / dx;</span></div>
<div class="line"><span class="lineno"> 1025</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno"> 1026</span><span class="comment">//       aResh[k] += w[k + 1] - w[k];</span></div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>      <span class="comment">//BEGIN FIRST ORDER</span></div>
<div class="line"><span class="lineno"> 1029</span>      <span class="keywordflow">if</span> ( i &gt; start ) {</div>
<div class="line"><span class="lineno"> 1030</span>        <span class="comment">//aResHT[k] += 0.5 * (solHTm[k] + solHT[k]) * solvm[k]  / dx; //second order</span></div>
<div class="line"><span class="lineno"> 1031</span>        <span class="keywordflow">if</span> ( solvm[k] &gt; 0 ) {</div>
<div class="line"><span class="lineno"> 1032</span>          aResHT[k] += solHTm[k] * solvm[k]<span class="comment">/*.value()*/</span>  / dx;</div>
<div class="line"><span class="lineno"> 1033</span>        }</div>
<div class="line"><span class="lineno"> 1034</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1035</span>          aResHT[k] += solHT[k] * solvm[k]<span class="comment">/*.value()*/</span>  / dx;</div>
<div class="line"><span class="lineno"> 1036</span>        }</div>
<div class="line"><span class="lineno"> 1037</span>      }</div>
<div class="line"><span class="lineno"> 1038</span>      <span class="keywordflow">if</span> ( i &lt; end - 1 ) {</div>
<div class="line"><span class="lineno"> 1039</span>        <span class="comment">//aResHT[k] -= 0.5 * (solHT[k] + solHTp[k]) * solvp[k]  / dx; //second order</span></div>
<div class="line"><span class="lineno"> 1040</span>        <span class="keywordflow">if</span> ( solvp[k] &gt; 0 ) {</div>
<div class="line"><span class="lineno"> 1041</span>          aResHT[k] -= solHT[k] * solvp[k]<span class="comment">/*.value()*/</span>  / dx; <span class="comment">//first order upwind</span></div>
<div class="line"><span class="lineno"> 1042</span>        }</div>
<div class="line"><span class="lineno"> 1043</span>        <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1044</span>          aResHT[k] -= solHTp[k] * solvp[k]<span class="comment">/*.value()*/</span>  / dx; <span class="comment">//first order upwind</span></div>
<div class="line"><span class="lineno"> 1045</span>        }</div>
<div class="line"><span class="lineno"> 1046</span>      }</div>
<div class="line"><span class="lineno"> 1047</span>      <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1048</span> </div>
<div class="line"><span class="lineno"> 1049</span>      <span class="comment">//BEGIN THIRD ORDER</span></div>
<div class="line"><span class="lineno"> 1050</span><span class="comment">//       if ( i &gt; start ) {</span></div>
<div class="line"><span class="lineno"> 1051</span><span class="comment">//         aResHT[k] += 0.5 * ( solHTm[k].value() + solHT[k].value() ) * solvm[k] / dx;</span></div>
<div class="line"><span class="lineno"> 1052</span><span class="comment">//         if ( solvm[k] &gt; 0 ) {</span></div>
<div class="line"><span class="lineno"> 1053</span><span class="comment">//           if ( i &gt; start + 1 ) {</span></div>
<div class="line"><span class="lineno"> 1054</span><span class="comment">//             aResHT[k] += - 1. / 6. * ( solHT[k].value() - 2.*solHTm[k].value() + solHTmm[k].value() ) * solvm[k]  / dx;</span></div>
<div class="line"><span class="lineno"> 1055</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno"> 1056</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno"> 1057</span><span class="comment">//         else {</span></div>
<div class="line"><span class="lineno"> 1058</span><span class="comment">//           if ( i &lt; end - 1 ) {</span></div>
<div class="line"><span class="lineno"> 1059</span><span class="comment">//             aResHT[k] += - 1. / 6. * ( solHTp[k].value() - 2.*solHT[k].value() + solHTm[k].value() ) * solvm[k]  / dx;</span></div>
<div class="line"><span class="lineno"> 1060</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno"> 1061</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno"> 1062</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno"> 1063</span><span class="comment">//       if ( i &lt; end - 1 ) {</span></div>
<div class="line"><span class="lineno"> 1064</span><span class="comment">//         aResHT[k] -= 0.5 * ( solHTp[k].value() + solHT[k].value() ) * solvp[k] / dx;</span></div>
<div class="line"><span class="lineno"> 1065</span><span class="comment">//         if ( solvp[k] &gt; 0 ) {</span></div>
<div class="line"><span class="lineno"> 1066</span><span class="comment">//           if (i &gt; start) {</span></div>
<div class="line"><span class="lineno"> 1067</span><span class="comment">//             aResHT[k] -= - 1. / 6. * ( solHTp[k].value() - 2.*solHT[k].value() + solHTm[k].value() ) * solvp[k]  / dx;</span></div>
<div class="line"><span class="lineno"> 1068</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno"> 1070</span><span class="comment">//         else {</span></div>
<div class="line"><span class="lineno"> 1071</span><span class="comment">//           if ( i &lt; end - 2 ) {</span></div>
<div class="line"><span class="lineno"> 1072</span><span class="comment">//             aResHT[k] -= - 1. / 6. * ( solHTpp[k].value() - 2.*solHTp[k].value() + solHT[k].value() ) * solvp[k]  / dx;</span></div>
<div class="line"><span class="lineno"> 1073</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno"> 1074</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno"> 1075</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno"> 1076</span>      <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1077</span> </div>
<div class="line"><span class="lineno"> 1078</span>      <span class="keywordflow">if</span> ( k &lt; NLayers - 1 ) {</div>
<div class="line"><span class="lineno"> 1079</span>        aResHT[k] += w[k + 1] * 0.5 * ( solHT[k] / solh[k]<span class="comment">/*.value()*/</span> + solHT[k + 1] / solh[k + 1]<span class="comment">/*.value()*/</span> );</div>
<div class="line"><span class="lineno"> 1080</span>      }</div>
<div class="line"><span class="lineno"> 1081</span>      <span class="keywordflow">if</span> ( k &gt; 0 ) {</div>
<div class="line"><span class="lineno"> 1082</span>        aResHT[k] -= w[k] * 0.5 * ( solHT[k - 1] / solh[k - 1]<span class="comment">/*.value()*/</span> + solHT[k] / solh[k]<span class="comment">/*.value()*/</span> );</div>
<div class="line"><span class="lineno"> 1083</span>      }</div>
<div class="line"><span class="lineno"> 1084</span> </div>
<div class="line"><span class="lineno"> 1085</span><span class="comment">//       aResHT[k] += ((solhp[k] - solhm[k]) * k_h * (solHTp[k] - solHTm[k])) / (dx*dx); // horizontal diffusion</span></div>
<div class="line"><span class="lineno"> 1086</span><span class="comment">//       aResHT[k] += k_h * solh[k] * (solHTm[k] - solHT[k])/(dx*dx); // horizontal diffusion</span></div>
<div class="line"><span class="lineno"> 1087</span><span class="comment">//       aResHT[k] += k_h * solh[k] * (solHTp[k] - solHT[k])/(dx*dx); // horizontal diffusion</span></div>
<div class="line"><span class="lineno"> 1088</span> </div>
<div class="line"><span class="lineno"> 1089</span>    }</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>    vector&lt; double &gt; Res ( NLayers ); <span class="comment">// local redidual vector</span></div>
<div class="line"><span class="lineno"> 1092</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno"> 1093</span>      <span class="comment">//Res[k] =  aResh[k].value();</span></div>
<div class="line"><span class="lineno"> 1094</span>      Res[k] =  aResHT[k].value();</div>
<div class="line"><span class="lineno"> 1095</span>      <span class="comment">//std::cout&lt;&lt; &quot;Res[&quot;&lt;&lt;k&lt;&lt;&quot;] = &quot; &lt;&lt; Res[k] &lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1096</span>      <span class="comment">//std::cout&lt;&lt; &quot;Res[&quot;&lt;&lt;NLayers+k&lt;&lt;&quot;] = &quot; &lt;&lt; Res[NLayers+k] &lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1097</span>    }</div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>    RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a> ( Res, l2GMapRow );</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>    <span class="comment">//s.dependent ( &amp;aResh[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1102</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.dependent ( &amp;aResHT[0], NLayers );</div>
<div class="line"><span class="lineno"> 1103</span> </div>
<div class="line"><span class="lineno"> 1104</span>    <span class="comment">// define the independent variables</span></div>
<div class="line"><span class="lineno"> 1105</span>    <span class="comment">//s.independent ( &amp;solh[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1106</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solHT[0], NLayers );</div>
<div class="line"><span class="lineno"> 1107</span>    <span class="comment">//s.independent ( &amp;solvm[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1108</span>    <span class="comment">//s.independent ( &amp;solvp[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1109</span>    <span class="keywordflow">if</span> ( i &gt; start ) {</div>
<div class="line"><span class="lineno"> 1110</span>      <span class="comment">//s.independent ( &amp;solhm[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1111</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solHTm[0], NLayers );</div>
<div class="line"><span class="lineno"> 1112</span>    }</div>
<div class="line"><span class="lineno"> 1113</span>    <span class="keywordflow">if</span> ( i &lt; end - 1 ) {</div>
<div class="line"><span class="lineno"> 1114</span>      <span class="comment">//s.independent ( &amp;solhp[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1115</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solHTp[0], NLayers );</div>
<div class="line"><span class="lineno"> 1116</span>    }</div>
<div class="line"><span class="lineno"> 1117</span><span class="comment">/*    if ( i &gt; start + 1) {</span></div>
<div class="line"><span class="lineno"> 1118</span><span class="comment">      s.independent ( &amp;solHTmm[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1119</span><span class="comment">    }</span></div>
<div class="line"><span class="lineno"> 1120</span><span class="comment">    if ( i &lt; end - 2 ) {</span></div>
<div class="line"><span class="lineno"> 1121</span><span class="comment">      s.independent ( &amp;solHTpp[0], NLayers );</span></div>
<div class="line"><span class="lineno"> 1122</span><span class="comment">    }*/</span>    </div>
<div class="line"><span class="lineno"> 1123</span>    </div>
<div class="line"><span class="lineno"> 1124</span>    <span class="comment">// get the jacobian matrix (ordered by row major )</span></div>
<div class="line"><span class="lineno"> 1125</span>    vector &lt; double &gt; Jac ( NLayers * NLayers * ( 1 + bc1 + bc2 ) );</div>
<div class="line"><span class="lineno"> 1126</span>    <span class="comment">//vector &lt; double &gt; Jac ( NLayers * NLayers * ( 1 + bc1 + bc2 + bc3 +bc4 ) );</span></div>
<div class="line"><span class="lineno"> 1127</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.jacobian ( &amp;Jac[0], <span class="keyword">true</span> );</div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>    <span class="comment">//store K in the global matrix KK</span></div>
<div class="line"><span class="lineno"> 1130</span>    <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked ( Jac, l2GMapRow, l2GMapColumn );</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_independents();</div>
<div class="line"><span class="lineno"> 1133</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_dependents();</div>
<div class="line"><span class="lineno"> 1134</span> </div>
<div class="line"><span class="lineno"> 1135</span>  }</div>
<div class="line"><span class="lineno"> 1136</span> </div>
<div class="line"><span class="lineno"> 1137</span>  RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno"> 1138</span>  <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;close();</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span> </div>
<div class="line"><span class="lineno"> 1142</span><span class="comment">//   PetscViewer    viewer;</span></div>
<div class="line"><span class="lineno"> 1143</span><span class="comment">//   PetscViewerDrawOpen(PETSC_COMM_WORLD,NULL,NULL,0,0,900,900,&amp;viewer);</span></div>
<div class="line"><span class="lineno"> 1144</span><span class="comment">//   PetscObjectSetName((PetscObject)viewer,&quot;FSI matrix&quot;);</span></div>
<div class="line"><span class="lineno"> 1145</span><span class="comment">//   PetscViewerPushFormat(viewer,PETSC_VIEWER_DRAW_LG);</span></div>
<div class="line"><span class="lineno"> 1146</span><span class="comment">//   MatView((static_cast&lt;PetscMatrix*&gt;(KK))-&gt;mat(),viewer);</span></div>
<div class="line"><span class="lineno"> 1147</span><span class="comment">//   double a;</span></div>
<div class="line"><span class="lineno"> 1148</span><span class="comment">//   std::cin&gt;&gt;a;</span></div>
<div class="line"><span class="lineno"> 1149</span><span class="comment">// //</span></div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span><span class="comment">//  abort();</span></div>
<div class="line"><span class="lineno"> 1152</span>  MFN mfn;</div>
<div class="line"><span class="lineno"> 1153</span>  Mat <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> = ( <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="../../da/dcf/classfemus_1_1_petsc_matrix.html">PetscMatrix</a>*<span class="keyword">&gt;</span> ( <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> ) )-&gt;mat();</div>
<div class="line"><span class="lineno"> 1154</span>  FN f, f1, f2, f3 , f4;</div>
<div class="line"><span class="lineno"> 1155</span> </div>
<div class="line"><span class="lineno"> 1156</span>  <span class="comment">//std::cout &lt;&lt; &quot;dt = &quot; &lt;&lt; dt &lt;&lt; &quot; dx = &quot;&lt;&lt; dx &lt;&lt; &quot; maxWaveSpeed = &quot;&lt;&lt;maxWaveSpeed &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1157</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;dt = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1158</span> </div>
<div class="line"><span class="lineno"> 1159</span>  <span class="comment">//dt = 100.;</span></div>
<div class="line"><span class="lineno"> 1160</span> </div>
<div class="line"><span class="lineno"> 1161</span>  Vec v = ( <span class="keyword">static_cast&lt;</span> <a class="code hl_class" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a>* <span class="keyword">&gt;</span> ( RES ) )-&gt;vec();</div>
<div class="line"><span class="lineno"> 1162</span>  Vec <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> = ( <span class="keyword">static_cast&lt;</span> <a class="code hl_class" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a>* <span class="keyword">&gt;</span> ( EPS ) )-&gt;vec();</div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span>  MFNCreate ( PETSC_COMM_WORLD, &amp;mfn );</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>  MFNSetOperator ( mfn, <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> );</div>
<div class="line"><span class="lineno"> 1167</span>  MFNGetFN ( mfn, &amp;f );</div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span>  FNPhiSetIndex ( f, 1 );</div>
<div class="line"><span class="lineno"> 1170</span>  FNSetType ( f, FNPHI );</div>
<div class="line"><span class="lineno"> 1171</span><span class="comment">// FNView(f,PETSC_VIEWER_STDOUT_WORLD);</span></div>
<div class="line"><span class="lineno"> 1172</span> </div>
<div class="line"><span class="lineno"> 1173</span>  FNSetScale ( f, <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>, <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> );</div>
<div class="line"><span class="lineno"> 1174</span>  MFNSetFromOptions ( mfn );</div>
<div class="line"><span class="lineno"> 1175</span> </div>
<div class="line"><span class="lineno"> 1176</span>  MFNSolve ( mfn, v, <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> );</div>
<div class="line"><span class="lineno"> 1177</span>  MFNDestroy ( &amp;mfn );</div>
<div class="line"><span class="lineno"> 1178</span> </div>
<div class="line"><span class="lineno"> 1179</span>  sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a0a62d3ed880efa82cb1cd4c6144cc823">UpdateSol</a> ( mlPdeSys-&gt;GetSolPdeIndex(), EPS, pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a> );</div>
<div class="line"><span class="lineno"> 1180</span> </div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keywordtype">unsigned</span> solIndexeta = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( <span class="stringliteral">&quot;eta&quot;</span> );</div>
<div class="line"><span class="lineno"> 1182</span>  <span class="keywordtype">unsigned</span> solIndexb = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( <span class="stringliteral">&quot;b&quot;</span> );</div>
<div class="line"><span class="lineno"> 1183</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexeta]-&gt;zero();</div>
<div class="line"><span class="lineno"> 1184</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; k++ ) {</div>
<div class="line"><span class="lineno"> 1185</span>    sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexeta]-&gt;add ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[k]] );</div>
<div class="line"><span class="lineno"> 1186</span>  }</div>
<div class="line"><span class="lineno"> 1187</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexeta]-&gt;add ( -1, *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexb] );</div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; k++ ) {</div>
<div class="line"><span class="lineno"> 1190</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i =  msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeHT][iproc]; i &lt;  msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeHT][iproc + 1]; i++ ) {</div>
<div class="line"><span class="lineno"> 1191</span>      <span class="keywordtype">double</span> valueHT = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexHT[k]] ) ( i );</div>
<div class="line"><span class="lineno"> 1192</span>      <span class="keywordtype">double</span> valueH = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[k]] ) ( i );</div>
<div class="line"><span class="lineno"> 1193</span> </div>
<div class="line"><span class="lineno"> 1194</span>      <span class="keywordtype">double</span> valueT = valueHT / valueH;</div>
<div class="line"><span class="lineno"> 1195</span> </div>
<div class="line"><span class="lineno"> 1196</span>      sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexT[k]]-&gt;set ( i, valueT );</div>
<div class="line"><span class="lineno"> 1197</span>    }</div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>    sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexT[k]]-&gt;close();</div>
<div class="line"><span class="lineno"> 1200</span> </div>
<div class="line"><span class="lineno"> 1201</span>  }</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span>}</div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451"><div class="ttname"><a href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a></div><div class="ttdeci">@ KK</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9a/_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_a2fb1c5cf58867b5bbc9a1b145a86f3a0"><div class="ttname"><a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a></div><div class="ttdeci">y</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00053">MG_precond.m:53</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_u_q_2ex12_2ex12_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp_source.html#l00053">ex12.cpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html_ab48c1191eb7ebb370a323d3ec4f713c9"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">femus::FemusInit::_adeptStack</a></div><div class="ttdeci">static adept::Stack _adeptStack</div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00059">FemusInit.hpp:59</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a20ac8999e714492516cd8a2be53fb54f"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d77/_linear_equation_8cpp_source.html#l00071">LinearEquation.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a7f79930715e7e6c8b0ec81ee506a4ef0"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">femus::LinearEquation::_EPS</a></div><div class="ttdeci">NumericVector * _EPS</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00118">LinearEquation.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ae3ec0b2dd39e7527448bc35f108f6093"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">femus::LinearEquation::KKoffset</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned &gt; &gt; KKoffset</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00125">LinearEquation.hpp:125</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00055">LinearEquationSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a36b27d856d33d9d5554bda71401a5800"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">femus::Mesh::_dofOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _dofOffset[5]</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00399">Mesh.hpp:399</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a89a77678df230dce7f2dd2ff171c71b4"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">femus::MultiLevelMesh::GetNumberOfLevels</a></div><div class="ttdeci">unsigned GetNumberOfLevels()</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00157">MultiLevelMesh.hpp:157</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a6dd8fec26a0ffbaae07e6df7ea42d12b"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">femus::MultiLevelProblem::_ml_sol</a></div><div class="ttdeci">MultiLevelSolution * _ml_sol</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00079">MultiLevelProblem.hpp:79</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00116">MultiLevelProblem.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db0/_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a0440021963af01ac49a6f02df562e44b"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">femus::NumericVector::add_vector_blocked</a></div><div class="ttdeci">virtual void add_vector_blocked(const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)=0</div><div class="ttdoc">where v is a std::vector !!!fast</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_af6629fca51be192be664c76eb8aecc79"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">femus::ParallelObject::n_processors</a></div><div class="ttdeci">int n_processors() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00048">ParallelObject.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_matrix_html"><div class="ttname"><a href="../../da/dcf/classfemus_1_1_petsc_matrix.html">femus::PetscMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/d31/_petsc_matrix_8hpp_source.html#l00070">PetscMatrix.hpp:70</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html">femus::PetscVector</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00056">PetscVector.hpp:56</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a0a62d3ed880efa82cb1cd4c6144cc823"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a0a62d3ed880efa82cb1cd4c6144cc823">femus::Solution::UpdateSol</a></div><div class="ttdeci">void UpdateSol(const std::vector&lt; unsigned &gt; &amp;_SolPdeIndex, NumericVector *EPS, const std::vector&lt; std::vector&lt; unsigned &gt; &gt; &amp;KKoffset)</div><div class="ttdoc">====</div><div class="ttdef"><b>Definition</b> <a href="../../d2/da7/_solution_8cpp_source.html#l00501">Solution.cpp:501</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5a9e3b150f6202162de4e350c39f544c"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a5a9e3b150f6202162de4e350c39f544c">femus::Solution::_SolOld</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _SolOld</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00167">Solution.hpp:167</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d14/_sparse_matrix_8hpp_source.html#l00047">SparseMatrix.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html"><div class="ttname"><a href="../../da/d5b/classfemus_1_1_transient_system.html">femus::TransientSystem</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d7f/_transient_system_8hpp_source.html#l00047">TransientSystem.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="ainternal__waves__zlevel_8cpp_html_a2941385b1be5280d3b1f546356f7ec99"><div class="ttname"><a href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a></div><div class="ttdeci">double A</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d97/internal__waves__zlevel_8cpp_source.html#l00043">internal_waves_zlevel.cpp:43</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00032">lock_exchange_zlevel_2matrices.cpp:32</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_a8bbed1516a6d7e1b00f660dd54e232c1"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a></div><div class="ttdeci">const unsigned NumberOfLayers</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00042">lock_exchange_zlevel_2matrices.cpp:42</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_ae8687ac9f3e6cab8f2e98e121ca69bb8"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a></div><div class="ttdeci">const double hRest[20]</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00045">lock_exchange_zlevel_2matrices.cpp:45</a></div></div>
<div class="ttc" id="anamespacefemus_html_a7216a0536acdac46863fd54b0320a8e6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">femus::s</a></div><div class="ttdeci">double * s</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dc5/_f_s_i_time_dependent_assembly_supg_g_c_l_8hpp_source.html#l00036">FSITimeDependentAssemblySupgGCL.hpp:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5d7ff4fee461c0603de22f0a74f2db26" name="a5d7ff4fee461c0603de22f0a74f2db26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5d7ff4fee461c0603de22f0a74f2db26">&#9670;&#160;</a></span>ETDvh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ETDvh </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00184">184</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  184</span>                                          {</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>&amp; NLayers = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>;</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  adept::Stack&amp; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> = <a class="code hl_variable" href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span>  <a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a>* mlPdeSys  = &amp;ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a>&gt; ( <span class="stringliteral">&quot;SWhv&quot;</span> ); <span class="comment">// pointer to the linear implicit system named &quot;Poisson&quot;</span></div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>  <span class="keywordtype">unsigned</span> level = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1u;</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* msh = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> ( level ); <span class="comment">// pointer to the mesh (level) object</span></div>
<div class="line"><span class="lineno">  195</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>* el = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;  <span class="comment">// pointer to the elem object in msh (level)</span></div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>* mlSol = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;  <span class="comment">// pointer to the multilevel solution object</span></div>
<div class="line"><span class="lineno">  198</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>* sol = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a> ( level ); <span class="comment">// pointer to the solution (level) object</span></div>
<div class="line"><span class="lineno">  199</span> </div>
<div class="line"><span class="lineno">  200</span>  <a class="code hl_class" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>* pdeSys = mlPdeSys-&gt;_LinSolver[level]; <span class="comment">// pointer to the equation (level) object</span></div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  <a class="code hl_class" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a>* <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;  <span class="comment">// pointer to the global stifness matrix object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  203</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* RES = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>; <span class="comment">// pointer to the global residual vector object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  204</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* EPS = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a7f79930715e7e6c8b0ec81ee506a4ef0">_EPS</a>; <span class="comment">// pointer to the global residual vector object in pdeSys (level)</span></div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>(); <span class="comment">// get the domain dimension of the problem</span></div>
<div class="line"><span class="lineno">  207</span> </div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  209</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>  <span class="comment">//solution variable</span></div>
<div class="line"><span class="lineno">  213</span>  std::vector &lt; unsigned &gt; solIndexh ( NLayers );</div>
<div class="line"><span class="lineno">  214</span>  std::vector &lt; unsigned &gt; solPdeIndexh ( NLayers );</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>  std::vector &lt; unsigned &gt; solIndexv ( NLayers );</div>
<div class="line"><span class="lineno">  217</span>  std::vector &lt; unsigned &gt; solPdeIndexv ( NLayers );</div>
<div class="line"><span class="lineno">  218</span> </div>
<div class="line"><span class="lineno">  219</span>  <span class="comment">//std::vector &lt; unsigned &gt; solIndexHT ( NLayers );</span></div>
<div class="line"><span class="lineno">  220</span>  <span class="comment">//std::vector &lt; unsigned &gt; solPdeIndexHT ( NLayers );</span></div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>  std::vector &lt; unsigned &gt; solIndexT ( NLayers );</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>  vector&lt; int &gt; l2GMapRow; <span class="comment">// local to global mapping</span></div>
<div class="line"><span class="lineno">  226</span>  vector&lt; int &gt; l2GMapColumn; <span class="comment">// local to global mapping</span></div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; NLayers; i++ ) {</div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordtype">char</span> name[10];</div>
<div class="line"><span class="lineno">  230</span>    sprintf ( name, <span class="stringliteral">&quot;h%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  231</span>    solIndexh[i] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( name ); <span class="comment">// get the position of &quot;hi&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  232</span>    solPdeIndexh[i] = mlPdeSys-&gt;GetSolPdeIndex ( name ); <span class="comment">// get the position of &quot;hi&quot; in the pdeSys object</span></div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    sprintf ( name, <span class="stringliteral">&quot;v%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  235</span>    solIndexv[i] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( name ); <span class="comment">// get the position of &quot;vi&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  236</span>    solPdeIndexv[i] = mlPdeSys-&gt;GetSolPdeIndex ( name ); <span class="comment">// get the position of &quot;vi&quot; in the pdeSys object</span></div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>    <span class="comment">//sprintf ( name, &quot;HT%d&quot;, i );</span></div>
<div class="line"><span class="lineno">  239</span>    <span class="comment">//solIndexHT[i] = mlSol-&gt;GetIndex ( name ); // get the position of &quot;Ti&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  240</span>    <span class="comment">//solPdeIndexHT[i] = mlPdeSys-&gt;GetSolPdeIndex ( name ); // get the position of &quot;Ti&quot; in the pdeSys object</span></div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>    sprintf ( name, <span class="stringliteral">&quot;T%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  243</span>    solIndexT[i] = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( name ); <span class="comment">// get the position of &quot;Ti&quot; in the sol object</span></div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>  }</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  <span class="keywordtype">unsigned</span> solTypeh = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> ( solIndexh[0] ); <span class="comment">// get the finite element type for &quot;hi&quot;</span></div>
<div class="line"><span class="lineno">  248</span>  <span class="keywordtype">unsigned</span> solTypev = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> ( solIndexv[0] ); <span class="comment">// get the finite element type for &quot;vi&quot;</span></div>
<div class="line"><span class="lineno">  249</span>  <span class="keywordtype">unsigned</span> solTypeT = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> ( solIndexT[0] ); <span class="comment">// get the finite element type for &quot;Ti&quot;</span></div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>  <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;zero();</div>
<div class="line"><span class="lineno">  252</span>  RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  MatSetOption ( ( <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="../../da/dcf/classfemus_1_1_petsc_matrix.html">PetscMatrix</a>*<span class="keyword">&gt;</span> ( <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> ) )-&gt;mat(), MAT_NEW_NONZERO_ALLOCATION_ERR, PETSC_FALSE );</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span><span class="comment">//   for ( unsigned k = 0; k &lt; NumberOfLayers; k++ ) {</span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">//     for ( unsigned i =  msh-&gt;_dofOffset[solTypeHT][iproc]; i &lt;  msh-&gt;_dofOffset[solTypeHT][iproc + 1]; i++ ) {</span></div>
<div class="line"><span class="lineno">  258</span><span class="comment">//       double valueT = ( *sol-&gt;_Sol[solIndexT[k]] ) ( i );</span></div>
<div class="line"><span class="lineno">  259</span><span class="comment">//       double valueH = ( *sol-&gt;_Sol[solIndexh[k]] ) ( i );</span></div>
<div class="line"><span class="lineno">  260</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  261</span><span class="comment">//       double valueHT = valueT * valueH;</span></div>
<div class="line"><span class="lineno">  262</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  263</span><span class="comment">//       sol-&gt;_Sol[solIndexHT[k]]-&gt;set ( i, valueHT );</span></div>
<div class="line"><span class="lineno">  264</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  265</span><span class="comment">//     sol-&gt;_Sol[solIndexHT[k]]-&gt;close();</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>  <span class="keywordtype">unsigned</span> start = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeh][iproc];</div>
<div class="line"><span class="lineno">  269</span>  <span class="keywordtype">unsigned</span> end = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypeh][iproc + 1];</div>
<div class="line"><span class="lineno">  270</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i =  start; i &lt;  end; i++ ) {</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    vector &lt; adept::adouble &gt; solhm ( NLayers );</div>
<div class="line"><span class="lineno">  273</span>    vector &lt; adept::adouble &gt; solh ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  274</span>    vector &lt; adept::adouble &gt; solhp ( NLayers );</div>
<div class="line"><span class="lineno">  275</span>    vector &lt; adept::adouble &gt; solvm ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  276</span>    vector &lt; adept::adouble &gt; solvp ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  277</span>    <span class="comment">//vector &lt; adept::adouble &gt; solHTm ( NLayers ); // local coordinates</span></div>
<div class="line"><span class="lineno">  278</span>    <span class="comment">//vector &lt; adept::adouble &gt; solHT ( NLayers ); // local coordinates</span></div>
<div class="line"><span class="lineno">  279</span>    <span class="comment">//vector &lt; adept::adouble &gt; solHTp ( NLayers ); // local coordinates</span></div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    vector&lt; adept::adouble &gt; aResh ( NLayers );</div>
<div class="line"><span class="lineno">  282</span>    vector&lt; adept::adouble &gt; aResv ( NLayers );</div>
<div class="line"><span class="lineno">  283</span>    <span class="comment">//vector&lt; adept::adouble &gt; aResHT ( NLayers );</span></div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    <span class="keywordtype">unsigned</span> bc1 = ( i == start ) ? 0 : 1;</div>
<div class="line"><span class="lineno">  286</span>    <span class="keywordtype">unsigned</span> bc2 = ( i == end - 1 ) ? 0 : 1;</div>
<div class="line"><span class="lineno">  287</span> </div>
<div class="line"><span class="lineno">  288</span>    l2GMapRow.resize ( NLayers );</div>
<div class="line"><span class="lineno">  289</span>    l2GMapColumn.resize ( ( 3 + bc1 + bc2 ) * NLayers );</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    std::fill ( aResh.begin(), aResh.end(), 0 ); <span class="comment">//set aRes to zero</span></div>
<div class="line"><span class="lineno">  292</span>    <span class="comment">//std::fill ( aResHT.begin(), aResHT.end(), 0 ); //set aRes to zero</span></div>
<div class="line"><span class="lineno">  293</span> </div>
<div class="line"><span class="lineno">  294</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; NLayers; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>      solh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  297</span>      <span class="comment">//solHT[j] = ( *sol-&gt;_Sol[solIndexHT[j]] ) ( i );</span></div>
<div class="line"><span class="lineno">  298</span>      l2GMapRow[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  299</span>      <span class="comment">//l2GMapRow[NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i );</span></div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>      l2GMapColumn[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  302</span>      <span class="comment">//l2GMapColumn[NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i );</span></div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>      solvm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  305</span>      solvp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i + 1 );</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>      l2GMapColumn[1 * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  308</span>      l2GMapColumn[2 * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 1, i );</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>      <span class="keywordflow">if</span> ( i &gt; start ) {</div>
<div class="line"><span class="lineno">  311</span>        solhm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i - 1 );</div>
<div class="line"><span class="lineno">  312</span>        <span class="comment">//solHTm[j] = ( *sol-&gt;_Sol[solIndexHT[j]] ) ( i - 1 );</span></div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>        l2GMapColumn[3 * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i - 1 );</div>
<div class="line"><span class="lineno">  315</span>        <span class="comment">//l2GMapColumn[5 * NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i - 1 );</span></div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>      }</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>      <span class="keywordflow">if</span> ( i &lt; end - 1 ) {</div>
<div class="line"><span class="lineno">  320</span>        solhp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i + 1 );</div>
<div class="line"><span class="lineno">  321</span>        <span class="comment">//solHTp[j] = ( *sol-&gt;_Sol[solIndexHT[j]] ) ( i + 1 );</span></div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>        l2GMapColumn[ ( 3 + bc1 ) * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i + 1 );</div>
<div class="line"><span class="lineno">  324</span>        <span class="comment">//l2GMapColumn[ ( 5 + 2 * bc1 ) * NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i + 1 );</span></div>
<div class="line"><span class="lineno">  325</span>      }</div>
<div class="line"><span class="lineno">  326</span>    }</div>
<div class="line"><span class="lineno">  327</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.new_recording();</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>    vector &lt; double &gt; x ( 2 ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  330</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 2; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  331</span>      <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> ( <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, i, 2 ); <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  332</span>      x[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0] ) ( xDof ); <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  333</span>    }</div>
<div class="line"><span class="lineno">  334</span>    <span class="keywordtype">double</span> dx = x[1] - x[0];</div>
<div class="line"><span class="lineno">  335</span> </div>
<div class="line"><span class="lineno">  336</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = 20; <span class="comment">//( H_shelf + H_0 / 2 * (1 + tanh(hh / phi)) );</span></div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>    <span class="keywordtype">double</span> hTot = 0.;</div>
<div class="line"><span class="lineno">  339</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  340</span>      hTot += solh[k].value();</div>
<div class="line"><span class="lineno">  341</span>    }</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>    std::vector &lt; double &gt; hALE ( NLayers, 0. );</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>    hALE[0] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[0] + ( hTot - <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> );</div>
<div class="line"><span class="lineno">  346</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 1; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  347</span>      hALE[k] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[k];</div>
<div class="line"><span class="lineno">  348</span>    }</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>    std::vector &lt; double &gt; w ( NLayers + 1, 0. );</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span><span class="comment">//     for ( unsigned k = NLayers; k &gt; 1; k-- ) {</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment">//       w[k - 1] = w[k] - ( 0.5 * ( solh[k - 1].value() + solhp[k - 1].value() ) * solvp[k - 1].value()</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">//                           - 0.5 * ( solh[k - 1].value() + solhm[k - 1].value() ) * solvm[k - 1].value() ) / dx</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment">//                  - ( hALE[k - 1] - solh[k - 1].value() ) / dt; //TODO</span></div>
<div class="line"><span class="lineno">  356</span><span class="comment">//       //std::cout&lt;&lt;&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;&lt;&lt;w[k-1]&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  358</span>    </div>
<div class="line"><span class="lineno">  359</span>    </div>
<div class="line"><span class="lineno">  360</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = NLayers; k &gt; 1; k-- ) {</div>
<div class="line"><span class="lineno">  361</span>      w[k - 1] = w[k] - ( hALE[k - 1] - solh[k - 1].value()) / <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>; </div>
<div class="line"><span class="lineno">  362</span>      <span class="keywordflow">if</span>(bc2){ </div>
<div class="line"><span class="lineno">  363</span>        w[k - 1] -=   0.5 * ( solh[k - 1].value() + solhp[k - 1].value() ) * solvp[k - 1].value() /dx;</div>
<div class="line"><span class="lineno">  364</span>      }</div>
<div class="line"><span class="lineno">  365</span>      <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  366</span>        <span class="comment">//w[k - 1] -=   solh[k - 1] * 0. /dx;  </span></div>
<div class="line"><span class="lineno">  367</span>      }</div>
<div class="line"><span class="lineno">  368</span>      <span class="keywordflow">if</span>(bc1){</div>
<div class="line"><span class="lineno">  369</span>        w[k - 1] +=   0.5 * ( solh[k - 1].value() + solhm[k - 1].value() ) * solvm[k - 1].value() /dx;</div>
<div class="line"><span class="lineno">  370</span>      }</div>
<div class="line"><span class="lineno">  371</span>      <span class="keywordflow">else</span>{</div>
<div class="line"><span class="lineno">  372</span>        <span class="comment">//w[k - 1] +=   solh[k - 1] * 0. /dx;   </span></div>
<div class="line"><span class="lineno">  373</span>      }</div>
<div class="line"><span class="lineno">  374</span>      <span class="comment">//std::cout&lt;&lt; w[k-1] &lt;&lt; &quot; &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  375</span>    }</div>
<div class="line"><span class="lineno">  376</span>    </div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span><span class="comment">//     for(unsigned k = 1; k &lt; NLayers; k++){</span></div>
<div class="line"><span class="lineno">  379</span><span class="comment">//       w[k] = w[k-1] + (  0.5 * ( solh[k-1].value() + solhp[k-1].value() ) * solvp[k-1].value()</span></div>
<div class="line"><span class="lineno">  380</span><span class="comment">//                     - 0.5 * ( solh[k-1].value() + solhm[k-1].value() ) * solvm[k-1].value() )/dx</span></div>
<div class="line"><span class="lineno">  381</span><span class="comment">//                  + ( hALE[k-1] - solh[k-1].value()) / dt;//TODO</span></div>
<div class="line"><span class="lineno">  382</span><span class="comment">//                  //std::cout&lt;&lt;&quot;AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA&quot;&lt;&lt;w[k-1]&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  383</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span> </div>
<div class="line"><span class="lineno">  386</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>      <span class="keywordflow">if</span> ( i &gt; start ) {</div>
<div class="line"><span class="lineno">  389</span>        aResh[k] += 0.5 * ( solhm[k] + solh[k] ) * solvm[k] / dx;</div>
<div class="line"><span class="lineno">  390</span>      }</div>
<div class="line"><span class="lineno">  391</span>      <span class="keywordflow">if</span> ( i &lt; end - 1 ) {</div>
<div class="line"><span class="lineno">  392</span>        aResh[k] -= 0.5 * ( solh[k] + solhp[k] ) * solvp[k] / dx;</div>
<div class="line"><span class="lineno">  393</span>      }</div>
<div class="line"><span class="lineno">  394</span>      aResh[k] += w[k + 1] - w[k];</div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span><span class="comment">//       if ( i &gt; start ) {</span></div>
<div class="line"><span class="lineno">  398</span><span class="comment">//         //aResHT[k] += 0.5 * (solHTm[k] + solHT[k]) * solvm[k]  / dx; //second order</span></div>
<div class="line"><span class="lineno">  399</span><span class="comment">//         if ( solvm[k] &gt; 0 ) {</span></div>
<div class="line"><span class="lineno">  400</span><span class="comment">//           aResHT[k] += solHTm[k] * solvm[k].value()  / dx;</span></div>
<div class="line"><span class="lineno">  401</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  402</span><span class="comment">//         else {</span></div>
<div class="line"><span class="lineno">  403</span><span class="comment">//           aResHT[k] += solHT[k] * solvm[k].value()  / dx;</span></div>
<div class="line"><span class="lineno">  404</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  405</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  406</span><span class="comment">//       if ( i &lt; end - 1 ) {</span></div>
<div class="line"><span class="lineno">  407</span><span class="comment">//         //aResHT[k] -= 0.5 * (solHT[k] + solHTp[k]) * solvp[k]  / dx; //second order</span></div>
<div class="line"><span class="lineno">  408</span><span class="comment">//         if ( solvp[k] &gt; 0 ) {</span></div>
<div class="line"><span class="lineno">  409</span><span class="comment">//           aResHT[k] -= solHT[k] * solvp[k].value()  / dx; //first order upwind</span></div>
<div class="line"><span class="lineno">  410</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  411</span><span class="comment">//         else {</span></div>
<div class="line"><span class="lineno">  412</span><span class="comment">//           aResHT[k] -= solHTp[k] * solvp[k].value()  / dx; //first order upwind</span></div>
<div class="line"><span class="lineno">  413</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  414</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  415</span> </div>
<div class="line"><span class="lineno">  416</span><span class="comment">//       if ( i &gt; start ) {</span></div>
<div class="line"><span class="lineno">  417</span><span class="comment">//         aResHT[k] += 0.5 * ( solHTm[k] + solHT[k] ) * solvm[k] / dx;</span></div>
<div class="line"><span class="lineno">  418</span><span class="comment">//         if ( solvm[k] &gt; 0 ) {</span></div>
<div class="line"><span class="lineno">  419</span><span class="comment">//           if ( i &gt; start + 1 ) {</span></div>
<div class="line"><span class="lineno">  420</span><span class="comment">//             aResHT[k] += - 1. / 6. * ( solHT[k] - 2.*solHTm[k] + solHTmm[k] ) * solvm[k]  / dx;</span></div>
<div class="line"><span class="lineno">  421</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  422</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  423</span><span class="comment">//         else {</span></div>
<div class="line"><span class="lineno">  424</span><span class="comment">//           if ( i &lt; end - 1 ) {</span></div>
<div class="line"><span class="lineno">  425</span><span class="comment">//             aResHT[k] += - 1. / 6. * ( solHTp[k] - 2.*solHT[k] + solHTm[k] ) * solvm[k]  / dx;</span></div>
<div class="line"><span class="lineno">  426</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  427</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  428</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  429</span> </div>
<div class="line"><span class="lineno">  430</span><span class="comment">//       if ( i &lt; end - 1 ) {</span></div>
<div class="line"><span class="lineno">  431</span><span class="comment">//         aResHT[k] -= 0.5 * ( solHTp[k] + solHT[k] ) * solvp[k] / dx;</span></div>
<div class="line"><span class="lineno">  432</span><span class="comment">//         if ( solvp[k] &gt; 0 ) {</span></div>
<div class="line"><span class="lineno">  433</span><span class="comment">//           if (i &gt; start) {</span></div>
<div class="line"><span class="lineno">  434</span><span class="comment">//             aResHT[k] -= - 1. / 6. * ( solHTp[k] - 2.*solHT[k] + solHTm[k] ) * solvp[k]  / dx;</span></div>
<div class="line"><span class="lineno">  435</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  436</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  437</span><span class="comment">//         else {</span></div>
<div class="line"><span class="lineno">  438</span><span class="comment">//           if ( i &lt; end - 2 ) {</span></div>
<div class="line"><span class="lineno">  439</span><span class="comment">//             aResHT[k] -= - 1. / 6. * ( solHTpp[k] - 2.*solHTp[k] + solHT[k] ) * solvp[k]  / dx;</span></div>
<div class="line"><span class="lineno">  440</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  441</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  442</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span><span class="comment">//       if ( k &lt; NLayers - 1 ) {</span></div>
<div class="line"><span class="lineno">  445</span><span class="comment">//         aResHT[k] += w[k + 1] * 0.5 * ( solHT[k] / solh[k].value() + solHT[k + 1] / solh[k + 1].value() );</span></div>
<div class="line"><span class="lineno">  446</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  447</span><span class="comment">//       if ( k &gt; 0 ) {</span></div>
<div class="line"><span class="lineno">  448</span><span class="comment">//         aResHT[k] -= w[k] * 0.5 * ( solHT[k - 1] / solh[k - 1].value() + solHT[k] / solh[k].value() );</span></div>
<div class="line"><span class="lineno">  449</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span><span class="comment">//       aResHT[k] += ((solhp[k] - solhm[k]) * k_h * (solHTp[k] - solHTm[k])) / (dx*dx); // horizontal diffusion</span></div>
<div class="line"><span class="lineno">  452</span><span class="comment">//       aResHT[k] += k_h * solh[k] * (solHTm[k] - solHT[k])/(dx*dx); // horizontal diffusion</span></div>
<div class="line"><span class="lineno">  453</span><span class="comment">//       aResHT[k] += k_h * solh[k] * (solHTp[k] - solHT[k])/(dx*dx); // horizontal diffusion</span></div>
<div class="line"><span class="lineno">  454</span> </div>
<div class="line"><span class="lineno">  455</span>    }</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>    vector&lt; double &gt; Res ( NLayers ); <span class="comment">// local redidual vector</span></div>
<div class="line"><span class="lineno">  458</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  459</span>      Res[k] =  aResh[k].value();</div>
<div class="line"><span class="lineno">  460</span>      <span class="comment">//Res[NLayers + k] =  aResHT[k].value();</span></div>
<div class="line"><span class="lineno">  461</span>      <span class="comment">//std::cout&lt;&lt; &quot;Res[&quot;&lt;&lt;k&lt;&lt;&quot;] = &quot; &lt;&lt; Res[k] &lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  462</span>      <span class="comment">//std::cout&lt;&lt; &quot;Res[&quot;&lt;&lt;NLayers+k&lt;&lt;&quot;] = &quot; &lt;&lt; Res[NLayers+k] &lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  463</span>    }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>    RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a> ( Res, l2GMapRow );</div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.dependent ( &amp;aResh[0], NLayers );</div>
<div class="line"><span class="lineno">  468</span>    <span class="comment">//s.dependent ( &amp;aResHT[0], NLayers );</span></div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>    <span class="comment">// define the independent variables</span></div>
<div class="line"><span class="lineno">  471</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solh[0], NLayers );</div>
<div class="line"><span class="lineno">  472</span>    <span class="comment">//s.independent ( &amp;solHT[0], NLayers );</span></div>
<div class="line"><span class="lineno">  473</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solvm[0], NLayers );</div>
<div class="line"><span class="lineno">  474</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solvp[0], NLayers );</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">if</span> ( i &gt; start ) {</div>
<div class="line"><span class="lineno">  476</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solhm[0], NLayers );</div>
<div class="line"><span class="lineno">  477</span>      <span class="comment">//s.independent ( &amp;solHTm[0], NLayers );</span></div>
<div class="line"><span class="lineno">  478</span>    }</div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">if</span> ( i &lt; end - 1 ) {</div>
<div class="line"><span class="lineno">  480</span>      <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solhp[0], NLayers );</div>
<div class="line"><span class="lineno">  481</span>      <span class="comment">//s.independent ( &amp;solHTp[0], NLayers );</span></div>
<div class="line"><span class="lineno">  482</span>    }</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>    <span class="comment">// get the jacobian matrix (ordered by row major )</span></div>
<div class="line"><span class="lineno">  485</span>    vector &lt; double &gt; Jac ( NLayers * NLayers * ( 3 + bc1 + bc2 ) );</div>
<div class="line"><span class="lineno">  486</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.jacobian ( &amp;Jac[0], <span class="keyword">true</span> );</div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span>    <span class="comment">//store K in the global matrix KK</span></div>
<div class="line"><span class="lineno">  489</span>    <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked ( Jac, l2GMapRow, l2GMapColumn );</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_independents();</div>
<div class="line"><span class="lineno">  492</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_dependents();</div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>  }</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>  start = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypev][iproc] + 1;</div>
<div class="line"><span class="lineno">  499</span>  end = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[solTypev][iproc + 1] - 1;</div>
<div class="line"><span class="lineno">  500</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i =  start; i &lt;  end; i++ ) {</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>    vector &lt; adept::adouble &gt; solhm ( NLayers );</div>
<div class="line"><span class="lineno">  503</span>    vector &lt; adept::adouble &gt; solhp ( NLayers );</div>
<div class="line"><span class="lineno">  504</span>    vector &lt; adept::adouble &gt; solvm ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  505</span>    vector &lt; adept::adouble &gt; solv ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  506</span>    vector &lt; adept::adouble &gt; solvp ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  507</span>    vector &lt; double &gt; solTm ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  508</span>    vector &lt; double &gt; solTp ( NLayers ); <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  509</span> </div>
<div class="line"><span class="lineno">  510</span>    <span class="comment">//vector&lt; adept::adouble &gt; aResh ( NLayers );</span></div>
<div class="line"><span class="lineno">  511</span>    vector&lt; adept::adouble &gt; aResv ( NLayers );</div>
<div class="line"><span class="lineno">  512</span>    <span class="comment">//vector&lt; adept::adouble &gt; aResHT ( NLayers );</span></div>
<div class="line"><span class="lineno">  513</span> </div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>    l2GMapRow.resize ( NLayers );</div>
<div class="line"><span class="lineno">  516</span>    l2GMapColumn.resize ( 5 * NLayers );</div>
<div class="line"><span class="lineno">  517</span> </div>
<div class="line"><span class="lineno">  518</span>    std::fill ( aResv.begin(), aResv.end(), 0 ); <span class="comment">//set aRes to zero</span></div>
<div class="line"><span class="lineno">  519</span> </div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; NLayers; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>      solv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  523</span>      l2GMapRow[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  524</span>      l2GMapColumn[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>      solvm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i - 1 );</div>
<div class="line"><span class="lineno">  527</span>      solvp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i + 1 );</div>
<div class="line"><span class="lineno">  528</span>      l2GMapColumn[1 * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i - 1 );</div>
<div class="line"><span class="lineno">  529</span>      l2GMapColumn[2 * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexv[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 1, i );</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span> </div>
<div class="line"><span class="lineno">  532</span>      solhm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i - 1 );</div>
<div class="line"><span class="lineno">  533</span>      solTm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i - 1 );</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>      l2GMapColumn[3 * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i - 1 );</div>
<div class="line"><span class="lineno">  536</span>      <span class="comment">//l2GMapColumn[4 * NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i - 1 );</span></div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>      solhp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]  = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  539</span>      solTp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexT[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]] ) ( i );</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>      l2GMapColumn[4 * NLayers + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a> ( solIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], solPdeIndexh[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>], 0, i );</div>
<div class="line"><span class="lineno">  542</span>      <span class="comment">//l2GMapColumn[6 * NLayers + j] = pdeSys-&gt;GetSystemDof ( solIndexHT[j], solPdeIndexHT[j], 0, i );</span></div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>    }</div>
<div class="line"><span class="lineno">  545</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.new_recording();</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span>    std::vector &lt;double&gt; xm ( 2 );</div>
<div class="line"><span class="lineno">  548</span>    std::vector &lt;double&gt; xp ( 2 );</div>
<div class="line"><span class="lineno">  549</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 2; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  550</span>      <span class="keywordtype">unsigned</span> xDofm  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> ( <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, i - 1, 2 ); <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  551</span>      xm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0] ) ( xDofm ); <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>      <span class="keywordtype">unsigned</span> xDofp  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> ( <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>, i, 2 ); <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  554</span>      xp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = ( *msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0] ) ( xDofp ); <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  555</span>    }</div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordtype">double</span> dxm = xm[1] - xm[0];</div>
<div class="line"><span class="lineno">  557</span>    <span class="keywordtype">double</span> dxp = xp[1] - xp[0];</div>
<div class="line"><span class="lineno">  558</span> </div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordtype">double</span> bm = 20; <span class="comment">//( H_shelf + H_0 / 2 * (1 + tanh(hhm / phi)) );</span></div>
<div class="line"><span class="lineno">  560</span> </div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordtype">double</span> bp = 20; <span class="comment">//( H_shelf + H_0 / 2 * (1 + tanh(hhp / phi)) );</span></div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>    <span class="keywordtype">double</span> hTotm = 0.;</div>
<div class="line"><span class="lineno">  564</span>    <span class="keywordtype">double</span> hTotp = 0.;</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d3/de5/_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> = 0.2;</div>
<div class="line"><span class="lineno">  567</span>    <span class="comment">//double TRef[2] = {30,5};</span></div>
<div class="line"><span class="lineno">  568</span>    <span class="keywordtype">double</span> TRef = 5.;</div>
<div class="line"><span class="lineno">  569</span> </div>
<div class="line"><span class="lineno">  570</span>    std::vector &lt; adept::adouble &gt; Pm ( NLayers );</div>
<div class="line"><span class="lineno">  571</span>    std::vector &lt; adept::adouble &gt; Pp ( NLayers );</div>
<div class="line"><span class="lineno">  572</span>    std::vector &lt; adept::adouble &gt; zMidm ( NLayers );</div>
<div class="line"><span class="lineno">  573</span>    std::vector &lt; adept::adouble &gt; zMidp ( NLayers );</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  576</span>      hTotm += solhm[k].value();</div>
<div class="line"><span class="lineno">  577</span>      hTotp += solhp[k].value();</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>      adept::adouble rhokm = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a>[k] - <a class="code hl_variable" href="../../d3/de5/_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> * ( solTm[k] - TRef );</div>
<div class="line"><span class="lineno">  580</span>      adept::adouble rhokp = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a>[k] - <a class="code hl_variable" href="../../d3/de5/_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> * ( solTp[k] - TRef );</div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>      Pm[k] = 9.81 * rhokm * solhm[k] / 2.;</div>
<div class="line"><span class="lineno">  583</span>      Pp[k] = 9.81 * rhokp * solhp[k] / 2.;</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>      zMidm[k] = -bm + solhm[k] / 2.;</div>
<div class="line"><span class="lineno">  586</span>      zMidp[k] = -bp + solhp[k] / 2.;</div>
<div class="line"><span class="lineno">  587</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = k + 1; i &lt; NLayers; i++ ) {</div>
<div class="line"><span class="lineno">  588</span>        zMidm[k] += solhm[i];</div>
<div class="line"><span class="lineno">  589</span>        zMidp[k] += solhp[i];</div>
<div class="line"><span class="lineno">  590</span>      }</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>      Pm[k] += 0.5 * ( rhokm + rhokp ) * 9.81 * zMidm[k];</div>
<div class="line"><span class="lineno">  593</span>      Pp[k] += 0.5 * ( rhokm + rhokp ) * 9.81 * zMidp[k];</div>
<div class="line"><span class="lineno">  594</span>      <span class="comment">//Pm[k] = - rhokm * 9.81 * bm; // bottom topography</span></div>
<div class="line"><span class="lineno">  595</span>      <span class="comment">//Pp[k] = - rhokp * 9.81 * bp; // bottom topography</span></div>
<div class="line"><span class="lineno">  596</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; k; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  597</span>        adept::adouble rhojm = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - <a class="code hl_variable" href="../../d3/de5/_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> * ( solTm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - TRef );</div>
<div class="line"><span class="lineno">  598</span>        adept::adouble rhojp = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a>[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - <a class="code hl_variable" href="../../d3/de5/_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> * ( solTp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - TRef );</div>
<div class="line"><span class="lineno">  599</span>        <span class="comment">//for( unsigned j = 0; j &lt; NLayers; j++){</span></div>
<div class="line"><span class="lineno">  600</span>        <span class="comment">//BEGIN Isopycnal Pressure</span></div>
<div class="line"><span class="lineno">  601</span>        <span class="comment">//adept::adouble rhojm = (j &lt;= k) ? (rho1[j] - beta * (solHTm[j]/solhm[j] - TRef)) : rhokm;</span></div>
<div class="line"><span class="lineno">  602</span>        <span class="comment">//adept::adouble rhojp = (j &lt;= k) ? (rho1[j] - beta * (solHTp[j]/solhp[j] - TRef)) : rhokp;</span></div>
<div class="line"><span class="lineno">  603</span>        <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  604</span>        <span class="comment">//BEGIN Modified Isopycnal Pressure</span></div>
<div class="line"><span class="lineno">  605</span><span class="comment">//       adept::adouble rhojm;</span></div>
<div class="line"><span class="lineno">  606</span><span class="comment">//       adept::adouble rhojp;</span></div>
<div class="line"><span class="lineno">  607</span><span class="comment">//       if (j&lt;k){</span></div>
<div class="line"><span class="lineno">  608</span><span class="comment">//         rhojm = (rho1[j] - beta * solHTm[j]/solhm[j] - TRef) * rhokm/1024;</span></div>
<div class="line"><span class="lineno">  609</span><span class="comment">//         rhojp = (rho1[j] - beta * solHTp[j]/solhp[j] - TRef) * rhokp/1024;</span></div>
<div class="line"><span class="lineno">  610</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  611</span><span class="comment">//       else if (j==k){</span></div>
<div class="line"><span class="lineno">  612</span><span class="comment">//         rhojm = 0.5 * rhokm/1024 * (rhokm + (rhokm+rhokp)/2);</span></div>
<div class="line"><span class="lineno">  613</span><span class="comment">//         rhojp = 0.5 * rhokp/1024 * (rhokp + (rhokm+rhokp)/2);</span></div>
<div class="line"><span class="lineno">  614</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  615</span><span class="comment">//       else{</span></div>
<div class="line"><span class="lineno">  616</span><span class="comment">//         rhojm = (rho1[j] - beta * solHTm[j]/solhm[j] - TRef) * rhokm/1024 * (rhokm+rhokp)/2;</span></div>
<div class="line"><span class="lineno">  617</span><span class="comment">//         rhojp = (rho1[j] - beta * solHTp[j]/solhp[j] - TRef) * rhokp/1024 * (rhokm+rhokp)/2;</span></div>
<div class="line"><span class="lineno">  618</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  619</span>        <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  620</span>        Pm[k] += rhojm * 9.81 * solhm[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  621</span>        Pp[k] += rhojp * 9.81 * solhp[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  622</span>        <span class="comment">//std::cout&lt;&lt;&quot;HHHHHHHHHHHHHHHHHHH &quot;&lt;&lt;j&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  623</span>        <span class="comment">//std::cout&lt;&lt;&quot;AAAAAAAAAAAAAAAAAAA &quot;&lt;&lt;rhojm&lt;&lt;&quot; , &quot;&lt;&lt;rhojp&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  624</span>      }</div>
<div class="line"><span class="lineno">  625</span>      Pm[k] /= <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a>[k];</div>
<div class="line"><span class="lineno">  626</span>      Pp[k] /= <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a>[k];</div>
<div class="line"><span class="lineno">  627</span>      <span class="comment">//std::cout&lt;&lt;&quot;BBBBBBBBBBBBBBBBBBB &quot;&lt;&lt;k&lt;&lt;&quot; , &quot;&lt;&lt;rhokm&lt;&lt;&quot; , &quot;&lt;&lt;rhokp&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  628</span>      <span class="comment">//std::cout&lt;&lt;&quot;CCCCCCCCCCCCCCCCCCC &quot;&lt;&lt;k&lt;&lt;&quot; , &quot;&lt;&lt;Pm[k]&lt;&lt;&quot; , &quot;&lt;&lt;Pp[k]&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  629</span>    }</div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>    std::vector &lt; double &gt; hALEm ( NLayers, 0. );</div>
<div class="line"><span class="lineno">  632</span>    std::vector &lt; double &gt; hALEp ( NLayers, 0. );</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>    hALEm[0] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[0] + ( hTotm - bm );</div>
<div class="line"><span class="lineno">  635</span>    hALEp[0] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[0] + ( hTotp - bp );</div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 1; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  637</span>      hALEm[k] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[k];</div>
<div class="line"><span class="lineno">  638</span>      hALEp[k] = <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[k];</div>
<div class="line"><span class="lineno">  639</span>    }</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span><span class="comment">//     std::vector &lt; double &gt; wm(NLayers+1, 0.);</span></div>
<div class="line"><span class="lineno">  642</span><span class="comment">//     std::vector &lt; double &gt; wp(NLayers+1, 0.);</span></div>
<div class="line"><span class="lineno">  643</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  644</span><span class="comment">//     for(unsigned k = NLayers; k&gt;1; k--){</span></div>
<div class="line"><span class="lineno">  645</span><span class="comment">//       wm[k-1] = wm[k] -  solhm[k-1].value() * (solv[k-1].value() - solvm[k-1].value() )/dxm - ( hALEm[k-1] - solhm[k-1].value()) / dt;</span></div>
<div class="line"><span class="lineno">  646</span><span class="comment">//       wp[k-1] = wp[k] -  solhp[k-1].value() * (solvp[k-1].value() - solv[k-1].value() )/dxp - ( hALEp[k-1] - solhp[k-1].value()) / dt;</span></div>
<div class="line"><span class="lineno">  647</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  648</span> </div>
<div class="line"><span class="lineno">  649</span>    std::vector &lt; double &gt; w ( NLayers + 1, 0. );</div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>    <span class="keywordtype">double</span> dx = 0.5 * ( dxm + dxp );</div>
<div class="line"><span class="lineno">  652</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = NLayers; k &gt; 1; k-- ) {</div>
<div class="line"><span class="lineno">  653</span>      w[k - 1] = w[k] - ( solhp[k - 1].value() * ( 0.5 * ( solv[k - 1].value() + solvp[k - 1].value() ) )</div>
<div class="line"><span class="lineno">  654</span>                          - solhm[k - 1].value() * ( 0.5 * ( solv[k - 1].value() + solvm[k - 1].value() ) ) ) / dx</div>
<div class="line"><span class="lineno">  655</span>                 - ( 0.5 * ( hALEm[k - 1] + hALEp[k - 1] )  - 0.5 * ( solhm[k - 1].value() + solhp[k - 1].value() ) ) / <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><span class="lineno">  656</span>      <span class="comment">//std::cout&lt;&lt;&quot;w in u equation&quot;&lt;&lt;w[k-1]&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>    }</div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  661</span>      adept::adouble vMidm = 0.5 * ( solvm[k] + solv[k] );</div>
<div class="line"><span class="lineno">  662</span>      adept::adouble fvm = 0.5 * vMidm * vMidm + Pm[k];</div>
<div class="line"><span class="lineno">  663</span>      aResv[k] +=  fvm / dxm;</div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>      adept::adouble vMidp = 0.5 * ( solv[k] + solvp[k] );</div>
<div class="line"><span class="lineno">  666</span>      adept::adouble fvp = 0.5 * vMidp * vMidp + Pp[k];</div>
<div class="line"><span class="lineno">  667</span>      aResv[k] -=  fvp / dxp;</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>      adept::adouble deltaZt = 0.;</div>
<div class="line"><span class="lineno">  670</span>      adept::adouble deltaZb = 0.;</div>
<div class="line"><span class="lineno">  671</span>      adept::adouble ht = 0.;</div>
<div class="line"><span class="lineno">  672</span>      adept::adouble hb = 0.;</div>
<div class="line"><span class="lineno">  673</span>      <span class="keywordflow">if</span> ( k &gt; 0 ) {</div>
<div class="line"><span class="lineno">  674</span>        ht = ( solhm[k - 1] + solhm[k] + solhp[k - 1] + solhp[k] ) / 4.;</div>
<div class="line"><span class="lineno">  675</span>        deltaZt = ( solv[k - 1] - solv[k] ) / ht;</div>
<div class="line"><span class="lineno">  676</span>        aResv[k] -= 0.5 * w[k] * deltaZt;</div>
<div class="line"><span class="lineno">  677</span>      }</div>
<div class="line"><span class="lineno">  678</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  679</span>        ht = 0.5 * ( solhm[k] + solhp[k] );</div>
<div class="line"><span class="lineno">  680</span>        deltaZt = 0.* ( 0. - solv[k] ) / ht;</div>
<div class="line"><span class="lineno">  681</span>      }</div>
<div class="line"><span class="lineno">  682</span>      <span class="keywordflow">if</span> ( k &lt; NLayers - 1 ) {</div>
<div class="line"><span class="lineno">  683</span>        hb = ( solhm[k] + solhm[k + 1] + solhp[k] + solhp[k + 1] ) / 4.;</div>
<div class="line"><span class="lineno">  684</span>        deltaZb = ( solv[k] - solv[k + 1] ) / hb;</div>
<div class="line"><span class="lineno">  685</span>        aResv[k] -= 0.5 * w[k + 1] * deltaZb;</div>
<div class="line"><span class="lineno">  686</span>      }</div>
<div class="line"><span class="lineno">  687</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  688</span>        hb = 0.5 * ( solhm[k] + solhp[k] );</div>
<div class="line"><span class="lineno">  689</span>        deltaZb = 0.* ( solv[k] - 0. ) / hb;</div>
<div class="line"><span class="lineno">  690</span>      }</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>      aResv[k] += <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#abc71ccd436cc809f06b6c7d08cbccf24">ni_h</a> * ( solvm[k] - solv[k] ) / ( dxm * 0.5 * ( dxm + dxp ) ); <span class="comment">// horizontal diffusion</span></div>
<div class="line"><span class="lineno">  693</span>      aResv[k] += <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#abc71ccd436cc809f06b6c7d08cbccf24">ni_h</a> * ( solvp[k] - solv[k] ) / ( dxp * 0.5 * ( dxm + dxp ) ); <span class="comment">// horizontal diffusion</span></div>
<div class="line"><span class="lineno">  694</span> </div>
<div class="line"><span class="lineno">  695</span>      aResv[k] += <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aec5c8799058dca0be83e5a2eed7b16f2">ni_v</a> * ( deltaZt - deltaZb ) / ( ( ht + hb ) / 2. ); <span class="comment">// vertical diffusion</span></div>
<div class="line"><span class="lineno">  696</span>    }</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>    vector&lt; double &gt; Res ( NLayers ); <span class="comment">// local redidual vector</span></div>
<div class="line"><span class="lineno">  699</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; NLayers; k++ ) {</div>
<div class="line"><span class="lineno">  700</span>      Res[k] =  aResv[k].value();</div>
<div class="line"><span class="lineno">  701</span>      <span class="comment">//std::cout&lt;&lt; &quot;Res[&quot;&lt;&lt;k&lt;&lt;&quot;] = &quot; &lt;&lt; Res[k] &lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  702</span>    }</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>    RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a> ( Res, l2GMapRow );</div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.dependent ( &amp;aResv[0], NLayers );</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>    <span class="comment">// define the independent variables</span></div>
<div class="line"><span class="lineno">  709</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solv[0], NLayers );</div>
<div class="line"><span class="lineno">  710</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solvm[0], NLayers );</div>
<div class="line"><span class="lineno">  711</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solvp[0], NLayers );</div>
<div class="line"><span class="lineno">  712</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solhm[0], NLayers );</div>
<div class="line"><span class="lineno">  713</span>    <span class="comment">//s.independent ( &amp;solHTm[0], NLayers );</span></div>
<div class="line"><span class="lineno">  714</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.independent ( &amp;solhp[0], NLayers );</div>
<div class="line"><span class="lineno">  715</span>    <span class="comment">//s.independent ( &amp;solHTp[0], NLayers );</span></div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>    <span class="comment">// get the jacobian matrix (ordered by row major )</span></div>
<div class="line"><span class="lineno">  718</span>    vector &lt; double &gt; Jac ( NLayers * NLayers * 5 );</div>
<div class="line"><span class="lineno">  719</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.jacobian ( &amp;Jac[0], <span class="keyword">true</span> );</div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>    <span class="comment">//store K in the global matrix KK</span></div>
<div class="line"><span class="lineno">  722</span>    <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;add_matrix_blocked ( Jac, l2GMapRow, l2GMapColumn );</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_independents();</div>
<div class="line"><span class="lineno">  725</span>    <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>.clear_dependents();</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>  }</div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>  RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  731</span>  <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>-&gt;close();</div>
<div class="line"><span class="lineno">  732</span> </div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span><span class="comment">//   PetscViewer    viewer;</span></div>
<div class="line"><span class="lineno">  736</span><span class="comment">//   PetscViewerDrawOpen(PETSC_COMM_WORLD,NULL,NULL,0,0,900,900,&amp;viewer);</span></div>
<div class="line"><span class="lineno">  737</span><span class="comment">//   PetscObjectSetName((PetscObject)viewer,&quot;FSI matrix&quot;);</span></div>
<div class="line"><span class="lineno">  738</span><span class="comment">//   PetscViewerPushFormat(viewer,PETSC_VIEWER_DRAW_LG);</span></div>
<div class="line"><span class="lineno">  739</span><span class="comment">//   MatView((static_cast&lt;PetscMatrix*&gt;(KK))-&gt;mat(),viewer);</span></div>
<div class="line"><span class="lineno">  740</span><span class="comment">//   double a;</span></div>
<div class="line"><span class="lineno">  741</span><span class="comment">//   std::cin&gt;&gt;a;</span></div>
<div class="line"><span class="lineno">  742</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span><span class="comment">//  abort();</span></div>
<div class="line"><span class="lineno">  745</span>  MFN mfn;</div>
<div class="line"><span class="lineno">  746</span>  Mat <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> = ( <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="../../da/dcf/classfemus_1_1_petsc_matrix.html">PetscMatrix</a>*<span class="keyword">&gt;</span> ( <a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a> ) )-&gt;mat();</div>
<div class="line"><span class="lineno">  747</span>  FN f, f1, f2, f3 , f4;</div>
<div class="line"><span class="lineno">  748</span> </div>
<div class="line"><span class="lineno">  749</span>  <span class="comment">//std::cout &lt;&lt; &quot;dt = &quot; &lt;&lt; dt &lt;&lt; &quot; dx = &quot;&lt;&lt; dx &lt;&lt; &quot; maxWaveSpeed = &quot;&lt;&lt;maxWaveSpeed &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  750</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;dt = &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>  <span class="comment">//dt = 100.;</span></div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>  Vec v = ( <span class="keyword">static_cast&lt;</span> <a class="code hl_class" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a>* <span class="keyword">&gt;</span> ( RES ) )-&gt;vec();</div>
<div class="line"><span class="lineno">  755</span>  Vec <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> = ( <span class="keyword">static_cast&lt;</span> <a class="code hl_class" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a>* <span class="keyword">&gt;</span> ( EPS ) )-&gt;vec();</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>  MFNCreate ( PETSC_COMM_WORLD, &amp;mfn );</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>  MFNSetOperator ( mfn, <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> );</div>
<div class="line"><span class="lineno">  760</span>  MFNGetFN ( mfn, &amp;f );</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>  FNPhiSetIndex ( f, 1 );</div>
<div class="line"><span class="lineno">  763</span>  FNSetType ( f, FNPHI );</div>
<div class="line"><span class="lineno">  764</span><span class="comment">// FNView(f,PETSC_VIEWER_STDOUT_WORLD);</span></div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>  FNSetScale ( f, <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>, <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> );</div>
<div class="line"><span class="lineno">  767</span>  MFNSetFromOptions ( mfn );</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>  MFNSolve ( mfn, v, <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> );</div>
<div class="line"><span class="lineno">  770</span>  MFNDestroy ( &amp;mfn );</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>  sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a0a62d3ed880efa82cb1cd4c6144cc823">UpdateSol</a> ( mlPdeSys-&gt;GetSolPdeIndex(), EPS, pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a> );</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>  <span class="keywordtype">unsigned</span> solIndexeta = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( <span class="stringliteral">&quot;eta&quot;</span> );</div>
<div class="line"><span class="lineno">  775</span>  <span class="keywordtype">unsigned</span> solIndexb = mlSol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( <span class="stringliteral">&quot;b&quot;</span> );</div>
<div class="line"><span class="lineno">  776</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexeta]-&gt;zero();</div>
<div class="line"><span class="lineno">  777</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; k++ ) {</div>
<div class="line"><span class="lineno">  778</span>    sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexeta]-&gt;add ( *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexh[k]] );</div>
<div class="line"><span class="lineno">  779</span>  }</div>
<div class="line"><span class="lineno">  780</span>  sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexeta]-&gt;add ( -1, *sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[solIndexb] );</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span><span class="comment">//   for ( unsigned k = 0; k &lt; NumberOfLayers; k++ ) {</span></div>
<div class="line"><span class="lineno">  783</span><span class="comment">//     for ( unsigned i =  msh-&gt;_dofOffset[solTypeHT][iproc]; i &lt;  msh-&gt;_dofOffset[solTypeHT][iproc + 1]; i++ ) {</span></div>
<div class="line"><span class="lineno">  784</span><span class="comment">//       double valueHT = ( *sol-&gt;_Sol[solIndexHT[k]] ) ( i );</span></div>
<div class="line"><span class="lineno">  785</span><span class="comment">//       double valueH = ( *sol-&gt;_Sol[solIndexh[k]] ) ( i );</span></div>
<div class="line"><span class="lineno">  786</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  787</span><span class="comment">//       double valueT = valueHT / valueH;</span></div>
<div class="line"><span class="lineno">  788</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  789</span><span class="comment">//       sol-&gt;_Sol[solIndexT[k]]-&gt;set ( i, valueT );</span></div>
<div class="line"><span class="lineno">  790</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  791</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  792</span><span class="comment">//     sol-&gt;_Sol[solIndexT[k]]-&gt;close();</span></div>
<div class="line"><span class="lineno">  793</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  794</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>}</div>
<div class="ttc" id="a_conformal_2ex3_2ex3_8cpp_html_a4049344c4d6020a322197047b513967f"><div class="ttname"><a href="../../d3/de5/_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a></div><div class="ttdeci">const double beta</div><div class="ttdef"><b>Definition</b> <a href="../../d3/de5/_conformal_2ex3_2ex3_8cpp_source.html#l00023">ex3.cpp:23</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_a7adc750d395e26424054cf5d3794cd87"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a7adc750d395e26424054cf5d3794cd87">rho1</a></div><div class="ttdeci">double rho1[20]</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00030">lock_exchange_zlevel_2matrices.cpp:30</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_abc71ccd436cc809f06b6c7d08cbccf24"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#abc71ccd436cc809f06b6c7d08cbccf24">ni_h</a></div><div class="ttdeci">double ni_h</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00034">lock_exchange_zlevel_2matrices.cpp:34</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_aec5c8799058dca0be83e5a2eed7b16f2"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aec5c8799058dca0be83e5a2eed7b16f2">ni_v</a></div><div class="ttdeci">double ni_v</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00036">lock_exchange_zlevel_2matrices.cpp:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aa400609e27627c072ac486290fe0c578" name="aa400609e27627c072ac486290fe0c578"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa400609e27627c072ac486290fe0c578">&#9670;&#160;</a></span>InitalValueB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double InitalValueB </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00064">64</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   64</span>                                                      {</div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordflow">return</span> 20; <span class="comment">//( H_shelf + H_0 / 2 * (1 + tanh(hh / phi)) );</span></div>
<div class="line"><span class="lineno">   66</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4e5f401ba6f89ef90709419b553449c2" name="a4e5f401ba6f89ef90709419b553449c2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4e5f401ba6f89ef90709419b553449c2">&#9670;&#160;</a></span>InitalValueH()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double InitalValueH </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00051">51</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>                                                      {</div>
<div class="line"><span class="lineno">   52</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae8687ac9f3e6cab8f2e98e121ca69bb8">hRest</a>[0];</div>
<div class="line"><span class="lineno">   53</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae45ae26f12d9a15818c6f894ca273a26" name="ae45ae26f12d9a15818c6f894ca273a26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae45ae26f12d9a15818c6f894ca273a26">&#9670;&#160;</a></span>InitalValueT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double InitalValueT </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00056">56</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   56</span>                                                      {</div>
<div class="line"><span class="lineno">   57</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="../../df/d64/_i_s_m_2ex3_2ex3_8cpp.html#a31c17cc321db72d5ab448b71ea92792f">pi</a> = acos ( -1. );</div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">//return 17.5 + 25/pi * atan(x[0]/100.);</span></div>
<div class="line"><span class="lineno">   59</span>  <span class="keywordflow">if</span> ( x[0] &lt; 0 ) <span class="keywordflow">return</span> 5;</div>
<div class="line"><span class="lineno">   60</span>  <span class="keywordflow">else</span> <span class="keywordflow">return</span> 30;</div>
<div class="line"><span class="lineno">   61</span>}</div>
<div class="ttc" id="a_i_s_m_2ex3_2ex3_8cpp_html_a31c17cc321db72d5ab448b71ea92792f"><div class="ttname"><a href="../../df/d64/_i_s_m_2ex3_2ex3_8cpp.html#a31c17cc321db72d5ab448b71ea92792f">pi</a></div><div class="ttdeci">double pi</div><div class="ttdef"><b>Definition</b> <a href="../../df/d64/_i_s_m_2ex3_2ex3_8cpp_source.html#l00044">ex3.cpp:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c511f31ed03c318ae5e8f4059130dc7" name="a3c511f31ed03c318ae5e8f4059130dc7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c511f31ed03c318ae5e8f4059130dc7">&#9670;&#160;</a></span>InitalValueV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double InitalValueV </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>                                                      {</div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   49</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a29781a20c5dd4153c3c1cecf0ff328" name="a7a29781a20c5dd4153c3c1cecf0ff328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a29781a20c5dd4153c3c1cecf0ff328">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00081">81</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   81</span>                                   {</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>  SlepcInitialize ( &amp;argc, &amp;args, PETSC_NULL, PETSC_NULL );</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  <span class="comment">// init Petsc-MPI communicator</span></div>
<div class="line"><span class="lineno">   86</span>  <a class="code hl_class" href="../../da/d5e/classfemus_1_1_femus_init.html">FemusInit</a> mpinit ( argc, args, MPI_COMM_WORLD );</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  <span class="comment">// define multilevel mesh2</span></div>
<div class="line"><span class="lineno">   89</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> mlMsh;</div>
<div class="line"><span class="lineno">   90</span>  <span class="keywordtype">double</span> scalingFactor = 1.;</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> = 1;</div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordtype">unsigned</span> numberOfSelectiveLevels = 0;</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordtype">unsigned</span> nx = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span><span class="keyword">&gt;</span> ( floor ( pow ( 2.,<span class="comment">/*11*/</span>7 ) + 0.5 ) ); <span class="comment">//Grid cell size = 0.5km</span></div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>  <span class="keywordtype">double</span> length = 64000; <span class="comment">//2 * 1465700.;</span></div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>  mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a> ( nx, 0, 0, -length / 2, length / 2, 0., 0., 0., 0., <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a>, <span class="stringliteral">&quot;seventh&quot;</span> );</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>  <span class="comment">//mlMsh.RefineMesh(numberOfUniformLevels + numberOfSelectiveLevels, numberOfUniformLevels , NULL);</span></div>
<div class="line"><span class="lineno">  102</span>  mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  103</span> </div>
<div class="line"><span class="lineno">  104</span>  <span class="comment">// define the multilevel solution and attach the mlMsh object to it</span></div>
<div class="line"><span class="lineno">  105</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> mlSol ( &amp;mlMsh );</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; i++ ) {</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordtype">char</span> name[10];</div>
<div class="line"><span class="lineno">  109</span>    sprintf ( name, <span class="stringliteral">&quot;h%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  110</span>    mlSol.AddSolution ( name, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 2);</div>
<div class="line"><span class="lineno">  111</span>    sprintf ( name, <span class="stringliteral">&quot;v%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  112</span>    mlSol.AddSolution ( name, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, 2 );</div>
<div class="line"><span class="lineno">  113</span>    sprintf ( name, <span class="stringliteral">&quot;T%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  114</span>    mlSol.AddSolution ( name, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 2);</div>
<div class="line"><span class="lineno">  115</span>    sprintf ( name, <span class="stringliteral">&quot;HT%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  116</span>    mlSol.AddSolution ( name, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 2);</div>
<div class="line"><span class="lineno">  117</span>  }</div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  mlSol.AddSolution ( <span class="stringliteral">&quot;b&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 1, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  mlSol.AddSolution ( <span class="stringliteral">&quot;eta&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 1, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  122</span> </div>
<div class="line"><span class="lineno">  123</span>  mlSol.Initialize ( <span class="stringliteral">&quot;All&quot;</span> );</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; i++ ) {</div>
<div class="line"><span class="lineno">  126</span>    <span class="keywordtype">char</span> name[10];</div>
<div class="line"><span class="lineno">  127</span>    sprintf ( name, <span class="stringliteral">&quot;v%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  128</span>    mlSol.Initialize ( name, <a class="code hl_function" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a3c511f31ed03c318ae5e8f4059130dc7">InitalValueV</a> );</div>
<div class="line"><span class="lineno">  129</span>  }</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; i++ ) {</div>
<div class="line"><span class="lineno">  132</span>    <span class="keywordtype">char</span> name[10];</div>
<div class="line"><span class="lineno">  133</span>    sprintf ( name, <span class="stringliteral">&quot;h%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  134</span>    mlSol.Initialize ( name, <a class="code hl_function" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a4e5f401ba6f89ef90709419b553449c2">InitalValueH</a> );</div>
<div class="line"><span class="lineno">  135</span>  }</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; i++ ) {</div>
<div class="line"><span class="lineno">  138</span>    <span class="keywordtype">char</span> name[10];</div>
<div class="line"><span class="lineno">  139</span>    sprintf ( name, <span class="stringliteral">&quot;T%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  140</span>    mlSol.Initialize ( name, <a class="code hl_function" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae45ae26f12d9a15818c6f894ca273a26">InitalValueT</a> );</div>
<div class="line"><span class="lineno">  141</span>  }</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>  mlSol.Initialize ( <span class="stringliteral">&quot;b&quot;</span>, <a class="code hl_function" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aa400609e27627c072ac486290fe0c578">InitalValueB</a> );</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  mlSol.AttachSetBoundaryConditionFunction ( <a class="code hl_function" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a> );</div>
<div class="line"><span class="lineno">  146</span>  mlSol.GenerateBdc ( <span class="stringliteral">&quot;All&quot;</span> );</div>
<div class="line"><span class="lineno">  147</span> </div>
<div class="line"><span class="lineno">  148</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob ( &amp;mlSol );</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>  <span class="comment">// ******* Add FEM system to the MultiLevel problem *******</span></div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a>&amp; system = ml_prob.add_system &lt; <a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a> &gt; ( <span class="stringliteral">&quot;SWhv&quot;</span> );</div>
<div class="line"><span class="lineno">  152</span>  <a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a>&amp; system2 = ml_prob.add_system &lt; <a class="code hl_class" href="../../da/d5b/classfemus_1_1_transient_system.html">TransientLinearImplicitSystem</a> &gt; ( <span class="stringliteral">&quot;SWt&quot;</span> );</div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a8bbed1516a6d7e1b00f660dd54e232c1">NumberOfLayers</a>; i++ ) {</div>
<div class="line"><span class="lineno">  154</span>    <span class="keywordtype">char</span> name[10];</div>
<div class="line"><span class="lineno">  155</span>    sprintf ( name, <span class="stringliteral">&quot;h%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  156</span>    system.AddSolutionToSystemPDE ( name );</div>
<div class="line"><span class="lineno">  157</span>    sprintf ( name, <span class="stringliteral">&quot;v%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  158</span>    system.AddSolutionToSystemPDE ( name );</div>
<div class="line"><span class="lineno">  159</span>    sprintf ( name, <span class="stringliteral">&quot;HT%d&quot;</span>, i );</div>
<div class="line"><span class="lineno">  160</span>    system2.AddSolutionToSystemPDE ( name );</div>
<div class="line"><span class="lineno">  161</span>  }</div>
<div class="line"><span class="lineno">  162</span>  system.init();</div>
<div class="line"><span class="lineno">  163</span>  system2.init();</div>
<div class="line"><span class="lineno">  164</span>  </div>
<div class="line"><span class="lineno">  165</span>  mlSol.SetWriter ( <a class="code hl_enumvalue" href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a> );</div>
<div class="line"><span class="lineno">  166</span>  std::vector&lt;std::string&gt; print_vars;</div>
<div class="line"><span class="lineno">  167</span>  print_vars.push_back ( <span class="stringliteral">&quot;All&quot;</span> );</div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">//mlSol.GetWriter()-&gt;SetDebugOutput(true);</span></div>
<div class="line"><span class="lineno">  169</span>  mlSol.GetWriter()-&gt;Write ( <a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;linear&quot;</span>, print_vars, 0 );</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordtype">unsigned</span> numberOfTimeSteps = 1800; <span class="comment">//17h=1020 with dt=60, 17h=10200 with dt=6</span></div>
<div class="line"><span class="lineno">  172</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; numberOfTimeSteps; i++ ) {</div>
<div class="line"><span class="lineno">  173</span>    system.<a class="code hl_function" href="../../da/d5b/classfemus_1_1_transient_system.html#a6bbd657b80c05844fca4b683c90d879e">CopySolutionToOldSolution</a>();</div>
<div class="line"><span class="lineno">  174</span>    <span class="comment">//dt = 60.;</span></div>
<div class="line"><span class="lineno">  175</span>    <a class="code hl_function" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a5d7ff4fee461c0603de22f0a74f2db26">ETDvh</a> ( ml_prob );</div>
<div class="line"><span class="lineno">  176</span>    <span class="comment">//dt = 60.;</span></div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_function" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aef6fb1f9f1bf2c50c083708d81863629">ETDt</a> ( ml_prob );</div>
<div class="line"><span class="lineno">  178</span>    mlSol.GetWriter()-&gt;Write ( <a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;linear&quot;</span>, print_vars, ( i + 1 ) / 1 );</div>
<div class="line"><span class="lineno">  179</span>  }</div>
<div class="line"><span class="lineno">  180</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  181</span>}</div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a></div><div class="ttdeci">@ EDGE3</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00008">ElemTypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a></div><div class="ttdeci">@ ZERO</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00014">FElemTypeEnum.hpp:14</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a></div><div class="ttdeci">@ DISCONTINUOUS_POLYNOMIAL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00006">FElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_af12829f27afb4207fd7c58ef847b9d8b"><div class="ttname"><a href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a></div><div class="ttdeci">#define DEFAULT_OUTPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="../../de/df8/_femus_default_8hpp_source.html#l00040">FemusDefault.hpp:40</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_a0aca793820b6ff7705450e2043256938"><div class="ttname"><a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a></div><div class="ttdeci">unsigned numberOfUniformLevels</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp_source.html#l00089">ex4.cpp:89</a></div></div>
<div class="ttc" id="a_writer_enum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition</b> <a href="../../db/d1c/_writer_enum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a09c12975f18035d5369ae411c0208648"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">femus::MultiLevelMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo()</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00462">MultiLevelMesh.cpp:462</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html_a6bbd657b80c05844fca4b683c90d879e"><div class="ttname"><a href="../../da/d5b/classfemus_1_1_transient_system.html#a6bbd657b80c05844fca4b683c90d879e">femus::TransientSystem::CopySolutionToOldSolution</a></div><div class="ttdeci">virtual void CopySolutionToOldSolution()</div><div class="ttdef"><b>Definition</b> <a href="../../de/d97/_transient_system_8cpp_source.html#l00059">TransientSystem.cpp:59</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_a3c511f31ed03c318ae5e8f4059130dc7"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a3c511f31ed03c318ae5e8f4059130dc7">InitalValueV</a></div><div class="ttdeci">double InitalValueV(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00047">lock_exchange_zlevel_2matrices.cpp:47</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_a4e5f401ba6f89ef90709419b553449c2"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a4e5f401ba6f89ef90709419b553449c2">InitalValueH</a></div><div class="ttdeci">double InitalValueH(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00051">lock_exchange_zlevel_2matrices.cpp:51</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_a5d7ff4fee461c0603de22f0a74f2db26"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#a5d7ff4fee461c0603de22f0a74f2db26">ETDvh</a></div><div class="ttdeci">void ETDvh(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00184">lock_exchange_zlevel_2matrices.cpp:184</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_aa400609e27627c072ac486290fe0c578"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aa400609e27627c072ac486290fe0c578">InitalValueB</a></div><div class="ttdeci">double InitalValueB(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00064">lock_exchange_zlevel_2matrices.cpp:64</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_ab8b0d45993b678f2b4a8aea9fff7fc87"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00069">lock_exchange_zlevel_2matrices.cpp:69</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_ae45ae26f12d9a15818c6f894ca273a26"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#ae45ae26f12d9a15818c6f894ca273a26">InitalValueT</a></div><div class="ttdeci">double InitalValueT(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00056">lock_exchange_zlevel_2matrices.cpp:56</a></div></div>
<div class="ttc" id="alock__exchange__zlevel__2matrices_8cpp_html_aef6fb1f9f1bf2c50c083708d81863629"><div class="ttname"><a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html#aef6fb1f9f1bf2c50c083708d81863629">ETDt</a></div><div class="ttdeci">void ETDt(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00802">lock_exchange_zlevel_2matrices.cpp:802</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8b0d45993b678f2b4a8aea9fff7fc87" name="ab8b0d45993b678f2b4a8aea9fff7fc87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b0d45993b678f2b4a8aea9fff7fc87">&#9670;&#160;</a></span>SetBoundaryCondition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryCondition </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>SolName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00069">69</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   69</span>                                                                                                                                        {</div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordtype">bool</span> dirichlet = <span class="keyword">false</span>; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">   71</span>  <span class="keywordflow">if</span> ( facename == 1 || facename == 2 ) dirichlet = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   72</span>  value = 0.;</div>
<div class="line"><span class="lineno">   73</span>  <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><span class="lineno">   74</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a03e28be41881b703c836edbfe9b51b17" name="a03e28be41881b703c836edbfe9b51b17"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a03e28be41881b703c836edbfe9b51b17">&#9670;&#160;</a></span>dt</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double dt = 60.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00032">32</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>

</div>
</div>
<a id="ae8687ac9f3e6cab8f2e98e121ca69bb8" name="ae8687ac9f3e6cab8f2e98e121ca69bb8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8687ac9f3e6cab8f2e98e121ca69bb8">&#9670;&#160;</a></span>hRest</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const double hRest[20] = {1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00045">45</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>

</div>
</div>
<a id="abc71ccd436cc809f06b6c7d08cbccf24" name="abc71ccd436cc809f06b6c7d08cbccf24"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abc71ccd436cc809f06b6c7d08cbccf24">&#9670;&#160;</a></span>ni_h</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ni_h = 100.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00034">34</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>

</div>
</div>
<a id="aec5c8799058dca0be83e5a2eed7b16f2" name="aec5c8799058dca0be83e5a2eed7b16f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec5c8799058dca0be83e5a2eed7b16f2">&#9670;&#160;</a></span>ni_v</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double ni_v = 0.0001</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00036">36</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>

</div>
</div>
<a id="a8bbed1516a6d7e1b00f660dd54e232c1" name="a8bbed1516a6d7e1b00f660dd54e232c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bbed1516a6d7e1b00f660dd54e232c1">&#9670;&#160;</a></span>NumberOfLayers</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const unsigned NumberOfLayers = 20</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00042">42</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>

</div>
</div>
<a id="a7adc750d395e26424054cf5d3794cd87" name="a7adc750d395e26424054cf5d3794cd87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7adc750d395e26424054cf5d3794cd87">&#9670;&#160;</a></span>rho1</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double rho1[20] = {1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000, 1000}</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html#l00030">30</a> of file <a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp_source.html">lock_exchange_zlevel_2matrices.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_2ba75da238e3fbc00509952288ee6fce.html">SW</a></li><li class="navelem"><a class="el" href="../../dir_48d8d249d200d1771e064ce38b431803.html">lock_exchange_zlevel_2matrices</a></li><li class="navelem"><a class="el" href="../../da/df4/lock__exchange__zlevel__2matrices_8cpp.html">lock_exchange_zlevel_2matrices.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
