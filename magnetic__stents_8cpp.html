<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/applications/ISM/magnetic_stents/magnetic_stents.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('magnetic__stents_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">magnetic_stents.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_numeric_vector_8hpp_source.html">NumericVector.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_fluid_8hpp_source.html">Fluid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_solid_8hpp_source.html">Solid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_parameter_8hpp_source.html">Parameter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_sparse_matrix_8hpp_source.html">SparseMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_f_elem_type_enum_8hpp_source.html">FElemTypeEnum.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_files_8hpp_source.html">Files.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_monolithic_f_s_i_non_linear_implicit_system_8hpp_source.html">MonolithicFSINonLinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_transient_system_8hpp_source.html">TransientSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_g_m_v_writer_8hpp_source.html">GMVWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_x_d_m_f_writer_8hpp_source.html">XDMFWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_line_8hpp_source.html">Line.hpp</a>&quot;</code><br />
<code>#include &quot;adept.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_8hpp_source.html">../../FSI/vascular/include/FSITimeDependentAssemblySupgNonConservativeTwoPressures.hpp</a>&quot;</code><br />
<code>#include &lt;cmath&gt;</code><br />
<code>#include &lt;boost/math/special_functions/ellint_1.hpp&gt;</code><br />
<code>#include &lt;boost/math/special_functions/ellint_2.hpp&gt;</code><br />
</div>
<p><a href="magnetic__stents_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad47bed7d7095b356056b518e0842c75a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#ad47bed7d7095b356056b518e0842c75a">SetVariableTimeStep</a> (const double time)</td></tr>
<tr class="separator:ad47bed7d7095b356056b518e0842c75a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3fdd5f4775bbdd38ffe27fb6a232799"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#ab3fdd5f4775bbdd38ffe27fb6a232799">SetBoundaryConditionAorticBifurcation</a> (const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:ab3fdd5f4775bbdd38ffe27fb6a232799"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a95e7008a8dc52128d7dde0029e5ddd5d"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a95e7008a8dc52128d7dde0029e5ddd5d">SetBoundaryConditionTubo3D</a> (const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:a95e7008a8dc52128d7dde0029e5ddd5d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af5e696906686ccd7c8afb2fd4ee846ad"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#af5e696906686ccd7c8afb2fd4ee846ad">SetBoundaryConditionCarotidBifurcation</a> (const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:af5e696906686ccd7c8afb2fd4ee846ad"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec52f43f998adde5ed3ccb6c4b21dac2"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#aec52f43f998adde5ed3ccb6c4b21dac2">SetBoundaryConditionMagneticStents</a> (const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:aec52f43f998adde5ed3ccb6c4b21dac2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a246808dd279b9a7838339cbcb81e18bb"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a246808dd279b9a7838339cbcb81e18bb">UpdateMeshCoordinates</a> (<a class="el" href="classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;mlMesh, <a class="el" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;mlSol)</td></tr>
<tr class="separator:a246808dd279b9a7838339cbcb81e18bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad291af8a9eed7b4ec5fc850834049a28"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#ad291af8a9eed7b4ec5fc850834049a28">MagneticForceWire</a> (const std::vector&lt; double &gt; &amp;xMarker, std::vector&lt; double &gt; &amp;Fm, const unsigned &amp;material)</td></tr>
<tr class="separator:ad291af8a9eed7b4ec5fc850834049a28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a85c583291c006c5144cc8a9c06bc1e3a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a85c583291c006c5144cc8a9c06bc1e3a">MagneticForceSC</a> (const std::vector&lt; double &gt; &amp;xMarker, std::vector&lt; double &gt; &amp;Fm, const unsigned &amp;material)</td></tr>
<tr class="separator:a85c583291c006c5144cc8a9c06bc1e3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a642f24668cc85d5eada722f3c2bc08ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a642f24668cc85d5eada722f3c2bc08ae">MagneticForceStents</a> (const std::vector&lt; double &gt; &amp;xMarker, std::vector&lt; double &gt; &amp;Fm, const unsigned &amp;material)</td></tr>
<tr class="separator:a642f24668cc85d5eada722f3c2bc08ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a> (int argc, char **args)</td></tr>
<tr class="separator:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a80d402d10e8341004c0caf10133b80ab"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a> = 1000.</td></tr>
<tr class="separator:a80d402d10e8341004c0caf10133b80ab"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a667695b2e2b6f386ba3f5249732f3aba"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a></td></tr>
<tr class="separator:a667695b2e2b6f386ba3f5249732f3aba"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a87785c57dfeccbf971d24cfcdbe88c22"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a></td></tr>
<tr class="separator:a87785c57dfeccbf971d24cfcdbe88c22"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a85c583291c006c5144cc8a9c06bc1e3a" name="a85c583291c006c5144cc8a9c06bc1e3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a85c583291c006c5144cc8a9c06bc1e3a">&#9670;&#160;</a></span>MagneticForceSC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MagneticForceSC </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xMarker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Fm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>material</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l01032">1032</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1033</span>{</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>  <span class="comment">//current loop of radius a, center x and for z-axis the line identified by x and v</span></div>
<div class="line"><span class="lineno"> 1036</span> </div>
<div class="line"><span class="lineno"> 1037</span>  <span class="comment">//BEGIN magnetic and electric parameters</span></div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno"> 1040</span>  <span class="keywordtype">double</span> I = 1.857e5; <span class="comment">// electric current intensity</span></div>
<div class="line"><span class="lineno"> 1041</span>  <span class="keywordtype">double</span> Msat = 1.e6;  <span class="comment">//  magnetic saturation</span></div>
<div class="line"><span class="lineno"> 1042</span>  <span class="keywordtype">double</span>  chi = 3.; <span class="comment">//magnetic susceptibility</span></div>
<div class="line"><span class="lineno"> 1043</span>  <span class="keywordtype">double</span> mu0 = 4 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * 1.e-7;  <span class="comment">//magnetic permeability of the vacuum</span></div>
<div class="line"><span class="lineno"> 1044</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a>;</div>
<div class="line"><span class="lineno"> 1045</span>  std::vector &lt;double&gt; gradH ( 3 );</div>
<div class="line"><span class="lineno"> 1046</span>  std::vector &lt;double&gt; gradHSquared ( 3 );</div>
<div class="line"><span class="lineno"> 1047</span>  std::vector&lt;double&gt; vectorH ( 3 );</div>
<div class="line"><span class="lineno"> 1048</span>  <span class="keywordtype">double</span> H0 = Msat / chi;</div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span> </div>
<div class="line"><span class="lineno"> 1053</span>  <span class="comment">//BEGIN fluid viscosity</span></div>
<div class="line"><span class="lineno"> 1054</span> </div>
<div class="line"><span class="lineno"> 1055</span>  <span class="keywordtype">double</span> muf = ( material == 2 ) ? 3.5 * 1.0e-3 : 1.0e100; <span class="comment">// fluid viscosity</span></div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span>  <span class="comment">//BEGIN geometric parameters</span></div>
<div class="line"><span class="lineno"> 1061</span> </div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keywordtype">double</span> D = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1 ) * 0.5 * 1.e-6;     <span class="comment">//diameter of the particle</span></div>
<div class="line"><span class="lineno"> 1063</span> </div>
<div class="line"><span class="lineno"> 1064</span>  <span class="keywordtype">double</span> a = 0.02; <span class="comment">//radius of the circular current loop in m</span></div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>  std::vector &lt;double&gt; v ( 3 );</div>
<div class="line"><span class="lineno"> 1067</span>  std::vector &lt;double&gt; x ( 3 );</div>
<div class="line"><span class="lineno"> 1068</span> </div>
<div class="line"><span class="lineno"> 1069</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 0 ) { <span class="comment">//conf1 with z = 1.75 cm</span></div>
<div class="line"><span class="lineno"> 1070</span>    v[0] = 0.;</div>
<div class="line"><span class="lineno"> 1071</span>    v[1] = -1.;</div>
<div class="line"><span class="lineno"> 1072</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno"> 1073</span> </div>
<div class="line"><span class="lineno"> 1074</span>    x[0] = -0.002065;</div>
<div class="line"><span class="lineno"> 1075</span>    x[1] = -0.019932;</div>
<div class="line"><span class="lineno"> 1076</span>    x[2] = 0.000169;</div>
<div class="line"><span class="lineno"> 1077</span>  }</div>
<div class="line"><span class="lineno"> 1078</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 1 ) { <span class="comment">//conf2 with z =1.75 cm</span></div>
<div class="line"><span class="lineno"> 1079</span>    v[0] = -1;</div>
<div class="line"><span class="lineno"> 1080</span>    v[1] = 0.;</div>
<div class="line"><span class="lineno"> 1081</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>    x[0] = 0.0175;</div>
<div class="line"><span class="lineno"> 1084</span>    x[1] = 0.0045;</div>
<div class="line"><span class="lineno"> 1085</span>    x[2] = 0.;</div>
<div class="line"><span class="lineno"> 1086</span>  }</div>
<div class="line"><span class="lineno"> 1087</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 2 ) { <span class="comment">//conf1 with z = 2.75 cm</span></div>
<div class="line"><span class="lineno"> 1088</span>    v[0] = 0.;</div>
<div class="line"><span class="lineno"> 1089</span>    v[1] = -1.;</div>
<div class="line"><span class="lineno"> 1090</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno"> 1091</span> </div>
<div class="line"><span class="lineno"> 1092</span>    x[0] = -0.002065;</div>
<div class="line"><span class="lineno"> 1093</span>    x[1] = -0.029932;</div>
<div class="line"><span class="lineno"> 1094</span>    x[2] = 0.000169;</div>
<div class="line"><span class="lineno"> 1095</span>  }</div>
<div class="line"><span class="lineno"> 1096</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 3 ) { <span class="comment">//conf2 with z = 2.75 cm</span></div>
<div class="line"><span class="lineno"> 1097</span>    v[0] = -1;</div>
<div class="line"><span class="lineno"> 1098</span>    v[1] = 0.;</div>
<div class="line"><span class="lineno"> 1099</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno"> 1100</span> </div>
<div class="line"><span class="lineno"> 1101</span>    x[0] = 0.0275;</div>
<div class="line"><span class="lineno"> 1102</span>    x[1] = 0.0045;</div>
<div class="line"><span class="lineno"> 1103</span>    x[2] = 0.;</div>
<div class="line"><span class="lineno"> 1104</span>  }</div>
<div class="line"><span class="lineno"> 1105</span> </div>
<div class="line"><span class="lineno"> 1106</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 4 ) { <span class="comment">//conf 3 with z = 1.75 cm</span></div>
<div class="line"><span class="lineno"> 1107</span>    v[0] = 1;</div>
<div class="line"><span class="lineno"> 1108</span>    v[1] = 0.;</div>
<div class="line"><span class="lineno"> 1109</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno"> 1110</span> </div>
<div class="line"><span class="lineno"> 1111</span>    x[0] = -0.0285;</div>
<div class="line"><span class="lineno"> 1112</span>    x[1] = -0.001;</div>
<div class="line"><span class="lineno"> 1113</span>    x[2] = 0.;</div>
<div class="line"><span class="lineno"> 1114</span>  }</div>
<div class="line"><span class="lineno"> 1115</span> </div>
<div class="line"><span class="lineno"> 1116</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 5 ) { <span class="comment">//conf 3 with z = 2.75 cm</span></div>
<div class="line"><span class="lineno"> 1117</span>    v[0] = 1;</div>
<div class="line"><span class="lineno"> 1118</span>    v[1] = 0.;</div>
<div class="line"><span class="lineno"> 1119</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span>    x[0] = -0.0385;</div>
<div class="line"><span class="lineno"> 1122</span>    x[1] = -0.001;</div>
<div class="line"><span class="lineno"> 1123</span>    x[2] = 0.;</div>
<div class="line"><span class="lineno"> 1124</span>  }</div>
<div class="line"><span class="lineno"> 1125</span> </div>
<div class="line"><span class="lineno"> 1126</span> </div>
<div class="line"><span class="lineno"> 1127</span> </div>
<div class="line"><span class="lineno"> 1128</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1129</span> </div>
<div class="line"><span class="lineno"> 1130</span> </div>
<div class="line"><span class="lineno"> 1131</span>  <span class="comment">//BEGIN extraction of the coordinates of the particle</span></div>
<div class="line"><span class="lineno"> 1132</span> </div>
<div class="line"><span class="lineno"> 1133</span>  std::vector &lt;double&gt; xM ( 3 );</div>
<div class="line"><span class="lineno"> 1134</span>  xM[0] = xMarker[0];</div>
<div class="line"><span class="lineno"> 1135</span>  xM[1] = xMarker[1];</div>
<div class="line"><span class="lineno"> 1136</span>  xM[2] = ( xMarker.size() == 3 ) ? xMarker[2] : 0. ;</div>
<div class="line"><span class="lineno"> 1137</span> </div>
<div class="line"><span class="lineno"> 1138</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span> </div>
<div class="line"><span class="lineno"> 1141</span>  <span class="comment">//BEGIN evaluate H</span></div>
<div class="line"><span class="lineno"> 1142</span> </div>
<div class="line"><span class="lineno"> 1143</span> </div>
<div class="line"><span class="lineno"> 1144</span>  <span class="comment">//BEGIN bulid the rotation Matrix;</span></div>
<div class="line"><span class="lineno"> 1145</span>  <span class="keywordtype">double</span> v2 = sqrt ( v[0] * v[0] + v[1] * v[1] + v[2] * v[2] );</div>
<div class="line"><span class="lineno"> 1146</span>  v[0] /= v2;</div>
<div class="line"><span class="lineno"> 1147</span>  v[1] /= v2;</div>
<div class="line"><span class="lineno"> 1148</span>  v[2] /= v2;</div>
<div class="line"><span class="lineno"> 1149</span> </div>
<div class="line"><span class="lineno"> 1150</span>  std::vector &lt;double&gt; u ( 3 ); <span class="comment">// will be the x&#39;-axis</span></div>
<div class="line"><span class="lineno"> 1151</span>  std::vector &lt;double&gt; w ( 3 ); <span class="comment">// will be the y&#39;-axis</span></div>
<div class="line"><span class="lineno"> 1152</span> </div>
<div class="line"><span class="lineno"> 1153</span>  <span class="keywordtype">unsigned</span> imax = 0;</div>
<div class="line"><span class="lineno"> 1154</span>  <span class="keywordtype">double</span> vmax = fabs ( v[0] );</div>
<div class="line"><span class="lineno"> 1155</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 1; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1156</span>    <span class="keywordflow">if</span> ( fabs ( v[i] ) &gt; vmax ) {</div>
<div class="line"><span class="lineno"> 1157</span>      imax = i;</div>
<div class="line"><span class="lineno"> 1158</span>      vmax = fabs ( v[i] );</div>
<div class="line"><span class="lineno"> 1159</span>    }</div>
<div class="line"><span class="lineno"> 1160</span>  }</div>
<div class="line"><span class="lineno"> 1161</span> </div>
<div class="line"><span class="lineno"> 1162</span>  u[0] = ( imax == 0 ) ? - ( v[1] + v[2] ) / v[0]  : 1;</div>
<div class="line"><span class="lineno"> 1163</span>  u[1] = ( imax == 1 ) ? - ( v[2] + v[0] ) / v[1]  : 1;</div>
<div class="line"><span class="lineno"> 1164</span>  u[2] = ( imax == 2 ) ? - ( v[0] + v[1] ) / v[2]  : 1;</div>
<div class="line"><span class="lineno"> 1165</span> </div>
<div class="line"><span class="lineno"> 1166</span>  <span class="keywordtype">double</span> u2 = sqrt ( u[0] * u[0] + u[1] * u[1] + u[2] * u[2] );</div>
<div class="line"><span class="lineno"> 1167</span>  u[0] /= u2;</div>
<div class="line"><span class="lineno"> 1168</span>  u[1] /= u2;</div>
<div class="line"><span class="lineno"> 1169</span>  u[2] /= u2;</div>
<div class="line"><span class="lineno"> 1170</span> </div>
<div class="line"><span class="lineno"> 1171</span>  w[0] = v[1] * u[2] - v[2] * u[1];</div>
<div class="line"><span class="lineno"> 1172</span>  w[1] = v[2] * u[0] - v[0] * u[2];</div>
<div class="line"><span class="lineno"> 1173</span>  w[2] = v[0] * u[1] - v[1] * u[0];</div>
<div class="line"><span class="lineno"> 1174</span> </div>
<div class="line"><span class="lineno"> 1175</span>  <span class="keywordtype">double</span> w2 = sqrt ( w[0] * w[0] + w[1] * w[1] + w[2] * w[2] );</div>
<div class="line"><span class="lineno"> 1176</span>  <span class="keywordflow">if</span> ( fabs ( w2 - 1. ) &gt; 1.0e-12 ) {</div>
<div class="line"><span class="lineno"> 1177</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;ERRORE AAAAAAAAAAAAAAAAAAA&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1178</span>  }</div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>  std::vector&lt; std::vector &lt;double&gt; &gt; R ( 3 );</div>
<div class="line"><span class="lineno"> 1181</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1182</span>    R[i].resize ( 3 );</div>
<div class="line"><span class="lineno"> 1183</span>    R[i][0] = u[i];</div>
<div class="line"><span class="lineno"> 1184</span>    R[i][1] = w[i];</div>
<div class="line"><span class="lineno"> 1185</span>    R[i][2] = v[i];</div>
<div class="line"><span class="lineno"> 1186</span>  }</div>
<div class="line"><span class="lineno"> 1187</span>  <span class="comment">//END bulid the rotation Matrix;</span></div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span><span class="comment">//           std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1190</span><span class="comment">//           for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1191</span><span class="comment">//      for(unsigned j=0;j&lt;3;j++){</span></div>
<div class="line"><span class="lineno"> 1192</span><span class="comment">//        std::cout &lt;&lt; R[i][j] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1193</span><span class="comment">//      }</span></div>
<div class="line"><span class="lineno"> 1194</span><span class="comment">//      std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1195</span><span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1196</span> </div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span>  <span class="comment">//BEGIN find marker local coordinates</span></div>
<div class="line"><span class="lineno"> 1199</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 3 ; i++ ) {</div>
<div class="line"><span class="lineno"> 1200</span>    xM[i] -= x[i];</div>
<div class="line"><span class="lineno"> 1201</span>  }</div>
<div class="line"><span class="lineno"> 1202</span> </div>
<div class="line"><span class="lineno"> 1203</span> </div>
<div class="line"><span class="lineno"> 1204</span> </div>
<div class="line"><span class="lineno"> 1205</span> </div>
<div class="line"><span class="lineno"> 1206</span>  std::vector&lt;double&gt; xM1 ( 3, 0. );</div>
<div class="line"><span class="lineno"> 1207</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1208</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 3; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno"> 1209</span>      xM1[i] += R[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i] * xM[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1210</span>    }</div>
<div class="line"><span class="lineno"> 1211</span>  }</div>
<div class="line"><span class="lineno"> 1212</span>  xM = xM1;</div>
<div class="line"><span class="lineno"> 1213</span> </div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>  <span class="comment">//END find marker local coordinates</span></div>
<div class="line"><span class="lineno"> 1216</span> </div>
<div class="line"><span class="lineno"> 1217</span>  <span class="keywordtype">double</span> rhoSquared = xM[0] * xM[0] + xM[1] * xM[1];</div>
<div class="line"><span class="lineno"> 1218</span>  <span class="keywordtype">double</span> rSquared = rhoSquared + xM[2] * xM[2];</div>
<div class="line"><span class="lineno"> 1219</span>  <span class="keywordtype">double</span> alphaSquared = a * a + rSquared - 2 * a * sqrt ( rhoSquared );</div>
<div class="line"><span class="lineno"> 1220</span>  <span class="keywordtype">double</span> betaSquared = a * a + rSquared + 2 * a * sqrt ( rhoSquared );</div>
<div class="line"><span class="lineno"> 1221</span>  <span class="keywordtype">double</span> kSquared = 1 - ( alphaSquared / betaSquared );</div>
<div class="line"><span class="lineno"> 1222</span>  <span class="keywordtype">double</span> gamma = xM[0] * xM[0] - xM[1] * xM[1];</div>
<div class="line"><span class="lineno"> 1223</span>  <span class="keywordtype">double</span> C = ( I * mu0 ) / <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a>;</div>
<div class="line"><span class="lineno"> 1224</span> </div>
<div class="line"><span class="lineno"> 1225</span> </div>
<div class="line"><span class="lineno"> 1226</span> </div>
<div class="line"><span class="lineno"> 1227</span>  std::vector &lt; double &gt; vectorHp ( 3 );</div>
<div class="line"><span class="lineno"> 1228</span>  std::vector &lt; std::vector &lt; double &gt; &gt; jacobianVectorHp ( 3 );</div>
<div class="line"><span class="lineno"> 1229</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1230</span>    jacobianVectorHp[i].resize ( 3 );</div>
<div class="line"><span class="lineno"> 1231</span>  }</div>
<div class="line"><span class="lineno"> 1232</span> </div>
<div class="line"><span class="lineno"> 1233</span>  <span class="keywordtype">bool</span> nearZAxis = ( rhoSquared &lt; 1e-5 * a * a ) ? <span class="keyword">true</span> : false;</div>
<div class="line"><span class="lineno"> 1234</span> </div>
<div class="line"><span class="lineno"> 1235</span>  vectorHp[0] = ( nearZAxis == true ) ?  0 : ( 1 / mu0 ) * ( ( C * xM[0] * xM[2] ) / ( 2 * alphaSquared * sqrt ( betaSquared ) * rhoSquared ) ) * ( ( a * a + rSquared ) * ellint_2 ( kSquared ) - alphaSquared * ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1236</span>  vectorHp[1] = ( nearZAxis == true ) ?  0 : ( 1 / mu0 ) * ( ( C * xM[1] * xM[2] ) / ( 2 * alphaSquared * sqrt ( betaSquared ) * rhoSquared ) ) * ( ( a * a + rSquared ) * ellint_2 ( kSquared ) - alphaSquared * ellint_1 ( kSquared ) );;</div>
<div class="line"><span class="lineno"> 1237</span>  vectorHp[2] = ( 1 / mu0 ) * ( C / ( 2 * alphaSquared * sqrt ( betaSquared ) ) ) * ( ( a * a - rSquared ) * ellint_2 ( kSquared ) + alphaSquared * ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1238</span> </div>
<div class="line"><span class="lineno"> 1239</span> </div>
<div class="line"><span class="lineno"> 1240</span>  jacobianVectorHp[0][0] = ( nearZAxis == true ) ?  0 : ( ( C * xM[2] ) / ( 2 * alphaSquared * alphaSquared * sqrt ( betaSquared * betaSquared * betaSquared ) * rhoSquared * rhoSquared * mu0 ) ) * (</div>
<div class="line"><span class="lineno"> 1241</span>                             ( a * a * a * a * ( - gamma * ( 3 * xM[2] * xM[2] + a * a ) + rhoSquared * ( 8 * xM[0] * xM[0] - xM[1] * xM[1] ) ) -</div>
<div class="line"><span class="lineno"> 1242</span>                               a * a * ( rhoSquared * rhoSquared * ( 5 * xM[0] * xM[0] + xM[1] * xM[1] ) -</div>
<div class="line"><span class="lineno"> 1243</span>                                         2 * rhoSquared * xM[2] * xM[2] * ( 2 * xM[0] * xM[0] + xM[1] * xM[1] ) + 3 * xM[2] * xM[2] * xM[2] * xM[2] * gamma ) -</div>
<div class="line"><span class="lineno"> 1244</span>                               rSquared * rSquared * ( 2 * xM[0] * xM[0] * xM[0] * xM[0] + gamma * ( xM[1] * xM[1] + xM[2] * xM[2] ) ) )  * ellint_2 ( kSquared ) +</div>
<div class="line"><span class="lineno"> 1245</span>                             ( a * a * ( gamma * ( a * a + 2 * xM[2] * xM[2] ) - rhoSquared * ( 3 * xM[0] * xM[0] - 2 * xM[1] * xM[1] ) ) +</div>
<div class="line"><span class="lineno"> 1246</span>                               rSquared * ( 2 * xM[0] * xM[0] * xM[0] * xM[0] + gamma * ( xM[1] * xM[1] + xM[2] * xM[2] ) ) ) * alphaSquared * ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1247</span> </div>
<div class="line"><span class="lineno"> 1248</span> </div>
<div class="line"><span class="lineno"> 1249</span>  jacobianVectorHp[0][1] = ( nearZAxis == true ) ?  0 : ( ( C * xM[0] * xM[1] * xM[2] ) / ( 2 * alphaSquared * alphaSquared * sqrt ( betaSquared * betaSquared * betaSquared ) * rhoSquared * rhoSquared * mu0 ) ) * (</div>
<div class="line"><span class="lineno"> 1250</span>                             ( 3 * a * a * a * a * ( 3 * rhoSquared - 2 * xM[2] * xM[2] ) - rSquared * rSquared * ( 2 * rSquared + rhoSquared ) - 2 * a * a * a * a * a * a  -</div>
<div class="line"><span class="lineno"> 1251</span>                               2 * a * a * ( 2 * rhoSquared * rhoSquared - rhoSquared * xM[2] * xM[2] + 3 * xM[2] * xM[2] * xM[2] * xM[2] ) ) * ellint_2 ( kSquared ) +</div>
<div class="line"><span class="lineno"> 1252</span>                             ( rSquared * ( 2 * rSquared + rhoSquared ) - a * a * ( 5 * rhoSquared - 4 * xM[2] * xM[2] ) + 2 * a * a * a * a ) * alphaSquared * ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1253</span> </div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>  jacobianVectorHp[0][2] = ( nearZAxis == true ) ?  0 : ( ( C * xM[0] ) / ( 2 * alphaSquared * alphaSquared * sqrt ( betaSquared * betaSquared * betaSquared ) * rhoSquared * mu0 ) ) * (</div>
<div class="line"><span class="lineno"> 1256</span>                             ( ( rhoSquared - a * a ) * ( rhoSquared - a * a ) * ( rhoSquared + a * a ) + 2 * xM[2] * xM[2] * ( a * a * a * a - 6 * a * a * rhoSquared + rhoSquared * rhoSquared ) +</div>
<div class="line"><span class="lineno"> 1257</span>                               xM[2] * xM[2] * xM[2] * xM[2] * ( a * a + rhoSquared ) ) *  ellint_2 ( kSquared ) -</div>
<div class="line"><span class="lineno"> 1258</span>                             ( ( rhoSquared - a * a ) * ( rhoSquared - a * a ) + xM[2] * xM[2] * ( rhoSquared + a * a ) ) * alphaSquared *  ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1259</span> </div>
<div class="line"><span class="lineno"> 1260</span> </div>
<div class="line"><span class="lineno"> 1261</span>  jacobianVectorHp[1][0] = jacobianVectorHp[0][1];</div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span> </div>
<div class="line"><span class="lineno"> 1264</span>  jacobianVectorHp[1][1] = ( nearZAxis == true ) ?  0 : ( ( C * xM[2] ) / ( 2 * alphaSquared * alphaSquared * sqrt ( betaSquared * betaSquared * betaSquared ) * rhoSquared * rhoSquared * mu0 ) ) * (</div>
<div class="line"><span class="lineno"> 1265</span>                             ( a * a * a * a * ( gamma * ( 3 * xM[2] * xM[2] + a * a ) + rhoSquared * ( 8 * xM[1] * xM[1] - xM[0] * xM[0] ) ) -</div>
<div class="line"><span class="lineno"> 1266</span>                               a * a * ( rhoSquared * rhoSquared * ( 5 * xM[1] * xM[1] + xM[0] * xM[0] ) - 2 * rhoSquared * xM[2] * xM[2] * ( 2 * xM[1] * xM[1] + xM[0] * xM[0] ) -</div>
<div class="line"><span class="lineno"> 1267</span>                                         3 * xM[2] * xM[2] * xM[2] * xM[2] * gamma )  - rSquared * rSquared * ( 2 * xM[1] * xM[1] * xM[1] * xM[1] - gamma * ( xM[0] * xM[0] + xM[2] * xM[2] ) ) ) * ellint_2 ( kSquared ) +</div>
<div class="line"><span class="lineno"> 1268</span>                             ( a * a * ( - gamma * ( a * a + 2 * xM[2] * xM[2] )  - rhoSquared * ( 3 * xM[1] * xM[1] - 2 * xM[0] * xM[0] ) ) + rSquared * ( 2 * xM[1] * xM[1] * xM[1] * xM[1] -</div>
<div class="line"><span class="lineno"> 1269</span>                                 gamma * ( xM[0] * xM[0] + xM[2] * xM[2] ) ) ) * alphaSquared * ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1270</span> </div>
<div class="line"><span class="lineno"> 1271</span> </div>
<div class="line"><span class="lineno"> 1272</span>  jacobianVectorHp[1][2] = ( nearZAxis == true ) ?  0 : ( ( C * xM[1] ) / ( 2 * alphaSquared * alphaSquared * sqrt ( betaSquared * betaSquared * betaSquared ) * rhoSquared * mu0 ) ) * (</div>
<div class="line"><span class="lineno"> 1273</span>                             ( ( rhoSquared - a * a ) * ( rhoSquared - a * a ) * ( rhoSquared + a * a ) + 2 * xM[2] * xM[2] * ( a * a * a * a - 6 * a * a * rhoSquared + rhoSquared * rhoSquared ) +</div>
<div class="line"><span class="lineno"> 1274</span>                               xM[2] * xM[2] * xM[2] * xM[2] * ( a * a + rhoSquared ) ) *  ellint_2 ( kSquared ) -</div>
<div class="line"><span class="lineno"> 1275</span>                             ( ( rhoSquared - a * a ) * ( rhoSquared - a * a ) + xM[2] * xM[2] * ( rhoSquared + a * a ) ) * alphaSquared *  ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1276</span> </div>
<div class="line"><span class="lineno"> 1277</span> </div>
<div class="line"><span class="lineno"> 1278</span>  jacobianVectorHp[2][0] = ( nearZAxis == true ) ?  0 : jacobianVectorHp[0][2];</div>
<div class="line"><span class="lineno"> 1279</span> </div>
<div class="line"><span class="lineno"> 1280</span> </div>
<div class="line"><span class="lineno"> 1281</span>  jacobianVectorHp[2][1] = ( nearZAxis == true ) ?  0 : jacobianVectorHp[1][2];</div>
<div class="line"><span class="lineno"> 1282</span> </div>
<div class="line"><span class="lineno"> 1283</span> </div>
<div class="line"><span class="lineno"> 1284</span>  jacobianVectorHp[2][2] = ( ( C * xM[2] ) / ( 2 * alphaSquared * alphaSquared * sqrt ( betaSquared * betaSquared * betaSquared ) * mu0 ) ) * (</div>
<div class="line"><span class="lineno"> 1285</span>                             ( 6 * a * a * ( rhoSquared - xM[2] * xM[2] ) - 7 * a * a * a * a + rSquared * rSquared ) * ellint_2 ( kSquared ) +</div>
<div class="line"><span class="lineno"> 1286</span>                             ( a * a - rSquared ) * alphaSquared * ellint_1 ( kSquared ) );</div>
<div class="line"><span class="lineno"> 1287</span> </div>
<div class="line"><span class="lineno"> 1288</span> </div>
<div class="line"><span class="lineno"> 1289</span><span class="comment">// //     std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1290</span><span class="comment">// //           for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1291</span><span class="comment">// //       for(unsigned j=0;j&lt;3;j++){</span></div>
<div class="line"><span class="lineno"> 1292</span><span class="comment">// //         std::cout &lt;&lt; jacobianVectorHp[i][j] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1293</span><span class="comment">// //       }</span></div>
<div class="line"><span class="lineno"> 1294</span><span class="comment">// //       std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1295</span><span class="comment">// //     }</span></div>
<div class="line"><span class="lineno"> 1296</span><span class="comment">// //     std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1297</span><span class="comment">//    for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1298</span><span class="comment">//      std::cout &lt;&lt; vectorHp[i] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1299</span><span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1300</span><span class="comment">//           std::cout&lt;&lt;std::endl;  std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1301</span> </div>
<div class="line"><span class="lineno"> 1302</span>  std::vector &lt; std::vector &lt;double&gt; &gt; jacobianVectorH ( 3 );</div>
<div class="line"><span class="lineno"> 1303</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1304</span>    jacobianVectorH[i].resize ( 3 );</div>
<div class="line"><span class="lineno"> 1305</span>  }</div>
<div class="line"><span class="lineno"> 1306</span> </div>
<div class="line"><span class="lineno"> 1307</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1308</span>    vectorH[i] = 0.;</div>
<div class="line"><span class="lineno"> 1309</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 3; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno"> 1310</span>      vectorH[i] += R[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * vectorHp[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1311</span>      jacobianVectorH[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0.;</div>
<div class="line"><span class="lineno"> 1312</span>      <span class="comment">// std::cout &lt;&lt; R[i][j] &lt;&lt;&quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1313</span>      <span class="comment">// std::cout &lt;&lt; jacobianVectorHp[i][j] &lt;&lt;&quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1314</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; 3; k++ ) {</div>
<div class="line"><span class="lineno"> 1315</span>        jacobianVectorH[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += R[i][k] * jacobianVectorHp[k][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1316</span>      }</div>
<div class="line"><span class="lineno"> 1317</span>    }</div>
<div class="line"><span class="lineno"> 1318</span>  }</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span> </div>
<div class="line"><span class="lineno"> 1321</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1322</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 3; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno"> 1323</span>      jacobianVectorHp[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0. ;</div>
<div class="line"><span class="lineno"> 1324</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; 3; k++ ) {</div>
<div class="line"><span class="lineno"> 1325</span>        jacobianVectorHp[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += jacobianVectorH[i][k] * R[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][k];</div>
<div class="line"><span class="lineno"> 1326</span>      }</div>
<div class="line"><span class="lineno"> 1327</span>    }</div>
<div class="line"><span class="lineno"> 1328</span>  }</div>
<div class="line"><span class="lineno"> 1329</span> </div>
<div class="line"><span class="lineno"> 1330</span>  jacobianVectorH = jacobianVectorHp;</div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span> </div>
<div class="line"><span class="lineno"> 1333</span><span class="comment">//    std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1334</span><span class="comment">//           for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1335</span><span class="comment">//      for(unsigned j=0;j&lt;3;j++){</span></div>
<div class="line"><span class="lineno"> 1336</span><span class="comment">//        std::cout &lt;&lt; jacobianVectorH[i][j] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1337</span><span class="comment">//      }</span></div>
<div class="line"><span class="lineno"> 1338</span><span class="comment">//      std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1339</span><span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1340</span><span class="comment">//    std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1341</span><span class="comment">//    for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1342</span><span class="comment">//      std::cout &lt;&lt; vectorH[i] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1343</span><span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1344</span><span class="comment">//           std::cout&lt;&lt;std::endl;  std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span><span class="comment">//    std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1347</span><span class="comment">//           for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1348</span><span class="comment">//      for(unsigned j=0;j&lt;3;j++){</span></div>
<div class="line"><span class="lineno"> 1349</span><span class="comment">//        std::cout &lt;&lt; jacobianVectorH[i][j] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1350</span><span class="comment">//      }</span></div>
<div class="line"><span class="lineno"> 1351</span><span class="comment">//      std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1352</span><span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1353</span><span class="comment">//    std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1354</span><span class="comment">//    for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1355</span><span class="comment">//      std::cout &lt;&lt; vectorH[i] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1356</span><span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1357</span><span class="comment">//           std::cout&lt;&lt;std::endl;  std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1358</span> </div>
<div class="line"><span class="lineno"> 1359</span> </div>
<div class="line"><span class="lineno"> 1360</span>  <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> = 0.;</div>
<div class="line"><span class="lineno"> 1361</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span>  i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1362</span>    <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> += vectorH[i] * vectorH[i];</div>
<div class="line"><span class="lineno"> 1363</span>  }</div>
<div class="line"><span class="lineno"> 1364</span>  <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> = sqrt ( <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> );</div>
<div class="line"><span class="lineno"> 1365</span> </div>
<div class="line"><span class="lineno"> 1366</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span>  i = 0; i &lt; 3; i++ ) {</div>
<div class="line"><span class="lineno"> 1367</span>    gradHSquared[i] = 0.;</div>
<div class="line"><span class="lineno"> 1368</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 3; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno"> 1369</span>      gradHSquared[i] += 2 * vectorH[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * jacobianVectorH[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i];</div>
<div class="line"><span class="lineno"> 1370</span>    }</div>
<div class="line"><span class="lineno"> 1371</span>  }</div>
<div class="line"><span class="lineno"> 1372</span> </div>
<div class="line"><span class="lineno"> 1373</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0 ; i &lt; Fm.size(); i++ ) {</div>
<div class="line"><span class="lineno"> 1374</span>    Fm[i] = - Fm[i] ;</div>
<div class="line"><span class="lineno"> 1375</span>    <span class="comment">//printf(&quot;%g &quot;,Fm[i]);</span></div>
<div class="line"><span class="lineno"> 1376</span>  }</div>
<div class="line"><span class="lineno"> 1377</span><span class="comment">//           gradHSquared[0] = 2 * vectorH[0] * jacobianVectorH[0][0] + 2 * vectorH[1] * jacobianVectorH[1][0] + 2 * vectorH[2] * jacobianVectorH[2][0];</span></div>
<div class="line"><span class="lineno"> 1378</span><span class="comment">//           gradHSquared[1] = 2 * vectorH[0] * jacobianVectorH[0][1] + 2 * vectorH[1] * jacobianVectorH[1][1] + 2 * vectorH[2] * jacobianVectorH[2][1];</span></div>
<div class="line"><span class="lineno"> 1379</span><span class="comment">//           gradHSquared[2] = 2 * vectorH[0] * jacobianVectorH[0][2] + 2 * vectorH[1] * jacobianVectorH[1][2] + 2 * vectorH[2] * jacobianVectorH[2][2];</span></div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span>  gradH[0] = 0.5 * ( 1 / <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> ) * gradHSquared[0];</div>
<div class="line"><span class="lineno"> 1382</span>  gradH[1] = 0.5 * ( 1 / <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> ) * gradHSquared[1];</div>
<div class="line"><span class="lineno"> 1383</span>  gradH[2] = 0.5 * ( 1 / <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> ) * gradHSquared[2];</div>
<div class="line"><span class="lineno"> 1384</span> </div>
<div class="line"><span class="lineno"> 1385</span><span class="comment">//           for(unsigned i=0;i&lt;3;i++){</span></div>
<div class="line"><span class="lineno"> 1386</span><span class="comment">//      std::cout &lt;&lt;  gradHSquared[i]&lt;&lt;&quot; &quot;&lt;&lt; gradH[i] &lt;&lt;  &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 1387</span><span class="comment">//    }</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="comment">//           std::cout&lt;&lt;std::endl;  std::cout&lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno"> 1389</span> </div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>  <span class="comment">//END valuate H</span></div>
<div class="line"><span class="lineno"> 1392</span> </div>
<div class="line"><span class="lineno"> 1393</span> </div>
<div class="line"><span class="lineno"> 1394</span>  <span class="comment">//BEGIN evaluate Fm</span></div>
<div class="line"><span class="lineno"> 1395</span> </div>
<div class="line"><span class="lineno"> 1396</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> &lt; H0 ) {</div>
<div class="line"><span class="lineno"> 1397</span> </div>
<div class="line"><span class="lineno"> 1398</span> </div>
<div class="line"><span class="lineno"> 1399</span>    <span class="keywordtype">double</span> C1 = ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * D * D * D * mu0 * chi ) / 12;</div>
<div class="line"><span class="lineno"> 1400</span>    <span class="comment">// printf(&quot;%g\n&quot;,C1);</span></div>
<div class="line"><span class="lineno"> 1401</span>    Fm[0] = C1 * gradHSquared[0];</div>
<div class="line"><span class="lineno"> 1402</span>    Fm[1] = C1 * gradHSquared[1];</div>
<div class="line"><span class="lineno"> 1403</span>    Fm[2] = C1 * gradHSquared[2];</div>
<div class="line"><span class="lineno"> 1404</span>  }</div>
<div class="line"><span class="lineno"> 1405</span> </div>
<div class="line"><span class="lineno"> 1406</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1407</span> </div>
<div class="line"><span class="lineno"> 1408</span>    <span class="keywordtype">double</span> C2 = ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * D * D * D * mu0 * Msat ) / 6;</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>    <span class="comment">//printf(&quot;%g\n&quot;,C2);</span></div>
<div class="line"><span class="lineno"> 1411</span>    Fm[0] = C2 * gradH[0];</div>
<div class="line"><span class="lineno"> 1412</span>    Fm[1] = C2 * gradH[1];</div>
<div class="line"><span class="lineno"> 1413</span>    Fm[2] = C2 * gradH[2];</div>
<div class="line"><span class="lineno"> 1414</span> </div>
<div class="line"><span class="lineno"> 1415</span>  }</div>
<div class="line"><span class="lineno"> 1416</span> </div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0 ; i &lt; Fm.size(); i++ ) {</div>
<div class="line"><span class="lineno"> 1419</span>    Fm[i] = Fm[i] / ( 3 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * D * muf ) ;</div>
<div class="line"><span class="lineno"> 1420</span>  }</div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1423</span> </div>
<div class="line"><span class="lineno"> 1424</span> </div>
<div class="line"><span class="lineno"> 1425</span>  <span class="comment">//BEGIN cheating to have attractive force</span></div>
<div class="line"><span class="lineno"> 1426</span> </div>
<div class="line"><span class="lineno"> 1427</span><span class="comment">//   for (unsigned i = 0 ; i &lt; Fm.size(); i++) {</span></div>
<div class="line"><span class="lineno"> 1428</span><span class="comment">//     Fm[i] = - Fm[i] ;</span></div>
<div class="line"><span class="lineno"> 1429</span><span class="comment">//     //printf(&quot;%g &quot;,Fm[i]);</span></div>
<div class="line"><span class="lineno"> 1430</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span>  <span class="comment">//END cheating</span></div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span>}</div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="acylinder__beam__3d__benchmark_8cpp_html_ad7cd26dc1ce30ff209c71b309a3134e6"><div class="ttname"><a href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a></div><div class="ttdeci">static const double H</div><div class="ttdef"><b>Definition</b> <a href="cylinder__beam__3d__benchmark_8cpp_source.html#l00010">cylinder_beam_3d_benchmark.cpp:10</a></div></div>
<div class="ttc" id="ainternal__waves__zlevel_8cpp_html_a4e36555c8609254715858261f34dfd94"><div class="ttname"><a href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a></div><div class="ttdeci">double PI</div><div class="ttdef"><b>Definition</b> <a href="internal__waves__zlevel_8cpp_source.html#l00044">internal_waves_zlevel.cpp:44</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_a667695b2e2b6f386ba3f5249732f3aba"><div class="ttname"><a href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a></div><div class="ttdeci">unsigned partSim</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00053">magnetic_stents.cpp:53</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_a87785c57dfeccbf971d24cfcdbe88c22"><div class="ttname"><a href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a></div><div class="ttdeci">unsigned configuration</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00054">magnetic_stents.cpp:54</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a642f24668cc85d5eada722f3c2bc08ae" name="a642f24668cc85d5eada722f3c2bc08ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a642f24668cc85d5eada722f3c2bc08ae">&#9670;&#160;</a></span>MagneticForceStents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MagneticForceStents </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xMarker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Fm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>material</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l01439">1439</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1440</span>{</div>
<div class="line"><span class="lineno"> 1441</span> </div>
<div class="line"><span class="lineno"> 1442</span>  <span class="comment">//magnetic force when there are magnezable stents and the magnetic field is constant</span></div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span>  <span class="comment">//BEGIN magnetic parameters</span></div>
<div class="line"><span class="lineno"> 1445</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno"> 1446</span>  <span class="keywordtype">double</span> MsatWire = 1261 * 1.e3;  <span class="comment">//  magnetic saturation</span></div>
<div class="line"><span class="lineno"> 1447</span>  <span class="keywordtype">double</span>  chiWire = 1000.; <span class="comment">//magnetic susceptibility</span></div>
<div class="line"><span class="lineno"> 1448</span>  <span class="keywordtype">double</span> mu0 = 4 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * 1.e-7;  <span class="comment">//magnetic permeability of the vacuum</span></div>
<div class="line"><span class="lineno"> 1449</span>  <span class="keywordtype">double</span> H0 = 0.15 / mu0; <span class="comment">//magnetic field intensity</span></div>
<div class="line"><span class="lineno"> 1450</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a> = <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * 0.5;</div>
<div class="line"><span class="lineno"> 1451</span>  <span class="keywordtype">unsigned</span> numberOfWires = 20;</div>
<div class="line"><span class="lineno"> 1452</span>  <span class="keywordtype">double</span> fattore1 = chiWire / ( 2 + chiWire );</div>
<div class="line"><span class="lineno"> 1453</span>  <span class="keywordtype">double</span> fattore2 = 0.5 * ( MsatWire / H0 );</div>
<div class="line"><span class="lineno"> 1454</span>  <span class="keywordtype">double</span> alphaWire = ( fattore1 &lt; fattore2 ) ? fattore1 : fattore2;</div>
<div class="line"><span class="lineno"> 1455</span>  <span class="keywordtype">double</span> RWire = 62.5 * 1.e-6;</div>
<div class="line"><span class="lineno"> 1456</span>  <span class="keywordtype">double</span> wireSpace = 0.2 * 1.e-2;</div>
<div class="line"><span class="lineno"> 1457</span>  std::vector &lt;std::vector&lt;double&gt; &gt; wiresCenter ( numberOfWires );</div>
<div class="line"><span class="lineno"> 1458</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; wiresCenter.size(); i++ ) {</div>
<div class="line"><span class="lineno"> 1459</span>    wiresCenter[i].resize ( 2 );</div>
<div class="line"><span class="lineno"> 1460</span>    <span class="keywordflow">if</span> ( i &lt; numberOfWires / 2 ) {</div>
<div class="line"><span class="lineno"> 1461</span>      wiresCenter[i][0] = 0.15 * 1.e-2 + i * wireSpace;</div>
<div class="line"><span class="lineno"> 1462</span>      wiresCenter[i][1] = 3 * 1.e-4;</div>
<div class="line"><span class="lineno"> 1463</span><span class="comment">//       std::cout &lt;&lt; &quot;wire:&quot; &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; &quot;x=&quot; &lt;&lt; wiresCenter[i][0] &lt;&lt; &quot; , &quot; &lt;&lt; wiresCenter[i][1] &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1464</span>    }</div>
<div class="line"><span class="lineno"> 1465</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno"> 1466</span>      wiresCenter[i][0] = 0.05 * 1.e-2 + ( i - numberOfWires / 2 ) * wireSpace;</div>
<div class="line"><span class="lineno"> 1467</span>      wiresCenter[i][1] = - 3 * 1.e-4;</div>
<div class="line"><span class="lineno"> 1468</span><span class="comment">//       std::cout &lt;&lt; &quot;wire:&quot; &lt;&lt; i &lt;&lt; &quot; &quot; &lt;&lt; &quot;x=&quot; &lt;&lt; wiresCenter[i][0] &lt;&lt; &quot; , &quot; &lt;&lt; wiresCenter[i][1] &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1469</span>    }</div>
<div class="line"><span class="lineno"> 1470</span>  }</div>
<div class="line"><span class="lineno"> 1471</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1472</span> </div>
<div class="line"><span class="lineno"> 1473</span>  std::vector &lt;std::vector&lt;double&gt; &gt; relPosition ( numberOfWires ); <span class="comment">//relative position of the wires</span></div>
<div class="line"><span class="lineno"> 1474</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; relPosition.size(); i++ ) {</div>
<div class="line"><span class="lineno"> 1475</span>    relPosition[i].resize ( 2 );</div>
<div class="line"><span class="lineno"> 1476</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno"> 1477</span>      relPosition[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = xMarker[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] - wiresCenter[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]; <span class="comment">//particle position wrt the ith reference frame, i=1,...,numberOfWires</span></div>
<div class="line"><span class="lineno"> 1478</span>    }</div>
<div class="line"><span class="lineno"> 1479</span>  }</div>
<div class="line"><span class="lineno"> 1480</span> </div>
<div class="line"><span class="lineno"> 1481</span>  <span class="comment">//BEGIN GRADIENT PHI and HESSIAN</span></div>
<div class="line"><span class="lineno"> 1482</span>  <span class="comment">// we compute the gradient of each phi and then sum them up to obtain sumGradPhi</span></div>
<div class="line"><span class="lineno"> 1483</span>  <span class="comment">// sumHessPhi is the negative sum of the Hessian matrix of each phi</span></div>
<div class="line"><span class="lineno"> 1484</span>  std::vector&lt;double&gt; sumGradPhi ( 2, 0. );</div>
<div class="line"><span class="lineno"> 1485</span>  std::vector&lt; std::vector &lt;double&gt; &gt; sumHessPhi ( 2 );</div>
<div class="line"><span class="lineno"> 1486</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 2; i++ ) {</div>
<div class="line"><span class="lineno"> 1487</span>    sumHessPhi[i].assign ( 2, 0.);</div>
<div class="line"><span class="lineno"> 1488</span>  }</div>
<div class="line"><span class="lineno"> 1489</span> </div>
<div class="line"><span class="lineno"> 1490</span>  <span class="keywordtype">double</span> value = H0 * RWire * RWire * alphaWire;</div>
<div class="line"><span class="lineno"> 1491</span> </div>
<div class="line"><span class="lineno"> 1492</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; numberOfWires; i++ ) {</div>
<div class="line"><span class="lineno"> 1493</span>    </div>
<div class="line"><span class="lineno"> 1494</span>    <span class="keywordtype">double</span> x = relPosition[i][0];</div>
<div class="line"><span class="lineno"> 1495</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> = relPosition[i][1];</div>
<div class="line"><span class="lineno"> 1496</span> </div>
<div class="line"><span class="lineno"> 1497</span>    <span class="keywordtype">double</span> r2 =  x * x + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>;</div>
<div class="line"><span class="lineno"> 1498</span>    <span class="keywordtype">double</span> r4 = r2 * r2;</div>
<div class="line"><span class="lineno"> 1499</span>    </div>
<div class="line"><span class="lineno"> 1500</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> = value * ( x * cos(<a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a>) + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> * sin(<a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a>) ) / r2;</div>
<div class="line"><span class="lineno"> 1501</span>    <span class="keywordtype">double</span> phi_x = value * cos ( <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a> ) / r2 - <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> * 2. * x / r2;</div>
<div class="line"><span class="lineno"> 1502</span>    <span class="keywordtype">double</span> phi_y = value * sin ( <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a> ) / r2 - <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> * 2. * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> / r2;</div>
<div class="line"><span class="lineno"> 1503</span>    </div>
<div class="line"><span class="lineno"> 1504</span>    sumGradPhi[0] += phi_x;</div>
<div class="line"><span class="lineno"> 1505</span>    </div>
<div class="line"><span class="lineno"> 1506</span>    sumGradPhi[1] += phi_y;</div>
<div class="line"><span class="lineno"> 1507</span>    </div>
<div class="line"><span class="lineno"> 1508</span>    sumHessPhi[0][0] += value * cos(<a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a>) * (- 2. * x ) / r4 - ( phi_x * 2. * x / r2 + <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> * 2. / r2 + <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> * 2. * x * (- 2. * x) / r4 );</div>
<div class="line"><span class="lineno"> 1509</span> </div>
<div class="line"><span class="lineno"> 1510</span>    sumHessPhi[1][1] += value * sin(<a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a>) * (- 2. * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> ) / r4 - ( phi_y * 2. * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> / r2 + <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> * 2. / r2 + <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> * 2. * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> * (- 2. * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) / r4 );</div>
<div class="line"><span class="lineno"> 1511</span>    </div>
<div class="line"><span class="lineno"> 1512</span>    sumHessPhi[0][1] += value * cos(<a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a>) * (- 2. * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a> ) / r4 - ( phi_y * 2. * x / r2 + <a class="code hl_variable" href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a> * 2. * x * (- 2. * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a>) / r4 );</div>
<div class="line"><span class="lineno"> 1513</span>    </div>
<div class="line"><span class="lineno"> 1514</span>  }</div>
<div class="line"><span class="lineno"> 1515</span> </div>
<div class="line"><span class="lineno"> 1516</span> </div>
<div class="line"><span class="lineno"> 1517</span>  sumHessPhi[1][0] = sumHessPhi[0][1];</div>
<div class="line"><span class="lineno"> 1518</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1519</span> </div>
<div class="line"><span class="lineno"> 1520</span> </div>
<div class="line"><span class="lineno"> 1521</span> </div>
<div class="line"><span class="lineno"> 1522</span>  <span class="comment">//BEGIN B and JACOBIAN of B</span></div>
<div class="line"><span class="lineno"> 1523</span>  std::vector&lt;double&gt; B ( 2, 0. );</div>
<div class="line"><span class="lineno"> 1524</span>  B[0] = mu0 * ( H0 * cos ( <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a> )  - sumGradPhi[0] );</div>
<div class="line"><span class="lineno"> 1525</span>  B[1] = mu0 * ( H0 * sin ( <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a> )  - sumGradPhi[1] );</div>
<div class="line"><span class="lineno"> 1526</span> </div>
<div class="line"><span class="lineno"> 1527</span><span class="comment">//   std::cout &lt;&lt; &quot;B1 = &quot; &lt;&lt; B[0] &lt;&lt; &quot; , &quot; &lt;&lt; &quot;B2 = &quot; &lt;&lt; B[1] &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1528</span> </div>
<div class="line"><span class="lineno"> 1529</span>  std::vector&lt; std::vector &lt;double&gt; &gt; JacB ( 2 );</div>
<div class="line"><span class="lineno"> 1530</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; 2; i++ ) {</div>
<div class="line"><span class="lineno"> 1531</span>    JacB[i].resize ( 2 );</div>
<div class="line"><span class="lineno"> 1532</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno"> 1533</span>      JacB[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = - mu0 * sumHessPhi[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1534</span>    }</div>
<div class="line"><span class="lineno"> 1535</span>  }</div>
<div class="line"><span class="lineno"> 1536</span><span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1537</span> </div>
<div class="line"><span class="lineno"> 1538</span> </div>
<div class="line"><span class="lineno"> 1539</span>  <span class="comment">//BEGIN MAGNITUDE of B and its GRADIENT</span></div>
<div class="line"><span class="lineno"> 1540</span>  <span class="keywordtype">double</span> magnitudeB = sqrt ( B[0] * B[0] + B[1] * B[1] );</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span><span class="comment">//   std::vector &lt;double&gt; gradMagnitudeB ( 2, 0. ) ;</span></div>
<div class="line"><span class="lineno"> 1543</span><span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1544</span><span class="comment">//   gradMagnitudeB[0] = mu0 * ( B[0] * sumHessPhi[0][0] + B[1] * sumHessPhi[0][1] ) / magnitudeB;</span></div>
<div class="line"><span class="lineno"> 1545</span><span class="comment">//   gradMagnitudeB[1] = mu0 * ( B[0] * sumHessPhi[0][1] + B[1] * sumHessPhi[1][1] ) / magnitudeB;</span></div>
<div class="line"><span class="lineno"> 1546</span><span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>  <span class="comment">//BEGIN DIVERGENCE of MAGNETIC MOMENT</span></div>
<div class="line"><span class="lineno"> 1550</span>  <span class="keywordtype">double</span> Dp = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 2 * 0.43 * 1.e-6;  <span class="comment">//particle diameter //rule con partSim</span></div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span>  <span class="keywordtype">double</span> m_fm_p = 2.03 * 1.e-19; <span class="comment">// magnitude of the magnetic moment of the magnetite in the particle</span></div>
<div class="line"><span class="lineno"> 1553</span>  <span class="keywordtype">double</span> k = 1.38 * 1.e-23; <span class="comment">//Boltzman constant</span></div>
<div class="line"><span class="lineno"> 1554</span>  <span class="keywordtype">double</span> T = 300.; <span class="comment">//absolute temperature</span></div>
<div class="line"><span class="lineno"> 1555</span>  <span class="keywordtype">double</span> C1 = m_fm_p / ( k * T ) ;</div>
<div class="line"><span class="lineno"> 1556</span> </div>
<div class="line"><span class="lineno"> 1557</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> = C1 * magnitudeB; <span class="comment">//this is to highlight that beta depends on B and so on x and y</span></div>
<div class="line"><span class="lineno"> 1558</span> </div>
<div class="line"><span class="lineno"> 1559</span>  <span class="keywordtype">double</span> cothBeta =  cosh(<a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a>) / sinh(<a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a>) <span class="comment">/*( exp ( beta ) + exp ( - beta ) ) / ( exp ( beta ) - exp ( - beta ) )*/</span>;</div>
<div class="line"><span class="lineno"> 1560</span>  <span class="keywordtype">double</span> Langevin = cothBeta - 1. / <a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a>;</div>
<div class="line"><span class="lineno"> 1561</span> </div>
<div class="line"><span class="lineno"> 1562</span>  <span class="keywordtype">double</span> w_fm_p = 6.4;</div>
<div class="line"><span class="lineno"> 1563</span>  <span class="keywordtype">double</span> Vp = ( 4. / 3 ) * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * ( Dp * 0.5 ) * ( Dp * 0.5 ) * ( Dp * 0.5 ); <span class="comment">//particle spherical volume</span></div>
<div class="line"><span class="lineno"> 1564</span>  <span class="keywordtype">double</span> M_fm_p_s = 351.9 * 1.e3;</div>
<div class="line"><span class="lineno"> 1565</span>  <span class="keywordtype">double</span> C2 = w_fm_p * Vp * M_fm_p_s;</div>
<div class="line"><span class="lineno"> 1566</span> </div>
<div class="line"><span class="lineno"> 1567</span>  std::vector&lt;double&gt; magnMom ( 2, 0. );</div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span>  magnMom[0] = C2 * Langevin * B[0] / magnitudeB;</div>
<div class="line"><span class="lineno"> 1570</span>  magnMom[1] = C2 * Langevin * B[1] / magnitudeB;</div>
<div class="line"><span class="lineno"> 1571</span> </div>
<div class="line"><span class="lineno"> 1572</span>  <span class="comment">/*</span></div>
<div class="line"><span class="lineno"> 1573</span><span class="comment">    double dMagnMom1_dx = C2 * ( ( 1. - cothBeta * cothBeta ) * C1 * gradMagnitudeB[0] * B[0] / magnitudeB +</span></div>
<div class="line"><span class="lineno"> 1574</span><span class="comment">                                 B[0] * gradMagnitudeB[0] / pow ( magnitudeB, 3 ) +</span></div>
<div class="line"><span class="lineno"> 1575</span><span class="comment">                                 Langevin * ( ( JacB[0][0] * magnitudeB - B[0] * gradMagnitudeB[0] ) / ( magnitudeB * magnitudeB ) )</span></div>
<div class="line"><span class="lineno"> 1576</span><span class="comment">                               );</span></div>
<div class="line"><span class="lineno"> 1577</span><span class="comment">    double dMagnMom2_dy = C2 * ( ( 1. - cothBeta * cothBeta ) * C1 * gradMagnitudeB[1] * B[1] / magnitudeB +</span></div>
<div class="line"><span class="lineno"> 1578</span><span class="comment">                                 B[1] * gradMagnitudeB[1] / pow ( magnitudeB, 3 ) +</span></div>
<div class="line"><span class="lineno"> 1579</span><span class="comment">                                 Langevin * ( ( JacB[1][1] * magnitudeB - B[1] * gradMagnitudeB[1] ) / ( magnitudeB * magnitudeB ) )</span></div>
<div class="line"><span class="lineno"> 1580</span><span class="comment">                               );</span></div>
<div class="line"><span class="lineno"> 1581</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 1582</span><span class="comment">    double divMagnMom = dMagnMom1_dx + dMagnMom2_dy;*/</span></div>
<div class="line"><span class="lineno"> 1583</span><span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1584</span> </div>
<div class="line"><span class="lineno"> 1585</span> </div>
<div class="line"><span class="lineno"> 1586</span> </div>
<div class="line"><span class="lineno"> 1587</span><span class="comment">//BEGIN MAGNETIC FORCE</span></div>
<div class="line"><span class="lineno"> 1588</span>  <span class="keywordtype">double</span> muf = ( material == 2 ) ? 3.5 * 1.0e-3 : 1.0e100; <span class="comment">// fluid viscosity</span></div>
<div class="line"><span class="lineno"> 1589</span> </div>
<div class="line"><span class="lineno"> 1590</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0 ; i &lt; 2; i++ ) {</div>
<div class="line"><span class="lineno"> 1591</span>    Fm[i] = 0.;</div>
<div class="line"><span class="lineno"> 1592</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0 ; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; 2; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno"> 1593</span>      Fm[i] += magnMom[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * JacB[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ;</div>
<div class="line"><span class="lineno"> 1594</span>    }</div>
<div class="line"><span class="lineno"> 1595</span>    Fm[i] /= ( 3. * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * Dp * muf );</div>
<div class="line"><span class="lineno"> 1596</span>  }</div>
<div class="line"><span class="lineno"> 1597</span>  Fm[2] = 0.;</div>
<div class="line"><span class="lineno"> 1598</span><span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1599</span> </div>
<div class="line"><span class="lineno"> 1600</span>}</div>
<div class="ttc" id="a_conformal_2ex3_2ex3_8cpp_html_a4049344c4d6020a322197047b513967f"><div class="ttname"><a href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a></div><div class="ttdeci">const double beta</div><div class="ttdef"><b>Definition</b> <a href="_conformal_2ex3_2ex3_8cpp_source.html#l00023">ex3.cpp:23</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_a2fb1c5cf58867b5bbc9a1b145a86f3a0"><div class="ttname"><a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a2fb1c5cf58867b5bbc9a1b145a86f3a0">y</a></div><div class="ttdeci">y</div><div class="ttdef"><b>Definition</b> <a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00053">MG_precond.m:53</a></div></div>
<div class="ttc" id="a_s_w_2ex2_2ex2_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">double phi</div><div class="ttdef"><b>Definition</b> <a href="_s_w_2ex2_2ex2_8cpp_source.html#l00038">ex2.cpp:38</a></div></div>
<div class="ttc" id="anamespacefemus_html_a02e050d6adc3998272b7cd5fa4e7dc46"><div class="ttname"><a href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">femus::theta</a></div><div class="ttdeci">double * theta</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_time_dependent_assembly_supg_g_c_l_8hpp_source.html#l00037">FSITimeDependentAssemblySupgGCL.hpp:37</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad291af8a9eed7b4ec5fc850834049a28" name="ad291af8a9eed7b4ec5fc850834049a28"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad291af8a9eed7b4ec5fc850834049a28">&#9670;&#160;</a></span>MagneticForceWire()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void MagneticForceWire </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>xMarker</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>Fm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned &amp;&#160;</td>
          <td class="paramname"><em>material</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00858">858</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  859</span>{</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>  <span class="comment">//infinitely long wire with a current I flowing modelled by the line identified by x and v</span></div>
<div class="line"><span class="lineno">  862</span> </div>
<div class="line"><span class="lineno">  863</span>  <span class="comment">//BEGIN magnetic and electric parameters</span></div>
<div class="line"><span class="lineno">  864</span> </div>
<div class="line"><span class="lineno">  865</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno">  866</span>  <span class="comment">//double I = 1.e5; // electric current intensity</span></div>
<div class="line"><span class="lineno">  867</span>  <span class="comment">//double I = 0.5 * 1.e5;</span></div>
<div class="line"><span class="lineno">  868</span>  <span class="keywordtype">double</span> I = 2 * 1.e5;</div>
<div class="line"><span class="lineno">  869</span>  <span class="keywordtype">double</span> Msat = 1.e6;  <span class="comment">//  magnetic saturation</span></div>
<div class="line"><span class="lineno">  870</span>  <span class="keywordtype">double</span>  chi = 3.; <span class="comment">//magnetic susceptibility</span></div>
<div class="line"><span class="lineno">  871</span>  <span class="keywordtype">double</span> mu0 = 4 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * 1.e-7;  <span class="comment">//magnetic permeability of the vacuum</span></div>
<div class="line"><span class="lineno">  872</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a>;</div>
<div class="line"><span class="lineno">  873</span>  std::vector &lt;double&gt; gradH ( 3 );</div>
<div class="line"><span class="lineno">  874</span>  std::vector &lt;double&gt; gradHSquared ( 3 );</div>
<div class="line"><span class="lineno">  875</span>  std::vector&lt;double&gt; vectorH ( 3 );</div>
<div class="line"><span class="lineno">  876</span>  <span class="keywordtype">double</span> H0 = Msat / chi;</div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>  <span class="comment">//BEGIN fluid viscosity</span></div>
<div class="line"><span class="lineno">  882</span> </div>
<div class="line"><span class="lineno">  883</span>  <span class="keywordtype">double</span> muf = ( material == 2 ) ? 3.5 * 1.0e-3 : 1.0e100; <span class="comment">// fluid viscosity</span></div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  886</span> </div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>  <span class="comment">//BEGIN geometric parameters</span></div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>  <span class="keywordtype">double</span> D = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 0.1 * 1.e-6;      <span class="comment">//diameter of the particle //rule con partSim</span></div>
<div class="line"><span class="lineno">  891</span> </div>
<div class="line"><span class="lineno">  892</span>  std::vector &lt;double&gt; v ( 3 ); <span class="comment">//direction vector of the line that identifies the infinite wire</span></div>
<div class="line"><span class="lineno">  893</span>  std::vector &lt;double&gt; x ( 3 ); <span class="comment">//point that with v identifies the line of the wire</span></div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 0 ) {</div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span>    x[0] = 0.02093036072;</div>
<div class="line"><span class="lineno">  898</span>    x[1] = 0.02093036072;</div>
<div class="line"><span class="lineno">  899</span>    x[2] = 0.;</div>
<div class="line"><span class="lineno">  900</span> </div>
<div class="line"><span class="lineno">  901</span>    v[0] = 0.;</div>
<div class="line"><span class="lineno">  902</span>    v[1] = 0.;</div>
<div class="line"><span class="lineno">  903</span>    v[2] = -1.;</div>
<div class="line"><span class="lineno">  904</span> </div>
<div class="line"><span class="lineno">  905</span>  }</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 1 ) {</div>
<div class="line"><span class="lineno">  908</span> </div>
<div class="line"><span class="lineno">  909</span>    x[0] = 0.006788225;</div>
<div class="line"><span class="lineno">  910</span>    x[1] = 0.006788225;</div>
<div class="line"><span class="lineno">  911</span>    x[2] = 0.;</div>
<div class="line"><span class="lineno">  912</span> </div>
<div class="line"><span class="lineno">  913</span>    v[0] = 0.;</div>
<div class="line"><span class="lineno">  914</span>    v[1] = 0.;</div>
<div class="line"><span class="lineno">  915</span>    v[2] = -1.;</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>  }</div>
<div class="line"><span class="lineno">  918</span> </div>
<div class="line"><span class="lineno">  919</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 2 ) {</div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span>    x[0] = 0.0196 * sqrt ( 2 ) / 2;</div>
<div class="line"><span class="lineno">  922</span>    x[1] = 0.0196 * sqrt ( 2 ) / 2;</div>
<div class="line"><span class="lineno">  923</span>    x[2] = 0.01;</div>
<div class="line"><span class="lineno">  924</span> </div>
<div class="line"><span class="lineno">  925</span>    v[0] = sqrt ( 2 ) / 2.;</div>
<div class="line"><span class="lineno">  926</span>    v[1] = sqrt ( 2 ) / 2.;</div>
<div class="line"><span class="lineno">  927</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>  }</div>
<div class="line"><span class="lineno">  930</span> </div>
<div class="line"><span class="lineno">  931</span> </div>
<div class="line"><span class="lineno">  932</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> == 3 ) {</div>
<div class="line"><span class="lineno">  933</span> </div>
<div class="line"><span class="lineno">  934</span>    x[0] = 0.0196 * sqrt ( 2 ) / 2;</div>
<div class="line"><span class="lineno">  935</span>    x[1] = 0.0196 * sqrt ( 2 ) / 2;</div>
<div class="line"><span class="lineno">  936</span>    x[2] = 0.01;</div>
<div class="line"><span class="lineno">  937</span> </div>
<div class="line"><span class="lineno">  938</span>    v[0] = - sqrt ( 2 ) / 2.;</div>
<div class="line"><span class="lineno">  939</span>    v[1] = sqrt ( 2 ) / 2.;</div>
<div class="line"><span class="lineno">  940</span>    v[2] = 0.;</div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>  }</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span> </div>
<div class="line"><span class="lineno">  945</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>  <span class="comment">//BEGIN extraction of the coordinates of the particle</span></div>
<div class="line"><span class="lineno">  949</span> </div>
<div class="line"><span class="lineno">  950</span>  std::vector &lt;double&gt; xM ( 3 );</div>
<div class="line"><span class="lineno">  951</span>  xM[0] = xMarker[0];</div>
<div class="line"><span class="lineno">  952</span>  xM[1] = xMarker[1];</div>
<div class="line"><span class="lineno">  953</span>  xM[2] = ( xMarker.size() == 3 ) ? xMarker[2] : 0. ;</div>
<div class="line"><span class="lineno">  954</span> </div>
<div class="line"><span class="lineno">  955</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  956</span> </div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>  <span class="comment">//BEGIN evaluate H</span></div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a>;</div>
<div class="line"><span class="lineno">  961</span>  <span class="keywordtype">double</span> Omega;</div>
<div class="line"><span class="lineno">  962</span>  std::vector&lt;double&gt; gradOmega ( 3 );</div>
<div class="line"><span class="lineno">  963</span> </div>
<div class="line"><span class="lineno">  964</span>  <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> = sqrt ( v[0] * v[0] + v[1] * v[1] + v[2] * v[2] );</div>
<div class="line"><span class="lineno">  965</span>  Omega = ( v[2] * ( x[1] - xM[1] ) - v[1] * ( x[2] - xM[2] ) ) * ( v[2] * ( x[1] - xM[1] ) - v[1] * ( x[2] - xM[2] ) ) +</div>
<div class="line"><span class="lineno">  966</span>          ( v[2] * ( x[0] - xM[0] ) - v[0] * ( x[2] - xM[2] ) ) * ( v[2] * ( x[0] - xM[0] ) - v[0] * ( x[2] - xM[2] ) ) +</div>
<div class="line"><span class="lineno">  967</span>          ( v[1] * ( x[0] - xM[0] ) - v[0] * ( x[1] - xM[1] ) ) * ( v[1] * ( x[0] - xM[0] ) - v[0] * ( x[1] - xM[1] ) ) ;</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span>  gradOmega[0] = 2 * v[2] * ( v[2] * ( x[0] - xM[0] ) - v[0] * ( x[2] - xM[2] ) ) + 2 * v[1] * ( v[1] * ( x[0] - xM[0] ) - v[0] * ( x[1] - xM[1] ) );</div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span>  gradOmega[1] = 2 * v[2] * ( v[2] * ( x[1] - xM[1] ) - v[1] * ( x[2] - xM[2] ) ) - 2 * v[0] * ( v[1] * ( x[0] - xM[0] ) - v[0] * ( x[1] - xM[1] ) );</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>  gradOmega[2] = - 2 * v[1] * ( v[2] * ( x[1] - xM[1] ) - v[1] * ( x[2] - xM[2] ) ) - 2 * v[0] * ( v[2] * ( x[0] - xM[0] ) - v[0] * ( x[2] - xM[2] ) );</div>
<div class="line"><span class="lineno">  974</span> </div>
<div class="line"><span class="lineno">  975</span>  <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> = ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * ( 1 / sqrt ( Omega ) );</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>  gradHSquared[0] = ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( ( -1 ) * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * ( 1 / ( Omega * Omega ) ) ) * gradOmega[0];</div>
<div class="line"><span class="lineno">  978</span>  gradHSquared[1] = ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( ( -1 ) * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * ( 1 / ( Omega * Omega ) ) ) * gradOmega[1];</div>
<div class="line"><span class="lineno">  979</span>  gradHSquared[2] = ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( ( -1 ) * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * ( 1 / ( Omega * Omega ) ) ) * gradOmega[2];</div>
<div class="line"><span class="lineno">  980</span> </div>
<div class="line"><span class="lineno">  981</span>  gradH[0] = ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( ( -0.5 ) * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * gradOmega[0] ) / sqrt ( Omega * Omega * Omega );</div>
<div class="line"><span class="lineno">  982</span>  gradH[1] = ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( ( -0.5 ) * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * gradOmega[1] ) / sqrt ( Omega * Omega * Omega );</div>
<div class="line"><span class="lineno">  983</span>  gradH[2] = ( I / ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> ) ) * ( ( -0.5 ) * <a class="code hl_variable" href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a> * gradOmega[2] ) / sqrt ( Omega * Omega * Omega );</div>
<div class="line"><span class="lineno">  984</span> </div>
<div class="line"><span class="lineno">  985</span> </div>
<div class="line"><span class="lineno">  986</span>  <span class="comment">//BEGIN evaluate Fm</span></div>
<div class="line"><span class="lineno">  987</span> </div>
<div class="line"><span class="lineno">  988</span>  <span class="keywordflow">if</span> ( <span class="keyword">true</span> || <a class="code hl_variable" href="cylinder__beam__3d__benchmark_8cpp.html#ad7cd26dc1ce30ff209c71b309a3134e6">H</a> &lt; H0 ) {</div>
<div class="line"><span class="lineno">  989</span> </div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>    <span class="keywordtype">double</span> C1 = ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * D * D * D * mu0 * chi ) / 12;</div>
<div class="line"><span class="lineno">  992</span>    <span class="comment">// printf(&quot;%g\n&quot;,C1);</span></div>
<div class="line"><span class="lineno">  993</span>    Fm[0] = C1 * gradHSquared[0];</div>
<div class="line"><span class="lineno">  994</span>    Fm[1] = C1 * gradHSquared[1];</div>
<div class="line"><span class="lineno">  995</span>    Fm[2] = C1 * gradHSquared[2];</div>
<div class="line"><span class="lineno">  996</span>  }</div>
<div class="line"><span class="lineno">  997</span> </div>
<div class="line"><span class="lineno">  998</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span> </div>
<div class="line"><span class="lineno"> 1001</span>    <span class="keywordtype">double</span> C2 = ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * D * D * D * mu0 * Msat ) / 6;</div>
<div class="line"><span class="lineno"> 1002</span> </div>
<div class="line"><span class="lineno"> 1003</span>    <span class="comment">//printf(&quot;%g\n&quot;,C2);</span></div>
<div class="line"><span class="lineno"> 1004</span>    Fm[0] = C2 * gradH[0];</div>
<div class="line"><span class="lineno"> 1005</span>    Fm[1] = C2 * gradH[1];</div>
<div class="line"><span class="lineno"> 1006</span>    Fm[2] = C2 * gradH[2];</div>
<div class="line"><span class="lineno"> 1007</span> </div>
<div class="line"><span class="lineno"> 1008</span>  }</div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span> </div>
<div class="line"><span class="lineno"> 1011</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0 ; i &lt; Fm.size(); i++ ) {</div>
<div class="line"><span class="lineno"> 1012</span>    Fm[i] = Fm[i] / ( 3 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * D * muf ) ;</div>
<div class="line"><span class="lineno"> 1013</span>  }</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span> </div>
<div class="line"><span class="lineno"> 1018</span>  <span class="comment">//BEGIN cheating to have attractive force</span></div>
<div class="line"><span class="lineno"> 1019</span> </div>
<div class="line"><span class="lineno"> 1020</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0 ; i &lt; Fm.size(); i++ ) {</div>
<div class="line"><span class="lineno"> 1021</span>    Fm[i] = - Fm[i] ;</div>
<div class="line"><span class="lineno"> 1022</span>    <span class="comment">//printf(&quot;%g &quot;,Fm[i]);</span></div>
<div class="line"><span class="lineno"> 1023</span>  }</div>
<div class="line"><span class="lineno"> 1024</span> </div>
<div class="line"><span class="lineno"> 1025</span> </div>
<div class="line"><span class="lineno"> 1026</span>  <span class="comment">//END cheating</span></div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span>}</div>
<div class="ttc" id="a_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp_html_a1a0cbbb118b67bb2a3f1f682c0dad85b"><div class="ttname"><a href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a1a0cbbb118b67bb2a3f1f682c0dad85b">Gamma</a></div><div class="ttdeci">double Gamma</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp_source.html#l00010">FSITimeDependentAssemblySupgNonConservativeTwoPressuresNewmark.hpp:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a29781a20c5dd4153c3c1cecf0ff328" name="a7a29781a20c5dd4153c3c1cecf0ff328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a29781a20c5dd4153c3c1cecf0ff328">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>FSI Aortic Bifurcation 2D</p>
<p>FSI Tubo 3D</p>
<p>FSI Carotid Bifurcation 3D</p>
<p>FSI Carotid Bifurcation 3D</p>

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00056">56</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>{</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>  <span class="comment">// ******* Init Petsc-MPI communicator *******</span></div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_class" href="classfemus_1_1_femus_init.html">FemusInit</a> mpinit ( argc, args, MPI_COMM_WORLD );</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_variable" href="namespacefemus.html#a9f30b7c76f4daea4a5dd0cf1dc855e87">twoPressure</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   63</span>  <a class="code hl_variable" href="namespacefemus.html#a59a34d23c69142d91f84525f5aa78db9">valve</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> = 0;</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>  <span class="keywordflow">if</span> ( argc &gt;= 2 ) {</div>
<div class="line"><span class="lineno">   68</span>    <span class="keywordflow">if</span> ( !strcmp ( <span class="stringliteral">&quot;0&quot;</span>, args[1] ) ) { </div>
<div class="line"><span class="lineno">   69</span>      <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> = 0;</div>
<div class="line"><span class="lineno">   70</span>    }</div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( <span class="stringliteral">&quot;1&quot;</span>, args[1] ) ) { </div>
<div class="line"><span class="lineno">   72</span>      <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> = 1;</div>
<div class="line"><span class="lineno">   73</span>    }</div>
<div class="line"><span class="lineno">   74</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( <span class="stringliteral">&quot;2&quot;</span>, args[1] ) ) { </div>
<div class="line"><span class="lineno">   75</span>      <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> = 2;</div>
<div class="line"><span class="lineno">   76</span>    }</div>
<div class="line"><span class="lineno">   77</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( <span class="stringliteral">&quot;3&quot;</span>, args[1] ) ) { </div>
<div class="line"><span class="lineno">   78</span>      <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> = 3;</div>
<div class="line"><span class="lineno">   79</span>    }</div>
<div class="line"><span class="lineno">   80</span>  }</div>
<div class="line"><span class="lineno">   81</span> </div>
<div class="line"><span class="lineno">   82</span>  <span class="comment">//Files files;</span></div>
<div class="line"><span class="lineno">   83</span>  <span class="comment">//files.CheckIODirectories(true);</span></div>
<div class="line"><span class="lineno">   84</span>  <span class="comment">//files.RedirectCout(true);</span></div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <span class="comment">// ******* Extract the problem dimension and simulation identifier based on the inline input *******</span></div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  <span class="comment">// ******* Extract the mesh.neu file name based on the simulation identifier *******</span></div>
<div class="line"><span class="lineno">   90</span>  std::string infile;</div>
<div class="line"><span class="lineno">   91</span>  <span class="keywordtype">bool</span> dimension2D = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 0 ) {</div>
<div class="line"><span class="lineno">   94</span>    infile = <span class="stringliteral">&quot;./input/aortic_bifurcation.neu&quot;</span>;</div>
<div class="line"><span class="lineno">   95</span>  }</div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) {</div>
<div class="line"><span class="lineno">   97</span>    infile = <span class="stringliteral">&quot;./input/tubo3D.neu&quot;</span>;</div>
<div class="line"><span class="lineno">   98</span>    <span class="comment">//infile = &quot;./input/tubo3D_thick.neu&quot;; //used only once, not important</span></div>
<div class="line"><span class="lineno">   99</span>    dimension2D = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  100</span>  }</div>
<div class="line"><span class="lineno">  101</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) {</div>
<div class="line"><span class="lineno">  102</span>    infile = <span class="stringliteral">&quot;./input/carotid_bifurcation_3D.neu&quot;</span>;</div>
<div class="line"><span class="lineno">  103</span>    dimension2D = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  104</span>  }</div>
<div class="line"><span class="lineno">  105</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) {</div>
<div class="line"><span class="lineno">  106</span>    infile = <span class="stringliteral">&quot;./input/magnetic_stents_solidWires.neu&quot;</span>;</div>
<div class="line"><span class="lineno">  107</span>  }</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>  <span class="comment">// ******* Set physics parameters *******</span></div>
<div class="line"><span class="lineno">  111</span>  <span class="keywordtype">double</span> Lref, Uref, rhof, muf, rhos, ni, E, E1;</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  Lref = 1.;</div>
<div class="line"><span class="lineno">  114</span>  Uref = 1.;</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>  rhof = 1035.;</div>
<div class="line"><span class="lineno">  117</span>  muf = 3.5 * 1.0e-3; <span class="comment">//wrong=3.38*1.0e-4*rhof, note:3.38*1.0e-6*rhof=3.5*1.0e-3</span></div>
<div class="line"><span class="lineno">  118</span>  rhos = 1120;</div>
<div class="line"><span class="lineno">  119</span>  ni = 0.5;</div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 0 ) { <span class="comment">//aortic_bifurcation</span></div>
<div class="line"><span class="lineno">  121</span>    E = 100 * 1.e6;</div>
<div class="line"><span class="lineno">  122</span>  }</div>
<div class="line"><span class="lineno">  123</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) { <span class="comment">//tubo3D</span></div>
<div class="line"><span class="lineno">  124</span>    <span class="comment">//E = 1000;</span></div>
<div class="line"><span class="lineno">  125</span>    E = 1. * 1.e12 ;</div>
<div class="line"><span class="lineno">  126</span>  }</div>
<div class="line"><span class="lineno">  127</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) { <span class="comment">//carotide</span></div>
<div class="line"><span class="lineno">  128</span>    <span class="comment">//E = 1.e6 * 1.e6; //CFD case</span></div>
<div class="line"><span class="lineno">  129</span>    E = 1 * 1.e6; <span class="comment">// FSI with E = 1 MPa</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">//E = 0.5 * 1.e6; // FSI with E = 0.5 MPa</span></div>
<div class="line"><span class="lineno">  131</span>  }</div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) { <span class="comment">//magnetic_stents</span></div>
<div class="line"><span class="lineno">  133</span>    E = 1. * 1.e6;</div>
<div class="line"><span class="lineno">  134</span>  }</div>
<div class="line"><span class="lineno">  135</span>  E1 = 1000;</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  <a class="code hl_class" href="classfemus_1_1_parameter.html">Parameter</a> par ( Lref, Uref );</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  <span class="comment">// Generate Solid Object</span></div>
<div class="line"><span class="lineno">  141</span>  <a class="code hl_class" href="classfemus_1_1_solid.html">Solid</a> solid;</div>
<div class="line"><span class="lineno">  142</span>  solid = <a class="code hl_class" href="classfemus_1_1_solid.html">Solid</a> ( par, E, ni, rhos, <span class="stringliteral">&quot;Mooney-Rivlin&quot;</span> );</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>  <a class="code hl_class" href="classfemus_1_1_solid.html">Solid</a> solid1;</div>
<div class="line"><span class="lineno">  145</span>  solid1 = <a class="code hl_class" href="classfemus_1_1_solid.html">Solid</a> ( par, E1, ni, rhos, <span class="stringliteral">&quot;Mooney-Rivlin&quot;</span> );</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>  cout &lt;&lt; <span class="stringliteral">&quot;Solid properties: &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  148</span>  cout &lt;&lt; solid &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>  <span class="comment">// Generate Fluid Object</span></div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_class" href="classfemus_1_1_fluid.html">Fluid</a> fluid ( par, muf, rhof, <span class="stringliteral">&quot;Newtonian&quot;</span> );</div>
<div class="line"><span class="lineno">  152</span>  cout &lt;&lt; <span class="stringliteral">&quot;Fluid properties: &quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  153</span>  cout &lt;&lt; fluid &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>  <span class="comment">// ******* Init multilevel mesh from mesh.neu file *******</span></div>
<div class="line"><span class="lineno">  156</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> <a class="code hl_variable" href="fsi_steady_m_g_8cpp.html#a79d6dc8c192d4ac163f592ba4e7d1d7e">numberOfUniformRefinedMeshes</a>, numberOfAMRLevels;</div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_variable" href="fsi_steady_m_g_8cpp.html#a79d6dc8c192d4ac163f592ba4e7d1d7e">numberOfUniformRefinedMeshes</a> = 1;</div>
<div class="line"><span class="lineno">  159</span>  numberOfAMRLevels = 0;</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  std::cout &lt;&lt; 0 &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_msh ( <a class="code hl_variable" href="fsi_steady_m_g_8cpp.html#a79d6dc8c192d4ac163f592ba4e7d1d7e">numberOfUniformRefinedMeshes</a> + numberOfAMRLevels, <a class="code hl_variable" href="fsi_steady_m_g_8cpp.html#a79d6dc8c192d4ac163f592ba4e7d1d7e">numberOfUniformRefinedMeshes</a>,</div>
<div class="line"><span class="lineno">  164</span>                          infile.c_str(), <span class="stringliteral">&quot;fifth&quot;</span>, Lref, NULL );</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span><span class="comment">//   MultiLevelMesh ml_msh1(numberOfUniformRefinedMeshes + numberOfAMRLevels, numberOfUniformRefinedMeshes,</span></div>
<div class="line"><span class="lineno">  167</span><span class="comment">//                          infile.c_str(), &quot;fifth&quot;, Lref, NULL);</span></div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span><span class="comment">//   ml_msh.EraseCoarseLevels(numberOfUniformRefinedMeshes - 1);</span></div>
<div class="line"><span class="lineno">  170</span><span class="comment">//   numberOfUniformRefinedMeshes = 1;</span></div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  ml_msh.PrintInfo();</div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  <span class="comment">// mark Solid nodes</span></div>
<div class="line"><span class="lineno">  176</span>  <span class="comment">// ml_msh.MarkStructureNode();</span></div>
<div class="line"><span class="lineno">  177</span> </div>
<div class="line"><span class="lineno">  178</span>  <span class="comment">// ******* Init multilevel solution ******</span></div>
<div class="line"><span class="lineno">  179</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> ml_sol ( &amp;ml_msh );</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>  ml_sol.SetIfFSI ( <span class="keyword">true</span> );</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span>  <span class="comment">// ******* Add solution variables to multilevel solution and pair them *******</span></div>
<div class="line"><span class="lineno">  184</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;DX&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 2 );</div>
<div class="line"><span class="lineno">  185</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;DY&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 2 );</div>
<div class="line"><span class="lineno">  186</span>  <span class="keywordflow">if</span> ( !dimension2D ) ml_sol.AddSolution ( <span class="stringliteral">&quot;DZ&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 2 );</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;U&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 2 );</div>
<div class="line"><span class="lineno">  189</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;V&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 2 );</div>
<div class="line"><span class="lineno">  190</span>  <span class="keywordflow">if</span> ( !dimension2D ) ml_sol.AddSolution ( <span class="stringliteral">&quot;W&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 2 );</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>  <span class="comment">// Pair each velocity variable with the corresponding displacement variable</span></div>
<div class="line"><span class="lineno">  193</span>  ml_sol.PairSolution ( <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;DX&quot;</span> ); <span class="comment">// Add this line</span></div>
<div class="line"><span class="lineno">  194</span>  ml_sol.PairSolution ( <span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;DY&quot;</span> ); <span class="comment">// Add this line</span></div>
<div class="line"><span class="lineno">  195</span>  <span class="keywordflow">if</span> ( !dimension2D ) ml_sol.PairSolution ( <span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;DZ&quot;</span> ); <span class="comment">// Add this line</span></div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>  <span class="comment">// Since the Pressure is a Lagrange multiplier it is used as an implicit variable</span></div>
<div class="line"><span class="lineno">  198</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;PS&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, 2 );</div>
<div class="line"><span class="lineno">  199</span>  ml_sol.AssociatePropertyToSolution ( <span class="stringliteral">&quot;PS&quot;</span>, <span class="stringliteral">&quot;Pressure&quot;</span>, <span class="keyword">false</span> ); <span class="comment">// Add this line</span></div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;PF&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, 2 );</div>
<div class="line"><span class="lineno">  202</span>  ml_sol.AssociatePropertyToSolution ( <span class="stringliteral">&quot;PF&quot;</span>, <span class="stringliteral">&quot;Pressure&quot;</span>, <span class="keyword">false</span> ); <span class="comment">// Add this line</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;lmbd&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, 0, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;Um&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 0, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  207</span>  ml_sol.AddSolution ( <span class="stringliteral">&quot;Vm&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 0, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordflow">if</span> ( !dimension2D ) ml_sol.AddSolution ( <span class="stringliteral">&quot;Wm&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, 0, <span class="keyword">false</span> );</div>
<div class="line"><span class="lineno">  209</span> </div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">// ******* Initialize solution *******</span></div>
<div class="line"><span class="lineno">  211</span>  ml_sol.Initialize ( <span class="stringliteral">&quot;All&quot;</span> );</div>
<div class="line"><span class="lineno">  212</span> </div>
<div class="line"><span class="lineno">  213</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 0 ) {</div>
<div class="line"><span class="lineno">  214</span>    ml_sol.AttachSetBoundaryConditionFunction ( <a class="code hl_function" href="magnetic__stents_8cpp.html#ab3fdd5f4775bbdd38ffe27fb6a232799">SetBoundaryConditionAorticBifurcation</a> );</div>
<div class="line"><span class="lineno">  215</span>  }</div>
<div class="line"><span class="lineno">  216</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) {</div>
<div class="line"><span class="lineno">  217</span>    ml_sol.AttachSetBoundaryConditionFunction ( <a class="code hl_function" href="magnetic__stents_8cpp.html#a95e7008a8dc52128d7dde0029e5ddd5d">SetBoundaryConditionTubo3D</a> );</div>
<div class="line"><span class="lineno">  218</span>  }</div>
<div class="line"><span class="lineno">  219</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) {</div>
<div class="line"><span class="lineno">  220</span>    ml_sol.AttachSetBoundaryConditionFunction ( <a class="code hl_function" href="magnetic__stents_8cpp.html#af5e696906686ccd7c8afb2fd4ee846ad">SetBoundaryConditionCarotidBifurcation</a> );</div>
<div class="line"><span class="lineno">  221</span>  }</div>
<div class="line"><span class="lineno">  222</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) {</div>
<div class="line"><span class="lineno">  223</span>    ml_sol.AttachSetBoundaryConditionFunction ( <a class="code hl_function" href="magnetic__stents_8cpp.html#aec52f43f998adde5ed3ccb6c4b21dac2">SetBoundaryConditionMagneticStents</a> );</div>
<div class="line"><span class="lineno">  224</span>  }</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>  <span class="comment">// ******* Set boundary conditions *******</span></div>
<div class="line"><span class="lineno">  227</span>  ml_sol.GenerateBdc ( <span class="stringliteral">&quot;DX&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  228</span>  ml_sol.GenerateBdc ( <span class="stringliteral">&quot;DY&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordflow">if</span> ( !dimension2D ) ml_sol.GenerateBdc ( <span class="stringliteral">&quot;DZ&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 0 ) {</div>
<div class="line"><span class="lineno">  232</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  233</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Time_dependent&quot;</span> );</div>
<div class="line"><span class="lineno">  234</span>  }</div>
<div class="line"><span class="lineno">  235</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) {</div>
<div class="line"><span class="lineno">  236</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;Time_dependent&quot;</span> );</div>
<div class="line"><span class="lineno">  237</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  238</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  239</span>  }</div>
<div class="line"><span class="lineno">  240</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) {</div>
<div class="line"><span class="lineno">  241</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  242</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  243</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;W&quot;</span>, <span class="stringliteral">&quot;Time_dependent&quot;</span> );</div>
<div class="line"><span class="lineno">  244</span>  }</div>
<div class="line"><span class="lineno">  245</span>  <span class="keywordflow">else</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) {</div>
<div class="line"><span class="lineno">  246</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;U&quot;</span>, <span class="stringliteral">&quot;Time_dependent&quot;</span> );</div>
<div class="line"><span class="lineno">  247</span>    ml_sol.GenerateBdc ( <span class="stringliteral">&quot;V&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  248</span>  }</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>  ml_sol.GenerateBdc ( <span class="stringliteral">&quot;PS&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  251</span>  ml_sol.GenerateBdc ( <span class="stringliteral">&quot;PF&quot;</span>, <span class="stringliteral">&quot;Steady&quot;</span> );</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  <span class="comment">// ******* Define the FSI Multilevel Problem *******</span></div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob ( &amp;ml_sol );</div>
<div class="line"><span class="lineno">  257</span>  <span class="comment">// Add fluid object</span></div>
<div class="line"><span class="lineno">  258</span>  ml_prob.parameters.set&lt;<a class="code hl_class" href="classfemus_1_1_fluid.html">Fluid</a>&gt; ( <span class="stringliteral">&quot;Fluid&quot;</span> ) = fluid;</div>
<div class="line"><span class="lineno">  259</span>  <span class="comment">// Add Solid Object</span></div>
<div class="line"><span class="lineno">  260</span>  ml_prob.parameters.set&lt;<a class="code hl_class" href="classfemus_1_1_solid.html">Solid</a>&gt; ( <span class="stringliteral">&quot;Solid&quot;</span> ) = solid;</div>
<div class="line"><span class="lineno">  261</span>  ml_prob.parameters.set&lt;<a class="code hl_class" href="classfemus_1_1_solid.html">Solid</a>&gt; ( <span class="stringliteral">&quot;Solid1&quot;</span> ) = solid1;</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>  <span class="comment">// ******* Add FSI system to the MultiLevel problem *******</span></div>
<div class="line"><span class="lineno">  264</span>  <a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientMonolithicFSINonlinearImplicitSystem</a> &amp; system = ml_prob.add_system&lt;<a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientMonolithicFSINonlinearImplicitSystem</a>&gt; ( <span class="stringliteral">&quot;Fluid-Structure-Interaction&quot;</span> );</div>
<div class="line"><span class="lineno">  265</span>  system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;DX&quot;</span> );</div>
<div class="line"><span class="lineno">  266</span>  system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;DY&quot;</span> );</div>
<div class="line"><span class="lineno">  267</span>  <span class="keywordflow">if</span> ( !dimension2D ) system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;DZ&quot;</span> );</div>
<div class="line"><span class="lineno">  268</span>  system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;U&quot;</span> );</div>
<div class="line"><span class="lineno">  269</span>  system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;V&quot;</span> );</div>
<div class="line"><span class="lineno">  270</span>  <span class="keywordflow">if</span> ( !dimension2D ) system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;W&quot;</span> );</div>
<div class="line"><span class="lineno">  271</span>  system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;PS&quot;</span> );</div>
<div class="line"><span class="lineno">  272</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="namespacefemus.html#a9f30b7c76f4daea4a5dd0cf1dc855e87">twoPressure</a> ) system.AddSolutionToSystemPDE ( <span class="stringliteral">&quot;PF&quot;</span> );</div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span>  <span class="comment">// ******* System Fluid-Structure-Interaction Assembly *******</span></div>
<div class="line"><span class="lineno">  275</span>  system.SetAssembleFunction ( <a class="code hl_function" href="namespacefemus.html#afe5dc8c9b84f44b2474a91a1d08e604a">FSITimeDependentAssemblySupgNew2</a> );</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>  <span class="comment">// ******* set MG-Solver *******</span></div>
<div class="line"><span class="lineno">  278</span>  system.SetMgType ( <a class="code hl_enumvalue" href="_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a6ce16ab03eaaecb71458081ce0147fa0">F_CYCLE</a> );</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>  system.SetNonLinearConvergenceTolerance ( 1.e-7 );</div>
<div class="line"><span class="lineno">  281</span>  system.SetMaxNumberOfNonLinearIterations ( 20 );</div>
<div class="line"><span class="lineno">  282</span>  <span class="keywordflow">if</span> ( dimension2D ) {</div>
<div class="line"><span class="lineno">  283</span><span class="comment">//     system.SetMaxNumberOfResidualUpdatesForNonlinearIteration(4);</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">//     system.SetResidualUpdateConvergenceTolerance(1.e-15);</span></div>
<div class="line"><span class="lineno">  285</span>    system.SetMaxNumberOfLinearIterations ( 1 );</div>
<div class="line"><span class="lineno">  286</span>    system.SetAbsoluteLinearConvergenceTolerance ( 1.e-50 );</div>
<div class="line"><span class="lineno">  287</span>  }</div>
<div class="line"><span class="lineno">  288</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  289</span><span class="comment">//     system.SetMaxNumberOfLinearIterations(4);</span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">//     system.SetAbsoluteLinearConvergenceTolerance(1.e-15);</span></div>
<div class="line"><span class="lineno">  291</span>    system.SetMaxNumberOfLinearIterations ( 1 );</div>
<div class="line"><span class="lineno">  292</span>    system.SetAbsoluteLinearConvergenceTolerance ( 1.e-50 );</div>
<div class="line"><span class="lineno">  293</span>  }</div>
<div class="line"><span class="lineno">  294</span>  system.SetNumberPreSmoothingStep ( 1 );</div>
<div class="line"><span class="lineno">  295</span>  system.SetNumberPostSmoothingStep ( 1 );</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>  <span class="comment">// ******* Set Preconditioner *******</span></div>
<div class="line"><span class="lineno">  298</span> </div>
<div class="line"><span class="lineno">  299</span>  system.SetLinearEquationSolverType ( <a class="code hl_enumvalue" href="_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e">FEMuS_ASM</a> );</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>  system.init();</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>  <span class="comment">// ******* Set Smoother *******</span></div>
<div class="line"><span class="lineno">  304</span>  system.SetSolverFineGrids ( <a class="code hl_enumvalue" href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3">RICHARDSON</a> );</div>
<div class="line"><span class="lineno">  305</span>  <span class="comment">//system.SetSolverFineGrids(GMRES);</span></div>
<div class="line"><span class="lineno">  306</span>  system.SetRichardsonScaleFactor ( 0.4 );</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  system.SetPreconditionerFineGrids ( <a class="code hl_enumvalue" href="_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da">MLU_PRECOND</a> );</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>  <span class="keywordflow">if</span> ( dimension2D ) system.SetTolerances ( 1.e-10, 1.e-9, 1.e+50, 40, 40 );</div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordflow">else</span> system.SetTolerances ( 1.e-10, 1.e-50, 1.e+50, 40, 40 );</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>  <span class="comment">// ******* Add variables to be solved *******</span></div>
<div class="line"><span class="lineno">  314</span>  system.ClearVariablesToBeSolved();</div>
<div class="line"><span class="lineno">  315</span>  system.AddVariableToBeSolved ( <span class="stringliteral">&quot;All&quot;</span> );</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>  <span class="comment">// ******* Set the last (1) variables in system (i.e. P) to be a schur variable *******</span></div>
<div class="line"><span class="lineno">  318</span>  system.SetNumberOfSchurVariables ( 2 );</div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>  <span class="comment">// ******* Set block size for the ASM smoothers *******</span></div>
<div class="line"><span class="lineno">  321</span>  <span class="keywordflow">if</span> ( dimension2D ) system.SetElementBlockNumber ( 4 );</div>
<div class="line"><span class="lineno">  322</span>  <span class="keywordflow">else</span> system.SetElementBlockNumber ( 3 );</div>
<div class="line"><span class="lineno">  323</span> </div>
<div class="line"><span class="lineno">  324</span>  <span class="comment">// ******* Print solution *******</span></div>
<div class="line"><span class="lineno">  325</span>  ml_sol.SetWriter ( <a class="code hl_enumvalue" href="_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a> );</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>  std::vector&lt;std::string&gt; mov_vars;</div>
<div class="line"><span class="lineno">  329</span>  mov_vars.push_back ( <span class="stringliteral">&quot;DX&quot;</span> );</div>
<div class="line"><span class="lineno">  330</span>  mov_vars.push_back ( <span class="stringliteral">&quot;DY&quot;</span> );</div>
<div class="line"><span class="lineno">  331</span>  <span class="keywordflow">if</span> ( !dimension2D ) mov_vars.push_back ( <span class="stringliteral">&quot;DZ&quot;</span> );</div>
<div class="line"><span class="lineno">  332</span>  ml_sol.GetWriter()-&gt;SetMovingMesh ( mov_vars );</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span>  std::vector&lt;std::string&gt; print_vars;</div>
<div class="line"><span class="lineno">  335</span>  print_vars.push_back ( <span class="stringliteral">&quot;All&quot;</span> );</div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>  ml_sol.GetWriter()-&gt;SetDebugOutput ( <span class="keyword">true</span> );</div>
<div class="line"><span class="lineno">  338</span>  ml_sol.GetWriter()-&gt;Write ( <a class="code hl_define" href="_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;biquadratic&quot;</span>, print_vars, 0 );</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>  <span class="comment">// ******* Solve *******</span></div>
<div class="line"><span class="lineno">  342</span>  std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  343</span>  std::cout &lt;&lt; <span class="stringliteral">&quot; *********** Fluid-Structure-Interaction ************  &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  <span class="comment">//BEGIN INITIALIZE PARTICLES</span></div>
<div class="line"><span class="lineno">  347</span>  <span class="keywordtype">unsigned</span> pSize = 50;</div>
<div class="line"><span class="lineno">  348</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno">  349</span>  std::vector &lt; std::vector &lt; double &gt; &gt; x ( pSize );</div>
<div class="line"><span class="lineno">  350</span>  std::vector &lt; MarkerType &gt; markerType ( pSize );</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 0 ) { <span class="comment">//for aortic_bifurcation</span></div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; pSize; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  355</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].resize ( 2 );</div>
<div class="line"><span class="lineno">  356</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0] = -0.008 + 0.016 * <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> / ( pSize - 1 );</div>
<div class="line"><span class="lineno">  357</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1] = 0.11;</div>
<div class="line"><span class="lineno">  358</span>      markerType[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = <a class="code hl_enumvalue" href="_marker_type_enum_8hpp.html#ade22213fff69cfb37d8238e8fd3073dfa9d326c2efb1f1ef1840d474c0f9b8a48">VOLUME</a>;</div>
<div class="line"><span class="lineno">  359</span>    }</div>
<div class="line"><span class="lineno">  360</span>  }</div>
<div class="line"><span class="lineno">  361</span> </div>
<div class="line"><span class="lineno">  362</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) { <span class="comment">//for 3D tube</span></div>
<div class="line"><span class="lineno">  363</span>    <span class="keywordtype">unsigned</span> theta_intervals = 100;</div>
<div class="line"><span class="lineno">  364</span>    <span class="keywordtype">unsigned</span> radius_intervals = 9;</div>
<div class="line"><span class="lineno">  365</span>    pSize = radius_intervals * theta_intervals;</div>
<div class="line"><span class="lineno">  366</span>    x.resize ( pSize );</div>
<div class="line"><span class="lineno">  367</span>    markerType.resize ( pSize );</div>
<div class="line"><span class="lineno">  368</span>    srand ( 2 );</div>
<div class="line"><span class="lineno">  369</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; pSize; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  370</span>      <span class="keywordtype">double</span> r_rad = <span class="keyword">static_cast &lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( rand() ) / RAND_MAX;</div>
<div class="line"><span class="lineno">  371</span>      r_rad = 0.0034 * sqrt ( r_rad );</div>
<div class="line"><span class="lineno">  372</span>      <span class="keywordtype">double</span> r_theta = <span class="keyword">static_cast &lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( rand() ) / RAND_MAX * 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a>;</div>
<div class="line"><span class="lineno">  373</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].resize ( 3 );</div>
<div class="line"><span class="lineno">  374</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0] = -0.035;</div>
<div class="line"><span class="lineno">  375</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1] = 0.0196 + r_rad * sin ( r_theta );</div>
<div class="line"><span class="lineno">  376</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][2] = r_rad * cos ( r_theta );</div>
<div class="line"><span class="lineno">  377</span>    }</div>
<div class="line"><span class="lineno">  378</span>  }</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) { <span class="comment">//for carotidBifurcation</span></div>
<div class="line"><span class="lineno">  381</span>    <span class="keywordtype">unsigned</span> theta_intervals = 100;</div>
<div class="line"><span class="lineno">  382</span>    <span class="keywordtype">unsigned</span> radius_intervals = 9;</div>
<div class="line"><span class="lineno">  383</span>    pSize = radius_intervals * theta_intervals;</div>
<div class="line"><span class="lineno">  384</span>    x.resize ( pSize );</div>
<div class="line"><span class="lineno">  385</span>    markerType.resize ( pSize );</div>
<div class="line"><span class="lineno">  386</span>    srand ( 2 );</div>
<div class="line"><span class="lineno">  387</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; pSize; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  388</span>      <span class="keywordtype">double</span> r_rad = <span class="keyword">static_cast &lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( rand() ) / RAND_MAX;</div>
<div class="line"><span class="lineno">  389</span>      r_rad = 0.0034 * sqrt ( r_rad );</div>
<div class="line"><span class="lineno">  390</span>      <span class="keywordtype">double</span> r_theta = <span class="keyword">static_cast &lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( rand() ) / RAND_MAX * 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a>;</div>
<div class="line"><span class="lineno">  391</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].resize ( 3 );</div>
<div class="line"><span class="lineno">  392</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0] = r_rad * cos ( r_theta );</div>
<div class="line"><span class="lineno">  393</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1] = 0.006 + r_rad * sin ( r_theta );</div>
<div class="line"><span class="lineno">  394</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][2] = -0.06;</div>
<div class="line"><span class="lineno">  395</span>    }</div>
<div class="line"><span class="lineno">  396</span><span class="comment">//     unsigned counter = 0;</span></div>
<div class="line"><span class="lineno">  397</span><span class="comment">//     for (unsigned k = 1; k &lt; radius_intervals + 1 ; k++) {</span></div>
<div class="line"><span class="lineno">  398</span><span class="comment">//       for (unsigned j = 0; j &lt; theta_intervals; j++) {</span></div>
<div class="line"><span class="lineno">  399</span><span class="comment">//         x[counter].resize(3);</span></div>
<div class="line"><span class="lineno">  400</span><span class="comment">//         x[counter][0] = 0.00033 * k * sin(2.*PI / theta_intervals * j);</span></div>
<div class="line"><span class="lineno">  401</span><span class="comment">//         x[counter][1] = 0.006 + 0.00033 * k * cos(2.*PI / theta_intervals * j);</span></div>
<div class="line"><span class="lineno">  402</span><span class="comment">//         x[counter][2] = -0.06;</span></div>
<div class="line"><span class="lineno">  403</span><span class="comment">//         counter++;</span></div>
<div class="line"><span class="lineno">  404</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  405</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  406</span>  }</div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) { <span class="comment">//for magnetic_stents</span></div>
<div class="line"><span class="lineno">  409</span>    pSize = 8. * 1.e3;</div>
<div class="line"><span class="lineno">  410</span>    x.resize ( pSize );</div>
<div class="line"><span class="lineno">  411</span>    <span class="keywordtype">double</span> a = -0.0004 + 0.000002;</div>
<div class="line"><span class="lineno">  412</span>    <span class="keywordtype">double</span> <a class="code hl_variable" href="_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = 0.0004 - 0.000002;</div>
<div class="line"><span class="lineno">  413</span>    <span class="keywordtype">double</span> h = ( <a class="code hl_variable" href="_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> - a ) / pSize;</div>
<div class="line"><span class="lineno">  414</span>    markerType.resize ( pSize );</div>
<div class="line"><span class="lineno">  415</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; pSize; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  416</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].resize ( 2 );</div>
<div class="line"><span class="lineno">  417</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][0] = 0.000002;</div>
<div class="line"><span class="lineno">  418</span>      x[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][1] = a + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * h;</div>
<div class="line"><span class="lineno">  419</span>    }</div>
<div class="line"><span class="lineno">  420</span>  }</div>
<div class="line"><span class="lineno">  421</span> </div>
<div class="line"><span class="lineno">  422</span><span class="comment">//   std::cout &lt;&lt; &quot;SUUUUUUUUUUUUUUUUUUUUUUUUUUUUUCA&quot; &lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>  <span class="comment">//END INITIALIZE PARTICLES</span></div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  <span class="keywordtype">unsigned</span> itPeriod = 32 <span class="comment">/*for steady state with dt =100*/</span> <span class="comment">/* for unsteady with dt =1/32, itPeriod = 32*/</span>;</div>
<div class="line"><span class="lineno">  427</span>  <span class="keywordtype">unsigned</span> confNumber;</div>
<div class="line"><span class="lineno">  428</span>  <span class="keywordtype">unsigned</span> partSimMax;</div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) {</div>
<div class="line"><span class="lineno">  430</span>    confNumber = 4;</div>
<div class="line"><span class="lineno">  431</span>    partSimMax = 21;</div>
<div class="line"><span class="lineno">  432</span>  }</div>
<div class="line"><span class="lineno">  433</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) {</div>
<div class="line"><span class="lineno">  434</span>    confNumber = 6;</div>
<div class="line"><span class="lineno">  435</span>    partSimMax = 8;</div>
<div class="line"><span class="lineno">  436</span>  }</div>
<div class="line"><span class="lineno">  437</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) {</div>
<div class="line"><span class="lineno">  438</span>    confNumber = 1;</div>
<div class="line"><span class="lineno">  439</span>    partSimMax = 1;</div>
<div class="line"><span class="lineno">  440</span>  }</div>
<div class="line"><span class="lineno">  441</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  442</span>    confNumber = 1;</div>
<div class="line"><span class="lineno">  443</span>    partSimMax = 1;</div>
<div class="line"><span class="lineno">  444</span>  }</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span> </div>
<div class="line"><span class="lineno">  447</span>  std::vector &lt; std::vector &lt; std::vector &lt; double &gt; &gt; &gt; streamline ( pSize );</div>
<div class="line"><span class="lineno">  448</span>  std::vector &lt; std::vector &lt; std::vector &lt; Line* &gt; &gt; &gt; <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a> ( confNumber );</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>  <span class="keywordflow">for</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> = 0; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> &lt; confNumber; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>++ ) {</div>
<div class="line"><span class="lineno">  451</span>    <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>].resize ( partSimMax );</div>
<div class="line"><span class="lineno">  452</span>    <span class="keywordflow">for</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> = 0; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> &lt; partSimMax; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>++ ) {</div>
<div class="line"><span class="lineno">  453</span>      <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>].resize ( 1 );</div>
<div class="line"><span class="lineno">  454</span>      <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][0] =  <span class="keyword">new</span> <a class="code hl_class" href="classfemus_1_1_line.html">Line</a> ( x, markerType, ml_sol.GetLevel ( <a class="code hl_variable" href="fsi_steady_m_g_8cpp.html#a79d6dc8c192d4ac163f592ba4e7d1d7e">numberOfUniformRefinedMeshes</a> - 1 ), 2 );</div>
<div class="line"><span class="lineno">  455</span>      <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][0]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a4e7742ddfcf4f4e27cff81c51dbd5afd">GetStreamLine</a> ( streamline, 0 );</div>
<div class="line"><span class="lineno">  456</span>      <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][0]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a4e7742ddfcf4f4e27cff81c51dbd5afd">GetStreamLine</a> ( streamline, 1 );</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>      std::ostringstream output_path;</div>
<div class="line"><span class="lineno">  459</span> </div>
<div class="line"><span class="lineno">  460</span>      <span class="keywordtype">double</span> diam;</div>
<div class="line"><span class="lineno">  461</span>      <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) diam = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 0.1 * 1.e-6;</div>
<div class="line"><span class="lineno">  462</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) diam = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 0.5 * 1.e-6;</div>
<div class="line"><span class="lineno">  463</span>      <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) diam = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 2 * 0.43 * 1.e-6;</div>
<div class="line"><span class="lineno">  464</span>      <span class="keywordflow">else</span> diam = 1.;</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span>      output_path &lt;&lt; <span class="stringliteral">&quot;./output/particles-&quot;</span> &lt;&lt; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; diam;</div>
<div class="line"><span class="lineno">  467</span> </div>
<div class="line"><span class="lineno">  468</span>      <a class="code hl_function" href="namespacefemus.html#ab218007e286871c1b8c469f8e78a96b4">PrintLine</a> ( output_path.str(), <span class="stringliteral">&quot;streamline&quot;</span>, streamline, 0 );</div>
<div class="line"><span class="lineno">  469</span>    }</div>
<div class="line"><span class="lineno">  470</span>  }</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span><span class="comment">//      std::cout &lt;&lt; &quot;SUUUUUUUUUUUUUUUUUUUUUUUUUUUUUCA&quot; &lt;&lt;std::endl;</span></div>
<div class="line"><span class="lineno">  473</span> </div>
<div class="line"><span class="lineno">  474</span>  <span class="comment">// time loop parameter</span></div>
<div class="line"><span class="lineno">  475</span>  system.AttachGetTimeIntervalFunction ( <a class="code hl_function" href="magnetic__stents_8cpp.html#ad47bed7d7095b356056b518e0842c75a">SetVariableTimeStep</a> );</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_timesteps = ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) ? 352 : 288 ;</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>  <span class="keywordtype">unsigned</span> count_inside;</div>
<div class="line"><span class="lineno">  480</span>  <span class="keywordtype">unsigned</span> count_out;</div>
<div class="line"><span class="lineno">  481</span>  <span class="keywordtype">unsigned</span> count_tot = pSize;</div>
<div class="line"><span class="lineno">  482</span>  std::vector &lt; std::vector &lt;  double &gt; &gt; efficiencyVector ( confNumber );</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> time_step = 0; time_step &lt; n_timesteps; time_step++ ) {</div>
<div class="line"><span class="lineno">  485</span> </div>
<div class="line"><span class="lineno">  486</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> level = 0; level &lt; <a class="code hl_variable" href="fsi_steady_m_g_8cpp.html#a79d6dc8c192d4ac163f592ba4e7d1d7e">numberOfUniformRefinedMeshes</a>; level++ ) {</div>
<div class="line"><span class="lineno">  487</span>      <a class="code hl_function" href="namespacefemus.html#a3afb24e5e39c6913039027de4e1d970a">SetLambdaNew</a> ( ml_sol, level , <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>, <a class="code hl_enumvalue" href="_oprtr_type_enum_8hpp.html#a7215803e478cdd4bdf4f1b8087cae87ba9893e4ccf5eaa7c78225e38782928aa6">ELASTICITY</a> );</div>
<div class="line"><span class="lineno">  488</span>    }</div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">if</span> ( time_step &gt; 0 )</div>
<div class="line"><span class="lineno">  490</span>      system.SetMgType ( <a class="code hl_enumvalue" href="_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a> );</div>
<div class="line"><span class="lineno">  491</span>    system.CopySolutionToOldSolution();</div>
<div class="line"><span class="lineno">  492</span>    system.MGsolve();</div>
<div class="line"><span class="lineno">  493</span>    <a class="code hl_function" href="namespacefemus.html#a2c4f4bd8ac7fc7156f2e944e294ce267">StoreMeshVelocity</a> ( ml_prob );</div>
<div class="line"><span class="lineno">  494</span>    ml_sol.GetWriter()-&gt;Write ( <a class="code hl_define" href="_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;biquadratic&quot;</span>, print_vars, time_step + 1 );</div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>    <span class="comment">//if (time_step &gt;= itPeriod) {</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">for</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> = 0; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> &lt; confNumber; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>++ ) {</div>
<div class="line"><span class="lineno">  498</span>      efficiencyVector[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>].resize ( partSimMax );</div>
<div class="line"><span class="lineno">  499</span>      <span class="keywordflow">for</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> = 0; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> &lt; partSimMax; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>++ ) {</div>
<div class="line"><span class="lineno">  500</span> </div>
<div class="line"><span class="lineno">  501</span>        count_out = 0;</div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>        <span class="keywordflow">if</span> ( time_step &gt;= 1. / itPeriod <span class="comment">/*2.5*/</span> * itPeriod ) {</div>
<div class="line"><span class="lineno">  504</span>          <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>].size(); i++ ) {</div>
<div class="line"><span class="lineno">  505</span>            <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) {</div>
<div class="line"><span class="lineno">  506</span>              <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][i]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a4ee4b75bb07d8849015130c57dfde0d7">AdvectionParallel</a> ( 20, 1. / itPeriod, 4, <a class="code hl_function" href="magnetic__stents_8cpp.html#ad291af8a9eed7b4ec5fc850834049a28">MagneticForceWire</a> );</div>
<div class="line"><span class="lineno">  507</span>            }</div>
<div class="line"><span class="lineno">  508</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 0 || <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) {</div>
<div class="line"><span class="lineno">  509</span>              <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][i]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a4ee4b75bb07d8849015130c57dfde0d7">AdvectionParallel</a> ( 150, 1. / itPeriod, 4, <a class="code hl_function" href="magnetic__stents_8cpp.html#a85c583291c006c5144cc8a9c06bc1e3a">MagneticForceSC</a> );</div>
<div class="line"><span class="lineno">  510</span>              <span class="comment">//linea[configuration][partSim][i]-&gt;AdvectionParallel(75, 1. / itPeriod, 4, MagneticForceSC);</span></div>
<div class="line"><span class="lineno">  511</span>            }</div>
<div class="line"><span class="lineno">  512</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) {</div>
<div class="line"><span class="lineno">  513</span>              <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][i]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a4ee4b75bb07d8849015130c57dfde0d7">AdvectionParallel</a> ( 150, 1. / itPeriod, 4, <a class="code hl_function" href="magnetic__stents_8cpp.html#a642f24668cc85d5eada722f3c2bc08ae">MagneticForceStents</a> );</div>
<div class="line"><span class="lineno">  514</span>            }</div>
<div class="line"><span class="lineno">  515</span>            count_out += <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][i]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a2b8a19a410213e8a7cd8fb2118cc4305">NumberOfParticlesOutsideTheDomain</a>();</div>
<div class="line"><span class="lineno">  516</span>          }</div>
<div class="line"><span class="lineno">  517</span>        }</div>
<div class="line"><span class="lineno">  518</span><span class="comment">//           if (time_step &lt; 4 * itPeriod + itPeriod) {</span></div>
<div class="line"><span class="lineno">  519</span><span class="comment">//             count_tot += pSize;</span></div>
<div class="line"><span class="lineno">  520</span><span class="comment">//             linea.resize(time_step - itPeriod + 2);</span></div>
<div class="line"><span class="lineno">  521</span><span class="comment">//             linea[time_step - itPeriod + 1] =  new Line(x, markerType, ml_sol.GetLevel(numberOfUniformRefinedMeshes - 1), 2);</span></div>
<div class="line"><span class="lineno">  522</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>        count_inside = count_tot - count_out;</div>
<div class="line"><span class="lineno">  525</span> </div>
<div class="line"><span class="lineno">  526</span>        efficiencyVector[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>] =  <span class="keyword">static_cast&lt;</span> <span class="keywordtype">double</span> <span class="keyword">&gt;</span> ( count_inside ) / count_tot;</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>        <span class="keywordtype">double</span> diam;</div>
<div class="line"><span class="lineno">  529</span>        <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 1 ) diam = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 0.1 * 1.e-6;</div>
<div class="line"><span class="lineno">  530</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 2 ) diam = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 0.5 * 1.e-6;</div>
<div class="line"><span class="lineno">  531</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a> == 3 ) diam = ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> + 1. ) * 2 * 0.43 * 1.e-6;</div>
<div class="line"><span class="lineno">  532</span>        <span class="keywordflow">else</span> diam = 0;</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;configuration = &quot;</span> &lt;&lt; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  535</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;diameter = &quot;</span> &lt;&lt; std::setw ( 11 ) &lt;&lt; std::setprecision ( 12 ) &lt;&lt; std::fixed &lt;&lt; diam &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  536</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;time_step = &quot;</span> &lt;&lt; time_step + 1 &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  537</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;particle inside = &quot;</span> &lt;&lt; count_inside &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  538</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;particle outside = &quot;</span> &lt;&lt; count_out &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  539</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;capture efficiency = &quot;</span> &lt;&lt; efficiencyVector[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>        <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][0]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a4e7742ddfcf4f4e27cff81c51dbd5afd">GetStreamLine</a> ( streamline, 0 );</div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>].size(); i++ ) {</div>
<div class="line"><span class="lineno">  543</span>          <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][i]-&gt;<a class="code hl_function" href="classfemus_1_1_line.html#a4e7742ddfcf4f4e27cff81c51dbd5afd">GetStreamLine</a> ( streamline, i + 1 );</div>
<div class="line"><span class="lineno">  544</span>        }</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>        std::ostringstream output_path;</div>
<div class="line"><span class="lineno">  547</span>        output_path &lt;&lt; <span class="stringliteral">&quot;./output/particles-&quot;</span> &lt;&lt; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> &lt;&lt; <span class="stringliteral">&quot;-&quot;</span> &lt;&lt; diam;</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>        <a class="code hl_function" href="namespacefemus.html#ab218007e286871c1b8c469f8e78a96b4">PrintLine</a> ( output_path.str(), <span class="stringliteral">&quot;streamline&quot;</span>, streamline, time_step + 1 );</div>
<div class="line"><span class="lineno">  550</span>      }</div>
<div class="line"><span class="lineno">  551</span>    }</div>
<div class="line"><span class="lineno">  552</span>    <span class="comment">//}</span></div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>  }</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>  <span class="comment">// ******* Clear all systems *******</span></div>
<div class="line"><span class="lineno">  558</span>  <span class="keywordflow">for</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> = 0; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a> &lt; confNumber; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>++ ) {</div>
<div class="line"><span class="lineno">  559</span>    <span class="keywordflow">for</span> ( <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> = 0; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a> &lt; partSimMax; <a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>++ ) {</div>
<div class="line"><span class="lineno">  560</span>      <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>].size(); i++ ) {</div>
<div class="line"><span class="lineno">  561</span>        <span class="keyword">delete</span> <a class="code hl_variable" href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a>[<a class="code hl_variable" href="magnetic__stents_8cpp.html#a87785c57dfeccbf971d24cfcdbe88c22">configuration</a>][<a class="code hl_variable" href="magnetic__stents_8cpp.html#a667695b2e2b6f386ba3f5249732f3aba">partSim</a>][i];</div>
<div class="line"><span class="lineno">  562</span>      }</div>
<div class="line"><span class="lineno">  563</span>    }</div>
<div class="line"><span class="lineno">  564</span>  }</div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; confNumber; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++ ) {</div>
<div class="line"><span class="lineno">  568</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; CONFIGURATION &quot;</span> &lt;&lt; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  569</span>    <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> i = 0; i &lt; partSimMax; i++ ) {</div>
<div class="line"><span class="lineno">  570</span>      std::cout &lt;&lt; efficiencyVector[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i] * 100 &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  571</span>    }</div>
<div class="line"><span class="lineno">  572</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; ---------------------------------------------------------------------------- &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  573</span>  }</div>
<div class="line"><span class="lineno">  574</span> </div>
<div class="line"><span class="lineno">  575</span>  ml_prob.clear();</div>
<div class="line"><span class="lineno">  576</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  577</span>}</div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00018">FElemTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a></div><div class="ttdeci">@ ZERO</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00014">FElemTypeEnum.hpp:14</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a></div><div class="ttdeci">@ DISCONTINUOUS_POLYNOMIAL</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00006">FElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_af12829f27afb4207fd7c58ef847b9d8b"><div class="ttname"><a href="_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a></div><div class="ttdeci">#define DEFAULT_OUTPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00040">FemusDefault.hpp:40</a></div></div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e"><div class="ttname"><a href="_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e">FEMuS_ASM</a></div><div class="ttdeci">@ FEMuS_ASM</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_solver_enum_8hpp_source.html#l00006">LinearEquationSolverEnum.hpp:6</a></div></div>
<div class="ttc" id="a_marker_type_enum_8hpp_html_ade22213fff69cfb37d8238e8fd3073dfa9d326c2efb1f1ef1840d474c0f9b8a48"><div class="ttname"><a href="_marker_type_enum_8hpp.html#ade22213fff69cfb37d8238e8fd3073dfa9d326c2efb1f1ef1840d474c0f9b8a48">VOLUME</a></div><div class="ttdeci">@ VOLUME</div><div class="ttdef"><b>Definition</b> <a href="_marker_type_enum_8hpp_source.html#l00005">MarkerTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb"><div class="ttname"><a href="_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a></div><div class="ttdeci">@ V_CYCLE</div><div class="ttdef"><b>Definition</b> <a href="_mg_type_enum_8hpp_source.html#l00006">MgTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_a35aafc39068a269f658aac64338aa781a6ce16ab03eaaecb71458081ce0147fa0"><div class="ttname"><a href="_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a6ce16ab03eaaecb71458081ce0147fa0">F_CYCLE</a></div><div class="ttdeci">@ F_CYCLE</div><div class="ttdef"><b>Definition</b> <a href="_mg_type_enum_8hpp_source.html#l00005">MgTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_oprtr_type_enum_8hpp_html_a7215803e478cdd4bdf4f1b8087cae87ba9893e4ccf5eaa7c78225e38782928aa6"><div class="ttname"><a href="_oprtr_type_enum_8hpp.html#a7215803e478cdd4bdf4f1b8087cae87ba9893e4ccf5eaa7c78225e38782928aa6">ELASTICITY</a></div><div class="ttdeci">@ ELASTICITY</div><div class="ttdef"><b>Definition</b> <a href="_oprtr_type_enum_8hpp_source.html#l00007">OprtrTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da"><div class="ttname"><a href="_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da">MLU_PRECOND</a></div><div class="ttdeci">@ MLU_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="_precondtype_enum_8hpp_source.html#l00024">PrecondtypeEnum.hpp:24</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3"><div class="ttname"><a href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3">RICHARDSON</a></div><div class="ttdeci">@ RICHARDSON</div><div class="ttdef"><b>Definition</b> <a href="_solvertype_enum_8hpp_source.html#l00023">SolvertypeEnum.hpp:23</a></div></div>
<div class="ttc" id="a_u_q_2ex12_2ex12_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition</b> <a href="_u_q_2ex12_2ex12_8cpp_source.html#l00053">ex12.cpp:53</a></div></div>
<div class="ttc" id="a_writer_enum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition</b> <a href="_writer_enum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_fluid_html"><div class="ttname"><a href="classfemus_1_1_fluid.html">femus::Fluid</a></div><div class="ttdef"><b>Definition</b> <a href="_fluid_8hpp_source.html#l00034">Fluid.hpp:34</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html"><div class="ttname"><a href="classfemus_1_1_line.html">femus::Line</a></div><div class="ttdef"><b>Definition</b> <a href="_line_8hpp_source.html#l00034">Line.hpp:34</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html_a2b8a19a410213e8a7cd8fb2118cc4305"><div class="ttname"><a href="classfemus_1_1_line.html#a2b8a19a410213e8a7cd8fb2118cc4305">femus::Line::NumberOfParticlesOutsideTheDomain</a></div><div class="ttdeci">unsigned NumberOfParticlesOutsideTheDomain()</div><div class="ttdef"><b>Definition</b> <a href="ism_2_line_8cpp_source.html#l01273">Line.cpp:1273</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html_a4e7742ddfcf4f4e27cff81c51dbd5afd"><div class="ttname"><a href="classfemus_1_1_line.html#a4e7742ddfcf4f4e27cff81c51dbd5afd">femus::Line::GetStreamLine</a></div><div class="ttdeci">void GetStreamLine(std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &amp;line, const unsigned &amp;step)</div><div class="ttdef"><b>Definition</b> <a href="_line_8hpp_source.html#l00060">Line.hpp:60</a></div></div>
<div class="ttc" id="aclassfemus_1_1_line_html_a4ee4b75bb07d8849015130c57dfde0d7"><div class="ttname"><a href="classfemus_1_1_line.html#a4ee4b75bb07d8849015130c57dfde0d7">femus::Line::AdvectionParallel</a></div><div class="ttdeci">void AdvectionParallel(const unsigned &amp;n, const double &amp;T, const unsigned &amp;order, ForceFunction Force=NULL)</div><div class="ttdef"><b>Definition</b> <a href="ism_2_line_8cpp_source.html#l00912">Line.cpp:912</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parameter_html"><div class="ttname"><a href="classfemus_1_1_parameter.html">femus::Parameter</a></div><div class="ttdef"><b>Definition</b> <a href="_parameter_8hpp_source.html#l00028">Parameter.hpp:28</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html"><div class="ttname"><a href="classfemus_1_1_solid.html">femus::Solid</a></div><div class="ttdef"><b>Definition</b> <a href="_solid_8hpp_source.html#l00036">Solid.hpp:36</a></div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html"><div class="ttname"><a href="classfemus_1_1_transient_system.html">femus::TransientSystem</a></div><div class="ttdef"><b>Definition</b> <a href="_transient_system_8hpp_source.html#l00047">TransientSystem.hpp:47</a></div></div>
<div class="ttc" id="afsi_steady_m_g_8cpp_html_a79d6dc8c192d4ac163f592ba4e7d1d7e"><div class="ttname"><a href="fsi_steady_m_g_8cpp.html#a79d6dc8c192d4ac163f592ba4e7d1d7e">numberOfUniformRefinedMeshes</a></div><div class="ttdeci">unsigned short numberOfUniformRefinedMeshes</div><div class="ttdef"><b>Definition</b> <a href="fsi_steady_m_g_8cpp_source.html#l00036">fsiSteadyMG.cpp:36</a></div></div>
<div class="ttc" id="afsi_time_dep_m_g_8cpp_html_a690064f1b48fbafe61db31c7960292bb"><div class="ttname"><a href="fsi_time_dep_m_g_8cpp.html#a690064f1b48fbafe61db31c7960292bb">simulation</a></div><div class="ttdeci">unsigned simulation</div><div class="ttdef"><b>Definition</b> <a href="fsi_time_dep_m_g_8cpp_source.html#l00038">fsiTimeDepMG.cpp:38</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_a642f24668cc85d5eada722f3c2bc08ae"><div class="ttname"><a href="magnetic__stents_8cpp.html#a642f24668cc85d5eada722f3c2bc08ae">MagneticForceStents</a></div><div class="ttdeci">void MagneticForceStents(const std::vector&lt; double &gt; &amp;xMarker, std::vector&lt; double &gt; &amp;Fm, const unsigned &amp;material)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l01439">magnetic_stents.cpp:1439</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_a85c583291c006c5144cc8a9c06bc1e3a"><div class="ttname"><a href="magnetic__stents_8cpp.html#a85c583291c006c5144cc8a9c06bc1e3a">MagneticForceSC</a></div><div class="ttdeci">void MagneticForceSC(const std::vector&lt; double &gt; &amp;xMarker, std::vector&lt; double &gt; &amp;Fm, const unsigned &amp;material)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l01032">magnetic_stents.cpp:1032</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_a95e7008a8dc52128d7dde0029e5ddd5d"><div class="ttname"><a href="magnetic__stents_8cpp.html#a95e7008a8dc52128d7dde0029e5ddd5d">SetBoundaryConditionTubo3D</a></div><div class="ttdeci">bool SetBoundaryConditionTubo3D(const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00650">magnetic_stents.cpp:650</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_ab3fdd5f4775bbdd38ffe27fb6a232799"><div class="ttname"><a href="magnetic__stents_8cpp.html#ab3fdd5f4775bbdd38ffe27fb6a232799">SetBoundaryConditionAorticBifurcation</a></div><div class="ttdeci">bool SetBoundaryConditionAorticBifurcation(const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00595">magnetic_stents.cpp:595</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_ad291af8a9eed7b4ec5fc850834049a28"><div class="ttname"><a href="magnetic__stents_8cpp.html#ad291af8a9eed7b4ec5fc850834049a28">MagneticForceWire</a></div><div class="ttdeci">void MagneticForceWire(const std::vector&lt; double &gt; &amp;xMarker, std::vector&lt; double &gt; &amp;Fm, const unsigned &amp;material)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00858">magnetic_stents.cpp:858</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_ad47bed7d7095b356056b518e0842c75a"><div class="ttname"><a href="magnetic__stents_8cpp.html#ad47bed7d7095b356056b518e0842c75a">SetVariableTimeStep</a></div><div class="ttdeci">double SetVariableTimeStep(const double time)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00582">magnetic_stents.cpp:582</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_aec52f43f998adde5ed3ccb6c4b21dac2"><div class="ttname"><a href="magnetic__stents_8cpp.html#aec52f43f998adde5ed3ccb6c4b21dac2">SetBoundaryConditionMagneticStents</a></div><div class="ttdeci">bool SetBoundaryConditionMagneticStents(const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00767">magnetic_stents.cpp:767</a></div></div>
<div class="ttc" id="amagnetic__stents_8cpp_html_af5e696906686ccd7c8afb2fd4ee846ad"><div class="ttname"><a href="magnetic__stents_8cpp.html#af5e696906686ccd7c8afb2fd4ee846ad">SetBoundaryConditionCarotidBifurcation</a></div><div class="ttdeci">bool SetBoundaryConditionCarotidBifurcation(const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="magnetic__stents_8cpp_source.html#l00699">magnetic_stents.cpp:699</a></div></div>
<div class="ttc" id="ampm_fem_8hpp_html_aa0fdc51a36f86cd151f897c5bc1c121e"><div class="ttname"><a href="mpm_fem_8hpp.html#aa0fdc51a36f86cd151f897c5bc1c121e">linea</a></div><div class="ttdeci">Line * linea</div><div class="ttdef"><b>Definition</b> <a href="mpm_fem_8hpp_source.html#l00012">mpmFem.hpp:12</a></div></div>
<div class="ttc" id="anamespacefemus_html_a2c4f4bd8ac7fc7156f2e944e294ce267"><div class="ttname"><a href="namespacefemus.html#a2c4f4bd8ac7fc7156f2e944e294ce267">femus::StoreMeshVelocity</a></div><div class="ttdeci">void StoreMeshVelocity(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_2vascular_2include_2_f_s_i_time_dependent_assembly_supg_8hpp_source.html#l01473">FSITimeDependentAssemblySupg.hpp:1473</a></div></div>
<div class="ttc" id="anamespacefemus_html_a3afb24e5e39c6913039027de4e1d970a"><div class="ttname"><a href="namespacefemus.html#a3afb24e5e39c6913039027de4e1d970a">femus::SetLambdaNew</a></div><div class="ttdeci">void SetLambdaNew(MultiLevelSolution &amp;mlSol, const unsigned &amp;level, const FEOrder &amp;order, Operator operatorType)</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_2vascular_2include_2_f_s_i_time_dependent_assembly_supg_8hpp_source.html#l01101">FSITimeDependentAssemblySupg.hpp:1101</a></div></div>
<div class="ttc" id="anamespacefemus_html_a59a34d23c69142d91f84525f5aa78db9"><div class="ttname"><a href="namespacefemus.html#a59a34d23c69142d91f84525f5aa78db9">femus::valve</a></div><div class="ttdeci">bool valve</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_8hpp_source.html#l00033">FSITimeDependentAssemblySupgNonConservativeTwoPressures.hpp:33</a></div></div>
<div class="ttc" id="anamespacefemus_html_a9f30b7c76f4daea4a5dd0cf1dc855e87"><div class="ttname"><a href="namespacefemus.html#a9f30b7c76f4daea4a5dd0cf1dc855e87">femus::twoPressure</a></div><div class="ttdeci">bool twoPressure</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_8hpp_source.html#l00031">FSITimeDependentAssemblySupgNonConservativeTwoPressures.hpp:31</a></div></div>
<div class="ttc" id="anamespacefemus_html_ab218007e286871c1b8c469f8e78a96b4"><div class="ttname"><a href="namespacefemus.html#ab218007e286871c1b8c469f8e78a96b4">femus::PrintLine</a></div><div class="ttdeci">void PrintLine(const std::string output_path, const std::string file, const std::vector&lt; std::vector&lt; std::vector&lt; double &gt; &gt; &gt; &amp;xn, const unsigned &amp;step)</div><div class="ttdef"><b>Definition</b> <a href="_polynomial_bases_8cpp_source.html#l01952">PolynomialBases.cpp:1952</a></div></div>
<div class="ttc" id="anamespacefemus_html_afe5dc8c9b84f44b2474a91a1d08e604a"><div class="ttname"><a href="namespacefemus.html#afe5dc8c9b84f44b2474a91a1d08e604a">femus::FSITimeDependentAssemblySupgNew2</a></div><div class="ttdeci">void FSITimeDependentAssemblySupgNew2(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_2vascular_2include_2_f_s_i_time_dependent_assembly_supg_8hpp_source.html#l00014">FSITimeDependentAssemblySupg.hpp:14</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3fdd5f4775bbdd38ffe27fb6a232799" name="ab3fdd5f4775bbdd38ffe27fb6a232799"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3fdd5f4775bbdd38ffe27fb6a232799">&#9670;&#160;</a></span>SetBoundaryConditionAorticBifurcation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryConditionAorticBifurcation </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00595">595</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  596</span>{</div>
<div class="line"><span class="lineno">  597</span>  <span class="keywordtype">bool</span> test = 1; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">  598</span>  value = 0.;</div>
<div class="line"><span class="lineno">  599</span> </div>
<div class="line"><span class="lineno">  600</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>  <span class="keywordtype">double</span> ramp = ( time &lt; 1 ) ? sin ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> / 2 * time ) : 1.;</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>  <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;V&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  605</span>    <span class="keywordflow">if</span> ( 1 == facename ) {</div>
<div class="line"><span class="lineno">  606</span>      <span class="keywordtype">double</span> r2 = ( x[0] * 100. ) * ( x[0] * 100. );</div>
<div class="line"><span class="lineno">  607</span>      value = -0.15 / .81 * ( .81 - r2 ) * ( 1. + 0.25 * sin ( 2.*<a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * time ) ) * ramp; <span class="comment">//inflow</span></div>
<div class="line"><span class="lineno">  608</span>    }</div>
<div class="line"><span class="lineno">  609</span>    <span class="keywordflow">if</span> ( 2 == facename || 3 == facename || 7 == facename ) {</div>
<div class="line"><span class="lineno">  610</span>      test = 0;</div>
<div class="line"><span class="lineno">  611</span>      value = 0.;</div>
<div class="line"><span class="lineno">  612</span>    }</div>
<div class="line"><span class="lineno">  613</span>  }</div>
<div class="line"><span class="lineno">  614</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;U&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  615</span>    <span class="keywordflow">if</span> ( 2 == facename || 3 == facename || 7 == facename ) {</div>
<div class="line"><span class="lineno">  616</span><span class="comment">//       test = 0;</span></div>
<div class="line"><span class="lineno">  617</span><span class="comment">//       value = (10000 + 2500 * sin(2 * PI * time)) * ramp;;</span></div>
<div class="line"><span class="lineno">  618</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  619</span><span class="comment">//     else if (7 == facename) {</span></div>
<div class="line"><span class="lineno">  620</span>      test = 0;</div>
<div class="line"><span class="lineno">  621</span>      value = 0;</div>
<div class="line"><span class="lineno">  622</span>    }</div>
<div class="line"><span class="lineno">  623</span>  }</div>
<div class="line"><span class="lineno">  624</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PS&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  625</span>    test = 0;</div>
<div class="line"><span class="lineno">  626</span>    value = 0.;</div>
<div class="line"><span class="lineno">  627</span>  }</div>
<div class="line"><span class="lineno">  628</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PF&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  629</span>    test = 0;</div>
<div class="line"><span class="lineno">  630</span>    value = 0.;</div>
<div class="line"><span class="lineno">  631</span>  }</div>
<div class="line"><span class="lineno">  632</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;DX&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  633</span>    <span class="keywordflow">if</span> ( 7 == facename ) {</div>
<div class="line"><span class="lineno">  634</span>      test = 0;</div>
<div class="line"><span class="lineno">  635</span>      value = 0;</div>
<div class="line"><span class="lineno">  636</span>    }</div>
<div class="line"><span class="lineno">  637</span>  }</div>
<div class="line"><span class="lineno">  638</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;DY&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  639</span>    <span class="keywordflow">if</span> ( 7 == facename ) {</div>
<div class="line"><span class="lineno">  640</span>      test = 0;</div>
<div class="line"><span class="lineno">  641</span>      value = 0;</div>
<div class="line"><span class="lineno">  642</span>    }</div>
<div class="line"><span class="lineno">  643</span>  }</div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>  <span class="keywordflow">return</span> test;</div>
<div class="line"><span class="lineno">  646</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af5e696906686ccd7c8afb2fd4ee846ad" name="af5e696906686ccd7c8afb2fd4ee846ad"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af5e696906686ccd7c8afb2fd4ee846ad">&#9670;&#160;</a></span>SetBoundaryConditionCarotidBifurcation()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryConditionCarotidBifurcation </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00699">699</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  700</span>{</div>
<div class="line"><span class="lineno">  701</span>  <span class="keywordtype">bool</span> test = 1; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">  702</span>  value = 0.;</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno">  705</span>  <span class="keywordtype">double</span> ramp = ( time &lt; 1 ) ? sin ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> / 2 * time ) : 1.;</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>  <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;W&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  708</span>    <span class="keywordflow">if</span> ( 1 == facename ) {</div>
<div class="line"><span class="lineno">  709</span>      <span class="keywordtype">double</span> r2 = ( ( x[0] * x[0] ) + ( x[1] - 0.006 ) * ( x[1] - 0.006 ) ) / ( 0.0035 * 0.0035 );</div>
<div class="line"><span class="lineno">  710</span>      value = 2 * 0.1 * ( 1. - r2 ) * ( 1. + 0.25 * sin ( 2.*<a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * time ) ) * ramp; <span class="comment">//inflow</span></div>
<div class="line"><span class="lineno">  711</span>      <span class="comment">//value = 1.3 * 0.194 * (1. - r2) * (1. + 0.25 * sin(2.*PI * time)) * ramp; //inflow</span></div>
<div class="line"><span class="lineno">  712</span><span class="comment">//       double q;</span></div>
<div class="line"><span class="lineno">  713</span><span class="comment">//       double t = time - floor(time);</span></div>
<div class="line"><span class="lineno">  714</span><span class="comment">//       if (t &gt;= 0. || t &lt; 0.15) {</span></div>
<div class="line"><span class="lineno">  715</span><span class="comment">//         q = 946.67 * t * t * t + 130 * t * t + 0.9333 * t + 3.94;</span></div>
<div class="line"><span class="lineno">  716</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  717</span><span class="comment">//       else if (t &gt;= 0.15 || t &lt; 0.45) {</span></div>
<div class="line"><span class="lineno">  718</span><span class="comment">//         q = - 424889 * t * t * t * t * t * t + 876000 * t * t * t * t * t - 732289 * t * t * t * t + 317210 * t * t * t - 74927 * t * t + 9100.3 * t - 430.54;</span></div>
<div class="line"><span class="lineno">  719</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  720</span><span class="comment">//       else if (t &gt;= 0.45 || t &lt; 1.) {</span></div>
<div class="line"><span class="lineno">  721</span><span class="comment">//         q = - 601.31  * t * t * t * t * t * t + 3582.2 * t * t * t * t * t - 8384.8 * t * t * t * t + 10028 * t * t * t - 6510.4 * t * t + 2177.1 * t - 286.61;</span></div>
<div class="line"><span class="lineno">  722</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  723</span><span class="comment">//       value = 2 * q * 1.e-6 * (1. - r2) / (PI * 0.0035 * 0.0035) * ramp; //inflow</span></div>
<div class="line"><span class="lineno">  724</span>      <span class="comment">//std::cout &lt;&lt; &quot;velocity we would like to have = &quot; &lt;&lt; value1 &lt;&lt; &quot; &quot; &lt;&lt; &quot;time t is : &quot; &lt;&lt; t &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  725</span>    }</div>
<div class="line"><span class="lineno">  726</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( 2 == facename || 3 == facename || 7 == facename ) {</div>
<div class="line"><span class="lineno">  727</span>      test = 0;</div>
<div class="line"><span class="lineno">  728</span>      value = 0.;</div>
<div class="line"><span class="lineno">  729</span>    }</div>
<div class="line"><span class="lineno">  730</span>  }</div>
<div class="line"><span class="lineno">  731</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;U&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordflow">if</span> ( 7 == facename ) {</div>
<div class="line"><span class="lineno">  733</span>      test = 0;</div>
<div class="line"><span class="lineno">  734</span>      value = 0.;</div>
<div class="line"><span class="lineno">  735</span>    }</div>
<div class="line"><span class="lineno">  736</span>  }</div>
<div class="line"><span class="lineno">  737</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;V&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  738</span>    <span class="keywordflow">if</span> ( 7 == facename ) {</div>
<div class="line"><span class="lineno">  739</span>      test = 0;</div>
<div class="line"><span class="lineno">  740</span>      value = 0.;</div>
<div class="line"><span class="lineno">  741</span>    }</div>
<div class="line"><span class="lineno">  742</span>  }</div>
<div class="line"><span class="lineno">  743</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PS&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  744</span>    test = 0;</div>
<div class="line"><span class="lineno">  745</span>    value = 0.;</div>
<div class="line"><span class="lineno">  746</span>    <span class="keywordflow">if</span> ( 2 == facename || 3 == facename ) {</div>
<div class="line"><span class="lineno">  747</span>      value = ( 5000 + 2500 * sin ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * time ) ) * ramp;</div>
<div class="line"><span class="lineno">  748</span>      <span class="comment">//value = 5000 * ramp;//13332</span></div>
<div class="line"><span class="lineno">  749</span>    }</div>
<div class="line"><span class="lineno">  750</span>  }</div>
<div class="line"><span class="lineno">  751</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PF&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  752</span>    test = 0;</div>
<div class="line"><span class="lineno">  753</span>    value = 0.;</div>
<div class="line"><span class="lineno">  754</span>  }</div>
<div class="line"><span class="lineno">  755</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;DX&quot;</span> ) || !strcmp ( name, <span class="stringliteral">&quot;DY&quot;</span> ) || !strcmp ( name, <span class="stringliteral">&quot;DZ&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">if</span> ( 7 == facename ) {</div>
<div class="line"><span class="lineno">  757</span>      test = 0;</div>
<div class="line"><span class="lineno">  758</span>      value = 0;</div>
<div class="line"><span class="lineno">  759</span>    }</div>
<div class="line"><span class="lineno">  760</span>  }</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span>  <span class="keywordflow">return</span> test;</div>
<div class="line"><span class="lineno">  763</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aec52f43f998adde5ed3ccb6c4b21dac2" name="aec52f43f998adde5ed3ccb6c4b21dac2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec52f43f998adde5ed3ccb6c4b21dac2">&#9670;&#160;</a></span>SetBoundaryConditionMagneticStents()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryConditionMagneticStents </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00767">767</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  768</span>{</div>
<div class="line"><span class="lineno">  769</span>  <span class="keywordtype">bool</span> test = 1; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">  770</span>  value = 0.;</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>  <span class="keywordtype">double</span> ramp = ( time &lt; 1 ) ? sin ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> / 2 * time ) : 1.;</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>  <span class="keywordtype">double</span> u0 = 4.68; <span class="comment">//0.58, 1.17, 2.34, 4.68, 11.7, 23.4, 52.6 cm/s</span></div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>  <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;U&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordflow">if</span> ( 1 == facename ) {</div>
<div class="line"><span class="lineno">  780</span>      <span class="keywordtype">double</span> r2 = ( x[1] * x[1] ) / ( 0.0004 * 0.0004 );</div>
<div class="line"><span class="lineno">  781</span>      value = 1.5 * ( u0 * 1.e-2 ) * ( 1. - r2 ) * ramp; <span class="comment">//steady-state inflow</span></div>
<div class="line"><span class="lineno">  782</span>      <span class="comment">//value = -0.15 / .81 * (.81 - r2) * (1. + 0.25 * sin(2.*PI * time)) * ramp; //time dependent inflow</span></div>
<div class="line"><span class="lineno">  783</span>    }</div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">if</span> ( 2 == facename ) {</div>
<div class="line"><span class="lineno">  785</span>      test = 0;</div>
<div class="line"><span class="lineno">  786</span>      value = 0.;</div>
<div class="line"><span class="lineno">  787</span>    }</div>
<div class="line"><span class="lineno">  788</span>  }</div>
<div class="line"><span class="lineno">  789</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;V&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  790</span>    <span class="keywordflow">if</span> ( 2 == facename ) {</div>
<div class="line"><span class="lineno">  791</span>      test = 0;</div>
<div class="line"><span class="lineno">  792</span>      value = 0;</div>
<div class="line"><span class="lineno">  793</span>    }</div>
<div class="line"><span class="lineno">  794</span>  }</div>
<div class="line"><span class="lineno">  795</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PS&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  796</span>    test = 0;</div>
<div class="line"><span class="lineno">  797</span>    value = 0.;</div>
<div class="line"><span class="lineno">  798</span>  }</div>
<div class="line"><span class="lineno">  799</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PF&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  800</span>    test = 0;</div>
<div class="line"><span class="lineno">  801</span>    value = 0.;</div>
<div class="line"><span class="lineno">  802</span>  }</div>
<div class="line"><span class="lineno">  803</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;DX&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  804</span>    <span class="keywordflow">if</span> ( 5 == facename || 6 == facename ) {</div>
<div class="line"><span class="lineno">  805</span>      test = 0;</div>
<div class="line"><span class="lineno">  806</span>      value = 0;</div>
<div class="line"><span class="lineno">  807</span>    }</div>
<div class="line"><span class="lineno">  808</span>  }</div>
<div class="line"><span class="lineno">  809</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;DY&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  810</span>    <span class="keywordflow">if</span> ( 5 == facename || 6 == facename ) {</div>
<div class="line"><span class="lineno">  811</span>      test = 0;</div>
<div class="line"><span class="lineno">  812</span>      value = 0;</div>
<div class="line"><span class="lineno">  813</span>    }</div>
<div class="line"><span class="lineno">  814</span>  }</div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>  <span class="keywordflow">return</span> test;</div>
<div class="line"><span class="lineno">  817</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a95e7008a8dc52128d7dde0029e5ddd5d" name="a95e7008a8dc52128d7dde0029e5ddd5d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a95e7008a8dc52128d7dde0029e5ddd5d">&#9670;&#160;</a></span>SetBoundaryConditionTubo3D()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryConditionTubo3D </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00650">650</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  651</span>{</div>
<div class="line"><span class="lineno">  652</span>  <span class="keywordtype">bool</span> test = 1; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">  653</span>  value = 0.;</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> = acos ( -1. );</div>
<div class="line"><span class="lineno">  656</span>  <span class="keywordtype">double</span> ramp = ( time &lt; 1 ) ? sin ( <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> / 2 * time ) : 1.;</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>  <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;U&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  659</span>    <span class="keywordflow">if</span> ( 2 == facename ) {</div>
<div class="line"><span class="lineno">  660</span>      <span class="keywordtype">double</span> r2 = ( ( x[1] - 0.0196 ) * ( x[1] - 0.0196 ) + ( x[2] * x[2] ) ) / ( 0.0035 * 0.0035 );</div>
<div class="line"><span class="lineno">  661</span>      value = 2 * 0.1 * ( 1. - r2 ) * ( 1. + 0.25 * sin ( 2.*<a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * time ) ) * ramp; <span class="comment">//inflow</span></div>
<div class="line"><span class="lineno">  662</span>      <span class="comment">//value = 2 * 0.1 * (1. - r2) * ramp; //inflow</span></div>
<div class="line"><span class="lineno">  663</span>    }</div>
<div class="line"><span class="lineno">  664</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( 1 == facename || 5 == facename ) {</div>
<div class="line"><span class="lineno">  665</span>      test = 0;</div>
<div class="line"><span class="lineno">  666</span>      value = 0.;</div>
<div class="line"><span class="lineno">  667</span>    }</div>
<div class="line"><span class="lineno">  668</span>  }</div>
<div class="line"><span class="lineno">  669</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;V&quot;</span> ) || !strcmp ( name, <span class="stringliteral">&quot;W&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  670</span>    <span class="keywordflow">if</span> ( 1 == facename || 5 == facename ) {</div>
<div class="line"><span class="lineno">  671</span>      test = 0;</div>
<div class="line"><span class="lineno">  672</span>      value = 0.;</div>
<div class="line"><span class="lineno">  673</span>    }</div>
<div class="line"><span class="lineno">  674</span>  }</div>
<div class="line"><span class="lineno">  675</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PS&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  676</span>    test = 0;</div>
<div class="line"><span class="lineno">  677</span>    value = 0.;</div>
<div class="line"><span class="lineno">  678</span>    <span class="keywordflow">if</span> ( 1 == facename ) {</div>
<div class="line"><span class="lineno">  679</span>      value = ( 12500 + 2500 * sin ( 2 * <a class="code hl_variable" href="internal__waves__zlevel_8cpp.html#a4e36555c8609254715858261f34dfd94">PI</a> * time ) ) * ramp;</div>
<div class="line"><span class="lineno">  680</span>      <span class="comment">//value = 13335 * ramp;</span></div>
<div class="line"><span class="lineno">  681</span>    }</div>
<div class="line"><span class="lineno">  682</span>  }</div>
<div class="line"><span class="lineno">  683</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;PF&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  684</span>    test = 0;</div>
<div class="line"><span class="lineno">  685</span>    value = 0.;</div>
<div class="line"><span class="lineno">  686</span>  }</div>
<div class="line"><span class="lineno">  687</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( !strcmp ( name, <span class="stringliteral">&quot;DX&quot;</span> ) || !strcmp ( name, <span class="stringliteral">&quot;DY&quot;</span> ) || !strcmp ( name, <span class="stringliteral">&quot;DZ&quot;</span> ) ) {</div>
<div class="line"><span class="lineno">  688</span>    <span class="keywordflow">if</span> ( 5 == facename ) {</div>
<div class="line"><span class="lineno">  689</span>      test = 0;</div>
<div class="line"><span class="lineno">  690</span>      value = 0;</div>
<div class="line"><span class="lineno">  691</span>    }</div>
<div class="line"><span class="lineno">  692</span>  }</div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>  <span class="keywordflow">return</span> test;</div>
<div class="line"><span class="lineno">  695</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ad47bed7d7095b356056b518e0842c75a" name="ad47bed7d7095b356056b518e0842c75a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad47bed7d7095b356056b518e0842c75a">&#9670;&#160;</a></span>SetVariableTimeStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SetVariableTimeStep </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00582">582</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  583</span>{</div>
<div class="line"><span class="lineno">  584</span>  <span class="comment">//double dt = 1./(64*1.4);</span></div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = 1. / 32; <span class="comment">//1./16;</span></div>
<div class="line"><span class="lineno">  587</span>  <span class="comment">//double dt = 1. / 4;</span></div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>  <span class="comment">//double dt = 60;</span></div>
<div class="line"><span class="lineno">  590</span>  <span class="keywordflow">return</span> <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><span class="lineno">  591</span>}</div>
<div class="ttc" id="a_s_w_2ex3_2ex3_8cpp_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition</b> <a href="_s_w_2ex3_2ex3_8cpp_source.html#l00041">ex3.cpp:41</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a246808dd279b9a7838339cbcb81e18bb" name="a246808dd279b9a7838339cbcb81e18bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a246808dd279b9a7838339cbcb81e18bb">&#9670;&#160;</a></span>UpdateMeshCoordinates()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void UpdateMeshCoordinates </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mlMesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>mlSol</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00821">821</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  822</span>{</div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span>  <span class="keywordtype">unsigned</span> level = mlSol.<a class="code hl_variable" href="classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span>  <a class="code hl_class" href="classfemus_1_1_solution.html">Solution</a>* solution  = mlSol.<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a> ( level );</div>
<div class="line"><span class="lineno">  827</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>* msh0 = mlSol.<a class="code hl_variable" href="classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> ( level );</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>* msh = mlMesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> ( level );</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>  <span class="keyword">const</span> <span class="keywordtype">char</span> varname[3][3] = {<span class="stringliteral">&quot;DX&quot;</span>, <span class="stringliteral">&quot;DY&quot;</span>, <span class="stringliteral">&quot;DZ&quot;</span>};</div>
<div class="line"><span class="lineno">  834</span>  vector &lt;unsigned&gt; indVAR ( <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> );</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++ ) {</div>
<div class="line"><span class="lineno">  837</span>    indVAR[k] = mlSol.<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> ( &amp;varname[k][0] );</div>
<div class="line"><span class="lineno">  838</span>  }</div>
<div class="line"><span class="lineno">  839</span> </div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++ ) {</div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>    ( *msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k] ).zero();</div>
<div class="line"><span class="lineno">  844</span>    ( *msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k] ).close();</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    ( *msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k] ).add ( ( *msh0-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k] ) );</div>
<div class="line"><span class="lineno">  847</span>    ( *msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k] ).close();</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>    ( *msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k] ).add ( ( *solution-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[indVAR[k]] ) );</div>
<div class="line"><span class="lineno">  850</span>    ( *msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k] ).close();</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>  }</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>}</div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a89a77678df230dce7f2dd2ff171c71b4"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">femus::MultiLevelMesh::GetNumberOfLevels</a></div><div class="ttdeci">unsigned GetNumberOfLevels()</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00157">MultiLevelMesh.hpp:157</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0b3054885210f9a51ebff160e52ec2df"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">femus::MultiLevelSolution::_mlMesh</a></div><div class="ttdeci">MultiLevelMesh * _mlMesh</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00148">MultiLevelSolution.hpp:148</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a87785c57dfeccbf971d24cfcdbe88c22" name="a87785c57dfeccbf971d24cfcdbe88c22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a87785c57dfeccbf971d24cfcdbe88c22">&#9670;&#160;</a></span>configuration</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned configuration</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00054">54</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>

</div>
</div>
<a id="a667695b2e2b6f386ba3f5249732f3aba" name="a667695b2e2b6f386ba3f5249732f3aba"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a667695b2e2b6f386ba3f5249732f3aba">&#9670;&#160;</a></span>partSim</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned partSim</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00053">53</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>

</div>
</div>
<a id="a80d402d10e8341004c0caf10133b80ab" name="a80d402d10e8341004c0caf10133b80ab"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a80d402d10e8341004c0caf10133b80ab">&#9670;&#160;</a></span>scale</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double scale = 1000.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="magnetic__stents_8cpp_source.html#l00027">27</a> of file <a class="el" href="magnetic__stents_8cpp_source.html">magnetic_stents.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="dir_7579d023baf981a59da204ebe3763fe1.html">ISM</a></li><li class="navelem"><a class="el" href="dir_728cb2db820adc424b7d71ac7672d048.html">magnetic_stents</a></li><li class="navelem"><a class="el" href="magnetic__stents_8cpp.html">magnetic_stents.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
