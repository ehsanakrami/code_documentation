<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: femus::GenCase Class Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('classfemus_1_1_gen_case.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Data Fields</a>  </div>
  <div class="headertitle"><div class="title">femus::GenCase Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="_gen_case_8hpp_source.html">GenCase.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for femus::GenCase:</div>
<div class="dyncontent">
 <div class="center">
  <img src="classfemus_1_1_gen_case.png" usemap="#femus::GenCase_map" alt=""/>
  <map id="femus::GenCase_map" name="femus::GenCase_map">
<area href="classfemus_1_1_multi_level_mesh_two.html" alt="femus::MultiLevelMeshTwo" shape="rect" coords="0,0,163,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aac5da7e30562ce9e894192215c2db96c"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#aac5da7e30562ce9e894192215c2db96c">GenCase</a> (const unsigned nolevels, const unsigned <a class="el" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, const <a class="el" href="_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031d">GeomElType</a> geomel_type, const std::string mesh_file)</td></tr>
<tr class="separator:aac5da7e30562ce9e894192215c2db96c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae154b7b406541bda5fc562ac7350574f"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#ae154b7b406541bda5fc562ac7350574f">~GenCase</a> ()</td></tr>
<tr class="separator:ae154b7b406541bda5fc562ac7350574f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1f32c3d80b3a5f9e60f6f2ef64d7957e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a1f32c3d80b3a5f9e60f6f2ef64d7957e">ElemChildToFather</a> ()</td></tr>
<tr class="separator:a1f32c3d80b3a5f9e60f6f2ef64d7957e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac8a4b195137869e5aea20553baa8b37d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#ac8a4b195137869e5aea20553baa8b37d">ReorderElementBySubdLev_VV</a> ()</td></tr>
<tr class="separator:ac8a4b195137869e5aea20553baa8b37d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7dd80e2b843180f82f9c8a11b9114ec5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a7dd80e2b843180f82f9c8a11b9114ec5">ReorderElementBySubdLev_BB</a> ()</td></tr>
<tr class="separator:a7dd80e2b843180f82f9c8a11b9114ec5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2c8dce7f34c3d4331c677c224d601fe2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a2c8dce7f34c3d4331c677c224d601fe2">ReorderNodesBySubdLev</a> ()</td></tr>
<tr class="separator:a2c8dce7f34c3d4331c677c224d601fe2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3f84519134fe7bdfc5040450fe49400e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a3f84519134fe7bdfc5040450fe49400e">ComputeMaxElXNode</a> ()</td></tr>
<tr class="separator:a3f84519134fe7bdfc5040450fe49400e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7638dda7e28540362e134cd783ac2826"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a7638dda7e28540362e134cd783ac2826">ComputeAndPrintMGOperators</a> (const std::string output_path)</td></tr>
<tr class="separator:a7638dda7e28540362e134cd783ac2826"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af03fdb695fdbdd9328ab53c28e57b796"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#af03fdb695fdbdd9328ab53c28e57b796">ComputeAndPrintMatrix</a> (const std::string output_path)</td></tr>
<tr class="memdesc:af03fdb695fdbdd9328ab53c28e57b796"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the sparse matrix pattern.  <br /></td></tr>
<tr class="separator:af03fdb695fdbdd9328ab53c28e57b796"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acf6276fa8c123a0911b1cde3975b01e1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#acf6276fa8c123a0911b1cde3975b01e1">ComputeAndPrintProl</a> (const std::string output_path)</td></tr>
<tr class="separator:acf6276fa8c123a0911b1cde3975b01e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35cd2513d9f9a0ca6d8ce50e71f34e7c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a35cd2513d9f9a0ca6d8ce50e71f34e7c">ComputeAndPrintRest</a> (const std::string output_path)</td></tr>
<tr class="separator:a35cd2513d9f9a0ca6d8ce50e71f34e7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab3241cafafa6233649d61074e34b1358"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#ab3241cafafa6233649d61074e34b1358">CreateMeshStructuresLevSubd</a> (const std::string output_path)</td></tr>
<tr class="separator:ab3241cafafa6233649d61074e34b1358"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a418c8756c74bb200de5e17afd7336620"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a418c8756c74bb200de5e17afd7336620">Delete</a> ()</td></tr>
<tr class="separator:a418c8756c74bb200de5e17afd7336620"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac3e88c39000c590d4e804298e2724c6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#aac3e88c39000c590d4e804298e2724c6">GenerateCase</a> (const std::string output_path)</td></tr>
<tr class="separator:aac3e88c39000c590d4e804298e2724c6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8a58afe0ec434646bc59dafb2925b0ff"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a8a58afe0ec434646bc59dafb2925b0ff">GenerateCoarseMesh</a> () const</td></tr>
<tr class="separator:a8a58afe0ec434646bc59dafb2925b0ff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adac39ccc5e6781cba188e4b4f1e682fd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#adac39ccc5e6781cba188e4b4f1e682fd">RefineMesh</a> () const</td></tr>
<tr class="separator:adac39ccc5e6781cba188e4b4f1e682fd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82dd421b7ab2256a8fa6c763dcc4787a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a82dd421b7ab2256a8fa6c763dcc4787a">GenerateBoundaryMesh</a> () const</td></tr>
<tr class="separator:a82dd421b7ab2256a8fa6c763dcc4787a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a16d995f5a08faf6e7cd89e9f750734e9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a16d995f5a08faf6e7cd89e9f750734e9">GrabMeshinfoFromLibmesh</a> ()</td></tr>
<tr class="separator:a16d995f5a08faf6e7cd89e9f750734e9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_methods_classfemus_1_1_multi_level_mesh_two"><td colspan="2" onclick="javascript:toggleInherit('pub_methods_classfemus_1_1_multi_level_mesh_two')"><img src="closed.png" alt="-"/>&#160;Public Member Functions inherited from <a class="el" href="classfemus_1_1_multi_level_mesh_two.html">femus::MultiLevelMeshTwo</a></td></tr>
<tr class="memitem:a8ef3229e483c6af9adc5a229de775fe4 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a8ef3229e483c6af9adc5a229de775fe4">MultiLevelMeshTwo</a> ()</td></tr>
<tr class="separator:a8ef3229e483c6af9adc5a229de775fe4 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6f3b2f33e877654cbe2deec4bcc783b inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#aa6f3b2f33e877654cbe2deec4bcc783b">MultiLevelMeshTwo</a> (const unsigned nolevels, const unsigned <a class="el" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, const <a class="el" href="_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031d">GeomElType</a> geomel_type, const std::string mesh_file_in)</td></tr>
<tr class="separator:aa6f3b2f33e877654cbe2deec4bcc783b inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0957e12f70519d5a208c4dcb64ab1479 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a0957e12f70519d5a208c4dcb64ab1479">clear</a> ()</td></tr>
<tr class="separator:a0957e12f70519d5a208c4dcb64ab1479 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab40ccf25155da82eba08e5c328c2340e inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#ab40ccf25155da82eba08e5c328c2340e">ElemChildToFather</a> ()</td></tr>
<tr class="separator:ab40ccf25155da82eba08e5c328c2340e inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa6ccebf256b74843676735f05f4a2521 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#aa6ccebf256b74843676735f05f4a2521">ComputeElemOffsetsBySubdLevel</a> ()</td></tr>
<tr class="separator:aa6ccebf256b74843676735f05f4a2521 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6ad5acbba0b96c59cb48d77cbb8f3827 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a6ad5acbba0b96c59cb48d77cbb8f3827">FillNodeSto</a> ()</td></tr>
<tr class="separator:a6ad5acbba0b96c59cb48d77cbb8f3827 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a82ef73f3ce811a7475a8e92f827ce17a inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a82ef73f3ce811a7475a8e92f827ce17a">ComputeNodeOffsetsBySubdLevel</a> ()</td></tr>
<tr class="separator:a82ef73f3ce811a7475a8e92f827ce17a inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0bbe7e9cca35f2cb2f93cbb50718ee76 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a0bbe7e9cca35f2cb2f93cbb50718ee76">ComputeMaxElXNode</a> ()</td></tr>
<tr class="separator:a0bbe7e9cca35f2cb2f93cbb50718ee76 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6c4b8b1cd5e1d30f315d5fbab4e472eb inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a6c4b8b1cd5e1d30f315d5fbab4e472eb">ComputeNodeMapExtLevels</a> ()</td></tr>
<tr class="separator:a6c4b8b1cd5e1d30f315d5fbab4e472eb inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab9d25c5c55f650ac17469b863a7586d1 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfemus_1_1_domain.html">Domain</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#ab9d25c5c55f650ac17469b863a7586d1">GetDomain</a> () const</td></tr>
<tr class="separator:ab9d25c5c55f650ac17469b863a7586d1 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a256cc90a75f655f95e94dbce46177b31 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a256cc90a75f655f95e94dbce46177b31">SetDomain</a> (<a class="el" href="classfemus_1_1_domain.html">Domain</a> *)</td></tr>
<tr class="separator:a256cc90a75f655f95e94dbce46177b31 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac2b345f7a5f8b3c59436f037ede4c6b1 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">const double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#ac2b345f7a5f8b3c59436f037ede4c6b1">get_Lref</a> () const</td></tr>
<tr class="separator:ac2b345f7a5f8b3c59436f037ede4c6b1 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a767181491d990e3b808571309b153eb9 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a> () const</td></tr>
<tr class="separator:a767181491d990e3b808571309b153eb9 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c89c8df632231b116f5113f79dcf008 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a1c89c8df632231b116f5113f79dcf008">SetLref</a> (const double lref_in)</td></tr>
<tr class="separator:a1c89c8df632231b116f5113f79dcf008 inherit pub_methods_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a8ff0e1ca8e4b16e005e8a37799c43194"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a8ff0e1ca8e4b16e005e8a37799c43194">ReadMGOps</a> (const std::string output_path, <a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *mysys)</td></tr>
<tr class="separator:a8ff0e1ca8e4b16e005e8a37799c43194"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b47da5519d3b8d3d3d4778bc07deef3"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a2b47da5519d3b8d3d3d4778bc07deef3">ReadMatrix</a> (const std::string &amp;name, <a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *mysys)</td></tr>
<tr class="separator:a2b47da5519d3b8d3d3d4778bc07deef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a537015fb25eb05e896a2ab4da02d4c9f"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a537015fb25eb05e896a2ab4da02d4c9f">ReadProl</a> (const std::string &amp;name, <a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *mysys)</td></tr>
<tr class="separator:a537015fb25eb05e896a2ab4da02d4c9f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37997ccf132703dfabf7bead831f6f38"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a37997ccf132703dfabf7bead831f6f38">ReadRest</a> (const std::string &amp;name, <a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *mysys)</td></tr>
<tr class="separator:a37997ccf132703dfabf7bead831f6f38"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Data Fields</h2></td></tr>
<tr class="memitem:a17c27a66dbb43c45aacf26cc204e6892"><td class="memItemLeft" align="right" valign="top">std::vector&lt; <a class="el" href="classfemus_1_1_geom_elem_base.html">GeomElemBase</a> * &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_gen_case.html#a17c27a66dbb43c45aacf26cc204e6892">_feelems</a></td></tr>
<tr class="separator:a17c27a66dbb43c45aacf26cc204e6892"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="inherit_header pub_attribs_classfemus_1_1_multi_level_mesh_two"><td colspan="2" onclick="javascript:toggleInherit('pub_attribs_classfemus_1_1_multi_level_mesh_two')"><img src="closed.png" alt="-"/>&#160;Data Fields inherited from <a class="el" href="classfemus_1_1_multi_level_mesh_two.html">femus::MultiLevelMeshTwo</a></td></tr>
<tr class="memitem:a0d43deb111e461db94315df3c8f6b0ed inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">const <a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a0d43deb111e461db94315df3c8f6b0ed">_dim</a></td></tr>
<tr class="memdesc:a0d43deb111e461db94315df3c8f6b0ed inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">spatial dimension  <br /></td></tr>
<tr class="separator:a0d43deb111e461db94315df3c8f6b0ed inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2073adff4b7add5f6d88efa9d725bb35 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a></td></tr>
<tr class="separator:a2073adff4b7add5f6d88efa9d725bb35 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a345e33af17ea0c184dbf07285bb17d31 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a></td></tr>
<tr class="memdesc:a345e33af17ea0c184dbf07285bb17d31 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">current subdomain  <br /></td></tr>
<tr class="separator:a345e33af17ea0c184dbf07285bb17d31 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68f3f358a51963417fbaeb9255d2c2c3 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a></td></tr>
<tr class="memdesc:a68f3f358a51963417fbaeb9255d2c2c3 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of subdomains (subdomain P)  <br /></td></tr>
<tr class="separator:a68f3f358a51963417fbaeb9255d2c2c3 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac880a3845b674c89c531ebc387f6fa41 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#ac880a3845b674c89c531ebc387f6fa41">_type_FEM</a> [<a class="el" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>]</td></tr>
<tr class="memdesc:ac880a3845b674c89c531ebc387f6fa41 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">Number of Levels (L)  <br /></td></tr>
<tr class="separator:ac880a3845b674c89c531ebc387f6fa41 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7da44ed973c45cc98c53369b60d61a5a inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a> [<a class="el" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>][<a class="el" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>]</td></tr>
<tr class="memdesc:a7da44ed973c45cc98c53369b60d61a5a inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB] //just for check  <br /></td></tr>
<tr class="separator:a7da44ed973c45cc98c53369b60d61a5a inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8f12d2fca872882da380f30ea69984bb inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">short unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a8f12d2fca872882da380f30ea69984bb">_eltype_flag</a> [<a class="el" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>]</td></tr>
<tr class="memdesc:a8f12d2fca872882da380f30ea69984bb inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB]  <br /></td></tr>
<tr class="separator:a8f12d2fca872882da380f30ea69984bb inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afddb1d5ec4c83cb731720e4cc0dd5105 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#afddb1d5ec4c83cb731720e4cc0dd5105">_geomelem_id</a></td></tr>
<tr class="memdesc:afddb1d5ec4c83cb731720e4cc0dd5105 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB]  <br /></td></tr>
<tr class="separator:afddb1d5ec4c83cb731720e4cc0dd5105 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af194897d6292b23e5e37689f95409704 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::vector&lt; short unsigned &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#af194897d6292b23e5e37689f95409704">_geomelem_flag</a></td></tr>
<tr class="memdesc:af194897d6292b23e5e37689f95409704 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[DIM]  <br /></td></tr>
<tr class="separator:af194897d6292b23e5e37689f95409704 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2431608d37cb7fbe406de970b6b71788 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a></td></tr>
<tr class="memdesc:a2431608d37cb7fbe406de970b6b71788 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[DIM]  <br /></td></tr>
<tr class="separator:a2431608d37cb7fbe406de970b6b71788 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7508c00c363175fd124c4fec42e0637c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a></td></tr>
<tr class="memdesc:a7508c00c363175fd124c4fec42e0637c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB][L] Number of Elements <br  />
  <br /></td></tr>
<tr class="separator:a7508c00c363175fd124c4fec42e0637c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bb789736fb24676c0488d1a5a4c6a17 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a2bb789736fb24676c0488d1a5a4c6a17">_el_map</a></td></tr>
<tr class="memdesc:a2bb789736fb24676c0488d1a5a4c6a17 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB][L+P*_NoLevels] offset of element numbers <br  />
  <br /></td></tr>
<tr class="separator:a2bb789736fb24676c0488d1a5a4c6a17 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a83416b565efdbc3e138155219cfa9f5c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a83416b565efdbc3e138155219cfa9f5c">_el_bdry_to_vol</a></td></tr>
<tr class="memdesc:a83416b565efdbc3e138155219cfa9f5c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB][L+P*_NoLevels] Connectivity map <br  />
  <br /></td></tr>
<tr class="separator:a83416b565efdbc3e138155219cfa9f5c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8ed8b966375e77f855441b1bc0867c24 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a></td></tr>
<tr class="separator:a8ed8b966375e77f855441b1bc0867c24 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1cbec4cdab8a318ef1bbf3323cc2c47e inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a> [<a class="el" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>]</td></tr>
<tr class="memdesc:a1cbec4cdab8a318ef1bbf3323cc2c47e inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB][]  <br /></td></tr>
<tr class="separator:a1cbec4cdab8a318ef1bbf3323cc2c47e inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ebaec44ee8f9bef3be3325dc08edc88 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a3ebaec44ee8f9bef3be3325dc08edc88">_el_child_to_fath</a></td></tr>
<tr class="memdesc:a3ebaec44ee8f9bef3be3325dc08edc88 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[VB] //of the WHOLE REFINEMENT! //LMFILLS  <br /></td></tr>
<tr class="separator:a3ebaec44ee8f9bef3be3325dc08edc88 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a15a91978c93fe07eff517d90075301e5 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfemus_1_1_elem_sto_vol.html">ElemStoVol</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a></td></tr>
<tr class="memdesc:a15a91978c93fe07eff517d90075301e5 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="mdescLeft">&#160;</td><td class="mdescRight">[LEV][IELEM] //for every level, it gives you the father  <br /></td></tr>
<tr class="separator:a15a91978c93fe07eff517d90075301e5 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afd4c5c12b820008801e667b7701b9165 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfemus_1_1_elem_sto_bdry.html">ElemStoBdry</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a></td></tr>
<tr class="separator:afd4c5c12b820008801e667b7701b9165 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeee8551d149cdd762f5e493297ac2426 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#aeee8551d149cdd762f5e493297ac2426">_xyz</a></td></tr>
<tr class="separator:aeee8551d149cdd762f5e493297ac2426 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab974278587f62066f8747ed734f438c7 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a></td></tr>
<tr class="separator:ab974278587f62066f8747ed734f438c7 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a920204d0b6e8914d8b16e84e5f5b3b03 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a920204d0b6e8914d8b16e84e5f5b3b03">_Qnode_lev_Qnode_fine</a></td></tr>
<tr class="separator:a920204d0b6e8914d8b16e84e5f5b3b03 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:accd4caec1f81d3dfad0f1c69dd87b467 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a></td></tr>
<tr class="separator:accd4caec1f81d3dfad0f1c69dd87b467 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad212108f2e50d25b0ccdb3202a1fa130 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a></td></tr>
<tr class="separator:ad212108f2e50d25b0ccdb3202a1fa130 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2befae1f6286793dd66b614987eff74c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a></td></tr>
<tr class="separator:a2befae1f6286793dd66b614987eff74c inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2aa71c7d2a8aaf40ef6b28c0606cf7fe inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a></td></tr>
<tr class="separator:a2aa71c7d2a8aaf40ef6b28c0606cf7fe inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a12e7b8a567e73ca83cec9218b4aa41 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">_elxnode</a></td></tr>
<tr class="separator:a1a12e7b8a567e73ca83cec9218b4aa41 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a846b0a2baf5039c237d68920d7ee1f09 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">double *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a846b0a2baf5039c237d68920d7ee1f09">_nd_coords_libm</a></td></tr>
<tr class="separator:a846b0a2baf5039c237d68920d7ee1f09 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4324ce4d34f7d71cd37e19c271a416fc inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfemus_1_1_node_sto.html">NodeSto</a> **&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a></td></tr>
<tr class="separator:a4324ce4d34f7d71cd37e19c271a416fc inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a36e0eff2f50cb30f84ce331345108988 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a></td></tr>
<tr class="separator:a36e0eff2f50cb30f84ce331345108988 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeadabac66a6ee1c7fe8ec9b53c47a01b inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top"><a class="el" href="classfemus_1_1_domain.html">Domain</a> *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#aeadabac66a6ee1c7fe8ec9b53c47a01b">_domain</a></td></tr>
<tr class="separator:aeadabac66a6ee1c7fe8ec9b53c47a01b inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aca0f0af0223841f4cf9b306fdb2e3462 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a></td></tr>
<tr class="separator:aca0f0af0223841f4cf9b306fdb2e3462 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3078cd94966a22672df6b24d24fdcd60 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a></td></tr>
<tr class="separator:a3078cd94966a22672df6b24d24fdcd60 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a096557dfb03c8fa0173c29beaed36fee inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::vector&lt; std::pair&lt; int, int &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a></td></tr>
<tr class="separator:a096557dfb03c8fa0173c29beaed36fee inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5c4d7084bf63a5fd8b3ee38ec667dd79 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a></td></tr>
<tr class="separator:a5c4d7084bf63a5fd8b3ee38ec667dd79 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6abbf958a300ffd816c2bc7b42652320 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::vector&lt; int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a6abbf958a300ffd816c2bc7b42652320">_el_libm_fm</a></td></tr>
<tr class="separator:a6abbf958a300ffd816c2bc7b42652320 inherit pub_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="inherited" name="inherited"></a>
Additional Inherited Members</h2></td></tr>
<tr class="inherit_header pro_attribs_classfemus_1_1_multi_level_mesh_two"><td colspan="2" onclick="javascript:toggleInherit('pro_attribs_classfemus_1_1_multi_level_mesh_two')"><img src="closed.png" alt="-"/>&#160;Protected Attributes inherited from <a class="el" href="classfemus_1_1_multi_level_mesh_two.html">femus::MultiLevelMeshTwo</a></td></tr>
<tr class="memitem:a2e69e092b1871b1d3023e22ad7748d30 inherit pro_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memItemLeft" align="right" valign="top">std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="classfemus_1_1_multi_level_mesh_two.html#a2e69e092b1871b1d3023e22ad7748d30">_mesh_file</a></td></tr>
<tr class="separator:a2e69e092b1871b1d3023e22ad7748d30 inherit pro_attribs_classfemus_1_1_multi_level_mesh_two"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="_gen_case_8hpp_source.html#l00032">32</a> of file <a class="el" href="_gen_case_8hpp_source.html">GenCase.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aac5da7e30562ce9e894192215c2db96c" name="aac5da7e30562ce9e894192215c2db96c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac5da7e30562ce9e894192215c2db96c">&#9670;&#160;</a></span>GenCase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">femus::GenCase::GenCase </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>nolevels</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031d">GeomElType</a>&#160;</td>
          <td class="paramname"><em>geomel_type</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>mesh_file</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00037">37</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   38</span>     : <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a8ef3229e483c6af9adc5a229de775fe4">MultiLevelMeshTwo</a>(nolevels,<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,geomel_type,mesh_file_in)</div>
<div class="line"><span class="lineno">   39</span>{</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>   <a class="code hl_variable" href="classfemus_1_1_gen_case.html#a17c27a66dbb43c45aacf26cc204e6892">_feelems</a>.resize(<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>);</div>
<div class="line"><span class="lineno">   42</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) <a class="code hl_variable" href="classfemus_1_1_gen_case.html#a17c27a66dbb43c45aacf26cc204e6892">_feelems</a>[fe] = <a class="code hl_function" href="classfemus_1_1_geom_elem_base.html#a582b19d29667e30e9d7706cb0ff2e36f">GeomElemBase::build</a>(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afddb1d5ec4c83cb731720e4cc0dd5105">_geomelem_id</a>[<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1].c_str(),fe);</div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>}</div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_aca285339f9cf24489fdc0af5b51a5fde"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a></div><div class="ttdeci">#define QL</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00008">FETypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a17c27a66dbb43c45aacf26cc204e6892"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a17c27a66dbb43c45aacf26cc204e6892">femus::GenCase::_feelems</a></div><div class="ttdeci">std::vector&lt; GeomElemBase * &gt; _feelems</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8hpp_source.html#l00066">GenCase.hpp:66</a></div></div>
<div class="ttc" id="aclassfemus_1_1_geom_elem_base_html_a582b19d29667e30e9d7706cb0ff2e36f"><div class="ttname"><a href="classfemus_1_1_geom_elem_base.html#a582b19d29667e30e9d7706cb0ff2e36f">femus::GeomElemBase::build</a></div><div class="ttdeci">static GeomElemBase * build(const std::string geomel_id_in, const uint fe_family)</div><div class="ttdef"><b>Definition</b> <a href="_geom_elem_base_8cpp_source.html#l00041">GeomElemBase.cpp:41</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a767181491d990e3b808571309b153eb9"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">femus::MultiLevelMeshTwo::get_dim</a></div><div class="ttdeci">const uint get_dim() const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00115">MultiLevelMeshTwo.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a8ef3229e483c6af9adc5a229de775fe4"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a8ef3229e483c6af9adc5a229de775fe4">femus::MultiLevelMeshTwo::MultiLevelMeshTwo</a></div><div class="ttdeci">MultiLevelMeshTwo()</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00050">MultiLevelMeshTwo.hpp:50</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_afddb1d5ec4c83cb731720e4cc0dd5105"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#afddb1d5ec4c83cb731720e4cc0dd5105">femus::MultiLevelMeshTwo::_geomelem_id</a></div><div class="ttdeci">std::vector&lt; std::string &gt; _geomelem_id</div><div class="ttdoc">[VB]</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00077">MultiLevelMeshTwo.hpp:77</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae154b7b406541bda5fc562ac7350574f" name="ae154b7b406541bda5fc562ac7350574f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae154b7b406541bda5fc562ac7350574f">&#9670;&#160;</a></span>~GenCase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">femus::GenCase::~GenCase </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00046">46</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   46</span>                  {</div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>.clear();  <span class="comment">// AAA These must be destroyed HERE because they are created in PARALLEL by both processors!</span></div>
<div class="line"><span class="lineno">   49</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a>.clear();  <span class="comment">//TODO is this a real destructor?</span></div>
<div class="line"><span class="lineno">   50</span> </div>
<div class="line"><span class="lineno">   51</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>.clear();</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span><span class="comment">//   delete _el_libm_fm; //TODO how come i cant delete this one here? when i&#39;m serial yes, but not when i&#39;m parallel</span></div>
<div class="line"><span class="lineno">   54</span>    <span class="comment">// Oh well YES, because i put this INSIDE an IFPROC==0 !!!!!!!!!</span></div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>    <span class="comment">//clean</span></div>
<div class="line"><span class="lineno">   57</span>  <span class="comment">//remember that the CHILD destructor is not called here. This is because </span></div>
<div class="line"><span class="lineno">   58</span>  <span class="comment">//these things are of GeomElemBase type</span></div>
<div class="line"><span class="lineno">   59</span>  <span class="comment">//TODO Do I have to put a delete [] or only delete? Do standard vectors have an overloading of the &quot;delete&quot; operator?</span></div>
<div class="line"><span class="lineno">   60</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) <span class="keyword">delete</span> <a class="code hl_variable" href="classfemus_1_1_gen_case.html#a17c27a66dbb43c45aacf26cc204e6892">_feelems</a>[fe];</div>
<div class="line"><span class="lineno">   61</span>  </div>
<div class="line"><span class="lineno">   62</span>}</div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a096557dfb03c8fa0173c29beaed36fee"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">femus::MultiLevelMeshTwo::_el_fm_libm_b</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int, int &gt; &gt; _el_fm_libm_b</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00123">MultiLevelMeshTwo.hpp:123</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a3078cd94966a22672df6b24d24fdcd60"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">femus::MultiLevelMeshTwo::_el_fm_libm</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int, int &gt; &gt; _el_fm_libm</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00122">MultiLevelMeshTwo.hpp:122</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_aca0f0af0223841f4cf9b306fdb2e3462"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">femus::MultiLevelMeshTwo::_nd_fm_libm</a></div><div class="ttdeci">std::vector&lt; std::pair&lt; int, int &gt; &gt; _nd_fm_libm</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00121">MultiLevelMeshTwo.hpp:121</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="af03fdb695fdbdd9328ab53c28e57b796" name="af03fdb695fdbdd9328ab53c28e57b796"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af03fdb695fdbdd9328ab53c28e57b796">&#9670;&#160;</a></span>ComputeAndPrintMatrix()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ComputeAndPrintMatrix </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function computes the sparse matrix pattern. </p>

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l01298">1298</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1298</span>                                                               {</div>
<div class="line"><span class="lineno"> 1299</span> </div>
<div class="line"><span class="lineno"> 1300</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno"> 1301</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; GenCase::compute_matrix:  start \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1302</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1303</span> </div>
<div class="line"><span class="lineno"> 1304</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> NegativeOneFlag = -1;</div>
<div class="line"><span class="lineno"> 1305</span> </div>
<div class="line"><span class="lineno"> 1306</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno"> 1307</span><span class="comment">//============ ALLOCATIONS =====================================</span></div>
<div class="line"><span class="lineno"> 1308</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1310</span>    <span class="keywordtype">int</span> ** off_dof = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];  <span class="comment">//TODO do the delete for this</span></div>
<div class="line"><span class="lineno"> 1311</span>    off_dof[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>];  <span class="comment">//You set the pointers to be equal</span></div>
<div class="line"><span class="lineno"> 1312</span>    off_dof[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>];  <span class="comment">//You set the pointers to be equal</span></div>
<div class="line"><span class="lineno"> 1313</span>    off_dof[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];  <span class="comment">//You set the pointers to be equal</span></div>
<div class="line"><span class="lineno"> 1314</span> </div>
<div class="line"><span class="lineno"> 1315</span>    <span class="keywordtype">int</span> *** lenG;</div>
<div class="line"><span class="lineno"> 1316</span>    <span class="keywordtype">int</span> *** lenoffG;</div>
<div class="line"><span class="lineno"> 1317</span>    <span class="keywordtype">int</span> *** MatG;</div>
<div class="line"><span class="lineno"> 1318</span>    <span class="keywordtype">int</span> *** memG;</div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span><span class="comment">//========= CREATE THE FILE ============================</span></div>
<div class="line"><span class="lineno"> 1321</span>    std::string f_matrix  = <a class="code hl_define" href="_femus_default_8hpp.html#a38b4725eb3b423ebb1fe835d244bb3e6">DEFAULT_F_MATRIX</a>;</div>
<div class="line"><span class="lineno"> 1322</span>    std::string ext_h5    = <a class="code hl_define" href="_femus_default_8hpp.html#a88cc18ae6f1376162580864906e9fcef">DEFAULT_EXT_H5</a>;</div>
<div class="line"><span class="lineno"> 1323</span> </div>
<div class="line"><span class="lineno"> 1324</span>        std::ostringstream name;</div>
<div class="line"><span class="lineno"> 1325</span>        name &lt;&lt; output_path &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; f_matrix &lt;&lt; ext_h5;</div>
<div class="line"><span class="lineno"> 1326</span>        hid_t file = H5Fcreate(name.str().c_str(), H5F_ACC_TRUNC, H5P_DEFAULT,H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 1327</span> </div>
<div class="line"><span class="lineno"> 1328</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno"> 1329</span><span class="comment">//============ LEVEL LOOP ======================================</span></div>
<div class="line"><span class="lineno"> 1330</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno"> 1331</span> </div>
<div class="line"><span class="lineno"> 1332</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Level1 = 0; Level1 &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>; Level1++) {</div>
<div class="line"><span class="lineno"> 1333</span> </div>
<div class="line"><span class="lineno"> 1334</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno"> 1335</span>        std::clock_t   <a class="code hl_variable" href="_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a>=std::clock();</div>
<div class="line"><span class="lineno"> 1336</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1337</span> </div>
<div class="line"><span class="lineno"> 1338</span>    std::ostringstream groupname_lev; groupname_lev &lt;&lt;  <span class="stringliteral">&quot;LEVEL&quot;</span> &lt;&lt; Level1;</div>
<div class="line"><span class="lineno"> 1339</span>    hid_t group = H5Gcreate(file, groupname_lev.str().c_str(), H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 1340</span> </div>
<div class="line"><span class="lineno"> 1341</span><span class="comment">//============== SET LEVELS and DOFS =======================</span></div>
<div class="line"><span class="lineno"> 1342</span>        <span class="keywordtype">int</span> FELevel[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1343</span>        FELevel[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level1;</div>
<div class="line"><span class="lineno"> 1344</span>        FELevel[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = (Level1+<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>)%(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+1);</div>
<div class="line"><span class="lineno"> 1345</span>        FELevel[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level1;</div>
<div class="line"><span class="lineno"> 1346</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>** n_dofs_lev_fe;</div>
<div class="line"><span class="lineno"> 1347</span>        n_dofs_lev_fe = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1348</span>        n_dofs_lev_fe[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>;            <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno"> 1349</span>        n_dofs_lev_fe[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>;            <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno"> 1350</span>        n_dofs_lev_fe[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];  <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno"> 1351</span> </div>
<div class="line"><span class="lineno"> 1352</span>        lenG       = <span class="keyword">new</span> <span class="keywordtype">int</span>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1353</span>        lenoffG    = <span class="keyword">new</span> <span class="keywordtype">int</span>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1354</span>        MatG       = <span class="keyword">new</span> <span class="keywordtype">int</span>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1355</span>        memG       = <span class="keyword">new</span> <span class="keywordtype">int</span>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1356</span> </div>
<div class="line"><span class="lineno"> 1357</span>        <span class="comment">//initial setups</span></div>
<div class="line"><span class="lineno"> 1358</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;r++) {</div>
<div class="line"><span class="lineno"> 1359</span>            MatG[r]       = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1360</span>            memG[r]       = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1361</span> </div>
<div class="line"><span class="lineno"> 1362</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) {</div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>                memG[r][c]       = <span class="keyword">new</span> <span class="keywordtype">int</span>[ n_dofs_lev_fe[r][FELevel[r]] ];   <span class="comment">//for every row, it memorizes the offset for multiple occurrences</span></div>
<div class="line"><span class="lineno"> 1365</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im = 0; im &lt; n_dofs_lev_fe[r][ FELevel[r] ]; im++)     memG[r][c][im] = 0;</div>
<div class="line"><span class="lineno"> 1366</span> </div>
<div class="line"><span class="lineno"> 1367</span>                MatG[r][c]       = <span class="keyword">new</span> <span class="keywordtype">int</span>[n_dofs_lev_fe[r][FELevel[r]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>];       <span class="comment">// or even better (n_dofs_lev_fe[level][FE_ROW]) * ( _elnodes[VV][FE_COL]*_elxnode[ROW_DOF])</span></div>
<div class="line"><span class="lineno"> 1368</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> im = 0; im &lt;     n_dofs_lev_fe[r][FELevel[r]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>; im++)  MatG[r][c][im] = NegativeOneFlag;</div>
<div class="line"><span class="lineno"> 1369</span>            }</div>
<div class="line"><span class="lineno"> 1370</span>        }</div>
<div class="line"><span class="lineno"> 1371</span> </div>
<div class="line"><span class="lineno"> 1372</span><span class="comment">// ========== DOF EXTREMES AT LEVEL ====================================</span></div>
<div class="line"><span class="lineno"> 1373</span> </div>
<div class="line"><span class="lineno"> 1374</span>        <span class="keywordtype">int</span> ** dof_extreme_at_lev_sd;</div>
<div class="line"><span class="lineno"> 1375</span>        dof_extreme_at_lev_sd= <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1376</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)   dof_extreme_at_lev_sd[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span> [<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>+1];</div>
<div class="line"><span class="lineno"> 1377</span> </div>
<div class="line"><span class="lineno"> 1378</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)  {</div>
<div class="line"><span class="lineno"> 1379</span>            dof_extreme_at_lev_sd[fe][0]=0;</div>
<div class="line"><span class="lineno"> 1380</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idom=0;idom&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>;idom++) {</div>
<div class="line"><span class="lineno"> 1381</span>                <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)       dof_extreme_at_lev_sd[fe][idom+1] =  dof_extreme_at_lev_sd[fe][idom] + ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>]);</div>
<div class="line"><span class="lineno"> 1382</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) dof_extreme_at_lev_sd[fe][idom+1] =  dof_extreme_at_lev_sd[fe][idom] + ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1]);</div>
<div class="line"><span class="lineno"> 1383</span>                <span class="comment">//from this you see that on a given level the dofs are of course numbered CONTIGUOUSLY; in practice this is the construction of the dof map</span></div>
<div class="line"><span class="lineno"> 1384</span>            }</div>
<div class="line"><span class="lineno"> 1385</span>        }</div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span><span class="comment">// ==============================================</span></div>
<div class="line"><span class="lineno"> 1388</span><span class="comment">// ====== Mesh loop =============================</span></div>
<div class="line"><span class="lineno"> 1389</span><span class="comment">// ==============================================</span></div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pr=0;pr&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>;pr++) {</div>
<div class="line"><span class="lineno"> 1392</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1]; iel &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1+1]; iel++) {</div>
<div class="line"><span class="lineno"> 1393</span>                <span class="keywordtype">int</span> el_lib = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>[iel].second;</div>
<div class="line"><span class="lineno"> 1394</span> </div>
<div class="line"><span class="lineno"> 1395</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;r++) {</div>
<div class="line"><span class="lineno"> 1396</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> k_r=0; k_r &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][r]; k_r++) { <span class="comment">//this loop can be optimized because some operations are not done for KK</span></div>
<div class="line"><span class="lineno"> 1397</span>                        <span class="keywordtype">int</span> nd_libm_r = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_lib]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[k_r];</div>
<div class="line"><span class="lineno"> 1398</span>                        <span class="keywordtype">int</span> nd_r  = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>[ nd_libm_r ]; <span class="comment">//node corresponding to the row k_r</span></div>
<div class="line"><span class="lineno"> 1399</span>                        <span class="keywordtype">int</span> dof_r = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[FELevel[r]][nd_r];              <span class="comment">//dof corresponding to the node for that level</span></div>
<div class="line"><span class="lineno"> 1400</span> </div>
<div class="line"><span class="lineno"> 1401</span>                        <span class="keywordflow">if</span> (r==<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {</div>
<div class="line"><span class="lineno"> 1402</span>                            <span class="keywordtype">int</span> sum_previous_sd=0;      <span class="comment">//sum of the dofs AT THAT LEVEL coming from the PREVIOUSLY CONSIDERED SUBDOMAINS</span></div>
<div class="line"><span class="lineno"> 1403</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sd=0;sd&lt;pr;sd++) sum_previous_sd += <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1];</div>
<div class="line"><span class="lineno"> 1404</span>                            dof_r = iel - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1] + sum_previous_sd;</div>
<div class="line"><span class="lineno"> 1405</span>                        }</div>
<div class="line"><span class="lineno"> 1406</span><span class="comment">// put debug control here on dof_r</span></div>
<div class="line"><span class="lineno"> 1407</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) {</div>
<div class="line"><span class="lineno"> 1408</span>                            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> k_c=0;k_c &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]; k_c++) {</div>
<div class="line"><span class="lineno"> 1409</span>                                <span class="keywordtype">int</span> nd_c  = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>[ <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_lib]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[k_c]];  <span class="comment">//node corresponding to the column k_c</span></div>
<div class="line"><span class="lineno"> 1410</span>                                <span class="keywordtype">int</span> dof_c = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[FELevel[c]][nd_c];</div>
<div class="line"><span class="lineno"> 1411</span> </div>
<div class="line"><span class="lineno"> 1412</span>                                <span class="keywordflow">if</span> (c==<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {</div>
<div class="line"><span class="lineno"> 1413</span>                                    <span class="keywordtype">int</span> sum_previous_sd=0;      <span class="comment">//sum of the dofs AT THAT LEVEL coming from the PREVIOUSLY CONSIDERED SUBDOMAINS</span></div>
<div class="line"><span class="lineno"> 1414</span>                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sd=0;sd&lt;pr;sd++) sum_previous_sd += <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1];</div>
<div class="line"><span class="lineno"> 1415</span>                                    dof_c = iel - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1] + sum_previous_sd;</div>
<div class="line"><span class="lineno"> 1416</span>                                }</div>
<div class="line"><span class="lineno"> 1417</span> </div>
<div class="line"><span class="lineno"> 1418</span>                                MatG[r][c][ dof_r*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a> + memG[r][c][dof_r]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c] + k_c ] = dof_c;</div>
<div class="line"><span class="lineno"> 1419</span> </div>
<div class="line"><span class="lineno"> 1420</span>                            }   <span class="comment">//&gt;&gt;&gt;&gt;&gt;&gt;&gt; end k_c</span></div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>                            <span class="comment">//for the current row &quot;r&quot;, we hit this column &quot;c&quot; with the current element, so we must remember it when we hit it with another element</span></div>
<div class="line"><span class="lineno"> 1423</span>                            <span class="comment">//for every row dof nd_r... memG is basically the &quot;number of involved elements&quot;   //jump by another element in that row</span></div>
<div class="line"><span class="lineno"> 1424</span>                            memG[r][c][dof_r] +=  1;</div>
<div class="line"><span class="lineno"> 1425</span> </div>
<div class="line"><span class="lineno"> 1426</span>                        } <span class="comment">//&gt;&gt;&gt;&gt;&gt;&gt;&gt;end c</span></div>
<div class="line"><span class="lineno"> 1427</span>                    }   <span class="comment">//&gt;&gt;&gt;&gt;&gt;&gt;&gt; end k_r</span></div>
<div class="line"><span class="lineno"> 1428</span>                }  <span class="comment">//&gt;&gt;&gt;&gt;&gt;&gt;&gt; end r</span></div>
<div class="line"><span class="lineno"> 1429</span>            } <span class="comment">//&gt;&gt;&gt;&gt;&gt;&gt;&gt; end element</span></div>
<div class="line"><span class="lineno"> 1430</span>        }  <span class="comment">//&gt;&gt;&gt;&gt;&gt;&gt;&gt; end subdomain</span></div>
<div class="line"><span class="lineno"> 1431</span> </div>
<div class="line"><span class="lineno"> 1432</span> </div>
<div class="line"><span class="lineno"> 1433</span><span class="comment">//here you don&#39;t use memG anymore</span></div>
<div class="line"><span class="lineno"> 1434</span> </div>
<div class="line"><span class="lineno"> 1435</span><span class="comment">//  debug      for (uint im = 0; im &lt; n_nodes_f*_elnodes[VV][QQ]*_maxelxnode; im++) {   std::cout &lt;&lt; MatG[LL][QQ][im] &lt;&lt; std::endl; }</span></div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span><span class="comment">//================================================================</span></div>
<div class="line"><span class="lineno"> 1438</span><span class="comment">//====== COMPRESS, COUNT LENGTHS, then PRINT, then DESTROY ===============</span></div>
<div class="line"><span class="lineno"> 1439</span><span class="comment">//===============================================================</span></div>
<div class="line"><span class="lineno"> 1440</span> </div>
<div class="line"><span class="lineno"> 1441</span>        <span class="keywordtype">int</span>** countG    = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];      <span class="comment">//[FE_R][FE_C] this is on the fly, for every row involving FE_R and FE_C; these are stored in lenG and lenoffG</span></div>
<div class="line"><span class="lineno"> 1442</span>        <span class="keywordtype">int</span>** countoffG = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1443</span> </div>
<div class="line"><span class="lineno"> 1444</span><span class="comment">//==============================================</span></div>
<div class="line"><span class="lineno"> 1445</span><span class="comment">//====== Begin the Big (r,c) FECouple loop =========</span></div>
<div class="line"><span class="lineno"> 1446</span><span class="comment">//==============================================</span></div>
<div class="line"><span class="lineno"> 1447</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;r++) {</div>
<div class="line"><span class="lineno"> 1448</span> </div>
<div class="line"><span class="lineno"> 1449</span>            countG[r]     = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1450</span>            countoffG[r]  = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1451</span>            lenG[r]       = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1452</span>            lenoffG[r]    = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1453</span> </div>
<div class="line"><span class="lineno"> 1454</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) {</div>
<div class="line"><span class="lineno"> 1455</span> </div>
<div class="line"><span class="lineno"> 1456</span><span class="comment">//=============================================</span></div>
<div class="line"><span class="lineno"> 1457</span><span class="comment">//============== COMPRESS MatG ================</span></div>
<div class="line"><span class="lineno"> 1458</span><span class="comment">//=============================================</span></div>
<div class="line"><span class="lineno"> 1459</span>                <span class="keywordtype">int</span> *  aux;</div>
<div class="line"><span class="lineno"> 1460</span>                lenG[r][c]       = <span class="keyword">new</span> <span class="keywordtype">int</span>[ n_dofs_lev_fe[r][FELevel[r]] + 1 ];   <span class="comment">//notice how actually these do not depend on &quot;c&quot;</span></div>
<div class="line"><span class="lineno"> 1461</span>                lenoffG[r][c]    = <span class="keyword">new</span> <span class="keywordtype">int</span>[ n_dofs_lev_fe[r][FELevel[r]] + 1 ];   <span class="comment">//notice how actually these do not depend on &quot;c&quot;</span></div>
<div class="line"><span class="lineno"> 1462</span>                aux = <span class="keyword">new</span> <span class="keywordtype">int</span>[ n_dofs_lev_fe[r][FELevel[r]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>];  <span class="comment">//This has the same length as MatG</span></div>
<div class="line"><span class="lineno"> 1463</span> </div>
<div class="line"><span class="lineno"> 1464</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i &lt; n_dofs_lev_fe[r][FELevel[r]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>; i++) aux[i] = 0;</div>
<div class="line"><span class="lineno"> 1465</span> </div>
<div class="line"><span class="lineno"> 1466</span>                countG[r][c] = 0;</div>
<div class="line"><span class="lineno"> 1467</span>                countoffG[r][c] = 0;</div>
<div class="line"><span class="lineno"> 1468</span>                lenG[r][c][0] = 0;</div>
<div class="line"><span class="lineno"> 1469</span>                lenoffG[r][c][0] = 0;</div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span>                <span class="keywordtype">int</span> ki=0; <span class="comment">//the maximum value for ki is what? The sum of all the _off_nd_ql for all _nsubdomains, so it is exactly the number of nodes of the current level Level1</span></div>
<div class="line"><span class="lineno"> 1472</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kdom=0;kdom &lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>; kdom++) {</div>
<div class="line"><span class="lineno"> 1473</span>                    <span class="keywordtype">int</span> delta_dof_at_lev_sd;</div>
<div class="line"><span class="lineno"> 1474</span>                    <span class="keywordflow">if</span>       (r &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  delta_dof_at_lev_sd =  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[r][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1+1] -  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[r][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>];</div>
<div class="line"><span class="lineno"> 1475</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  delta_dof_at_lev_sd = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Level1];</div>
<div class="line"><span class="lineno"> 1476</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iki=0; iki &lt; delta_dof_at_lev_sd; iki++) {</div>
<div class="line"><span class="lineno"> 1477</span>                        <span class="comment">//is this Level1 or FELevel[r]? No, this must be Level1 because you do not have &quot;nsubdomains*(nlevels+1)&quot; groups.</span></div>
<div class="line"><span class="lineno"> 1478</span>                        <span class="comment">//this is the &quot;OFFSET of the DOFS (q,l,constant,...) WITH RESPECT TO the SUBDOMAINS and the &quot;NUMBER of LEVELS of the QUADRATIC MESH&quot; (Level1)</span></div>
<div class="line"><span class="lineno"> 1479</span>                        <span class="comment">//you see that nothing depends on iki, so it is just a counter</span></div>
<div class="line"><span class="lineno"> 1480</span>                        <span class="comment">//also notice that iki is DIFFERENT from ki !!!</span></div>
<div class="line"><span class="lineno"> 1481</span>                        <span class="comment">//iki goes from zero to the sum of dofs PER SUBDOMAIN and PER LEVEL;</span></div>
<div class="line"><span class="lineno"> 1482</span>                        <span class="comment">// ki goes from zero to the sum of dofs PER LEVEL, so on ALL subdomains</span></div>
<div class="line"><span class="lineno"> 1483</span>                        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> kj=0;kj &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>; kj++) {</div>
<div class="line"><span class="lineno"> 1484</span>                            <span class="keywordtype">int</span> kdofG = MatG[r][c][<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>*ki+kj];</div>
<div class="line"><span class="lineno"> 1485</span>                            <span class="keywordflow">if</span> (kdofG &gt;= 0)    aux[kdofG]=1;  <span class="comment">//aux=1 means that there is a node of the sparsity pattern</span></div>
<div class="line"><span class="lineno"> 1486</span>                        }</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>                        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> kj=0;kj &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>; kj++) {</div>
<div class="line"><span class="lineno"> 1489</span>                            <span class="keywordtype">int</span> kdofG = MatG[r][c][<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][c]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>*ki+kj];</div>
<div class="line"><span class="lineno"> 1490</span>                            <span class="keywordflow">if</span> (kdofG&gt;=0 &amp;&amp;   aux[kdofG]==1) {</div>
<div class="line"><span class="lineno"> 1491</span>                                aux[kdofG]=0;                      <span class="comment">//if you found a node of the sparsity pattern, you do not have to count it anymore the next times</span></div>
<div class="line"><span class="lineno"> 1492</span>                                MatG[r][c][countG[r][c]]=kdofG;    <span class="comment">//WE ARE REWRITING ON TOP OF THE SAME ARRAY!</span></div>
<div class="line"><span class="lineno"> 1493</span>                                <span class="comment">//yes, because countG[r][c] is never gonna be larger than &quot;_elnodes[VV][QQ/*c*/]*_maxelxnode&quot;</span></div>
<div class="line"><span class="lineno"> 1494</span>                                <span class="comment">//then on the next row you will go ahead ATTACHED to the PREVIOUS, and of course you&#39;re gonna have</span></div>
<div class="line"><span class="lineno"> 1495</span>                                <span class="comment">//some DOUBLE OCCURRENCES so for sure you will not superimpose.</span></div>
<div class="line"><span class="lineno"> 1496</span>                                <span class="comment">//TODO: this is compatible also with having _elxnode instead of _maxelxnode</span></div>
<div class="line"><span class="lineno"> 1497</span>                                countG[r][c]++;                    <span class="comment">//increase the count of the length of that row</span></div>
<div class="line"><span class="lineno"> 1498</span>                                <span class="keywordflow">if</span> ( kdofG  &lt; (<span class="keywordtype">int</span>) dof_extreme_at_lev_sd[c][kdom] || kdofG &gt;= (int) dof_extreme_at_lev_sd[c][kdom+1] )  countoffG[r][c]++;  <span class="comment">//increase the count of the off-processor columns</span></div>
<div class="line"><span class="lineno"> 1499</span>                                <span class="comment">//if the dof number is outside the range, then increase</span></div>
<div class="line"><span class="lineno"> 1500</span>                            }</div>
<div class="line"><span class="lineno"> 1501</span>                        }</div>
<div class="line"><span class="lineno"> 1502</span>                        <span class="comment">//here you finish the contributions of ONE ROW: so you summarize the resulting counts</span></div>
<div class="line"><span class="lineno"> 1503</span>                           lenG[r][c][ki+1] =    countG[r][c];</div>
<div class="line"><span class="lineno"> 1504</span>                        lenoffG[r][c][ki+1] = countoffG[r][c];</div>
<div class="line"><span class="lineno"> 1505</span> </div>
<div class="line"><span class="lineno"> 1506</span>                        ki++; <span class="comment">//increase the row index for that level (you are inside &quot;r&quot; and &quot;c&quot;, so you re-use it everytime from scratch)</span></div>
<div class="line"><span class="lineno"> 1507</span>                    }</div>
<div class="line"><span class="lineno"> 1508</span>                }</div>
<div class="line"><span class="lineno"> 1509</span>                <span class="comment">//=============</span></div>
<div class="line"><span class="lineno"> 1510</span>                <span class="comment">//at this point countG and countoffG give you the length of Mat</span></div>
<div class="line"><span class="lineno"> 1511</span>                <span class="comment">//the arrays &quot;len&quot; have length equal to the number of row dofs</span></div>
<div class="line"><span class="lineno"> 1512</span><span class="comment">//============================================================</span></div>
<div class="line"><span class="lineno"> 1513</span><span class="comment">//============== PRINT MatG,lenG,offG TO FILE ================</span></div>
<div class="line"><span class="lineno"> 1514</span> </div>
<div class="line"><span class="lineno"> 1515</span>                XDMFWriter::PrintOneVarMatrixHDF5(name.str(),groupname_lev.str(),n_dofs_lev_fe,countG[r][c],MatG[r][c],lenG[r][c],lenoffG[r][c],r,c,FELevel);</div>
<div class="line"><span class="lineno"> 1516</span> </div>
<div class="line"><span class="lineno"> 1517</span><span class="comment">//============================================================</span></div>
<div class="line"><span class="lineno"> 1518</span><span class="comment">//============ DELETE THE CURRENT c ==========================</span></div>
<div class="line"><span class="lineno"> 1519</span> </div>
<div class="line"><span class="lineno"> 1520</span>                <span class="keyword">delete</span> [] aux;             <span class="comment">//valgrind wants the []</span></div>
<div class="line"><span class="lineno"> 1521</span>                <span class="keyword">delete</span> [] lenoffG[r][c];   <span class="comment">//valgrind wants the []</span></div>
<div class="line"><span class="lineno"> 1522</span>                <span class="keyword">delete</span> [] lenG[r][c];      <span class="comment">//valgrind wants the []</span></div>
<div class="line"><span class="lineno"> 1523</span> </div>
<div class="line"><span class="lineno"> 1524</span> </div>
<div class="line"><span class="lineno"> 1525</span>            }  <span class="comment">//*********************************</span></div>
<div class="line"><span class="lineno"> 1526</span>            <span class="comment">//*************** end c *************</span></div>
<div class="line"><span class="lineno"> 1527</span>            <span class="comment">//*********************************</span></div>
<div class="line"><span class="lineno"> 1528</span> </div>
<div class="line"><span class="lineno"> 1529</span><span class="comment">//============================================================</span></div>
<div class="line"><span class="lineno"> 1530</span><span class="comment">//============ DELETE THE CURRENT r ==========================</span></div>
<div class="line"><span class="lineno"> 1531</span>            <span class="keyword">delete</span> [] lenG[r];</div>
<div class="line"><span class="lineno"> 1532</span>            <span class="keyword">delete</span> [] lenoffG[r];</div>
<div class="line"><span class="lineno"> 1533</span>            <span class="keyword">delete</span> [] countG[r];</div>
<div class="line"><span class="lineno"> 1534</span>            <span class="keyword">delete</span> [] countoffG[r];</div>
<div class="line"><span class="lineno"> 1535</span> </div>
<div class="line"><span class="lineno"> 1536</span>        }   <span class="comment">//**********************************</span></div>
<div class="line"><span class="lineno"> 1537</span>        <span class="comment">//************** end r ***************</span></div>
<div class="line"><span class="lineno"> 1538</span>        <span class="comment">//**********************************</span></div>
<div class="line"><span class="lineno"> 1539</span> </div>
<div class="line"><span class="lineno"> 1540</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)   <span class="keyword">delete</span> [] dof_extreme_at_lev_sd[fe];</div>
<div class="line"><span class="lineno"> 1541</span> </div>
<div class="line"><span class="lineno"> 1542</span>        <span class="keyword">delete</span> [] dof_extreme_at_lev_sd;</div>
<div class="line"><span class="lineno"> 1543</span> </div>
<div class="line"><span class="lineno"> 1544</span> </div>
<div class="line"><span class="lineno"> 1545</span>        <span class="keyword">delete</span> [] countG;</div>
<div class="line"><span class="lineno"> 1546</span>        <span class="keyword">delete</span> [] countoffG;</div>
<div class="line"><span class="lineno"> 1547</span> </div>
<div class="line"><span class="lineno"> 1548</span> </div>
<div class="line"><span class="lineno"> 1549</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;r++) {</div>
<div class="line"><span class="lineno"> 1550</span> </div>
<div class="line"><span class="lineno"> 1551</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0; c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) {</div>
<div class="line"><span class="lineno"> 1552</span>                <span class="keyword">delete</span> [] memG[r][c];</div>
<div class="line"><span class="lineno"> 1553</span>                <span class="keyword">delete</span> [] MatG[r][c];</div>
<div class="line"><span class="lineno"> 1554</span>            }</div>
<div class="line"><span class="lineno"> 1555</span> </div>
<div class="line"><span class="lineno"> 1556</span>            <span class="keyword">delete</span> [] MatG[r]  ;</div>
<div class="line"><span class="lineno"> 1557</span>            <span class="keyword">delete</span> [] memG[r]  ;</div>
<div class="line"><span class="lineno"> 1558</span> </div>
<div class="line"><span class="lineno"> 1559</span>        }</div>
<div class="line"><span class="lineno"> 1560</span> </div>
<div class="line"><span class="lineno"> 1561</span>        <span class="keyword">delete</span> [] MatG       ;</div>
<div class="line"><span class="lineno"> 1562</span>        <span class="keyword">delete</span> [] memG       ;</div>
<div class="line"><span class="lineno"> 1563</span> </div>
<div class="line"><span class="lineno"> 1564</span>        <span class="keyword">delete</span> [] lenG       ;</div>
<div class="line"><span class="lineno"> 1565</span>        <span class="keyword">delete</span> [] lenoffG    ;</div>
<div class="line"><span class="lineno"> 1566</span> </div>
<div class="line"><span class="lineno"> 1567</span>    H5Gclose(group);</div>
<div class="line"><span class="lineno"> 1568</span> </div>
<div class="line"><span class="lineno"> 1569</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno"> 1570</span>        std::clock_t end_time=std::clock();</div>
<div class="line"><span class="lineno"> 1571</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; Reference level = &quot;</span> &lt;&lt;  Level1 &lt;&lt; <span class="stringliteral">&quot; Matrix compute time =&quot;</span>&lt;&lt; double(end_time- <a class="code hl_variable" href="_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a>) / CLOCKS_PER_SEC &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1572</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1573</span> </div>
<div class="line"><span class="lineno"> 1574</span>    }</div>
<div class="line"><span class="lineno"> 1575</span> </div>
<div class="line"><span class="lineno"> 1576</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno"> 1577</span><span class="comment">//================= END LEVEL LOOP =============================</span></div>
<div class="line"><span class="lineno"> 1578</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span><span class="comment">// CLOSE THE FILE ============================</span></div>
<div class="line"><span class="lineno"> 1581</span>      H5Fclose(file);</div>
<div class="line"><span class="lineno"> 1582</span> </div>
<div class="line"><span class="lineno"> 1583</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno"> 1584</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; GenCase::compute_and_print_MGOps: compute_matrix end \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1585</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1586</span> </div>
<div class="line"><span class="lineno"> 1587</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1588</span>}</div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a></div><div class="ttdeci">@ LL</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a></div><div class="ttdeci">@ QQ</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a></div><div class="ttdeci">@ KK</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_a38b4725eb3b423ebb1fe835d244bb3e6"><div class="ttname"><a href="_femus_default_8hpp.html#a38b4725eb3b423ebb1fe835d244bb3e6">DEFAULT_F_MATRIX</a></div><div class="ttdeci">#define DEFAULT_F_MATRIX</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00023">FemusDefault.hpp:23</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_a88cc18ae6f1376162580864906e9fcef"><div class="ttname"><a href="_femus_default_8hpp.html#a88cc18ae6f1376162580864906e9fcef">DEFAULT_EXT_H5</a></div><div class="ttdeci">#define DEFAULT_EXT_H5</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00013">FemusDefault.hpp:13</a></div></div>
<div class="ttc" id="a_l_e__zlevel__poster_8cpp_html_affc511ee6672968dd4a00f341600ed36"><div class="ttname"><a href="_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a></div><div class="ttdeci">clock_t start_time</div><div class="ttdef"><b>Definition</b> <a href="_l_e__zlevel__poster_8cpp_source.html#l00043">LE_zlevel_poster.cpp:43</a></div></div>
<div class="ttc" id="a_typedefs_8hpp_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition</b> <a href="_typedefs_8hpp_source.html#l00005">Typedefs.hpp:5</a></div></div>
<div class="ttc" id="a_v_b_type_enum_8hpp_html_a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e"><div class="ttname"><a href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a></div><div class="ttdeci">@ VV</div><div class="ttdef"><b>Definition</b> <a href="_v_b_type_enum_8hpp_source.html#l00004">VBTypeEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_base_html_a9d853484dcf998f1e3e1b2374e8c3b61"><div class="ttname"><a href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">femus::ElemStoBase::_elnds</a></div><div class="ttdeci">int * _elnds</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00041">ElemSto.hpp:41</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a15a91978c93fe07eff517d90075301e5"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">femus::MultiLevelMeshTwo::_el_sto</a></div><div class="ttdeci">ElemStoVol ** _el_sto</div><div class="ttdoc">[LEV][IELEM] //for every level, it gives you the father</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00089">MultiLevelMeshTwo.hpp:89</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a2431608d37cb7fbe406de970b6b71788"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">femus::MultiLevelMeshTwo::_n_elements_vb_lev</a></div><div class="ttdeci">uint ** _n_elements_vb_lev</div><div class="ttdoc">[DIM]</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00081">MultiLevelMeshTwo.hpp:81</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a345e33af17ea0c184dbf07285bb17d31"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">femus::MultiLevelMeshTwo::_NoSubdom</a></div><div class="ttdeci">uint _NoSubdom</div><div class="ttdoc">current subdomain</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00068">MultiLevelMeshTwo.hpp:68</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a36e0eff2f50cb30f84ce331345108988"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">femus::MultiLevelMeshTwo::_maxelxnode</a></div><div class="ttdeci">int _maxelxnode</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00105">MultiLevelMeshTwo.hpp:105</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a5c4d7084bf63a5fd8b3ee38ec667dd79"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">femus::MultiLevelMeshTwo::_nd_libm_fm</a></div><div class="ttdeci">std::vector&lt; int &gt; _nd_libm_fm</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00124">MultiLevelMeshTwo.hpp:124</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a68f3f358a51963417fbaeb9255d2c2c3"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">femus::MultiLevelMeshTwo::_NoLevels</a></div><div class="ttdeci">uint _NoLevels</div><div class="ttdoc">Number of subdomains (subdomain P)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00071">MultiLevelMeshTwo.hpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a7508c00c363175fd124c4fec42e0637c"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">femus::MultiLevelMeshTwo::_off_el</a></div><div class="ttdeci">int ** _off_el</div><div class="ttdoc">[VB][L] Number of Elements</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00082">MultiLevelMeshTwo.hpp:82</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a7da44ed973c45cc98c53369b60d61a5a"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">femus::MultiLevelMeshTwo::_elnodes</a></div><div class="ttdeci">uint _elnodes[VB][QL]</div><div class="ttdoc">[VB] //just for check</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00075">MultiLevelMeshTwo.hpp:75</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_ab974278587f62066f8747ed734f438c7"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">femus::MultiLevelMeshTwo::_NoNodesXLev</a></div><div class="ttdeci">uint * _NoNodesXLev</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00094">MultiLevelMeshTwo.hpp:94</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_accd4caec1f81d3dfad0f1c69dd87b467"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">femus::MultiLevelMeshTwo::_Qnode_fine_Qnode_lev</a></div><div class="ttdeci">int ** _Qnode_fine_Qnode_lev</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00096">MultiLevelMeshTwo.hpp:96</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_ad212108f2e50d25b0ccdb3202a1fa130"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">femus::MultiLevelMeshTwo::_off_nd</a></div><div class="ttdeci">int ** _off_nd</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00097">MultiLevelMeshTwo.hpp:97</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7638dda7e28540362e134cd783ac2826" name="a7638dda7e28540362e134cd783ac2826"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7638dda7e28540362e134cd783ac2826">&#9670;&#160;</a></span>ComputeAndPrintMGOperators()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ComputeAndPrintMGOperators </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00628">628</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  628</span>                                                                    {</div>
<div class="line"><span class="lineno">  629</span> </div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a> == 0)   {  <span class="comment">//serial function</span></div>
<div class="line"><span class="lineno">  631</span>      </div>
<div class="line"><span class="lineno">  632</span>            <span class="comment">//this involves only VOLUME STUFF, no boundary stuff</span></div>
<div class="line"><span class="lineno">  633</span>            <span class="comment">// instead, not only NODES but also ELEMENTS are used</span></div>
<div class="line"><span class="lineno">  634</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#af03fdb695fdbdd9328ab53c28e57b796">ComputeAndPrintMatrix</a>(output_path); </div>
<div class="line"><span class="lineno">  635</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#acf6276fa8c123a0911b1cde3975b01e1">ComputeAndPrintProl</a>(output_path); </div>
<div class="line"><span class="lineno">  636</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a35cd2513d9f9a0ca6d8ce50e71f34e7c">ComputeAndPrintRest</a>(output_path);</div>
<div class="line"><span class="lineno">  637</span> </div>
<div class="line"><span class="lineno">  638</span>    } <span class="comment">//end proc==0</span></div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  641</span>}</div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a35cd2513d9f9a0ca6d8ce50e71f34e7c"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a35cd2513d9f9a0ca6d8ce50e71f34e7c">femus::GenCase::ComputeAndPrintRest</a></div><div class="ttdeci">void ComputeAndPrintRest(const std::string output_path)</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l01635">GenCase.cpp:1635</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_acf6276fa8c123a0911b1cde3975b01e1"><div class="ttname"><a href="classfemus_1_1_gen_case.html#acf6276fa8c123a0911b1cde3975b01e1">femus::GenCase::ComputeAndPrintProl</a></div><div class="ttdeci">void ComputeAndPrintProl(const std::string output_path)</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00715">GenCase.cpp:715</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_af03fdb695fdbdd9328ab53c28e57b796"><div class="ttname"><a href="classfemus_1_1_gen_case.html#af03fdb695fdbdd9328ab53c28e57b796">femus::GenCase::ComputeAndPrintMatrix</a></div><div class="ttdeci">void ComputeAndPrintMatrix(const std::string output_path)</div><div class="ttdoc">This function computes the sparse matrix pattern.</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l01298">GenCase.cpp:1298</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a2073adff4b7add5f6d88efa9d725bb35"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">femus::MultiLevelMeshTwo::_iproc</a></div><div class="ttdeci">uint _iproc</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00067">MultiLevelMeshTwo.hpp:67</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="acf6276fa8c123a0911b1cde3975b01e1" name="acf6276fa8c123a0911b1cde3975b01e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acf6276fa8c123a0911b1cde3975b01e1">&#9670;&#160;</a></span>ComputeAndPrintProl()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ComputeAndPrintProl </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00715">715</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  715</span>                                                              {</div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span>  <span class="keywordtype">int</span> NegativeOneFlag = -1;</div>
<div class="line"><span class="lineno">  718</span>  <span class="keywordtype">double</span>   PseudoZero = 1.e-8;</div>
<div class="line"><span class="lineno">  719</span>  </div>
<div class="line"><span class="lineno">  720</span>    std::string f_prol    = <a class="code hl_define" href="_femus_default_8hpp.html#a2246e654bedf09d71456edd5ac222a0f">DEFAULT_F_PROL</a>;</div>
<div class="line"><span class="lineno">  721</span>    std::string ext_h5    = <a class="code hl_define" href="_femus_default_8hpp.html#a88cc18ae6f1376162580864906e9fcef">DEFAULT_EXT_H5</a>;</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span>    std::ostringstream name;</div>
<div class="line"><span class="lineno">  724</span>    name &lt;&lt; output_path &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; f_prol &lt;&lt; ext_h5;</div>
<div class="line"><span class="lineno">  725</span>    hid_t file = H5Fcreate(name.str().c_str(), H5F_ACC_TRUNC, H5P_DEFAULT,H5P_DEFAULT);</div>
<div class="line"><span class="lineno">  726</span> </div>
<div class="line"><span class="lineno">  727</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Level1 = 1; Level1 &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>; Level1++) {  <span class="comment">//Level1 is the OUTPUT level (fine level) (the level of the ROWS)</span></div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordtype">int</span> Lev_c = Level1 - 1;</div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordtype">int</span> Lev_f = Level1;</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>    std::ostringstream groupname_lev; groupname_lev &lt;&lt;  <span class="stringliteral">&quot;LEVEL&quot;</span> &lt;&lt; Lev_c &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; Lev_f;</div>
<div class="line"><span class="lineno">  733</span>    hid_t group = H5Gcreate(file, groupname_lev.str().c_str(), H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT);</div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span><span class="comment">//These FElevels return EXTENDED levels, to be used in the _Qnode_fine_Qnode_lev map</span></div>
<div class="line"><span class="lineno">  736</span>        <span class="keywordtype">int</span> FEXLevel_c[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  737</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Lev_c; </div>
<div class="line"><span class="lineno">  738</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = (Level1-1+<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>)%(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+1);</div>
<div class="line"><span class="lineno">  739</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Lev_c;       </div>
<div class="line"><span class="lineno">  740</span>        <span class="keywordtype">int</span> FEXLevel_f[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  741</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level1;     </div>
<div class="line"><span class="lineno">  742</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = Level1-1;                                <span class="comment">// AAA look at the symmetry, this is exactly (_n_levels + Level1 + 1)%(_n_levels + 1); ! //FINE Level for LINEAR:   Level1=0 means coarse linear, a finer linear is the first coarse quadratic, and so on and so on</span></div>
<div class="line"><span class="lineno">  743</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Lev_f;   </div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>** n_dofs_fe_lev;</div>
<div class="line"><span class="lineno">  746</span>        n_dofs_fe_lev = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  747</span>        n_dofs_fe_lev[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>;            <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno">  748</span>        n_dofs_fe_lev[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>;            <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno">  749</span>        n_dofs_fe_lev[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];  <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno">  750</span> </div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>      <span class="keywordtype">int</span> **     Prol_pos = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  753</span>      <span class="keywordtype">double</span> **  Prol_val = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  754</span>      <span class="keywordtype">int</span> **          len = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  755</span>      <span class="keywordtype">int</span> **       lenoff = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  756</span>      <span class="keywordtype">int</span>    count[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  757</span>      <span class="keywordtype">int</span> countoff[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  758</span>     </div>
<div class="line"><span class="lineno">  759</span>       </div>
<div class="line"><span class="lineno">  760</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno">  761</span>               len[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span> [n_dofs_fe_lev[fe][FEXLevel_f[fe]]+1];</div>
<div class="line"><span class="lineno">  762</span>            lenoff[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span> [n_dofs_fe_lev[fe][FEXLevel_f[fe]]+1];</div>
<div class="line"><span class="lineno">  763</span>             count[fe] = 0;</div>
<div class="line"><span class="lineno">  764</span>          countoff[fe] = 0;</div>
<div class="line"><span class="lineno">  765</span>               len[fe][0] = 0;</div>
<div class="line"><span class="lineno">  766</span>            lenoff[fe][0] = 0;      </div>
<div class="line"><span class="lineno">  767</span>          }     </div>
<div class="line"><span class="lineno">  768</span>        </div>
<div class="line"><span class="lineno">  769</span>          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno">  770</span>          <span class="keywordtype">int</span> dim_large = n_dofs_fe_lev[fe][FEXLevel_f[fe]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe];  <span class="comment">//TODO the length of this array depends on HOW you EXPLORE things:</span></div>
<div class="line"><span class="lineno">  771</span>                                                                                    <span class="comment">//here for every node we loop over its father nodes, so here&#39;s why</span></div>
<div class="line"><span class="lineno">  772</span>                                                                                    <span class="comment">// in the RESTRICTOR the way of exploring is different</span></div>
<div class="line"><span class="lineno">  773</span>                                                                                    <span class="comment">//actually I think that for the elements you don&#39;t need the -1, you can make it compact from the beginning...</span></div>
<div class="line"><span class="lineno">  774</span>                                                                                    <span class="comment">//for the elements I could just allocate the exact number, because every fine element is influenced by only one coarse element</span></div>
<div class="line"><span class="lineno">  775</span>                                                                                    <span class="comment">//so far I will keep the same scheme</span></div>
<div class="line"><span class="lineno">  776</span>            Prol_pos[fe] = <span class="keyword">new</span>    <span class="keywordtype">int</span> [ dim_large ];</div>
<div class="line"><span class="lineno">  777</span>            Prol_val[fe] = <span class="keyword">new</span> <span class="keywordtype">double</span> [ dim_large ];</div>
<div class="line"><span class="lineno">  778</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i &lt; dim_large; i++) {</div>
<div class="line"><span class="lineno">  779</span>                Prol_pos[fe][i] = NegativeOneFlag;</div>
<div class="line"><span class="lineno">  780</span>                Prol_val[fe][i] =  0.;</div>
<div class="line"><span class="lineno">  781</span>            }    </div>
<div class="line"><span class="lineno">  782</span>        }</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>        <span class="comment">// Prolongation Operator</span></div>
<div class="line"><span class="lineno">  785</span>        <span class="comment">// For any FINE ELEMENT, find its own FATHER, then find WHAT CHILD our element is</span></div>
<div class="line"><span class="lineno">  786</span>        <span class="comment">// Then loop over the child nodes</span></div>
<div class="line"><span class="lineno">  787</span>        <span class="comment">//For any child node, loop over the SURROUNDING FATHER NODES</span></div>
<div class="line"><span class="lineno">  788</span>        <span class="comment">// basically for every FINE DOF you have to find all the RELATED COARSE DOFS</span></div>
<div class="line"><span class="lineno">  789</span>        <span class="comment">//for the element the related coarse dof is just the FATHER!</span></div>
<div class="line"><span class="lineno">  790</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pr=0; pr&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>; pr++) {</div>
<div class="line"><span class="lineno">  791</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f]; iel&lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f+1]; iel++) {</div>
<div class="line"><span class="lineno">  792</span>                <span class="keywordtype">int</span> el_lib = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>[iel].second;</div>
<div class="line"><span class="lineno">  793</span>                <span class="keywordtype">int</span> par_el = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_lib]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#a452494c41098efc1170394e89c1ce8a8">_par</a>;</div>
<div class="line"><span class="lineno">  794</span>                <span class="keywordtype">int</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a406be6ce6b0a2c4a450108496228bd6d">ch</a>=0;</div>
<div class="line"><span class="lineno">  795</span>                <span class="keywordtype">int</span> ch_id=0;</div>
<div class="line"><span class="lineno">  796</span>                <span class="keywordflow">while</span> (el_lib != <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[par_el]-&gt;_elchs[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a406be6ce6b0a2c4a450108496228bd6d">ch</a>]) ch_id=++<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a406be6ce6b0a2c4a450108496228bd6d">ch</a>;</div>
<div class="line"><span class="lineno">  797</span> </div>
<div class="line"><span class="lineno">  798</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno">  799</span>        <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {</div>
<div class="line"><span class="lineno">  800</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> node_of_child_elem=0; node_of_child_elem &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]; node_of_child_elem++) {</div>
<div class="line"><span class="lineno">  801</span>                    <span class="keywordtype">int</span> el_n = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>[ <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_lib]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[node_of_child_elem] ];</div>
<div class="line"><span class="lineno">  802</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> node_of_par_elem=0;node_of_par_elem &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]; node_of_par_elem++) {</div>
<div class="line"><span class="lineno">  803</span>                        <span class="keywordtype">int</span> par_n = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>[ <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[par_el]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[node_of_par_elem] ];</div>
<div class="line"><span class="lineno">  804</span>              <span class="keywordtype">int</span> mypp_node = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[ FEXLevel_f[fe] ][el_n]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]+node_of_par_elem;</div>
<div class="line"><span class="lineno">  805</span>                        Prol_pos[fe][ mypp_node ] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[ FEXLevel_c[fe] ][par_n];</div>
<div class="line"><span class="lineno">  806</span>                        Prol_val[fe][ mypp_node ] = <a class="code hl_variable" href="classfemus_1_1_gen_case.html#a17c27a66dbb43c45aacf26cc204e6892">_feelems</a>[fe]-&gt;get_embedding_matrix(ch_id, node_of_child_elem, node_of_par_elem);</div>
<div class="line"><span class="lineno">  807</span>                    }</div>
<div class="line"><span class="lineno">  808</span>                }</div>
<div class="line"><span class="lineno">  809</span>         }</div>
<div class="line"><span class="lineno">  810</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  {</div>
<div class="line"><span class="lineno">  811</span>          <span class="keywordtype">int</span> sum_previous_sd=0;      <span class="comment">//sum of the dofs AT THAT LEVEL coming from the PREVIOUSLY CONSIDERED SUBDOMAINS</span></div>
<div class="line"><span class="lineno">  812</span>                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sd=0;sd&lt;pr;sd++) sum_previous_sd += <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][ sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f+1 ] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][ sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_f ];</div>
<div class="line"><span class="lineno">  813</span>                        <span class="keywordtype">int</span>  dof_r = iel - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_f] + sum_previous_sd;</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span>           <span class="comment">//what is the number in femus indexing of the parent element? par_el is in libmesh indexing!</span></div>
<div class="line"><span class="lineno">  816</span>          <span class="keywordtype">int</span> iel_femus_c = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a6abbf958a300ffd816c2bc7b42652320">_el_libm_fm</a>[par_el];</div>
<div class="line"><span class="lineno">  817</span>          <span class="keywordtype">int</span> sum_previous_sd_coarse = 0;</div>
<div class="line"><span class="lineno">  818</span>                   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sd=0;sd&lt;pr;sd++) sum_previous_sd_coarse += <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][ sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c+1 ] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][ sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_c ];</div>
<div class="line"><span class="lineno">  819</span>                        <span class="keywordtype">int</span>  dof_c = iel_femus_c - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_c] + sum_previous_sd_coarse;</div>
<div class="line"><span class="lineno">  820</span>          </div>
<div class="line"><span class="lineno">  821</span>          Prol_pos[fe][ dof_r ] = dof_c;</div>
<div class="line"><span class="lineno">  822</span>          Prol_val[fe][ dof_r ] = 1;</div>
<div class="line"><span class="lineno">  823</span>        }</div>
<div class="line"><span class="lineno">  824</span>        </div>
<div class="line"><span class="lineno">  825</span>        }  <span class="comment">//end fe</span></div>
<div class="line"><span class="lineno">  826</span>          } <span class="comment">//iel</span></div>
<div class="line"><span class="lineno">  827</span>        }  <span class="comment">//subd</span></div>
<div class="line"><span class="lineno">  828</span>        </div>
<div class="line"><span class="lineno">  829</span>        <span class="comment">//========== COMPRESSION ================</span></div>
<div class="line"><span class="lineno">  830</span>        <span class="comment">//this is needed in order to know what is in-diagonal and what is off-diagonal in the columns.</span></div>
<div class="line"><span class="lineno">  831</span>        <span class="comment">//therefore, columns = coarse level</span></div>
<div class="line"><span class="lineno">  832</span>        <span class="keywordtype">int</span> **dof_extreme_at_coarse_lev_sd = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno">  833</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) {</div>
<div class="line"><span class="lineno">  834</span>            dof_extreme_at_coarse_lev_sd[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>+1];</div>
<div class="line"><span class="lineno">  835</span>            dof_extreme_at_coarse_lev_sd[fe][0] = 0;</div>
<div class="line"><span class="lineno">  836</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idom=0;idom&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>;idom++){</div>
<div class="line"><span class="lineno">  837</span>               <span class="keywordflow">if</span> (fe  &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  dof_extreme_at_coarse_lev_sd[fe][idom+1] =  dof_extreme_at_coarse_lev_sd[fe][idom] + ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>]); </div>
<div class="line"><span class="lineno">  838</span>              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  dof_extreme_at_coarse_lev_sd[fe][idom+1] =  dof_extreme_at_coarse_lev_sd[fe][idom] + ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c]);</div>
<div class="line"><span class="lineno">  839</span>             }</div>
<div class="line"><span class="lineno">  840</span>        }        </div>
<div class="line"><span class="lineno">  841</span> </div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) {</div>
<div class="line"><span class="lineno">  844</span>      </div>
<div class="line"><span class="lineno">  845</span>        <span class="keywordtype">int</span> ki=0;</div>
<div class="line"><span class="lineno">  846</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kdom=0;kdom &lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>; kdom++) {</div>
<div class="line"><span class="lineno">  847</span>                    <span class="keywordtype">int</span> delta_dof_at_fine_lev_sd;</div>
<div class="line"><span class="lineno">  848</span>                    <span class="keywordflow">if</span>       (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  delta_dof_at_fine_lev_sd = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>];</div>
<div class="line"><span class="lineno">  849</span>                    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  delta_dof_at_fine_lev_sd = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_f];</div>
<div class="line"><span class="lineno">  850</span>  </div>
<div class="line"><span class="lineno">  851</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iki = 0; iki &lt; delta_dof_at_fine_lev_sd; iki++) {</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>                <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> kj=0;kj &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]; kj++) {</div>
<div class="line"><span class="lineno">  854</span>                    <span class="keywordtype">int</span> kk= <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*ki+kj;</div>
<div class="line"><span class="lineno">  855</span>                    <span class="keywordflow">if</span> (fabs(Prol_val[fe][kk])&gt; PseudoZero) {</div>
<div class="line"><span class="lineno">  856</span>                        Prol_pos[fe][ count[fe] ] = Prol_pos[fe][kk];</div>
<div class="line"><span class="lineno">  857</span>                        Prol_val[fe][ count[fe] ] = Prol_val[fe][kk];</div>
<div class="line"><span class="lineno">  858</span>                        count[fe]++;</div>
<div class="line"><span class="lineno">  859</span>                        <span class="keywordflow">if</span> (Prol_pos[fe][kk] &gt;=(<span class="keywordtype">int</span>) dof_extreme_at_coarse_lev_sd[fe][kdom+1] ||</div>
<div class="line"><span class="lineno">  860</span>                Prol_pos[fe][kk] &lt;(int)  dof_extreme_at_coarse_lev_sd[fe][kdom]) countoff[fe]++;</div>
<div class="line"><span class="lineno">  861</span>                    }</div>
<div class="line"><span class="lineno">  862</span>                }</div>
<div class="line"><span class="lineno">  863</span>                   len[fe][ki+1] = count[fe];</div>
<div class="line"><span class="lineno">  864</span>                lenoff[fe][ki+1] = countoff[fe];</div>
<div class="line"><span class="lineno">  865</span>                ki++;</div>
<div class="line"><span class="lineno">  866</span>            }</div>
<div class="line"><span class="lineno">  867</span>        }</div>
<div class="line"><span class="lineno">  868</span>            XDMFWriter::PrintOneVarMGOperatorHDF5(name.str(),groupname_lev.str(),n_dofs_fe_lev[fe],count[fe],Prol_pos[fe],Prol_val[fe],len[fe],lenoff[fe],FEXLevel_f[fe],FEXLevel_c[fe],fe);</div>
<div class="line"><span class="lineno">  869</span> </div>
<div class="line"><span class="lineno">  870</span>          <span class="keyword">delete</span> []  dof_extreme_at_coarse_lev_sd[fe];</div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span>    } <span class="comment">//end fe</span></div>
<div class="line"><span class="lineno">  873</span> </div>
<div class="line"><span class="lineno">  874</span><span class="comment">//=======================================</span></div>
<div class="line"><span class="lineno">  875</span> </div>
<div class="line"><span class="lineno">  876</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno">  877</span>       <span class="keyword">delete</span> [] Prol_pos[fe];</div>
<div class="line"><span class="lineno">  878</span>       <span class="keyword">delete</span> [] Prol_val[fe];</div>
<div class="line"><span class="lineno">  879</span>       <span class="keyword">delete</span> [] len[fe];</div>
<div class="line"><span class="lineno">  880</span>       <span class="keyword">delete</span> [] lenoff[fe];</div>
<div class="line"><span class="lineno">  881</span>     }</div>
<div class="line"><span class="lineno">  882</span>     <span class="keyword">delete</span> [] Prol_pos;</div>
<div class="line"><span class="lineno">  883</span>     <span class="keyword">delete</span> [] Prol_val;</div>
<div class="line"><span class="lineno">  884</span>     <span class="keyword">delete</span> [] len;</div>
<div class="line"><span class="lineno">  885</span>     <span class="keyword">delete</span> [] lenoff;</div>
<div class="line"><span class="lineno">  886</span>     <span class="keyword">delete</span> []  dof_extreme_at_coarse_lev_sd;</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>     H5Gclose(group);</div>
<div class="line"><span class="lineno">  889</span>   </div>
<div class="line"><span class="lineno">  890</span>    }</div>
<div class="line"><span class="lineno">  891</span>    <span class="comment">//end Level1</span></div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>    H5Fclose(file);</div>
<div class="line"><span class="lineno">  894</span> </div>
<div class="line"><span class="lineno">  895</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno">  896</span>    std::cout&lt;&lt; <span class="stringliteral">&quot; GenCase::compute_and_print_MGOps: compute_prol end  \n&quot;</span>;</div>
<div class="line"><span class="lineno">  897</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  898</span> </div>
<div class="line"><span class="lineno">  899</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  900</span>}</div>
<div class="ttc" id="a_femus_default_8hpp_html_a2246e654bedf09d71456edd5ac222a0f"><div class="ttname"><a href="_femus_default_8hpp.html#a2246e654bedf09d71456edd5ac222a0f">DEFAULT_F_PROL</a></div><div class="ttdeci">#define DEFAULT_F_PROL</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00024">FemusDefault.hpp:24</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_a406be6ce6b0a2c4a450108496228bd6d"><div class="ttname"><a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a406be6ce6b0a2c4a450108496228bd6d">ch</a></div><div class="ttdeci">ch</div><div class="ttdef"><b>Definition</b> <a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00017">MG_precond.m:17</a></div></div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_vol_html_a452494c41098efc1170394e89c1ce8a8"><div class="ttname"><a href="classfemus_1_1_elem_sto_vol.html#a452494c41098efc1170394e89c1ce8a8">femus::ElemStoVol::_par</a></div><div class="ttdeci">int _par</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00057">ElemSto.hpp:57</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a6abbf958a300ffd816c2bc7b42652320"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a6abbf958a300ffd816c2bc7b42652320">femus::MultiLevelMeshTwo::_el_libm_fm</a></div><div class="ttdeci">std::vector&lt; int &gt; _el_libm_fm</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00125">MultiLevelMeshTwo.hpp:125</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35cd2513d9f9a0ca6d8ce50e71f34e7c" name="a35cd2513d9f9a0ca6d8ce50e71f34e7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35cd2513d9f9a0ca6d8ce50e71f34e7c">&#9670;&#160;</a></span>ComputeAndPrintRest()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ComputeAndPrintRest </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>_elnodes[VV][fe]</p>
<p>_elnodes[VV][fe]</p>
<p>_elnodes[VV][fe]</p>

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l01635">1635</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1635</span>                                                             {</div>
<div class="line"><span class="lineno"> 1636</span> </div>
<div class="line"><span class="lineno"> 1637</span>  <span class="keywordtype">int</span> NegativeOneFlag = -1;</div>
<div class="line"><span class="lineno"> 1638</span>  <span class="keywordtype">double</span>   PseudoZero = 1.e-8;</div>
<div class="line"><span class="lineno"> 1639</span>  </div>
<div class="line"><span class="lineno"> 1640</span>        std::string f_rest    = <a class="code hl_define" href="_femus_default_8hpp.html#afabe91b16d34f7c1759f0a383a2e9cc2">DEFAULT_F_REST</a>;</div>
<div class="line"><span class="lineno"> 1641</span>        std::string ext_h5    = <a class="code hl_define" href="_femus_default_8hpp.html#a88cc18ae6f1376162580864906e9fcef">DEFAULT_EXT_H5</a>;</div>
<div class="line"><span class="lineno"> 1642</span> </div>
<div class="line"><span class="lineno"> 1643</span>        std::ostringstream filename;</div>
<div class="line"><span class="lineno"> 1644</span>        filename &lt;&lt; output_path &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; f_rest &lt;&lt; ext_h5;</div>
<div class="line"><span class="lineno"> 1645</span>        hid_t file = H5Fcreate(filename.str().c_str(), H5F_ACC_TRUNC, H5P_DEFAULT,H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 1646</span> </div>
<div class="line"><span class="lineno"> 1647</span>  </div>
<div class="line"><span class="lineno"> 1648</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> Level1 = 0; Level1 &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>-1; Level1++) {  <span class="comment">//Level1 is the COARSE level (OUTPUT level)</span></div>
<div class="line"><span class="lineno"> 1649</span> </div>
<div class="line"><span class="lineno"> 1650</span>        <span class="keywordtype">int</span> Lev_c = Level1;</div>
<div class="line"><span class="lineno"> 1651</span>        <span class="keywordtype">int</span> Lev_f = Level1+1;</div>
<div class="line"><span class="lineno"> 1652</span>    </div>
<div class="line"><span class="lineno"> 1653</span>    std::ostringstream groupname_lev; groupname_lev &lt;&lt;  <span class="stringliteral">&quot;LEVEL&quot;</span> &lt;&lt; Lev_f &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; Lev_c;</div>
<div class="line"><span class="lineno"> 1654</span>    hid_t group = H5Gcreate(file, groupname_lev.str().c_str(), H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 1655</span> </div>
<div class="line"><span class="lineno"> 1656</span>        <span class="keywordtype">int</span> FEXLevel_c[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1657</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level1;                                 <span class="comment">//COARSE Level for QUADRATIC</span></div>
<div class="line"><span class="lineno"> 1658</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Level1)%(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + 1);   <span class="comment">//COARSE Level for LINEAR: Level1=0 means coarse linear, a finer linear is the first coarse quadratic, and so on and so on</span></div>
<div class="line"><span class="lineno"> 1659</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level1;                                 <span class="comment">//COARSE Level for CONSTANT</span></div>
<div class="line"><span class="lineno"> 1660</span>        <span class="keywordtype">int</span> FEXLevel_f[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1661</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level1+1;                                  <span class="comment">//FINE Level for QUADRATIC</span></div>
<div class="line"><span class="lineno"> 1662</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = Level1;                                <span class="comment">// AAA look at the symmetry, this is exactly (_n_levels + Level1 + 1)%(_n_levels + 1); ! //FINE Level for LINEAR:   Level1=0 means coarse linear, a finer linear is the first coarse quadratic, and so on and so on</span></div>
<div class="line"><span class="lineno"> 1663</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level1+1;                                  <span class="comment">//FINE Level for CONSTANT</span></div>
<div class="line"><span class="lineno"> 1664</span> </div>
<div class="line"><span class="lineno"> 1665</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>** n_dofs_fe_lev;</div>
<div class="line"><span class="lineno"> 1666</span>        n_dofs_fe_lev = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1667</span>        n_dofs_fe_lev[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>;            <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno"> 1668</span>        n_dofs_fe_lev[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>;            <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno"> 1669</span>        n_dofs_fe_lev[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];  <span class="comment">//equal the pointers</span></div>
<div class="line"><span class="lineno"> 1670</span> </div>
<div class="line"><span class="lineno"> 1671</span>        <span class="keywordtype">int</span>**     Rest_pos = <span class="keyword">new</span>    <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1672</span>        <span class="keywordtype">double</span>**  Rest_val = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1673</span>        <span class="keywordtype">int</span>**    mult_cols = <span class="keyword">new</span>    <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];   <span class="comment">//here mult_cols counts, for every dof row (coarse row), the number of FINE NODES that INFLUENCE SOME GIVEN COARSE NODE  //it counts only the nonzero&#39;s, doesn&#39;t it? yes</span></div>
<div class="line"><span class="lineno"> 1674</span> </div>
<div class="line"><span class="lineno"> 1675</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 1676</span>        <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  {</div>
<div class="line"><span class="lineno"> 1677</span>            Rest_pos[fe]   = <span class="keyword">new</span>    <span class="keywordtype">int</span> [n_dofs_fe_lev[fe][FEXLevel_c[fe]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>];</div>
<div class="line"><span class="lineno"> 1678</span>            Rest_val[fe]   = <span class="keyword">new</span> <span class="keywordtype">double</span> [n_dofs_fe_lev[fe][FEXLevel_c[fe]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>];</div>
<div class="line"><span class="lineno"> 1679</span>            mult_cols[fe]  = <span class="keyword">new</span>    <span class="keywordtype">int</span> [n_dofs_fe_lev[fe][FEXLevel_c[fe]]];</div>
<div class="line"><span class="lineno"> 1680</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i &lt; n_dofs_fe_lev[fe][FEXLevel_c[fe]]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>; i++) {</div>
<div class="line"><span class="lineno"> 1681</span>                Rest_pos[fe][i] = NegativeOneFlag;</div>
<div class="line"><span class="lineno"> 1682</span>                Rest_val[fe][i] = 0.;</div>
<div class="line"><span class="lineno"> 1683</span>               }</div>
<div class="line"><span class="lineno"> 1684</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im = 0; im &lt; n_dofs_fe_lev[fe][FEXLevel_c[fe]]; im++)     mult_cols[fe][im]=0;</div>
<div class="line"><span class="lineno"> 1685</span> </div>
<div class="line"><span class="lineno"> 1686</span>        }</div>
<div class="line"><span class="lineno"> 1687</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  {  <span class="comment">//you dont need excess of space for L2 elements</span></div>
<div class="line"><span class="lineno"> 1688</span>            Rest_pos[fe]   = <span class="keyword">new</span>    <span class="keywordtype">int</span> [ n_dofs_fe_lev[fe][FEXLevel_c[fe]]*4*(<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1) ]; <span class="comment">//here I have to put the number of childs</span></div>
<div class="line"><span class="lineno"> 1689</span>            Rest_val[fe]   = <span class="keyword">new</span> <span class="keywordtype">double</span> [ n_dofs_fe_lev[fe][FEXLevel_c[fe]]*4*(<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1) ];</div>
<div class="line"><span class="lineno"> 1690</span>            mult_cols[fe]  = <span class="keyword">new</span>    <span class="keywordtype">int</span> [ n_dofs_fe_lev[fe][FEXLevel_c[fe]] ];  <span class="comment">//TODO unused</span></div>
<div class="line"><span class="lineno"> 1691</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i=0; i &lt; n_dofs_fe_lev[fe][FEXLevel_c[fe]]*4*(<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1) ; i++) {</div>
<div class="line"><span class="lineno"> 1692</span>                Rest_pos[fe][i] = NegativeOneFlag;</div>
<div class="line"><span class="lineno"> 1693</span>                Rest_val[fe][i] = 0.;</div>
<div class="line"><span class="lineno"> 1694</span>               }</div>
<div class="line"><span class="lineno"> 1695</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> im = 0; im &lt; n_dofs_fe_lev[fe][FEXLevel_c[fe]]; im++)     mult_cols[fe][im]=0;</div>
<div class="line"><span class="lineno"> 1696</span>        }</div>
<div class="line"><span class="lineno"> 1697</span>        </div>
<div class="line"><span class="lineno"> 1698</span>          }</div>
<div class="line"><span class="lineno"> 1699</span> </div>
<div class="line"><span class="lineno"> 1700</span> </div>
<div class="line"><span class="lineno"> 1701</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> pr=0; pr&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>; pr++) {</div>
<div class="line"><span class="lineno"> 1702</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c]; iel&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c + 1]; iel++) {  <span class="comment">//we are looping over the COARSE ELEMENTS,</span></div>
<div class="line"><span class="lineno"> 1703</span>                <span class="keywordtype">int</span>   el_lib = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>[iel].second;</div>
<div class="line"><span class="lineno"> 1704</span>                <span class="keywordtype">int</span> n_childs = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_lib]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#ae157383dd2c483093c6354fbfc1d0116">_nch</a>;</div>
<div class="line"><span class="lineno"> 1705</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_ch=0; i_ch&lt; n_childs; i_ch++) {</div>
<div class="line"><span class="lineno"> 1706</span>                    <span class="keywordtype">int</span> ch_el = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_lib]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#a4800376b85eeccc97f7c12c5c91a8070">_elchs</a>[i_ch];</div>
<div class="line"><span class="lineno"> 1707</span> </div>
<div class="line"><span class="lineno"> 1708</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 1709</span>                        <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  {</div>
<div class="line"><span class="lineno"> 1710</span>                        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> k_fath=0; k_fath &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]; k_fath++) {</div>
<div class="line"><span class="lineno"> 1711</span> </div>
<div class="line"><span class="lineno"> 1712</span>                            <span class="keywordtype">int</span> op   = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_lib]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[k_fath]]; <span class="comment">//coarse node (for rows)</span></div>
<div class="line"><span class="lineno"> 1713</span>                            <span class="keywordtype">int</span> irow = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[FEXLevel_c[fe]][op]; <span class="comment">//coarse dof (for rows)    //the COARSE DOF determines the ROW</span></div>
<div class="line"><span class="lineno"> 1714</span> </div>
<div class="line"><span class="lineno"> 1715</span>                            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> k_ch = 0; k_ch &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]; k_ch++) {</div>
<div class="line"><span class="lineno"> 1716</span>                                <span class="keywordtype">int</span> ch_op = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[ch_el]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[k_ch]];   <span class="comment">//child node (fine node) (for columns)</span></div>
<div class="line"><span class="lineno"> 1717</span> </div>
<div class="line"><span class="lineno"> 1718</span><span class="preprocessor">#if DEFAULT_REST_SIMPLE == 1</span></div>
<div class="line"><span class="lineno"> 1719</span><span class="comment">//the only contributions from the fine grid to the coarse grid come from the fine nodes which also belong to the coarse grid, very easy.</span></div>
<div class="line"><span class="lineno"> 1720</span>                                <span class="keywordflow">if</span> (ch_op == op) {   <span class="comment">//if the fine dof is also a coarse dof</span></div>
<div class="line"><span class="lineno"> 1721</span>                                    std::cout &lt;&lt; <span class="stringliteral">&quot;=============== SIMPLE RESTRICTOR, CHECK HERE AND IN THE READING =============&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1722</span>                                    Rest_pos[fe][irow*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>] = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[FEXLevel_f[fe]][ch_op];   <span class="comment">//put the fine level</span></div>
<div class="line"><span class="lineno"> 1723</span>                                    Rest_val[fe][irow*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>] = 1.;</div>
<div class="line"><span class="lineno"> 1724</span>                                    mult_cols[fe][irow] += 1;</div>
<div class="line"><span class="lineno"> 1725</span><span class="comment">//How it was before</span></div>
<div class="line"><span class="lineno"> 1726</span><span class="comment">//quadratic simple</span></div>
<div class="line"><span class="lineno"> 1727</span><span class="comment">//                              Rest_val[fe][irow*_elnodes[VV][fe]*max_elnd] = _elnodes[VV][LL]; //TODO: what is this?</span></div>
<div class="line"><span class="lineno"> 1728</span><span class="comment">//                                 mult_cols[fe][irow]==1;                                              //TODO: what is this? double equal?</span></div>
<div class="line"><span class="lineno"> 1729</span><span class="comment">//linear simple</span></div>
<div class="line"><span class="lineno"> 1730</span><span class="comment">//                                 Rest_val[LL][ g_indexL[ FELevel_c[LL] ][op]*_elnodes[VV][/*LL*/QQ]*max_elnd ] = 1.;    //TODO: what is this?</span></div>
<div class="line"><span class="lineno"> 1731</span><span class="comment">//                                mult_cols[LL][ g_indexL[ FELevel_c[LL] ][op]]=_elnodes[VV][LL];                   //TODO: what is this?</span></div>
<div class="line"><span class="lineno"> 1732</span>                                }</div>
<div class="line"><span class="lineno"> 1733</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno"> 1734</span>                                <span class="keywordtype">double</span> val = <a class="code hl_variable" href="classfemus_1_1_gen_case.html#a17c27a66dbb43c45aacf26cc204e6892">_feelems</a>[fe]-&gt;get_embedding_matrix(i_ch,k_ch,k_fath);   <span class="comment">//the value AT THE FINE (CHILD) NODE of the SHAPE FUNCTION of the COARSE (FATHER) NODE</span></div>
<div class="line"><span class="lineno"> 1735</span>                                <span class="keywordflow">if</span> ( fabs(val) &gt; PseudoZero ) {</div>
<div class="line"><span class="lineno"> 1736</span> </div>
<div class="line"><span class="lineno"> 1737</span>                                    <span class="keywordtype">int</span> jcln     = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[FEXLevel_f[fe]][ch_op];  <span class="comment">//put the fine level, because it is the column level</span></div>
<div class="line"><span class="lineno"> 1738</span>                                    <span class="keywordtype">int</span> indx0    = irow*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>;</div>
<div class="line"><span class="lineno"> 1739</span>                                    <span class="keywordtype">int</span> indx_mem = mult_cols[fe][irow];   <span class="comment">//this is to keep track of how many times we picked that COARSE ROW SO FAR</span></div>
<div class="line"><span class="lineno"> 1740</span>                                    <span class="keywordtype">int</span> fine_node_is_set = 0;</div>
<div class="line"><span class="lineno"> 1741</span>                                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ks=0;ks&lt;indx_mem;ks++) <span class="keywordflow">if</span> (Rest_pos[fe][indx0+ks] == jcln) fine_node_is_set=1;</div>
<div class="line"><span class="lineno"> 1742</span> </div>
<div class="line"><span class="lineno"> 1743</span>                                    <span class="keywordflow">if</span> (fine_node_is_set == 0) {  <span class="comment">//if that fine node has not been set in the current row &quot;irow&quot; yet</span></div>
<div class="line"><span class="lineno"> 1744</span>                                        Rest_pos[fe][indx0+indx_mem] = jcln;</div>
<div class="line"><span class="lineno"> 1745</span>                                        Rest_val[fe][indx0+indx_mem] = val;</div>
<div class="line"><span class="lineno"> 1746</span>                                        mult_cols[fe][irow]++;</div>
<div class="line"><span class="lineno"> 1747</span>                                    }</div>
<div class="line"><span class="lineno"> 1748</span>                                }</div>
<div class="line"><span class="lineno"> 1749</span> </div>
<div class="line"><span class="lineno"> 1750</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1751</span> </div>
<div class="line"><span class="lineno"> 1752</span>                            } <span class="comment">//end k_ch</span></div>
<div class="line"><span class="lineno"> 1753</span> </div>
<div class="line"><span class="lineno"> 1754</span>                        }  <span class="comment">//k_fath  //irow changes inside here, so mult_cols[irow] changes inside here, so the maximum value of mult_cols is (range of k_fath) * (range of k_ch) = _elnodes[QQ][VV] * _elnodes[QQ][VV]</span></div>
<div class="line"><span class="lineno"> 1755</span>                        <span class="comment">//no, it is not true!! The maximum value of mult_cols is _elnodes[fe][VV]* _maxelxnode, because that &quot;irow&quot; is picked _maxelxnode times (those are coarse elements), and each of these times</span></div>
<div class="line"><span class="lineno"> 1756</span>                        <span class="comment">//the maximum number of nodes that can influence is _elnodes[fe][VV]</span></div>
<div class="line"><span class="lineno"> 1757</span>                        <span class="comment">//(_elnodes[fe][VV] is here the number of NONZERO EVALUATIONS of the COARSE TEST_ FUNCTION of irow at the FINE NODES belonging to the COARSE ELEMENT that is in the support of irow)</span></div>
<div class="line"><span class="lineno"> 1758</span>                    </div>
<div class="line"><span class="lineno"> 1759</span>              </div>
<div class="line"><span class="lineno"> 1760</span>              </div>
<div class="line"><span class="lineno"> 1761</span>            } <span class="comment">//end temp fe</span></div>
<div class="line"><span class="lineno"> 1762</span>               <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  {</div>
<div class="line"><span class="lineno"> 1763</span>             </div>
<div class="line"><span class="lineno"> 1764</span>             <span class="keywordtype">int</span> sum_previous_sd_c = 0;</div>
<div class="line"><span class="lineno"> 1765</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sd=0;sd&lt;pr;sd++) sum_previous_sd_c += <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_c+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_c];</div>
<div class="line"><span class="lineno"> 1766</span>                            <span class="keywordtype">int</span> dof_pos_c = iel - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_c] + sum_previous_sd_c;</div>
<div class="line"><span class="lineno"> 1767</span>             </div>
<div class="line"><span class="lineno"> 1768</span>             <span class="keywordtype">int</span> el_child_fm = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a6abbf958a300ffd816c2bc7b42652320">_el_libm_fm</a>[ch_el];</div>
<div class="line"><span class="lineno"> 1769</span>             <span class="keywordtype">int</span> sum_previous_sd = 0;</div>
<div class="line"><span class="lineno"> 1770</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sd=0;sd&lt;pr;sd++) sum_previous_sd += <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_f+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_f];</div>
<div class="line"><span class="lineno"> 1771</span>                            <span class="keywordtype">int</span> dof_pos_f = el_child_fm - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][pr*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+Lev_f] + sum_previous_sd;</div>
<div class="line"><span class="lineno"> 1772</span> </div>
<div class="line"><span class="lineno"> 1773</span>                             Rest_pos[fe][ dof_pos_c*4*(<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1) + i_ch ] = dof_pos_f;</div>
<div class="line"><span class="lineno"> 1774</span>                             Rest_val[fe][ dof_pos_c*4*(<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1) + i_ch ] = 1;</div>
<div class="line"><span class="lineno"> 1775</span>                            mult_cols[fe][ dof_pos_c ]++;</div>
<div class="line"><span class="lineno"> 1776</span>             </div>
<div class="line"><span class="lineno"> 1777</span>               }</div>
<div class="line"><span class="lineno"> 1778</span>              </div>
<div class="line"><span class="lineno"> 1779</span>            }  <span class="comment">//end fe</span></div>
<div class="line"><span class="lineno"> 1780</span> </div>
<div class="line"><span class="lineno"> 1781</span>                }   <span class="comment">//child loop</span></div>
<div class="line"><span class="lineno"> 1782</span> </div>
<div class="line"><span class="lineno"> 1783</span>            }   <span class="comment">//iel loop</span></div>
<div class="line"><span class="lineno"> 1784</span>        }  <span class="comment">//end loop pr subdomains</span></div>
<div class="line"><span class="lineno"> 1785</span> </div>
<div class="line"><span class="lineno"> 1786</span><span class="comment">//Dof extremes</span></div>
<div class="line"><span class="lineno"> 1787</span><span class="comment">//I am only using the QUADRATIC Extremes so far</span></div>
<div class="line"><span class="lineno"> 1788</span><span class="comment">//if you change the way you PRINT, you also have to change the way you READ</span></div>
<div class="line"><span class="lineno"> 1789</span><span class="comment">//Now the point is: with dof_extremes we</span></div>
<div class="line"><span class="lineno"> 1790</span> </div>
<div class="line"><span class="lineno"> 1791</span>        <span class="keywordtype">int</span> **dof_extreme_at_fine_lev_sd = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1792</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 1793</span>            dof_extreme_at_fine_lev_sd[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>+1];</div>
<div class="line"><span class="lineno"> 1794</span>            dof_extreme_at_fine_lev_sd[fe][0] = 0;</div>
<div class="line"><span class="lineno"> 1795</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idom=0;idom&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>;idom++)  { </div>
<div class="line"><span class="lineno"> 1796</span>               <span class="keywordflow">if</span> (fe  &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  dof_extreme_at_fine_lev_sd[fe][idom+1] = dof_extreme_at_fine_lev_sd[fe][idom] + ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f +1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>]); </div>
<div class="line"><span class="lineno"> 1797</span>              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  dof_extreme_at_fine_lev_sd[fe][idom+1] = dof_extreme_at_fine_lev_sd[fe][idom] + ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f +1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][idom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_f]);</div>
<div class="line"><span class="lineno"> 1798</span>           }</div>
<div class="line"><span class="lineno"> 1799</span>    }</div>
<div class="line"><span class="lineno"> 1800</span> </div>
<div class="line"><span class="lineno"> 1801</span><span class="comment">//==============================</span></div>
<div class="line"><span class="lineno"> 1802</span><span class="comment">//============= COMPRESSION =================</span></div>
<div class="line"><span class="lineno"> 1803</span><span class="comment">//==============================</span></div>
<div class="line"><span class="lineno"> 1804</span> </div>
<div class="line"><span class="lineno"> 1805</span>        <span class="keywordtype">int</span> ** lenG    = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1806</span>        <span class="keywordtype">int</span> ** lenoffG = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1807</span>        <span class="keywordtype">int</span> count[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1808</span>        <span class="keywordtype">int</span> countoff[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 1809</span> </div>
<div class="line"><span class="lineno"> 1810</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 1811</span> </div>
<div class="line"><span class="lineno"> 1812</span>            lenG[fe]    = <span class="keyword">new</span> <span class="keywordtype">int</span> [n_dofs_fe_lev[fe][FEXLevel_c[fe]]+1];</div>
<div class="line"><span class="lineno"> 1813</span>            lenoffG[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span> [n_dofs_fe_lev[fe][FEXLevel_c[fe]]+1];</div>
<div class="line"><span class="lineno"> 1814</span>            count[fe]=0;</div>
<div class="line"><span class="lineno"> 1815</span>            lenG[fe][0]=0;</div>
<div class="line"><span class="lineno"> 1816</span>            countoff[fe]=0;</div>
<div class="line"><span class="lineno"> 1817</span>            lenoffG[fe][0]=0;</div>
<div class="line"><span class="lineno"> 1818</span> </div>
<div class="line"><span class="lineno"> 1819</span>            <span class="keywordtype">int</span> dof_row=0;</div>
<div class="line"><span class="lineno"> 1820</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kdom=0; kdom&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>; kdom++) {</div>
<div class="line"><span class="lineno"> 1821</span>          <span class="keywordtype">int</span> delta_dof_at_coarse_lev_sd;</div>
<div class="line"><span class="lineno"> 1822</span>               <span class="keywordflow">if</span> (fe  &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) delta_dof_at_coarse_lev_sd = (int) (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[fe][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>]);</div>
<div class="line"><span class="lineno"> 1823</span>              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) delta_dof_at_coarse_lev_sd =        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][kdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + Lev_c];</div>
<div class="line"><span class="lineno"> 1824</span>        </div>
<div class="line"><span class="lineno"> 1825</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iki=0;iki &lt; delta_dof_at_coarse_lev_sd; iki++) {</div>
<div class="line"><span class="lineno"> 1826</span>               <span class="keywordflow">if</span> (fe  &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {</div>
<div class="line"><span class="lineno"> 1827</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> k_ch=0;k_ch &lt; mult_cols[fe][dof_row]; k_ch++) {</div>
<div class="line"><span class="lineno"> 1828</span>                        <span class="keywordtype">int</span> k_fath=<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][fe]*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>*dof_row+k_ch;</div>
<div class="line"><span class="lineno"> 1829</span>                        <span class="keywordflow">if</span> (fabs(Rest_val[fe][k_fath])&gt; PseudoZero) {</div>
<div class="line"><span class="lineno"> 1830</span>                            Rest_pos[fe][count[fe]] = Rest_pos[fe][k_fath];</div>
<div class="line"><span class="lineno"> 1831</span>                            Rest_val[fe][count[fe]] = Rest_val[fe][k_fath];</div>
<div class="line"><span class="lineno"> 1832</span>                            count[fe]++;</div>
<div class="line"><span class="lineno"> 1833</span>                            <span class="keywordflow">if</span> (Rest_pos[fe][k_fath] &gt;= (<span class="keywordtype">int</span>)  dof_extreme_at_fine_lev_sd[fe][kdom+1] ||  Rest_pos[fe][k_fath] &lt; (int) dof_extreme_at_fine_lev_sd[fe][kdom])   countoff[fe]++;</div>
<div class="line"><span class="lineno"> 1834</span>                        }</div>
<div class="line"><span class="lineno"> 1835</span>                    }</div>
<div class="line"><span class="lineno"> 1836</span>        } <span class="comment">//end temporary fe</span></div>
<div class="line"><span class="lineno"> 1837</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {</div>
<div class="line"><span class="lineno"> 1838</span>           <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> k_ch = 0; k_ch &lt; 4*(<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1); k_ch++) {</div>
<div class="line"><span class="lineno"> 1839</span><span class="comment">//                   Rest_pos  //dont need compression i think</span></div>
<div class="line"><span class="lineno"> 1840</span><span class="comment">//                  Rest_val          </span></div>
<div class="line"><span class="lineno"> 1841</span>                  <span class="comment">// you also dont need mult_cols</span></div>
<div class="line"><span class="lineno"> 1842</span>                   count[fe]++;</div>
<div class="line"><span class="lineno"> 1843</span>          <span class="comment">//you dont need the countoff</span></div>
<div class="line"><span class="lineno"> 1844</span>           }</div>
<div class="line"><span class="lineno"> 1845</span>        }</div>
<div class="line"><span class="lineno"> 1846</span>                       lenG[fe][dof_row+1] =    count[fe];</div>
<div class="line"><span class="lineno"> 1847</span>                    lenoffG[fe][dof_row+1] = countoff[fe];</div>
<div class="line"><span class="lineno"> 1848</span>                    dof_row++;</div>
<div class="line"><span class="lineno"> 1849</span>                }</div>
<div class="line"><span class="lineno"> 1850</span>            }</div>
<div class="line"><span class="lineno"> 1851</span> </div>
<div class="line"><span class="lineno"> 1852</span>            XDMFWriter::PrintOneVarMGOperatorHDF5(filename.str(),groupname_lev.str(),n_dofs_fe_lev[fe],count[fe],Rest_pos[fe],Rest_val[fe],lenG[fe],lenoffG[fe],FEXLevel_c[fe],FEXLevel_f[fe],fe);</div>
<div class="line"><span class="lineno"> 1853</span> </div>
<div class="line"><span class="lineno"> 1854</span>            <span class="keyword">delete</span> [] lenG[fe];</div>
<div class="line"><span class="lineno"> 1855</span>            <span class="keyword">delete</span> [] lenoffG[fe];</div>
<div class="line"><span class="lineno"> 1856</span>            <span class="keyword">delete</span> [] Rest_pos[fe];</div>
<div class="line"><span class="lineno"> 1857</span>            <span class="keyword">delete</span> [] Rest_val[fe];</div>
<div class="line"><span class="lineno"> 1858</span>            <span class="keyword">delete</span> [] mult_cols[fe];</div>
<div class="line"><span class="lineno"> 1859</span>        <span class="keyword">delete</span> [] dof_extreme_at_fine_lev_sd[fe];</div>
<div class="line"><span class="lineno"> 1860</span><span class="comment">//  delete [] n_dofs_lev_fe[fe]; //DO NOT DO THIS DELETE BECAUSE IT IS A COPIED POINTER</span></div>
<div class="line"><span class="lineno"> 1861</span> </div>
<div class="line"><span class="lineno"> 1862</span>        } <span class="comment">//end fe</span></div>
<div class="line"><span class="lineno"> 1863</span> </div>
<div class="line"><span class="lineno"> 1864</span> </div>
<div class="line"><span class="lineno"> 1865</span><span class="comment">// =======================================</span></div>
<div class="line"><span class="lineno"> 1866</span>        <span class="keyword">delete</span> []dof_extreme_at_fine_lev_sd;</div>
<div class="line"><span class="lineno"> 1867</span>        <span class="keyword">delete</span> [] lenG;</div>
<div class="line"><span class="lineno"> 1868</span>        <span class="keyword">delete</span> [] lenoffG;</div>
<div class="line"><span class="lineno"> 1869</span>        <span class="keyword">delete</span> [] Rest_pos;</div>
<div class="line"><span class="lineno"> 1870</span>        <span class="keyword">delete</span> [] Rest_val;</div>
<div class="line"><span class="lineno"> 1871</span>        <span class="keyword">delete</span> [] n_dofs_fe_lev;</div>
<div class="line"><span class="lineno"> 1872</span>        <span class="keyword">delete</span> [] mult_cols;</div>
<div class="line"><span class="lineno"> 1873</span> </div>
<div class="line"><span class="lineno"> 1874</span>        H5Gclose(group);</div>
<div class="line"><span class="lineno"> 1875</span> </div>
<div class="line"><span class="lineno"> 1876</span>    }</div>
<div class="line"><span class="lineno"> 1877</span><span class="comment">//end Level1</span></div>
<div class="line"><span class="lineno"> 1878</span> </div>
<div class="line"><span class="lineno"> 1879</span>     H5Fclose(file);</div>
<div class="line"><span class="lineno"> 1880</span>    </div>
<div class="line"><span class="lineno"> 1881</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno"> 1882</span>    std::cout&lt;&lt; <span class="stringliteral">&quot; GenCase::compute_and_print_MGOps: compute_rest  \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 1883</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 1884</span> </div>
<div class="line"><span class="lineno"> 1885</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1886</span>}</div>
<div class="ttc" id="a_femus_default_8hpp_html_afabe91b16d34f7c1759f0a383a2e9cc2"><div class="ttname"><a href="_femus_default_8hpp.html#afabe91b16d34f7c1759f0a383a2e9cc2">DEFAULT_F_REST</a></div><div class="ttdeci">#define DEFAULT_F_REST</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00025">FemusDefault.hpp:25</a></div></div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_vol_html_a4800376b85eeccc97f7c12c5c91a8070"><div class="ttname"><a href="classfemus_1_1_elem_sto_vol.html#a4800376b85eeccc97f7c12c5c91a8070">femus::ElemStoVol::_elchs</a></div><div class="ttdeci">int * _elchs</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00059">ElemSto.hpp:59</a></div></div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_vol_html_ae157383dd2c483093c6354fbfc1d0116"><div class="ttname"><a href="classfemus_1_1_elem_sto_vol.html#ae157383dd2c483093c6354fbfc1d0116">femus::ElemStoVol::_nch</a></div><div class="ttdeci">int _nch</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00058">ElemSto.hpp:58</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3f84519134fe7bdfc5040450fe49400e" name="a3f84519134fe7bdfc5040450fe49400e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3f84519134fe7bdfc5040450fe49400e">&#9670;&#160;</a></span>ComputeMaxElXNode()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ComputeMaxElXNode </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l02095">2095</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2095</span>                                {</div>
<div class="line"><span class="lineno"> 2096</span> </div>
<div class="line"><span class="lineno"> 2097</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">_elxnode</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>];</div>
<div class="line"><span class="lineno"> 2098</span> </div>
<div class="line"><span class="lineno"> 2099</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> inode=0;inode&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>;inode++) <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">_elxnode</a>[inode]=0;</div>
<div class="line"><span class="lineno"> 2100</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isub=0;isub&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>;isub++)</div>
<div class="line"><span class="lineno"> 2101</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][isub*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>];</div>
<div class="line"><span class="lineno"> 2102</span>                 i &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][isub*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + 1];i++)</div>
<div class="line"><span class="lineno"> 2103</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> k=0;k&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>];k++)   {</div>
<div class="line"><span class="lineno"> 2104</span>                <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">_elxnode</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>[i].second]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[k]]++;</div>
<div class="line"><span class="lineno"> 2105</span>            }</div>
<div class="line"><span class="lineno"> 2106</span> </div>
<div class="line"><span class="lineno"> 2107</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>=0;</div>
<div class="line"><span class="lineno"> 2108</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> inode=0;inode&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>;inode++) <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">_elxnode</a>[inode]&gt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>) <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a>=<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">_elxnode</a>[inode];</div>
<div class="line"><span class="lineno"> 2109</span>    std::cout&lt;&lt; <span class="stringliteral">&quot; Max number of element on each node = &quot;</span> &lt;&lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a36e0eff2f50cb30f84ce331345108988">_maxelxnode</a> &lt;&lt; <span class="stringliteral">&quot; \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2110</span> </div>
<div class="line"><span class="lineno"> 2111</span>    <span class="keyword">delete</span> []<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">_elxnode</a>;</div>
<div class="line"><span class="lineno"> 2112</span> </div>
<div class="line"><span class="lineno"> 2113</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2114</span>}</div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a1a12e7b8a567e73ca83cec9218b4aa41"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a1a12e7b8a567e73ca83cec9218b4aa41">femus::MultiLevelMeshTwo::_elxnode</a></div><div class="ttdeci">int * _elxnode</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00102">MultiLevelMeshTwo.hpp:102</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a2befae1f6286793dd66b614987eff74c"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">femus::MultiLevelMeshTwo::_n_nodes</a></div><div class="ttdeci">int _n_nodes</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00100">MultiLevelMeshTwo.hpp:100</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab3241cafafa6233649d61074e34b1358" name="ab3241cafafa6233649d61074e34b1358"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab3241cafafa6233649d61074e34b1358">&#9670;&#160;</a></span>CreateMeshStructuresLevSubd()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::CreateMeshStructuresLevSubd </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00577">577</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  577</span>                                                                     {</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a> == 0)   {  <span class="comment">//serial function</span></div>
<div class="line"><span class="lineno">  580</span><span class="comment">//================================================</span></div>
<div class="line"><span class="lineno">  581</span><span class="comment">// AT THIS POINT ALL THE LIBMESH CALLS are over, we are only FEMuS</span></div>
<div class="line"><span class="lineno">  582</span><span class="comment">//=====================================</span></div>
<div class="line"><span class="lineno">  583</span> </div>
<div class="line"><span class="lineno">  584</span>        <span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  585</span>        <span class="comment">//      ELEMENTS</span></div>
<div class="line"><span class="lineno">  586</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a>  = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>];</div>
<div class="line"><span class="lineno">  587</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> vb=0;vb &lt; <a class="code hl_define" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>; vb++) {</div>
<div class="line"><span class="lineno">  588</span>            <span class="keywordtype">int</span> offdim = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+1;</div>
<div class="line"><span class="lineno">  589</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a>[vb]= <span class="keyword">new</span> <span class="keywordtype">int</span>[offdim];</div>
<div class="line"><span class="lineno">  590</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;offdim; i++)     <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a>[vb][i]=0;</div>
<div class="line"><span class="lineno">  591</span>        }</div>
<div class="line"><span class="lineno">  592</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#ac8a4b195137869e5aea20553baa8b37d">ReorderElementBySubdLev_VV</a>();</div>
<div class="line"><span class="lineno">  593</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a7dd80e2b843180f82f9c8a11b9114ec5">ReorderElementBySubdLev_BB</a>();</div>
<div class="line"><span class="lineno">  594</span>        <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#aa6ccebf256b74843676735f05f4a2521">ComputeElemOffsetsBySubdLevel</a>();</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>        <span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  597</span>        <span class="comment">//       NODES</span></div>
<div class="line"><span class="lineno">  598</span>        <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a6ad5acbba0b96c59cb48d77cbb8f3827">FillNodeSto</a>();</div>
<div class="line"><span class="lineno">  599</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a2c8dce7f34c3d4331c677c224d601fe2">ReorderNodesBySubdLev</a>();</div>
<div class="line"><span class="lineno">  600</span>        <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a82ef73f3ce811a7475a8e92f827ce17a">ComputeNodeOffsetsBySubdLevel</a>();</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span><span class="comment">//===== node sto no longer needed, it has filled nd_libm_fm</span></div>
<div class="line"><span class="lineno">  603</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>;i++)    <span class="keyword">delete</span>  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[i];</div>
<div class="line"><span class="lineno">  604</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>;</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a1f32c3d80b3a5f9e60f6f2ef64d7957e">ElemChildToFather</a>();</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a3f84519134fe7bdfc5040450fe49400e">ComputeMaxElXNode</a>();</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>        <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a6c4b8b1cd5e1d30f315d5fbab4e472eb">ComputeNodeMapExtLevels</a>();</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>        XDMFWriter::PrintMeshBiquadraticHDF5(output_path,*<span class="keyword">this</span>);</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span><span class="comment">// delete the boundary part, no more needed</span></div>
<div class="line"><span class="lineno">  615</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>];i++)      <span class="keyword">delete</span>  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[i];</div>
<div class="line"><span class="lineno">  616</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>;</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a846b0a2baf5039c237d68920d7ee1f09">_nd_coords_libm</a>;</div>
<div class="line"><span class="lineno">  619</span> </div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>    } <span class="comment">//end proc==0</span></div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  624</span>}</div>
<div class="ttc" id="a_v_b_type_enum_8hpp_html_a02ebcbc55b174d8bb6a65cddbe7f90b6"><div class="ttname"><a href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a></div><div class="ttdeci">#define VB</div><div class="ttdef"><b>Definition</b> <a href="_v_b_type_enum_8hpp_source.html#l00008">VBTypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_v_b_type_enum_8hpp_html_a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083"><div class="ttname"><a href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a></div><div class="ttdeci">@ BB</div><div class="ttdef"><b>Definition</b> <a href="_v_b_type_enum_8hpp_source.html#l00005">VBTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a1f32c3d80b3a5f9e60f6f2ef64d7957e"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a1f32c3d80b3a5f9e60f6f2ef64d7957e">femus::GenCase::ElemChildToFather</a></div><div class="ttdeci">void ElemChildToFather()</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l01908">GenCase.cpp:1908</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a2c8dce7f34c3d4331c677c224d601fe2"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a2c8dce7f34c3d4331c677c224d601fe2">femus::GenCase::ReorderNodesBySubdLev</a></div><div class="ttdeci">void ReorderNodesBySubdLev()</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l02036">GenCase.cpp:2036</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a3f84519134fe7bdfc5040450fe49400e"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a3f84519134fe7bdfc5040450fe49400e">femus::GenCase::ComputeMaxElXNode</a></div><div class="ttdeci">void ComputeMaxElXNode()</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l02095">GenCase.cpp:2095</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a7dd80e2b843180f82f9c8a11b9114ec5"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a7dd80e2b843180f82f9c8a11b9114ec5">femus::GenCase::ReorderElementBySubdLev_BB</a></div><div class="ttdeci">void ReorderElementBySubdLev_BB()</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l02014">GenCase.cpp:2014</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_ac8a4b195137869e5aea20553baa8b37d"><div class="ttname"><a href="classfemus_1_1_gen_case.html#ac8a4b195137869e5aea20553baa8b37d">femus::GenCase::ReorderElementBySubdLev_VV</a></div><div class="ttdeci">void ReorderElementBySubdLev_VV()</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l01985">GenCase.cpp:1985</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a1cbec4cdab8a318ef1bbf3323cc2c47e"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">femus::MultiLevelMeshTwo::_n_elements_sum_levs</a></div><div class="ttdeci">int _n_elements_sum_levs[VB]</div><div class="ttdoc">[VB][]</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00087">MultiLevelMeshTwo.hpp:87</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a4324ce4d34f7d71cd37e19c271a416fc"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">femus::MultiLevelMeshTwo::_nd_sto</a></div><div class="ttdeci">NodeSto ** _nd_sto</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00104">MultiLevelMeshTwo.hpp:104</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a6ad5acbba0b96c59cb48d77cbb8f3827"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a6ad5acbba0b96c59cb48d77cbb8f3827">femus::MultiLevelMeshTwo::FillNodeSto</a></div><div class="ttdeci">void FillNodeSto()</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8cpp_source.html#l00200">MultiLevelMeshTwo.cpp:200</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a6c4b8b1cd5e1d30f315d5fbab4e472eb"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a6c4b8b1cd5e1d30f315d5fbab4e472eb">femus::MultiLevelMeshTwo::ComputeNodeMapExtLevels</a></div><div class="ttdeci">void ComputeNodeMapExtLevels()</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8cpp_source.html#l00282">MultiLevelMeshTwo.cpp:282</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a82ef73f3ce811a7475a8e92f827ce17a"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a82ef73f3ce811a7475a8e92f827ce17a">femus::MultiLevelMeshTwo::ComputeNodeOffsetsBySubdLevel</a></div><div class="ttdeci">void ComputeNodeOffsetsBySubdLevel()</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8cpp_source.html#l00252">MultiLevelMeshTwo.cpp:252</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a846b0a2baf5039c237d68920d7ee1f09"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a846b0a2baf5039c237d68920d7ee1f09">femus::MultiLevelMeshTwo::_nd_coords_libm</a></div><div class="ttdeci">double * _nd_coords_libm</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00103">MultiLevelMeshTwo.hpp:103</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a8ed8b966375e77f855441b1bc0867c24"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">femus::MultiLevelMeshTwo::_n_elements_sl_vb</a></div><div class="ttdeci">int ** _n_elements_sl_vb</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00086">MultiLevelMeshTwo.hpp:86</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_aa6ccebf256b74843676735f05f4a2521"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#aa6ccebf256b74843676735f05f4a2521">femus::MultiLevelMeshTwo::ComputeElemOffsetsBySubdLevel</a></div><div class="ttdeci">void ComputeElemOffsetsBySubdLevel()</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8cpp_source.html#l00231">MultiLevelMeshTwo.cpp:231</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_afd4c5c12b820008801e667b7701b9165"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">femus::MultiLevelMeshTwo::_el_sto_b</a></div><div class="ttdeci">ElemStoBdry ** _el_sto_b</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00090">MultiLevelMeshTwo.hpp:90</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a418c8756c74bb200de5e17afd7336620" name="a418c8756c74bb200de5e17afd7336620"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a418c8756c74bb200de5e17afd7336620">&#9670;&#160;</a></span>Delete()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::Delete </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00644">644</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  644</span>                     {</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a> == 0)   {  <span class="comment">//serial function</span></div>
<div class="line"><span class="lineno">  647</span><span class="comment">//=====================================</span></div>
<div class="line"><span class="lineno">  648</span><span class="comment">//delete</span></div>
<div class="line"><span class="lineno">  649</span><span class="comment">//=====================================</span></div>
<div class="line"><span class="lineno">  650</span> </div>
<div class="line"><span class="lineno">  651</span>        <span class="comment">//==== ELEMENTS =========</span></div>
<div class="line"><span class="lineno">  652</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>;i++)     <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[i];</div>
<div class="line"><span class="lineno">  653</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>;</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> vb=0;vb &lt; <a class="code hl_define" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>; vb++)    <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a>[vb];</div>
<div class="line"><span class="lineno">  656</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a>;</div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>;i++) <span class="keyword">delete</span> []<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[i];</div>
<div class="line"><span class="lineno">  659</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>;</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];i++)   <span class="keyword">delete</span>  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[i];    <span class="comment">// delete [] el_sto[i]; with [] it doesnt work, check the static_cast thing TODO</span></div>
<div class="line"><span class="lineno">  662</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>;</div>
<div class="line"><span class="lineno">  663</span> </div>
<div class="line"><span class="lineno">  664</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev&lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>; lev++) <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3ebaec44ee8f9bef3be3325dc08edc88">_el_child_to_fath</a>[lev];</div>
<div class="line"><span class="lineno">  665</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3ebaec44ee8f9bef3be3325dc08edc88">_el_child_to_fath</a>;</div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span>        <span class="comment">//==== NODES =========</span></div>
<div class="line"><span class="lineno">  668</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>;</div>
<div class="line"><span class="lineno">  669</span> </div>
<div class="line"><span class="lineno">  670</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#ab87a71ae1c1c9cc1d6ec5dfb857153f2">QL_NODES</a>; fe++)   <span class="keyword">delete</span> []<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a>[fe];</div>
<div class="line"><span class="lineno">  671</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a>;</div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ab87a71ae1c1c9cc1d6ec5dfb857153f2">QL_NODES</a>;i++)    <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>[i];</div>
<div class="line"><span class="lineno">  674</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ad212108f2e50d25b0ccdb3202a1fa130">_off_nd</a>;</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ind=0;ind&lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+1; ind++) {</div>
<div class="line"><span class="lineno">  677</span>      <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>[ind];</div>
<div class="line"><span class="lineno">  678</span>          <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a920204d0b6e8914d8b16e84e5f5b3b03">_Qnode_lev_Qnode_fine</a>[ind];   </div>
<div class="line"><span class="lineno">  679</span>    }</div>
<div class="line"><span class="lineno">  680</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#accd4caec1f81d3dfad0f1c69dd87b467">_Qnode_fine_Qnode_lev</a>;</div>
<div class="line"><span class="lineno">  681</span>        <span class="keyword">delete</span> [] <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a920204d0b6e8914d8b16e84e5f5b3b03">_Qnode_lev_Qnode_fine</a>;</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span> </div>
<div class="line"><span class="lineno">  684</span>    } <span class="comment">//end proc==0</span></div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  687</span>}</div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_ab87a71ae1c1c9cc1d6ec5dfb857153f2"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#ab87a71ae1c1c9cc1d6ec5dfb857153f2">QL_NODES</a></div><div class="ttdeci">#define QL_NODES</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00007">FETypeEnum.hpp:7</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a2aa71c7d2a8aaf40ef6b28c0606cf7fe"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">femus::MultiLevelMeshTwo::_n_nodes_sl_ql</a></div><div class="ttdeci">int ** _n_nodes_sl_ql</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00101">MultiLevelMeshTwo.hpp:101</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a3ebaec44ee8f9bef3be3325dc08edc88"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a3ebaec44ee8f9bef3be3325dc08edc88">femus::MultiLevelMeshTwo::_el_child_to_fath</a></div><div class="ttdeci">int ** _el_child_to_fath</div><div class="ttdoc">[VB] //of the WHOLE REFINEMENT! //LMFILLS</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00088">MultiLevelMeshTwo.hpp:88</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a920204d0b6e8914d8b16e84e5f5b3b03"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a920204d0b6e8914d8b16e84e5f5b3b03">femus::MultiLevelMeshTwo::_Qnode_lev_Qnode_fine</a></div><div class="ttdeci">uint ** _Qnode_lev_Qnode_fine</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00095">MultiLevelMeshTwo.hpp:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1f32c3d80b3a5f9e60f6f2ef64d7957e" name="a1f32c3d80b3a5f9e60f6f2ef64d7957e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1f32c3d80b3a5f9e60f6f2ef64d7957e">&#9670;&#160;</a></span>ElemChildToFather()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ElemChildToFather </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l01908">1908</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1908</span>                                {</div>
<div class="line"><span class="lineno"> 1909</span> </div>
<div class="line"><span class="lineno"> 1910</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3ebaec44ee8f9bef3be3325dc08edc88">_el_child_to_fath</a> = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>];</div>
<div class="line"><span class="lineno"> 1911</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev=0; lev&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>; lev++)  {</div>
<div class="line"><span class="lineno"> 1912</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Level=== &quot;</span> &lt;&lt; lev &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1913</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3ebaec44ee8f9bef3be3325dc08edc88">_el_child_to_fath</a>[lev] =  <span class="keyword">new</span> <span class="keywordtype">int</span>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][lev]];</div>
<div class="line"><span class="lineno"> 1914</span>        <span class="keywordtype">int</span> ielem = 0;</div>
<div class="line"><span class="lineno"> 1915</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> isub=0;isub&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>;isub++) {</div>
<div class="line"><span class="lineno"> 1916</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Subdomain= &quot;</span> &lt;&lt; isub &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1917</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][isub*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+lev];</div>
<div class="line"><span class="lineno"> 1918</span>                     iel &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][isub*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+lev+1]; iel++) {</div>
<div class="line"><span class="lineno"> 1919</span>                <span class="keywordtype">int</span>   el_libm_b = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a>[iel].second;</div>
<div class="line"><span class="lineno"> 1920</span><span class="comment">//                 std::cout &lt;&lt; &quot;boundary elem libmesh&quot; &lt;&lt; el_libm_b &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1921</span>                <span class="keywordtype">int</span> father_id_libm = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[el_libm_b]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_bdry.html#a5df83163da75a6633d69ba8bb19fced7">_vol_id</a>;</div>
<div class="line"><span class="lineno"> 1922</span><span class="comment">//                 std::cout &lt;&lt; &quot;Volume elem libmesh &quot; &lt;&lt; father_id_libm &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1923</span>                <span class="keywordtype">int</span> father_id_fm = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a6abbf958a300ffd816c2bc7b42652320">_el_libm_fm</a>[father_id_libm];</div>
<div class="line"><span class="lineno"> 1924</span><span class="comment">//                 std::cout &lt;&lt; &quot;Volume elem fm &quot; &lt;&lt; father_id_fm &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1925</span>                <span class="keywordtype">int</span> boundary_proc = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[el_libm_b]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a>;</div>
<div class="line"><span class="lineno"> 1926</span><span class="comment">//                 std::cout &lt;&lt; &quot;BOUNDARY PROC &quot; &lt;&lt; boundary_proc &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1927</span>                <span class="keywordtype">int</span> volume_proc   = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[father_id_libm]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a>;</div>
<div class="line"><span class="lineno"> 1928</span>        <span class="comment">// father_id_fm is the ABSOLUTE number</span></div>
<div class="line"><span class="lineno"> 1929</span>        <span class="comment">// I want to have the number SO THAT EACH LEVEL RESTARTS FROM ZERO</span></div>
<div class="line"><span class="lineno"> 1930</span>        <span class="comment">// therefore, i want to remove </span></div>
<div class="line"><span class="lineno"> 1931</span>        <span class="keywordtype">int</span> el_sum_prev_sd_at_lev = 0;</div>
<div class="line"><span class="lineno"> 1932</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> sd=0; sd &lt; isub; sd++)  el_sum_prev_sd_at_lev += <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + lev+1] - <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][sd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + lev];</div>
<div class="line"><span class="lineno"> 1933</span>        <span class="keywordtype">int</span> vol_elem_per_lev = father_id_fm -<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][isub*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + lev] + el_sum_prev_sd_at_lev;</div>
<div class="line"><span class="lineno"> 1934</span><span class="comment">//                 std::cout &lt;&lt; &quot;Volume PROC &quot; &lt;&lt; volume_proc  &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1935</span>                <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3ebaec44ee8f9bef3be3325dc08edc88">_el_child_to_fath</a>[lev][ielem] = vol_elem_per_lev;  <span class="comment">//father_id_fm;</span></div>
<div class="line"><span class="lineno"> 1936</span><span class="comment">//                 std::cout &lt;&lt; &quot;ielem pos &quot; &lt;&lt; ielem &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 1937</span>                <span class="comment">//TODO of course _el_sto and _el_sto_b have the Node and Elem numberings still in LIBMESH order</span></div>
<div class="line"><span class="lineno"> 1938</span>                <span class="comment">//given the libmesh order, we must get the FEMuS order</span></div>
<div class="line"><span class="lineno"> 1939</span>                <span class="comment">//TODO is it possible that when you have ONE PROC and ONE SUBDOMAIN</span></div>
<div class="line"><span class="lineno"> 1940</span>                <span class="comment">// the LIBMESH and FEMUS orderings COINCIDE?</span></div>
<div class="line"><span class="lineno"> 1941</span>                <span class="comment">//I guess I will build the INVERSE of the ELEMENT ORDERING</span></div>
<div class="line"><span class="lineno"> 1942</span>                <span class="comment">/*CHECK*/</span></div>
<div class="line"><span class="lineno"> 1943</span>                <span class="keywordflow">if</span> (ielem &gt;= <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][lev]  ) {</div>
<div class="line"><span class="lineno"> 1944</span>                    std::cout &lt;&lt; ielem &lt;&lt; <span class="stringliteral">&quot; Something wrong with number of elems&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1945</span>                    abort();</div>
<div class="line"><span class="lineno"> 1946</span>                }</div>
<div class="line"><span class="lineno"> 1947</span> </div>
<div class="line"><span class="lineno"> 1948</span>                ielem++;</div>
<div class="line"><span class="lineno"> 1949</span> </div>
<div class="line"><span class="lineno"> 1950</span>            } <span class="comment">//end iel</span></div>
<div class="line"><span class="lineno"> 1951</span>        } <span class="comment">//end subdomain</span></div>
<div class="line"><span class="lineno"> 1952</span>    }<span class="comment">//end lev</span></div>
<div class="line"><span class="lineno"> 1953</span> </div>
<div class="line"><span class="lineno"> 1954</span> </div>
<div class="line"><span class="lineno"> 1955</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 1956</span>}</div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_base_html_ae2a0bc193975b623626a8eb58e549417"><div class="ttname"><a href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">femus::ElemStoBase::_subd</a></div><div class="ttdeci">int _subd</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00039">ElemSto.hpp:39</a></div></div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_bdry_html_a5df83163da75a6633d69ba8bb19fced7"><div class="ttname"><a href="classfemus_1_1_elem_sto_bdry.html#a5df83163da75a6633d69ba8bb19fced7">femus::ElemStoBdry::_vol_id</a></div><div class="ttdeci">int _vol_id</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00074">ElemSto.hpp:74</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a82dd421b7ab2256a8fa6c763dcc4787a" name="a82dd421b7ab2256a8fa6c763dcc4787a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a82dd421b7ab2256a8fa6c763dcc4787a">&#9670;&#160;</a></span>GenerateBoundaryMesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::GenerateBoundaryMesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00246">246</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  246</span>                                         {</div>
<div class="line"><span class="lineno">  247</span><span class="preprocessor">#ifdef HAVE_LIBMESH</span></div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; LibMesh BOUNDARY generation --------- \n&quot;</span>;</div>
<div class="line"><span class="lineno">  250</span>    _msh_all_levs-&gt;boundary_info-&gt;sync(*_bd_msht);</div>
<div class="line"><span class="lineno">  251</span>    _bd_msht-&gt;print_info();</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span><span class="preprocessor">#endif </span><span class="comment">//end have_libmesh</span></div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  255</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac3e88c39000c590d4e804298e2724c6" name="aac3e88c39000c590d4e804298e2724c6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac3e88c39000c590d4e804298e2724c6">&#9670;&#160;</a></span>GenerateCase()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::GenerateCase </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00067">67</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>                                                        {</div>
<div class="line"><span class="lineno">   68</span><span class="preprocessor">#ifdef HAVE_LIBMESH </span><span class="comment">//i am putting this inside because there are no libmesh dependent arguments</span></div>
<div class="line"><span class="lineno">   69</span>  </div>
<div class="line"><span class="lineno">   70</span>  </div>
<div class="line"><span class="lineno">   71</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">   72</span>    std::clock_t start_timeA=std::clock();</div>
<div class="line"><span class="lineno">   73</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>    _msh_coarse = <span class="keyword">new</span> libMesh::Mesh( (libMesh::Parallel::Communicator) MPI_COMM_WORLD,<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>());</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_function" href="classfemus_1_1_gen_case.html#a8a58afe0ec434646bc59dafb2925b0ff">GenerateCoarseMesh</a>();</div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>    _msh_all_levs = <span class="keyword">new</span> libMesh::Mesh(*_msh_coarse);</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>    <a class="code hl_function" href="classfemus_1_1_gen_case.html#adac39ccc5e6781cba188e4b4f1e682fd">RefineMesh</a>();</div>
<div class="line"><span class="lineno">   82</span> </div>
<div class="line"><span class="lineno">   83</span>    _bd_msht = <span class="keyword">new</span>  libMesh::BoundaryMesh( (libMesh::Parallel::Communicator) MPI_COMM_WORLD, _msh_all_levs-&gt;mesh_dimension()-1);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_function" href="classfemus_1_1_gen_case.html#a82dd421b7ab2256a8fa6c763dcc4787a">GenerateBoundaryMesh</a>();</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">   88</span>    std::clock_t start_timeC=std::clock();</div>
<div class="line"><span class="lineno">   89</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   90</span> </div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_function" href="classfemus_1_1_gen_case.html#a16d995f5a08faf6e7cd89e9f750734e9">GrabMeshinfoFromLibmesh</a>();  <span class="comment">//only proc==0</span></div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    <span class="keyword">delete</span> _bd_msht;</div>
<div class="line"><span class="lineno">   94</span>    <span class="keyword">delete</span> _msh_all_levs;</div>
<div class="line"><span class="lineno">   95</span>    <span class="keyword">delete</span> _msh_coarse;</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_function" href="classfemus_1_1_gen_case.html#ab3241cafafa6233649d61074e34b1358">CreateMeshStructuresLevSubd</a>(output_path);    <span class="comment">//only proc==0</span></div>
<div class="line"><span class="lineno">   98</span>    </div>
<div class="line"><span class="lineno">   99</span>    <a class="code hl_function" href="classfemus_1_1_gen_case.html#a7638dda7e28540362e134cd783ac2826">ComputeAndPrintMGOperators</a>(output_path);    <span class="comment">//only proc==0</span></div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_function" href="classfemus_1_1_gen_case.html#a418c8756c74bb200de5e17afd7336620">Delete</a>();</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">  104</span>    std::clock_t end_timeC = std::clock();</div>
<div class="line"><span class="lineno">  105</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; Print and Operators time =&quot;</span>&lt;&lt; double(end_timeC- start_timeC) / CLOCKS_PER_SEC &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  106</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  107</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">  108</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; +*+*+* Total time =&quot;</span>&lt;&lt; double(end_timeC- start_timeA) / CLOCKS_PER_SEC &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  109</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>    </div>
<div class="line"><span class="lineno">  112</span><span class="preprocessor">#endif </span><span class="comment">//end have_libmesh    </span></div>
<div class="line"><span class="lineno">  113</span>    </div>
<div class="line"><span class="lineno">  114</span><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><span class="lineno">  115</span>        MPI_Barrier(MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  116</span><span class="preprocessor">#endif       </span></div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  118</span>}</div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a16d995f5a08faf6e7cd89e9f750734e9"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a16d995f5a08faf6e7cd89e9f750734e9">femus::GenCase::GrabMeshinfoFromLibmesh</a></div><div class="ttdeci">void GrabMeshinfoFromLibmesh()</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00269">GenCase.cpp:269</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a418c8756c74bb200de5e17afd7336620"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a418c8756c74bb200de5e17afd7336620">femus::GenCase::Delete</a></div><div class="ttdeci">void Delete()</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00644">GenCase.cpp:644</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a7638dda7e28540362e134cd783ac2826"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a7638dda7e28540362e134cd783ac2826">femus::GenCase::ComputeAndPrintMGOperators</a></div><div class="ttdeci">void ComputeAndPrintMGOperators(const std::string output_path)</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00628">GenCase.cpp:628</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a82dd421b7ab2256a8fa6c763dcc4787a"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a82dd421b7ab2256a8fa6c763dcc4787a">femus::GenCase::GenerateBoundaryMesh</a></div><div class="ttdeci">void GenerateBoundaryMesh() const</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00246">GenCase.cpp:246</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a8a58afe0ec434646bc59dafb2925b0ff"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a8a58afe0ec434646bc59dafb2925b0ff">femus::GenCase::GenerateCoarseMesh</a></div><div class="ttdeci">void GenerateCoarseMesh() const</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00126">GenCase.cpp:126</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_ab3241cafafa6233649d61074e34b1358"><div class="ttname"><a href="classfemus_1_1_gen_case.html#ab3241cafafa6233649d61074e34b1358">femus::GenCase::CreateMeshStructuresLevSubd</a></div><div class="ttdeci">void CreateMeshStructuresLevSubd(const std::string output_path)</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00577">GenCase.cpp:577</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_adac39ccc5e6781cba188e4b4f1e682fd"><div class="ttname"><a href="classfemus_1_1_gen_case.html#adac39ccc5e6781cba188e4b4f1e682fd">femus::GenCase::RefineMesh</a></div><div class="ttdeci">void RefineMesh() const</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l00211">GenCase.cpp:211</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8a58afe0ec434646bc59dafb2925b0ff" name="a8a58afe0ec434646bc59dafb2925b0ff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8a58afe0ec434646bc59dafb2925b0ff">&#9670;&#160;</a></span>GenerateCoarseMesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::GenerateCoarseMesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00126">126</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  126</span>                                       {</div>
<div class="line"><span class="lineno">  127</span><span class="preprocessor">#ifdef HAVE_LIBMESH</span></div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">  130</span>    std::clock_t start_timeA=std::clock();</div>
<div class="line"><span class="lineno">  131</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  132</span>    </div>
<div class="line"><span class="lineno">  133</span>        std::string config_dir  = <a class="code hl_define" href="_femus_default_8hpp.html#a8e12c4926d6c36bf00835a092bc0e310">DEFAULT_INPUTDIR</a>;</div>
<div class="line"><span class="lineno">  134</span>        std::string f_mesh_read = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2e69e092b1871b1d3023e22ad7748d30">_mesh_file</a>;</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>        std::ostringstream mesh_infile;</div>
<div class="line"><span class="lineno">  137</span>        mesh_infile &lt;&lt; <span class="stringliteral">&quot;./&quot;</span> &lt;&lt; config_dir &lt;&lt; f_mesh_read;</div>
<div class="line"><span class="lineno">  138</span>        std::ifstream <a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#ae162929dc5a88736f3f0afa0ea3601b0">inf</a>(mesh_infile.str().c_str());</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#ae162929dc5a88736f3f0afa0ea3601b0">inf</a> || f_mesh_read == <span class="stringliteral">&quot;&quot;</span>  ) {</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; Internal mesh generator at level 0 \n&quot;</span>;</div>
<div class="line"><span class="lineno">  143</span> </div>
<div class="line"><span class="lineno">  144</span>        <span class="keywordflow">if</span> ( <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#ab9d25c5c55f650ac17469b863a7586d1">GetDomain</a>()-&gt;GetDomainFlag() == 0 ) {</div>
<div class="line"><span class="lineno">  145</span> </div>
<div class="line"><span class="lineno">  146</span>      </div>
<div class="line"><span class="lineno">  147</span>       Box* box = <span class="keyword">static_cast&lt;</span>Box*<span class="keyword">&gt;</span>(<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#ab9d25c5c55f650ac17469b863a7586d1">GetDomain</a>());</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span><span class="comment">//---Meshing -------</span></div>
<div class="line"><span class="lineno">  150</span>            <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>* ninterv = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()];</div>
<div class="line"><span class="lineno">  151</span>        ninterv[0] = box-&gt;_domain_rtmap.get(<span class="stringliteral">&quot;nintervx&quot;</span>);</div>
<div class="line"><span class="lineno">  152</span>            ninterv[1] = box-&gt;_domain_rtmap.get(<span class="stringliteral">&quot;nintervy&quot;</span>);</div>
<div class="line"><span class="lineno">  153</span>            <span class="keywordflow">if</span> ( <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>() == 3 ) ninterv[2] = box-&gt;_domain_rtmap.get(<span class="stringliteral">&quot;nintervz&quot;</span>);</div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span>            <span class="comment">// fem element definition --------------------------------</span></div>
<div class="line"><span class="lineno">  156</span>            libMesh::ElemType libmname; <span class="comment">//convert the _geomel name into the libmesh geom el name</span></div>
<div class="line"><span class="lineno">  157</span> </div>
<div class="line"><span class="lineno">  158</span>            <span class="keywordflow">if</span> ( <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>() == 2 ) {</div>
<div class="line"><span class="lineno">  159</span>            <span class="keywordflow">if</span> (      <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afddb1d5ec4c83cb731720e4cc0dd5105">_geomelem_id</a>[<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1] == <span class="stringliteral">&quot;quad&quot;</span>) libmname = libMesh::QUAD9;</div>
<div class="line"><span class="lineno">  160</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afddb1d5ec4c83cb731720e4cc0dd5105">_geomelem_id</a>[<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1] == <span class="stringliteral">&quot;tri&quot;</span>)  libmname = libMesh::TRI6;</div>
<div class="line"><span class="lineno">  161</span>            libMesh::MeshTools::Generation::build_square</div>
<div class="line"><span class="lineno">  162</span>            (*_msh_coarse, ninterv[0], ninterv[1], box-&gt;_lb[0], box-&gt;_le[0], box-&gt;_lb[1], box-&gt;_le[1],libmname);</div>
<div class="line"><span class="lineno">  163</span>        }</div>
<div class="line"><span class="lineno">  164</span>        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>() == 3 ) {</div>
<div class="line"><span class="lineno">  165</span>            <span class="keywordflow">if</span> (      <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afddb1d5ec4c83cb731720e4cc0dd5105">_geomelem_id</a>[<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1] == <span class="stringliteral">&quot;hex&quot;</span>)  libmname = libMesh::HEX27;</div>
<div class="line"><span class="lineno">  166</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afddb1d5ec4c83cb731720e4cc0dd5105">_geomelem_id</a>[<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>()-1] == <span class="stringliteral">&quot;tet&quot;</span>)  libmname = libMesh::TET10;</div>
<div class="line"><span class="lineno">  167</span>            libMesh::MeshTools::Generation::build_cube</div>
<div class="line"><span class="lineno">  168</span>            (*_msh_coarse,  ninterv[0], ninterv[1],  ninterv[2], box-&gt;_lb[0], box-&gt;_le[0], box-&gt;_lb[1], box-&gt;_le[1], box-&gt;_lb[2], box-&gt;_le[2],libmname);</div>
<div class="line"><span class="lineno">  169</span>        }</div>
<div class="line"><span class="lineno">  170</span>            <span class="keywordflow">else</span> {         std::cout &lt;&lt; <span class="stringliteral">&quot; Dim 1 not implemented \n&quot;</span>; abort(); }</div>
<div class="line"><span class="lineno">  171</span>            </div>
<div class="line"><span class="lineno">  172</span>        } <span class="comment">//box</span></div>
<div class="line"><span class="lineno">  173</span>        </div>
<div class="line"><span class="lineno">  174</span>        <span class="keywordflow">else</span> { std::cout &lt;&lt; <span class="stringliteral">&quot; Domain shape not implemented for libmesh generation \n&quot;</span>; abort();  }</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>    }</div>
<div class="line"><span class="lineno">  177</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  178</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; Reading Mesh File at level 0 \n&quot;</span>;</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>        _msh_coarse-&gt;read(mesh_infile.str().c_str());  <span class="comment">//is this read in parallel or only by proc=0?</span></div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>    }</div>
<div class="line"><span class="lineno">  183</span>    </div>
<div class="line"><span class="lineno">  184</span>    <a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#ae162929dc5a88736f3f0afa0ea3601b0">inf</a>.close();</div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>    _msh_coarse-&gt;print_info();</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">  189</span>    std::clock_t end_timeA=std::clock();</div>
<div class="line"><span class="lineno">  190</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; *+* Generation/Reading coarse mesh time =&quot;</span></div>
<div class="line"><span class="lineno">  191</span>              &lt;&lt; double(end_timeA- start_timeA) / CLOCKS_PER_SEC &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  192</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span><span class="preprocessor">#endif </span><span class="comment">//end have_libmesh</span></div>
<div class="line"><span class="lineno">  195</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  196</span>}</div>
<div class="ttc" id="a_conformal_2ex3_2ex3_8cpp_html_ae162929dc5a88736f3f0afa0ea3601b0"><div class="ttname"><a href="_conformal_2ex3_2ex3_8cpp.html#ae162929dc5a88736f3f0afa0ea3601b0">inf</a></div><div class="ttdeci">double inf</div><div class="ttdef"><b>Definition</b> <a href="_conformal_2ex3_2ex3_8cpp_source.html#l00024">ex3.cpp:24</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_a8e12c4926d6c36bf00835a092bc0e310"><div class="ttname"><a href="_femus_default_8hpp.html#a8e12c4926d6c36bf00835a092bc0e310">DEFAULT_INPUTDIR</a></div><div class="ttdeci">#define DEFAULT_INPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00039">FemusDefault.hpp:39</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a2e69e092b1871b1d3023e22ad7748d30"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#a2e69e092b1871b1d3023e22ad7748d30">femus::MultiLevelMeshTwo::_mesh_file</a></div><div class="ttdeci">std::string _mesh_file</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8hpp_source.html#l00129">MultiLevelMeshTwo.hpp:129</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_ab9d25c5c55f650ac17469b863a7586d1"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh_two.html#ab9d25c5c55f650ac17469b863a7586d1">femus::MultiLevelMeshTwo::GetDomain</a></div><div class="ttdeci">Domain * GetDomain() const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_two_8cpp_source.html#l00172">MultiLevelMeshTwo.cpp:172</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a16d995f5a08faf6e7cd89e9f750734e9" name="a16d995f5a08faf6e7cd89e9f750734e9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a16d995f5a08faf6e7cd89e9f750734e9">&#9670;&#160;</a></span>GrabMeshinfoFromLibmesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::GrabMeshinfoFromLibmesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>This function print the mesh, or better does all the stuff... we must isolate where we call libmesh functions from where we use OUR arrays Basically, grabbing information from libmesh means filling the _el_sto[] and _el_sto_b[] arrays, together with the _nod_coords[] array once you have this interface with libmesh, you do the rest only in FEMuS. </p>

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00269">269</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  269</span>                                       {</div>
<div class="line"><span class="lineno">  270</span><span class="preprocessor">#ifdef HAVE_LIBMESH</span></div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a> == 0)  {  <span class="comment">//serial function</span></div>
<div class="line"><span class="lineno">  273</span> </div>
<div class="line"><span class="lineno">  274</span><span class="comment">//   msht contains ALL LEVELS</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">//  msh0 contains THE COARSE</span></div>
<div class="line"><span class="lineno">  276</span><span class="comment">//how about bd_msht? i think it has ONLY THE FINE</span></div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span><span class="comment">// ===================================</span></div>
<div class="line"><span class="lineno">  279</span><span class="comment">// Setup</span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">// ===================================</span></div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span><span class="comment">//here you cannot know earlier what element type will be chosen.</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">// All you can do is prepare a list of possible element types</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">//and prepare a switch that can pick one or another</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">//this switch must yield a child &quot;under the cover of the father&quot;</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">//and all the child data can be retrieved from the father with get functions</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">//no, in our case it is impossible to make a choice at RUN-TIME.</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">//so, one has to do the new necessarily</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">//we can make a class that reads things the nodes from the constructor,</span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">// then you instantiate and initialize each object of that class</span></div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a> = _msh_all_levs-&gt;n_nodes();                   <span class="comment">//these are the FINE nodes</span></div>
<div class="line"><span class="lineno">  293</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>] = _msh_all_levs-&gt;n_elem();                 <span class="comment">//from mesh</span></div>
<div class="line"><span class="lineno">  294</span> </div>
<div class="line"><span class="lineno">  295</span>        libMesh::Mesh::const_element_iterator         it_t00 = _msh_coarse-&gt;elements_begin();</div>
<div class="line"><span class="lineno">  296</span>        <span class="keyword">const</span> libMesh::Mesh::const_element_iterator  end_t00 = _msh_coarse-&gt;elements_end();</div>
<div class="line"><span class="lineno">  297</span>        libMesh::Mesh::const_element_iterator          it_tr = _msh_all_levs-&gt;elements_begin();</div>
<div class="line"><span class="lineno">  298</span>        <span class="keyword">const</span> libMesh::Mesh::const_element_iterator   end_tr = _msh_all_levs-&gt;elements_end();</div>
<div class="line"><span class="lineno">  299</span>        libMesh::Mesh::const_element_iterator it_el = _msh_all_levs-&gt;elements_begin();</div>
<div class="line"><span class="lineno">  300</span><span class="comment">// counting</span></div>
<div class="line"><span class="lineno">  301</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>     = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_v_b_type_enum_8hpp.html#a02ebcbc55b174d8bb6a65cddbe7f90b6">VB</a>];</div>
<div class="line"><span class="lineno">  302</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>] = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>];</div>
<div class="line"><span class="lineno">  303</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>] = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>];</div>
<div class="line"><span class="lineno">  304</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>           = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a> + 1];</div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ilev=0; ilev&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>; ilev++) {</div>
<div class="line"><span class="lineno">  307</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][ilev] = 0;</div>
<div class="line"><span class="lineno">  308</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][ilev] = 0;</div>
<div class="line"><span class="lineno">  309</span>        }</div>
<div class="line"><span class="lineno">  310</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ilev=0; ilev&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+1; ilev++) <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>[ilev] = 0;</div>
<div class="line"><span class="lineno">  311</span> </div>
<div class="line"><span class="lineno">  312</span><span class="comment">// structures with original mesh</span></div>
<div class="line"><span class="lineno">  313</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a846b0a2baf5039c237d68920d7ee1f09">_nd_coords_libm</a> = <span class="keyword">new</span> <span class="keywordtype">double</span>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>*3];  <span class="comment">// why 3? because always 3 coords</span></div>
<div class="line"><span class="lineno">  314</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>*3;i++) <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a846b0a2baf5039c237d68920d7ee1f09">_nd_coords_libm</a>[i] = 0.;</div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span><span class="comment">//===== store VV elem info</span></div>
<div class="line"><span class="lineno">  317</span>        <span class="comment">// this one is initialized to all -1</span></div>
<div class="line"><span class="lineno">  318</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a> = <span class="keyword">new</span> ElemStoVol*[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>]];</div>
<div class="line"><span class="lineno">  319</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0;i&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];i++)     <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[i] = <span class="keyword">new</span> ElemStoVol(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>],<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>());</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span><span class="comment">//===== compute the number of boundary elements</span></div>
<div class="line"><span class="lineno">  322</span>        <span class="keywordtype">int</span> n_el_bdry_all_levs = 0;</div>
<div class="line"><span class="lineno">  323</span>        <span class="keywordflow">for</span> (; it_el != end_tr; ++it_el) {</div>
<div class="line"><span class="lineno">  324</span>            Elem * elem = *it_el;</div>
<div class="line"><span class="lineno">  325</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>=0; <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> &lt; elem-&gt;n_sides(); <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>++) {</div>
<div class="line"><span class="lineno">  326</span>                <span class="keywordflow">if</span> (elem-&gt;neighbor(<a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>) == NULL)    {</div>
<div class="line"><span class="lineno">  327</span>                    n_el_bdry_all_levs++;</div>
<div class="line"><span class="lineno">  328</span>                }</div>
<div class="line"><span class="lineno">  329</span>            }</div>
<div class="line"><span class="lineno">  330</span>        }</div>
<div class="line"><span class="lineno">  331</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>] = n_el_bdry_all_levs;</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span><span class="comment">//===== store BB elem info</span></div>
<div class="line"><span class="lineno">  334</span>        <span class="comment">// this one is initialized to all 0</span></div>
<div class="line"><span class="lineno">  335</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a> = <span class="keyword">new</span> ElemStoBdry*[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>]];</div>
<div class="line"><span class="lineno">  336</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>];i++)    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[i]= <span class="keyword">new</span> ElemStoBdry(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>],<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>());</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>        <span class="comment">//============= all the &quot;new&quot; done so far are deleted in the other routine, TODO check that</span></div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>        <span class="comment">//elem sto is in the order given by LIBMESH</span></div>
<div class="line"><span class="lineno">  342</span>        <span class="comment">//we must construct a new elem ordering,</span></div>
<div class="line"><span class="lineno">  343</span>        <span class="comment">//and always be able to go back to libmesh ordering</span></div>
<div class="line"><span class="lineno">  344</span><span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  345</span><span class="comment">//    ELEMENTS (in elem_sto and bd_elem_sto)</span></div>
<div class="line"><span class="lineno">  346</span><span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  347</span>        <span class="comment">// Storing the mesh information</span></div>
<div class="line"><span class="lineno">  348</span>        <span class="comment">//we fill _el_sto by count_el, which means &quot;how the mesh iterator runs&quot;</span></div>
<div class="line"><span class="lineno">  349</span>        <span class="comment">//one expects that the mesh iterator goes by elem id, but it may not be true, i guess</span></div>
<div class="line"><span class="lineno">  350</span>        <span class="comment">//instead count_eb goes with &quot;when we find a boundary element, we add it&quot;</span></div>
<div class="line"><span class="lineno">  351</span>    <span class="comment">//TODO do we have, both in serial and in parallel, that count_e == elem-&gt;id(), so that </span></div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">//the iterator goes from small to large values of elem-&gt;id() ?</span></div>
<div class="line"><span class="lineno">  353</span>    <span class="comment">//I mean, the ELEMENT ID may have nothing to do with the ELEMENT POSITION in the list explored by the iterator!</span></div>
<div class="line"><span class="lineno">  354</span>    <span class="comment">//I put a check and it seems like this thing is respected.</span></div>
<div class="line"><span class="lineno">  355</span>    <span class="comment">// TODO there is another thing that must be considered!!! The VOLUME PROC PARTITIONING is done at the COARSE LEVEL,</span></div>
<div class="line"><span class="lineno">  356</span>    <span class="comment">// while the BOUNDARY MESH PROC PARTITIONING IS DONE AFTER the REFINEMENTS!</span></div>
<div class="line"><span class="lineno">  357</span>    <span class="comment">//This might cause MISMATCH in PROC NUMBERS!</span></div>
<div class="line"><span class="lineno">  358</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> count_e=0;</div>
<div class="line"><span class="lineno">  359</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> count_eb=0;</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordflow">for</span> (; it_tr != end_tr; ++it_tr) {</div>
<div class="line"><span class="lineno">  362</span>            Elem * elem = *it_tr;</div>
<div class="line"><span class="lineno">  363</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[count_e]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a650ffa9b4e351ec4d16212d80b251dc7">_id</a> = elem-&gt;id();</div>
<div class="line"><span class="lineno">  364</span>        <span class="comment">/*CHECK*/</span> <span class="keywordflow">if</span> (count_e != elem-&gt;id()) { std::cout &lt;&lt; <span class="stringliteral">&quot; The elements are not ordered by id ====== &quot;</span> &lt;&lt; std::endl; abort();}</div>
<div class="line"><span class="lineno">  365</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[count_e]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a21fac1582fea632435a5576ff9a6b6ac">_lev</a>  = elem-&gt;level();</div>
<div class="line"><span class="lineno">  366</span><span class="comment">//             _el_sto[count_e]-&gt;_subd = elem-&gt;processor_id();</span></div>
<div class="line"><span class="lineno">  367</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][elem-&gt;level()]++;</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> inode=0; inode &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a7da44ed973c45cc98c53369b60d61a5a">_elnodes</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>];inode++) {</div>
<div class="line"><span class="lineno">  370</span>                <span class="keywordtype">int</span> knode=elem-&gt;node(inode);      <span class="comment">//libmesh node numbering</span></div>
<div class="line"><span class="lineno">  371</span>                <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[count_e]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a9d853484dcf998f1e3e1b2374e8c3b61">_elnds</a>[inode]=knode;</div>
<div class="line"><span class="lineno">  372</span>            <span class="comment">// coordinates storage</span></div>
<div class="line"><span class="lineno">  373</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim=0; idim&lt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh_two.html#a767181491d990e3b808571309b153eb9">get_dim</a>(); idim++) {</div>
<div class="line"><span class="lineno">  374</span>                    <span class="keywordtype">double</span> xyz=  _msh_all_levs-&gt;point(knode)(idim);</div>
<div class="line"><span class="lineno">  375</span>                    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a846b0a2baf5039c237d68920d7ee1f09">_nd_coords_libm</a>[knode+idim*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>]=xyz;</div>
<div class="line"><span class="lineno">  376</span>                }</div>
<div class="line"><span class="lineno">  377</span>            }</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>            <span class="comment">// multigrid refinement</span></div>
<div class="line"><span class="lineno">  380</span>            Elem *parent=elem-&gt;parent();</div>
<div class="line"><span class="lineno">  381</span>            <span class="keywordflow">if</span> (parent != NULL)   <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[count_e]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#a452494c41098efc1170394e89c1ce8a8">_par</a>=parent-&gt;id();</div>
<div class="line"><span class="lineno">  382</span>            </div>
<div class="line"><span class="lineno">  383</span>            <span class="keywordtype">int</span> n_childs=elem-&gt;n_children();</div>
<div class="line"><span class="lineno">  384</span>            <span class="keywordflow">if</span> (elem-&gt; has_children()) {</div>
<div class="line"><span class="lineno">  385</span>                <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[count_e]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#ae157383dd2c483093c6354fbfc1d0116">_nch</a>= n_childs;</div>
<div class="line"><span class="lineno">  386</span>                <span class="comment">// children in the element</span></div>
<div class="line"><span class="lineno">  387</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_ch=0; i_ch&lt; n_childs; i_ch++) {</div>
<div class="line"><span class="lineno">  388</span>                    Elem* child=(*it_tr)-&gt;child(i_ch);</div>
<div class="line"><span class="lineno">  389</span>                    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[count_e]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#a4800376b85eeccc97f7c12c5c91a8070">_elchs</a>[i_ch]=child-&gt;id();</div>
<div class="line"><span class="lineno">  390</span>                }</div>
<div class="line"><span class="lineno">  391</span>            }</div>
<div class="line"><span class="lineno">  392</span>        </div>
<div class="line"><span class="lineno">  393</span>            <span class="comment">//  boundary</span></div>
<div class="line"><span class="lineno">  394</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>=0; <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> &lt; elem-&gt;n_sides(); <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>++) {</div>
<div class="line"><span class="lineno">  395</span>                <span class="keywordflow">if</span> (elem-&gt;neighbor(<a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>) == NULL)    { <span class="comment">//every element enters here only once</span></div>
<div class="line"><span class="lineno">  396</span>                    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[count_eb]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a650ffa9b4e351ec4d16212d80b251dc7">_id</a>=count_eb;        <span class="comment">//while for volume elems we use libmesh ordering, for boundary ones we count them &quot;as we go&quot;</span></div>
<div class="line"><span class="lineno">  397</span>                    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[count_eb]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_bdry.html#a5df83163da75a6633d69ba8bb19fced7">_vol_id</a>= elem-&gt;id();</div>
<div class="line"><span class="lineno">  398</span>                    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[count_eb]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a21fac1582fea632435a5576ff9a6b6ac">_lev</a>  = elem-&gt;level();</div>
<div class="line"><span class="lineno">  399</span><span class="comment">//                     _el_sto_b[count_eb]-&gt;_subd = elem-&gt;processor_id();</span></div>
<div class="line"><span class="lineno">  400</span>                    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2431608d37cb7fbe406de970b6b71788">_n_elements_vb_lev</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][elem-&gt;level()]++;</div>
<div class="line"><span class="lineno">  401</span>                    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[count_eb]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_bdry.html#a24ee13b2bdb33a0d2b03f7f820ad2d8b">_nside</a>= <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>;</div>
<div class="line"><span class="lineno">  402</span>                    AutoPtr&lt;Elem&gt; side(elem-&gt;build_side(<a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>));</div>
<div class="line"><span class="lineno">  403</span>                    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ns=0; ns&lt; side-&gt;n_nodes(); ns++)  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[count_eb]-&gt;_elnds[ns]=side-&gt;node(ns);</div>
<div class="line"><span class="lineno">  404</span>                    count_eb++;</div>
<div class="line"><span class="lineno">  405</span>                }</div>
<div class="line"><span class="lineno">  406</span>            }  <span class="comment">//side elements of each Volume Element</span></div>
<div class="line"><span class="lineno">  407</span>            </div>
<div class="line"><span class="lineno">  408</span>        count_e++;</div>
<div class="line"><span class="lineno">  409</span>       } <span class="comment">//iterator for elems</span></div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>        <span class="comment">/*CHECK*/</span>  assert((<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>) <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>] == count_e);</div>
<div class="line"><span class="lineno">  412</span>        <span class="comment">/*CHECK*/</span>  assert((<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>) <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>] == count_eb);</div>
<div class="line"><span class="lineno">  413</span>         </div>
<div class="line"><span class="lineno">  414</span>          </div>
<div class="line"><span class="lineno">  415</span>        <span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  416</span>        <span class="comment">// ELEMENT GROUPING  (lev(0)&gt;lev(n))</span></div>
<div class="line"><span class="lineno">  417</span>        <span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  418</span>        <span class="comment">//TODO Notice here what happens: you are changing the processor numbers to the element list,</span></div>
<div class="line"><span class="lineno">  419</span>        <span class="comment">// in such a way that FINER elements get the SAME PROCESSOR as the coarse ones, which is very correct!</span></div>
<div class="line"><span class="lineno">  420</span>        <span class="keywordflow">for</span> (; it_t00 != end_t00; ++it_t00) {</div>
<div class="line"><span class="lineno">  421</span>            Elem * elem=*it_t00;</div>
<div class="line"><span class="lineno">  422</span>            <span class="keywordtype">int</span> el_id=elem-&gt;id();</div>
<div class="line"><span class="lineno">  423</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_id]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a21fac1582fea632435a5576ff9a6b6ac">_lev</a> =0;</div>
<div class="line"><span class="lineno">  424</span>            <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[el_id]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a>=elem-&gt;processor_id();</div>
<div class="line"><span class="lineno">  425</span>        }</div>
<div class="line"><span class="lineno">  426</span>        <span class="comment">// subdomain ordering from level 0</span></div>
<div class="line"><span class="lineno">  427</span>        <span class="comment">//for every level, pick the elements of that level</span></div>
<div class="line"><span class="lineno">  428</span>        <span class="comment">//pick its children and set the same processor id as the father!</span></div>
<div class="line"><span class="lineno">  429</span>        <span class="comment">//I also want to pick the BOUNDARY ELEMS and set the same proc as the father!</span></div>
<div class="line"><span class="lineno">  430</span>        <span class="comment">//look, this process is not the best, it may be improved. but it works.</span></div>
<div class="line"><span class="lineno">  431</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ilev=0; ilev&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>-1; ilev++) {</div>
<div class="line"><span class="lineno">  432</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ielem=0;ielem&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];ielem++) {</div>
<div class="line"><span class="lineno">  433</span>                <span class="keywordflow">if</span> ( <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[ielem]-&gt;_lev == ilev) {</div>
<div class="line"><span class="lineno">  434</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ich=0;ich &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[ielem]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#ae157383dd2c483093c6354fbfc1d0116">_nch</a>;ich++) {</div>
<div class="line"><span class="lineno">  435</span>                        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[ielem]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_vol.html#a4800376b85eeccc97f7c12c5c91a8070">_elchs</a>[ich]]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a> = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[ielem]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a>;</div>
<div class="line"><span class="lineno">  436</span>                    }</div>
<div class="line"><span class="lineno">  437</span>                }</div>
<div class="line"><span class="lineno">  438</span>            }</div>
<div class="line"><span class="lineno">  439</span>        }</div>
<div class="line"><span class="lineno">  440</span>        </div>
<div class="line"><span class="lineno">  441</span>        </div>
<div class="line"><span class="lineno">  442</span>        <span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  443</span>        <span class="comment">//UPDATE BOUNDARY elems ==============</span></div>
<div class="line"><span class="lineno">  444</span>        <span class="comment">// ================================================</span></div>
<div class="line"><span class="lineno">  445</span>        <span class="comment">//The point is that I do not have the map that gives me the LIBMESH POSITION out of the count_eb position, so I&#39;ll do it again.</span></div>
<div class="line"><span class="lineno">  446</span>        <span class="comment">//Now the processors of all levels and all </span></div>
<div class="line"><span class="lineno">  447</span>        <span class="comment">//these iterators are strange; for instance end_tr must be a &quot;const const_element_iterator&quot;, otherwise the operator overloading of != does not work</span></div>
<div class="line"><span class="lineno">  448</span>        libMesh::Mesh::const_element_iterator    my_iter = _msh_all_levs-&gt;elements_begin();</div>
<div class="line"><span class="lineno">  449</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> count_eb2=0;</div>
<div class="line"><span class="lineno">  450</span>            <span class="keywordflow">for</span> (; my_iter != end_tr; ++my_iter) {</div>
<div class="line"><span class="lineno">  451</span>                   Elem* elem = *my_iter; </div>
<div class="line"><span class="lineno">  452</span>             <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>=0; <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> &lt; elem-&gt;n_sides(); <a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>++) {</div>
<div class="line"><span class="lineno">  453</span>                     <span class="keywordflow">if</span> (elem-&gt;neighbor(<a class="code hl_variable" href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>) == NULL)    {</div>
<div class="line"><span class="lineno">  454</span>                         <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[count_eb2]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a> = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[ <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[count_eb2]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_bdry.html#a5df83163da75a6633d69ba8bb19fced7">_vol_id</a>]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a>;  <span class="comment">//PAY ATTENTION this is DIFFERENT from &quot;elem-&gt;processor_id()&quot;!</span></div>
<div class="line"><span class="lineno">  455</span>                         count_eb2++;</div>
<div class="line"><span class="lineno">  456</span>                       }</div>
<div class="line"><span class="lineno">  457</span>                 }</div>
<div class="line"><span class="lineno">  458</span>        }</div>
<div class="line"><span class="lineno">  459</span>    </div>
<div class="line"><span class="lineno">  460</span> </div>
<div class="line"><span class="lineno">  461</span><span class="comment">/*CHECK*/</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>]; i++) {</div>
<div class="line"><span class="lineno">  462</span>         <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[i]-&gt;_subd !=  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[i]-&gt;_vol_id]-&gt;_subd )  { std::cout &lt;&lt; <span class="stringliteral">&quot; Subdomain mismatch between Boundary and Volume Elements &quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  463</span>          }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span> <span class="comment">//here is the point: we are reattributing the numbers to the volume elements, so we must do the same for the boundary as well!!!         </span></div>
<div class="line"><span class="lineno">  466</span> <span class="comment">//Now we are first looping over volume elements, then picking the corresponding boundary elems,</span></div>
<div class="line"><span class="lineno">  467</span> <span class="comment">//and associating the boundary the proc number of the &quot;father&quot;</span></div>
<div class="line"><span class="lineno">  468</span> <span class="comment">//but then we CHANGE the PROC NUMBER of the FATHER and we DO NOT UPDATE the VOLUME NUMBER of the BOUNDARY ELEMENTS.</span></div>
<div class="line"><span class="lineno">  469</span> <span class="comment">//So, we should maybe do a FUNCTION that gives the REFERENCE to the VOLUME PROCESSOR;</span></div>
<div class="line"><span class="lineno">  470</span> <span class="comment">//but, since we are in a STRUCT, we must REUPDATE the NUMBERS for the BOUNDARY ELEMENTS!</span></div>
<div class="line"><span class="lineno">  471</span> <span class="comment">//as a matter of fact, it makes no sense to assign the processor numbers BEFORE and REASSIGN THEM AFTER.</span></div>
<div class="line"><span class="lineno">  472</span> <span class="comment">//let us do that ONLY AFTER!</span></div>
<div class="line"><span class="lineno">  473</span> <span class="comment">//Now the point is: given some boundary node we know what is the corresponding VOLUME id;</span></div>
<div class="line"><span class="lineno">  474</span> <span class="comment">//on the other hand, given a volume, do we know what are the corresponding BOUNDARY ID&#39;s?</span></div>
<div class="line"><span class="lineno">  475</span> <span class="comment">//they may be one, two, even more...</span></div>
<div class="line"><span class="lineno">  476</span> <span class="comment">//every volume element should have a LIST of WHAT SIDES are BOUNDARY SIDES and have their ID</span></div>
<div class="line"><span class="lineno">  477</span> <span class="comment">//of course the length of this list is different for each boundary side</span></div>
<div class="line"><span class="lineno">  478</span> <span class="comment">//so far we do not have this association from volume to boundary, let us still use from boundary to volume</span></div>
<div class="line"><span class="lineno">  479</span> </div>
<div class="line"><span class="lineno">  480</span> <span class="comment">//can I get the libmesh element back from the element id? so get the element whose id is the given number,</span></div>
<div class="line"><span class="lineno">  481</span> <span class="comment">//without using iterator</span></div>
<div class="line"><span class="lineno">  482</span> <span class="comment">//I think it is maybe faster to increase the iterator rather than picking the element from the id.</span></div>
<div class="line"><span class="lineno">  483</span> <span class="comment">//now the point is:</span></div>
<div class="line"><span class="lineno">  484</span> <span class="comment">//first you loop to get the level</span></div>
<div class="line"><span class="lineno">  485</span> <span class="comment">//then you assign the processor to the coarse elems</span></div>
<div class="line"><span class="lineno">  486</span> <span class="comment">//then you swap all levels and for every level you assign the children with the same processor as the father</span></div>
<div class="line"><span class="lineno">  487</span> </div>
<div class="line"><span class="lineno">  488</span> <span class="comment">//things are not done as nicely as I want.</span></div>
<div class="line"><span class="lineno">  489</span> <span class="comment">//First you loop over the elements to get the LEVEL.</span></div>
<div class="line"><span class="lineno">  490</span> <span class="comment">//Then, you consider the COARSE SUBDIVISION and based on that, you give the same subdivision to ALL the CHILDREN PROCESSORS, and to the BOUNDARY PROCESSORS also</span></div>
<div class="line"><span class="lineno">  491</span> </div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>    } <span class="comment">//end proc==0</span></div>
<div class="line"><span class="lineno">  495</span>    </div>
<div class="line"><span class="lineno">  496</span><span class="preprocessor">#endif </span><span class="comment">//end have_libmesh</span></div>
<div class="line"><span class="lineno">  497</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  498</span>}</div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_base_html_a21fac1582fea632435a5576ff9a6b6ac"><div class="ttname"><a href="classfemus_1_1_elem_sto_base.html#a21fac1582fea632435a5576ff9a6b6ac">femus::ElemStoBase::_lev</a></div><div class="ttdeci">int _lev</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00038">ElemSto.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_base_html_a650ffa9b4e351ec4d16212d80b251dc7"><div class="ttname"><a href="classfemus_1_1_elem_sto_base.html#a650ffa9b4e351ec4d16212d80b251dc7">femus::ElemStoBase::_id</a></div><div class="ttdeci">int _id</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00037">ElemSto.hpp:37</a></div></div>
<div class="ttc" id="aclassfemus_1_1_elem_sto_bdry_html_a24ee13b2bdb33a0d2b03f7f820ad2d8b"><div class="ttname"><a href="classfemus_1_1_elem_sto_bdry.html#a24ee13b2bdb33a0d2b03f7f820ad2d8b">femus::ElemStoBdry::_nside</a></div><div class="ttdeci">int _nside</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00075">ElemSto.hpp:75</a></div></div>
<div class="ttc" id="anamespacefemus_html_a7216a0536acdac46863fd54b0320a8e6"><div class="ttname"><a href="namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">femus::s</a></div><div class="ttdeci">double * s</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_time_dependent_assembly_supg_g_c_l_8hpp_source.html#l00036">FSITimeDependentAssemblySupgGCL.hpp:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b47da5519d3b8d3d3d4778bc07deef3" name="a2b47da5519d3b8d3d3d4778bc07deef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b47da5519d3b8d3d3d4778bc07deef3">&#9670;&#160;</a></span>ReadMatrix()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ReadMatrix </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>namefile</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *&#160;</td>
          <td class="paramname"><em>mysys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="todo.html#_todo000033">Todo:</a></b></dt><dd>the std::cerr is not redirected to file, think of redirecting it also to file. </dd></dl>

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l02300">2300</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2300</span>                                                                      {</div>
<div class="line"><span class="lineno"> 2301</span> </div>
<div class="line"><span class="lineno"> 2302</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Level = 0; Level&lt; mysys-&gt;GetGridn(); Level++) {</div>
<div class="line"><span class="lineno"> 2303</span> </div>
<div class="line"><span class="lineno"> 2304</span>      std::ostringstream groupname_lev; groupname_lev &lt;&lt;  <span class="stringliteral">&quot;LEVEL&quot;</span> &lt;&lt; Level;</div>
<div class="line"><span class="lineno"> 2305</span>  </div>
<div class="line"><span class="lineno"> 2306</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*** rowcln;    <span class="comment">//number of rows and columns for one variable couple</span></div>
<div class="line"><span class="lineno"> 2307</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*** length_row; <span class="comment">//for every FE row and FE column</span></div>
<div class="line"><span class="lineno"> 2308</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*** length_offrow;</div>
<div class="line"><span class="lineno"> 2309</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*** pos_row;</div>
<div class="line"><span class="lineno"> 2310</span> </div>
<div class="line"><span class="lineno"> 2311</span>    rowcln        = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2312</span>    length_row    = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2313</span>    length_offrow = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2314</span>    pos_row       = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>**[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2315</span> </div>
<div class="line"><span class="lineno"> 2316</span>    hid_t  file = H5Fopen(namefile.c_str(),H5F_ACC_RDWR, H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2317</span> </div>
<div class="line"><span class="lineno"> 2318</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0;r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;r++) {  <span class="comment">//row FE type</span></div>
<div class="line"><span class="lineno"> 2319</span> </div>
<div class="line"><span class="lineno"> 2320</span>        rowcln[r]        = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2321</span>        length_row[r]    = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2322</span>        length_offrow[r] = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2323</span>        pos_row[r]       = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2324</span> </div>
<div class="line"><span class="lineno"> 2325</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) {   <span class="comment">//col FE type</span></div>
<div class="line"><span class="lineno"> 2326</span> </div>
<div class="line"><span class="lineno"> 2327</span>            std::ostringstream fe_couple;</div>
<div class="line"><span class="lineno"> 2328</span>            fe_couple &lt;&lt; <span class="stringliteral">&quot;_F&quot;</span> &lt;&lt; r &lt;&lt; <span class="stringliteral">&quot;_F&quot;</span> &lt;&lt; c;</div>
<div class="line"><span class="lineno"> 2329</span> </div>
<div class="line"><span class="lineno"> 2330</span>            <span class="comment">// dimension</span></div>
<div class="line"><span class="lineno"> 2331</span>            std::ostringstream dim_name;</div>
<div class="line"><span class="lineno"> 2332</span>            dim_name &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;DIM&quot;</span> &lt;&lt; fe_couple.str();</div>
<div class="line"><span class="lineno"> 2333</span>            rowcln[r][c] = <span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[2];</div>
<div class="line"><span class="lineno"> 2334</span>            XDMFWriter::read_UIhdf5(file,dim_name.str().c_str(),rowcln[r][c]);</div>
<div class="line"><span class="lineno"> 2335</span> </div>
<div class="line"><span class="lineno"> 2336</span>            <span class="comment">//row length</span></div>
<div class="line"><span class="lineno"> 2337</span>            std::ostringstream len_name;</div>
<div class="line"><span class="lineno"> 2338</span>            len_name &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;LEN&quot;</span> &lt;&lt; fe_couple.str();</div>
<div class="line"><span class="lineno"> 2339</span>            length_row[r][c]=<span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[ rowcln[r][c][0]+1 ];</div>
<div class="line"><span class="lineno"> 2340</span>            XDMFWriter::read_UIhdf5(file,len_name.str().c_str(),length_row[r][c]);</div>
<div class="line"><span class="lineno"> 2341</span> </div>
<div class="line"><span class="lineno"> 2342</span>            <span class="comment">// matrix off diagonal</span></div>
<div class="line"><span class="lineno"> 2343</span>            std::ostringstream offlen_name;</div>
<div class="line"><span class="lineno"> 2344</span>            offlen_name &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;OFFLEN&quot;</span> &lt;&lt; fe_couple.str();</div>
<div class="line"><span class="lineno"> 2345</span>            length_offrow[r][c]=<span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[ rowcln[r][c][0]+1 ];</div>
<div class="line"><span class="lineno"> 2346</span>            XDMFWriter::read_UIhdf5(file,offlen_name.str().c_str(),length_offrow[r][c]);</div>
<div class="line"><span class="lineno"> 2347</span> </div>
<div class="line"><span class="lineno"> 2348</span>            <span class="comment">// matrix pos //must stay AFTER reading length_offrow</span></div>
<div class="line"><span class="lineno"> 2349</span>            std::ostringstream pos_name;</div>
<div class="line"><span class="lineno"> 2350</span>            pos_name &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;POS&quot;</span> &lt;&lt; fe_couple.str();</div>
<div class="line"><span class="lineno"> 2351</span>            pos_row[r][c]=<span class="keyword">new</span> <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>[ length_row[r][c][rowcln[r][c][0]] ];</div>
<div class="line"><span class="lineno"> 2352</span>            XDMFWriter::read_UIhdf5(file,pos_name.str().c_str(),pos_row[r][c]);</div>
<div class="line"><span class="lineno"> 2353</span> </div>
<div class="line"><span class="lineno"> 2354</span>        } <span class="comment">//end col</span></div>
<div class="line"><span class="lineno"> 2355</span>    } <span class="comment">//end row</span></div>
<div class="line"><span class="lineno"> 2356</span>    </div>
<div class="line"><span class="lineno"> 2357</span>    H5Fclose(file);</div>
<div class="line"><span class="lineno"> 2358</span> </div>
<div class="line"><span class="lineno"> 2359</span><span class="comment">//============================================================================</span></div>
<div class="line"><span class="lineno"> 2360</span><span class="comment">//============ compute things for the sparsity pattern =======================</span></div>
<div class="line"><span class="lineno"> 2361</span><span class="comment">//============================================================================</span></div>
<div class="line"><span class="lineno"> 2362</span>    </div>
<div class="line"><span class="lineno"> 2363</span>    <span class="keywordtype">int</span> NoLevels  = mysys-&gt;GetMLProb().GetMeshTwo()._NoLevels;</div>
<div class="line"><span class="lineno"> 2364</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> off_proc = NoLevels*mysys-&gt;GetMLProb().GetMeshTwo()._iproc;</div>
<div class="line"><span class="lineno"> 2365</span> </div>
<div class="line"><span class="lineno"> 2366</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mrow_glob_t = 0;</div>
<div class="line"><span class="lineno"> 2367</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) mrow_glob_t += mysys-&gt;_dofmap._nvars[fe]*rowcln[fe][fe][0];</div>
<div class="line"><span class="lineno"> 2368</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ncol_glob_t = mrow_glob_t;</div>
<div class="line"><span class="lineno"> 2369</span> </div>
<div class="line"><span class="lineno"> 2370</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mrow_lev_proc_t  = 0;</div>
<div class="line"><span class="lineno"> 2371</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)  mrow_lev_proc_t +=  mysys-&gt;_dofmap._DofLocLevProcFE[Level][mysys-&gt;GetMLProb().GetMeshTwo()._iproc][fe]*mysys-&gt;_dofmap._nvars[fe];</div>
<div class="line"><span class="lineno"> 2372</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ncol_lev_proc_t  = mrow_lev_proc_t;</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> DofObjInit_lev_PrevProcs[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];  <span class="comment">// what is this? it is the ROW INDEX at which to begin for every processor</span></div>
<div class="line"><span class="lineno"> 2375</span>                      </div>
<div class="line"><span class="lineno"> 2376</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0; r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; r++)     DofObjInit_lev_PrevProcs[r] = 0;</div>
<div class="line"><span class="lineno"> 2377</span>         </div>
<div class="line"><span class="lineno"> 2378</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> isubd=0; isubd&lt;mysys-&gt;GetMLProb().GetMeshTwo().<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a>; isubd++) {</div>
<div class="line"><span class="lineno"> 2379</span>        DofObjInit_lev_PrevProcs[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] += mysys-&gt;_dofmap._DofLocLevProcFE[Level][isubd][<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>];</div>
<div class="line"><span class="lineno"> 2380</span>        DofObjInit_lev_PrevProcs[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] += mysys-&gt;_dofmap._DofLocLevProcFE[Level][isubd][<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>];</div>
<div class="line"><span class="lineno"> 2381</span>        DofObjInit_lev_PrevProcs[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] += mysys-&gt;_dofmap._DofLocLevProcFE[Level][isubd][<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>];</div>
<div class="line"><span class="lineno"> 2382</span>    }    </div>
<div class="line"><span class="lineno"> 2383</span>    </div>
<div class="line"><span class="lineno"> 2384</span>    </div>
<div class="line"><span class="lineno"> 2385</span>    mysys-&gt;_LinSolver[Level]-&gt;_KK = <a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a350a92495af225cec7b898b9fe29d9d2">SparseMatrix::build</a>().release();</div>
<div class="line"><span class="lineno"> 2386</span><span class="comment">// //     mysys-&gt;_LinSolver[Level]-&gt;_KK-&gt;init(_Dim[Level],_Dim[Level], mrow_lev_proc_t, mrow_lev_proc_t); ///@todo BACK TO a REASONABLE INIT</span></div>
<div class="line"><span class="lineno"> 2387</span> </div>
<div class="line"><span class="lineno"> 2388</span>    Graph graph;</div>
<div class="line"><span class="lineno"> 2389</span>    graph.resize(mrow_glob_t);</div>
<div class="line"><span class="lineno"> 2390</span>    graph._m  = mrow_glob_t;</div>
<div class="line"><span class="lineno"> 2391</span>    graph._n  = ncol_glob_t;</div>
<div class="line"><span class="lineno"> 2392</span>    graph._ml = mrow_lev_proc_t;</div>
<div class="line"><span class="lineno"> 2393</span>    graph._nl = ncol_lev_proc_t;</div>
<div class="line"><span class="lineno"> 2394</span>    graph._ml_start = mysys-&gt;_dofmap.GetStartDof(Level,off_proc);</div>
<div class="line"><span class="lineno"> 2395</span>    <span class="comment">// TODO is this used? I guess it is used by update_sparsity_pattern !</span></div>
<div class="line"><span class="lineno"> 2396</span>    <span class="comment">// Every subdomain has a local set of dofs, and these dofs start at a specific point.</span></div>
<div class="line"><span class="lineno"> 2397</span>    <span class="comment">// Now, remember that mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[QQ] should only be used for computing offsets, so differences.</span></div>
<div class="line"><span class="lineno"> 2398</span>    <span class="comment">// Here, it is used ALONE, because it gives you the NODE (in femus ordering) AT WHICH THE CURRENT SUBDOMAIN BEGINS,</span></div>
<div class="line"><span class="lineno"> 2399</span>    <span class="comment">//and then from _node_dof[Level] (which was already constructed) you get THE LOCAL DOF AT THE CURRENT LEVEL TO START FROM.</span></div>
<div class="line"><span class="lineno"> 2400</span>    <span class="comment">// Clearly, pay attention when you add elements, because in that case you would need to REDO the _node_dof map !!!</span></div>
<div class="line"><span class="lineno"> 2401</span>    <span class="comment">//TODO: also, what happens if you have a system with ONLY ELEMENT BASED DOFS?!?</span></div>
<div class="line"><span class="lineno"> 2402</span>    </div>
<div class="line"><span class="lineno"> 2403</span>    </div>
<div class="line"><span class="lineno"> 2404</span>    <span class="keywordtype">int</span> FELevel[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2405</span>    FELevel[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level;</div>
<div class="line"><span class="lineno"> 2406</span>    FELevel[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = (Level+mysys-&gt;GetGridn())%(mysys-&gt;GetGridn()+1); <span class="comment">//This is the map for the level of the LINEAR DOFS</span></div>
<div class="line"><span class="lineno"> 2407</span>    FELevel[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level;</div>
<div class="line"><span class="lineno"> 2408</span> </div>
<div class="line"><span class="lineno"> 2409</span>    <span class="keywordtype">int</span> off_onevar[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2410</span>    off_onevar[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = mysys-&gt;GetMLProb().GetMeshTwo()._NoNodesXLev[mysys-&gt;GetGridn()-1];</div>
<div class="line"><span class="lineno"> 2411</span>    off_onevar[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = mysys-&gt;GetMLProb().GetMeshTwo()._NoNodesXLev[mysys-&gt;GetGridn()-1];</div>
<div class="line"><span class="lineno"> 2412</span>    off_onevar[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = mysys-&gt;GetMLProb().GetMeshTwo()._n_elements_vb_lev[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][Level];</div>
<div class="line"><span class="lineno"> 2413</span>    </div>
<div class="line"><span class="lineno"> 2414</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>  off_EachFEFromStart[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2415</span>    off_EachFEFromStart[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = 0;</div>
<div class="line"><span class="lineno"> 2416</span>    off_EachFEFromStart[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = mysys-&gt;_dofmap._nvars[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>]*off_onevar[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>];</div>
<div class="line"><span class="lineno"> 2417</span>    off_EachFEFromStart[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = mysys-&gt;_dofmap._nvars[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>]*off_onevar[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] + mysys-&gt;_dofmap._nvars[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>]*off_onevar[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>];</div>
<div class="line"><span class="lineno"> 2418</span> </div>
<div class="line"><span class="lineno"> 2419</span> <span class="comment">//==============   </span></div>
<div class="line"><span class="lineno"> 2420</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0;r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;r++) {</div>
<div class="line"><span class="lineno"> 2421</span>      <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ivar=0; ivar &lt; mysys-&gt;_dofmap._nvars[r]; ivar++) {</div>
<div class="line"><span class="lineno"> 2422</span> </div>
<div class="line"><span class="lineno"> 2423</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> DofObj_lev = DofObjInit_lev_PrevProcs[r]; DofObj_lev &lt; DofObjInit_lev_PrevProcs[r] + mysys-&gt;_dofmap._DofLocLevProcFE[Level][mysys-&gt;GetMLProb().GetMeshTwo()._iproc][r]; DofObj_lev++) {</div>
<div class="line"><span class="lineno"> 2424</span> </div>
<div class="line"><span class="lineno"> 2425</span>            <span class="keywordtype">int</span> dof_pos, irow;</div>
<div class="line"><span class="lineno"> 2426</span>             <span class="keywordflow">if</span>  (r&lt;<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {  dof_pos = mysys-&gt;GetMLProb().GetMeshTwo()._Qnode_lev_Qnode_fine[FELevel[r]][ DofObj_lev ];  }</div>
<div class="line"><span class="lineno"> 2427</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (r==<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {  dof_pos = DofObj_lev; }</div>
<div class="line"><span class="lineno"> 2428</span>                    irow = mysys-&gt;_dofmap.GetDof(Level,r,ivar,dof_pos); </div>
<div class="line"><span class="lineno"> 2429</span> </div>
<div class="line"><span class="lineno"> 2430</span>        <span class="keywordtype">int</span> len[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) len[c] = 0;</div>
<div class="line"><span class="lineno"> 2431</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) len[c] = (length_row[r][c][ DofObj_lev+1 ]-length_row[r][c][ DofObj_lev ]);</div>
<div class="line"><span class="lineno"> 2432</span>            <span class="keywordtype">int</span> rowsize = 0; </div>
<div class="line"><span class="lineno"> 2433</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) rowsize +=mysys-&gt;_dofmap._nvars[c]*len[c];</div>
<div class="line"><span class="lineno"> 2434</span>          graph[irow].resize(rowsize + 1);  <span class="comment">//There is a +1 because in the last position you memorize the number of offset dofs in that row</span></div>
<div class="line"><span class="lineno"> 2435</span> </div>
<div class="line"><span class="lineno"> 2436</span>            <span class="keywordtype">int</span> lenoff[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) lenoff[c] = 0;</div>
<div class="line"><span class="lineno"> 2437</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++)  lenoff[c] = length_offrow[r][c][DofObj_lev+1] - length_offrow[r][c][ DofObj_lev ];</div>
<div class="line"><span class="lineno"> 2438</span>        <span class="keywordtype">int</span> lenoff_size = 0;</div>
<div class="line"><span class="lineno"> 2439</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) lenoff_size += mysys-&gt;_dofmap._nvars[c]*lenoff[c];</div>
<div class="line"><span class="lineno"> 2440</span>            graph[irow][rowsize] = lenoff_size;      <span class="comment">// last stored value is the number of in-matrix nonzero off-diagonal values</span></div>
<div class="line"><span class="lineno"> 2441</span> </div>
<div class="line"><span class="lineno"> 2442</span>        }</div>
<div class="line"><span class="lineno"> 2443</span>    }</div>
<div class="line"><span class="lineno"> 2444</span>  } <span class="comment">//end r</span></div>
<div class="line"><span class="lineno"> 2445</span>     </div>
<div class="line"><span class="lineno"> 2446</span><span class="comment">//===========================</span></div>
<div class="line"><span class="lineno"> 2447</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; Matrix \n&quot;</span>;</div>
<div class="line"><span class="lineno"> 2448</span>    graph.print();</div>
<div class="line"><span class="lineno"> 2449</span><span class="comment">//===========================</span></div>
<div class="line"><span class="lineno"> 2450</span> </div>
<div class="line"><span class="lineno"> 2451</span>    mysys-&gt;_LinSolver[Level]-&gt;_KK-&gt;update_sparsity_pattern_old(graph);</div>
<div class="line"><span class="lineno"> 2452</span> </div>
<div class="line"><span class="lineno"> 2453</span>    <span class="comment">//  clean ===============</span></div>
<div class="line"><span class="lineno"> 2454</span>    graph.clear();</div>
<div class="line"><span class="lineno"> 2455</span> </div>
<div class="line"><span class="lineno"> 2456</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> r=0;r&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;r++) {  <span class="comment">//row FE type</span></div>
<div class="line"><span class="lineno"> 2457</span> </div>
<div class="line"><span class="lineno"> 2458</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> c=0;c&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;c++) {   <span class="comment">//col</span></div>
<div class="line"><span class="lineno"> 2459</span> </div>
<div class="line"><span class="lineno"> 2460</span>            <span class="keyword">delete</span> []  rowcln[r][c];</div>
<div class="line"><span class="lineno"> 2461</span>            <span class="keyword">delete</span> []  length_row[r][c];</div>
<div class="line"><span class="lineno"> 2462</span>            <span class="keyword">delete</span> []  length_offrow[r][c];</div>
<div class="line"><span class="lineno"> 2463</span>            <span class="keyword">delete</span> []  pos_row[r][c];</div>
<div class="line"><span class="lineno"> 2464</span> </div>
<div class="line"><span class="lineno"> 2465</span>        }</div>
<div class="line"><span class="lineno"> 2466</span> </div>
<div class="line"><span class="lineno"> 2467</span>        <span class="keyword">delete</span> []  rowcln[r];</div>
<div class="line"><span class="lineno"> 2468</span>        <span class="keyword">delete</span> []  length_row[r];</div>
<div class="line"><span class="lineno"> 2469</span>        <span class="keyword">delete</span> []  length_offrow[r];</div>
<div class="line"><span class="lineno"> 2470</span>        <span class="keyword">delete</span> []  pos_row[r];</div>
<div class="line"><span class="lineno"> 2471</span> </div>
<div class="line"><span class="lineno"> 2472</span>    }</div>
<div class="line"><span class="lineno"> 2473</span> </div>
<div class="line"><span class="lineno"> 2474</span>    <span class="keyword">delete</span>  []  rowcln;</div>
<div class="line"><span class="lineno"> 2475</span>    <span class="keyword">delete</span>  []  length_row;</div>
<div class="line"><span class="lineno"> 2476</span>    <span class="keyword">delete</span>  []  length_offrow;</div>
<div class="line"><span class="lineno"> 2477</span>    <span class="keyword">delete</span>  []  pos_row;</div>
<div class="line"><span class="lineno"> 2478</span> </div>
<div class="line"><span class="lineno"> 2479</span>    </div>
<div class="line"><span class="lineno"> 2480</span>    } <span class="comment">//end levels   </span></div>
<div class="line"><span class="lineno"> 2481</span> </div>
<div class="line"><span class="lineno"> 2482</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno"> 2483</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; ReadMatrix: matrix reading &quot;</span>  &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2484</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2485</span> </div>
<div class="line"><span class="lineno"> 2486</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2487</span>}</div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a350a92495af225cec7b898b9fe29d9d2"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html#a350a92495af225cec7b898b9fe29d9d2">femus::SparseMatrix::build</a></div><div class="ttdeci">static std::unique_ptr&lt; SparseMatrix &gt; build(const SolverPackage solver_package=LSOLVER)</div><div class="ttdef"><b>Definition</b> <a href="_sparse_matrix_8cpp_source.html#l00042">SparseMatrix.cpp:42</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8ff0e1ca8e4b16e005e8a37799c43194" name="a8ff0e1ca8e4b16e005e8a37799c43194"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8ff0e1ca8e4b16e005e8a37799c43194">&#9670;&#160;</a></span>ReadMGOps()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ReadMGOps </td>
          <td>(</td>
          <td class="paramtype">const std::string&#160;</td>
          <td class="paramname"><em>output_path</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *&#160;</td>
          <td class="paramname"><em>mysys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l02118">2118</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2118</span>                                                                      {</div>
<div class="line"><span class="lineno"> 2119</span> </div>
<div class="line"><span class="lineno"> 2120</span>    std::string     f_matrix = <a class="code hl_define" href="_femus_default_8hpp.html#a38b4725eb3b423ebb1fe835d244bb3e6">DEFAULT_F_MATRIX</a>;</div>
<div class="line"><span class="lineno"> 2121</span>    std::string       f_rest = <a class="code hl_define" href="_femus_default_8hpp.html#afabe91b16d34f7c1759f0a383a2e9cc2">DEFAULT_F_REST</a>;</div>
<div class="line"><span class="lineno"> 2122</span>    std::string       f_prol = <a class="code hl_define" href="_femus_default_8hpp.html#a2246e654bedf09d71456edd5ac222a0f">DEFAULT_F_PROL</a>;</div>
<div class="line"><span class="lineno"> 2123</span>    std::string       ext_h5 = <a class="code hl_define" href="_femus_default_8hpp.html#a88cc18ae6f1376162580864906e9fcef">DEFAULT_EXT_H5</a>;</div>
<div class="line"><span class="lineno"> 2124</span> </div>
<div class="line"><span class="lineno"> 2125</span>    std::ostringstream filename;</div>
<div class="line"><span class="lineno"> 2126</span>    std::string filename_base;</div>
<div class="line"><span class="lineno"> 2127</span>    filename_base = output_path + <span class="stringliteral">&quot;/&quot;</span>;</div>
<div class="line"><span class="lineno"> 2128</span>    </div>
<div class="line"><span class="lineno"> 2129</span>        filename.str(<span class="stringliteral">&quot;&quot;</span>);     filename &lt;&lt; filename_base &lt;&lt; f_rest &lt;&lt; ext_h5;</div>
<div class="line"><span class="lineno"> 2130</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a37997ccf132703dfabf7bead831f6f38">ReadRest</a>(filename.str(),mysys);</div>
<div class="line"><span class="lineno"> 2131</span>    </div>
<div class="line"><span class="lineno"> 2132</span>        filename.str(<span class="stringliteral">&quot;&quot;</span>);   filename &lt;&lt; filename_base &lt;&lt; f_matrix &lt;&lt; ext_h5;</div>
<div class="line"><span class="lineno"> 2133</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a2b47da5519d3b8d3d3d4778bc07deef3">ReadMatrix</a>(filename.str(),mysys);</div>
<div class="line"><span class="lineno"> 2134</span>  </div>
<div class="line"><span class="lineno"> 2135</span>        filename.str(<span class="stringliteral">&quot;&quot;</span>);    filename &lt;&lt; filename_base &lt;&lt; f_prol &lt;&lt; ext_h5;</div>
<div class="line"><span class="lineno"> 2136</span>        <a class="code hl_function" href="classfemus_1_1_gen_case.html#a537015fb25eb05e896a2ab4da02d4c9f">ReadProl</a>(filename.str(),mysys);</div>
<div class="line"><span class="lineno"> 2137</span> </div>
<div class="line"><span class="lineno"> 2138</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2139</span>}</div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a2b47da5519d3b8d3d3d4778bc07deef3"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a2b47da5519d3b8d3d3d4778bc07deef3">femus::GenCase::ReadMatrix</a></div><div class="ttdeci">static void ReadMatrix(const std::string &amp;name, SystemTwo *mysys)</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l02300">GenCase.cpp:2300</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a37997ccf132703dfabf7bead831f6f38"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a37997ccf132703dfabf7bead831f6f38">femus::GenCase::ReadRest</a></div><div class="ttdeci">static void ReadRest(const std::string &amp;name, SystemTwo *mysys)</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l02736">GenCase.cpp:2736</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a537015fb25eb05e896a2ab4da02d4c9f"><div class="ttname"><a href="classfemus_1_1_gen_case.html#a537015fb25eb05e896a2ab4da02d4c9f">femus::GenCase::ReadProl</a></div><div class="ttdeci">static void ReadProl(const std::string &amp;name, SystemTwo *mysys)</div><div class="ttdef"><b>Definition</b> <a href="_gen_case_8cpp_source.html#l02493">GenCase.cpp:2493</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a537015fb25eb05e896a2ab4da02d4c9f" name="a537015fb25eb05e896a2ab4da02d4c9f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a537015fb25eb05e896a2ab4da02d4c9f">&#9670;&#160;</a></span>ReadProl()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ReadProl </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *&#160;</td>
          <td class="paramname"><em>mysys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l02493">2493</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2493</span>                                                               {</div>
<div class="line"><span class="lineno"> 2494</span> </div>
<div class="line"><span class="lineno"> 2495</span>  </div>
<div class="line"><span class="lineno"> 2496</span>    vector &lt; SparseMatrix* &gt; &amp;_PP = mysys-&gt;GetProjectionMatrix(); <span class="comment">//added by Eugenio TO BE TESTED</span></div>
<div class="line"><span class="lineno"> 2497</span>    </div>
<div class="line"><span class="lineno"> 2498</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Level = 1; Level&lt; mysys-&gt;GetGridn(); Level++) {</div>
<div class="line"><span class="lineno"> 2499</span>  </div>
<div class="line"><span class="lineno"> 2500</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Lev_c = Level-1;</div>
<div class="line"><span class="lineno"> 2501</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Lev_f = Level;    </div>
<div class="line"><span class="lineno"> 2502</span> </div>
<div class="line"><span class="lineno"> 2503</span>        <span class="keywordtype">int</span> FEXLevel_c[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2504</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level-1;                                 <span class="comment">//COARSE Level for QUADRATIC</span></div>
<div class="line"><span class="lineno"> 2505</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = (Level-1+mysys-&gt;GetGridn())%(mysys-&gt;GetGridn()+1);</div>
<div class="line"><span class="lineno"> 2506</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level-1;                                 <span class="comment">//COARSE Level for CONSTANT //TODO is this used?</span></div>
<div class="line"><span class="lineno"> 2507</span>        <span class="keywordtype">int</span> FEXLevel_f[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2508</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level;                                  <span class="comment">//FINE Level for QUADRATIC</span></div>
<div class="line"><span class="lineno"> 2509</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = Level-1;                                <span class="comment">// AAA look at the symmetry, this is exactly (_n_levels + Level1 + 1)%(_n_levels + 1); ! //FINE Level for LINEAR:   Level1=0 means coarse linear, a finer linear is the first coarse quadratic, and so on and so on</span></div>
<div class="line"><span class="lineno"> 2510</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level;                                  <span class="comment">//FINE Level for CONSTANT //TODO is this used?</span></div>
<div class="line"><span class="lineno"> 2511</span> </div>
<div class="line"><span class="lineno"> 2512</span>    std::ostringstream groupname_lev; groupname_lev &lt;&lt;  <span class="stringliteral">&quot;LEVEL&quot;</span> &lt;&lt; Lev_c &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; Lev_f;</div>
<div class="line"><span class="lineno"> 2513</span>  </div>
<div class="line"><span class="lineno"> 2514</span>    <span class="keywordtype">int</span>** rowcln;</div>
<div class="line"><span class="lineno"> 2515</span>    <span class="keywordtype">int</span>** len;</div>
<div class="line"><span class="lineno"> 2516</span>    <span class="keywordtype">int</span>** lenoff;</div>
<div class="line"><span class="lineno"> 2517</span>    <span class="keywordtype">int</span>** Prol_pos;</div>
<div class="line"><span class="lineno"> 2518</span>    <span class="keywordtype">double</span>** Prol_val;</div>
<div class="line"><span class="lineno"> 2519</span> </div>
<div class="line"><span class="lineno"> 2520</span>    rowcln     = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2521</span>    len        = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2522</span>    lenoff     = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2523</span>    Prol_pos   = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2524</span>    Prol_val   = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2525</span> </div>
<div class="line"><span class="lineno"> 2526</span>    hid_t  file = H5Fopen(name.c_str(),H5F_ACC_RDWR, H5P_DEFAULT); <span class="comment">//TODO do I need to open it here for every level?!?</span></div>
<div class="line"><span class="lineno"> 2527</span> </div>
<div class="line"><span class="lineno"> 2528</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) {</div>
<div class="line"><span class="lineno"> 2529</span> </div>
<div class="line"><span class="lineno"> 2530</span>        std::ostringstream fe_family;</div>
<div class="line"><span class="lineno"> 2531</span>        fe_family &lt;&lt;  <span class="stringliteral">&quot;_F&quot;</span> &lt;&lt; fe;</div>
<div class="line"><span class="lineno"> 2532</span> </div>
<div class="line"><span class="lineno"> 2533</span>        <span class="comment">//==== DIM ========</span></div>
<div class="line"><span class="lineno"> 2534</span>        std::ostringstream name0;</div>
<div class="line"><span class="lineno"> 2535</span>        name0 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;DIM&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2536</span>        rowcln[fe]= <span class="keyword">new</span> <span class="keywordtype">int</span>[2];</div>
<div class="line"><span class="lineno"> 2537</span>        hid_t dataset = H5Dopen(file, name0.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2538</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,rowcln[fe]);</div>
<div class="line"><span class="lineno"> 2539</span>        <span class="keywordtype">int</span> nrow=rowcln[fe][0];</div>
<div class="line"><span class="lineno"> 2540</span>        <span class="comment">//===== LEN =======</span></div>
<div class="line"><span class="lineno"> 2541</span>        std::ostringstream name2;</div>
<div class="line"><span class="lineno"> 2542</span>        name2 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;LEN&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2543</span>        len[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[nrow+1];</div>
<div class="line"><span class="lineno"> 2544</span>        dataset = H5Dopen(file,name2.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2545</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,len[fe]);</div>
<div class="line"><span class="lineno"> 2546</span>        <span class="comment">//==== OFFLEN ========</span></div>
<div class="line"><span class="lineno"> 2547</span>        std::ostringstream name3;</div>
<div class="line"><span class="lineno"> 2548</span>        name3 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;OFFLEN&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2549</span>        lenoff[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[nrow+1];</div>
<div class="line"><span class="lineno"> 2550</span>        dataset = H5Dopen(file,name3.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2551</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,lenoff[fe]);</div>
<div class="line"><span class="lineno"> 2552</span>        <span class="comment">//===== POS =======</span></div>
<div class="line"><span class="lineno"> 2553</span>        std::ostringstream name1;</div>
<div class="line"><span class="lineno"> 2554</span>        name1 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;POS&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2555</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> count3 = len[fe][nrow];</div>
<div class="line"><span class="lineno"> 2556</span>        Prol_pos[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[count3];</div>
<div class="line"><span class="lineno"> 2557</span>        dataset = H5Dopen(file,name1.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2558</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,Prol_pos[fe]);</div>
<div class="line"><span class="lineno"> 2559</span>        <span class="comment">//===== VAL =======</span></div>
<div class="line"><span class="lineno"> 2560</span>        std::ostringstream name1b;</div>
<div class="line"><span class="lineno"> 2561</span>        name1b &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;VAL&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2562</span>        Prol_val[fe] = <span class="keyword">new</span> <span class="keywordtype">double</span>[count3];</div>
<div class="line"><span class="lineno"> 2563</span>        dataset = H5Dopen(file,name1b.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2564</span>        H5Dread(dataset,H5T_NATIVE_DOUBLE,H5S_ALL,H5S_ALL,H5P_DEFAULT,Prol_val[fe]);</div>
<div class="line"><span class="lineno"> 2565</span> </div>
<div class="line"><span class="lineno"> 2566</span>    }</div>
<div class="line"><span class="lineno"> 2567</span>   </div>
<div class="line"><span class="lineno"> 2568</span>    H5Fclose(file);</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span><span class="comment">//=================== end reading =====</span></div>
<div class="line"><span class="lineno"> 2571</span>    </div>
<div class="line"><span class="lineno"> 2572</span><span class="comment">//======= From here on the EQUATION comes into play, because we have to take into account</span></div>
<div class="line"><span class="lineno"> 2573</span><span class="comment">// the number of variables of every FE type</span></div>
<div class="line"><span class="lineno"> 2574</span><span class="comment">//Level goes from 1 to NoLevels-1</span></div>
<div class="line"><span class="lineno"> 2575</span>   </div>
<div class="line"><span class="lineno"> 2576</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> off_proc = mysys-&gt;GetMLProb().GetMeshTwo()._iproc*mysys-&gt;GetGridn();</div>
<div class="line"><span class="lineno"> 2577</span> </div>
<div class="line"><span class="lineno"> 2578</span>    <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2579</span>    _PP[Lev_f] = <a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a350a92495af225cec7b898b9fe29d9d2">SparseMatrix::build</a>().release();</div>
<div class="line"><span class="lineno"> 2580</span><span class="comment">// // //     _Prl[ Lev_f ]-&gt;init(0,0,0,0); //TODO BACK TO A REASONABLE INIT</span></div>
<div class="line"><span class="lineno"> 2581</span> </div>
<div class="line"><span class="lineno"> 2582</span>    <span class="comment">// local matrix dimension</span></div>
<div class="line"><span class="lineno"> 2583</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ml[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>]; <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nl[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2584</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) { </div>
<div class="line"><span class="lineno"> 2585</span>       <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) {</div>
<div class="line"><span class="lineno"> 2586</span>       ml[fe] = mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][off_proc + Lev_f +1] - mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][off_proc];    <span class="comment">//  local quadratic    //COARSE (rows)</span></div>
<div class="line"><span class="lineno"> 2587</span>       nl[fe] = mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][off_proc + Lev_c +1] - mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][off_proc];    <span class="comment">// global quadratic  //FINE QUADRATIC (cols)</span></div>
<div class="line"><span class="lineno"> 2588</span>       }</div>
<div class="line"><span class="lineno"> 2589</span>       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) { </div>
<div class="line"><span class="lineno"> 2590</span>       ml[fe] = mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][off_proc + Lev_f +1] - mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][off_proc + Lev_f];</div>
<div class="line"><span class="lineno"> 2591</span>       nl[fe] = mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][off_proc + Lev_c +1] - mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][off_proc + Lev_c];</div>
<div class="line"><span class="lineno"> 2592</span>      }</div>
<div class="line"><span class="lineno"> 2593</span>     }</div>
<div class="line"><span class="lineno"> 2594</span>    <span class="comment">// pattern dimension</span></div>
<div class="line"><span class="lineno"> 2595</span>        <span class="keywordtype">int</span> nrowt=0;<span class="keywordtype">int</span> nclnt=0;</div>
<div class="line"><span class="lineno"> 2596</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 2597</span>      nrowt += mysys-&gt;_dofmap._nvars[fe]*rowcln[fe][0];</div>
<div class="line"><span class="lineno"> 2598</span>          nclnt += mysys-&gt;_dofmap._nvars[fe]*rowcln[fe][1];</div>
<div class="line"><span class="lineno"> 2599</span>    }</div>
<div class="line"><span class="lineno"> 2600</span>    </div>
<div class="line"><span class="lineno"> 2601</span>    Graph pattern;</div>
<div class="line"><span class="lineno"> 2602</span>    pattern.resize(nrowt);</div>
<div class="line"><span class="lineno"> 2603</span>    pattern._m=nrowt;</div>
<div class="line"><span class="lineno"> 2604</span>    pattern._n=nclnt;</div>
<div class="line"><span class="lineno"> 2605</span>    pattern._ml = 0;</div>
<div class="line"><span class="lineno"> 2606</span>    pattern._nl = 0;</div>
<div class="line"><span class="lineno"> 2607</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) { </div>
<div class="line"><span class="lineno"> 2608</span>        pattern._ml += mysys-&gt;_dofmap._nvars[fe]*ml[fe];  <span class="comment">//  local _m</span></div>
<div class="line"><span class="lineno"> 2609</span>        pattern._nl += mysys-&gt;_dofmap._nvars[fe]*nl[fe];  <span class="comment">//  local _n</span></div>
<div class="line"><span class="lineno"> 2610</span>     }</div>
<div class="line"><span class="lineno"> 2611</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ml_start = mysys-&gt;_dofmap.GetStartDof(Level,off_proc);</div>
<div class="line"><span class="lineno"> 2612</span>    pattern._ml_start = ml_start;</div>
<div class="line"><span class="lineno"> 2613</span> </div>
<div class="line"><span class="lineno"> 2614</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ml_init[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>]; <span class="comment">//up to the current processor</span></div>
<div class="line"><span class="lineno"> 2615</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) { </div>
<div class="line"><span class="lineno"> 2616</span>           ml_init[fe]=0;</div>
<div class="line"><span class="lineno"> 2617</span>        <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> isubd=0;isubd&lt;mysys-&gt;GetMLProb().GetMeshTwo().<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a>; isubd++) {</div>
<div class="line"><span class="lineno"> 2618</span>       <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)       ml_init[fe] += mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][isubd*mysys-&gt;GetGridn() + Lev_f +1] - mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][isubd*mysys-&gt;GetGridn()];</div>
<div class="line"><span class="lineno"> 2619</span>       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) ml_init[fe] += mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][isubd*mysys-&gt;GetGridn() + Lev_f +1] - mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][isubd*mysys-&gt;GetGridn() + Lev_f];</div>
<div class="line"><span class="lineno"> 2620</span>    }</div>
<div class="line"><span class="lineno"> 2621</span>      }</div>
<div class="line"><span class="lineno"> 2622</span>  </div>
<div class="line"><span class="lineno"> 2623</span>    <span class="comment">//============= POSITION =========</span></div>
<div class="line"><span class="lineno"> 2624</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 2625</span> </div>
<div class="line"><span class="lineno"> 2626</span>     <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ivar=0;ivar&lt;mysys-&gt;_dofmap._nvars[fe];ivar++) {</div>
<div class="line"><span class="lineno"> 2627</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = ml_init[fe]; i &lt; ml_init[fe]+ml[fe]; i++) {</div>
<div class="line"><span class="lineno"> 2628</span>          <span class="keywordtype">int</span> dof_pos_f;</div>
<div class="line"><span class="lineno"> 2629</span>          <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)         dof_pos_f = mysys-&gt;GetMLProb().GetMeshTwo()._Qnode_lev_Qnode_fine[ FEXLevel_f[fe] ][ i ];  <span class="comment">//end fe &lt; ql</span></div>
<div class="line"><span class="lineno"> 2630</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)   dof_pos_f = i;</div>
<div class="line"><span class="lineno"> 2631</span>          </div>
<div class="line"><span class="lineno"> 2632</span>            <span class="keywordtype">int</span> irow  = mysys-&gt;_dofmap.GetDof(Lev_f,fe,ivar,dof_pos_f);</div>
<div class="line"><span class="lineno"> 2633</span> </div>
<div class="line"><span class="lineno"> 2634</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ncol =    len[fe][i+1] -    len[fe][i];</div>
<div class="line"><span class="lineno"> 2635</span>            <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> noff = lenoff[fe][i+1] - lenoff[fe][i];</div>
<div class="line"><span class="lineno"> 2636</span>            pattern[irow].resize(ncol+1);</div>
<div class="line"><span class="lineno"> 2637</span>            pattern[irow][ncol] = noff;</div>
<div class="line"><span class="lineno"> 2638</span><span class="comment">// #ifdef FEMUS_HAVE_LASPACK</span></div>
<div class="line"><span class="lineno"> 2639</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;ncol; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 2640</span>          <span class="keywordtype">int</span> dof_pos_lev_c = Prol_pos[fe][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>+len[fe][i]];</div>
<div class="line"><span class="lineno"> 2641</span>          <span class="keywordtype">int</span> dof_pos_c;</div>
<div class="line"><span class="lineno"> 2642</span>          <span class="keywordflow">if</span>      (fe  &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) dof_pos_c = mysys-&gt;GetMLProb().GetMeshTwo()._Qnode_lev_Qnode_fine[ FEXLevel_c[fe] ][ dof_pos_lev_c ];</div>
<div class="line"><span class="lineno"> 2643</span>              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) dof_pos_c = dof_pos_lev_c; </div>
<div class="line"><span class="lineno"> 2644</span>          </div>
<div class="line"><span class="lineno"> 2645</span>          pattern[irow][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = mysys-&gt;_dofmap.GetDof(Lev_c,fe,ivar,dof_pos_c);</div>
<div class="line"><span class="lineno"> 2646</span>            }</div>
<div class="line"><span class="lineno"> 2647</span><span class="comment">// #endif</span></div>
<div class="line"><span class="lineno"> 2648</span> </div>
<div class="line"><span class="lineno"> 2649</span>        }</div>
<div class="line"><span class="lineno"> 2650</span>        }<span class="comment">//end fe &lt; KK</span></div>
<div class="line"><span class="lineno"> 2651</span>   } <span class="comment">//end fe</span></div>
<div class="line"><span class="lineno"> 2652</span>   </div>
<div class="line"><span class="lineno"> 2653</span> </div>
<div class="line"><span class="lineno"> 2654</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Printing Prolongator ===========&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2655</span>    pattern.print();</div>
<div class="line"><span class="lineno"> 2656</span>    <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2657</span>    _PP[Lev_f]-&gt;update_sparsity_pattern_old(pattern);</div>
<div class="line"><span class="lineno"> 2658</span> </div>
<div class="line"><span class="lineno"> 2659</span><span class="comment">//=========== VALUES ===================</span></div>
<div class="line"><span class="lineno"> 2660</span>    DenseMatrix *valmat;</div>
<div class="line"><span class="lineno"> 2661</span>    std::vector&lt;uint&gt; tmp(1);</div>
<div class="line"><span class="lineno"> 2662</span>   <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) { </div>
<div class="line"><span class="lineno"> 2663</span>       <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ivar=0;ivar &lt; mysys-&gt;_dofmap._nvars[fe];ivar++) {</div>
<div class="line"><span class="lineno"> 2664</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=ml_init[fe]; i&lt;ml_init[fe] + ml[fe]; i++) {</div>
<div class="line"><span class="lineno"> 2665</span>          <span class="keywordtype">int</span> dof_pos_f;</div>
<div class="line"><span class="lineno"> 2666</span>          <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)        dof_pos_f = mysys-&gt;GetMLProb().GetMeshTwo()._Qnode_lev_Qnode_fine[ FEXLevel_f[fe] ][ i ];  <span class="comment">//end fe &lt; ql</span></div>
<div class="line"><span class="lineno"> 2667</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  dof_pos_f = i;</div>
<div class="line"><span class="lineno"> 2668</span> </div>
<div class="line"><span class="lineno"> 2669</span>          <span class="keywordtype">int</span> irow  = mysys-&gt;_dofmap.GetDof(Lev_f,fe,ivar,dof_pos_f);</div>
<div class="line"><span class="lineno"> 2670</span> </div>
<div class="line"><span class="lineno"> 2671</span>            <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ncol = len[fe][i+1]-len[fe][i];</div>
<div class="line"><span class="lineno"> 2672</span>            tmp[0] = irow;</div>
<div class="line"><span class="lineno"> 2673</span>            std::vector&lt; uint&gt; ind(pattern[irow].size()-1);</div>
<div class="line"><span class="lineno"> 2674</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;ind.size(); <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) ind[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = pattern[irow][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 2675</span>            valmat = <span class="keyword">new</span> DenseMatrix(1,ncol);</div>
<div class="line"><span class="lineno"> 2676</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;ncol; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++)(*valmat)(0,<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) = Prol_val[fe][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>+len[fe][i]];</div>
<div class="line"><span class="lineno"> 2677</span>            <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2678</span>        _PP[Lev_f]-&gt;add_matrix(*valmat,tmp,ind);</div>
<div class="line"><span class="lineno"> 2679</span>            <span class="keyword">delete</span>  valmat;</div>
<div class="line"><span class="lineno"> 2680</span>        }</div>
<div class="line"><span class="lineno"> 2681</span>     }</div>
<div class="line"><span class="lineno"> 2682</span>   }  <span class="comment">//end fe</span></div>
<div class="line"><span class="lineno"> 2683</span> </div>
<div class="line"><span class="lineno"> 2684</span> </div>
<div class="line"><span class="lineno"> 2685</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 2686</span>        <span class="keyword">delete</span> [] Prol_val[fe];</div>
<div class="line"><span class="lineno"> 2687</span>        <span class="keyword">delete</span> [] Prol_pos[fe];</div>
<div class="line"><span class="lineno"> 2688</span>        <span class="keyword">delete</span> [] len[fe];</div>
<div class="line"><span class="lineno"> 2689</span>        <span class="keyword">delete</span> [] lenoff[fe];</div>
<div class="line"><span class="lineno"> 2690</span>    }</div>
<div class="line"><span class="lineno"> 2691</span> </div>
<div class="line"><span class="lineno"> 2692</span>    <span class="keyword">delete</span> [] Prol_val;</div>
<div class="line"><span class="lineno"> 2693</span>    <span class="keyword">delete</span> [] Prol_pos;</div>
<div class="line"><span class="lineno"> 2694</span>    <span class="keyword">delete</span> [] len;</div>
<div class="line"><span class="lineno"> 2695</span>    <span class="keyword">delete</span> [] lenoff;</div>
<div class="line"><span class="lineno"> 2696</span> </div>
<div class="line"><span class="lineno"> 2697</span>    pattern.clear();</div>
<div class="line"><span class="lineno"> 2698</span> </div>
<div class="line"><span class="lineno"> 2699</span>    <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2700</span>    _PP[Lev_f]-&gt;close();</div>
<div class="line"><span class="lineno"> 2701</span><span class="comment">//     if (mysys-&gt;GetMLProb().GetMeshTwo()._iproc==0) _Prl[  Lev_f ]-&gt;print_personal();</span></div>
<div class="line"><span class="lineno"> 2702</span><span class="comment">//     _Prl[  Lev_f ]-&gt;print_graphic(false); //TODO should pass this true or false as a parameter</span></div>
<div class="line"><span class="lineno"> 2703</span>   } <span class="comment">//end levels</span></div>
<div class="line"><span class="lineno"> 2704</span>    </div>
<div class="line"><span class="lineno"> 2705</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno"> 2706</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; ReadProl(B): read Op &quot;</span> &lt;&lt; name.c_str() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2707</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2708</span> </div>
<div class="line"><span class="lineno"> 2709</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2710</span>}</div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a37997ccf132703dfabf7bead831f6f38" name="a37997ccf132703dfabf7bead831f6f38"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37997ccf132703dfabf7bead831f6f38">&#9670;&#160;</a></span>ReadRest()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ReadRest </td>
          <td>(</td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_system_two.html">SystemTwo</a> *&#160;</td>
          <td class="paramname"><em>mysys</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l02736">2736</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2736</span>                                                               {</div>
<div class="line"><span class="lineno"> 2737</span> </div>
<div class="line"><span class="lineno"> 2738</span>  vector &lt; SparseMatrix* &gt; &amp;_RR = mysys-&gt;GetRestrictionMatrix(); <span class="comment">//added by Eugenio TO BE TESTED</span></div>
<div class="line"><span class="lineno"> 2739</span>  </div>
<div class="line"><span class="lineno"> 2740</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Level = 0; Level&lt; mysys-&gt;GetGridn() - 1; Level++) {</div>
<div class="line"><span class="lineno"> 2741</span>    </div>
<div class="line"><span class="lineno"> 2742</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Lev_c = Level;</div>
<div class="line"><span class="lineno"> 2743</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Lev_f = Level+1;</div>
<div class="line"><span class="lineno"> 2744</span>    </div>
<div class="line"><span class="lineno"> 2745</span>    std::ostringstream groupname_lev; groupname_lev &lt;&lt;  <span class="stringliteral">&quot;LEVEL&quot;</span> &lt;&lt; Lev_f &lt;&lt; <span class="stringliteral">&quot;_&quot;</span> &lt;&lt; Lev_c;</div>
<div class="line"><span class="lineno"> 2746</span>   </div>
<div class="line"><span class="lineno"> 2747</span>    <span class="keywordtype">int</span>** rowcln;</div>
<div class="line"><span class="lineno"> 2748</span>    <span class="keywordtype">int</span>** len;</div>
<div class="line"><span class="lineno"> 2749</span>    <span class="keywordtype">int</span>** lenoff;</div>
<div class="line"><span class="lineno"> 2750</span>    <span class="keywordtype">int</span>** Rest_pos;</div>
<div class="line"><span class="lineno"> 2751</span>    <span class="keywordtype">double</span>** Rest_val;</div>
<div class="line"><span class="lineno"> 2752</span> </div>
<div class="line"><span class="lineno"> 2753</span>    rowcln   = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2754</span>    len      = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2755</span>    lenoff   = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2756</span>    Rest_pos = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2757</span>    Rest_val = <span class="keyword">new</span> <span class="keywordtype">double</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2758</span> </div>
<div class="line"><span class="lineno"> 2759</span>        hid_t  file = H5Fopen(name.c_str(),H5F_ACC_RDWR, H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2760</span> </div>
<div class="line"><span class="lineno"> 2761</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 2762</span> </div>
<div class="line"><span class="lineno"> 2763</span>        std::ostringstream fe_family;</div>
<div class="line"><span class="lineno"> 2764</span>        fe_family &lt;&lt;  <span class="stringliteral">&quot;_F&quot;</span> &lt;&lt; fe;</div>
<div class="line"><span class="lineno"> 2765</span> </div>
<div class="line"><span class="lineno"> 2766</span>        <span class="comment">//==== DIM ========</span></div>
<div class="line"><span class="lineno"> 2767</span>        std::ostringstream name0;</div>
<div class="line"><span class="lineno"> 2768</span>        name0 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;DIM&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2769</span>        rowcln[fe]= <span class="keyword">new</span> <span class="keywordtype">int</span>[2];</div>
<div class="line"><span class="lineno"> 2770</span>        hid_t dataset = H5Dopen(file, name0.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2771</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,rowcln[fe]);</div>
<div class="line"><span class="lineno"> 2772</span>        <span class="keywordtype">int</span> nrow=rowcln[fe][0];</div>
<div class="line"><span class="lineno"> 2773</span>        <span class="comment">//===== LEN =======</span></div>
<div class="line"><span class="lineno"> 2774</span>        std::ostringstream name2;</div>
<div class="line"><span class="lineno"> 2775</span>        name2 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;LEN&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2776</span>        len[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[nrow+1];</div>
<div class="line"><span class="lineno"> 2777</span>        dataset = H5Dopen(file,name2.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2778</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,len[fe]);</div>
<div class="line"><span class="lineno"> 2779</span>        <span class="comment">//==== OFFLEN ========</span></div>
<div class="line"><span class="lineno"> 2780</span>        std::ostringstream name3;</div>
<div class="line"><span class="lineno"> 2781</span>        name3 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;OFFLEN&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2782</span>        lenoff[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[nrow+1];</div>
<div class="line"><span class="lineno"> 2783</span>        dataset = H5Dopen(file,name3.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2784</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,lenoff[fe]);</div>
<div class="line"><span class="lineno"> 2785</span>        <span class="comment">//===== POS =======</span></div>
<div class="line"><span class="lineno"> 2786</span>        std::ostringstream name1;</div>
<div class="line"><span class="lineno"> 2787</span>        name1 &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;POS&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2788</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> count3 = len[fe][nrow];</div>
<div class="line"><span class="lineno"> 2789</span>        Rest_pos[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[count3];</div>
<div class="line"><span class="lineno"> 2790</span>        dataset = H5Dopen(file,name1.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2791</span>        H5Dread(dataset,H5T_NATIVE_INT,H5S_ALL,H5S_ALL,H5P_DEFAULT,Rest_pos[fe]);</div>
<div class="line"><span class="lineno"> 2792</span>        <span class="comment">//===== VAL =======</span></div>
<div class="line"><span class="lineno"> 2793</span>        std::ostringstream name1b;</div>
<div class="line"><span class="lineno"> 2794</span>        name1b &lt;&lt; groupname_lev.str() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;VAL&quot;</span> &lt;&lt; fe_family.str();</div>
<div class="line"><span class="lineno"> 2795</span>        Rest_val[fe] = <span class="keyword">new</span> <span class="keywordtype">double</span>[count3];</div>
<div class="line"><span class="lineno"> 2796</span>        dataset = H5Dopen(file,name1b.str().c_str(), H5P_DEFAULT);</div>
<div class="line"><span class="lineno"> 2797</span>        H5Dread(dataset,H5T_NATIVE_DOUBLE,H5S_ALL,H5S_ALL,H5P_DEFAULT,Rest_val[fe]);</div>
<div class="line"><span class="lineno"> 2798</span> </div>
<div class="line"><span class="lineno"> 2799</span>    }</div>
<div class="line"><span class="lineno"> 2800</span>    </div>
<div class="line"><span class="lineno"> 2801</span>        H5Fclose(file);</div>
<div class="line"><span class="lineno"> 2802</span> </div>
<div class="line"><span class="lineno"> 2803</span><span class="comment">//======= From here on the EQUATION comes into play, because we have to take into account</span></div>
<div class="line"><span class="lineno"> 2804</span><span class="comment">// the number of variables of every FE type</span></div>
<div class="line"><span class="lineno"> 2805</span><span class="comment">//TODO if you watch carefully, you see that the COARSE levels are EXTENDED,</span></div>
<div class="line"><span class="lineno"> 2806</span><span class="comment">// while the FINE LEVELS never risk to be &quot;extended&quot;, the maximum for them is (mysys-&gt;GetGridn()-1) !</span></div>
<div class="line"><span class="lineno"> 2807</span>    </div>
<div class="line"><span class="lineno"> 2808</span>        <span class="keywordtype">int</span> FEXLevel_c[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2809</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level;                                 <span class="comment">//COARSE Level for QUADRATIC</span></div>
<div class="line"><span class="lineno"> 2810</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = (mysys-&gt;GetGridn() + Level)%(mysys-&gt;GetGridn() + 1);   <span class="comment">//COARSE Level for LINEAR: Level1=0 means coarse linear, a finer linear is the first coarse quadratic, and so on and so on</span></div>
<div class="line"><span class="lineno"> 2811</span>        FEXLevel_c[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level;                                 <span class="comment">//COARSE Level for CONSTANT</span></div>
<div class="line"><span class="lineno"> 2812</span>        <span class="keywordtype">int</span> FEXLevel_f[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2813</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>] = Level+1;                                  <span class="comment">//FINE Level for QUADRATIC</span></div>
<div class="line"><span class="lineno"> 2814</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>] = Level;                                <span class="comment">// AAA look at the symmetry, this is exactly (_n_levels + Level1 + 1)%(_n_levels + 1); ! //FINE Level for LINEAR:   Level1=0 means coarse linear, a finer linear is the first coarse quadratic, and so on and so on</span></div>
<div class="line"><span class="lineno"> 2815</span>        FEXLevel_f[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>] = Level+1;                                  <span class="comment">//FINE Level for CONSTANT</span></div>
<div class="line"><span class="lineno"> 2816</span> </div>
<div class="line"><span class="lineno"> 2817</span>    <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> off_proc=mysys-&gt;GetGridn()*mysys-&gt;GetMLProb().GetMeshTwo()._iproc;</div>
<div class="line"><span class="lineno"> 2818</span> </div>
<div class="line"><span class="lineno"> 2819</span>    <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2820</span>    _RR[Lev_c] = <a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a350a92495af225cec7b898b9fe29d9d2">SparseMatrix::build</a>().release();</div>
<div class="line"><span class="lineno"> 2821</span><span class="comment">// // //     _Rst[Lev_c]-&gt;init(0,0,0,0);   //TODO BACK TO A REASONABLE INIT  //we have to do this before appropriately!!!</span></div>
<div class="line"><span class="lineno"> 2822</span> </div>
<div class="line"><span class="lineno"> 2823</span>    <span class="keywordtype">int</span> nrowt=0;<span class="keywordtype">int</span> nclnt=0;</div>
<div class="line"><span class="lineno"> 2824</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 2825</span>      nrowt += mysys-&gt;_dofmap._nvars[fe]*rowcln[fe][0];</div>
<div class="line"><span class="lineno"> 2826</span>          nclnt += mysys-&gt;_dofmap._nvars[fe]*rowcln[fe][1];</div>
<div class="line"><span class="lineno"> 2827</span>    }</div>
<div class="line"><span class="lineno"> 2828</span> </div>
<div class="line"><span class="lineno"> 2829</span> </div>
<div class="line"><span class="lineno"> 2830</span>    Graph pattern;</div>
<div class="line"><span class="lineno"> 2831</span>    pattern.resize(nrowt);</div>
<div class="line"><span class="lineno"> 2832</span>    pattern._m  = nrowt;</div>
<div class="line"><span class="lineno"> 2833</span>    pattern._n  = nclnt;        <span class="comment">// global dim _m x _n</span></div>
<div class="line"><span class="lineno"> 2834</span>    pattern._ml = 0;            <span class="comment">//  local _m</span></div>
<div class="line"><span class="lineno"> 2835</span>    pattern._nl = 0;            <span class="comment">//  local _n</span></div>
<div class="line"><span class="lineno"> 2836</span>     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) { </div>
<div class="line"><span class="lineno"> 2837</span>        pattern._ml += mysys-&gt;_dofmap._nvars[fe]*mysys-&gt;_dofmap._DofLocLevProcFE[Lev_c][mysys-&gt;GetMLProb().GetMeshTwo()._iproc][fe]; </div>
<div class="line"><span class="lineno"> 2838</span>        pattern._nl += mysys-&gt;_dofmap._nvars[fe]*mysys-&gt;_dofmap._DofLocLevProcFE[Lev_f][mysys-&gt;GetMLProb().GetMeshTwo()._iproc][fe];</div>
<div class="line"><span class="lineno"> 2839</span>     } </div>
<div class="line"><span class="lineno"> 2840</span>     </div>
<div class="line"><span class="lineno"> 2841</span>    <span class="comment">// starting indices for local matrix</span></div>
<div class="line"><span class="lineno"> 2842</span>   <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ml_start = mysys-&gt;_dofmap.GetStartDof(Lev_c,off_proc);    <span class="comment">//  offset proc nodes</span></div>
<div class="line"><span class="lineno"> 2843</span>   pattern._ml_start = ml_start;</div>
<div class="line"><span class="lineno"> 2844</span>   <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> DofObjInit_lev_PrevProcs_c[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>];</div>
<div class="line"><span class="lineno"> 2845</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) { DofObjInit_lev_PrevProcs_c[fe] = 0;  }</div>
<div class="line"><span class="lineno"> 2846</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) { </div>
<div class="line"><span class="lineno"> 2847</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> isubd=0;isubd&lt;mysys-&gt;GetMLProb().GetMeshTwo().<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a>; isubd++) { <span class="comment">//up to the current processor</span></div>
<div class="line"><span class="lineno"> 2848</span>       <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)       <span class="comment">/*mlinit*/</span> DofObjInit_lev_PrevProcs_c[fe] += mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][ isubd*mysys-&gt;GetGridn() + Lev_c +1 ]  - mysys-&gt;GetMLProb().GetMeshTwo()._off_nd[fe][isubd*mysys-&gt;GetGridn()];  </div>
<div class="line"><span class="lineno"> 2849</span>       <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>) <span class="comment">/*mlinit*/</span> DofObjInit_lev_PrevProcs_c[fe] += mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][ isubd*mysys-&gt;GetGridn() + Lev_c +1 ]  - mysys-&gt;GetMLProb().GetMeshTwo()._off_el[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][isubd*mysys-&gt;GetGridn() + Lev_c];   </div>
<div class="line"><span class="lineno"> 2850</span>         }</div>
<div class="line"><span class="lineno"> 2851</span>     }</div>
<div class="line"><span class="lineno"> 2852</span> </div>
<div class="line"><span class="lineno"> 2853</span>    <span class="comment">//============= POSITION =========</span></div>
<div class="line"><span class="lineno"> 2854</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0; fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++) { </div>
<div class="line"><span class="lineno"> 2855</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ivar=0;ivar&lt;mysys-&gt;_dofmap._nvars[fe];ivar++) {</div>
<div class="line"><span class="lineno"> 2856</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = DofObjInit_lev_PrevProcs_c[fe]; i&lt; DofObjInit_lev_PrevProcs_c[fe] + mysys-&gt;_dofmap._DofLocLevProcFE[Lev_c][mysys-&gt;GetMLProb().GetMeshTwo().<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a>][fe]; i++) {</div>
<div class="line"><span class="lineno"> 2857</span>      <span class="keywordtype">int</span> dof_pos_c;</div>
<div class="line"><span class="lineno"> 2858</span>          <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)         dof_pos_c = mysys-&gt;GetMLProb().GetMeshTwo()._Qnode_lev_Qnode_fine[ FEXLevel_c[fe] ][ i ];</div>
<div class="line"><span class="lineno"> 2859</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)   dof_pos_c = i;</div>
<div class="line"><span class="lineno"> 2860</span>      </div>
<div class="line"><span class="lineno"> 2861</span>            <span class="keywordtype">int</span> irow  = mysys-&gt;_dofmap.GetDof(Lev_c,fe,ivar,dof_pos_c);</div>
<div class="line"><span class="lineno"> 2862</span> </div>
<div class="line"><span class="lineno"> 2863</span>        <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ncol = len[fe][i+1]-len[fe][i];</div>
<div class="line"><span class="lineno"> 2864</span>            <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> noff = lenoff[fe][i+1] - lenoff[fe][i];</div>
<div class="line"><span class="lineno"> 2865</span>            pattern[irow].resize(ncol+1);  <span class="comment">//when you do resize, it puts a zero in all positions</span></div>
<div class="line"><span class="lineno"> 2866</span>        pattern[irow][ncol] = noff;</div>
<div class="line"><span class="lineno"> 2867</span><span class="comment">// pattern structure (was for laspack only)</span></div>
<div class="line"><span class="lineno"> 2868</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;ncol; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 2869</span>          <span class="keywordtype">int</span> dof_pos_lev_f = Rest_pos[fe][ <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>+len[fe][i] ];</div>
<div class="line"><span class="lineno"> 2870</span>          <span class="keywordtype">int</span> dof_pos_f;</div>
<div class="line"><span class="lineno"> 2871</span>    </div>
<div class="line"><span class="lineno"> 2872</span>          <span class="keywordflow">if</span>      (fe  &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  dof_pos_f = mysys-&gt;GetMLProb().GetMeshTwo()._Qnode_lev_Qnode_fine[ FEXLevel_f[fe] ][ dof_pos_lev_f ];</div>
<div class="line"><span class="lineno"> 2873</span>              <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)  dof_pos_f = dof_pos_lev_f;</div>
<div class="line"><span class="lineno"> 2874</span>              pattern[irow][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = mysys-&gt;_dofmap.GetDof(Lev_f,fe,ivar,dof_pos_f);</div>
<div class="line"><span class="lineno"> 2875</span>                }</div>
<div class="line"><span class="lineno"> 2876</span> </div>
<div class="line"><span class="lineno"> 2877</span>              }</div>
<div class="line"><span class="lineno"> 2878</span>           }</div>
<div class="line"><span class="lineno"> 2879</span>    } <span class="comment">//end fe loop</span></div>
<div class="line"><span class="lineno"> 2880</span> </div>
<div class="line"><span class="lineno"> 2881</span> </div>
<div class="line"><span class="lineno"> 2882</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Printing Restrictor ===========&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2883</span>    pattern.print();</div>
<div class="line"><span class="lineno"> 2884</span>    <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2885</span>    _RR[Lev_c]-&gt;update_sparsity_pattern_old(pattern);  <span class="comment">//TODO see </span></div>
<div class="line"><span class="lineno"> 2886</span><span class="comment">//         _Rst[Lev_c]-&gt;close();</span></div>
<div class="line"><span class="lineno"> 2887</span><span class="comment">//     if (mysys-&gt;GetMLProb().GetMeshTwo()._iproc==0) _Rst[Lev_c]-&gt;print_personal(); //there is no print function for rectangular matrices, and print_personal doesnt seem to be working...</span></div>
<div class="line"><span class="lineno"> 2888</span><span class="comment">// la print stampa il contenuto, ma io voglio solo stampare lo sparsity pattern!</span></div>
<div class="line"><span class="lineno"> 2889</span>     <span class="comment">//Allora cosa faccio: riempio di zeri e poi la stampo! No, di zeri no!!! devi riempirla con qualcos&#39;altro!</span></div>
<div class="line"><span class="lineno"> 2890</span><span class="comment">//TODO how can I print the sparsity pattern in Petsc BEFORE FILLING the MATRIX ?!?!</span></div>
<div class="line"><span class="lineno"> 2891</span>    <span class="comment">//==============================</span></div>
<div class="line"><span class="lineno"> 2892</span><span class="comment">//========= SET VALUES =========</span></div>
<div class="line"><span class="lineno"> 2893</span><span class="comment">//==============================</span></div>
<div class="line"><span class="lineno"> 2894</span> </div>
<div class="line"><span class="lineno"> 2895</span>    DenseMatrix *valmat;</div>
<div class="line"><span class="lineno"> 2896</span>    std::vector&lt;uint&gt; tmp(1);</div>
<div class="line"><span class="lineno"> 2897</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 2898</span> </div>
<div class="line"><span class="lineno"> 2899</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ivar=0;ivar&lt;mysys-&gt;_dofmap._nvars[fe];ivar++) {</div>
<div class="line"><span class="lineno"> 2900</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = DofObjInit_lev_PrevProcs_c[fe]; i&lt; DofObjInit_lev_PrevProcs_c[fe] + mysys-&gt;_dofmap._DofLocLevProcFE[Lev_c][mysys-&gt;GetMLProb().GetMeshTwo().<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2073adff4b7add5f6d88efa9d725bb35">_iproc</a>][fe]; i++) {</div>
<div class="line"><span class="lineno"> 2901</span>      <span class="keywordtype">int</span> dof_pos_c;</div>
<div class="line"><span class="lineno"> 2902</span>          <span class="keywordflow">if</span> (fe &lt; <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)         dof_pos_c = mysys-&gt;GetMLProb().GetMeshTwo()._Qnode_lev_Qnode_fine[ FEXLevel_c[fe] ][ i ];</div>
<div class="line"><span class="lineno"> 2903</span>          <span class="keywordflow">else</span> <span class="keywordflow">if</span> (fe == <a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba886f39d2f1a5889032091a8a4244f451">KK</a>)   dof_pos_c = i;</div>
<div class="line"><span class="lineno"> 2904</span>            <span class="keywordtype">int</span> irow     = mysys-&gt;_dofmap.GetDof(Lev_c,fe,ivar,dof_pos_c);</div>
<div class="line"><span class="lineno"> 2905</span>            <span class="keywordtype">int</span> irow_top = mysys-&gt;_dofmap.GetDof(mysys-&gt;GetGridn()-1,fe,ivar,dof_pos_c);</div>
<div class="line"><span class="lineno"> 2906</span>            <a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ncol = len[fe][i+1]-len[fe][i];</div>
<div class="line"><span class="lineno"> 2907</span>            tmp[0]=irow;</div>
<div class="line"><span class="lineno"> 2908</span>            std::vector&lt; uint&gt; ind(pattern[irow].size()-1);</div>
<div class="line"><span class="lineno"> 2909</span><span class="comment">//      std::cout &lt;&lt; &quot;\n ==== &quot; &lt;&lt; irow &lt;&lt; &quot;: &quot;;</span></div>
<div class="line"><span class="lineno"> 2910</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i1=0;i1&lt;ind.size();i1++) { ind[i1] = pattern[irow][i1]; <span class="comment">/*std::cout &lt;&lt; &quot; &quot; &lt;&lt; ind[i1] &lt;&lt; &quot; &quot;;*/</span>}</div>
<div class="line"><span class="lineno"> 2911</span>            valmat = <span class="keyword">new</span> DenseMatrix(1,ncol);  <span class="comment">//TODO add a matrix row by row...</span></div>
<div class="line"><span class="lineno"> 2912</span>            <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;ncol; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) (*valmat)(0,<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) = mysys-&gt;_bcond._bc[irow_top]*Rest_val[fe][ <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>+len[fe][i] ];</div>
<div class="line"><span class="lineno"> 2913</span>            <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2914</span>        _RR[Lev_c]-&gt;add_matrix(*valmat,tmp,ind);</div>
<div class="line"><span class="lineno"> 2915</span>            <span class="keyword">delete</span>  valmat;</div>
<div class="line"><span class="lineno"> 2916</span>            }<span class="comment">// end dof loop</span></div>
<div class="line"><span class="lineno"> 2917</span>         } <span class="comment">// end var loop</span></div>
<div class="line"><span class="lineno"> 2918</span>       } <span class="comment">//end fe</span></div>
<div class="line"><span class="lineno"> 2919</span> </div>
<div class="line"><span class="lineno"> 2920</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe&lt;<a class="code hl_define" href="_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>;fe++) {</div>
<div class="line"><span class="lineno"> 2921</span>        <span class="keyword">delete</span> [] Rest_val[fe];</div>
<div class="line"><span class="lineno"> 2922</span>        <span class="keyword">delete</span> [] Rest_pos[fe];</div>
<div class="line"><span class="lineno"> 2923</span>        <span class="keyword">delete</span> [] len[fe];</div>
<div class="line"><span class="lineno"> 2924</span>        <span class="keyword">delete</span> [] lenoff[fe];</div>
<div class="line"><span class="lineno"> 2925</span>    }</div>
<div class="line"><span class="lineno"> 2926</span> </div>
<div class="line"><span class="lineno"> 2927</span>    <span class="keyword">delete</span> [] Rest_val;</div>
<div class="line"><span class="lineno"> 2928</span>    <span class="keyword">delete</span> [] Rest_pos;</div>
<div class="line"><span class="lineno"> 2929</span>    <span class="keyword">delete</span> [] len;</div>
<div class="line"><span class="lineno"> 2930</span>    <span class="keyword">delete</span> [] lenoff;</div>
<div class="line"><span class="lineno"> 2931</span> </div>
<div class="line"><span class="lineno"> 2932</span>    pattern.clear();</div>
<div class="line"><span class="lineno"> 2933</span> </div>
<div class="line"><span class="lineno"> 2934</span>    <span class="comment">//mysys-&gt;</span></div>
<div class="line"><span class="lineno"> 2935</span>    _RR[Lev_c]-&gt;close();</div>
<div class="line"><span class="lineno"> 2936</span><span class="comment">//     if (mysys-&gt;GetMLProb().GetMeshTwo()._iproc==0)  _Rst[Lev_c]-&gt;print_personal(std::cout);</span></div>
<div class="line"><span class="lineno"> 2937</span><span class="comment">//     _Rst[Lev_c]-&gt;print_graphic(false); // TODO should pass this true or false as a parameter</span></div>
<div class="line"><span class="lineno"> 2938</span> </div>
<div class="line"><span class="lineno"> 2939</span>  } <span class="comment">//end levels</span></div>
<div class="line"><span class="lineno"> 2940</span>  </div>
<div class="line"><span class="lineno"> 2941</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno"> 2942</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; ReadRest(B): read Op &quot;</span> &lt;&lt; name.c_str() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2943</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno"> 2944</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2945</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adac39ccc5e6781cba188e4b4f1e682fd" name="adac39ccc5e6781cba188e4b4f1e682fd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adac39ccc5e6781cba188e4b4f1e682fd">&#9670;&#160;</a></span>RefineMesh()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::RefineMesh </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l00211">211</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  211</span>                               {</div>
<div class="line"><span class="lineno">  212</span><span class="preprocessor">#ifdef HAVE_LIBMESH</span></div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">  215</span>    std::clock_t start_timeB=std::clock();</div>
<div class="line"><span class="lineno">  216</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\n LibMesh Mesh Refinement ---------  \n&quot;</span>;</div>
<div class="line"><span class="lineno">  219</span>    libMesh::MeshRefinement mesh_refinement(*_msh_all_levs);</div>
<div class="line"><span class="lineno">  220</span>    mesh_refinement.uniformly_refine(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>-1);</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span><span class="preprocessor">#ifdef DEFAULT_PRINT_TIME</span></div>
<div class="line"><span class="lineno">  223</span>    std::clock_t end_timeB=std::clock();</div>
<div class="line"><span class="lineno">  224</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; *+* Generation refined mesh time =&quot;</span></div>
<div class="line"><span class="lineno">  225</span>              &lt;&lt; double(end_timeB- start_timeB) / CLOCKS_PER_SEC &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  226</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span><span class="preprocessor">#endif </span><span class="comment">//end have_libmesh</span></div>
<div class="line"><span class="lineno">  229</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  230</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7dd80e2b843180f82f9c8a11b9114ec5" name="a7dd80e2b843180f82f9c8a11b9114ec5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7dd80e2b843180f82f9c8a11b9114ec5">&#9670;&#160;</a></span>ReorderElementBySubdLev_BB()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ReorderElementBySubdLev_BB </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l02014">2014</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2014</span>                                         {</div>
<div class="line"><span class="lineno"> 2015</span> </div>
<div class="line"><span class="lineno"> 2016</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a>.resize(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>]);</div>
<div class="line"><span class="lineno"> 2017</span> </div>
<div class="line"><span class="lineno"> 2018</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kel=0;kel&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>];kel++) {</div>
<div class="line"><span class="lineno"> 2019</span>        <span class="keywordtype">int</span> isubdom = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[kel]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a>;  <span class="comment">// _el_sto[_el_sto_b[kel]-&gt;_vol_id]-&gt;_subd;  //this is the only difference with VV: you get the SUBDOMAIN from the VOLUME!</span></div>
<div class="line"><span class="lineno"> 2020</span>        <span class="keywordtype">int</span> ilev    = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#afd4c5c12b820008801e667b7701b9165">_el_sto_b</a>[kel]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a21fac1582fea632435a5576ff9a6b6ac">_lev</a>;</div>
<div class="line"><span class="lineno"> 2021</span>        <span class="keywordtype">int</span> rank_sl = ilev+isubdom*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>;</div>
<div class="line"><span class="lineno"> 2022</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcdae244545a383510f5c37378bd2d0b7083">BB</a>][rank_sl]++;</div>
<div class="line"><span class="lineno"> 2023</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a>[kel].first  = rank_sl;</div>
<div class="line"><span class="lineno"> 2024</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a>[kel].second = kel;</div>
<div class="line"><span class="lineno"> 2025</span>    }</div>
<div class="line"><span class="lineno"> 2026</span>    <span class="comment">// std reordering on pairs</span></div>
<div class="line"><span class="lineno"> 2027</span>    std::sort(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a>.begin(),<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a096557dfb03c8fa0173c29beaed36fee">_el_fm_libm_b</a>.end());</div>
<div class="line"><span class="lineno"> 2028</span> </div>
<div class="line"><span class="lineno"> 2029</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2030</span> </div>
<div class="line"><span class="lineno"> 2031</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac8a4b195137869e5aea20553baa8b37d" name="ac8a4b195137869e5aea20553baa8b37d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac8a4b195137869e5aea20553baa8b37d">&#9670;&#160;</a></span>ReorderElementBySubdLev_VV()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ReorderElementBySubdLev_VV </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l01985">1985</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1985</span>                                         {</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>.resize(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>]);  <span class="comment">//every component of this vector is a pair of integers  ==&gt; 3 things</span></div>
<div class="line"><span class="lineno"> 1988</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a6abbf958a300ffd816c2bc7b42652320">_el_libm_fm</a>.resize(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>]);     <span class="comment">//so far I need the INVERSE for the VOLUME ELEMENT LIST, not for the boundary so far</span></div>
<div class="line"><span class="lineno"> 1989</span>    <span class="comment">//==== Volume ==========</span></div>
<div class="line"><span class="lineno"> 1990</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kel=0;kel&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a1cbec4cdab8a318ef1bbf3323cc2c47e">_n_elements_sum_levs</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>];kel++) {</div>
<div class="line"><span class="lineno"> 1991</span>        <span class="comment">// counting (level and subdom)</span></div>
<div class="line"><span class="lineno"> 1992</span>        <span class="keywordtype">int</span> isubd = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[kel]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#ae2a0bc193975b623626a8eb58e549417">_subd</a>;</div>
<div class="line"><span class="lineno"> 1993</span>        <span class="keywordtype">int</span>  ilev = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a15a91978c93fe07eff517d90075301e5">_el_sto</a>[kel]-&gt;<a class="code hl_variable" href="classfemus_1_1_elem_sto_base.html#a21fac1582fea632435a5576ff9a6b6ac">_lev</a>;</div>
<div class="line"><span class="lineno"> 1994</span>        <span class="keywordtype">int</span> rank_sl = ilev + isubd*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>;</div>
<div class="line"><span class="lineno"> 1995</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a8ed8b966375e77f855441b1bc0867c24">_n_elements_sl_vb</a>[<a class="code hl_enumvalue" href="_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>][rank_sl]++;</div>
<div class="line"><span class="lineno"> 1996</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>[kel].first  = rank_sl ;</div>
<div class="line"><span class="lineno"> 1997</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>[kel].second = kel;                                 <span class="comment">//this is the libmesh ordering</span></div>
<div class="line"><span class="lineno"> 1998</span>    }</div>
<div class="line"><span class="lineno"> 1999</span> </div>
<div class="line"><span class="lineno"> 2000</span>    <span class="comment">// std reordering on pairs //pairs are reordered wrt their .FIRST element</span></div>
<div class="line"><span class="lineno"> 2001</span>    std::sort(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>.begin(),<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>.end());</div>
<div class="line"><span class="lineno"> 2002</span> </div>
<div class="line"><span class="lineno"> 2003</span>    <span class="comment">//====== INVERSE Volume Elements ===========</span></div>
<div class="line"><span class="lineno"> 2004</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i = 0; i &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>.size(); i++)  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a6abbf958a300ffd816c2bc7b42652320">_el_libm_fm</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a3078cd94966a22672df6b24d24fdcd60">_el_fm_libm</a>[i].second] = i;</div>
<div class="line"><span class="lineno"> 2005</span> </div>
<div class="line"><span class="lineno"> 2006</span> </div>
<div class="line"><span class="lineno"> 2007</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2008</span> </div>
<div class="line"><span class="lineno"> 2009</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2c8dce7f34c3d4331c677c224d601fe2" name="a2c8dce7f34c3d4331c677c224d601fe2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2c8dce7f34c3d4331c677c224d601fe2">&#9670;&#160;</a></span>ReorderNodesBySubdLev()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::GenCase::ReorderNodesBySubdLev </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8cpp_source.html#l02036">2036</a> of file <a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 2036</span>                                    {</div>
<div class="line"><span class="lineno"> 2037</span> </div>
<div class="line"><span class="lineno"> 2038</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a>     = <span class="keyword">new</span> <span class="keywordtype">int</span>*[<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ab87a71ae1c1c9cc1d6ec5dfb857153f2">QL_NODES</a>];</div>
<div class="line"><span class="lineno"> 2039</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> fe=0;fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#ab87a71ae1c1c9cc1d6ec5dfb857153f2">QL_NODES</a>; fe++) {</div>
<div class="line"><span class="lineno"> 2040</span>        <span class="keywordtype">int</span> offdim2 = <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a345e33af17ea0c184dbf07285bb17d31">_NoSubdom</a>*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+1;</div>
<div class="line"><span class="lineno"> 2041</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a>[fe] = <span class="keyword">new</span> <span class="keywordtype">int</span>[offdim2];</div>
<div class="line"><span class="lineno"> 2042</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;offdim2; i++)      <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a>[fe][i]=0;</div>
<div class="line"><span class="lineno"> 2043</span>    }</div>
<div class="line"><span class="lineno"> 2044</span> </div>
<div class="line"><span class="lineno"> 2045</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>.resize(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>);                        <span class="comment">//every component of this vector is a pair of integers (some_rank_to_give_an_order, libmesh_index)</span></div>
<div class="line"><span class="lineno"> 2046</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>.resize(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>);                       <span class="comment">//the new numbering in the desired P-L ordering</span></div>
<div class="line"><span class="lineno"> 2047</span> </div>
<div class="line"><span class="lineno"> 2048</span>    <span class="comment">// -----------------------------------------------</span></div>
<div class="line"><span class="lineno"> 2049</span>    <span class="comment">// REORDERING NODES (subdom&gt;lev&gt;levP&gt;var)</span></div>
<div class="line"><span class="lineno"> 2050</span>    <span class="comment">// -----------------------------------------------</span></div>
<div class="line"><span class="lineno"> 2051</span>    <span class="comment">//since the mesh is QUADRATIC and we also want to track COARSE LINEAR nodes, it&#39;s like thinking of an ADDITIONAL LEVEL</span></div>
<div class="line"><span class="lineno"> 2052</span>    <span class="comment">// 1 + LP + (NL+1)(L + NL*SUBD)</span></div>
<div class="line"><span class="lineno"> 2053</span>    <span class="keywordtype">int</span> n_variables=1;</div>
<div class="line"><span class="lineno"> 2054</span>    <span class="keywordtype">int</span> n_nodes_0p=0;</div>
<div class="line"><span class="lineno"> 2055</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> knode=0;knode&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2befae1f6286793dd66b614987eff74c">_n_nodes</a>;knode++) {</div>
<div class="line"><span class="lineno"> 2056</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a>[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>][<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;<a class="code hl_variable" href="classfemus_1_1_node_sto.html#a8d90125bc244fb501d8426d43c7c6d69">_subd</a> + <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;<a class="code hl_variable" href="classfemus_1_1_node_sto.html#aeae85ae14a0a2a278636046579b084c2">_lev</a>]++;   <span class="comment">//order by quadratic rank</span></div>
<div class="line"><span class="lineno"> 2057</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;_levp &lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>)    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a2aa71c7d2a8aaf40ef6b28c0606cf7fe">_n_nodes_sl_ql</a>[<a class="code hl_enumvalue" href="_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>][<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;<a class="code hl_variable" href="classfemus_1_1_node_sto.html#a8d90125bc244fb501d8426d43c7c6d69">_subd</a> + <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;<a class="code hl_variable" href="classfemus_1_1_node_sto.html#a93d77191ef3021338e383cc7c8b1bc3b">_levp</a>]++;</div>
<div class="line"><span class="lineno"> 2058</span>        <span class="keywordflow">if</span> (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;_levp == 0)    n_nodes_0p++;</div>
<div class="line"><span class="lineno"> 2059</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> klev=<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;_lev;klev&lt;<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>;klev++) <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>[klev]++;  <span class="comment">// a node contributes to its level and all the finer</span></div>
<div class="line"><span class="lineno"> 2060</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>[knode].first= <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;<a class="code hl_variable" href="classfemus_1_1_node_sto.html#a35bd418878c1058f42bdd33d03271e6b">_var</a></div>
<div class="line"><span class="lineno"> 2061</span>                                  + n_variables*(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;<a class="code hl_variable" href="classfemus_1_1_node_sto.html#a93d77191ef3021338e383cc7c8b1bc3b">_levp</a> + (<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>+1)*(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;_lev + <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a4324ce4d34f7d71cd37e19c271a416fc">_nd_sto</a>[knode]-&gt;_subd)); <span class="comment">//rank</span></div>
<div class="line"><span class="lineno"> 2062</span>        <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>[knode].second=knode;         <span class="comment">//libmesh ordering value</span></div>
<div class="line"><span class="lineno"> 2063</span>    }</div>
<div class="line"><span class="lineno"> 2064</span>    <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#ab974278587f62066f8747ed734f438c7">_NoNodesXLev</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>]= n_nodes_0p;</div>
<div class="line"><span class="lineno"> 2065</span> </div>
<div class="line"><span class="lineno"> 2066</span>    <span class="comment">// std reordering on pairs</span></div>
<div class="line"><span class="lineno"> 2067</span>    sort(<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>.begin(),<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>.end());   <span class="comment">//FROM NOW ON, nodes are ordered in this way</span></div>
<div class="line"><span class="lineno"> 2068</span>    <span class="comment">//if i want to retrieve info about a node,  v[knode].second gives me the libmesh node ordering... BUT,</span></div>
<div class="line"><span class="lineno"> 2069</span>    <span class="comment">//the point is that _nd_sto is not used later on</span></div>
<div class="line"><span class="lineno"> 2070</span>    <span class="comment">//so, nd_libm_fm RECEIVES the libmesh ordering and YIELDS the FEMUS ordering</span></div>
<div class="line"><span class="lineno"> 2071</span>    <span class="comment">//while for elements it is not important to store the femus index, with nodes we have to</span></div>
<div class="line"><span class="lineno"> 2072</span>    <span class="comment">// nodes must be ordered some way, they are the dofs!</span></div>
<div class="line"><span class="lineno"> 2073</span>    <span class="comment">//element connectivities can be order whatever you want</span></div>
<div class="line"><span class="lineno"> 2074</span> </div>
<div class="line"><span class="lineno"> 2075</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> i = 0; i &lt; <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>.size(); i++)  <a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#a5c4d7084bf63a5fd8b3ee38ec667dd79">_nd_libm_fm</a>[<a class="code hl_variable" href="classfemus_1_1_multi_level_mesh_two.html#aca0f0af0223841f4cf9b306fdb2e3462">_nd_fm_libm</a>[i].second] = i;  <span class="comment">//you start numbering from zero   //TODO we could overwrite v[i].first = i, without using nd_libm_fm, we dont need the rank later on</span></div>
<div class="line"><span class="lineno"> 2076</span> </div>
<div class="line"><span class="lineno"> 2077</span> </div>
<div class="line"><span class="lineno"> 2078</span><span class="comment">//given this node numbering, you can later fill the coords also</span></div>
<div class="line"><span class="lineno"> 2079</span> </div>
<div class="line"><span class="lineno"> 2080</span><span class="comment">// el_fm_libm[kel].second receives the femus index and yields the libmesh index</span></div>
<div class="line"><span class="lineno"> 2081</span><span class="comment">// if you want the opposite just do a v_inv_el exactly like nd_libm_fm: this might be good for cell dofs!</span></div>
<div class="line"><span class="lineno"> 2082</span> </div>
<div class="line"><span class="lineno"> 2083</span><span class="comment">//nd_libm_fm[i]       receives the libmesh index and yields the femus index</span></div>
<div class="line"><span class="lineno"> 2084</span><span class="comment">// v[i].second      receives the femus index and yields the libmesh index</span></div>
<div class="line"><span class="lineno"> 2085</span> </div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2088</span> </div>
<div class="line"><span class="lineno"> 2089</span>}</div>
<div class="ttc" id="aclassfemus_1_1_node_sto_html_a35bd418878c1058f42bdd33d03271e6b"><div class="ttname"><a href="classfemus_1_1_node_sto.html#a35bd418878c1058f42bdd33d03271e6b">femus::NodeSto::_var</a></div><div class="ttdeci">int _var</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00102">ElemSto.hpp:102</a></div></div>
<div class="ttc" id="aclassfemus_1_1_node_sto_html_a8d90125bc244fb501d8426d43c7c6d69"><div class="ttname"><a href="classfemus_1_1_node_sto.html#a8d90125bc244fb501d8426d43c7c6d69">femus::NodeSto::_subd</a></div><div class="ttdeci">int _subd</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00100">ElemSto.hpp:100</a></div></div>
<div class="ttc" id="aclassfemus_1_1_node_sto_html_a93d77191ef3021338e383cc7c8b1bc3b"><div class="ttname"><a href="classfemus_1_1_node_sto.html#a93d77191ef3021338e383cc7c8b1bc3b">femus::NodeSto::_levp</a></div><div class="ttdeci">int _levp</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00101">ElemSto.hpp:101</a></div></div>
<div class="ttc" id="aclassfemus_1_1_node_sto_html_aeae85ae14a0a2a278636046579b084c2"><div class="ttname"><a href="classfemus_1_1_node_sto.html#aeae85ae14a0a2a278636046579b084c2">femus::NodeSto::_lev</a></div><div class="ttdeci">int _lev</div><div class="ttdef"><b>Definition</b> <a href="_elem_sto_8hpp_source.html#l00099">ElemSto.hpp:99</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Field Documentation</h2>
<a id="a17c27a66dbb43c45aacf26cc204e6892" name="a17c27a66dbb43c45aacf26cc204e6892"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17c27a66dbb43c45aacf26cc204e6892">&#9670;&#160;</a></span>_feelems</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt;<a class="el" href="classfemus_1_1_geom_elem_base.html">GeomElemBase</a>*&gt; femus::GenCase::_feelems</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="_gen_case_8hpp_source.html#l00066">66</a> of file <a class="el" href="_gen_case_8hpp_source.html">GenCase.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/src/02_mesh/gencase/<a class="el" href="_gen_case_8hpp_source.html">GenCase.hpp</a></li>
<li>C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/src/02_mesh/gencase/<a class="el" href="_gen_case_8cpp_source.html">GenCase.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="namespacefemus.html">femus</a></li><li class="navelem"><a class="el" href="classfemus_1_1_gen_case.html">GenCase</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
