<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/applications/OptimalControl/04_solidopt/02_solid_control_lifting/02_solid_control_lifting.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('02__solid__control__lifting_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">02_solid_control_lifting.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_numeric_vector_8hpp_source.html">NumericVector.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_g_m_v_writer_8hpp_source.html">GMVWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_non_linear_implicit_system_8hpp_source.html">NonLinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;adept.h&quot;</code><br />
<code>#include &quot;<a class="el" href="_linear_implicit_system_8hpp_source.html">LinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_parameter_8hpp_source.html">Parameter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="paral_8hpp_source.html">paral.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_fluid_8hpp_source.html">Fluid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_solid_8hpp_source.html">Solid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_files_8hpp_source.html">Files.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_assemble__jacobian_8hpp_source.html">Assemble_jacobian.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="solidopt__params_8hpp_source.html">../solidopt_params.hpp</a>&quot;</code><br />
</div>
<p><a href="02__solid__control__lifting_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_solution__generation__1.html">Solution_generation_1&lt; real_num &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5dec9191b407f5f1913e563b23777741"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a> (const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</td></tr>
<tr class="separator:a5dec9191b407f5f1913e563b23777741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1afc17d1ddb3752caf6910ec9a7c39ef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a> (const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *ml_prob, const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:a1afc17d1ddb3752caf6910ec9a7c39ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea610d910b5d696b3e500ed9636d8367"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:aea610d910b5d696b3e500ed9636d8367"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#aea610d910b5d696b3e500ed9636d8367">AssembleSolidMech</a> (<a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:aea610d910b5d696b3e500ed9636d8367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96a01d4289cc795fc7506b8b67ba84bc"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:a96a01d4289cc795fc7506b8b67ba84bc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#a96a01d4289cc795fc7506b8b67ba84bc">AssembleSolidMech</a> (<a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob, const <a class="el" href="classfemus_1_1_solid.html">Solid</a> &amp;solid_in, system_type *mlPdeSys, const std::vector&lt; <a class="el" href="namespacefemus.html#classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns)</td></tr>
<tr class="separator:a96a01d4289cc795fc7506b8b67ba84bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b2e165d5cf19933c60a49927c5bf64"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:ad6b2e165d5cf19933c60a49927c5bf64"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#ad6b2e165d5cf19933c60a49927c5bf64">ComputeIntegral</a> (const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:ad6b2e165d5cf19933c60a49927c5bf64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b4961693657f83b36edc7f4e2e17de6"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:a2b4961693657f83b36edc7f4e2e17de6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#a2b4961693657f83b36edc7f4e2e17de6">ComputeIntegral</a> (const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob, const system_type *mlPdeSys, const std::vector&lt; <a class="el" href="namespacefemus.html#classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns)</td></tr>
<tr class="separator:a2b4961693657f83b36edc7f4e2e17de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6917621ec8f1cbd9eda71cf3f12de89c"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="namespacefemus.html#classfemus_1_1_unknown">Unknown</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#a6917621ec8f1cbd9eda71cf3f12de89c">provide_list_of_unknowns</a> (const unsigned int dimension)</td></tr>
<tr class="separator:a6917621ec8f1cbd9eda71cf3f12de89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="02__solid__control__lifting_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a> (int argc, char **args)</td></tr>
<tr class="separator:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aea610d910b5d696b3e500ed9636d8367" name="aea610d910b5d696b3e500ed9636d8367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea610d910b5d696b3e500ed9636d8367">&#9670;&#160;</a></span>AssembleSolidMech() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void AssembleSolidMech </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l00348">348</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  348</span>                                                   {</div>
<div class="line"><span class="lineno">  349</span>    </div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>  AssembleSolidMech&lt; system_type, real_num, real_num_mov &gt; (  ml_prob, </div>
<div class="line"><span class="lineno">  352</span>                                                              ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a537b31965e5402b9c9febebce96ce01c">parameters</a>.<a class="code hl_function" href="classfemus_1_1_parameters.html#a419ddd3d0965dbca868a5072249b8374">get</a>&lt;<a class="code hl_class" href="classfemus_1_1_solid.html">Solid</a>&gt;(<span class="stringliteral">&quot;Solid&quot;</span>), </div>
<div class="line"><span class="lineno">  353</span>                                                            &amp; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0), </div>
<div class="line"><span class="lineno">  354</span>                                                              ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0).get_unknown_list_for_assembly());</div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>}</div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a537b31965e5402b9c9febebce96ce01c"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a537b31965e5402b9c9febebce96ce01c">femus::MultiLevelProblem::parameters</a></div><div class="ttdeci">Parameters parameters</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00397">MultiLevelProblem.hpp:397</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parameters_html_a419ddd3d0965dbca868a5072249b8374"><div class="ttname"><a href="classfemus_1_1_parameters.html#a419ddd3d0965dbca868a5072249b8374">femus::Parameters::get</a></div><div class="ttdeci">const T &amp; get(const std::string &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="_parameters_8hpp_source.html#l00414">Parameters.hpp:414</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html"><div class="ttname"><a href="classfemus_1_1_solid.html">femus::Solid</a></div><div class="ttdef"><b>Definition</b> <a href="_solid_8hpp_source.html#l00036">Solid.hpp:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96a01d4289cc795fc7506b8b67ba84bc" name="a96a01d4289cc795fc7506b8b67ba84bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96a01d4289cc795fc7506b8b67ba84bc">&#9670;&#160;</a></span>AssembleSolidMech() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void AssembleSolidMech </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="classfemus_1_1_solid.html">Solid</a> &amp;&#160;</td>
          <td class="paramname"><em>solid_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">system_type *&#160;</td>
          <td class="paramname"><em>mlPdeSys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefemus.html#classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l00361">361</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  364</span>                                                               {</div>
<div class="line"><span class="lineno">  365</span>    </div>
<div class="line"><span class="lineno">  366</span>  <span class="comment">//  ml_prob is the global object from/to where get/set all the data</span></div>
<div class="line"><span class="lineno">  367</span>  <span class="comment">//  level is the level of the PDE system to be assembled</span></div>
<div class="line"><span class="lineno">  368</span>  <span class="comment">//  levelMax is the Maximum level of the MultiLevelProblem</span></div>
<div class="line"><span class="lineno">  369</span>  <span class="comment">//  assembleMatrix is a flag that tells if only the residual or also the matrix should be assembled</span></div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>        level           = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><span class="lineno">  373</span>  <span class="keywordtype">bool</span>          assembleMatrix          = mlPdeSys-&gt;GetAssembleMatrix(); </div>
<div class="line"><span class="lineno">  374</span>  <span class="keyword">const</span> <span class="keywordtype">char</span>*           pdename         = mlPdeSys-&gt;name().c_str();</div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>*                 msh         = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno">  377</span>  <a class="code hl_class" href="classfemus_1_1elem.html">elem</a>*                 el          = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>*       ml_sol  = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><span class="lineno">  380</span>  <a class="code hl_class" href="classfemus_1_1_solution.html">Solution</a>*             sol         = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level); </div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>  <a class="code hl_class" href="classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>*     pdeSys  = mlPdeSys-&gt;_LinSolver[level];</div>
<div class="line"><span class="lineno">  384</span>  <a class="code hl_class" href="classfemus_1_1_sparse_matrix.html">SparseMatrix</a>*         JAC         = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><span class="lineno">  385</span>  <a class="code hl_class" href="classfemus_1_1_numeric_vector.html">NumericVector</a>*        RES         = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>;</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>    <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  389</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>   dim2  = (3 * (<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1));</div>
<div class="line"><span class="lineno">  390</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>    nel  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">GetNumberOfElements</a>();</div>
<div class="line"><span class="lineno">  391</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  igrid  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>();</div>
<div class="line"><span class="lineno">  392</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  iproc  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  393</span>  <span class="comment">// reserve memory for the local standard vectors</span></div>
<div class="line"><span class="lineno">  394</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size_elem_dofs = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><span class="lineno">  395</span> </div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>  </div>
<div class="line"><span class="lineno">  398</span>  <span class="comment">//----------- unknowns ------------------------------</span></div>
<div class="line"><span class="lineno">  399</span>   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><span class="lineno">  400</span><span class="comment">//      enum Sol_pos {pos_dx = 0, pos_dy, pos_p};  //these are known at compile-time</span></div>
<div class="line"><span class="lineno">  401</span><span class="comment">//      enum Sol_pos {pos_dx = 0, pos_dy, pos_dz, pos_p};</span></div>
<div class="line"><span class="lineno">  402</span><span class="comment">//   constexpr unsigned int pos_dx = 0;  </span></div>
<div class="line"><span class="lineno">  403</span><span class="comment">//   constexpr unsigned int pos_dy = 1;  </span></div>
<div class="line"><span class="lineno">  404</span><span class="comment">//   constexpr unsigned int pos_dp = 2;  </span></div>
<div class="line"><span class="lineno">  405</span><span class="comment">//   if (dim == 3) {std::cout &lt;&lt; &quot;Uncomment the 3d enum and recompile&quot;; abort(); }</span></div>
<div class="line"><span class="lineno">  406</span>   </div>
<div class="line"><span class="lineno">  407</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> sol_index_displ      = 0;     <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno">  408</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press      = sol_index_displ + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      <span class="comment">//known at run time</span></div>
<div class="line"><span class="lineno">  409</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> state_pos_begin      = sol_index_displ;   <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno">  410</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> adj_pos_begin        = <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1;</div>
<div class="line"><span class="lineno">  411</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_adj        = adj_pos_begin;      </div>
<div class="line"><span class="lineno">  412</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press_adj  = sol_index_adj + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;     </div>
<div class="line"><span class="lineno">  413</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> ctrl_pos_begin       = 2 * (<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1);</div>
<div class="line"><span class="lineno">  414</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_ctrl       = ctrl_pos_begin;     </div>
<div class="line"><span class="lineno">  415</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press_ctrl = sol_index_ctrl + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      </div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>  n_state_vars = <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1;</div>
<div class="line"><span class="lineno">  418</span>  </div>
<div class="line"><span class="lineno">  419</span>  vector &lt; std::string &gt; Solname(n_unknowns);     </div>
<div class="line"><span class="lineno">  420</span>  vector &lt; unsigned int &gt; SolIndex(n_unknowns);  </div>
<div class="line"><span class="lineno">  421</span>  vector &lt; unsigned int &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><span class="lineno">  422</span>  vector &lt; unsigned int &gt; SolFEType(n_unknowns);  </div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno">  426</span>       Solname[ivar]    = unknowns[ivar]._name; </div>
<div class="line"><span class="lineno">  427</span>      SolIndex[ivar]    = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>        (Solname[ivar].c_str());</div>
<div class="line"><span class="lineno">  428</span>    SolPdeIndex[ivar]   = mlPdeSys-&gt;GetSolPdeIndex(Solname[ivar].c_str());</div>
<div class="line"><span class="lineno">  429</span><span class="comment">//       assert(ivar == SolPdeIndex[ivar]);  //I would like this ivar order to coincide either with SolIndex or with SolPdeIndex, otherwise too many orders... it has to be  with SolPdeIndex, because SolIndex is related to the Solution object which can have more fields... This has to match the order of the unknowns[] argument</span></div>
<div class="line"><span class="lineno">  430</span>    SolFEType[ivar] = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(SolIndex[ivar]);</div>
<div class="line"><span class="lineno">  431</span>  }</div>
<div class="line"><span class="lineno">  432</span> </div>
<div class="line"><span class="lineno">  433</span>   <span class="keyword">constexpr</span> <span class="keywordtype">int</span> solFEType_max = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>;  <span class="comment">//biquadratic, this is the highest-order FE </span></div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>   vector &lt; unsigned int &gt; Sol_n_el_dofs(n_unknowns);</div>
<div class="line"><span class="lineno">  436</span>  </div>
<div class="line"><span class="lineno">  437</span>  <span class="comment">//----------- of dofs and at quadrature points ------------------------------</span></div>
<div class="line"><span class="lineno">  438</span>  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  439</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp(n_unknowns);   <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here  //some of these should be real_num, some real_num_mov...</span></div>
<div class="line"><span class="lineno">  440</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp(n_unknowns);  <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here</span></div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>  vector &lt; vector &lt; double &gt; &gt; phi_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  443</span>  vector &lt; vector &lt; double &gt; &gt; phi_x_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  444</span>  vector &lt; vector &lt; double &gt; &gt; phi_xx_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {  </div>
<div class="line"><span class="lineno">  447</span>        phi_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  448</span>    phi_hat_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  449</span>      phi_x_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  450</span>  phi_x_hat_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  451</span>     phi_xx_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  452</span> phi_xx_hat_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  453</span>   }</div>
<div class="line"><span class="lineno">  454</span>   </div>
<div class="line"><span class="lineno">  455</span>  <span class="comment">//----------- at dofs ------------------------------</span></div>
<div class="line"><span class="lineno">  456</span>  vector &lt; double &gt;   Jac;   Jac.reserve( n_unknowns * max_size_elem_dofs * n_unknowns * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  457</span>  vector &lt; real_num &gt; Res;   Res.reserve( n_unknowns * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  458</span>           vector &lt; int &gt;       L2G_dofmap_AllVars;   L2G_dofmap_AllVars.reserve( n_unknowns *max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  459</span>  vector &lt; vector &lt; int &gt; &gt;         L2G_dofmap(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) {    L2G_dofmap[i].reserve(max_size_elem_dofs); }</div>
<div class="line"><span class="lineno">  460</span>  vector &lt; vector &lt; real_num &gt; &gt; SolVAR_eldofs(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { SolVAR_eldofs[k].reserve(max_size_elem_dofs); }</div>
<div class="line"><span class="lineno">  461</span> <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  462</span>  vector &lt; double &gt;   Jac_state_true;   Jac_state_true.reserve( n_state_vars * max_size_elem_dofs * n_state_vars * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  463</span>  vector &lt; double &gt;   Jac_state_false;   Jac_state_false.reserve( n_state_vars * max_size_elem_dofs * n_state_vars * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  464</span>  vector &lt; real_num &gt; Res_state;   Res_state.reserve( n_state_vars * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  465</span> </div>
<div class="line"><span class="lineno">  466</span> </div>
<div class="line"><span class="lineno">  467</span>  <span class="comment">// geometry (at dofs) --------------------------------</span></div>
<div class="line"><span class="lineno">  468</span>  vector&lt; vector &lt; real_num_mov &gt; &gt;   coords(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  469</span>  vector  &lt; vector  &lt; double &gt; &gt;  coords_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  470</span>  <span class="keywordtype">unsigned</span> coordsType = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE TENSOR-PRODUCT-QUADRATIC)</span></div>
<div class="line"><span class="lineno">  471</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {   </div>
<div class="line"><span class="lineno">  472</span>           coords[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno">  473</span>       coords_hat[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno">  474</span> }</div>
<div class="line"><span class="lineno">  475</span> </div>
<div class="line"><span class="lineno">  476</span> <span class="comment">//************** geometry phi **************************</span></div>
<div class="line"><span class="lineno">  477</span>  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp_domain(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  478</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp_domain(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  479</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp_domain(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  480</span>  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp_domain_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  481</span>  vector &lt; vector &lt; double &gt; &gt; phi_x_dof_qp_domain_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  482</span>  vector &lt; vector &lt; double &gt; &gt; phi_xx_dof_qp_domain_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  483</span> </div>
<div class="line"><span class="lineno">  484</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dom_coord = 0; dom_coord &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; dom_coord++) {</div>
<div class="line"><span class="lineno">  485</span>        phi_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  486</span>      phi_x_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  487</span>     phi_xx_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  488</span>        phi_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  489</span>      phi_x_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  490</span>     phi_xx_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  491</span>   }</div>
<div class="line"><span class="lineno">  492</span> </div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span> </div>
<div class="line"><span class="lineno">  495</span>  <span class="comment">// geometry ------------------------------------------</span></div>
<div class="line"><span class="lineno">  496</span>  </div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>  <span class="comment">//------------ at quadrature points ---------------------</span></div>
<div class="line"><span class="lineno">  499</span>  real_num_mov weight_qp = 0.;</div>
<div class="line"><span class="lineno">  500</span>    <span class="keywordtype">double</span> weight_hat_qp = 0.;</div>
<div class="line"><span class="lineno">  501</span>    vector &lt; real_num &gt; SolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  502</span>    vector &lt; real_num &gt; SolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  503</span>    vector &lt; vector &lt; real_num &gt; &gt; gradSolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  504</span>    vector &lt; vector &lt; real_num &gt; &gt; gradSolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { </div>
<div class="line"><span class="lineno">  506</span>          gradSolVAR_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  507</span>      gradSolVAR_hat_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  508</span>    }</div>
<div class="line"><span class="lineno">  509</span>      </div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>   <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  512</span>    <span class="comment">// Physical parameters</span></div>
<div class="line"><span class="lineno">  513</span>    <span class="keyword">const</span> <span class="keywordtype">int</span>    solid_model    = solid_in.<a class="code hl_function" href="classfemus_1_1_solid.html#a19ca2da625aede63d5277cb034584718">get_physical_model</a>();</div>
<div class="line"><span class="lineno">  514</span>    <span class="keywordtype">double</span> rhos                 = solid_in.<a class="code hl_function" href="classfemus_1_1_material.html#aa1968d4c8018a8fca33acb32a5be3dbc">get_density</a>();</div>
<div class="line"><span class="lineno">  515</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mu_lame        = solid_in.<a class="code hl_function" href="classfemus_1_1_solid.html#a5f3228eab52c343a13167eaf73f568bc">get_lame_shear_modulus</a>();</div>
<div class="line"><span class="lineno">  516</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> lambda_lame    = solid_in.<a class="code hl_function" href="classfemus_1_1_solid.html#a25307ed3e65fea474b2d74b130348e4b">get_lame_lambda</a>();</div>
<div class="line"><span class="lineno">  517</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mus   = mu_lame/rhos;</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> incompressible   = (0.5  ==  solid_in.<a class="code hl_function" href="classfemus_1_1_solid.html#a3d971cfb0d2a1810e6b31830f1f4b900">get_poisson_coeff</a>()) ? 1 : 0;</div>
<div class="line"><span class="lineno">  520</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> penalty = solid_in.<a class="code hl_function" href="classfemus_1_1_solid.html#a032c01f0f6e345f2818a7ffe24bad883">get_if_penalty</a>();</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> young_modulus = solid_in.<a class="code hl_function" href="classfemus_1_1_solid.html#a1a27599fb327424255b0823dcddd863a">get_young_module</a>();</div>
<div class="line"><span class="lineno">  523</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Lref = solid_in.<a class="code hl_variable" href="classfemus_1_1_material.html#a393992ac63eb6eaae7d5cbad9c6ac4ec">_parameter</a>-&gt;<a class="code hl_function" href="classfemus_1_1_parameter.html#a010508c1540e2547bcbf77f2c1103695">Get_reference_length</a>();</div>
<div class="line"><span class="lineno">  524</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> nondim_number = Lref/young_modulus;</div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// -----------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  528</span>  <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">zero</a>();</div>
<div class="line"><span class="lineno">  529</span>  </div>
<div class="line"><span class="lineno">  530</span>  adept::Stack &amp; stack = <a class="code hl_variable" href="classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;  <span class="comment">// call the adept stack object for potential use of AD</span></div>
<div class="line"><span class="lineno">  531</span>  <span class="keyword">const</span> <a class="code hl_class" href="classfemus_1_1assemble__jacobian.html">assemble_jacobian</a>&lt; real_num, <span class="keywordtype">double</span><span class="comment">/*real_num_mov*/</span> &gt; assemble_jac;</div>
<div class="line"><span class="lineno">  532</span> <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  533</span>  adept::Stack &amp; stack_state = <a class="code hl_variable" href="classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;  <span class="comment">// call the adept stack object for potential use of AD</span></div>
<div class="line"><span class="lineno">  534</span>  <span class="keyword">const</span> <a class="code hl_class" href="classfemus_1_1assemble__jacobian.html">assemble_jacobian</a>&lt; real_num, <span class="keywordtype">double</span><span class="comment">/*real_num_mov*/</span> &gt; assemble_jac_state;</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>   <span class="comment">//all vars ###################################################################  </span></div>
<div class="line"><span class="lineno">  540</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  541</span>    <span class="keywordtype">unsigned</span> ndofs_unk = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolFEType[k]);</div>
<div class="line"><span class="lineno">  542</span>       Sol_n_el_dofs[k] = ndofs_unk;</div>
<div class="line"><span class="lineno">  543</span>       SolVAR_eldofs[k].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  544</span>          L2G_dofmap[k].resize(Sol_n_el_dofs[k]); </div>
<div class="line"><span class="lineno">  545</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; SolVAR_eldofs[k].size(); i++) {</div>
<div class="line"><span class="lineno">  546</span>       <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolFEType[k]);</div>
<div class="line"><span class="lineno">  547</span>       SolVAR_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex[k]])(solDof);</div>
<div class="line"><span class="lineno">  548</span>          L2G_dofmap[k][i] = pdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(SolIndex[k], SolPdeIndex[k], i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><span class="lineno">  549</span>      }</div>
<div class="line"><span class="lineno">  550</span>    }</div>
<div class="line"><span class="lineno">  551</span>    </div>
<div class="line"><span class="lineno">  552</span>    L2G_dofmap_AllVars.resize(0);</div>
<div class="line"><span class="lineno">  553</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++)     L2G_dofmap_AllVars.insert(L2G_dofmap_AllVars.end(),L2G_dofmap[k].begin(),L2G_dofmap[k].end());</div>
<div class="line"><span class="lineno">  554</span> </div>
<div class="line"><span class="lineno">  555</span>    <span class="keywordtype">unsigned</span> sum_Sol_n_el_dofs = 0;</div>
<div class="line"><span class="lineno">  556</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) { sum_Sol_n_el_dofs += Sol_n_el_dofs[k]; }</div>
<div class="line"><span class="lineno">  557</span>    Jac.resize(sum_Sol_n_el_dofs * sum_Sol_n_el_dofs);  std::fill(Jac.begin(), Jac.end(), 0.);</div>
<div class="line"><span class="lineno">  558</span>    Res.resize(sum_Sol_n_el_dofs);                      std::fill(Res.begin(), Res.end(), 0.);</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span> <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  561</span>    <span class="keywordtype">unsigned</span> state_sum_Sol_n_el_dofs = 0;</div>
<div class="line"><span class="lineno">  562</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_state_vars; k++) { state_sum_Sol_n_el_dofs += Sol_n_el_dofs[k]; }</div>
<div class="line"><span class="lineno">  563</span>    Jac_state_true.resize(state_sum_Sol_n_el_dofs * state_sum_Sol_n_el_dofs);    std::fill(Jac_state_true.begin(), Jac_state_true.end(), 0.);</div>
<div class="line"><span class="lineno">  564</span>    Jac_state_false.resize(state_sum_Sol_n_el_dofs * state_sum_Sol_n_el_dofs);    std::fill(Jac_state_false.begin(), Jac_state_false.end(), 0.);</div>
<div class="line"><span class="lineno">  565</span>    Res_state.resize(state_sum_Sol_n_el_dofs);                              std::fill(Res_state.begin(), Res_state.end(), 0.);</div>
<div class="line"><span class="lineno">  566</span>  <span class="comment">//all vars ###################################################################</span></div>
<div class="line"><span class="lineno">  567</span>  </div>
<div class="line"><span class="lineno">  568</span>    </div>
<div class="line"><span class="lineno">  569</span>  <span class="comment">// geometry *****************************</span></div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  571</span> </div>
<div class="line"><span class="lineno">  572</span>      <span class="keywordtype">unsigned</span> nDofsX = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, coordsType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno">  573</span>    </div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ivar=0; ivar&lt;<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  575</span>      coords[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno">  576</span>      coords_hat[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno">  577</span>    }</div>
<div class="line"><span class="lineno">  578</span>    </div>
<div class="line"><span class="lineno">  579</span>   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno">  580</span>      <span class="keywordtype">unsigned</span> coordsDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, coordsType);    <span class="comment">// global to global mapping between coordinates node and coordinate dof // via local to global solution node</span></div>
<div class="line"><span class="lineno">  581</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  582</span>          <span class="comment">//Fixed coordinates (Reference frame)</span></div>
<div class="line"><span class="lineno">  583</span>    coords_hat[ivar][i] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[ivar])(coordsDof);</div>
<div class="line"><span class="lineno">  584</span>      }</div>
<div class="line"><span class="lineno">  585</span>    }</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>  <span class="comment">//***************************************  </span></div>
<div class="line"><span class="lineno">  588</span>    assert(nDofsX == Sol_n_el_dofs[sol_index_displ]);</div>
<div class="line"><span class="lineno">  589</span>    <span class="comment">//Moving coordinates (Moving frame)</span></div>
<div class="line"><span class="lineno">  590</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  591</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofsX; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  592</span>          coords[idim][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = coords_hat[idim][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + SolVAR_eldofs[SolIndex[idim]][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  593</span>        }</div>
<div class="line"><span class="lineno">  594</span>      }</div>
<div class="line"><span class="lineno">  595</span>  </div>
<div class="line"><span class="lineno">  596</span>     <span class="comment">// elem average point </span></div>
<div class="line"><span class="lineno">  597</span>    vector &lt; double &gt; elem_center(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);   </div>
<div class="line"><span class="lineno">  598</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0.;  }</div>
<div class="line"><span class="lineno">  599</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  </div>
<div class="line"><span class="lineno">  600</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno">  601</span>         elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += coords_hat[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i];</div>
<div class="line"><span class="lineno">  602</span>       }</div>
<div class="line"><span class="lineno">  603</span>    }</div>
<div class="line"><span class="lineno">  604</span>    </div>
<div class="line"><span class="lineno">  605</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) { elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]/nDofsX; }</div>
<div class="line"><span class="lineno">  606</span>  <span class="comment">//*************************************** </span></div>
<div class="line"><span class="lineno">  607</span>  </div>
<div class="line"><span class="lineno">  608</span>  <span class="comment">//***** set target domain flag ********************************** </span></div>
<div class="line"><span class="lineno">  609</span>   <span class="keywordtype">int</span> target_flag = 0;</div>
<div class="line"><span class="lineno">  610</span>   target_flag = ElementTargetFlag &lt; double &gt; (elem_center);</div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span>  <span class="comment">// geometry end *****************************</span></div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span>      </div>
<div class="line"><span class="lineno">  615</span>     assemble_jac.prepare_before_integration_loop(stack);</div>
<div class="line"><span class="lineno">  616</span>     assemble_jac_state.prepare_before_integration_loop(stack_state); <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  617</span>     </div>
<div class="line"><span class="lineno">  618</span>  </div>
<div class="line"><span class="lineno">  619</span>    <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno">  620</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom).GetGaussPointsNumber(); <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>    <span class="comment">// *** get Jacobian and test function and test function derivatives ***</span></div>
<div class="line"><span class="lineno">  623</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {</div>
<div class="line"><span class="lineno">  624</span>    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,    phi_dof_qp[unk],    phi_x_dof_qp[unk],    phi_xx_dof_qp[unk]);</div>
<div class="line"><span class="lineno">  625</span>    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_hat_qp,phi_hat_dof_qp[unk],phi_x_hat_dof_qp[unk],phi_xx_hat_dof_qp[unk]);</div>
<div class="line"><span class="lineno">  626</span>      }</div>
<div class="line"><span class="lineno">  627</span>      </div>
<div class="line"><span class="lineno">  628</span>   <span class="comment">//=============== Integration at qp ========================================</span></div>
<div class="line"><span class="lineno">  629</span>         <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN...</span></div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno">  631</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_qp,    phi_dof_qp_domain[d],     phi_x_dof_qp_domain[d],     phi_xx_dof_qp_domain[d]);</div>
<div class="line"><span class="lineno">  632</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_hat_qp,phi_dof_qp_domain_hat[d], phi_x_dof_qp_domain_hat[d], phi_xx_dof_qp_domain_hat[d]);</div>
<div class="line"><span class="lineno">  633</span>      }</div>
<div class="line"><span class="lineno">  634</span>     </div>
<div class="line"><span class="lineno">  635</span>  <span class="comment">//begin unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno">  636</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> unk = 0; unk &lt;  n_unknowns; unk++) {</div>
<div class="line"><span class="lineno">  637</span>      SolVAR_qp[unk] = 0.;</div>
<div class="line"><span class="lineno">  638</span>      SolVAR_hat_qp[unk] = 0.;</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++){ </div>
<div class="line"><span class="lineno">  641</span>        gradSolVAR_qp[unk][ivar2] = 0.; </div>
<div class="line"><span class="lineno">  642</span>        gradSolVAR_hat_qp[unk][ivar2] = 0.; </div>
<div class="line"><span class="lineno">  643</span>      }</div>
<div class="line"><span class="lineno">  644</span>      </div>
<div class="line"><span class="lineno">  645</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[unk]; i++) {</div>
<div class="line"><span class="lineno">  646</span>        SolVAR_qp[unk]    += phi_dof_qp[ unk ][i] * SolVAR_eldofs[unk][i];</div>
<div class="line"><span class="lineno">  647</span>        SolVAR_hat_qp[unk]    += phi_hat_dof_qp[ unk ][i] * SolVAR_eldofs[unk][i];</div>
<div class="line"><span class="lineno">  648</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2 = 0; ivar2 &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {</div>
<div class="line"><span class="lineno">  649</span>          gradSolVAR_qp[unk][ivar2]     += phi_x_dof_qp[ unk ][i*<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[unk][i]; </div>
<div class="line"><span class="lineno">  650</span>          gradSolVAR_hat_qp[unk][ivar2] += phi_x_hat_dof_qp[ unk ][i*<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[unk][i]; </div>
<div class="line"><span class="lineno">  651</span>        }</div>
<div class="line"><span class="lineno">  652</span>      }</div>
<div class="line"><span class="lineno">  653</span>      </div>
<div class="line"><span class="lineno">  654</span>    }  </div>
<div class="line"><span class="lineno">  655</span> <span class="comment">//end unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno">  656</span> </div>
<div class="line"><span class="lineno">  657</span> </div>
<div class="line"><span class="lineno">  658</span><span class="comment">//  assemble_jacobian&lt; real_num, real_num_mov &gt;::mass_residual (Res, Sol_n_el_dofs, sum_Sol_n_el_dofs, SolPdeIndex, phi_dof_qp, SolVAR_qp, weight_hat_qp); //identity</span></div>
<div class="line"><span class="lineno">  659</span> </div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span> <span class="comment">//*******************************************************************************************************</span></div>
<div class="line"><span class="lineno">  662</span>   vector &lt; vector &lt; real_num_mov &gt; &gt; Cauchy(3); <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Cauchy.size(); i++) Cauchy[i].resize(3);</div>
<div class="line"><span class="lineno">  663</span>   real_num_mov J_hat;</div>
<div class="line"><span class="lineno">  664</span>   real_num_mov trace_e_hat;</div>
<div class="line"><span class="lineno">  665</span> </div>
<div class="line"><span class="lineno">  666</span> </div>
<div class="line"><span class="lineno">  667</span> Cauchy = Solid::get_Cauchy_stress_tensor&lt; real_num_mov &gt;(solid_model, mus, lambda_lame, incompressible, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, sol_index_displ, sol_index_press, gradSolVAR_hat_qp, SolVAR_qp, SolPdeIndex, J_hat, trace_e_hat);</div>
<div class="line"><span class="lineno">  668</span> </div>
<div class="line"><span class="lineno">  669</span>    </div>
<div class="line"><span class="lineno">  670</span>  <span class="comment">//STATE=====================================</span></div>
<div class="line"><span class="lineno">  671</span><span class="comment">//----------from displ_state and p_state</span></div>
<div class="line"><span class="lineno">  672</span>              <span class="comment">//BEGIN residual Solid Momentum in moving domain</span></div>
<div class="line"><span class="lineno">  673</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_displ]; i++) {</div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span>              real_num_mov Cauchy_direction[3] = {0., 0., 0.};</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0.; idim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  678</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jdim = 0.; jdim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  679</span>                  Cauchy_direction[idim] += nondim_number * phi_x_dof_qp[ idim ][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + jdim] * Cauchy[idim][jdim];</div>
<div class="line"><span class="lineno">  680</span>                }</div>
<div class="line"><span class="lineno">  681</span>              }</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  684</span>                Res[ <a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[idim], i) ] += ( Cauchy_direction[idim] -  phi_dof_qp[ idim ][i] * <a class="code hl_variable" href="solidopt__params_8hpp.html#a491774c0485f249809d76f7933b79419">_gravity</a>[idim] ) * weight_qp;</div>
<div class="line"><span class="lineno">  685</span>              }</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>            }</div>
<div class="line"><span class="lineno">  688</span>              <span class="comment">//END residual Solid Momentum in moving domain</span></div>
<div class="line"><span class="lineno">  689</span><span class="comment">//----------from displ_state and p_state</span></div>
<div class="line"><span class="lineno">  690</span>              </div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span><span class="comment">//----------from displ_state of divergence</span></div>
<div class="line"><span class="lineno">  693</span>              <span class="comment">//BEGIN residual solid mass balance in reference domain</span></div>
<div class="line"><span class="lineno">  694</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_press]; i++) {</div>
<div class="line"><span class="lineno">  695</span>                </div>
<div class="line"><span class="lineno">  696</span>              Res[ <a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[sol_index_press], i) ] += </div>
<div class="line"><span class="lineno">  697</span>                - weight_hat_qp * phi_hat_dof_qp[ sol_index_press ][i] * Solid::get_mass_balance_reference_domain&lt; real_num_mov &gt;(solid_model, penalty, incompressible, lambda_lame, trace_e_hat, J_hat, SolVAR_qp, SolPdeIndex, sol_index_press);</div>
<div class="line"><span class="lineno">  698</span><span class="comment">//               - weight_hat_qp * phi_dof_qp[ sol_index_press ][i] * Solid::get_mass_balance_moving_domain&lt; real_num_mov &gt;(gradSolVAR_qp, SolPdeIndex);</span></div>
<div class="line"><span class="lineno">  699</span>              </div>
<div class="line"><span class="lineno">  700</span>            }</div>
<div class="line"><span class="lineno">  701</span>              <span class="comment">//END residual solid mass balance in reference domain</span></div>
<div class="line"><span class="lineno">  702</span><span class="comment">//----------from displ_state of div</span></div>
<div class="line"><span class="lineno">  703</span>  <span class="comment">//STATE=====================================</span></div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span> <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno">  707</span><span class="comment">//----------from displ_state and displ_ctrl</span></div>
<div class="line"><span class="lineno">  708</span>         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_adj]; i++) {</div>
<div class="line"><span class="lineno">  709</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  710</span>   Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[idim + adj_pos_begin], i)] += </div>
<div class="line"><span class="lineno">  711</span>    - <a class="code hl_variable" href="solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a> * target_flag * (SolVAR_hat_qp[SolPdeIndex[idim]] + SolVAR_hat_qp[SolPdeIndex[idim + ctrl_pos_begin]] - <a class="code hl_variable" href="solidopt__params_8hpp.html#a80e1487a07155d5b24edd6eca186b73b">TargetDisp</a>[idim]) </div>
<div class="line"><span class="lineno">  712</span>     * phi_dof_qp[ idim + adj_pos_begin ][i] * weight_qp;</div>
<div class="line"><span class="lineno">  713</span>               }</div>
<div class="line"><span class="lineno">  714</span>          }</div>
<div class="line"><span class="lineno">  715</span><span class="comment">//----------from displ_state and displ_ctrl</span></div>
<div class="line"><span class="lineno">  716</span> <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>        </div>
<div class="line"><span class="lineno">  719</span>  <span class="comment">//CONTROL=====================================</span></div>
<div class="line"><span class="lineno">  720</span> <span class="comment">//----------from displ_state and displ_ctrl</span></div>
<div class="line"><span class="lineno">  721</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_ctrl]; i++) {</div>
<div class="line"><span class="lineno">  722</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  723</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  724</span>   Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[idim + ctrl_pos_begin], i)] += </div>
<div class="line"><span class="lineno">  725</span>                    <a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> * ( gradSolVAR_hat_qp[idim + ctrl_pos_begin][jdim] + gradSolVAR_hat_qp[jdim + ctrl_pos_begin][idim] )</div>
<div class="line"><span class="lineno">  726</span>                    * phi_x_dof_qp[idim + ctrl_pos_begin][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + jdim] * weight_qp;                   </div>
<div class="line"><span class="lineno">  727</span>                    }</div>
<div class="line"><span class="lineno">  728</span>   Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[idim + ctrl_pos_begin], i)] += </div>
<div class="line"><span class="lineno">  729</span>            (   ( <a class="code hl_variable" href="solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a> * target_flag * (SolVAR_hat_qp[SolPdeIndex[idim]] + SolVAR_hat_qp[SolPdeIndex[idim + ctrl_pos_begin]] - <a class="code hl_variable" href="solidopt__params_8hpp.html#a80e1487a07155d5b24edd6eca186b73b">TargetDisp</a>[idim])  </div>
<div class="line"><span class="lineno">  730</span>                + <a class="code hl_variable" href="solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a> * SolVAR_hat_qp[SolPdeIndex[idim + ctrl_pos_begin]] )* phi_dof_qp[ idim + ctrl_pos_begin ][i] </div>
<div class="line"><span class="lineno">  731</span>            ) * weight_qp;</div>
<div class="line"><span class="lineno">  732</span>               }</div>
<div class="line"><span class="lineno">  733</span>          }</div>
<div class="line"><span class="lineno">  734</span> <span class="comment">//----------from displ_state and displ_ctrl</span></div>
<div class="line"><span class="lineno">  735</span> <span class="comment">//CONTROL=====================================</span></div>
<div class="line"><span class="lineno">  736</span>       </div>
<div class="line"><span class="lineno">  737</span>    } <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno">  738</span> </div>
<div class="line"><span class="lineno">  739</span>    <span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  740</span> </div>
<div class="line"><span class="lineno">  741</span>    </div>
<div class="line"><span class="lineno">  742</span> <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Res_state.size(); i++) {</div>
<div class="line"><span class="lineno">  743</span>        Res_state[i] = Res[i];</div>
<div class="line"><span class="lineno">  744</span>  }</div>
<div class="line"><span class="lineno">  745</span>  </div>
<div class="line"><span class="lineno">  746</span>    std::vector &lt; double &gt; Res_state_double(Res_state.size());</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Res_state_double.size(); i++) {</div>
<div class="line"><span class="lineno">  749</span>      Res_state_double[i] = - Res_state[i].value();</div>
<div class="line"><span class="lineno">  750</span>    }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span>    stack_state.dependent(  &amp; Res_state[0], Res_state_double.size());      <span class="comment">// define the dependent variables</span></div>
<div class="line"><span class="lineno">  754</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_state_vars; k++) {   </div>
<div class="line"><span class="lineno">  755</span>    stack_state.independent(&amp;SolVAR_eldofs[k][0],       SolVAR_eldofs[k].size());    <span class="comment">// define the independent variables</span></div>
<div class="line"><span class="lineno">  756</span>    }</div>
<div class="line"><span class="lineno">  757</span>    </div>
<div class="line"><span class="lineno">  758</span>    stack_state.jacobian(&amp;Jac_state_true[0], <span class="keyword">true</span>);    <span class="comment">// get the jacobian matrix (ordered by row major for Ctrl block in delta_state) </span></div>
<div class="line"><span class="lineno">  759</span>    stack_state.jacobian(&amp;Jac_state_false[0], <span class="keyword">false</span>);    <span class="comment">// get the jacobian matrix (ordered by column major for Adjoint) // Adj = transpose of state block</span></div>
<div class="line"><span class="lineno">  760</span> </div>
<div class="line"><span class="lineno">  761</span>    stack_state.clear_independents();</div>
<div class="line"><span class="lineno">  762</span>    stack_state.clear_dependents();    </div>
<div class="line"><span class="lineno">  763</span> </div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>  <span class="comment">//STATE=====================================</span></div>
<div class="line"><span class="lineno">  766</span><span class="comment">//----------from displ_ctrl only</span></div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = state_pos_begin; i_block &lt; state_pos_begin + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i_block++) {</div>
<div class="line"><span class="lineno">  769</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  770</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = state_pos_begin; j_block &lt; state_pos_begin + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block++) {</div>
<div class="line"><span class="lineno">  771</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  772</span>    Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  773</span>        Jac_state_true[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  774</span>            * SolVAR_eldofs[j_block + ctrl_pos_begin][j_dof];</div>
<div class="line"><span class="lineno">  775</span>                }</div>
<div class="line"><span class="lineno">  776</span>           }</div>
<div class="line"><span class="lineno">  777</span>        }</div>
<div class="line"><span class="lineno">  778</span>   }</div>
<div class="line"><span class="lineno">  779</span><span class="comment">//----------from displ_ctrl only</span></div>
<div class="line"><span class="lineno">  780</span>  <span class="comment">//STATE=====================================</span></div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>    </div>
<div class="line"><span class="lineno">  784</span>  <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno">  785</span><span class="comment">//----------from adj displ</span></div>
<div class="line"><span class="lineno">  786</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = adj_pos_begin; i_block &lt; adj_pos_begin + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i_block++) {</div>
<div class="line"><span class="lineno">  787</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  788</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = 0; j_block &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block++) {</div>
<div class="line"><span class="lineno">  789</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  790</span>    Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  791</span>        Jac_state_false[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - adj_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  792</span>            * SolVAR_eldofs[j_block + adj_pos_begin][j_dof];</div>
<div class="line"><span class="lineno">  793</span>                }</div>
<div class="line"><span class="lineno">  794</span>           }</div>
<div class="line"><span class="lineno">  795</span>        }</div>
<div class="line"><span class="lineno">  796</span>   }</div>
<div class="line"><span class="lineno">  797</span><span class="comment">//----------from adj displ </span></div>
<div class="line"><span class="lineno">  798</span> </div>
<div class="line"><span class="lineno">  799</span><span class="comment">//----------from p_adj only</span></div>
<div class="line"><span class="lineno">  800</span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = adj_pos_begin; i_block &lt; adj_pos_begin + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> ; i_block++) {</div>
<div class="line"><span class="lineno">  801</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  802</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block &lt; n_state_vars; j_block++) {</div>
<div class="line"><span class="lineno">  803</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  804</span>    Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  805</span>        Jac_state_true[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - adj_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  806</span>            * SolVAR_eldofs[j_block + adj_pos_begin][j_dof];</div>
<div class="line"><span class="lineno">  807</span>                }</div>
<div class="line"><span class="lineno">  808</span>           }</div>
<div class="line"><span class="lineno">  809</span>        }</div>
<div class="line"><span class="lineno">  810</span>   }</div>
<div class="line"><span class="lineno">  811</span><span class="comment">//----------from p_adj only</span></div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span><span class="comment">//----------from div of displ_adj</span></div>
<div class="line"><span class="lineno">  814</span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = sol_index_press_adj; i_block &lt; ctrl_pos_begin ; i_block++) {</div>
<div class="line"><span class="lineno">  815</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  816</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = 0; j_block &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block++) {</div>
<div class="line"><span class="lineno">  817</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  818</span>    Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  819</span>        Jac_state_true[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - adj_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  820</span>            * SolVAR_eldofs[j_block + adj_pos_begin][j_dof];</div>
<div class="line"><span class="lineno">  821</span>                }</div>
<div class="line"><span class="lineno">  822</span>           }</div>
<div class="line"><span class="lineno">  823</span>        }</div>
<div class="line"><span class="lineno">  824</span>   }</div>
<div class="line"><span class="lineno">  825</span><span class="comment">// ----------from div of displ_adj</span></div>
<div class="line"><span class="lineno">  826</span>  <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno">  827</span> </div>
<div class="line"><span class="lineno">  828</span>   <span class="comment">//CONTROL=====================================</span></div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span><span class="comment">//----------from displ__adj only</span></div>
<div class="line"><span class="lineno">  831</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = ctrl_pos_begin; i_block &lt; ctrl_pos_begin + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> ; i_block++) {</div>
<div class="line"><span class="lineno">  832</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  833</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = 0; j_block &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block++) {</div>
<div class="line"><span class="lineno">  834</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  835</span>    Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  836</span>        - Jac_state_false[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - ctrl_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  837</span>          * SolVAR_eldofs[j_block + adj_pos_begin][j_dof];</div>
<div class="line"><span class="lineno">  838</span>                }</div>
<div class="line"><span class="lineno">  839</span>           }</div>
<div class="line"><span class="lineno">  840</span>        }</div>
<div class="line"><span class="lineno">  841</span>   }</div>
<div class="line"><span class="lineno">  842</span><span class="comment">//----------from displ__adj only</span></div>
<div class="line"><span class="lineno">  843</span> </div>
<div class="line"><span class="lineno">  844</span><span class="comment">//----------from p_ctrl only</span></div>
<div class="line"><span class="lineno">  845</span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = ctrl_pos_begin; i_block &lt; ctrl_pos_begin + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> ; i_block++) {</div>
<div class="line"><span class="lineno">  846</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  847</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block &lt; n_state_vars; j_block++) {</div>
<div class="line"><span class="lineno">  848</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  849</span>    Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  850</span>        Jac_state_true[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - ctrl_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  851</span>            * SolVAR_eldofs[j_block + ctrl_pos_begin][j_dof];</div>
<div class="line"><span class="lineno">  852</span>                }</div>
<div class="line"><span class="lineno">  853</span>           }</div>
<div class="line"><span class="lineno">  854</span>        }</div>
<div class="line"><span class="lineno">  855</span>   }</div>
<div class="line"><span class="lineno">  856</span><span class="comment">//----------from p_ctrl only</span></div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span><span class="comment">//----------from div of displ_ctrl</span></div>
<div class="line"><span class="lineno">  859</span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = sol_index_press_ctrl; i_block &lt; n_unknowns ; i_block++) {</div>
<div class="line"><span class="lineno">  860</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  861</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = 0; j_block &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block++) {</div>
<div class="line"><span class="lineno">  862</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  863</span>    Res[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  864</span>        Jac_state_true[<a class="code hl_function" href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - ctrl_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  865</span>            * SolVAR_eldofs[j_block + ctrl_pos_begin][j_dof];</div>
<div class="line"><span class="lineno">  866</span>                }</div>
<div class="line"><span class="lineno">  867</span>           }</div>
<div class="line"><span class="lineno">  868</span>        }</div>
<div class="line"><span class="lineno">  869</span>   }</div>
<div class="line"><span class="lineno">  870</span><span class="comment">//----------from div of displ_ctrl</span></div>
<div class="line"><span class="lineno">  871</span>  <span class="comment">//CONTROL=====================================</span></div>
<div class="line"><span class="lineno">  872</span>  </div>
<div class="line"><span class="lineno">  873</span>  </div>
<div class="line"><span class="lineno">  874</span>      </div>
<div class="line"><span class="lineno">  875</span>     <span class="keywordflow">if</span> (assembleMatrix) assemble_jac.compute_jacobian_outside_integration_loop(stack, SolVAR_eldofs, Res, Jac, L2G_dofmap_AllVars, RES, JAC);</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>       </div>
<div class="line"><span class="lineno">  880</span><span class="comment">//     assemble_jacobian&lt;real_num,real_num_mov&gt;::print_element_residual(iel, Res, Sol_n_el_dofs, 9, 3);</span></div>
<div class="line"><span class="lineno">  881</span><span class="comment">//     assemble_jacobian&lt;real_num,real_num_mov&gt;::print_element_jacobian(iel, Jac, Sol_n_el_dofs, 9, 3);</span></div>
<div class="line"><span class="lineno">  882</span>    </div>
<div class="line"><span class="lineno">  883</span>  } <span class="comment">//end element loop for each process</span></div>
<div class="line"><span class="lineno">  884</span> </div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span> <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">close</a>();</div>
<div class="line"><span class="lineno">  887</span>                     RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  888</span>  </div>
<div class="line"><span class="lineno">  889</span>  </div>
<div class="line"><span class="lineno">  890</span>  </div>
<div class="line"><span class="lineno">  891</span>    <span class="comment">//print JAC and RES to files</span></div>
<div class="line"><span class="lineno">  892</span><span class="comment">//     const unsigned nonlin_iter = mlPdeSys-&gt;GetNonlinearIt();</span></div>
<div class="line"><span class="lineno">  893</span><span class="comment">//     assemble_jacobian&lt; real_num_mov,double &gt;::print_global_jacobian(assembleMatrix, ml_prob, JAC, nonlin_iter);</span></div>
<div class="line"><span class="lineno">  894</span><span class="comment">//     assemble_jacobian&lt; real_num_mov,double &gt;::print_global_residual(ml_prob, RES, nonlin_iter);</span></div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>  </div>
<div class="line"><span class="lineno">  897</span>}</div>
<div class="ttc" id="a_conformal_2ex3_2ex3_8cpp_html_a4049344c4d6020a322197047b513967f"><div class="ttname"><a href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a></div><div class="ttdeci">const double beta</div><div class="ttdef"><b>Definition</b> <a href="_conformal_2ex3_2ex3_8cpp_source.html#l00023">ex3.cpp:23</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a789a31c8b16fddbe5ad66911ec7933c6"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a></div><div class="ttdeci">#define BIQUADR_FE</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00010">FETypeEnum.hpp:10</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html_ab48c1191eb7ebb370a323d3ec4f713c9"><div class="ttname"><a href="classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">femus::FemusInit::_adeptStack</a></div><div class="ttdeci">static adept::Stack _adeptStack</div><div class="ttdef"><b>Definition</b> <a href="_femus_init_8hpp_source.html#l00059">FemusInit.hpp:59</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a20ac8999e714492516cd8a2be53fb54f"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8cpp_source.html#l00071">LinearEquation.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8hpp_source.html#l00118">LinearEquation.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html"><div class="ttname"><a href="classfemus_1_1_linear_equation_solver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_solver_8hpp_source.html#l00055">LinearEquationSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1_material_html_a393992ac63eb6eaae7d5cbad9c6ac4ec"><div class="ttname"><a href="classfemus_1_1_material.html#a393992ac63eb6eaae7d5cbad9c6ac4ec">femus::Material::_parameter</a></div><div class="ttdeci">Parameter * _parameter</div><div class="ttdef"><b>Definition</b> <a href="_material_8hpp_source.html#l00052">Material.hpp:52</a></div></div>
<div class="ttc" id="aclassfemus_1_1_material_html_aa1968d4c8018a8fca33acb32a5be3dbc"><div class="ttname"><a href="classfemus_1_1_material.html#aa1968d4c8018a8fca33acb32a5be3dbc">femus::Material::get_density</a></div><div class="ttdeci">const double get_density() const</div><div class="ttdef"><b>Definition</b> <a href="_material_8cpp_source.html#l00058">Material.cpp:58</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a24f5ab73a260d61b0ea9ff28f03bc815"><div class="ttname"><a href="classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">femus::Mesh::GetLevel</a></div><div class="ttdeci">unsigned GetLevel() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00260">Mesh.hpp:260</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a555c4982e81fc0042426c6741a792ca2"><div class="ttname"><a href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">femus::Mesh::_finiteElement</a></div><div class="ttdeci">const elem_type * _finiteElement[N_GEOM_ELS][5]</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00321">Mesh.hpp:321</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l01222">Mesh.cpp:1222</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ab5bcfd4be738d47ae025a06eddc66f61"><div class="ttname"><a href="classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">femus::Mesh::GetNumberOfElements</a></div><div class="ttdeci">unsigned GetNumberOfElements() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00099">Mesh.hpp:99</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00162">Mesh.hpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l01212">Mesh.cpp:1212</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a34890e6aa9d88946571fa050ee544c39"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">femus::MultiLevelProblem::GetQuadratureRule</a></div><div class="ttdeci">const Gauss &amp; GetQuadratureRule(const unsigned geom_elem_type) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00282">MultiLevelProblem.hpp:282</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a6dd8fec26a0ffbaae07e6df7ea42d12b"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">femus::MultiLevelProblem::_ml_sol</a></div><div class="ttdeci">MultiLevelSolution * _ml_sol</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00079">MultiLevelProblem.hpp:79</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00116">MultiLevelProblem.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition</b> <a href="_numeric_vector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parameter_html_a010508c1540e2547bcbf77f2c1103695"><div class="ttname"><a href="classfemus_1_1_parameter.html#a010508c1540e2547bcbf77f2c1103695">femus::Parameter::Get_reference_length</a></div><div class="ttdeci">double Get_reference_length()</div><div class="ttdef"><b>Definition</b> <a href="_parameter_8cpp_source.html#l00032">Parameter.cpp:32</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a032c01f0f6e345f2818a7ffe24bad883"><div class="ttname"><a href="classfemus_1_1_solid.html#a032c01f0f6e345f2818a7ffe24bad883">femus::Solid::get_if_penalty</a></div><div class="ttdeci">const bool get_if_penalty() const</div><div class="ttdef"><b>Definition</b> <a href="_solid_8cpp_source.html#l00161">Solid.cpp:161</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a19ca2da625aede63d5277cb034584718"><div class="ttname"><a href="classfemus_1_1_solid.html#a19ca2da625aede63d5277cb034584718">femus::Solid::get_physical_model</a></div><div class="ttdeci">const unsigned get_physical_model() const</div><div class="ttdef"><b>Definition</b> <a href="_solid_8cpp_source.html#l00141">Solid.cpp:141</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a1a27599fb327424255b0823dcddd863a"><div class="ttname"><a href="classfemus_1_1_solid.html#a1a27599fb327424255b0823dcddd863a">femus::Solid::get_young_module</a></div><div class="ttdeci">const double get_young_module() const</div><div class="ttdef"><b>Definition</b> <a href="_solid_8cpp_source.html#l00145">Solid.cpp:145</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a25307ed3e65fea474b2d74b130348e4b"><div class="ttname"><a href="classfemus_1_1_solid.html#a25307ed3e65fea474b2d74b130348e4b">femus::Solid::get_lame_lambda</a></div><div class="ttdeci">const double get_lame_lambda() const</div><div class="ttdef"><b>Definition</b> <a href="_solid_8cpp_source.html#l00153">Solid.cpp:153</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a3d971cfb0d2a1810e6b31830f1f4b900"><div class="ttname"><a href="classfemus_1_1_solid.html#a3d971cfb0d2a1810e6b31830f1f4b900">femus::Solid::get_poisson_coeff</a></div><div class="ttdeci">const double get_poisson_coeff() const</div><div class="ttdef"><b>Definition</b> <a href="_solid_8cpp_source.html#l00149">Solid.cpp:149</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a5f3228eab52c343a13167eaf73f568bc"><div class="ttname"><a href="classfemus_1_1_solid.html#a5f3228eab52c343a13167eaf73f568bc">femus::Solid::get_lame_shear_modulus</a></div><div class="ttdeci">const double get_lame_shear_modulus() const</div><div class="ttdef"><b>Definition</b> <a href="_solid_8cpp_source.html#l00157">Solid.cpp:157</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="_sparse_matrix_8hpp_source.html#l00047">SparseMatrix.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a45654dbe423d1970565b94c792ce6df3"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">femus::SparseMatrix::zero</a></div><div class="ttdeci">virtual void zero()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a6eb9fbd88830b0d10c88f0ce066b07ae"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">femus::SparseMatrix::close</a></div><div class="ttdeci">virtual void close() const =0</div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html"><div class="ttname"><a href="classfemus_1_1assemble__jacobian.html">femus::assemble_jacobian</a></div><div class="ttdef"><b>Definition</b> <a href="_assemble__jacobian_8hpp_source.html#l00026">Assemble_jacobian.hpp:26</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a298fb51789fa086f4ac3904b43336f76"><div class="ttname"><a href="classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">femus::assemble_jacobian::res_row_index</a></div><div class="ttdeci">static unsigned int res_row_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int my_row_pos, const int i)</div><div class="ttdef"><b>Definition</b> <a href="_assemble__jacobian_8hpp_source.html#l00284">Assemble_jacobian.hpp:284</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_afafa42b312f4db1f55298eb039ada1c6"><div class="ttname"><a href="classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">femus::assemble_jacobian::jac_row_col_index</a></div><div class="ttdeci">static unsigned int jac_row_col_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int nDof_AllVars, const int my_row_pos, const int my_col_pos, const int i, const int j)</div><div class="ttdef"><b>Definition</b> <a href="_assemble__jacobian_8hpp_source.html#l00296">Assemble_jacobian.hpp:296</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="_elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition</b> <a href="_elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a101671cfe5078b188740d5d892832ea9"><div class="ttname"><a href="solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a></div><div class="ttdeci">double cost_functional_coeff</div><div class="ttdef"><b>Definition</b> <a href="solidopt__params_8hpp_source.html#l00025">solidopt_params.hpp:25</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a20f4c4490bc8ecbdd1ffcb79acce6035"><div class="ttname"><a href="solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdef"><b>Definition</b> <a href="solidopt__params_8hpp_source.html#l00026">solidopt_params.hpp:26</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a491774c0485f249809d76f7933b79419"><div class="ttname"><a href="solidopt__params_8hpp.html#a491774c0485f249809d76f7933b79419">_gravity</a></div><div class="ttdeci">double _gravity[3]</div><div class="ttdef"><b>Definition</b> <a href="solidopt__params_8hpp_source.html#l00020">solidopt_params.hpp:20</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a80e1487a07155d5b24edd6eca186b73b"><div class="ttname"><a href="solidopt__params_8hpp.html#a80e1487a07155d5b24edd6eca186b73b">TargetDisp</a></div><div class="ttdeci">double TargetDisp[3]</div><div class="ttdef"><b>Definition</b> <a href="solidopt__params_8hpp_source.html#l00021">solidopt_params.hpp:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6b2e165d5cf19933c60a49927c5bf64" name="ad6b2e165d5cf19933c60a49927c5bf64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6b2e165d5cf19933c60a49927c5bf64">&#9670;&#160;</a></span>ComputeIntegral() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void ComputeIntegral </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l01041">1041</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1041</span>                                                       {</div>
<div class="line"><span class="lineno"> 1042</span>    ComputeIntegral&lt; system_type, real_num, real_num_mov &gt; (  ml_prob, </div>
<div class="line"><span class="lineno"> 1043</span>                                                            &amp; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0), </div>
<div class="line"><span class="lineno"> 1044</span>                                                              ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0).get_unknown_list_for_assembly());</div>
<div class="line"><span class="lineno"> 1045</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b4961693657f83b36edc7f4e2e17de6" name="a2b4961693657f83b36edc7f4e2e17de6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b4961693657f83b36edc7f4e2e17de6">&#9670;&#160;</a></span>ComputeIntegral() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void ComputeIntegral </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const system_type *&#160;</td>
          <td class="paramname"><em>mlPdeSys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="namespacefemus.html#classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l01048">1048</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1050</span>                                                            {</div>
<div class="line"><span class="lineno"> 1051</span> </div>
<div class="line"><span class="lineno"> 1052</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>        level       = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><span class="lineno"> 1053</span> </div>
<div class="line"><span class="lineno"> 1054</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>*                 msh         = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno"> 1055</span>  <a class="code hl_class" href="classfemus_1_1elem.html">elem</a>*                 el          = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>*       ml_sol  = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><span class="lineno"> 1058</span>  <a class="code hl_class" href="classfemus_1_1_solution.html">Solution</a>*             sol         = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level); </div>
<div class="line"><span class="lineno"> 1059</span> </div>
<div class="line"><span class="lineno"> 1060</span> </div>
<div class="line"><span class="lineno"> 1061</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>    <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno"> 1062</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>   dim2  = (3 * (<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1));</div>
<div class="line"><span class="lineno"> 1063</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  iproc  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno"> 1064</span>  <span class="comment">// reserve memory for the local standard vectors</span></div>
<div class="line"><span class="lineno"> 1065</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size_elem_dofs = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27 </span></div>
<div class="line"><span class="lineno"> 1066</span> </div>
<div class="line"><span class="lineno"> 1067</span>  </div>
<div class="line"><span class="lineno"> 1068</span>  <span class="comment">//----------- unknowns ------------------------------</span></div>
<div class="line"><span class="lineno"> 1069</span>   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><span class="lineno"> 1070</span>   </div>
<div class="line"><span class="lineno"> 1071</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> sol_index_displ      = 0;     <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno"> 1072</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press      = sol_index_displ + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      <span class="comment">//known at run time</span></div>
<div class="line"><span class="lineno"> 1073</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> state_pos_begin      = sol_index_displ;   <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno"> 1074</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> adj_pos_begin        = <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1;</div>
<div class="line"><span class="lineno"> 1075</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_adj        = adj_pos_begin;      </div>
<div class="line"><span class="lineno"> 1076</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press_adj  = sol_index_adj + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;     </div>
<div class="line"><span class="lineno"> 1077</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> ctrl_pos_begin       = 2 * (<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1);</div>
<div class="line"><span class="lineno"> 1078</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_ctrl       = ctrl_pos_begin;     </div>
<div class="line"><span class="lineno"> 1079</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press_ctrl = sol_index_ctrl + <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      </div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>  </div>
<div class="line"><span class="lineno"> 1082</span>  vector &lt; std::string &gt; Solname(n_unknowns);     </div>
<div class="line"><span class="lineno"> 1083</span>  vector &lt; unsigned int &gt; SolIndex(n_unknowns);  </div>
<div class="line"><span class="lineno"> 1084</span>  vector &lt; unsigned int &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><span class="lineno"> 1085</span>  vector &lt; unsigned int &gt; SolFEType(n_unknowns);  </div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span> </div>
<div class="line"><span class="lineno"> 1088</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno"> 1089</span>       Solname[ivar]    = unknowns[ivar]._name; </div>
<div class="line"><span class="lineno"> 1090</span>      SolIndex[ivar]    = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>        (Solname[ivar].c_str());</div>
<div class="line"><span class="lineno"> 1091</span><span class="comment">//     SolPdeIndex[ivar]    = mlPdeSys-&gt;GetSolPdeIndex(Solname[ivar].c_str());</span></div>
<div class="line"><span class="lineno"> 1092</span><span class="comment">//       assert(ivar == SolPdeIndex[ivar]);  //I would like this ivar order to coincide either with SolIndex or with SolPdeIndex, otherwise too many orders... it has to be  with SolPdeIndex, because SolIndex is related to the Solution object which can have more fields... This has to match the order of the unknowns[] argument</span></div>
<div class="line"><span class="lineno"> 1093</span>    SolFEType[ivar] = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(SolIndex[ivar]);<span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1094</span>  }</div>
<div class="line"><span class="lineno"> 1095</span> </div>
<div class="line"><span class="lineno"> 1096</span>   <span class="keyword">constexpr</span> <span class="keywordtype">int</span> solFEType_max = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>;  <span class="comment">//biquadratic, this is the highest-order FE </span></div>
<div class="line"><span class="lineno"> 1097</span> </div>
<div class="line"><span class="lineno"> 1098</span>   vector &lt; unsigned int &gt; Sol_n_el_dofs(n_unknowns);</div>
<div class="line"><span class="lineno"> 1099</span>  </div>
<div class="line"><span class="lineno"> 1100</span>  <span class="comment">//----------- of dofs and at quadrature points ------------------------------</span></div>
<div class="line"><span class="lineno"> 1101</span>  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1102</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp(n_unknowns);   <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here  //some of these should be real_num, some real_num_mov...</span></div>
<div class="line"><span class="lineno"> 1103</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp(n_unknowns);  <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here</span></div>
<div class="line"><span class="lineno"> 1104</span> </div>
<div class="line"><span class="lineno"> 1105</span>  vector &lt; vector &lt; double &gt; &gt; phi_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1106</span>  vector &lt; vector &lt; double &gt; &gt; phi_x_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1107</span>  vector &lt; vector &lt; double &gt; &gt; phi_xx_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1108</span> </div>
<div class="line"><span class="lineno"> 1109</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {  </div>
<div class="line"><span class="lineno"> 1110</span>        phi_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1111</span>    phi_hat_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1112</span>      phi_x_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1113</span>  phi_x_hat_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1114</span>     phi_xx_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1115</span> phi_xx_hat_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1116</span>   }</div>
<div class="line"><span class="lineno"> 1117</span>   </div>
<div class="line"><span class="lineno"> 1118</span>  <span class="comment">//----------- at dofs ------------------------------</span></div>
<div class="line"><span class="lineno"> 1119</span>  vector &lt; vector &lt; real_num &gt; &gt; SolVAR_eldofs(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { SolVAR_eldofs[k].reserve(max_size_elem_dofs); }</div>
<div class="line"><span class="lineno"> 1120</span> </div>
<div class="line"><span class="lineno"> 1121</span> </div>
<div class="line"><span class="lineno"> 1122</span>  <span class="comment">// geometry (at dofs) --------------------------------//</span></div>
<div class="line"><span class="lineno"> 1123</span>  vector&lt; vector &lt; real_num_mov &gt; &gt;   coords(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1124</span>  vector  &lt; vector  &lt; double &gt; &gt;  coords_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1125</span>  <span class="keywordtype">unsigned</span> coordsType = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE TENSOR-PRODUCT-QUADRATIC)</span></div>
<div class="line"><span class="lineno"> 1126</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {   </div>
<div class="line"><span class="lineno"> 1127</span>           coords[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno"> 1128</span>       coords_hat[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno"> 1129</span> }</div>
<div class="line"><span class="lineno"> 1130</span> </div>
<div class="line"><span class="lineno"> 1131</span> <span class="comment">//************** geometry phi **************************</span></div>
<div class="line"><span class="lineno"> 1132</span>  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp_domain(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1133</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp_domain(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1134</span>  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp_domain(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1135</span>  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp_domain_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1136</span>  vector &lt; vector &lt; double &gt; &gt; phi_x_dof_qp_domain_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1137</span>  vector &lt; vector &lt; double &gt; &gt; phi_xx_dof_qp_domain_hat(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1138</span> </div>
<div class="line"><span class="lineno"> 1139</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dom_coord = 0; dom_coord &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; dom_coord++) {</div>
<div class="line"><span class="lineno"> 1140</span>        phi_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1141</span>      phi_x_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1142</span>     phi_xx_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1143</span>        phi_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1144</span>      phi_x_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1145</span>     phi_xx_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1146</span>   }</div>
<div class="line"><span class="lineno"> 1147</span> </div>
<div class="line"><span class="lineno"> 1148</span>   <span class="comment">// geometry ------------------------------------------</span></div>
<div class="line"><span class="lineno"> 1149</span>  </div>
<div class="line"><span class="lineno"> 1150</span> </div>
<div class="line"><span class="lineno"> 1151</span>  <span class="comment">//------------ at quadrature points ---------------------</span></div>
<div class="line"><span class="lineno"> 1152</span>  real_num_mov weight_qp = 0.;<span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1153</span>    <span class="keywordtype">double</span> weight_hat_qp = 0.;</div>
<div class="line"><span class="lineno"> 1154</span>    vector &lt; real_num &gt; SolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1155</span>    vector &lt; real_num &gt; SolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1156</span>    vector &lt; vector &lt; real_num &gt; &gt; gradSolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1157</span>    vector &lt; vector &lt; real_num &gt; &gt; gradSolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1158</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { </div>
<div class="line"><span class="lineno"> 1159</span>          gradSolVAR_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1160</span>      gradSolVAR_hat_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1161</span>    }</div>
<div class="line"><span class="lineno"> 1162</span>      </div>
<div class="line"><span class="lineno"> 1163</span> </div>
<div class="line"><span class="lineno"> 1164</span> </div>
<div class="line"><span class="lineno"> 1165</span><span class="comment">// Displ_desired##################################################################</span></div>
<div class="line"><span class="lineno"> 1166</span>  vector &lt; double &gt; phi_des_dof_qp;</div>
<div class="line"><span class="lineno"> 1167</span>  vector &lt; real_num_mov &gt; phi_des_x_dof_qp;   <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here  //some of these should be real_num, some real_num_mov...</span></div>
<div class="line"><span class="lineno"> 1168</span>  vector &lt; real_num_mov &gt; phi_des_xx_dof_qp;  </div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span>  vector &lt; double &gt; phi_des_hat_dof_qp;</div>
<div class="line"><span class="lineno"> 1171</span>  vector &lt; double &gt; phi_des_x_hat_dof_qp;</div>
<div class="line"><span class="lineno"> 1172</span>  vector &lt; double &gt; phi_des_xx_hat_dof_qp;</div>
<div class="line"><span class="lineno"> 1173</span> </div>
<div class="line"><span class="lineno"> 1174</span>        phi_des_dof_qp.reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1175</span>      phi_des_x_dof_qp.reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1176</span>     phi_des_xx_dof_qp.reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1177</span>    phi_des_hat_dof_qp.reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1178</span>  phi_des_x_hat_dof_qp.reserve(max_size_elem_dofs * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1179</span> phi_des_xx_hat_dof_qp.reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1180</span>   </div>
<div class="line"><span class="lineno"> 1181</span>   </div>
<div class="line"><span class="lineno"> 1182</span>  vector &lt; real_num &gt;  SolDisp_eldofs(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,0.);</div>
<div class="line"><span class="lineno"> 1183</span>  vector &lt; real_num &gt; SolDisp_des_qp(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);  </div>
<div class="line"><span class="lineno"> 1184</span>  </div>
<div class="line"><span class="lineno"> 1185</span>  vector &lt; real_num &gt; SolDisp_des_hat_qp(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);  </div>
<div class="line"><span class="lineno"> 1186</span><span class="comment">// Displ_desired##################################################################</span></div>
<div class="line"><span class="lineno"> 1187</span> </div>
<div class="line"><span class="lineno"> 1188</span> </div>
<div class="line"><span class="lineno"> 1189</span> </div>
<div class="line"><span class="lineno"> 1190</span> </div>
<div class="line"><span class="lineno"> 1191</span>real_num  integral_target_alpha = 0.;</div>
<div class="line"><span class="lineno"> 1192</span>real_num    integral_beta   = 0.;</div>
<div class="line"><span class="lineno"> 1193</span>real_num    integral_gamma  = 0.;</div>
<div class="line"><span class="lineno"> 1194</span>  </div>
<div class="line"><span class="lineno"> 1195</span>  <span class="comment">// element loop: each process loops only on the elements that owns</span></div>
<div class="line"><span class="lineno"> 1196</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno"> 1197</span> </div>
<div class="line"><span class="lineno"> 1198</span> </div>
<div class="line"><span class="lineno"> 1199</span>   <span class="comment">//all vars ###################################################################  </span></div>
<div class="line"><span class="lineno"> 1200</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno"> 1201</span>    <span class="keywordtype">unsigned</span> ndofs_unk = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolFEType[k]);</div>
<div class="line"><span class="lineno"> 1202</span>       Sol_n_el_dofs[k] = ndofs_unk;</div>
<div class="line"><span class="lineno"> 1203</span>       SolVAR_eldofs[k].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno"> 1204</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; SolVAR_eldofs[k].size(); i++) {</div>
<div class="line"><span class="lineno"> 1205</span>       <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolFEType[k]);</div>
<div class="line"><span class="lineno"> 1206</span>       SolVAR_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex[k]])(solDof);</div>
<div class="line"><span class="lineno"> 1207</span>      }</div>
<div class="line"><span class="lineno"> 1208</span>    }</div>
<div class="line"><span class="lineno"> 1209</span>   <span class="comment">//all vars ###################################################################</span></div>
<div class="line"><span class="lineno"> 1210</span>  </div>
<div class="line"><span class="lineno"> 1211</span>    </div>
<div class="line"><span class="lineno"> 1212</span>  <span class="comment">// geometry *****************************</span></div>
<div class="line"><span class="lineno"> 1213</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno"> 1214</span> </div>
<div class="line"><span class="lineno"> 1215</span>      <span class="keywordtype">unsigned</span> nDofsX = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, coordsType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno"> 1216</span>    </div>
<div class="line"><span class="lineno"> 1217</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ivar=0; ivar&lt;<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno"> 1218</span>      coords[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno"> 1219</span>      coords_hat[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno"> 1220</span>    }</div>
<div class="line"><span class="lineno"> 1221</span>    </div>
<div class="line"><span class="lineno"> 1222</span>   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno"> 1223</span>      <span class="keywordtype">unsigned</span> coordsDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, coordsType);    <span class="comment">// global to global mapping between coordinates node and coordinate dof // via local to global solution node</span></div>
<div class="line"><span class="lineno"> 1224</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno"> 1225</span>          <span class="comment">//Fixed coordinates (Reference frame)</span></div>
<div class="line"><span class="lineno"> 1226</span>    coords_hat[ivar][i] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[ivar])(coordsDof);</div>
<div class="line"><span class="lineno"> 1227</span>      }</div>
<div class="line"><span class="lineno"> 1228</span>    }</div>
<div class="line"><span class="lineno"> 1229</span> </div>
<div class="line"><span class="lineno"> 1230</span>  <span class="comment">//***************************************  </span></div>
<div class="line"><span class="lineno"> 1231</span>    assert(nDofsX == Sol_n_el_dofs[sol_index_displ]);</div>
<div class="line"><span class="lineno"> 1232</span>    <span class="comment">//Moving coordinates (Moving frame)</span></div>
<div class="line"><span class="lineno"> 1233</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno"> 1234</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofsX; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1235</span>          coords[idim][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = coords_hat[idim][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + SolVAR_eldofs[SolIndex[idim]][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1236</span>        }</div>
<div class="line"><span class="lineno"> 1237</span>      }</div>
<div class="line"><span class="lineno"> 1238</span>  </div>
<div class="line"><span class="lineno"> 1239</span>     <span class="comment">// elem average point </span></div>
<div class="line"><span class="lineno"> 1240</span>    vector &lt; double &gt; elem_center(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);   </div>
<div class="line"><span class="lineno"> 1241</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0.;  }</div>
<div class="line"><span class="lineno"> 1242</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  </div>
<div class="line"><span class="lineno"> 1243</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno"> 1244</span>         elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += coords_hat[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i];</div>
<div class="line"><span class="lineno"> 1245</span>       }</div>
<div class="line"><span class="lineno"> 1246</span>    }</div>
<div class="line"><span class="lineno"> 1247</span>    </div>
<div class="line"><span class="lineno"> 1248</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) { elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = elem_center[<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]/nDofsX; }</div>
<div class="line"><span class="lineno"> 1249</span>  <span class="comment">//*************************************** </span></div>
<div class="line"><span class="lineno"> 1250</span>  </div>
<div class="line"><span class="lineno"> 1251</span>  <span class="comment">//***** set target domain flag ********************************** </span></div>
<div class="line"><span class="lineno"> 1252</span>   <span class="keywordtype">int</span> target_flag = 0;</div>
<div class="line"><span class="lineno"> 1253</span>   target_flag = ElementTargetFlag &lt; double &gt;(elem_center); <span class="comment">//domain is considered wrt moving</span></div>
<div class="line"><span class="lineno"> 1254</span> </div>
<div class="line"><span class="lineno"> 1255</span>  <span class="comment">// geometry end *****************************</span></div>
<div class="line"><span class="lineno"> 1256</span> </div>
<div class="line"><span class="lineno"> 1257</span> </div>
<div class="line"><span class="lineno"> 1258</span>  <span class="comment">//DESIRED DISPL###################################################################  </span></div>
<div class="line"><span class="lineno"> 1259</span>    <span class="comment">// displacement ************</span></div>
<div class="line"><span class="lineno"> 1260</span><span class="comment">//     for (unsigned i = 0; i &lt; Sol_n_el_dofs[sol_index_displ]; i++) {</span></div>
<div class="line"><span class="lineno"> 1261</span><span class="comment">//       unsigned solDdesDof = msh-&gt;GetSolutionDof(i, iel, solDType);    // global to global mapping between solution node and solution dof</span></div>
<div class="line"><span class="lineno"> 1262</span> </div>
<div class="line"><span class="lineno"> 1263</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; SolDisp_eldofs.size() <span class="comment">/*dim*/</span>; k++) {</div>
<div class="line"><span class="lineno"> 1264</span>        SolDisp_eldofs[k]<span class="comment">/*[i]*/</span> = <a class="code hl_variable" href="solidopt__params_8hpp.html#a80e1487a07155d5b24edd6eca186b73b">TargetDisp</a>[k] <span class="comment">/*(*sol-&gt;_Sol[solDIndex[k]])(solDdesDof)*/</span>;      <span class="comment">// global extraction and local storage for the solution</span></div>
<div class="line"><span class="lineno"> 1265</span>      }</div>
<div class="line"><span class="lineno"> 1266</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno"> 1267</span> <span class="comment">//DESIRED DISPL###################################################################</span></div>
<div class="line"><span class="lineno"> 1268</span> </div>
<div class="line"><span class="lineno"> 1269</span>      <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno"> 1270</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom).GetGaussPointsNumber(); <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno"> 1271</span> </div>
<div class="line"><span class="lineno"> 1272</span>    <span class="comment">// *** get Jacobian and test function and test function derivatives ***</span></div>
<div class="line"><span class="lineno"> 1273</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {</div>
<div class="line"><span class="lineno"> 1274</span>    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,    phi_dof_qp[unk],    phi_x_dof_qp[unk],    phi_xx_dof_qp[unk]);</div>
<div class="line"><span class="lineno"> 1275</span>    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_hat_qp,phi_hat_dof_qp[unk],phi_x_hat_dof_qp[unk],phi_xx_hat_dof_qp[unk]);</div>
<div class="line"><span class="lineno"> 1276</span>      }</div>
<div class="line"><span class="lineno"> 1277</span>      </div>
<div class="line"><span class="lineno"> 1278</span>   <span class="comment">//=============== Integration at qp ========================================</span></div>
<div class="line"><span class="lineno"> 1279</span>         <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN...</span></div>
<div class="line"><span class="lineno"> 1280</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 1281</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_qp,    phi_dof_qp_domain[d],     phi_x_dof_qp_domain[d],     phi_xx_dof_qp_domain[d]);</div>
<div class="line"><span class="lineno"> 1282</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_hat_qp,phi_dof_qp_domain_hat[d], phi_x_dof_qp_domain_hat[d], phi_xx_dof_qp_domain_hat[d]);</div>
<div class="line"><span class="lineno"> 1283</span>      }</div>
<div class="line"><span class="lineno"> 1284</span>     </div>
<div class="line"><span class="lineno"> 1285</span>  <span class="comment">//begin unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno"> 1286</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> unk = 0; unk &lt;  n_unknowns; unk++) {</div>
<div class="line"><span class="lineno"> 1287</span>      SolVAR_qp[unk] = 0.;</div>
<div class="line"><span class="lineno"> 1288</span>      SolVAR_hat_qp[unk] = 0.;</div>
<div class="line"><span class="lineno"> 1289</span> </div>
<div class="line"><span class="lineno"> 1290</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++){ </div>
<div class="line"><span class="lineno"> 1291</span>        gradSolVAR_qp[unk][ivar2] = 0.; </div>
<div class="line"><span class="lineno"> 1292</span>        gradSolVAR_hat_qp[unk][ivar2] = 0.; </div>
<div class="line"><span class="lineno"> 1293</span>      }</div>
<div class="line"><span class="lineno"> 1294</span>      </div>
<div class="line"><span class="lineno"> 1295</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[unk]; i++) {</div>
<div class="line"><span class="lineno"> 1296</span>        SolVAR_qp[unk]    += phi_dof_qp[ unk ][i] * SolVAR_eldofs[unk][i];</div>
<div class="line"><span class="lineno"> 1297</span>        SolVAR_hat_qp[unk]    += phi_hat_dof_qp[ unk ][i] * SolVAR_eldofs[unk][i];</div>
<div class="line"><span class="lineno"> 1298</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2 = 0; ivar2 &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {</div>
<div class="line"><span class="lineno"> 1299</span>          gradSolVAR_qp[unk][ivar2]     += phi_x_dof_qp[ unk ][i*<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[unk][i]; </div>
<div class="line"><span class="lineno"> 1300</span>          gradSolVAR_hat_qp[unk][ivar2] += phi_x_hat_dof_qp[ unk ][i*<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[unk][i]; </div>
<div class="line"><span class="lineno"> 1301</span>        }</div>
<div class="line"><span class="lineno"> 1302</span>      }</div>
<div class="line"><span class="lineno"> 1303</span>      </div>
<div class="line"><span class="lineno"> 1304</span>    }  </div>
<div class="line"><span class="lineno"> 1305</span> <span class="comment">//end unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno"> 1306</span> </div>
<div class="line"><span class="lineno"> 1307</span>    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[sol_index_displ]  <span class="comment">/*SolDisp_eldofs*/</span>]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords, <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_qp, phi_des_dof_qp, phi_des_x_dof_qp, phi_des_xx_dof_qp);</div>
<div class="line"><span class="lineno"> 1308</span>    msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[sol_index_displ]  <span class="comment">/*SolDisp_eldofs*/</span>]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat, <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_hat_qp, phi_des_hat_dof_qp, phi_des_x_hat_dof_qp, phi_des_xx_hat_dof_qp);</div>
<div class="line"><span class="lineno"> 1309</span> </div>
<div class="line"><span class="lineno"> 1310</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {      SolDisp_des_qp[k]    = 0.;     }</div>
<div class="line"><span class="lineno"> 1311</span>    </div>
<div class="line"><span class="lineno"> 1312</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1313</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_displ]; i++) {</div>
<div class="line"><span class="lineno"> 1314</span>                SolDisp_des_qp[k] += SolDisp_eldofs[k]<span class="comment">/*[i]*/</span> * phi_des_dof_qp[i];</div>
<div class="line"><span class="lineno"> 1315</span>            SolDisp_des_hat_qp[k] += SolDisp_eldofs[k]<span class="comment">/*[i]*/</span> * phi_des_hat_dof_qp[i];</div>
<div class="line"><span class="lineno"> 1316</span>        }</div>
<div class="line"><span class="lineno"> 1317</span>      }</div>
<div class="line"><span class="lineno"> 1318</span>    </div>
<div class="line"><span class="lineno"> 1319</span>      </div>
<div class="line"><span class="lineno"> 1320</span>          </div>
<div class="line"><span class="lineno"> 1321</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {  </div>
<div class="line"><span class="lineno"> 1322</span>          integral_target_alpha += target_flag * (SolVAR_qp[SolIndex[k]] + SolVAR_qp[SolIndex[k + ctrl_pos_begin]] - SolDisp_des_qp[k]) * </div>
<div class="line"><span class="lineno"> 1323</span>                                                 (SolVAR_qp[SolIndex[k]] + SolVAR_qp[SolIndex[k + ctrl_pos_begin]] - SolDisp_des_qp[k]) * weight_qp; </div>
<div class="line"><span class="lineno"> 1324</span>          integral_beta  += SolVAR_qp[SolIndex[k + ctrl_pos_begin]] *SolVAR_qp[SolIndex[k + ctrl_pos_begin]] * weight_qp;</div>
<div class="line"><span class="lineno"> 1325</span> </div>
<div class="line"><span class="lineno"> 1326</span>                }</div>
<div class="line"><span class="lineno"> 1327</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1328</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {   </div>
<div class="line"><span class="lineno"> 1329</span>            integral_gamma    +=  gradSolVAR_qp[SolIndex[k + ctrl_pos_begin]][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * gradSolVAR_qp[SolIndex[k + ctrl_pos_begin]][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * weight_qp;</div>
<div class="line"><span class="lineno"> 1330</span>        }</div>
<div class="line"><span class="lineno"> 1331</span>      }</div>
<div class="line"><span class="lineno"> 1332</span>   </div>
<div class="line"><span class="lineno"> 1333</span>  </div>
<div class="line"><span class="lineno"> 1334</span>      }<span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno"> 1335</span>    } <span class="comment">//end element loop  </span></div>
<div class="line"><span class="lineno"> 1336</span> </div>
<div class="line"><span class="lineno"> 1337</span>       std::ostringstream filename_out; filename_out &lt;&lt; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a274e91e352c0d6b69c5925fdfca67d1f">GetFilesHandler</a>()-&gt;<a class="code hl_function" href="classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Integral_computation&quot;</span>  &lt;&lt; <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><span class="lineno"> 1338</span> </div>
<div class="line"><span class="lineno"> 1339</span>       std::ofstream intgr_fstream;</div>
<div class="line"><span class="lineno"> 1340</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="namespacefemus_1_1paral.html#aaa59cb24784a64914811ba1045135a05">paral::get_rank</a>() == 0 ) {</div>
<div class="line"><span class="lineno"> 1341</span>      intgr_fstream.open(filename_out.str().c_str(),std::ios_base::app);</div>
<div class="line"><span class="lineno"> 1342</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot; ***************************** Non Linear Iteration &quot;</span>&lt;&lt; mlPdeSys-&gt;GetNonlinearIt() &lt;&lt; <span class="stringliteral">&quot; *********************************** &quot;</span> &lt;&lt;  std::endl &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1343</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the target functional for &quot;</span> &lt;&lt; <span class="stringliteral">&quot;alpha &quot;</span> &lt;&lt;   std::setprecision(0) &lt;&lt; std::scientific &lt;&lt; <a class="code hl_variable" href="solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt;  std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_target_alpha &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1344</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the L2 control for        &quot;</span> &lt;&lt; <span class="stringliteral">&quot;beta  &quot;</span> &lt;&lt;   std::setprecision(0) &lt;&lt; std::scientific &lt;&lt; <a class="code hl_variable" href="solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>  &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt;  std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_beta         &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1345</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the H1 control for        &quot;</span> &lt;&lt; <span class="stringliteral">&quot;gamma &quot;</span> &lt;&lt;   std::setprecision(0) &lt;&lt; std::scientific &lt;&lt; <a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt;  std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_gamma        &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1346</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the total integral is &quot;</span> &lt;&lt; std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_target_alpha * <a class="code hl_variable" href="solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a>*0.5  + integral_beta *<a class="code hl_variable" href="solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>*0.5 + integral_gamma *<a class="code hl_variable" href="_conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a>*0.5 &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1347</span>      intgr_fstream &lt;&lt;  std::endl;</div>
<div class="line"><span class="lineno"> 1348</span>      intgr_fstream.close();  <span class="comment">//you have to close to disassociate the file from the stream</span></div>
<div class="line"><span class="lineno"> 1349</span>}  </div>
<div class="line"><span class="lineno"> 1350</span> </div>
<div class="line"><span class="lineno"> 1351</span>    <span class="keywordflow">return</span>; </div>
<div class="line"><span class="lineno"> 1352</span>      </div>
<div class="line"><span class="lineno"> 1353</span>  </div>
<div class="line"><span class="lineno"> 1354</span>}</div>
<div class="ttc" id="aclassfemus_1_1_files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition</b> <a href="_files_8hpp_source.html#l00064">Files.hpp:64</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a274e91e352c0d6b69c5925fdfca67d1f"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a274e91e352c0d6b69c5925fdfca67d1f">femus::MultiLevelProblem::GetFilesHandler</a></div><div class="ttdeci">const Files * GetFilesHandler() const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00425">MultiLevelProblem.hpp:425</a></div></div>
<div class="ttc" id="anamespacefemus_1_1paral_html_aaa59cb24784a64914811ba1045135a05"><div class="ttname"><a href="namespacefemus_1_1paral.html#aaa59cb24784a64914811ba1045135a05">femus::paral::get_rank</a></div><div class="ttdeci">int get_rank()</div><div class="ttdef"><b>Definition</b> <a href="paral_8hpp_source.html#l00049">paral.hpp:49</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a29781a20c5dd4153c3c1cecf0ff328" name="a7a29781a20c5dd4153c3c1cecf0ff328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a29781a20c5dd4153c3c1cecf0ff328">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l00275">275</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  275</span>                                {</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>  <span class="comment">// ======= Init ==========================</span></div>
<div class="line"><span class="lineno">  278</span>  <a class="code hl_class" href="classfemus_1_1_femus_init.html">FemusInit</a> mpinit(argc, args, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>  <span class="comment">// ======= Files ==================</span></div>
<div class="line"><span class="lineno">  281</span>  <a class="code hl_class" href="classfemus_1_1_files.html">Files</a> files;</div>
<div class="line"><span class="lineno">  282</span>        files.<a class="code hl_function" href="classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">CheckIODirectories</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  283</span>        files.<a class="code hl_function" href="classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">RedirectCout</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>    std::string input_file = <span class="stringliteral">&quot;cyl.med&quot;</span>;</div>
<div class="line"><span class="lineno">  286</span>  std::ostringstream mystream; mystream &lt;&lt; <span class="stringliteral">&quot;./&quot;</span> &lt;&lt; <a class="code hl_define" href="_femus_default_8hpp.html#a8e12c4926d6c36bf00835a092bc0e310">DEFAULT_INPUTDIR</a>  &lt;&lt; <span class="stringliteral">&quot;/&quot;</span>  &lt;&lt; input_file;</div>
<div class="line"><span class="lineno">  287</span>  <span class="keyword">const</span> std::string infile = mystream.str();</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>  <span class="comment">// ======= Quad Rule ========================</span></div>
<div class="line"><span class="lineno">  290</span>  std::string quad_rule_order(<span class="stringliteral">&quot;fifth&quot;</span>);</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>  <span class="comment">// ======= Problem ========================</span></div>
<div class="line"><span class="lineno">  293</span>    <a class="code hl_class" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob;</div>
<div class="line"><span class="lineno">  294</span>  ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a8b72e984b63d5ff97c1e7a0f0a5eee5a">SetQuadratureRuleAllGeomElems</a>(quad_rule_order);</div>
<div class="line"><span class="lineno">  295</span>  ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a623bdc2aefd83cf0c6d74fc265ee5c3f">SetFilesHandler</a>(&amp;files);</div>
<div class="line"><span class="lineno">  296</span>    </div>
<div class="line"><span class="lineno">  297</span>  <span class="comment">// ======= Mesh ==================</span></div>
<div class="line"><span class="lineno">  298</span>  <span class="keyword">const</span> <a class="code hl_enumeration" href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a> geom_elem_type = <a class="code hl_enumvalue" href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a>;</div>
<div class="line"><span class="lineno">  299</span>  <span class="keyword">const</span> std::vector&lt; unsigned int &gt; nsub = {<a class="code hl_define" href="solidopt__params_8hpp.html#a40646ef4581e21d1eac608c36580fff3">NSUB</a>, <a class="code hl_define" href="solidopt__params_8hpp.html#a40646ef4581e21d1eac608c36580fff3">NSUB</a>, 0};</div>
<div class="line"><span class="lineno">  300</span>  <span class="keyword">const</span> std::vector&lt; double &gt;      xyz_min = {0., 0., 0.};</div>
<div class="line"><span class="lineno">  301</span>  <span class="keyword">const</span> std::vector&lt; double &gt;      xyz_max = {1., 1., 0.};</div>
<div class="line"><span class="lineno">  302</span> </div>
<div class="line"><span class="lineno">  303</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_mesh;</div>
<div class="line"><span class="lineno">  304</span><span class="comment">//   ml_mesh.GenerateCoarseBoxMesh(nsub[0],nsub[1],nsub[2],xyz_min[0],xyz_max[0],xyz_min[1],xyz_max[1],xyz_min[2],xyz_max[2],geom_elem_type,quad_rule_order.c_str());</span></div>
<div class="line"><span class="lineno">  305</span>   ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a29d0d0f9463c9417d390da6149ffc24d">ReadCoarseMesh</a>(infile.c_str(),quad_rule_order.c_str(), 1.<span class="comment">/*Lref*/</span>);</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>  <span class="comment">// ======= Unknowns ========================</span></div>
<div class="line"><span class="lineno">  308</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dimension = ml_mesh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();  </div>
<div class="line"><span class="lineno">  309</span>  std::vector&lt; Unknown &gt; unknowns = <a class="code hl_function" href="zzz__giorgiobornia__collect__all_8cpp.html#aa6cf7e343af28b995b6fab3d3528f6ef">provide_list_of_unknowns</a>(dimension);</div>
<div class="line"><span class="lineno">  310</span>  </div>
<div class="line"><span class="lineno">  311</span>  <span class="comment">// ======= Normal run ========================   //if you don&#39;t want the convergence study</span></div>
<div class="line"><span class="lineno">  312</span>  <a class="code hl_class" href="class_solution__generation__1.html">Solution_generation_1&lt; adept::adouble &gt;</a> my_main;</div>
<div class="line"><span class="lineno">  313</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_levels = 1;</div>
<div class="line"><span class="lineno">  314</span>  my_main.<a class="code hl_function" href="class_solution__generation__1.html#a2a0001fac52be7a97cc9cc3c901c5f9f">run_on_single_level</a>(ml_prob, ml_mesh, n_levels, unknowns, std::vector&lt; Math::Function &lt;double&gt; * &gt; (), <a class="code hl_function" href="02__solid__control__lifting_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a>, <a class="code hl_function" href="02__solid__control__lifting_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a>, <span class="keyword">true</span>); </div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  </div>
<div class="line"><span class="lineno">  317</span>  </div>
<div class="line"><span class="lineno">  318</span><span class="comment">//   // ======= Convergence study ========================</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">//     </span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">//    //set coarse storage mesh (should write the copy constructor or &quot;=&quot; operator to copy the previous mesh) ==================</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">//    MultiLevelMesh ml_mesh_all_levels;</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">//    ml_mesh_all_levels.GenerateCoarseBoxMesh(nsub[0],nsub[1],nsub[2],xyz_min[0],xyz_max[0],xyz_min[1],xyz_max[1],xyz_min[2],xyz_max[2],geom_elem_type,quad_rule_order.c_str());</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">//    //   ml_mesh_all_levels.ReadCoarseMesh(infile.c_str(),quad_rule_order.c_str(),1.);</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">//  </span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">//    // convergence choices ================  </span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">//    unsigned int max_number_of_meshes;               // set total number of levels ================  </span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">//    if (nsub[2] == 0)   max_number_of_meshes = 3;</span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">//    else                max_number_of_meshes = 4;</span></div>
<div class="line"><span class="lineno">  330</span><span class="comment">//   </span></div>
<div class="line"><span class="lineno">  331</span><span class="comment">// //    My_exact_solution&lt;&gt; exact_sol;                //provide exact solution, if available ==============</span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">//    const unsigned conv_order_flag = 0;              //Choose how to compute the convergence order ========= //0: incremental 1: absolute (with analytical sol)  2: absolute (with projection of finest sol)...</span></div>
<div class="line"><span class="lineno">  333</span><span class="comment">//    const unsigned norm_flag = 1;                    //Choose what norms to compute (//0 = only L2: //1 = L2 + H1) ==============</span></div>
<div class="line"><span class="lineno">  334</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">//    </span></div>
<div class="line"><span class="lineno">  336</span><span class="comment">//    // object ================  </span></div>
<div class="line"><span class="lineno">  337</span><span class="comment">//     FE_convergence&lt;&gt;  fe_convergence;</span></div>
<div class="line"><span class="lineno">  338</span><span class="comment">//     </span></div>
<div class="line"><span class="lineno">  339</span><span class="comment">//     fe_convergence.convergence_study( ... );</span></div>
<div class="line"><span class="lineno">  340</span>  </div>
<div class="line"><span class="lineno">  341</span>    </div>
<div class="line"><span class="lineno">  342</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  343</span>}</div>
<div class="ttc" id="a02__solid__control__lifting_8cpp_html_a1afc17d1ddb3752caf6910ec9a7c39ef"><div class="ttname"><a href="02__solid__control__lifting_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a></div><div class="ttdeci">bool Solution_set_boundary_conditions(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="02__solid__control__lifting_8cpp_source.html#l00071">02_solid_control_lifting.cpp:71</a></div></div>
<div class="ttc" id="a02__solid__control__lifting_8cpp_html_a5dec9191b407f5f1913e563b23777741"><div class="ttname"><a href="02__solid__control__lifting_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a></div><div class="ttdeci">double Solution_set_initial_conditions(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</div><div class="ttdef"><b>Definition</b> <a href="02__solid__control__lifting_8cpp_source.html#l00023">02_solid_control_lifting.cpp:23</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627"><div class="ttname"><a href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition</b> <a href="_elem_type_enum_8hpp_source.html#l00006">ElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59"><div class="ttname"><a href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a></div><div class="ttdeci">@ QUAD9</div><div class="ttdef"><b>Definition</b> <a href="_elem_type_enum_8hpp_source.html#l00016">ElemTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_a8e12c4926d6c36bf00835a092bc0e310"><div class="ttname"><a href="_femus_default_8hpp.html#a8e12c4926d6c36bf00835a092bc0e310">DEFAULT_INPUTDIR</a></div><div class="ttdeci">#define DEFAULT_INPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00039">FemusDefault.hpp:39</a></div></div>
<div class="ttc" id="aclass_solution__generation__1_html"><div class="ttname"><a href="class_solution__generation__1.html">Solution_generation_1</a></div><div class="ttdef"><b>Definition</b> <a href="ex02__poisson__convergence_8cpp_source.html#l00116">ex02_poisson_convergence.cpp:116</a></div></div>
<div class="ttc" id="aclass_solution__generation__1_html_a2a0001fac52be7a97cc9cc3c901c5f9f"><div class="ttname"><a href="class_solution__generation__1.html#a2a0001fac52be7a97cc9cc3c901c5f9f">Solution_generation_1::run_on_single_level</a></div><div class="ttdeci">const MultiLevelSolution run_on_single_level(MultiLevelProblem &amp;ml_prob, MultiLevelMesh &amp;ml_mesh, const unsigned i, const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; Math::Function&lt; double &gt; * &gt; &amp;exact_sol, const MultiLevelSolution::InitFuncMLProb SetInitialCondition_in, const MultiLevelSolution::BoundaryFuncMLProb SetBoundaryCondition_in, const bool equation_solve) const</div><div class="ttdef"><b>Definition</b> <a href="ex02__poisson__convergence_8cpp_source.html#l00307">ex02_poisson_convergence.cpp:307</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html"><div class="ttname"><a href="classfemus_1_1_files.html">femus::Files</a></div><div class="ttdef"><b>Definition</b> <a href="_files_8hpp_source.html#l00040">Files.hpp:40</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_aac199200ffda7ba50611cc41f6a874bc"><div class="ttname"><a href="classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">femus::Files::RedirectCout</a></div><div class="ttdeci">void RedirectCout(const bool redirect_cout_to_file) const</div><div class="ttdef"><b>Definition</b> <a href="_files_8cpp_source.html#l00553">Files.cpp:553</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab8c41974c4980d87c7e1467b153854e6"><div class="ttname"><a href="classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">femus::Files::CheckIODirectories</a></div><div class="ttdeci">void CheckIODirectories(const bool use_output_time_folder)</div><div class="ttdef"><b>Definition</b> <a href="_files_8cpp_source.html#l00515">Files.cpp:515</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a29d0d0f9463c9417d390da6149ffc24d"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a29d0d0f9463c9417d390da6149ffc24d">femus::MultiLevelMesh::ReadCoarseMesh</a></div><div class="ttdeci">void ReadCoarseMesh(const char mesh_file[], const char GaussOrder[], const double Lref)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00389">MultiLevelMesh.cpp:389</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a65dabdf1e308c1a44ebe5c6a41d09284"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">femus::MultiLevelMesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00541">MultiLevelMesh.cpp:541</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a623bdc2aefd83cf0c6d74fc265ee5c3f"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a623bdc2aefd83cf0c6d74fc265ee5c3f">femus::MultiLevelProblem::SetFilesHandler</a></div><div class="ttdeci">void SetFilesHandler(const Files *files_in)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00423">MultiLevelProblem.hpp:423</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a8b72e984b63d5ff97c1e7a0f0a5eee5a"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a8b72e984b63d5ff97c1e7a0f0a5eee5a">femus::MultiLevelProblem::SetQuadratureRuleAllGeomElems</a></div><div class="ttdeci">void SetQuadratureRuleAllGeomElems(const std::string quadr_order_in)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8cpp_source.html#l00177">MultiLevelProblem.cpp:177</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a40646ef4581e21d1eac608c36580fff3"><div class="ttname"><a href="solidopt__params_8hpp.html#a40646ef4581e21d1eac608c36580fff3">NSUB</a></div><div class="ttdeci">#define NSUB</div><div class="ttdef"><b>Definition</b> <a href="solidopt__params_8hpp_source.html#l00007">solidopt_params.hpp:7</a></div></div>
<div class="ttc" id="azzz__giorgiobornia__collect__all_8cpp_html_aa6cf7e343af28b995b6fab3d3528f6ef"><div class="ttname"><a href="zzz__giorgiobornia__collect__all_8cpp.html#aa6cf7e343af28b995b6fab3d3528f6ef">provide_list_of_unknowns</a></div><div class="ttdeci">const std::vector&lt; Unknown &gt; provide_list_of_unknowns()</div><div class="ttdef"><b>Definition</b> <a href="zzz__giorgiobornia__collect__all_8cpp_source.html#l00617">zzz_giorgiobornia_collect_all.cpp:617</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6917621ec8f1cbd9eda71cf3f12de89c" name="a6917621ec8f1cbd9eda71cf3f12de89c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6917621ec8f1cbd9eda71cf3f12de89c">&#9670;&#160;</a></span>provide_list_of_unknowns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; <a class="el" href="namespacefemus.html#classfemus_1_1_unknown">Unknown</a> &gt; provide_list_of_unknowns </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>dimension</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l00188">188</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>                                                                                    {</div>
<div class="line"><span class="lineno">  189</span>     </div>
<div class="line"><span class="lineno">  190</span>     </div>
<div class="line"><span class="lineno">  191</span>  std::vector&lt; FEFamily &gt; feFamily;</div>
<div class="line"><span class="lineno">  192</span>  std::vector&lt; FEOrder &gt;   feOrder;</div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);   <span class="comment">//state</span></div>
<div class="line"><span class="lineno">  195</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  196</span>  <span class="keywordflow">if</span> (dimension == 3)   feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  197</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a><span class="comment">/*DISCONTINOUS_POLYNOMIAL*/</span>);</div>
<div class="line"><span class="lineno">  198</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);   <span class="comment">//adjoint</span></div>
<div class="line"><span class="lineno">  199</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordflow">if</span> (dimension == 3)   feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  201</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a><span class="comment">/*DISCONTINOUS_POLYNOMIAL*/</span>);</div>
<div class="line"><span class="lineno">  202</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);   <span class="comment">//control</span></div>
<div class="line"><span class="lineno">  203</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  204</span>  <span class="keywordflow">if</span> (dimension == 3)   feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  205</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a><span class="comment">/*DISCONTINOUS_POLYNOMIAL*/</span>);</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  208</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  209</span>  <span class="keywordflow">if</span> (dimension == 3)   feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  210</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>);</div>
<div class="line"><span class="lineno">  211</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  212</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  213</span>  <span class="keywordflow">if</span> (dimension == 3)   feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  214</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>);</div>
<div class="line"><span class="lineno">  215</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  216</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  217</span>  <span class="keywordflow">if</span> (dimension == 3)   feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  218</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span> </div>
<div class="line"><span class="lineno">  221</span>  assert( feFamily.size() == feOrder.size() );</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span> std::vector&lt; Unknown &gt;  unknowns(feFamily.size());</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> adj_pos_begin   = dimension + 1;</div>
<div class="line"><span class="lineno">  226</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ctrl_pos_begin  = 2 * (dimension + 1);</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>                                        unknowns[0]._name      = <span class="stringliteral">&quot;DX&quot;</span>;</div>
<div class="line"><span class="lineno">  229</span>                                        unknowns[1]._name      = <span class="stringliteral">&quot;DY&quot;</span>;</div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordflow">if</span> (dimension == 3)                   unknowns[2]._name      = <span class="stringliteral">&quot;DZ&quot;</span>;</div>
<div class="line"><span class="lineno">  231</span>                                unknowns[dimension]._name      = <span class="stringliteral">&quot;P&quot;</span>;</div>
<div class="line"><span class="lineno">  232</span>                        unknowns[adj_pos_begin + 0]._name      = <span class="stringliteral">&quot;DX_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  233</span>                        unknowns[adj_pos_begin + 1]._name      = <span class="stringliteral">&quot;DY_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  234</span>  <span class="keywordflow">if</span> (dimension == 3)   unknowns[adj_pos_begin + 2]._name      = <span class="stringliteral">&quot;DZ_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  235</span>                unknowns[adj_pos_begin + dimension]._name      = <span class="stringliteral">&quot;P_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  236</span>                       unknowns[ctrl_pos_begin + 0]._name      = <span class="stringliteral">&quot;DX_CTRL&quot;</span>;</div>
<div class="line"><span class="lineno">  237</span>                       unknowns[ctrl_pos_begin + 1]._name      = <span class="stringliteral">&quot;DY_CTRL&quot;</span>;</div>
<div class="line"><span class="lineno">  238</span>  <span class="keywordflow">if</span> (dimension == 3)  unknowns[ctrl_pos_begin + 2]._name      = <span class="stringliteral">&quot;DZ_CTRL&quot;</span>;</div>
<div class="line"><span class="lineno">  239</span>               unknowns[ctrl_pos_begin + dimension]._name      = <span class="stringliteral">&quot;P_CTRL&quot;</span>;</div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++) {</div>
<div class="line"><span class="lineno">  242</span>         </div>
<div class="line"><span class="lineno">  243</span>              unknowns[u]._fe_family  = feFamily[u];</div>
<div class="line"><span class="lineno">  244</span>              unknowns[u]._fe_order   = feOrder[u];</div>
<div class="line"><span class="lineno">  245</span>              unknowns[u]._time_order = 0;</div>
<div class="line"><span class="lineno">  246</span>              unknowns[u]._is_pde_unknown = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  247</span>              </div>
<div class="line"><span class="lineno">  248</span>     }</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>   <span class="keywordflow">return</span> unknowns;</div>
<div class="line"><span class="lineno">  252</span>     </div>
<div class="line"><span class="lineno">  253</span>}</div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00018">FElemTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1afc17d1ddb3752caf6910ec9a7c39ef" name="a1afc17d1ddb3752caf6910ec9a7c39ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1afc17d1ddb3752caf6910ec9a7c39ef">&#9670;&#160;</a></span>Solution_set_boundary_conditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Solution_set_boundary_conditions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>SolName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l00071">71</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   71</span>                                                                                                                                                                                    {</div>
<div class="line"><span class="lineno">   72</span>  <span class="comment">//1: bottom (y=y_min) //2: right (x=x_max)  //3: top (y=y_max)  //4: left (x=x_min)  (in 2D)</span></div>
<div class="line"><span class="lineno">   73</span>  <span class="comment">//1: bottom (y=y_min) //2: right (x=x_max)  //3: top (y=y_max)  //4: left (x=x_min) //5: (z=z_min)  //6:  (z=z_max) (in 3D, I guess...)</span></div>
<div class="line"><span class="lineno">   74</span>  </div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordtype">bool</span> dirichlet  = <span class="keyword">true</span>; </div>
<div class="line"><span class="lineno">   76</span>  value = 0.;</div>
<div class="line"><span class="lineno">   77</span>  </div>
<div class="line"><span class="lineno">   78</span>        <span class="keywordflow">if</span> (facename == 2) {</div>
<div class="line"><span class="lineno">   79</span>       <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX_CTRL&quot;</span>))   { dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">   80</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY_CTRL&quot;</span>))   { dirichlet = <span class="keyword">false</span>; } </div>
<div class="line"><span class="lineno">   81</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ_CTRL&quot;</span>))   { dirichlet = <span class="keyword">false</span>; } </div>
<div class="line"><span class="lineno">   82</span>    </div>
<div class="line"><span class="lineno">   83</span>      }</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>  </div>
<div class="line"><span class="lineno">   86</span><span class="comment">// //       if (facename == 1) {</span></div>
<div class="line"><span class="lineno">   87</span><span class="comment">// //        if (!strcmp(SolName, &quot;DX&quot;))        { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">   88</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">   89</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">   90</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_ADJ&quot;))    { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">   91</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">   92</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">   93</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_CTRL&quot;))   { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">   94</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">   95</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">   96</span><span class="comment">// //       </span></div>
<div class="line"><span class="lineno">   97</span><span class="comment">// //       }</span></div>
<div class="line"><span class="lineno">   98</span><span class="comment">// // </span></div>
<div class="line"><span class="lineno">   99</span><span class="comment">// //       if (facename == 2) {</span></div>
<div class="line"><span class="lineno">  100</span><span class="comment">// //        if (!strcmp(SolName, &quot;DX&quot;))        { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  101</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  102</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  103</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_ADJ&quot;))    { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  104</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  105</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  106</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_CTRL&quot;))   { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  107</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  108</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  109</span><span class="comment">// //       </span></div>
<div class="line"><span class="lineno">  110</span><span class="comment">// //       }</span></div>
<div class="line"><span class="lineno">  111</span><span class="comment">// // </span></div>
<div class="line"><span class="lineno">  112</span><span class="comment">// //       if (facename == 3) {</span></div>
<div class="line"><span class="lineno">  113</span><span class="comment">// //        if (!strcmp(SolName, &quot;DX&quot;))        { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  114</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  115</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  116</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_ADJ&quot;))    { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  117</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  118</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  119</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_CTRL&quot;))   { dirichlet = false; value = 0.; }</span></div>
<div class="line"><span class="lineno">  120</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_CTRL&quot;))   { dirichlet = false; value = 0.; } </span></div>
<div class="line"><span class="lineno">  121</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_CTRL&quot;))   { dirichlet = false; value = 0.; } </span></div>
<div class="line"><span class="lineno">  122</span><span class="comment">// //       </span></div>
<div class="line"><span class="lineno">  123</span><span class="comment">// //       }</span></div>
<div class="line"><span class="lineno">  124</span><span class="comment">// // </span></div>
<div class="line"><span class="lineno">  125</span><span class="comment">// //       if (facename == 4) {</span></div>
<div class="line"><span class="lineno">  126</span><span class="comment">// //        if (!strcmp(SolName, &quot;DX&quot;))        { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  127</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  128</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  129</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_ADJ&quot;))    { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  130</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  131</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  132</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_CTRL&quot;))   { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  133</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  134</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  135</span><span class="comment">// //       </span></div>
<div class="line"><span class="lineno">  136</span><span class="comment">// //       }</span></div>
<div class="line"><span class="lineno">  137</span><span class="comment">// //       </span></div>
<div class="line"><span class="lineno">  138</span><span class="comment">// //       if (facename == 5) {</span></div>
<div class="line"><span class="lineno">  139</span><span class="comment">// //        if (!strcmp(SolName, &quot;DX&quot;))        { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  140</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY&quot;))        { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  141</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ&quot;))        { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  142</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_ADJ&quot;))    { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  143</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_ADJ&quot;))    { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_ADJ&quot;))    { dirichlet = true; value = 0.; }</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_CTRL&quot;))   { dirichlet = false; value = 0.; }</span></div>
<div class="line"><span class="lineno">  146</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_CTRL&quot;))   { dirichlet = false; value = 0.; } </span></div>
<div class="line"><span class="lineno">  147</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  148</span><span class="comment">// //      }</span></div>
<div class="line"><span class="lineno">  149</span><span class="comment">// //       </span></div>
<div class="line"><span class="lineno">  150</span><span class="comment">// //       if (facename == 6) {</span></div>
<div class="line"><span class="lineno">  151</span><span class="comment">// //        if (!strcmp(SolName, &quot;DX&quot;))        { dirichlet = true; value = 0. ; }</span></div>
<div class="line"><span class="lineno">  152</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY&quot;))        { dirichlet = true; value = 0. ; } </span></div>
<div class="line"><span class="lineno">  153</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ&quot;))        { dirichlet = true; value = 0. ; }</span></div>
<div class="line"><span class="lineno">  154</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_ADJ&quot;))    { dirichlet = true; value = 0. ; }</span></div>
<div class="line"><span class="lineno">  155</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_ADJ&quot;))    { dirichlet = true; value = 0. ; } </span></div>
<div class="line"><span class="lineno">  156</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_ADJ&quot;))    { dirichlet = true; value = 0. ; }</span></div>
<div class="line"><span class="lineno">  157</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DX_CTRL&quot;))   { dirichlet = false; value = 0.; }</span></div>
<div class="line"><span class="lineno">  158</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DY_CTRL&quot;))   { dirichlet = false; value = 0.; } </span></div>
<div class="line"><span class="lineno">  159</span><span class="comment">// //   else if (!strcmp(SolName, &quot;DZ_CTRL&quot;))   { dirichlet = true; value = 0.; } </span></div>
<div class="line"><span class="lineno">  160</span><span class="comment">// //       }</span></div>
<div class="line"><span class="lineno">  161</span>      </div>
<div class="line"><span class="lineno">  162</span> <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><span class="lineno">  163</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5dec9191b407f5f1913e563b23777741" name="a5dec9191b407f5f1913e563b23777741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dec9191b407f5f1913e563b23777741">&#9670;&#160;</a></span>Solution_set_initial_conditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Solution_set_initial_conditions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="02__solid__control__lifting_8cpp_source.html#l00023">23</a> of file <a class="el" href="02__solid__control__lifting_8cpp_source.html">02_solid_control_lifting.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   23</span>                                                                                                                            {</div>
<div class="line"><span class="lineno">   24</span>         </div>
<div class="line"><span class="lineno">   25</span>           <span class="keywordtype">double</span> value = 0.;</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>             <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DX&quot;</span>)) {</div>
<div class="line"><span class="lineno">   28</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   29</span>             }</div>
<div class="line"><span class="lineno">   30</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DY&quot;</span>)) {</div>
<div class="line"><span class="lineno">   31</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   32</span>             }</div>
<div class="line"><span class="lineno">   33</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DZ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   34</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   35</span>             }</div>
<div class="line"><span class="lineno">   36</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;P&quot;</span>)) {</div>
<div class="line"><span class="lineno">   37</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   38</span>             }</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DX_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   41</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   42</span>             }</div>
<div class="line"><span class="lineno">   43</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DY_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   44</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   45</span>             }</div>
<div class="line"><span class="lineno">   46</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DZ_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   47</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   48</span>             }</div>
<div class="line"><span class="lineno">   49</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;P_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   50</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   51</span>             }</div>
<div class="line"><span class="lineno">   52</span>             </div>
<div class="line"><span class="lineno">   53</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DX_CTRL&quot;</span>)) {</div>
<div class="line"><span class="lineno">   54</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   55</span>             }</div>
<div class="line"><span class="lineno">   56</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DY_CTRL&quot;</span>)) {</div>
<div class="line"><span class="lineno">   57</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   58</span>             }</div>
<div class="line"><span class="lineno">   59</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DZ_CTRL&quot;</span>)) {</div>
<div class="line"><span class="lineno">   60</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   61</span>             }</div>
<div class="line"><span class="lineno">   62</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;P_CTRL&quot;</span>)) {</div>
<div class="line"><span class="lineno">   63</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   64</span>             }</div>
<div class="line"><span class="lineno">   65</span>          </div>
<div class="line"><span class="lineno">   66</span>    </div>
<div class="line"><span class="lineno">   67</span>      <span class="keywordflow">return</span> value;   </div>
<div class="line"><span class="lineno">   68</span>}  </div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="dir_0011fd9907a18ae0e94bfb1b854040dc.html">OptimalControl</a></li><li class="navelem"><a class="el" href="dir_4e0612b01bde21c76cf7c05fff55d377.html">04_solidopt</a></li><li class="navelem"><a class="el" href="dir_8382928c11d672cdb4fcbf7718394739.html">02_solid_control_lifting</a></li><li class="navelem"><a class="el" href="02__solid__control__lifting_8cpp.html">02_solid_control_lifting.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
