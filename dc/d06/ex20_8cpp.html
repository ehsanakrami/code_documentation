<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - National University of Ireland, Galway/Desktop/femus/source/applications/AMR/ex20/ex20.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('dc/d06/ex20_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ex20.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../da/dce/_multi_level_solution_8hpp_source.html">MultiLevelSolution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/dbc/_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/dc5/_multi_level_mesh_8hpp_source.html">MultiLevelMesh.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d7f/_transient_system_8hpp_source.html">TransientSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d6d/_fluid_8hpp_source.html">Fluid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d1d/_parameter_8hpp_source.html">Parameter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d7c/_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d14/_sparse_matrix_8hpp_source.html">SparseMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df7/_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d84/_g_m_v_writer_8hpp_source.html">GMVWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d1a/_x_d_m_f_writer_8hpp_source.html">XDMFWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/dc5/_non_linear_implicit_system_8hpp_source.html">NonLinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/dd2/_solvertype_enum_8hpp_source.html">SolvertypeEnum.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/df7/_f_elem_type_enum_8hpp_source.html">FElemTypeEnum.hpp</a>&quot;</code><br />
<code>#include &lt;json/json.h&gt;</code><br />
<code>#include &lt;json/value.h&gt;</code><br />
<code>#include &quot;<a class="el" href="../../dd/dfd/_parsed_function_8hpp_source.html">ParsedFunction.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d4e/_files_8hpp_source.html">Files.hpp</a>&quot;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
</div>
<p><a href="../../dc/d06/ex20_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:ad336ac0f14496ce33e2cbb8257db5fd5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#ad336ac0f14496ce33e2cbb8257db5fd5">AssemblePoissonMatrixandRhs</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:ad336ac0f14496ce33e2cbb8257db5fd5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8bcc082bbb8f18ce8b4479f0359ffdaf"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#a8bcc082bbb8f18ce8b4479f0359ffdaf">GetRelativeError</a> (<a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;ml_sol, const bool &amp;H1)</td></tr>
<tr class="separator:a8bcc082bbb8f18ce8b4479f0359ffdaf"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a> (const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53f85b2fbf5b17ef7f7ee4251fc33cb7"><td class="memItemLeft" align="right" valign="top">static std::string&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#a53f85b2fbf5b17ef7f7ee4251fc33cb7">readInputTestFile</a> (const char *path)</td></tr>
<tr class="separator:a53f85b2fbf5b17ef7f7ee4251fc33cb7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a35ee06182a68a7e4ddf45e3b888e60c1"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#a35ee06182a68a7e4ddf45e3b888e60c1">show_usage</a> ()</td></tr>
<tr class="separator:a35ee06182a68a7e4ddf45e3b888e60c1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a8b9f315bff384189fd2f344bf4a9c401"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#a8b9f315bff384189fd2f344bf4a9c401">fpsource</a></td></tr>
<tr class="separator:a8b9f315bff384189fd2f344bf4a9c401"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa8d9c5fa63eeb198991d1abf849efb46"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#aa8d9c5fa63eeb198991d1abf849efb46">fp_sol</a></td></tr>
<tr class="separator:aa8d9c5fa63eeb198991d1abf849efb46"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad5653b0e7373558c99c8b385b10db24c"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#ad5653b0e7373558c99c8b385b10db24c">fp_dsoldx</a></td></tr>
<tr class="separator:ad5653b0e7373558c99c8b385b10db24c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7716ad279ddb09ed64dec90671bc9ddb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../dc/d06/ex20_8cpp.html#a7716ad279ddb09ed64dec90671bc9ddb">fp_dsoldy</a></td></tr>
<tr class="separator:a7716ad279ddb09ed64dec90671bc9ddb"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="ad336ac0f14496ce33e2cbb8257db5fd5" name="ad336ac0f14496ce33e2cbb8257db5fd5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad336ac0f14496ce33e2cbb8257db5fd5">&#9670;&#160;</a></span>AssemblePoissonMatrixandRhs()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AssemblePoissonMatrixandRhs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00477">477</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  477</span>                                                             {</div>
<div class="line"><span class="lineno">  478</span> </div>
<div class="line"><span class="lineno">  479</span>  <span class="comment">//pointers and references</span></div>
<div class="line"><span class="lineno">  480</span>  <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&amp; mylin_impl_sys = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&gt;(<span class="stringliteral">&quot;Poisson&quot;</span>);</div>
<div class="line"><span class="lineno">  481</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mylin_impl_sys.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>();</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>*      mysolution            = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level);</div>
<div class="line"><span class="lineno">  484</span>  <a class="code hl_class" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>*  mylsyspde     = mylin_impl_sys.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[level];</div>
<div class="line"><span class="lineno">  485</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>*          mymsh                 = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno">  486</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>*          myel                  = mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">  487</span>  <a class="code hl_class" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a>*  myKK                  = mylsyspde-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><span class="lineno">  488</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* myRES                 = mylsyspde-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>;</div>
<div class="line"><span class="lineno">  489</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>* ml_sol           = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><span class="lineno">  490</span> </div>
<div class="line"><span class="lineno">  491</span>  <span class="comment">//data</span></div>
<div class="line"><span class="lineno">  492</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>        <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>     = mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  493</span>  <span class="keywordtype">unsigned</span>              nel     = mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">GetNumberOfElements</a>();</div>
<div class="line"><span class="lineno">  494</span>  <span class="keywordtype">unsigned</span>              igrid   = mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>();</div>
<div class="line"><span class="lineno">  495</span>  <span class="keywordtype">unsigned</span>              iproc   = mymsh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  496</span> </div>
<div class="line"><span class="lineno">  497</span>  <span class="comment">//solution variable</span></div>
<div class="line"><span class="lineno">  498</span>  <span class="keywordtype">unsigned</span> SolIndex;</div>
<div class="line"><span class="lineno">  499</span>  <span class="keywordtype">unsigned</span> SolPdeIndex;</div>
<div class="line"><span class="lineno">  500</span>  SolIndex = ml_sol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  501</span>  SolPdeIndex = mylin_impl_sys.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">GetSolPdeIndex</a>(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  502</span>  <span class="comment">//solution order</span></div>
<div class="line"><span class="lineno">  503</span>  <span class="keywordtype">unsigned</span> order_ind = ml_sol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(SolIndex);</div>
<div class="line"><span class="lineno">  504</span> </div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>  <span class="comment">//coordinates</span></div>
<div class="line"><span class="lineno">  507</span>  vector&lt; vector &lt; double&gt; &gt; coordinates(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>  <span class="comment">// declare</span></div>
<div class="line"><span class="lineno">  510</span>  vector&lt; int &gt; metis_node;</div>
<div class="line"><span class="lineno">  511</span>  vector&lt; int &gt; KK_dof;</div>
<div class="line"><span class="lineno">  512</span>  vector &lt;double&gt; <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line"><span class="lineno">  513</span>  vector &lt;double&gt; gradphi;</div>
<div class="line"><span class="lineno">  514</span>  vector &lt;double&gt; nablaphi;</div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordtype">double</span> weight;</div>
<div class="line"><span class="lineno">  516</span>  vector&lt; double &gt; F;</div>
<div class="line"><span class="lineno">  517</span>  vector&lt; double &gt; B;</div>
<div class="line"><span class="lineno">  518</span>  vector&lt;double&gt; normal(3.0);</div>
<div class="line"><span class="lineno">  519</span>  <span class="keywordtype">double</span> src_term = 0.;</div>
<div class="line"><span class="lineno">  520</span>  vector&lt;double&gt; xyzt(4, 0.);</div>
<div class="line"><span class="lineno">  521</span>  <a class="code hl_class" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a>* bdcfunc = NULL;</div>
<div class="line"><span class="lineno">  522</span> </div>
<div class="line"><span class="lineno">  523</span>  <span class="comment">// reserve</span></div>
<div class="line"><span class="lineno">  524</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));</div>
<div class="line"><span class="lineno">  525</span>  metis_node.reserve(max_size);</div>
<div class="line"><span class="lineno">  526</span>  KK_dof.reserve(max_size);</div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++)</div>
<div class="line"><span class="lineno">  529</span>    coordinates[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  530</span> </div>
<div class="line"><span class="lineno">  531</span>  <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.reserve(max_size);</div>
<div class="line"><span class="lineno">  532</span>  gradphi.reserve(max_size * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  533</span>  nablaphi.reserve(max_size * (3 * (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1)));</div>
<div class="line"><span class="lineno">  534</span>  F.reserve(max_size);</div>
<div class="line"><span class="lineno">  535</span>  B.reserve(max_size * max_size);</div>
<div class="line"><span class="lineno">  536</span> </div>
<div class="line"><span class="lineno">  537</span>  <span class="comment">// Set to zeto all the entries of the Global Matrix</span></div>
<div class="line"><span class="lineno">  538</span>  myKK-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">zero</a>();</div>
<div class="line"><span class="lineno">  539</span> </div>
<div class="line"><span class="lineno">  540</span>  <span class="comment">// *** element loop ***</span></div>
<div class="line"><span class="lineno">  541</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielt = mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  544</span>    <span class="keywordtype">unsigned</span> nve = mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, order_ind);</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>    <span class="comment">// resize</span></div>
<div class="line"><span class="lineno">  547</span>    metis_node.resize(nve);</div>
<div class="line"><span class="lineno">  548</span>    KK_dof.resize(nve);</div>
<div class="line"><span class="lineno">  549</span>    <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(nve);</div>
<div class="line"><span class="lineno">  550</span>    gradphi.resize(nve * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  551</span>    nablaphi.resize(nve * (3 * (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1)));</div>
<div class="line"><span class="lineno">  552</span> </div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {</div>
<div class="line"><span class="lineno">  554</span>      coordinates[i].resize(nve);</div>
<div class="line"><span class="lineno">  555</span>    }</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    <span class="comment">// set to zero all the entries of the FE matrices</span></div>
<div class="line"><span class="lineno">  558</span>    F.resize(nve);</div>
<div class="line"><span class="lineno">  559</span>    memset(&amp;F[0], 0, nve * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  560</span>    B.resize(nve * nve);</div>
<div class="line"><span class="lineno">  561</span>    memset(&amp;B[0], 0, nve * nve * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>    <span class="comment">// get local to global mappings</span></div>
<div class="line"><span class="lineno">  565</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nve; i++) {</div>
<div class="line"><span class="lineno">  566</span>      <span class="keywordtype">unsigned</span> inode_coord_metis = mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, 2);</div>
<div class="line"><span class="lineno">  567</span>      metis_node[i] = mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, order_ind);</div>
<div class="line"><span class="lineno">  568</span> </div>
<div class="line"><span class="lineno">  569</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  570</span>        coordinates[ivar][i] = (*mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[ivar])(inode_coord_metis);</div>
<div class="line"><span class="lineno">  571</span>      }</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span>      KK_dof[i] = mylsyspde-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(SolIndex, SolPdeIndex, i, iel);</div>
<div class="line"><span class="lineno">  574</span>    }</div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">// *** Gauss poit loop ***</span></div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[ielt][order_ind]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>(); <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  579</span>      <span class="comment">// *** get Jacobian and test function and test function derivatives ***</span></div>
<div class="line"><span class="lineno">  580</span>      ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[ielt][order_ind]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coordinates, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, gradphi, nablaphi);</div>
<div class="line"><span class="lineno">  581</span>      <span class="comment">//current solution</span></div>
<div class="line"><span class="lineno">  582</span>      <span class="keywordtype">double</span> SolT = 0;</div>
<div class="line"><span class="lineno">  583</span>      vector &lt; double &gt; gradSolT(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  586</span>        gradSolT[ivar] = 0;</div>
<div class="line"><span class="lineno">  587</span>      }</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>      xyzt.assign(4, 0.);</div>
<div class="line"><span class="lineno">  590</span>      <span class="keywordtype">unsigned</span> SolType = ml_sol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nve; i++) {</div>
<div class="line"><span class="lineno">  593</span>        <span class="keywordtype">double</span> soli = (*mysolution-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex])(metis_node[i]);</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  596</span>          xyzt[ivar] += coordinates[ivar][i] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i];</div>
<div class="line"><span class="lineno">  597</span>        }</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>        SolT += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * soli;</div>
<div class="line"><span class="lineno">  600</span> </div>
<div class="line"><span class="lineno">  601</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar2 = 0; ivar2 &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) gradSolT[ivar2] += gradphi[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + ivar2] * soli;</div>
<div class="line"><span class="lineno">  602</span>      }</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>      <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  605</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nve; i++) {</div>
<div class="line"><span class="lineno">  606</span>        <span class="comment">//BEGIN RESIDUALS A block ===========================</span></div>
<div class="line"><span class="lineno">  607</span>        <span class="keywordtype">double</span> Adv_rhs = 0;</div>
<div class="line"><span class="lineno">  608</span>        <span class="keywordtype">double</span> Lap_rhs = 0;</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  611</span>          Lap_rhs += gradphi[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + ivar] * gradSolT[ivar];</div>
<div class="line"><span class="lineno">  612</span>        }</div>
<div class="line"><span class="lineno">  613</span> </div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>        <span class="comment">//src_term = Source(xyzt);</span></div>
<div class="line"><span class="lineno">  616</span><span class="preprocessor">#ifdef HAVE_FPARSER</span></div>
<div class="line"><span class="lineno">  617</span>        <span class="comment">//src_term = fpsource.Eval(xyzt);</span></div>
<div class="line"><span class="lineno">  618</span>        src_term = <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a8b9f315bff384189fd2f344bf4a9c401">fpsource</a>(&amp;xyzt[0]);</div>
<div class="line"><span class="lineno">  619</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>        F[i] += (-Lap_rhs + src_term * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i]) * weight;</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>        <span class="comment">//END RESIDUALS A block ===========================</span></div>
<div class="line"><span class="lineno">  624</span>        <span class="comment">// *** phi_j loop ***</span></div>
<div class="line"><span class="lineno">  625</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nve; <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  626</span>          <span class="keywordtype">double</span> Lap = 0;</div>
<div class="line"><span class="lineno">  627</span>          <span class="keywordtype">double</span> Adv1 = 0;</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  630</span>            <span class="comment">// Laplacian</span></div>
<div class="line"><span class="lineno">  631</span>            Lap  += gradphi[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + ivar] * gradphi[<a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + ivar] * weight;</div>
<div class="line"><span class="lineno">  632</span>          }</div>
<div class="line"><span class="lineno">  633</span> </div>
<div class="line"><span class="lineno">  634</span>          B[i * nve + <a class="code hl_variable" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += Lap;</div>
<div class="line"><span class="lineno">  635</span>        } <span class="comment">// end phij loop</span></div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span>      } <span class="comment">// endif assemble_matrix</span></div>
<div class="line"><span class="lineno">  638</span>    } <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>    <span class="comment">//number of faces for each type of element</span></div>
<div class="line"><span class="lineno">  641</span>    <span class="comment">//number of faces for each type of element</span></div>
<div class="line"><span class="lineno">  642</span><span class="comment">//     unsigned nfaces = mymsh-&gt;GetElementFaceNumber(iel);</span></div>
<div class="line"><span class="lineno">  643</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  644</span><span class="comment">//     // loop on faces</span></div>
<div class="line"><span class="lineno">  645</span><span class="comment">//     for (unsigned jface = 0; jface &lt; nfaces; jface++) {</span></div>
<div class="line"><span class="lineno">  646</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  647</span><span class="comment">//       // look for boundary faces</span></div>
<div class="line"><span class="lineno">  648</span><span class="comment">//       if (myel-&gt;GetBoundaryIndex(iel, jface) &gt; 0) {</span></div>
<div class="line"><span class="lineno">  649</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  650</span><span class="comment">//         unsigned int faceIndex =  myel-&gt;GetBoundaryIndex(iel, jface) - 1u;</span></div>
<div class="line"><span class="lineno">  651</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  652</span><span class="comment">//         if (ml_sol-&gt;GetBoundaryCondition(&quot;Sol&quot;, faceIndex) == NEUMANN &amp;&amp; !ml_sol-&gt;Ishomogeneous(&quot;Sol&quot;, faceIndex)) {</span></div>
<div class="line"><span class="lineno">  653</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  654</span><span class="comment">//           bdcfunc = (ParsedFunction*)(ml_sol-&gt;GetBdcFunction(&quot;Sol&quot;, faceIndex));</span></div>
<div class="line"><span class="lineno">  655</span><span class="comment">//           unsigned nve = mymsh-&gt;GetElementFaceDofNumber(iel, jface, order_ind);</span></div>
<div class="line"><span class="lineno">  656</span><span class="comment">//           const unsigned felt = mymsh-&gt;GetElementFaceType(iel, jface);</span></div>
<div class="line"><span class="lineno">  657</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  658</span><span class="comment">//           for (unsigned i = 0; i &lt; nve; i++) {</span></div>
<div class="line"><span class="lineno">  659</span><span class="comment">//             unsigned ilocal = mymsh-&gt;GetLocalFaceVertexIndex(iel, jface, i);</span></div>
<div class="line"><span class="lineno">  660</span><span class="comment">//             unsigned inode_coord_metis = mymsh-&gt;GetSolutionDof(ilocal, iel, 2);</span></div>
<div class="line"><span class="lineno">  661</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  662</span><span class="comment">//             for (unsigned ivar = 0; ivar &lt; dim; ivar++) {</span></div>
<div class="line"><span class="lineno">  663</span><span class="comment">//               coordinates[ivar][i] = (*mymsh-&gt;_topology-&gt;_Sol[ivar])(inode_coord_metis);</span></div>
<div class="line"><span class="lineno">  664</span><span class="comment">//             }</span></div>
<div class="line"><span class="lineno">  665</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  666</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  667</span><span class="comment">//           if (felt != 6)</span></div>
<div class="line"><span class="lineno">  668</span><span class="comment">//           {</span></div>
<div class="line"><span class="lineno">  669</span><span class="comment">//             for (unsigned igs = 0; igs &lt; ml_prob._ml_msh-&gt;_finiteElement[felt][order_ind]-&gt;GetGaussPointNumber(); igs++) {</span></div>
<div class="line"><span class="lineno">  670</span><span class="comment">//               ml_prob._ml_msh-&gt;_finiteElement[felt][order_ind]-&gt;JacobianSur(coordinates, igs, weight, phi, gradphi, normal);</span></div>
<div class="line"><span class="lineno">  671</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  672</span><span class="comment">//               xyzt.assign(4, 0.);</span></div>
<div class="line"><span class="lineno">  673</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  674</span><span class="comment">//               for (unsigned i = 0; i &lt; nve; i++) {</span></div>
<div class="line"><span class="lineno">  675</span><span class="comment">//                 for (unsigned ivar = 0; ivar &lt; dim; ivar++) {</span></div>
<div class="line"><span class="lineno">  676</span><span class="comment">//                   xyzt[ivar] += coordinates[ivar][i] * phi[i];</span></div>
<div class="line"><span class="lineno">  677</span><span class="comment">//                 }</span></div>
<div class="line"><span class="lineno">  678</span><span class="comment">//               }</span></div>
<div class="line"><span class="lineno">  679</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  680</span><span class="comment">//               // *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  681</span><span class="comment">//               for (unsigned i = 0; i &lt; nve; i++) {</span></div>
<div class="line"><span class="lineno">  682</span><span class="comment">//                 double surfterm_g = (*bdcfunc)(&amp;xyzt[0]);</span></div>
<div class="line"><span class="lineno">  683</span><span class="comment">//                 double bdintegral = phi[i] * surfterm_g * weight;</span></div>
<div class="line"><span class="lineno">  684</span><span class="comment">//                 unsigned int ilocalnode = mymsh-&gt;GetLocalFaceVertexIndex(iel, jface, i);</span></div>
<div class="line"><span class="lineno">  685</span><span class="comment">//                 F[ilocalnode] += bdintegral;</span></div>
<div class="line"><span class="lineno">  686</span><span class="comment">//               }</span></div>
<div class="line"><span class="lineno">  687</span><span class="comment">//             }</span></div>
<div class="line"><span class="lineno">  688</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  689</span><span class="comment">//           else // 1D : the side elems are points and does not still exist the point elem</span></div>
<div class="line"><span class="lineno">  690</span><span class="comment">//           {</span></div>
<div class="line"><span class="lineno">  691</span><span class="comment">//             // in 1D it is only one point</span></div>
<div class="line"><span class="lineno">  692</span><span class="comment">//             xyzt[0] = coordinates[0][0];</span></div>
<div class="line"><span class="lineno">  693</span><span class="comment">//             xyzt[1] = 0.;</span></div>
<div class="line"><span class="lineno">  694</span><span class="comment">//             xyzt[2] = 0.;</span></div>
<div class="line"><span class="lineno">  695</span><span class="comment">//             xyzt[3] = 0.;</span></div>
<div class="line"><span class="lineno">  696</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  697</span><span class="comment">//             double bdintegral = (*bdcfunc)(&amp;xyzt[0]);</span></div>
<div class="line"><span class="lineno">  698</span><span class="comment">//             unsigned int ilocalnode = mymsh-&gt;GetLocalFaceVertexIndex(iel, jface, 0);</span></div>
<div class="line"><span class="lineno">  699</span><span class="comment">//             F[ilocalnode] += bdintegral;</span></div>
<div class="line"><span class="lineno">  700</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  701</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  702</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  703</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span> </div>
<div class="line"><span class="lineno">  706</span>    <span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  707</span>    <span class="comment">//Sum the local matrices/vectors into the global Matrix/vector</span></div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>    myRES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(F, KK_dof);</div>
<div class="line"><span class="lineno">  710</span>    myKK-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">add_matrix_blocked</a>(B, KK_dof, KK_dof);</div>
<div class="line"><span class="lineno">  711</span>  } <span class="comment">//end list of elements loop for each subdomain</span></div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>  myRES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  714</span>  myKK-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">close</a>();</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>  <span class="comment">// ***************** END ASSEMBLY *******************</span></div>
<div class="line"><span class="lineno">  717</span> </div>
<div class="line"><span class="lineno">  718</span>}</div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_s_w_2ex2_2ex2_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">double phi</div><div class="ttdef"><b>Definition</b> <a href="../../de/d25/_s_w_2ex2_2ex2_8cpp_source.html#l00038">ex2.cpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a20ac8999e714492516cd8a2be53fb54f"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d77/_linear_equation_8cpp_source.html#l00071">LinearEquation.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00118">LinearEquation.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00055">LinearEquationSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">femus::LinearImplicitSystem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00038">LinearImplicitSystem.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a58ebbec8ab1f2eb863cba438f30404e0"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">femus::LinearImplicitSystem::_LinSolver</a></div><div class="ttdeci">vector&lt; LinearEquationSolver * &gt; _LinSolver</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00077">LinearImplicitSystem.hpp:77</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a24f5ab73a260d61b0ea9ff28f03bc815"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">femus::Mesh::GetLevel</a></div><div class="ttdeci">unsigned GetLevel() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00260">Mesh.hpp:260</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01222">Mesh.cpp:1222</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ab5bcfd4be738d47ae025a06eddc66f61"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">femus::Mesh::GetNumberOfElements</a></div><div class="ttdeci">unsigned GetNumberOfElements() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00099">Mesh.hpp:99</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00162">Mesh.hpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01212">Mesh.cpp:1212</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_ad59554c65099f852ba8797f09bc40227"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">femus::MultiLevelMesh::_finiteElement</a></div><div class="ttdeci">elem_type * _finiteElement[N_GEOM_ELS][NFE_FAMS]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00204">MultiLevelMesh.hpp:204</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a6dd8fec26a0ffbaae07e6df7ea42d12b"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">femus::MultiLevelProblem::_ml_sol</a></div><div class="ttdeci">MultiLevelSolution * _ml_sol</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00079">MultiLevelProblem.hpp:79</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00116">MultiLevelProblem.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db0/_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a0440021963af01ac49a6f02df562e44b"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">femus::NumericVector::add_vector_blocked</a></div><div class="ttdeci">virtual void add_vector_blocked(const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)=0</div><div class="ttdoc">where v is a std::vector !!!fast</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parsed_function_html"><div class="ttname"><a href="../../d8/de4/classfemus_1_1_parsed_function.html">femus::ParsedFunction</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dfd/_parsed_function_8hpp_source.html#l00073">ParsedFunction.hpp:75</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d14/_sparse_matrix_8hpp_source.html#l00047">SparseMatrix.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a45654dbe423d1970565b94c792ce6df3"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">femus::SparseMatrix::zero</a></div><div class="ttdeci">virtual void zero()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a6eb9fbd88830b0d10c88f0ce066b07ae"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">femus::SparseMatrix::close</a></div><div class="ttdeci">virtual void close() const =0</div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_aac0370cebbcc2d7111660dcf7115ebbf"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">femus::SparseMatrix::add_matrix_blocked</a></div><div class="ttdeci">virtual void add_matrix_blocked(const std::vector&lt; double &gt; &amp;mat_value, const std::vector&lt; int &gt; &amp;rows, const std::vector&lt; int &gt; &amp;cols)=0</div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a16af0d7b8849d6ea983a5e425fb90fee"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">femus::System::GetLevelToAssemble</a></div><div class="ttdeci">unsigned GetLevelToAssemble() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/def/_system_8hpp_source.html#l00116">System.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a4ebc859deb32b54c9936fa28f1485a93"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a4ebc859deb32b54c9936fa28f1485a93">femus::System::GetSolPdeIndex</a></div><div class="ttdeci">unsigned GetSolPdeIndex(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00087">System.cpp:87</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a3fa8f889f9ae97586b3db574acb4448e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">femus::elem_type::GetGaussPointNumber</a></div><div class="ttdeci">unsigned GetGaussPointNumber() const</div><div class="ttdef"><b>Definition</b> <a href="../../d8/df9/_elem_type_8hpp_source.html#l00208">ElemType.hpp:208</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="aex20_8cpp_html_a8b9f315bff384189fd2f344bf4a9c401"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#a8b9f315bff384189fd2f344bf4a9c401">fpsource</a></div><div class="ttdeci">ParsedFunction fpsource</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00067">ex20.cpp:67</a></div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a8bcc082bbb8f18ce8b4479f0359ffdaf" name="a8bcc082bbb8f18ce8b4479f0359ffdaf"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8bcc082bbb8f18ce8b4479f0359ffdaf">&#9670;&#160;</a></span>GetRelativeError()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double GetRelativeError </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool &amp;&#160;</td>
          <td class="paramname"><em>H1</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00722">722</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  722</span>                                                                    {</div>
<div class="line"><span class="lineno">  723</span> </div>
<div class="line"><span class="lineno">  724</span>  <span class="keywordtype">int</span>  iproc, nprocs;</div>
<div class="line"><span class="lineno">  725</span>  MPI_Comm_rank(MPI_COMM_WORLD, &amp;iproc);</div>
<div class="line"><span class="lineno">  726</span>  MPI_Comm_size(MPI_COMM_WORLD, &amp;nprocs);</div>
<div class="line"><span class="lineno">  727</span> </div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* error_vec;</div>
<div class="line"><span class="lineno">  730</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>* solution_vec;</div>
<div class="line"><span class="lineno">  731</span>  error_vec = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  732</span>  solution_vec = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>  <span class="keywordflow">if</span> (nprocs == 1) {</div>
<div class="line"><span class="lineno">  735</span>    error_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(nprocs, 1, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>);</div>
<div class="line"><span class="lineno">  736</span>    solution_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(nprocs, 1, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>);</div>
<div class="line"><span class="lineno">  737</span>  }</div>
<div class="line"><span class="lineno">  738</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  739</span>    error_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(nprocs, 1, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>);</div>
<div class="line"><span class="lineno">  740</span>    solution_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">init</a>(nprocs, 1, <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>);</div>
<div class="line"><span class="lineno">  741</span>  }</div>
<div class="line"><span class="lineno">  742</span> </div>
<div class="line"><span class="lineno">  743</span>  error_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  744</span>  solution_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>  <span class="keywordtype">unsigned</span> gridn = ml_sol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>();</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ilevel = gridn - 1; ilevel &lt; gridn; ilevel++) {</div>
<div class="line"><span class="lineno">  749</span>    <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>*      solution  = ml_sol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(ilevel);</div>
<div class="line"><span class="lineno">  750</span>    <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>*          msh       = ml_sol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(ilevel);</div>
<div class="line"><span class="lineno">  751</span>    <span class="keywordtype">unsigned</span>       iproc     = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  752</span> </div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>      <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>     = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  755</span>    vector&lt; vector &lt; double&gt; &gt; coordinates(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>    vector&lt; int &gt; metis_node;</div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>    vector &lt;double&gt; <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line"><span class="lineno">  760</span>    vector &lt;double&gt; gradphi;</div>
<div class="line"><span class="lineno">  761</span>    vector &lt;double&gt; nablaphi;</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordtype">double</span> weight;</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>    <span class="comment">// reserve</span></div>
<div class="line"><span class="lineno">  766</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));</div>
<div class="line"><span class="lineno">  767</span>    metis_node.reserve(max_size);</div>
<div class="line"><span class="lineno">  768</span> </div>
<div class="line"><span class="lineno">  769</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++)</div>
<div class="line"><span class="lineno">  770</span>      coordinates[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>    <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.reserve(max_size);</div>
<div class="line"><span class="lineno">  773</span>    gradphi.reserve(max_size * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  774</span>    nablaphi.reserve(max_size * (3 * (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1)));</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span> </div>
<div class="line"><span class="lineno">  777</span>    <span class="keywordtype">unsigned</span> SolIndex;</div>
<div class="line"><span class="lineno">  778</span>    SolIndex = ml_sol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordtype">unsigned</span> SolOrder = ml_sol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(SolIndex);</div>
<div class="line"><span class="lineno">  780</span> </div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  783</span> </div>
<div class="line"><span class="lineno">  784</span>      <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielt = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  785</span>      <span class="keywordtype">unsigned</span> nve = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolOrder);</div>
<div class="line"><span class="lineno">  786</span>      <span class="comment">// resize</span></div>
<div class="line"><span class="lineno">  787</span>      metis_node.resize(nve);</div>
<div class="line"><span class="lineno">  788</span>      <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.resize(nve);</div>
<div class="line"><span class="lineno">  789</span>      gradphi.resize(nve * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  790</span>      nablaphi.resize(nve * (3 * (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1)));</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {</div>
<div class="line"><span class="lineno">  793</span>        coordinates[i].resize(nve);</div>
<div class="line"><span class="lineno">  794</span>      }</div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>      <span class="comment">// get local to global mappings</span></div>
<div class="line"><span class="lineno">  797</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nve; i++) {</div>
<div class="line"><span class="lineno">  798</span>        <span class="keywordtype">unsigned</span> inode_coord_metis = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, 2);</div>
<div class="line"><span class="lineno">  799</span>        metis_node[i] = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolOrder);</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  802</span>          coordinates[idim][i] = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[idim])(inode_coord_metis);</div>
<div class="line"><span class="lineno">  803</span>        }</div>
<div class="line"><span class="lineno">  804</span>      }</div>
<div class="line"><span class="lineno">  805</span> </div>
<div class="line"><span class="lineno">  806</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_sol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[ielt][SolOrder]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>(); <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  807</span>        <span class="comment">// *** get Jacobian and test function and test function derivatives ***</span></div>
<div class="line"><span class="lineno">  808</span>        ml_sol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[ielt][SolOrder]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coordinates, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, gradphi, nablaphi);</div>
<div class="line"><span class="lineno">  809</span>        <span class="comment">//current solution</span></div>
<div class="line"><span class="lineno">  810</span>        <span class="keywordtype">double</span> SolT = 0;</div>
<div class="line"><span class="lineno">  811</span>        vector &lt; double &gt; gradSolT(<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  814</span>          gradSolT[ivar] = 0;</div>
<div class="line"><span class="lineno">  815</span>        }</div>
<div class="line"><span class="lineno">  816</span> </div>
<div class="line"><span class="lineno">  817</span>        <span class="keywordtype">double</span> <a class="code hl_variable" href="../../df/d64/_i_s_m_2ex3_2ex3_8cpp.html#a31c17cc321db72d5ab448b71ea92792f">pi</a> = acos(-1.);</div>
<div class="line"><span class="lineno">  818</span>        <span class="keywordtype">double</span> x[4] = {0., 0., 0., 0.};</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>        <span class="keywordtype">unsigned</span> SolType = ml_sol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  821</span> </div>
<div class="line"><span class="lineno">  822</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nve; i++) {</div>
<div class="line"><span class="lineno">  823</span>          <span class="keywordtype">double</span> soli = (*solution-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex])(metis_node[i]);</div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  826</span>            x[ivar] += coordinates[ivar][i] * <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i];</div>
<div class="line"><span class="lineno">  827</span>          }</div>
<div class="line"><span class="lineno">  828</span> </div>
<div class="line"><span class="lineno">  829</span>          SolT += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * soli;</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ivar2 = 0; ivar2 &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {</div>
<div class="line"><span class="lineno">  832</span>            gradSolT[ivar2] += gradphi[i * <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + ivar2] * soli;</div>
<div class="line"><span class="lineno">  833</span>          }</div>
<div class="line"><span class="lineno">  834</span>        }</div>
<div class="line"><span class="lineno">  835</span> </div>
<div class="line"><span class="lineno">  836</span>        <span class="keywordtype">double</span> SolExact, dSolExactdx, dSolExactdy;</div>
<div class="line"><span class="lineno">  837</span><span class="preprocessor">#ifdef HAVE_FPARSER</span></div>
<div class="line"><span class="lineno">  838</span>        SolExact    = <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#aa8d9c5fa63eeb198991d1abf849efb46">fp_sol</a>(x);</div>
<div class="line"><span class="lineno">  839</span>        dSolExactdx = <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#ad5653b0e7373558c99c8b385b10db24c">fp_dsoldx</a>(x);</div>
<div class="line"><span class="lineno">  840</span>        dSolExactdy = <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a7716ad279ddb09ed64dec90671bc9ddb">fp_dsoldy</a>(x);</div>
<div class="line"><span class="lineno">  841</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  842</span> </div>
<div class="line"><span class="lineno">  843</span>        error_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a016609e0912f741ed161b201edf8f86f">add</a>(iproc, ((SolT - SolExact) * (SolT - SolExact) +</div>
<div class="line"><span class="lineno">  844</span>                               H1 * ((gradSolT[0] - dSolExactdx) * (gradSolT[0] - dSolExactdx) +</div>
<div class="line"><span class="lineno">  845</span>                                     (gradSolT[1] - dSolExactdy) * (gradSolT[1] - dSolExactdy))</div>
<div class="line"><span class="lineno">  846</span>                              )*weight);</div>
<div class="line"><span class="lineno">  847</span> </div>
<div class="line"><span class="lineno">  848</span>        solution_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a016609e0912f741ed161b201edf8f86f">add</a>(iproc, (SolExact * SolExact +</div>
<div class="line"><span class="lineno">  849</span>                                  H1 * (dSolExactdx * dSolExactdx + dSolExactdy * dSolExactdy))*weight);</div>
<div class="line"><span class="lineno">  850</span>      }</div>
<div class="line"><span class="lineno">  851</span>    }</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>  }</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span>  error_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  856</span>  solution_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  857</span> </div>
<div class="line"><span class="lineno">  858</span>  <span class="keywordtype">double</span> l2_error = error_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#acf36fd402fe969244682a009f46d8f8c">l1_norm</a>();</div>
<div class="line"><span class="lineno">  859</span>  <span class="keywordtype">double</span> l2_solution = solution_vec-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#acf36fd402fe969244682a009f46d8f8c">l1_norm</a>();</div>
<div class="line"><span class="lineno">  860</span> </div>
<div class="line"><span class="lineno">  861</span>  <span class="keyword">delete</span> error_vec;</div>
<div class="line"><span class="lineno">  862</span>  <span class="keyword">delete</span> solution_vec;</div>
<div class="line"><span class="lineno">  863</span> </div>
<div class="line"><span class="lineno">  864</span>  <span class="keywordflow">return</span> sqrt(l2_error / l2_solution);</div>
<div class="line"><span class="lineno">  865</span> </div>
<div class="line"><span class="lineno">  866</span>}</div>
<div class="ttc" id="a_i_s_m_2ex3_2ex3_8cpp_html_a31c17cc321db72d5ab448b71ea92792f"><div class="ttname"><a href="../../df/d64/_i_s_m_2ex3_2ex3_8cpp.html#a31c17cc321db72d5ab448b71ea92792f">pi</a></div><div class="ttdeci">double pi</div><div class="ttdef"><b>Definition</b> <a href="../../df/d64/_i_s_m_2ex3_2ex3_8cpp_source.html#l00044">ex3.cpp:44</a></div></div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a></div><div class="ttdeci">@ PARALLEL</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00007">ParalleltypeEnum.hpp:7</a></div></div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a></div><div class="ttdeci">@ SERIAL</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00006">ParalleltypeEnum.hpp:6</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a89a77678df230dce7f2dd2ff171c71b4"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">femus::MultiLevelMesh::GetNumberOfLevels</a></div><div class="ttdeci">unsigned GetNumberOfLevels()</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00157">MultiLevelMesh.hpp:157</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0b3054885210f9a51ebff160e52ec2df"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">femus::MultiLevelSolution::_mlMesh</a></div><div class="ttdeci">MultiLevelMesh * _mlMesh</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00148">MultiLevelSolution.hpp:148</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a016609e0912f741ed161b201edf8f86f"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a016609e0912f741ed161b201edf8f86f">femus::NumericVector::add</a></div><div class="ttdeci">virtual void add(const int i, const double value)=0</div><div class="ttdoc">v(i) += value</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_aa554690df717f373d2b51e564fc421d6"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">femus::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector &gt; build(const SolverPackage solver_package=LSOLVER)</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbc/_numeric_vector_8cpp_source.html#l00035">NumericVector.cpp:35</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_abd17257b0b8aa9e09fd13cbd9c0bed08"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">femus::NumericVector::init</a></div><div class="ttdeci">virtual void init(const int, const int, const bool=false, const ParallelType=AUTOMATIC)=0</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_acf36fd402fe969244682a009f46d8f8c"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#acf36fd402fe969244682a009f46d8f8c">femus::NumericVector::l1_norm</a></div><div class="ttdeci">virtual double l1_norm() const =0</div></div>
<div class="ttc" id="aex20_8cpp_html_a7716ad279ddb09ed64dec90671bc9ddb"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#a7716ad279ddb09ed64dec90671bc9ddb">fp_dsoldy</a></div><div class="ttdeci">ParsedFunction fp_dsoldy</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00070">ex20.cpp:70</a></div></div>
<div class="ttc" id="aex20_8cpp_html_aa8d9c5fa63eeb198991d1abf849efb46"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#aa8d9c5fa63eeb198991d1abf849efb46">fp_sol</a></div><div class="ttdeci">ParsedFunction fp_sol</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00068">ex20.cpp:68</a></div></div>
<div class="ttc" id="aex20_8cpp_html_ad5653b0e7373558c99c8b385b10db24c"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#ad5653b0e7373558c99c8b385b10db24c">fp_dsoldx</a></div><div class="ttdeci">ParsedFunction fp_dsoldx</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00069">ex20.cpp:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Init Petsc-MPI communicator</p>
<p>INIT MESH =================================</p>
<p>Print all solutions</p>

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00073">73</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   73</span>                                {</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  std::string path;</div>
<div class="line"><span class="lineno">   76</span> </div>
<div class="line"><span class="lineno">   77</span>  <span class="keywordflow">if</span> (argc &lt; 2)</div>
<div class="line"><span class="lineno">   78</span>  {</div>
<div class="line"><span class="lineno">   79</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;Error: no input file specified!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_function" href="../../dc/d06/ex20_8cpp.html#a35ee06182a68a7e4ddf45e3b888e60c1">show_usage</a>();</div>
<div class="line"><span class="lineno">   81</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">   82</span>  }</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> count = 1; count &lt; argc; ++count)</div>
<div class="line"><span class="lineno">   85</span>  {</div>
<div class="line"><span class="lineno">   86</span>    std::string arg = argv[count];</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    <span class="keywordflow">if</span> ((arg == <span class="stringliteral">&quot;-h&quot;</span>) || (arg == <span class="stringliteral">&quot;--help&quot;</span>)) {</div>
<div class="line"><span class="lineno">   89</span>      <a class="code hl_function" href="../../dc/d06/ex20_8cpp.html#a35ee06182a68a7e4ddf45e3b888e60c1">show_usage</a>();</div>
<div class="line"><span class="lineno">   90</span>      <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">   91</span>    }</div>
<div class="line"><span class="lineno">   92</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> ((arg == <span class="stringliteral">&quot;-i&quot;</span>) || (arg == <span class="stringliteral">&quot;--inputfile&quot;</span>))</div>
<div class="line"><span class="lineno">   93</span>    {</div>
<div class="line"><span class="lineno">   94</span>      <span class="keywordflow">if</span> (count + 1 &lt; argc) {</div>
<div class="line"><span class="lineno">   95</span>        path = argv[++count];</div>
<div class="line"><span class="lineno">   96</span>      }</div>
<div class="line"><span class="lineno">   97</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   98</span>      {</div>
<div class="line"><span class="lineno">   99</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;--input file option requires one argument.&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  100</span>        <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  101</span>      }</div>
<div class="line"><span class="lineno">  102</span>    }</div>
<div class="line"><span class="lineno">  103</span>  }</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  <span class="comment">// start reading input from file</span></div>
<div class="line"><span class="lineno">  106</span>  <span class="comment">//-----------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>  std::string input = <a class="code hl_function" href="../../dc/d06/ex20_8cpp.html#a53f85b2fbf5b17ef7f7ee4251fc33cb7">readInputTestFile</a>(path.c_str());</div>
<div class="line"><span class="lineno">  109</span> </div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordflow">if</span> (input.empty())</div>
<div class="line"><span class="lineno">  111</span>  {</div>
<div class="line"><span class="lineno">  112</span>    printf(<span class="stringliteral">&quot;Failed to read input or empty input: %s\n&quot;</span>, path.c_str());</div>
<div class="line"><span class="lineno">  113</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  114</span>  }</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span>  Json::Value root;   <span class="comment">// will contains the root value after parsing.</span></div>
<div class="line"><span class="lineno">  117</span>  Json::Reader reader;</div>
<div class="line"><span class="lineno">  118</span>  <span class="keywordtype">bool</span> parsingSuccessful = reader.parse(input, root);</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>  <span class="keywordflow">if</span> (!parsingSuccessful)</div>
<div class="line"><span class="lineno">  121</span>  {</div>
<div class="line"><span class="lineno">  122</span>    <span class="comment">// report to the user the failure and their locations in the document.</span></div>
<div class="line"><span class="lineno">  123</span>    std::cout  &lt;&lt; <span class="stringliteral">&quot;Failed to parse configuration\n&quot;</span> &lt;&lt; reader.getFormatedErrorMessages();</div>
<div class="line"><span class="lineno">  124</span>    <span class="keywordflow">return</span> 1;</div>
<div class="line"><span class="lineno">  125</span>  }</div>
<div class="line"><span class="lineno">  126</span> </div>
<div class="line"><span class="lineno">  127</span>  std::string <a class="code hl_variable" href="../../da/da1/namespacebuild__edges__of__volumes.html#a8b9aa5b5b104ffacbc115e9ba3c22e6a">filename</a> = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;filename&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <span class="keywordtype">int</span> numelemx;</div>
<div class="line"><span class="lineno">  130</span>  <span class="keywordtype">int</span> numelemy;</div>
<div class="line"><span class="lineno">  131</span>  <span class="keywordtype">int</span> numelemz;</div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordtype">double</span> xa, xb, ya, yb, za, zb;</div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_enumeration" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a> elemtype;</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  <span class="keywordtype">bool</span> isBox = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="keyword">false</span>).asBool();</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <span class="keywordflow">if</span> (isBox) {</div>
<div class="line"><span class="lineno">  138</span>    numelemx = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;nx&quot;</span>, 2).asUInt();</div>
<div class="line"><span class="lineno">  139</span>    numelemy = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;ny&quot;</span>, 2).asUInt();</div>
<div class="line"><span class="lineno">  140</span>    numelemz = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;nz&quot;</span>, 2).asUInt();</div>
<div class="line"><span class="lineno">  141</span>    xa = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;xa&quot;</span>, 0.).asDouble();</div>
<div class="line"><span class="lineno">  142</span>    xb = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;xb&quot;</span>, 1.).asDouble();</div>
<div class="line"><span class="lineno">  143</span>    ya = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;ya&quot;</span>, 0.).asDouble();</div>
<div class="line"><span class="lineno">  144</span>    yb = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;yb&quot;</span>, 1.).asDouble();</div>
<div class="line"><span class="lineno">  145</span>    za = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;za&quot;</span>, 0.).asDouble();</div>
<div class="line"><span class="lineno">  146</span>    zb = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;zb&quot;</span>, 0.).asDouble();</div>
<div class="line"><span class="lineno">  147</span>    std::string elemtypestr = root[<span class="stringliteral">&quot;mesh&quot;</span>].get(<span class="stringliteral">&quot;box&quot;</span>, <span class="stringliteral">&quot;&quot;</span>).get(<span class="stringliteral">&quot;elem_type&quot;</span>, <span class="stringliteral">&quot;Quad9&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>    <span class="keywordflow">if</span> (elemtypestr == <span class="stringliteral">&quot;Quad9&quot;</span>)</div>
<div class="line"><span class="lineno">  150</span>    {</div>
<div class="line"><span class="lineno">  151</span>      elemtype = <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a>;</div>
<div class="line"><span class="lineno">  152</span>    }</div>
<div class="line"><span class="lineno">  153</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elemtypestr == <span class="stringliteral">&quot;Tri6&quot;</span>)</div>
<div class="line"><span class="lineno">  154</span>    {</div>
<div class="line"><span class="lineno">  155</span>      elemtype = <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a412f583bcb9d2bdc856cc6f373b403a6">TRI6</a>;</div>
<div class="line"><span class="lineno">  156</span>    }</div>
<div class="line"><span class="lineno">  157</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elemtypestr == <span class="stringliteral">&quot;Edge3&quot;</span>)</div>
<div class="line"><span class="lineno">  158</span>    {</div>
<div class="line"><span class="lineno">  159</span>      elemtype = <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a>;</div>
<div class="line"><span class="lineno">  160</span>    }</div>
<div class="line"><span class="lineno">  161</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (elemtypestr == <span class="stringliteral">&quot;Hex27&quot;</span>)</div>
<div class="line"><span class="lineno">  162</span>    {</div>
<div class="line"><span class="lineno">  163</span>      elemtype = <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27">HEX27</a>;</div>
<div class="line"><span class="lineno">  164</span>    }</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  166</span>    {</div>
<div class="line"><span class="lineno">  167</span>      elemtype = <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a79ebcb2edd3d6f041829b84eace9f517">INVALID_ELEM</a>;</div>
<div class="line"><span class="lineno">  168</span>    }</div>
<div class="line"><span class="lineno">  169</span>    </div>
<div class="line"><span class="lineno">  170</span>  }</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  std::string variableName = root[<span class="stringliteral">&quot;variable&quot;</span>].get(<span class="stringliteral">&quot;name&quot;</span>, <span class="stringliteral">&quot;Q&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>  <a class="code hl_enumeration" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3ba">FEOrder</a> fe_order;</div>
<div class="line"><span class="lineno">  175</span>  std::string fe_order_str = root[<span class="stringliteral">&quot;variable&quot;</span>].get(<span class="stringliteral">&quot;fe_order&quot;</span>, <span class="stringliteral">&quot;first&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>  <span class="keywordflow">if</span> (!strcmp(fe_order_str.c_str(), <span class="stringliteral">&quot;first&quot;</span>))</div>
<div class="line"><span class="lineno">  178</span>  {</div>
<div class="line"><span class="lineno">  179</span>    fe_order = <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>;</div>
<div class="line"><span class="lineno">  180</span>  }</div>
<div class="line"><span class="lineno">  181</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(fe_order_str.c_str(), <span class="stringliteral">&quot;serendipity&quot;</span>))</div>
<div class="line"><span class="lineno">  182</span>  {</div>
<div class="line"><span class="lineno">  183</span>    fe_order = <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae3061383e18f31bbeb7e22fd9f34396e">SERENDIPITY</a>;</div>
<div class="line"><span class="lineno">  184</span>  }</div>
<div class="line"><span class="lineno">  185</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(fe_order_str.c_str(), <span class="stringliteral">&quot;second&quot;</span>))</div>
<div class="line"><span class="lineno">  186</span>  {</div>
<div class="line"><span class="lineno">  187</span>    fe_order = <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>;</div>
<div class="line"><span class="lineno">  188</span>  }</div>
<div class="line"><span class="lineno">  189</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  190</span>  {</div>
<div class="line"><span class="lineno">  191</span>    std::cerr &lt;&lt; <span class="stringliteral">&quot; Error: Lagrange finite element order not supported!&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  192</span>    exit(1);</div>
<div class="line"><span class="lineno">  193</span>  }</div>
<div class="line"><span class="lineno">  194</span> </div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nlevels  = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;nlevels&quot;</span>, 1).asInt();</div>
<div class="line"><span class="lineno">  197</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> SMRlevels        = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;SMRlevels&quot;</span>, 0).asInt();</div>
<div class="line"><span class="lineno">  198</span>  std::string  AMR              = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;AMR&quot;</span>, <span class="stringliteral">&quot;no&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  199</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> maxAMRlevels     = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;maxAMRlevels&quot;</span>, 0).asInt();</div>
<div class="line"><span class="lineno">  200</span>  std::string  AMRnorm  = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;AMRnorm&quot;</span>, <span class="stringliteral">&quot;l2&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordtype">double</span>       AMRthreshold     = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;AMRthreshold&quot;</span>, <span class="stringliteral">&quot;0.001&quot;</span>).asDouble();</div>
<div class="line"><span class="lineno">  202</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npresmoothing    = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;npresmoothing&quot;</span>, 1).asUInt();</div>
<div class="line"><span class="lineno">  203</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> npostmoothing    = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;npostsmoothing&quot;</span>, 1).asUInt();</div>
<div class="line"><span class="lineno">  204</span>  std::string smoother_type     = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;smoother_type&quot;</span>, <span class="stringliteral">&quot;gmres&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  205</span>  std::string mg_type           = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;mgtype&quot;</span>, <span class="stringliteral">&quot;V_cycle&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  206</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_number_linear_iteration = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;max_number_linear_iteration&quot;</span>, 6).asUInt();</div>
<div class="line"><span class="lineno">  207</span>  <span class="keywordtype">double</span> abs_conv_tol        = root[<span class="stringliteral">&quot;mgsolver&quot;</span>].get(<span class="stringliteral">&quot;abs_conv_tol&quot;</span>, 1.e-09).asDouble();</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>  <a class="code hl_enumeration" href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781">MgType</a> mgtype;</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>  <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;V_cycle&quot;</span>, mg_type.c_str()))</div>
<div class="line"><span class="lineno">  212</span>  {</div>
<div class="line"><span class="lineno">  213</span>    mgtype = <a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a>;</div>
<div class="line"><span class="lineno">  214</span>  }</div>
<div class="line"><span class="lineno">  215</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;F_cycle&quot;</span>, mg_type.c_str()))</div>
<div class="line"><span class="lineno">  216</span>  {</div>
<div class="line"><span class="lineno">  217</span>    mgtype = <a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a6ce16ab03eaaecb71458081ce0147fa0">F_CYCLE</a>;</div>
<div class="line"><span class="lineno">  218</span>  }</div>
<div class="line"><span class="lineno">  219</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;F_cycle&quot;</span>, mg_type.c_str()))</div>
<div class="line"><span class="lineno">  220</span>  {</div>
<div class="line"><span class="lineno">  221</span>    mgtype = <a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a6ce16ab03eaaecb71458081ce0147fa0">F_CYCLE</a>;</div>
<div class="line"><span class="lineno">  222</span>  }</div>
<div class="line"><span class="lineno">  223</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  224</span>    cout &lt;&lt; <span class="stringliteral">&quot;The selected MG cycle does not exist!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  225</span>    exit(1);</div>
<div class="line"><span class="lineno">  226</span>  }</div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span>  <span class="keywordtype">bool</span> Gmres = 0, Asm = 0;</div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;gmres&quot;</span>, smoother_type.c_str()))     Gmres = 1;</div>
<div class="line"><span class="lineno">  230</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(<span class="stringliteral">&quot;asm&quot;</span>, smoother_type.c_str()))       Asm = 1;</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>  <span class="keywordflow">if</span> (Gmres + Asm == 0) {</div>
<div class="line"><span class="lineno">  233</span>    cout &lt;&lt; <span class="stringliteral">&quot;The selected MG smoother does not exist!&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">  234</span>    exit(1);</div>
<div class="line"><span class="lineno">  235</span>  }</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>  <span class="comment">// end reading input from file</span></div>
<div class="line"><span class="lineno">  238</span>  <span class="comment">//-----------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span> </div>
<div class="line"><span class="lineno">  241</span>  <span class="comment">// reading function</span></div>
<div class="line"><span class="lineno">  242</span>  std::string variables = <span class="stringliteral">&quot;x&quot;</span>;</div>
<div class="line"><span class="lineno">  243</span>  variables += <span class="stringliteral">&quot;,y&quot;</span>;</div>
<div class="line"><span class="lineno">  244</span>  variables += <span class="stringliteral">&quot;,z&quot;</span>;</div>
<div class="line"><span class="lineno">  245</span>  variables += <span class="stringliteral">&quot;,t&quot;</span>;</div>
<div class="line"><span class="lineno">  246</span>  std::string function;</div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span><span class="preprocessor">#ifdef HAVE_FPARSER</span></div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>  function = root[<span class="stringliteral">&quot;variable&quot;</span>].get(<span class="stringliteral">&quot;func_source1&quot;</span>, <span class="stringliteral">&quot;0.&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  251</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a8b9f315bff384189fd2f344bf4a9c401">fpsource</a>.SetExpression(function);</div>
<div class="line"><span class="lineno">  252</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a8b9f315bff384189fd2f344bf4a9c401">fpsource</a>.SetIndependentVariables(variables);</div>
<div class="line"><span class="lineno">  253</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a8b9f315bff384189fd2f344bf4a9c401">fpsource</a>.Parse();</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>  function = root[<span class="stringliteral">&quot;func_sol1&quot;</span>].get(<span class="stringliteral">&quot;sol&quot;</span>, <span class="stringliteral">&quot;0.&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  256</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#aa8d9c5fa63eeb198991d1abf849efb46">fp_sol</a>.SetExpression(function);</div>
<div class="line"><span class="lineno">  257</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#aa8d9c5fa63eeb198991d1abf849efb46">fp_sol</a>.SetIndependentVariables(variables);</div>
<div class="line"><span class="lineno">  258</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#aa8d9c5fa63eeb198991d1abf849efb46">fp_sol</a>.Parse();</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>  function = root[<span class="stringliteral">&quot;func_sol1&quot;</span>].get(<span class="stringliteral">&quot;dsoldx&quot;</span>, <span class="stringliteral">&quot;0.&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  261</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#ad5653b0e7373558c99c8b385b10db24c">fp_dsoldx</a>.SetExpression(function);</div>
<div class="line"><span class="lineno">  262</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#ad5653b0e7373558c99c8b385b10db24c">fp_dsoldx</a>.SetIndependentVariables(variables);</div>
<div class="line"><span class="lineno">  263</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#ad5653b0e7373558c99c8b385b10db24c">fp_dsoldx</a>.Parse();</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>  function = root[<span class="stringliteral">&quot;func_sol1&quot;</span>].get(<span class="stringliteral">&quot;dsoldy&quot;</span>, <span class="stringliteral">&quot;0.&quot;</span>).asString();</div>
<div class="line"><span class="lineno">  266</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a7716ad279ddb09ed64dec90671bc9ddb">fp_dsoldy</a>.SetExpression(function);</div>
<div class="line"><span class="lineno">  267</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a7716ad279ddb09ed64dec90671bc9ddb">fp_dsoldy</a>.SetIndependentVariables(variables);</div>
<div class="line"><span class="lineno">  268</span>  <a class="code hl_variable" href="../../dc/d06/ex20_8cpp.html#a7716ad279ddb09ed64dec90671bc9ddb">fp_dsoldy</a>.Parse();</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span> </div>
<div class="line"><span class="lineno">  271</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>  std::vector&lt;std::string&gt; facenamearray;</div>
<div class="line"><span class="lineno">  274</span>  std::vector&lt;ParsedFunction&gt; parsedfunctionarray;</div>
<div class="line"><span class="lineno">  275</span>  std::vector&lt;BDCType&gt; bdctypearray;</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span><span class="comment">//   const Json::Value boundary_conditions = root[&quot;boundary_conditions&quot;];</span></div>
<div class="line"><span class="lineno">  278</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  279</span><span class="comment">//   for (unsigned int index = 0; index &lt; boundary_conditions.size(); ++index) {</span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  281</span><span class="comment">//     std::string facename = boundary_conditions[index].get(&quot;facename&quot;, &quot;to&quot;).asString();</span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">//     facenamearray.push_back(facename);</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">//     std::string bdctypestr = boundary_conditions[index].get(&quot;bdc_type&quot;, &quot;to&quot;).asString();</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">//     BDCType bdctype = DIRICHLET;</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">//     if (bdctypestr.compare(&quot;dirichlet&quot;) == 0) {</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">//       bdctype = DIRICHLET;</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">//     else if (bdctypestr.compare(&quot;neumann&quot;) == 0) {</span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">//       bdctype = NEUMANN;</span></div>
<div class="line"><span class="lineno">  292</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  293</span><span class="comment">//     else {</span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">//       std::cout &lt;&lt; &quot;Boundary condition not implemented! Default one (Dirichlet) is set.&quot; &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">//     bdctypearray.push_back(bdctype);</span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">//     std::string bdcfuncstr = boundary_conditions[index].get(&quot;bdc_func&quot;, &quot;0.&quot;).asString();</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">//     ParsedFunction pfunc(bdcfuncstr, &quot;x,y,z,t&quot;);</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">//     parsedfunctionarray.push_back(pfunc);</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span>  <span class="comment">//---------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  305</span> </div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  308</span>  <a class="code hl_class" href="../../da/d5e/classfemus_1_1_femus_init.html">FemusInit</a> mpinit(argc, argv, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>  <span class="comment">//Files files;</span></div>
<div class="line"><span class="lineno">  311</span>  <span class="comment">//files.CheckIODirectories(true);</span></div>
<div class="line"><span class="lineno">  312</span>  <span class="comment">//files.RedirectCout(true);</span></div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  315</span> </div>
<div class="line"><span class="lineno">  316</span>  <span class="keywordtype">unsigned</span> <span class="keywordtype">short</span> nm, nr;</div>
<div class="line"><span class="lineno">  317</span>  nm = nlevels;</div>
<div class="line"><span class="lineno">  318</span>  nr = 0; <span class="comment">//SMRlevels;</span></div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>  <span class="keywordtype">int</span> tmp = nm;</div>
<div class="line"><span class="lineno">  322</span>  nm += nr;</div>
<div class="line"><span class="lineno">  323</span>  nr = tmp;</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>  <span class="comment">//Adimensional quantity (Lref,Uref)</span></div>
<div class="line"><span class="lineno">  326</span>  <span class="keywordtype">double</span> Lref = 1.;</div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordtype">double</span> Uref = 1.;</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>  <span class="comment">//Steadystate NonLinearMultiLevelProblem</span></div>
<div class="line"><span class="lineno">  330</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_msh;</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>  <span class="keywordflow">if</span> (filename != <span class="stringliteral">&quot;&quot;</span>)</div>
<div class="line"><span class="lineno">  333</span>  {</div>
<div class="line"><span class="lineno">  334</span>    ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a29d0d0f9463c9417d390da6149ffc24d">ReadCoarseMesh</a>(<a class="code hl_variable" href="../../da/da1/namespacebuild__edges__of__volumes.html#a8b9aa5b5b104ffacbc115e9ba3c22e6a">filename</a>.c_str(), <span class="stringliteral">&quot;seventh&quot;</span>, Lref);</div>
<div class="line"><span class="lineno">  335</span>  }</div>
<div class="line"><span class="lineno">  336</span>  <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  337</span>  {</div>
<div class="line"><span class="lineno">  338</span>    ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(numelemx, numelemy, numelemz, xa, xb, ya, yb, za, zb, elemtype, <span class="stringliteral">&quot;seventh&quot;</span>);</div>
<div class="line"><span class="lineno">  339</span>  }</div>
<div class="line"><span class="lineno">  340</span> </div>
<div class="line"><span class="lineno">  341</span>  <span class="comment">//ml_msh.RefineMesh(nm,nr, SetRefinementFlag);</span></div>
<div class="line"><span class="lineno">  342</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">RefineMesh</a>(nm, nr, NULL);</div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> ml_sol(&amp;ml_msh);</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>  <span class="comment">// generate solution vector</span></div>
<div class="line"><span class="lineno">  349</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;Sol&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, fe_order);</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>  <span class="comment">//Initialize (update Init(...) function)</span></div>
<div class="line"><span class="lineno">  352</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>  <span class="comment">//Set Boundary (update Dirichlet(...) function)</span></div>
<div class="line"><span class="lineno">  355</span> <span class="comment">// ml_sol.InitializeBdc();</span></div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span><span class="comment">//     ml_sol.SetBoundaryCondition(&quot;Sol&quot;,&quot;right&quot;, NEUMANN, false, false, &amp;bdcfunc);</span></div>
<div class="line"><span class="lineno">  358</span><span class="comment">//     ml_sol.SetBoundaryCondition(&quot;Sol&quot;,&quot;top&quot;, NEUMANN);</span></div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span><span class="comment">//   for (int i = 0; i &lt; boundary_conditions.size(); ++i) {</span></div>
<div class="line"><span class="lineno">  361</span><span class="comment">//     ml_sol.SetBoundaryCondition_new(&quot;Sol&quot;, facenamearray[i], bdctypearray[i], false, &amp;parsedfunctionarray[i]);</span></div>
<div class="line"><span class="lineno">  362</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  363</span> </div>
<div class="line"><span class="lineno">  364</span>  <span class="comment">//ml_sol.GenerateBdc(&quot;All&quot;);</span></div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>  ml_sol.AttachSetBoundaryConditionFunction(<a class="code hl_function" href="../../dc/d06/ex20_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a>);</div>
<div class="line"><span class="lineno">  368</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span> </div>
<div class="line"><span class="lineno">  371</span>  std::cout&lt;&lt;<span class="stringliteral">&quot;AAAAAAAAAAAAAAAAAAAAA&quot;</span>&lt;&lt;std::flush;</div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>  <span class="comment">// ml_msh.AddMeshLevel(SetRefinementFlag);</span></div>
<div class="line"><span class="lineno">  374</span>  <span class="comment">// ml_sol.AddSolutionLevel();</span></div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob(&amp;ml_sol);</div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span><span class="comment">// ml_prob.parameters.set&lt;func&gt;(&quot;func_source&quot;) = fpsource;</span></div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>  <span class="comment">// add fluid material</span></div>
<div class="line"><span class="lineno">  383</span>  <a class="code hl_class" href="../../d7/d3c/classfemus_1_1_parameter.html">Parameter</a> parameter(Lref, Uref);</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>  <span class="comment">//BEGIN Poisson MultiLevel Problem</span></div>
<div class="line"><span class="lineno">  386</span>  std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  387</span>  std::cout &lt;&lt; <span class="stringliteral">&quot; PDE problem to solve: Poisson &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>  <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&amp; system2 = ml_prob.add_system&lt;<a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&gt;(<span class="stringliteral">&quot;Poisson&quot;</span>);</div>
<div class="line"><span class="lineno">  390</span>  system2.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>  <span class="comment">// Set MG Options</span></div>
<div class="line"><span class="lineno">  393</span>  system2.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="../../dc/d06/ex20_8cpp.html#ad336ac0f14496ce33e2cbb8257db5fd5">AssemblePoissonMatrixandRhs</a>);</div>
<div class="line"><span class="lineno">  394</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aac52d38a95ff85409abd6e2d92a7c73a">SetMaxNumberOfLinearIterations</a>(max_number_linear_iteration);</div>
<div class="line"><span class="lineno">  395</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">SetAbsoluteLinearConvergenceTolerance</a>(abs_conv_tol);</div>
<div class="line"><span class="lineno">  396</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">SetMgType</a>(mgtype);</div>
<div class="line"><span class="lineno">  397</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">SetNumberPreSmoothingStep</a>(npresmoothing);</div>
<div class="line"><span class="lineno">  398</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">SetNumberPostSmoothingStep</a>(npostmoothing);</div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  <span class="comment">//Set Smoother Options</span></div>
<div class="line"><span class="lineno">  401</span>  <span class="keywordflow">if</span> (Gmres)            system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">SetLinearEquationSolverType</a>(<a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a>);</div>
<div class="line"><span class="lineno">  402</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Asm)         system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">SetLinearEquationSolverType</a>(<a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e">FEMuS_ASM</a>);</div>
<div class="line"><span class="lineno">  403</span> </div>
<div class="line"><span class="lineno">  404</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4605bac9ea670bb7dbd4454358155670">init</a>();</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>  <span class="comment">//system2.SetAMRSetOptions(AMR,AMRlevels,AMRnorm,AMRthreshold,SetRefinementFlag);</span></div>
<div class="line"><span class="lineno">  407</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aae918be6d07990b18bdf6713759c1cb9">SetAMRSetOptions</a>(AMR, maxAMRlevels, AMRnorm, AMRthreshold);</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>  <span class="comment">//common smoother option</span></div>
<div class="line"><span class="lineno">  410</span>  <span class="comment">//system2.SetSolverFineGrids(GMRES);</span></div>
<div class="line"><span class="lineno">  411</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">SetSolverFineGrids</a>(<a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3">RICHARDSON</a>);</div>
<div class="line"><span class="lineno">  412</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">SetTolerances</a>(1.e-12, 1.e-20, 1.e+50, 4);</div>
<div class="line"><span class="lineno">  413</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">SetPreconditionerFineGrids</a>(<a class="code hl_enumvalue" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a>);</div>
<div class="line"><span class="lineno">  414</span>  <span class="comment">//for Vanka and ASM smoothers</span></div>
<div class="line"><span class="lineno">  415</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a71658025becd1238e92318c950792b4b">ClearVariablesToBeSolved</a>();</div>
<div class="line"><span class="lineno">  416</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ab0c6f96601a00ae5f20a44bd137592b8">AddVariableToBeSolved</a>(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>  <span class="keywordflow">if</span> (Asm )</div>
<div class="line"><span class="lineno">  419</span>  {</div>
<div class="line"><span class="lineno">  420</span>    system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a0e60a0d128854b91b1740f656fb7526d">SetNumberOfSchurVariables</a>(0);</div>
<div class="line"><span class="lineno">  421</span>    system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a9521cfdd56da0ec0bc439066ce950bb0">SetElementBlockNumber</a>(4);</div>
<div class="line"><span class="lineno">  422</span>  }</div>
<div class="line"><span class="lineno">  423</span> </div>
<div class="line"><span class="lineno">  424</span>  <span class="comment">//for Gmres smoother</span></div>
<div class="line"><span class="lineno">  425</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a19479f6fb09ab437c3e2e7116ec3cd08">SetDirichletBCsHandling</a>(<a class="code hl_enumvalue" href="../../d2/d61/_dirichlet_b_c_type_enum_8hpp.html#a642eeb34fa6e30051fcb1258b649e241a4dd22f2a751ddd7f5cb0b8409552b3a6">PENALTY</a>);</div>
<div class="line"><span class="lineno">  426</span> </div>
<div class="line"><span class="lineno">  427</span>  <span class="comment">// Solve Temperature system</span></div>
<div class="line"><span class="lineno">  428</span>  </div>
<div class="line"><span class="lineno">  429</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a68382fae5355ec80f88f0dca96086d51">MGsolve</a>();</div>
<div class="line"><span class="lineno">  430</span>  <span class="comment">//END Temperature Multilevel Problem</span></div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  433</span>  std::vector&lt;std::string&gt; print_vars;</div>
<div class="line"><span class="lineno">  434</span>  print_vars.push_back(<span class="stringliteral">&quot;Sol&quot;</span>);</div>
<div class="line"><span class="lineno">  435</span> </div>
<div class="line"><span class="lineno">  436</span>  <span class="comment">//VTKWriter vtkio(&amp;ml_sol);</span></div>
<div class="line"><span class="lineno">  437</span>  <span class="comment">//vtkio.ParallelWrite(files.GetOutputPath(),&quot;biquadratic&quot;,print_vars);</span></div>
<div class="line"><span class="lineno">  438</span> </div>
<div class="line"><span class="lineno">  439</span>  <span class="comment">//GMVWriter gmvio(&amp;ml_sol);</span></div>
<div class="line"><span class="lineno">  440</span>  <span class="comment">//gmvio.ParallelWrite(files.GetOutputPath(),&quot;biquadratic&quot;,print_vars);</span></div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>  <a class="code hl_class" href="../../d4/d8d/classfemus_1_1_v_t_k_writer.html">VTKWriter</a> vtkio(&amp;ml_sol);</div>
<div class="line"><span class="lineno">  443</span>  vtkio.Write(<a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;biquadratic&quot;</span>, print_vars);</div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span>  <span class="comment">//GMVWriter gmvio(&amp;ml_sol);</span></div>
<div class="line"><span class="lineno">  446</span>  <span class="comment">//gmvio.ParallelWrite(DEFAULT_OUTPUTDIR,&quot;biquadratic&quot;,print_vars);</span></div>
<div class="line"><span class="lineno">  447</span> </div>
<div class="line"><span class="lineno">  448</span>  <span class="comment">//</span></div>
<div class="line"><span class="lineno">  449</span>  <span class="comment">//     XDMFWriter xdmfio(ml_sol);</span></div>
<div class="line"><span class="lineno">  450</span>  <span class="comment">//     xdmfio.write(&quot;biquadratic&quot;,print_vars);</span></div>
<div class="line"><span class="lineno">  451</span> </div>
<div class="line"><span class="lineno">  452</span>  <span class="keywordtype">int</span>  iproc;</div>
<div class="line"><span class="lineno">  453</span>  MPI_Comm_rank(MPI_COMM_WORLD, &amp;iproc);</div>
<div class="line"><span class="lineno">  454</span>  <span class="keywordflow">if</span>(AMRnorm == <span class="stringliteral">&quot;l2&quot;</span>) {</div>
<div class="line"><span class="lineno">  455</span>  <span class="keywordtype">double</span> l2error = <a class="code hl_function" href="../../dc/d06/ex20_8cpp.html#a8bcc082bbb8f18ce8b4479f0359ffdaf">GetRelativeError</a>(ml_sol, <span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>  <span class="keywordflow">if</span> (iproc == 0) printf(<span class="stringliteral">&quot;\n||Sol_h-Sol||_L2 / ||Sol||_L2  = %g \n&quot;</span>, l2error);</div>
<div class="line"><span class="lineno">  458</span>   ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  459</span>  }</div>
<div class="line"><span class="lineno">  460</span>  <span class="keywordflow">else</span> <span class="keywordflow">if</span>(AMRnorm == <span class="stringliteral">&quot;H1&quot;</span>) {</div>
<div class="line"><span class="lineno">  461</span>  <span class="keywordtype">double</span> H1error = <a class="code hl_function" href="../../dc/d06/ex20_8cpp.html#a8bcc082bbb8f18ce8b4479f0359ffdaf">GetRelativeError</a>(ml_sol, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  462</span> </div>
<div class="line"><span class="lineno">  463</span>  <span class="keywordflow">if</span> (iproc == 0) printf(<span class="stringliteral">&quot;\n||Sol_h-Sol||_H1 / ||Sol||_H1  = %g \n&quot;</span>, H1error);</div>
<div class="line"><span class="lineno">  464</span>   ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  465</span>      </div>
<div class="line"><span class="lineno">  466</span> }</div>
<div class="line"><span class="lineno">  467</span> <span class="keywordflow">else</span> {std::cout &lt;&lt; std::endl&lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; *********AMRnorm use &#39;H1&#39; or &#39;l2&#39;************&quot;</span> &lt;&lt; std::endl;}</div>
<div class="line"><span class="lineno">  468</span> </div>
<div class="line"><span class="lineno">  469</span>  <span class="comment">//Destroy all the new systems</span></div>
<div class="line"><span class="lineno">  470</span>  ml_prob.clear();</div>
<div class="line"><span class="lineno">  471</span> </div>
<div class="line"><span class="lineno">  472</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  473</span>}</div>
<div class="ttc" id="a_dirichlet_b_c_type_enum_8hpp_html_a642eeb34fa6e30051fcb1258b649e241a4dd22f2a751ddd7f5cb0b8409552b3a6"><div class="ttname"><a href="../../d2/d61/_dirichlet_b_c_type_enum_8hpp.html#a642eeb34fa6e30051fcb1258b649e241a4dd22f2a751ddd7f5cb0b8409552b3a6">PENALTY</a></div><div class="ttdeci">@ PENALTY</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d61/_dirichlet_b_c_type_enum_8hpp_source.html#l00005">DirichletBCTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00006">ElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27">HEX27</a></div><div class="ttdeci">@ HEX27</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00023">ElemTypeEnum.hpp:23</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a></div><div class="ttdeci">@ EDGE3</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00008">ElemTypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a412f583bcb9d2bdc856cc6f373b403a6"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a412f583bcb9d2bdc856cc6f373b403a6">TRI6</a></div><div class="ttdeci">@ TRI6</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00012">ElemTypeEnum.hpp:12</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a79ebcb2edd3d6f041829b84eace9f517"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a79ebcb2edd3d6f041829b84eace9f517">INVALID_ELEM</a></div><div class="ttdeci">@ INVALID_ELEM</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00048">ElemTypeEnum.hpp:47</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a></div><div class="ttdeci">@ QUAD9</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00016">ElemTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3ba"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3ba">FEOrder</a></div><div class="ttdeci">FEOrder</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00013">FElemTypeEnum.hpp:13</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00018">FElemTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baae3061383e18f31bbeb7e22fd9f34396e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae3061383e18f31bbeb7e22fd9f34396e">SERENDIPITY</a></div><div class="ttdeci">@ SERENDIPITY</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00016">FElemTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_af12829f27afb4207fd7c58ef847b9d8b"><div class="ttname"><a href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a></div><div class="ttdeci">#define DEFAULT_OUTPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="../../de/df8/_femus_default_8hpp_source.html#l00041">FemusDefault.hpp:41</a></div></div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0"><div class="ttname"><a href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a></div><div class="ttdeci">@ FEMuS_DEFAULT</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db5/_linear_equation_solver_enum_8hpp_source.html#l00005">LinearEquationSolverEnum.hpp:5</a></div></div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e"><div class="ttname"><a href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9ad01f8361c54d2a35a741f25e2f63038e">FEMuS_ASM</a></div><div class="ttdeci">@ FEMuS_ASM</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db5/_linear_equation_solver_enum_8hpp_source.html#l00006">LinearEquationSolverEnum.hpp:6</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_a35aafc39068a269f658aac64338aa781"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781">MgType</a></div><div class="ttdeci">MgType</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00004">MgTypeEnum.hpp:4</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a></div><div class="ttdeci">@ V_CYCLE</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00006">MgTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_a35aafc39068a269f658aac64338aa781a6ce16ab03eaaecb71458081ce0147fa0"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a6ce16ab03eaaecb71458081ce0147fa0">F_CYCLE</a></div><div class="ttdeci">@ F_CYCLE</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00005">MgTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea"><div class="ttname"><a href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a></div><div class="ttdeci">@ ILU_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d70/_precondtype_enum_8hpp_source.html#l00016">PrecondtypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306eca67bb8c58aed4c0e8302e11beaea5b8f3">RICHARDSON</a></div><div class="ttdeci">@ RICHARDSON</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00023">SolvertypeEnum.hpp:23</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a03b082409d094d87e46e023356c4cb8e"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">femus::LinearImplicitSystem::SetSolverFineGrids</a></div><div class="ttdeci">void SetSolverFineGrids(const SolverType &amp;solvertype)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l01029">LinearImplicitSystem.cpp:1029</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a0e60a0d128854b91b1740f656fb7526d"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a0e60a0d128854b91b1740f656fb7526d">femus::LinearImplicitSystem::SetNumberOfSchurVariables</a></div><div class="ttdeci">void SetNumberOfSchurVariables(const unsigned short &amp;NSchurVar)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l01072">LinearImplicitSystem.cpp:1072</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a19479f6fb09ab437c3e2e7116ec3cd08"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a19479f6fb09ab437c3e2e7116ec3cd08">femus::LinearImplicitSystem::SetDirichletBCsHandling</a></div><div class="ttdeci">void SetDirichletBCsHandling(const DirichletBCType DirichletMode)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00932">LinearImplicitSystem.cpp:932</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a3e3ca74a8990338254d7907397402bac"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">femus::LinearImplicitSystem::SetMgType</a></div><div class="ttdeci">void SetMgType(const MgType mgtype)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00110">LinearImplicitSystem.hpp:110</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a4605bac9ea670bb7dbd4454358155670"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4605bac9ea670bb7dbd4454358155670">femus::LinearImplicitSystem::init</a></div><div class="ttdeci">virtual void init()</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00129">LinearImplicitSystem.cpp:129</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a4c8a469ba9b68aa14c0780f3a7b61d58"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">femus::LinearImplicitSystem::SetAbsoluteLinearConvergenceTolerance</a></div><div class="ttdeci">void SetAbsoluteLinearConvergenceTolerance(const double &amp;absolute_convergence_tolerance)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00102">LinearImplicitSystem.hpp:102</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a68382fae5355ec80f88f0dca96086d51"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a68382fae5355ec80f88f0dca96086d51">femus::LinearImplicitSystem::MGsolve</a></div><div class="ttdeci">virtual void MGsolve(const MgSmootherType &amp;mgSmootherType=MULTIPLICATIVE)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00275">LinearImplicitSystem.cpp:275</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a71658025becd1238e92318c950792b4b"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a71658025becd1238e92318c950792b4b">femus::LinearImplicitSystem::ClearVariablesToBeSolved</a></div><div class="ttdeci">void ClearVariablesToBeSolved()</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00975">LinearImplicitSystem.cpp:975</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a85fc9c2a6bb9b384c298b1d42d2fba59"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">femus::LinearImplicitSystem::SetNumberPreSmoothingStep</a></div><div class="ttdeci">void SetNumberPreSmoothingStep(const unsigned &amp;npre)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00204">LinearImplicitSystem.hpp:204</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a9521cfdd56da0ec0bc439066ce950bb0"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a9521cfdd56da0ec0bc439066ce950bb0">femus::LinearImplicitSystem::SetElementBlockNumber</a></div><div class="ttdeci">void SetElementBlockNumber(unsigned const &amp;dim_vanka_block)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00999">LinearImplicitSystem.cpp:999</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aac52d38a95ff85409abd6e2d92a7c73a"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aac52d38a95ff85409abd6e2d92a7c73a">femus::LinearImplicitSystem::SetMaxNumberOfLinearIterations</a></div><div class="ttdeci">void SetMaxNumberOfLinearIterations(unsigned int max_lin_it)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00084">LinearImplicitSystem.hpp:84</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aae918be6d07990b18bdf6713759c1cb9"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aae918be6d07990b18bdf6713759c1cb9">femus::LinearImplicitSystem::SetAMRSetOptions</a></div><div class="ttdeci">void SetAMRSetOptions(const std::string &amp;AMR, const unsigned &amp;AMRlevels, const std::string &amp;AMRnorm, const double &amp;AMRthreshold, bool(*SetRefinementFlag)(const std::vector&lt; double &gt; &amp;x, const int &amp;ElemGroupNumber, const int &amp;level)=NULL)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00621">LinearImplicitSystem.cpp:621</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aaff342b69e3dd0e77a1bc084030f795c"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">femus::LinearImplicitSystem::SetPreconditionerFineGrids</a></div><div class="ttdeci">void SetPreconditionerFineGrids(const PreconditionerType &amp;preconditioner_type)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l01047">LinearImplicitSystem.cpp:1047</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_ab0c6f96601a00ae5f20a44bd137592b8"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ab0c6f96601a00ae5f20a44bd137592b8">femus::LinearImplicitSystem::AddVariableToBeSolved</a></div><div class="ttdeci">void AddVariableToBeSolved(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00944">LinearImplicitSystem.cpp:944</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aba6bff678d322a8d98c38360e93dab14"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">femus::LinearImplicitSystem::SetLinearEquationSolverType</a></div><div class="ttdeci">void SetLinearEquationSolverType(const LinearEquationSolverType LinearEquationSolverType, const CoarseLevelInclude &amp;includeCoarseLevel=INCLUDE_COARSE_LEVEL_FALSE)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00981">LinearImplicitSystem.cpp:981</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_abee928911384fcf422b7df9e89bd192c"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">femus::LinearImplicitSystem::SetTolerances</a></div><div class="ttdeci">void SetTolerances(const double &amp;rtol, const double &amp;atol, const double &amp;divtol, const unsigned &amp;maxits, const unsigned &amp;restart=30)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l01057">LinearImplicitSystem.cpp:1057</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_ac02a64ba83b4d1a33a889a677da875fb"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">femus::LinearImplicitSystem::SetNumberPostSmoothingStep</a></div><div class="ttdeci">void SetNumberPostSmoothingStep(const unsigned &amp;npost)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00213">LinearImplicitSystem.hpp:213</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a06c4fe014434c2bafdd2c6e94e018620"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">femus::MultiLevelMesh::RefineMesh</a></div><div class="ttdeci">void RefineMesh(const unsigned short &amp;igridn, const unsigned short &amp;igridr, bool(*SetRefinementFlag)(const std::vector&lt; double &gt; &amp;x, const int &amp;ElemGroupNumber, const int &amp;level))</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00495">MultiLevelMesh.cpp:495</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a09c12975f18035d5369ae411c0208648"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">femus::MultiLevelMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo()</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00462">MultiLevelMesh.cpp:462</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a29d0d0f9463c9417d390da6149ffc24d"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a29d0d0f9463c9417d390da6149ffc24d">femus::MultiLevelMesh::ReadCoarseMesh</a></div><div class="ttdeci">void ReadCoarseMesh(const char mesh_file[], const char GaussOrder[], const double Lref)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00389">MultiLevelMesh.cpp:389</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parameter_html"><div class="ttname"><a href="../../d7/d3c/classfemus_1_1_parameter.html">femus::Parameter</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/d1d/_parameter_8hpp_source.html#l00028">Parameter.hpp:28</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a42a5b5b5d2c7673b1d4c896762d8db9e"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">femus::System::SetAssembleFunction</a></div><div class="ttdeci">void SetAssembleFunction(AssembleFunctionType)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00058">System.cpp:58</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a606e07526d7a0d31eed638404ee2ed24"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">femus::System::AddSolutionToSystemPDE</a></div><div class="ttdeci">virtual void AddSolutionToSystemPDE(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00075">System.cpp:75</a></div></div>
<div class="ttc" id="aclassfemus_1_1_v_t_k_writer_html"><div class="ttname"><a href="../../d4/d8d/classfemus_1_1_v_t_k_writer.html">femus::VTKWriter</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/df7/_v_t_k_writer_8hpp_source.html#l00046">VTKWriter.hpp:46</a></div></div>
<div class="ttc" id="aex20_8cpp_html_a35ee06182a68a7e4ddf45e3b888e60c1"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#a35ee06182a68a7e4ddf45e3b888e60c1">show_usage</a></div><div class="ttdeci">static void show_usage()</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00061">ex20.cpp:61</a></div></div>
<div class="ttc" id="aex20_8cpp_html_a53f85b2fbf5b17ef7f7ee4251fc33cb7"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#a53f85b2fbf5b17ef7f7ee4251fc33cb7">readInputTestFile</a></div><div class="ttdeci">static std::string readInputTestFile(const char *path)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00039">ex20.cpp:39</a></div></div>
<div class="ttc" id="aex20_8cpp_html_a8bcc082bbb8f18ce8b4479f0359ffdaf"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#a8bcc082bbb8f18ce8b4479f0359ffdaf">GetRelativeError</a></div><div class="ttdeci">double GetRelativeError(MultiLevelSolution &amp;ml_sol, const bool &amp;H1)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00722">ex20.cpp:722</a></div></div>
<div class="ttc" id="aex20_8cpp_html_ab8b0d45993b678f2b4a8aea9fff7fc87"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00032">ex20.cpp:32</a></div></div>
<div class="ttc" id="aex20_8cpp_html_ad336ac0f14496ce33e2cbb8257db5fd5"><div class="ttname"><a href="../../dc/d06/ex20_8cpp.html#ad336ac0f14496ce33e2cbb8257db5fd5">AssemblePoissonMatrixandRhs</a></div><div class="ttdeci">void AssemblePoissonMatrixandRhs(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d06/ex20_8cpp_source.html#l00477">ex20.cpp:477</a></div></div>
<div class="ttc" id="anamespacebuild__edges__of__volumes_html_a8b9aa5b5b104ffacbc115e9ba3c22e6a"><div class="ttname"><a href="../../da/da1/namespacebuild__edges__of__volumes.html#a8b9aa5b5b104ffacbc115e9ba3c22e6a">build_edges_of_volumes.filename</a></div><div class="ttdeci">filename</div><div class="ttdef"><b>Definition</b> <a href="../../d2/dce/build__edges__of__volumes_8py_source.html#l00009">build_edges_of_volumes.py:9</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53f85b2fbf5b17ef7f7ee4251fc33cb7" name="a53f85b2fbf5b17ef7f7ee4251fc33cb7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53f85b2fbf5b17ef7f7ee4251fc33cb7">&#9670;&#160;</a></span>readInputTestFile()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static std::string readInputTestFile </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>path</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00039">39</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   40</span>{</div>
<div class="line"><span class="lineno">   41</span>  FILE* file = fopen(path, <span class="stringliteral">&quot;rb&quot;</span>);</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  <span class="keywordflow">if</span> (!file)</div>
<div class="line"><span class="lineno">   44</span>    <span class="keywordflow">return</span> std::string(<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">   45</span> </div>
<div class="line"><span class="lineno">   46</span>  <a class="code hl_function" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ae4e22f7b1f40e78b6f0dfbfc5ed0b9e1">fseek</a>(file, 0, SEEK_END);</div>
<div class="line"><span class="lineno">   47</span>  <span class="keywordtype">long</span> size = ftell(file);</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_function" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ae4e22f7b1f40e78b6f0dfbfc5ed0b9e1">fseek</a>(file, 0, SEEK_SET);</div>
<div class="line"><span class="lineno">   49</span>  std::string text;</div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordtype">char</span>* buffer = <span class="keyword">new</span> <span class="keywordtype">char</span>[size + 1000];</div>
<div class="line"><span class="lineno">   51</span>  buffer[size] = 0;</div>
<div class="line"><span class="lineno">   52</span> </div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordflow">if</span> (fread(buffer, 1, size, file) == (<span class="keywordtype">unsigned</span> <span class="keywordtype">long</span>)size)</div>
<div class="line"><span class="lineno">   54</span>    text = buffer;</div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_function" href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a0e99dd9c87ae1b1476436790ad6e88b7">fclose</a>(file);</div>
<div class="line"><span class="lineno">   57</span>  <span class="keyword">delete</span>[] buffer;</div>
<div class="line"><span class="lineno">   58</span>  <span class="keywordflow">return</span> text;</div>
<div class="line"><span class="lineno">   59</span>}</div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_a0e99dd9c87ae1b1476436790ad6e88b7"><div class="ttname"><a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#a0e99dd9c87ae1b1476436790ad6e88b7">fclose</a></div><div class="ttdeci">% number of lines fclose(fid)</div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ae4e22f7b1f40e78b6f0dfbfc5ed0b9e1"><div class="ttname"><a href="../../d6/d46/_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ae4e22f7b1f40e78b6f0dfbfc5ed0b9e1">fseek</a></div><div class="ttdeci">fseek(fid, 0, 'eof')</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8b0d45993b678f2b4a8aea9fff7fc87" name="ab8b0d45993b678f2b4a8aea9fff7fc87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b0d45993b678f2b4a8aea9fff7fc87">&#9670;&#160;</a></span>SetBoundaryCondition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryCondition </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>SolName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00032">32</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   32</span>                                                                                                                                     {</div>
<div class="line"><span class="lineno">   33</span>  <span class="keywordtype">bool</span> dirichlet = <span class="keyword">true</span>; <span class="comment">//dirichlet</span></div>
<div class="line"><span class="lineno">   34</span>  <a class="code hl_function" href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">value</a> = 0.;</div>
<div class="line"><span class="lineno">   35</span>  <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><span class="lineno">   36</span>}</div>
<div class="ttc" id="anamespacesegment_1_1function__0_html_a1907e04e881c10f3ef9cc3dac6dde30b"><div class="ttname"><a href="../../d0/d45/namespacesegment_1_1function__0.html#a1907e04e881c10f3ef9cc3dac6dde30b">segment::function_0::value</a></div><div class="ttdeci">double value(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dfe/ex02__poisson__a__all__dims__dir__neu_8cpp_source.html#l00035">ex02_poisson_a_all_dims_dir_neu.cpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a35ee06182a68a7e4ddf45e3b888e60c1" name="a35ee06182a68a7e4ddf45e3b888e60c1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a35ee06182a68a7e4ddf45e3b888e60c1">&#9670;&#160;</a></span>show_usage()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void show_usage </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00061">61</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>{</div>
<div class="line"><span class="lineno">   63</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Use --inputfile variable to set the input file&quot;</span> &lt;&lt; endl;</div>
<div class="line"><span class="lineno">   64</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;e.g.: ./AMR_ex20 --inputfile ./input/input.json&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">   65</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="ad5653b0e7373558c99c8b385b10db24c" name="ad5653b0e7373558c99c8b385b10db24c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad5653b0e7373558c99c8b385b10db24c">&#9670;&#160;</a></span>fp_dsoldx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a> fp_dsoldx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00069">69</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>

</div>
</div>
<a id="a7716ad279ddb09ed64dec90671bc9ddb" name="a7716ad279ddb09ed64dec90671bc9ddb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7716ad279ddb09ed64dec90671bc9ddb">&#9670;&#160;</a></span>fp_dsoldy</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a> fp_dsoldy</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00070">70</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>

</div>
</div>
<a id="aa8d9c5fa63eeb198991d1abf849efb46" name="aa8d9c5fa63eeb198991d1abf849efb46"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa8d9c5fa63eeb198991d1abf849efb46">&#9670;&#160;</a></span>fp_sol</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a> fp_sol</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00068">68</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>

</div>
</div>
<a id="a8b9f315bff384189fd2f344bf4a9c401" name="a8b9f315bff384189fd2f344bf4a9c401"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8b9f315bff384189fd2f344bf4a9c401">&#9670;&#160;</a></span>fpsource</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d8/de4/classfemus_1_1_parsed_function.html">ParsedFunction</a> fpsource</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dc/d06/ex20_8cpp_source.html#l00067">67</a> of file <a class="el" href="../../dc/d06/ex20_8cpp_source.html">ex20.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_4e99f7d71c888191530a842db0941bc3.html">AMR</a></li><li class="navelem"><a class="el" href="../../dir_9a98eac7a4e1dd937821f218887c5933.html">ex20</a></li><li class="navelem"><a class="el" href="../../dc/d06/ex20_8cpp.html">ex20.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
