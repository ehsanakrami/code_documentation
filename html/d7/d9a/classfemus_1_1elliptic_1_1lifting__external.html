<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: femus::elliptic::lifting_external Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="../../d9/db2/classfemus_1_1elliptic_1_1lifting__external-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">femus::elliptic::lifting_external Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for femus::elliptic::lifting_external:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.png" usemap="#femus::elliptic::lifting_5Fexternal_map" alt=""/>
  <map id="femus::elliptic::lifting_5Fexternal_map" name="femus::elliptic::lifting_5Fexternal_map">
<area href="../../de/da3/classfemus_1_1lifting__external.html" alt="femus::lifting_external" shape="rect" coords="0,0,175,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:af0a9ccb75bf6f983cdb5f8573000a33c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">compute_coordinates_bdry_one_face</a> (std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_at_dofs_bdry, const int solType_coords, const unsigned int iel, const int jface, const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *msh)</td></tr>
<tr class="separator:af0a9ccb75bf6f983cdb5f8573000a33c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86be6466c20a785bfa63545d1536fae9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a86be6466c20a785bfa63545d1536fae9">find_control_boundary_nodes</a> (std::vector&lt; unsigned int &gt; &amp;interface_node_flag, const std::vector&lt; double &gt; &amp;elem_center_bdry, const unsigned int nDofu_bdry, const unsigned int iel, const int jface, const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *msh)</td></tr>
<tr class="separator:a86be6466c20a785bfa63545d1536fae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52708ef8c522b82aaac9daececb660d7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a52708ef8c522b82aaac9daececb660d7">assemble_elliptic_dirichlet_control</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:a52708ef8c522b82aaac9daececb660d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-static-attribs" name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a3a29ef8490dc93fc0f45f5376e323a61"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> = 1</td></tr>
<tr class="separator:a3a29ef8490dc93fc0f45f5376e323a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad347558b2dc39abe98d8ff7ced798a3c"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">_neumann_adjoint_continuity_sign</a> = -1</td></tr>
<tr class="separator:ad347558b2dc39abe98d8ff7ced798a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65401ffd4bdad0456d123751e028576a"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> = 1</td></tr>
<tr class="separator:a65401ffd4bdad0456d123751e028576a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01923">1923</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a52708ef8c522b82aaac9daececb660d7" name="a52708ef8c522b82aaac9daececb660d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52708ef8c522b82aaac9daececb660d7">&#9670;&#160;</a></span>assemble_elliptic_dirichlet_control()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void femus::elliptic::lifting_external::assemble_elliptic_dirichlet_control </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000056">Todo:</a></b></dt><dd>these are the positions in the MlSol object or in the Matrix? I'd say the matrix, but we have to check where we use it... </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000057">Todo:</a></b></dt><dd>maybe it should be geometry-based </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000058">Todo:</a></b></dt><dd>check this term in control equation </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000059">Todo:</a></b></dt><dd>check this term in control equation </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01992">1992</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1992</span>                                                                            {</div>
<div class="line"><span class="lineno"> 1993</span>    <span class="comment">//  ml_prob is the global object from/to where get/set all the data</span></div>
<div class="line"><span class="lineno"> 1994</span> </div>
<div class="line"><span class="lineno"> 1995</span>    <span class="comment">//  level is the level of the PDE system to be assembled</span></div>
<div class="line"><span class="lineno"> 1996</span>    <span class="comment">//  levelMax is the Maximum level of the MultiLevelProblem</span></div>
<div class="line"><span class="lineno"> 1997</span>    <span class="comment">//  assembleMatrix is a flag that tells if only the residual or also the matrix should be assembled</span></div>
<div class="line"><span class="lineno"> 1998</span> </div>
<div class="line"><span class="lineno"> 1999</span>    <span class="comment">//  extract pointers to the several objects that we are going to use</span></div>
<div class="line"><span class="lineno"> 2000</span> </div>
<div class="line"><span class="lineno"> 2001</span>    NonLinearImplicitSystemWithPrimalDualActiveSetMethod* mlPdeSys  = &amp;ml_prob.get_system&lt;NonLinearImplicitSystemWithPrimalDualActiveSetMethod&gt; (<span class="stringliteral">&quot;LiftRestr&quot;</span>);   <span class="comment">// pointer to the linear implicit system named &quot;LiftRestr&quot;</span></div>
<div class="line"><span class="lineno"> 2002</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><span class="lineno"> 2003</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> assembleMatrix = mlPdeSys-&gt;GetAssembleMatrix();</div>
<div class="line"><span class="lineno"> 2004</span> </div>
<div class="line"><span class="lineno"> 2005</span>    Mesh*                    msh = ml_prob._ml_msh-&gt;GetLevel(level);</div>
<div class="line"><span class="lineno"> 2006</span> </div>
<div class="line"><span class="lineno"> 2007</span>    MultiLevelSolution*    ml_sol = ml_prob._ml_sol;</div>
<div class="line"><span class="lineno"> 2008</span>    Solution*                sol = ml_prob._ml_sol-&gt;GetSolutionLevel(level);</div>
<div class="line"><span class="lineno"> 2009</span> </div>
<div class="line"><span class="lineno"> 2010</span>    LinearEquationSolver* pdeSys = mlPdeSys-&gt;_LinSolver[level];</div>
<div class="line"><span class="lineno"> 2011</span>    SparseMatrix*             JAC = pdeSys-&gt;_KK;</div>
<div class="line"><span class="lineno"> 2012</span>    NumericVector*           RES = pdeSys-&gt;_RES;</div>
<div class="line"><span class="lineno"> 2013</span> </div>
<div class="line"><span class="lineno"> 2014</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;GetDimension();</div>
<div class="line"><span class="lineno"> 2015</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));</div>
<div class="line"><span class="lineno"> 2016</span> </div>
<div class="line"><span class="lineno"> 2017</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>    iproc = msh-&gt;processor_id();</div>
<div class="line"><span class="lineno"> 2018</span>  </div>
<div class="line"><span class="lineno"> 2019</span>    </div>
<div class="line"><span class="lineno"> 2020</span>    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> print_algebra_global = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 2021</span>    <span class="keyword">constexpr</span> <span class="keywordtype">bool</span> print_algebra_local = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2022</span>  </div>
<div class="line"><span class="lineno"> 2023</span> </div>
<div class="line"><span class="lineno"> 2024</span> </div>
<div class="line"><span class="lineno"> 2025</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2026</span>  CurrentElem &lt; double &gt; geom_element_iel(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, msh); </div>
<div class="line"><span class="lineno"> 2027</span>  </div>
<div class="line"><span class="lineno"> 2028</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> solType_coords = <a class="code hl_enumvalue" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a>;  <span class="comment">//biquadratic</span></div>
<div class="line"><span class="lineno"> 2029</span> </div>
<div class="line"><span class="lineno"> 2030</span><span class="comment">//************** geometry (at dofs) *************************************</span></div>
<div class="line"><span class="lineno"> 2031</span>    std::vector &lt; std::vector &lt; double &gt; &gt; coords_at_dofs(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2032</span>    std::vector &lt; std::vector &lt; double &gt; &gt; coords_at_dofs_bdry(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2033</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno"> 2034</span>        coords_at_dofs[idim].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2035</span>        coords_at_dofs_bdry[idim].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2036</span>    }</div>
<div class="line"><span class="lineno"> 2037</span> </div>
<div class="line"><span class="lineno"> 2038</span><span class="comment">//************** geometry (at quadrature points) *************************************</span></div>
<div class="line"><span class="lineno"> 2039</span>    std::vector &lt; double &gt; coord_at_qp(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2040</span> </div>
<div class="line"><span class="lineno"> 2041</span> </div>
<div class="line"><span class="lineno"> 2042</span><span class="comment">//************* shape functions (at dofs and quadrature points) **************************************</span></div>
<div class="line"><span class="lineno"> 2043</span>    <span class="keywordtype">double</span> weight_qp = 0.;      <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno"> 2044</span>    <span class="keywordtype">double</span> weight_qp_bdry = 0.; <span class="comment">// gauss point weight on the boundary</span></div>
<div class="line"><span class="lineno"> 2045</span> </div>
<div class="line"><span class="lineno"> 2046</span>    std::vector &lt; std::vector &lt; double &gt; &gt; phi_fe_qp(<a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno"> 2047</span>    std::vector &lt; std::vector &lt; double &gt; &gt; phi_x_fe_qp(<a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno"> 2048</span>    std::vector &lt; std::vector &lt; double &gt; &gt; phi_xx_fe_qp(<a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno"> 2049</span> </div>
<div class="line"><span class="lineno"> 2050</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><span class="lineno"> 2051</span>        phi_fe_qp[fe].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2052</span>        phi_x_fe_qp[fe].reserve(max_size*<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2053</span>        phi_xx_fe_qp[fe].reserve(max_size*(3*(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>-1)));</div>
<div class="line"><span class="lineno"> 2054</span>    }</div>
<div class="line"><span class="lineno"> 2055</span> </div>
<div class="line"><span class="lineno"> 2056</span><span class="comment">//************* bdry shape functions (at dofs and quadrature points) **************************************</span></div>
<div class="line"><span class="lineno"> 2057</span>    std::vector &lt; std::vector &lt; double &gt; &gt; phi_fe_qp_bdry(<a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno"> 2058</span>    std::vector &lt; std::vector &lt; double &gt; &gt; phi_x_fe_qp_bdry(<a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno"> 2059</span> </div>
<div class="line"><span class="lineno"> 2060</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><span class="lineno"> 2061</span>        phi_fe_qp_bdry[fe].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2062</span>        phi_x_fe_qp_bdry[fe].reserve(max_size * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2063</span>    }</div>
<div class="line"><span class="lineno"> 2064</span> </div>
<div class="line"><span class="lineno"> 2065</span><span class="comment">//********************* vol-at-bdry adjoint *******************</span></div>
<div class="line"><span class="lineno"> 2066</span>    std::vector &lt;double&gt; phi_adj_vol_at_bdry;</div>
<div class="line"><span class="lineno"> 2067</span>    phi_adj_vol_at_bdry.reserve(max_size);</div>
<div class="line"><span class="lineno"> 2068</span>    std::vector &lt;double&gt; phi_adj_x_vol_at_bdry;</div>
<div class="line"><span class="lineno"> 2069</span>    phi_adj_x_vol_at_bdry.reserve(max_size * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2070</span>    std::vector &lt;double&gt; sol_adj_x_vol_at_bdry_gss(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2071</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2072</span>    </div>
<div class="line"><span class="lineno"> 2073</span><span class="comment">//********************* vol-at-bdry adjoint_ext *******************</span></div>
<div class="line"><span class="lineno"> 2074</span>    std::vector &lt;double&gt; phi_adj_ext_vol_at_bdry;</div>
<div class="line"><span class="lineno"> 2075</span>    phi_adj_ext_vol_at_bdry.reserve(max_size);</div>
<div class="line"><span class="lineno"> 2076</span>    std::vector &lt;double&gt; phi_adj_ext_x_vol_at_bdry;</div>
<div class="line"><span class="lineno"> 2077</span>    phi_adj_ext_x_vol_at_bdry.reserve(max_size * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2078</span>    std::vector &lt;double&gt; sol_adj_ext_x_vol_at_bdry_gss(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2079</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2080</span> </div>
<div class="line"><span class="lineno"> 2081</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_components_ctrl = 1;</div>
<div class="line"><span class="lineno"> 2082</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> first_loc_comp_ctrl = 0;</div>
<div class="line"><span class="lineno"> 2083</span> </div>
<div class="line"><span class="lineno"> 2084</span>  <span class="comment">//************** act flag ****************************   </span></div>
<div class="line"><span class="lineno"> 2085</span>    std::vector &lt;unsigned int&gt; solIndex_act_flag_sol(n_components_ctrl);</div>
<div class="line"><span class="lineno"> 2086</span> </div>
<div class="line"><span class="lineno"> 2087</span>  <a class="code hl_function" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#ad8765c4d3fe1216148aa932896951aee">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::store_act_flag_in_old</a>(mlPdeSys, ml_sol, sol, solIndex_act_flag_sol);</div>
<div class="line"><span class="lineno"> 2088</span>    </div>
<div class="line"><span class="lineno"> 2089</span> </div>
<div class="line"><span class="lineno"> 2090</span> </div>
<div class="line"><span class="lineno"> 2091</span>    <span class="comment">//********* variables for ineq constraints *****************</span></div>
<div class="line"><span class="lineno"> 2092</span>     std::vector &lt;std::vector &lt; <span class="keywordtype">double</span><span class="comment">/*int*/</span> &gt; &gt; sol_actflag(n_components_ctrl);    <span class="comment">//flag for active set</span></div>
<div class="line"><span class="lineno"> 2093</span>     std::vector &lt;std::vector &lt; double &gt; &gt; ctrl_lower(n_components_ctrl);  </div>
<div class="line"><span class="lineno"> 2094</span>     std::vector &lt;std::vector &lt; double &gt; &gt; ctrl_upper(n_components_ctrl);  </div>
<div class="line"><span class="lineno"> 2095</span>  </div>
<div class="line"><span class="lineno"> 2096</span>     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; n_components_ctrl; kdim++) {</div>
<div class="line"><span class="lineno"> 2097</span>          sol_actflag[kdim].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2098</span>           ctrl_lower[kdim].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2099</span>           ctrl_upper[kdim].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2100</span>     }</div>
<div class="line"><span class="lineno"> 2101</span>     </div>
<div class="line"><span class="lineno"> 2102</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> ineq_flag = <a class="code hl_define" href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a4b681eb6859b04812f86861be922c517">INEQ_FLAG</a>;</div>
<div class="line"><span class="lineno"> 2103</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> c_compl = <a class="code hl_define" href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a90aa72cdc79d3af2036fdbb588d8c1d8">C_COMPL</a>;</div>
<div class="line"><span class="lineno"> 2104</span>    <span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2105</span> </div>
<div class="line"><span class="lineno"> 2106</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2107</span><span class="comment">//********* WHOLE SET OF VARIABLES ******************</span></div>
<div class="line"><span class="lineno"> 2108</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2109</span>    <span class="keyword">enum</span> Pos_in_matrix {pos_mat_state = 0, pos_mat_ctrl, pos_mat_adj, pos_mat_adj_ext, pos_mat_mu}; <span class="comment">//these are known at compile-time </span></div>
<div class="line"><span class="lineno"> 2111</span><span class="comment"></span> </div>
<div class="line"><span class="lineno"> 2112</span>                    </div>
<div class="line"><span class="lineno"> 2113</span>    assert(pos_mat_state   == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;state&quot;</span>));</div>
<div class="line"><span class="lineno"> 2114</span>    assert(pos_mat_ctrl    == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;control&quot;</span>));</div>
<div class="line"><span class="lineno"> 2115</span>    assert(pos_mat_adj     == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint&quot;</span>));</div>
<div class="line"><span class="lineno"> 2116</span>    assert(pos_mat_adj_ext == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint_ext&quot;</span>));</div>
<div class="line"><span class="lineno"> 2117</span>    assert(pos_mat_mu      == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;mu&quot;</span>));</div>
<div class="line"><span class="lineno"> 2118</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2119</span> </div>
<div class="line"><span class="lineno"> 2120</span> </div>
<div class="line"><span class="lineno"> 2121</span> std::vector &lt; unsigned &gt;   pos_ctrl_in_mat(n_components_ctrl);  pos_ctrl_in_mat[0] = pos_mat_ctrl;</div>
<div class="line"><span class="lineno"> 2122</span> std::vector &lt; unsigned &gt;   pos_mu_in_mat(n_components_ctrl);    pos_mu_in_mat[0] = pos_mat_mu;</div>
<div class="line"><span class="lineno"> 2123</span>    </div>
<div class="line"><span class="lineno"> 2124</span>    </div>
<div class="line"><span class="lineno"> 2125</span>    </div>
<div class="line"><span class="lineno"> 2126</span>    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><span class="lineno"> 2127</span> </div>
<div class="line"><span class="lineno"> 2128</span>    <span class="keyword">enum</span> Sol_pos {pos_state=0, pos_ctrl, pos_adj, pos_adj_ext, pos_mu}; <span class="comment">//these are known at compile-time</span></div>
<div class="line"><span class="lineno"> 2129</span> </div>
<div class="line"><span class="lineno"> 2130</span>    assert(pos_state   == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;state&quot;</span>));</div>
<div class="line"><span class="lineno"> 2131</span>    assert(pos_ctrl    == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;control&quot;</span>));</div>
<div class="line"><span class="lineno"> 2132</span>    assert(pos_adj     == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint&quot;</span>));</div>
<div class="line"><span class="lineno"> 2133</span>    assert(pos_adj_ext == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint_ext&quot;</span>));</div>
<div class="line"><span class="lineno"> 2134</span>    assert(pos_mu      == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;mu&quot;</span>));</div>
<div class="line"><span class="lineno"> 2135</span> </div>
<div class="line"><span class="lineno"> 2136</span> </div>
<div class="line"><span class="lineno"> 2137</span>    std::vector &lt; std::string &gt; Solname(n_unknowns);</div>
<div class="line"><span class="lineno"> 2138</span>    Solname[0] = <span class="stringliteral">&quot;state&quot;</span>;</div>
<div class="line"><span class="lineno"> 2139</span>    Solname[1] = <span class="stringliteral">&quot;control&quot;</span>;</div>
<div class="line"><span class="lineno"> 2140</span>    Solname[2] = <span class="stringliteral">&quot;adjoint&quot;</span>;</div>
<div class="line"><span class="lineno"> 2141</span>    Solname[3] = <span class="stringliteral">&quot;adjoint_ext&quot;</span>;</div>
<div class="line"><span class="lineno"> 2142</span>    Solname[4] = <span class="stringliteral">&quot;mu&quot;</span>;</div>
<div class="line"><span class="lineno"> 2143</span> </div>
<div class="line"><span class="lineno"> 2144</span>    std::vector &lt; unsigned &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><span class="lineno"> 2145</span>    std::vector &lt; unsigned &gt; SolIndex(n_unknowns);</div>
<div class="line"><span class="lineno"> 2146</span>    std::vector &lt; unsigned &gt; SolFEType(n_unknowns);</div>
<div class="line"><span class="lineno"> 2147</span> </div>
<div class="line"><span class="lineno"> 2148</span> </div>
<div class="line"><span class="lineno"> 2149</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno"> 2150</span>        SolPdeIndex[ivar] = mlPdeSys-&gt;GetSolPdeIndex(Solname[ivar].c_str());</div>
<div class="line"><span class="lineno"> 2151</span>        SolIndex[ivar]    = ml_sol-&gt;GetIndex        (Solname[ivar].c_str());</div>
<div class="line"><span class="lineno"> 2152</span>        SolFEType[ivar]   = ml_sol-&gt;GetSolutionType(SolIndex[ivar]);</div>
<div class="line"><span class="lineno"> 2153</span>    }</div>
<div class="line"><span class="lineno"> 2154</span> </div>
<div class="line"><span class="lineno"> 2155</span>    std::vector &lt; unsigned int &gt; Sol_n_el_dofs_Mat_vol(n_unknowns);</div>
<div class="line"><span class="lineno"> 2156</span> </div>
<div class="line"><span class="lineno"> 2157</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2158</span>    <span class="comment">//----------- quantities (at dof objects) ------------------------------</span></div>
<div class="line"><span class="lineno"> 2159</span>    std::vector &lt; int &gt;       L2G_dofmap_Mat_AllVars;</div>
<div class="line"><span class="lineno"> 2160</span>    L2G_dofmap_Mat_AllVars.reserve( n_unknowns * max_size );</div>
<div class="line"><span class="lineno"> 2161</span>    std::vector &lt; std::vector &lt; int &gt; &gt;     L2G_dofmap_Mat(n_unknowns);</div>
<div class="line"><span class="lineno"> 2162</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) {</div>
<div class="line"><span class="lineno"> 2163</span>        L2G_dofmap_Mat[i].reserve(max_size);</div>
<div class="line"><span class="lineno"> 2164</span>    }</div>
<div class="line"><span class="lineno"> 2165</span>    </div>
<div class="line"><span class="lineno"> 2166</span>    std::vector &lt; std::vector &lt; double &gt; &gt;  sol_eldofs_Mat(n_unknowns);</div>
<div class="line"><span class="lineno"> 2167</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) {        sol_eldofs_Mat[k].reserve(max_size);    }</div>
<div class="line"><span class="lineno"> 2168</span>    </div>
<div class="line"><span class="lineno"> 2169</span>    std::vector &lt; double &gt; Res;</div>
<div class="line"><span class="lineno"> 2170</span>    Res.reserve( n_unknowns * max_size);</div>
<div class="line"><span class="lineno"> 2171</span>    std::vector &lt; double &gt; Jac;</div>
<div class="line"><span class="lineno"> 2172</span>    Jac.reserve( n_unknowns * max_size * n_unknowns * max_size);</div>
<div class="line"><span class="lineno"> 2173</span> </div>
<div class="line"><span class="lineno"> 2174</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2175</span>    <span class="comment">//------------ quantities (at quadrature points) ---------------------</span></div>
<div class="line"><span class="lineno"> 2176</span>    std::vector &lt;double&gt;        sol_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 2177</span>    std::vector &lt; std::vector &lt;double&gt; &gt; sol_grad_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 2178</span> </div>
<div class="line"><span class="lineno"> 2179</span>    std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><span class="lineno"> 2180</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno"> 2181</span>        sol_grad_qp[k].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2182</span>        std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno"> 2183</span>    }</div>
<div class="line"><span class="lineno"> 2184</span> </div>
<div class="line"><span class="lineno"> 2185</span> </div>
<div class="line"><span class="lineno"> 2186</span><span class="comment">//********************* DATA ************************</span></div>
<div class="line"><span class="lineno"> 2187</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> u_des = ctrl::square_or_cube :: cost_functional_without_regularization::DesiredTargetVec()[0];</div>
<div class="line"><span class="lineno"> 2188</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a> = <a class="code hl_define" href="../../dc/d47/elliptic__nonlin__param_8hpp.html#ab6042dc7aa551272ad555cac7a27efca">ALPHA_CTRL_VOL</a>;</div>
<div class="line"><span class="lineno"> 2189</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a>  = <a class="code hl_define" href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a516ea8ebb0823e8c37feff8f4fe5afd1">BETA_CTRL_VOL</a>;</div>
<div class="line"><span class="lineno"> 2190</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty_strong_ctrl = 1.e30;</div>
<div class="line"><span class="lineno"> 2191</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty_strong_u =    1.e30;</div>
<div class="line"><span class="lineno"> 2192</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty_interface = 1.e10;         <span class="comment">//penalty for u = q and for weak continuity of adjoint Neumann</span></div>
<div class="line"><span class="lineno"> 2193</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2194</span> </div>
<div class="line"><span class="lineno"> 2195</span>    RES-&gt;zero();</div>
<div class="line"><span class="lineno"> 2196</span>    <span class="keywordflow">if</span> (assembleMatrix)  JAC-&gt;zero();</div>
<div class="line"><span class="lineno"> 2197</span> </div>
<div class="line"><span class="lineno"> 2198</span> </div>
<div class="line"><span class="lineno"> 2199</span>    <span class="comment">// element loop: each process loops only on the elements that owns</span></div>
<div class="line"><span class="lineno"> 2200</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno"> 2201</span> </div>
<div class="line"><span class="lineno"> 2202</span>    geom_element_iel.set_coords_at_dofs_and_geom_type(iel, solType_coords);</div>
<div class="line"><span class="lineno"> 2203</span>        </div>
<div class="line"><span class="lineno"> 2204</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = geom_element_iel.geom_type();</div>
<div class="line"><span class="lineno"> 2205</span> </div>
<div class="line"><span class="lineno"> 2206</span>    <span class="keywordtype">int</span> group_flag         = msh-&gt;GetElementGroup(iel);</div>
<div class="line"><span class="lineno"> 2207</span><span class="comment">//    std::cout &lt;&lt; &quot; ======= grp_flag === &quot; &lt;&lt; group_flag &lt;&lt; &quot; ================== &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 2208</span><span class="comment">//     int face_no         = msh-&gt;GetElementFaceNumber(iel);</span></div>
<div class="line"><span class="lineno"> 2209</span><span class="comment">//     std::cout &lt;&lt; &quot; ======= face# === &quot; &lt;&lt; face_no &lt;&lt; &quot; ================== &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno"> 2210</span> </div>
<div class="line"><span class="lineno"> 2211</span><span class="comment">//******************** GEOMETRY *********************</span></div>
<div class="line"><span class="lineno"> 2212</span>        <span class="keywordtype">unsigned</span> nDofx = msh-&gt;GetElementDofNumber(iel, solType_coords);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno"> 2213</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++)  coords_at_dofs[i].resize(nDofx);</div>
<div class="line"><span class="lineno"> 2214</span>        <span class="comment">// local storage of coordinates</span></div>
<div class="line"><span class="lineno"> 2215</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx; i++) {</div>
<div class="line"><span class="lineno"> 2216</span>            <span class="keywordtype">unsigned</span> xDof  = msh-&gt;GetSolutionDof(i, iel, solType_coords);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno"> 2217</span> </div>
<div class="line"><span class="lineno"> 2218</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno"> 2219</span>                coords_at_dofs[jdim][i] = (*msh-&gt;GetTopology()-&gt;_Sol[jdim])(xDof);      <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno"> 2220</span>            }</div>
<div class="line"><span class="lineno"> 2221</span>        }</div>
<div class="line"><span class="lineno"> 2222</span> </div>
<div class="line"><span class="lineno"> 2223</span>        <span class="comment">// elem average point</span></div>
<div class="line"><span class="lineno"> 2224</span>        std::vector &lt; double &gt; elem_center(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 2225</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 2226</span>            elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0.;</div>
<div class="line"><span class="lineno"> 2227</span>        }</div>
<div class="line"><span class="lineno"> 2228</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 2229</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx; i++) {</div>
<div class="line"><span class="lineno"> 2230</span>                elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += coords_at_dofs[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i];</div>
<div class="line"><span class="lineno"> 2231</span>            }</div>
<div class="line"><span class="lineno"> 2232</span>        }</div>
<div class="line"><span class="lineno"> 2233</span> </div>
<div class="line"><span class="lineno"> 2234</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 2235</span>            elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]/nDofx;</div>
<div class="line"><span class="lineno"> 2236</span>        }</div>
<div class="line"><span class="lineno"> 2237</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2238</span> </div>
<div class="line"><span class="lineno"> 2239</span><span class="comment">//****** set target domain flag *********************</span></div>
<div class="line"><span class="lineno"> 2240</span>        <span class="keywordtype">int</span> target_flag = 0;</div>
<div class="line"><span class="lineno"> 2241</span>        target_flag = ctrl::square_or_cube :: cost_functional_without_regularization::ElementTargetFlag(elem_center);</div>
<div class="line"><span class="lineno"> 2242</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2243</span> </div>
<div class="line"><span class="lineno"> 2244</span>        <span class="comment">//all vars###################################################################</span></div>
<div class="line"><span class="lineno"> 2245</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno"> 2246</span>            <span class="keywordtype">unsigned</span>  ndofs_unk = msh-&gt;GetElementDofNumber(iel, SolFEType[k]);</div>
<div class="line"><span class="lineno"> 2247</span>            Sol_n_el_dofs_Mat_vol[k] = ndofs_unk;</div>
<div class="line"><span class="lineno"> 2248</span>            sol_eldofs_Mat[k].resize(ndofs_unk);</div>
<div class="line"><span class="lineno"> 2249</span>            L2G_dofmap_Mat[k].resize(ndofs_unk);</div>
<div class="line"><span class="lineno"> 2250</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ndofs_unk; i++) {</div>
<div class="line"><span class="lineno"> 2251</span>                <span class="keywordtype">unsigned</span> solDof = msh-&gt;GetSolutionDof(i, iel, SolFEType[k]);                        <span class="comment">// global to global mapping between solution node and solution dof // via local to global solution node</span></div>
<div class="line"><span class="lineno"> 2252</span>                sol_eldofs_Mat[k][i] = (*sol-&gt;_Sol[SolIndex[k]])(solDof);                            <span class="comment">// global extraction and local storage for the solution</span></div>
<div class="line"><span class="lineno"> 2253</span>                L2G_dofmap_Mat[k][i] = pdeSys-&gt;GetSystemDof(SolIndex[k], SolPdeIndex[k], i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><span class="lineno"> 2254</span>            }</div>
<div class="line"><span class="lineno"> 2255</span>        }</div>
<div class="line"><span class="lineno"> 2256</span>        <span class="comment">//all vars###################################################################</span></div>
<div class="line"><span class="lineno"> 2257</span> </div>
<div class="line"><span class="lineno"> 2258</span>        <a class="code hl_function" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#a53fcde6a8cb427b5da69375d0fe7cd14">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::update_active_set_flag_for_current_nonlinear_iteration</a></div>
<div class="line"><span class="lineno"> 2259</span>         (msh, sol, iel, coords_at_dofs, sol_eldofs_Mat, Sol_n_el_dofs_Mat_vol, </div>
<div class="line"><span class="lineno"> 2260</span>          c_compl, </div>
<div class="line"><span class="lineno"> 2261</span>          pos_mu_in_mat,</div>
<div class="line"><span class="lineno"> 2262</span>          pos_ctrl_in_mat, </div>
<div class="line"><span class="lineno"> 2263</span>          solIndex_act_flag_sol,</div>
<div class="line"><span class="lineno"> 2264</span>          ctrl_lower,</div>
<div class="line"><span class="lineno"> 2265</span>          ctrl_upper, </div>
<div class="line"><span class="lineno"> 2266</span>          sol_actflag);</div>
<div class="line"><span class="lineno"> 2267</span> </div>
<div class="line"><span class="lineno"> 2268</span> </div>
<div class="line"><span class="lineno"> 2269</span><span class="comment">//******************** ALL VARS *********************</span></div>
<div class="line"><span class="lineno"> 2270</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nDof_max          = <a class="code hl_function" href="../../d3/dc6/classfemus_1_1_element_jac_res.html#adaae99208cf2f2f60e867d6409035f1d">ElementJacRes&lt;double&gt;::compute_max_n_dofs</a>(Sol_n_el_dofs_Mat_vol);</div>
<div class="line"><span class="lineno"> 2271</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sum_Sol_n_el_dofs = <a class="code hl_function" href="../../d3/dc6/classfemus_1_1_element_jac_res.html#af9f782d3aa6f1bcee95c7eb1af72b8ec">ElementJacRes&lt;double&gt;::compute_sum_n_dofs</a>(Sol_n_el_dofs_Mat_vol);</div>
<div class="line"><span class="lineno"> 2272</span>    </div>
<div class="line"><span class="lineno"> 2273</span>        </div>
<div class="line"><span class="lineno"> 2274</span>        Res.resize(sum_Sol_n_el_dofs);</div>
<div class="line"><span class="lineno"> 2275</span>        std::fill(Res.begin(), Res.end(), 0.);</div>
<div class="line"><span class="lineno"> 2276</span>        Jac.resize(sum_Sol_n_el_dofs * sum_Sol_n_el_dofs);</div>
<div class="line"><span class="lineno"> 2277</span>        std::fill(Jac.begin(), Jac.end(), 0.);</div>
<div class="line"><span class="lineno"> 2278</span> </div>
<div class="line"><span class="lineno"> 2279</span>        L2G_dofmap_Mat_AllVars.resize(0);</div>
<div class="line"><span class="lineno"> 2280</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++)     L2G_dofmap_Mat_AllVars.insert(L2G_dofmap_Mat_AllVars.end(),L2G_dofmap_Mat[k].begin(),L2G_dofmap_Mat[k].end());</div>
<div class="line"><span class="lineno"> 2281</span><span class="comment">//***************************************************</span></div>
<div class="line"><span class="lineno"> 2282</span> </div>
<div class="line"><span class="lineno"> 2283</span>        <span class="keyword">const</span> <span class="keywordtype">int</span> n_faces = msh-&gt;GetElementFaceNumber(iel);</div>
<div class="line"><span class="lineno"> 2284</span>        </div>
<div class="line"><span class="lineno"> 2285</span>        <span class="comment">//setting up control boundary region - BEGIN ***************************</span></div>
<div class="line"><span class="lineno"> 2286</span>        std::vector &lt;bool&gt; interface_elem_flag(n_faces);      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; n_faces; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) interface_elem_flag[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 2287</span>        std::vector &lt;unsigned int&gt; is_dof_on_Gamma_c(Sol_n_el_dofs_Mat_vol[pos_state]);   </div>
<div class="line"><span class="lineno"> 2288</span>        std::fill(is_dof_on_Gamma_c.begin(), is_dof_on_Gamma_c.end(), 0);</div>
<div class="line"><span class="lineno"> 2289</span> </div>
<div class="line"><span class="lineno"> 2290</span>     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface = 0; jface &lt; n_faces; jface++) {</div>
<div class="line"><span class="lineno"> 2291</span>            </div>
<div class="line"><span class="lineno"> 2292</span>       geom_element_iel.set_coords_at_dofs_bdry_3d(iel, jface, solType_coords);</div>
<div class="line"><span class="lineno"> 2293</span> </div>
<div class="line"><span class="lineno"> 2294</span>       geom_element_iel.set_elem_center_bdry_3d();</div>
<div class="line"><span class="lineno"> 2295</span> </div>
<div class="line"><span class="lineno"> 2296</span>       <span class="comment">//************** later try to avoid repeating this - BEGIN</span></div>
<div class="line"><span class="lineno"> 2297</span>          <a class="code hl_function" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">lifting_external::compute_coordinates_bdry_one_face</a>(coords_at_dofs_bdry, solType_coords, iel, jface, msh);</div>
<div class="line"><span class="lineno"> 2298</span>          </div>
<div class="line"><span class="lineno"> 2299</span>            <span class="keywordtype">unsigned</span> nDofu_bdry    = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_state]);</div>
<div class="line"><span class="lineno"> 2300</span>            <span class="keywordtype">unsigned</span> nDofctrl_bdry = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_ctrl]);</div>
<div class="line"><span class="lineno"> 2301</span>            <span class="keywordflow">if</span> (nDofu_bdry != nDofctrl_bdry) {</div>
<div class="line"><span class="lineno"> 2302</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;State and control need to have the same FE space&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2303</span>                abort();</div>
<div class="line"><span class="lineno"> 2304</span>            }</div>
<div class="line"><span class="lineno"> 2305</span>         <span class="comment">//************** later try to avoid repeating this - END</span></div>
<div class="line"><span class="lineno"> 2306</span>                    </div>
<div class="line"><span class="lineno"> 2307</span>           interface_elem_flag[jface] = <a class="code hl_function" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a86be6466c20a785bfa63545d1536fae9">lifting_external::find_control_boundary_nodes</a>(is_dof_on_Gamma_c, geom_element_iel.get_elem_center_bdry_3d(), nDofu_bdry, iel, jface, msh);</div>
<div class="line"><span class="lineno"> 2308</span>    </div>
<div class="line"><span class="lineno"> 2309</span>        }</div>
<div class="line"><span class="lineno"> 2310</span>       <span class="comment">//setting up control boundary region - END ***************************</span></div>
<div class="line"><span class="lineno"> 2311</span>       </div>
<div class="line"><span class="lineno"> 2312</span>        </div>
<div class="line"><span class="lineno"> 2313</span>        </div>
<div class="line"><span class="lineno"> 2314</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface=0; jface &lt; msh-&gt;GetElementFaceNumber(iel); jface++) {</div>
<div class="line"><span class="lineno"> 2315</span> </div>
<div class="line"><span class="lineno"> 2316</span> </div>
<div class="line"><span class="lineno"> 2317</span>            </div>
<div class="line"><span class="lineno"> 2318</span>     <a class="code hl_function" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">lifting_external::compute_coordinates_bdry_one_face</a>(coords_at_dofs_bdry, solType_coords, iel, jface, msh);</div>
<div class="line"><span class="lineno"> 2319</span> </div>
<div class="line"><span class="lineno"> 2320</span>            <span class="keywordtype">unsigned</span> nDofu_bdry    = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_state]);</div>
<div class="line"><span class="lineno"> 2321</span>            <span class="keywordtype">unsigned</span> nDofctrl_bdry = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_ctrl]);</div>
<div class="line"><span class="lineno"> 2322</span>            <span class="keywordflow">if</span> (nDofu_bdry != nDofctrl_bdry) {</div>
<div class="line"><span class="lineno"> 2323</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;State and control need to have the same FE space&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2324</span>                abort();</div>
<div class="line"><span class="lineno"> 2325</span>            }</div>
<div class="line"><span class="lineno"> 2326</span>            </div>
<div class="line"><span class="lineno"> 2327</span>    </div>
<div class="line"><span class="lineno"> 2328</span> </div>
<div class="line"><span class="lineno"> 2329</span>    <span class="keywordflow">if</span> (interface_elem_flag[jface] == <span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno"> 2330</span> </div>
<div class="line"><span class="lineno"> 2331</span>              std::vector&lt;double&gt; normal_qp(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno"> 2332</span>              </div>
<div class="line"><span class="lineno"> 2333</span>            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> felt_bdry = msh-&gt;GetElementFaceType(iel, jface);</div>
<div class="line"><span class="lineno"> 2334</span>              </div>
<div class="line"><span class="lineno"> 2335</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ig_bdry=0; ig_bdry &lt; msh-&gt;_finiteElement[felt_bdry][SolFEType[pos_ctrl]]-&gt;GetGaussPointNumber(); ig_bdry++) {</div>
<div class="line"><span class="lineno"> 2336</span> </div>
<div class="line"><span class="lineno"> 2337</span>                    <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno"> 2338</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><span class="lineno"> 2339</span>                        msh-&gt;_finiteElement[felt_bdry][fe]-&gt;JacobianSur(coords_at_dofs_bdry, ig_bdry, weight_qp_bdry, phi_fe_qp_bdry[fe], phi_x_fe_qp_bdry[fe], normal_qp);</div>
<div class="line"><span class="lineno"> 2340</span>                    }</div>
<div class="line"><span class="lineno"> 2341</span>                    <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN</span></div>
<div class="line"><span class="lineno"> 2342</span>                    msh-&gt;_finiteElement[felt_bdry][solType_coords]-&gt;JacobianSur(coords_at_dofs_bdry, ig_bdry, weight_qp_bdry, phi_fe_qp_bdry[solType_coords], phi_x_fe_qp_bdry[solType_coords], normal_qp);</div>
<div class="line"><span class="lineno"> 2343</span> </div>
<div class="line"><span class="lineno"> 2344</span>                    <span class="keywordflow">if</span> (ielGeom != <a class="code hl_enumvalue" href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c">QUAD</a>) {</div>
<div class="line"><span class="lineno"> 2345</span>                        std::cout &lt;&lt; <span class="stringliteral">&quot;fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem not implemented&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 2346</span>                        abort();</div>
<div class="line"><span class="lineno"> 2347</span>                    }</div>
<div class="line"><span class="lineno"> 2348</span>                    </div>
<div class="line"><span class="lineno"> 2349</span>                    msh-&gt;_finiteElement[ielGeom][SolFEType[pos_adj]]-&gt;fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem(coords_at_dofs, coords_at_dofs_bdry, jface, ig_bdry, phi_adj_vol_at_bdry, phi_adj_x_vol_at_bdry);</div>
<div class="line"><span class="lineno"> 2350</span>                    msh-&gt;_finiteElement[ielGeom][SolFEType[pos_adj_ext]]-&gt;fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem(coords_at_dofs, coords_at_dofs_bdry, jface, ig_bdry, phi_adj_ext_vol_at_bdry, phi_adj_ext_x_vol_at_bdry);</div>
<div class="line"><span class="lineno"> 2351</span> </div>
<div class="line"><span class="lineno"> 2352</span>                    </div>
<div class="line"><span class="lineno"> 2353</span><span class="comment">//=============== grad dot n for residual =========================================</span></div>
<div class="line"><span class="lineno"> 2354</span><span class="comment">//     compute gauss quantities on the boundary through VOLUME interpolation</span></div>
<div class="line"><span class="lineno"> 2355</span>                    std::fill(sol_adj_x_vol_at_bdry_gss.begin(), sol_adj_x_vol_at_bdry_gss.end(), 0.);</div>
<div class="line"><span class="lineno"> 2356</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv = 0; iv &lt; Sol_n_el_dofs_Mat_vol[pos_adj]; iv++)  {</div>
<div class="line"><span class="lineno"> 2357</span> </div>
<div class="line"><span class="lineno"> 2358</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 2359</span>                            sol_adj_x_vol_at_bdry_gss[d] += sol_eldofs_Mat[pos_adj][iv] * phi_adj_x_vol_at_bdry[iv * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];<span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><span class="lineno"> 2360</span>                        }</div>
<div class="line"><span class="lineno"> 2361</span>                    }</div>
<div class="line"><span class="lineno"> 2362</span> </div>
<div class="line"><span class="lineno"> 2363</span>                    <span class="keywordtype">double</span> grad_adj_dot_n_res = 0.;</div>
<div class="line"><span class="lineno"> 2364</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 2365</span>                        grad_adj_dot_n_res += sol_adj_x_vol_at_bdry_gss[d] * normal_qp[d];</div>
<div class="line"><span class="lineno"> 2366</span>                    }</div>
<div class="line"><span class="lineno"> 2367</span><span class="comment">//=============== grad dot n  for residual =========================================</span></div>
<div class="line"><span class="lineno"> 2368</span> </div>
<div class="line"><span class="lineno"> 2369</span><span class="comment">//=============== grad dot n for residual =========================================</span></div>
<div class="line"><span class="lineno"> 2370</span><span class="comment">//     compute gauss quantities on the boundary through VOLUME interpolation</span></div>
<div class="line"><span class="lineno"> 2371</span>                    std::fill(sol_adj_ext_x_vol_at_bdry_gss.begin(), sol_adj_ext_x_vol_at_bdry_gss.end(), 0.);</div>
<div class="line"><span class="lineno"> 2372</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv = 0; iv &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext]; iv++)  {</div>
<div class="line"><span class="lineno"> 2373</span> </div>
<div class="line"><span class="lineno"> 2374</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 2375</span>                            sol_adj_ext_x_vol_at_bdry_gss[d] += sol_eldofs_Mat[pos_adj_ext][iv] * phi_adj_ext_x_vol_at_bdry[iv * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];<span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><span class="lineno"> 2376</span>                        }</div>
<div class="line"><span class="lineno"> 2377</span>                    }</div>
<div class="line"><span class="lineno"> 2378</span> </div>
<div class="line"><span class="lineno"> 2379</span>                    <span class="keywordtype">double</span> grad_adj_ext_dot_n_res = 0.;</div>
<div class="line"><span class="lineno"> 2380</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 2381</span>                        grad_adj_ext_dot_n_res += sol_adj_ext_x_vol_at_bdry_gss[d] * normal_qp[d];</div>
<div class="line"><span class="lineno"> 2382</span>                    }</div>
<div class="line"><span class="lineno"> 2383</span><span class="comment">//=============== grad dot n  for residual =========================================</span></div>
<div class="line"><span class="lineno"> 2384</span> </div>
<div class="line"><span class="lineno"> 2385</span> </div>
<div class="line"><span class="lineno"> 2386</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_bdry = 0; i_bdry &lt; nDofu_bdry; i_bdry++)  {</div>
<div class="line"><span class="lineno"> 2387</span>                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, i_bdry);</div>
<div class="line"><span class="lineno"> 2388</span> </div>
<div class="line"><span class="lineno"> 2389</span><span class="comment">//============ Bdry Residuals - BEGIN ==================</span></div>
<div class="line"><span class="lineno"> 2390</span> </div>
<div class="line"><span class="lineno"> 2391</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_state, i_vol)  ]  +=  -  weight_qp_bdry *  ( grad_adj_dot_n_res * phi_fe_qp_bdry[SolFEType[pos_state]][i_bdry] );</div>
<div class="line"><span class="lineno"> 2392</span> </div>
<div class="line"><span class="lineno"> 2393</span>                        </div>
<div class="line"><span class="lineno"> 2394</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_ctrl, i_vol)  ]  +=  -  weight_qp_bdry *  ( grad_adj_ext_dot_n_res * phi_fe_qp_bdry[SolFEType[pos_ctrl]][i_bdry] );</div>
<div class="line"><span class="lineno"> 2396</span>                        </div>
<div class="line"><span class="lineno"> 2397</span>                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> gamma_c_u_minus_q_pos = pos_adj<span class="comment">/*pos_state*/</span>;</div>
<div class="line"><span class="lineno"> 2398</span>                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> gamma_c_Neum_adj_continuity_pos = pos_adj_ext<span class="comment">/*pos_ctrl*/</span>;</div>
<div class="line"><span class="lineno"> 2399</span>                        </div>
<div class="line"><span class="lineno"> 2400</span><span class="comment">//                         if ( group_flag == GROUP_INTERNAL ) Res[ assemble_jacobian&lt;double,double&gt;::res_row_index(Sol_n_el_dofs_Mat_vol, pos_adj, i_vol)   ]  +=  -  penalty_interface * ( sol_eldofs_Mat[pos_state][i_vol] - sol_eldofs_Mat[pos_ctrl][i_vol] ) ;    // u = q</span></div>
<div class="line"><span class="lineno"> 2401</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_u_minus_q_pos, i_vol)  ] +=  -  <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface * ( sol_eldofs_Mat[pos_state][i_vol]);    <span class="comment">// u</span></div>
<div class="line"><span class="lineno"> 2402</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_u_minus_q_pos, i_vol)  ] +=  -  <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface * ( - sol_eldofs_Mat[pos_ctrl][i_vol]);    <span class="comment">// - q</span></div>
<div class="line"><span class="lineno"> 2403</span>                        </div>
<div class="line"><span class="lineno"> 2404</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_Neum_adj_continuity_pos, i_vol)   ]  +=  - <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface *  weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * ( <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">_neumann_adjoint_continuity_sign</a> ) * grad_adj_dot_n_res ;</div>
<div class="line"><span class="lineno"> 2405</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_Neum_adj_continuity_pos, i_vol)   ]  +=  - <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface *  weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * (  grad_adj_ext_dot_n_res ) ;</div>
<div class="line"><span class="lineno"> 2406</span><span class="comment">//============ Bdry Residuals - END ==================</span></div>
<div class="line"><span class="lineno"> 2407</span> </div>
<div class="line"><span class="lineno"> 2408</span><span class="comment">//============ Bdry Jacobians on Bdry - BEGIN ==================</span></div>
<div class="line"><span class="lineno"> 2409</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_bdry=0; j_bdry &lt; nDofu_bdry; j_bdry ++) {</div>
<div class="line"><span class="lineno"> 2410</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, j_bdry);</div>
<div class="line"><span class="lineno"> 2411</span> </div>
<div class="line"><span class="lineno"> 2412</span><span class="comment">//============ u = q =============================</span></div>
<div class="line"><span class="lineno"> 2413</span>                            <span class="keywordflow">if</span> (i_vol == j_vol)  {</div>
<div class="line"><span class="lineno"> 2414</span>                                <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_u_minus_q_pos, pos_state, i_vol, j_vol) ]  += <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface *  ( 1.);</div>
<div class="line"><span class="lineno"> 2415</span>                                <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_u_minus_q_pos, pos_ctrl, i_vol, j_vol) ]   += <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface *  (-1.);</div>
<div class="line"><span class="lineno"> 2416</span>                            }</div>
<div class="line"><span class="lineno"> 2417</span><span class="comment">//============ u = q =============================</span></div>
<div class="line"><span class="lineno"> 2418</span> </div>
<div class="line"><span class="lineno"> 2419</span>                        } <span class="comment">//end j_bdry</span></div>
<div class="line"><span class="lineno"> 2420</span><span class="comment">//============ Bdry Jacobians on Bdry - END ==================</span></div>
<div class="line"><span class="lineno"> 2421</span> </div>
<div class="line"><span class="lineno"> 2422</span><span class="comment">//============ Bdry Jacobians on Volume - BEGIN ==================</span></div>
<div class="line"><span class="lineno"> 2423</span><span class="comment">//===================loop over j in the VOLUME (while i is in the boundary)</span></div>
<div class="line"><span class="lineno"> 2424</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof_max; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ++) {</div>
<div class="line"><span class="lineno"> 2425</span> </div>
<div class="line"><span class="lineno"> 2426</span><span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><span class="lineno"> 2427</span>                            <span class="keywordtype">double</span> grad_adj_dot_n_mat = 0.;</div>
<div class="line"><span class="lineno"> 2428</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0; d&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 2429</span>                                grad_adj_dot_n_mat += phi_adj_x_vol_at_bdry[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] * normal_qp[d];  <span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><span class="lineno"> 2430</span>                            }</div>
<div class="line"><span class="lineno"> 2431</span><span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><span class="lineno"> 2432</span> </div>
<div class="line"><span class="lineno"> 2433</span><span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><span class="lineno"> 2434</span>                            <span class="keywordtype">double</span> grad_adj_ext_dot_n_mat = 0.;</div>
<div class="line"><span class="lineno"> 2435</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0; d&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 2436</span>                                grad_adj_ext_dot_n_mat += phi_adj_ext_x_vol_at_bdry[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] * normal_qp[d];  <span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><span class="lineno"> 2437</span>                            }</div>
<div class="line"><span class="lineno"> 2438</span><span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><span class="lineno"> 2439</span> </div>
<div class="line"><span class="lineno"> 2440</span>                            <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) {</div>
<div class="line"><span class="lineno"> 2441</span>                                Jac[  <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_adj, i_vol, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp_bdry * grad_adj_dot_n_mat * phi_fe_qp_bdry[SolFEType[pos_state]][i_bdry];</div>
<div class="line"><span class="lineno"> 2442</span>                            }</div>
<div class="line"><span class="lineno"> 2443</span>                            </div>
<div class="line"><span class="lineno"> 2444</span>                            <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) {  </div>
<div class="line"><span class="lineno"> 2445</span>                                Jac[  <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_adj_ext, i_vol, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp_bdry * grad_adj_ext_dot_n_mat * phi_fe_qp_bdry[SolFEType[pos_ctrl]][i_bdry];</div>
<div class="line"><span class="lineno"> 2446</span>                            }</div>
<div class="line"><span class="lineno"> 2447</span>                            </div>
<div class="line"><span class="lineno"> 2448</span> </div>
<div class="line"><span class="lineno"> 2449</span>                                <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_Neum_adj_continuity_pos, pos_adj, i_vol, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface * weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * ( <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">_neumann_adjoint_continuity_sign</a> ) * grad_adj_dot_n_mat;</div>
<div class="line"><span class="lineno"> 2450</span>                                <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_Neum_adj_continuity_pos, pos_adj_ext, i_vol, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]   += <a class="code hl_variable" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface * weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * ( 1.) * grad_adj_ext_dot_n_mat;</div>
<div class="line"><span class="lineno"> 2451</span> </div>
<div class="line"><span class="lineno"> 2452</span> </div>
<div class="line"><span class="lineno"> 2453</span>                        } <span class="comment">//end j</span></div>
<div class="line"><span class="lineno"> 2454</span><span class="comment">//============ Bdry Jacobians on Volume - END ==================</span></div>
<div class="line"><span class="lineno"> 2455</span> </div>
<div class="line"><span class="lineno"> 2456</span>                    } <span class="comment">//end i_bdry</span></div>
<div class="line"><span class="lineno"> 2457</span> </div>
<div class="line"><span class="lineno"> 2458</span>                }  <span class="comment">//end ig_bdry loop</span></div>
<div class="line"><span class="lineno"> 2459</span> </div>
<div class="line"><span class="lineno"> 2460</span> </div>
<div class="line"><span class="lineno"> 2461</span>            }  <span class="comment">//bdry interface elements</span></div>
<div class="line"><span class="lineno"> 2462</span> </div>
<div class="line"><span class="lineno"> 2463</span>        }  <span class="comment">//end boundary face loop</span></div>
<div class="line"><span class="lineno"> 2464</span> </div>
<div class="line"><span class="lineno"> 2465</span> </div>
<div class="line"><span class="lineno"> 2466</span>        </div>
<div class="line"><span class="lineno"> 2467</span>        </div>
<div class="line"><span class="lineno"> 2468</span><span class="comment">//             for (unsigned j = 0; j &lt; is_dof_on_Gamma_c.size(); j++) {</span></div>
<div class="line"><span class="lineno"> 2469</span><span class="comment">//                 std::cout &lt;&lt;  &quot; ** &quot; &lt;&lt; is_dof_on_Gamma_c[j] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><span class="lineno"> 2470</span><span class="comment">//             }</span></div>
<div class="line"><span class="lineno"> 2471</span><span class="comment">//             </span></div>
<div class="line"><span class="lineno"> 2472</span><span class="comment">//            std::cout &lt;&lt; std::endl; </span></div>
<div class="line"><span class="lineno"> 2473</span>            </div>
<div class="line"><span class="lineno"> 2474</span> </div>
<div class="line"><span class="lineno"> 2475</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ig = 0; ig &lt; ml_prob.GetQuadratureRule(ielGeom).GetGaussPointsNumber(); ig++) {</div>
<div class="line"><span class="lineno"> 2476</span> </div>
<div class="line"><span class="lineno"> 2477</span>            <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno"> 2478</span>            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><span class="lineno"> 2479</span>                msh-&gt;_finiteElement[ielGeom][fe]-&gt;Jacobian(coords_at_dofs,ig,weight_qp,phi_fe_qp[fe],phi_x_fe_qp[fe],phi_xx_fe_qp[fe]);</div>
<div class="line"><span class="lineno"> 2480</span>            }</div>
<div class="line"><span class="lineno"> 2481</span>            <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN</span></div>
<div class="line"><span class="lineno"> 2482</span>            msh-&gt;_finiteElement[ielGeom][solType_coords]-&gt;Jacobian(coords_at_dofs,ig,weight_qp,phi_fe_qp[solType_coords],phi_x_fe_qp[solType_coords],phi_xx_fe_qp[solType_coords]);</div>
<div class="line"><span class="lineno"> 2483</span> </div>
<div class="line"><span class="lineno"> 2484</span><span class="comment">//========= fill gauss value xyz ==================</span></div>
<div class="line"><span class="lineno"> 2485</span>            std::fill(coord_at_qp.begin(), coord_at_qp.end(), 0.);</div>
<div class="line"><span class="lineno"> 2486</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 2487</span>                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; coords_at_dofs[d].size(); i++) {</div>
<div class="line"><span class="lineno"> 2488</span>                    coord_at_qp[d] += coords_at_dofs[d][i] * phi_fe_qp[solType_coords][i];</div>
<div class="line"><span class="lineno"> 2489</span>                }</div>
<div class="line"><span class="lineno"> 2490</span>            }</div>
<div class="line"><span class="lineno"> 2491</span>            <span class="comment">//========= fill gauss value xyz ==================</span></div>
<div class="line"><span class="lineno"> 2492</span> </div>
<div class="line"><span class="lineno"> 2493</span><span class="comment">//========= fill gauss value quantities ==================</span></div>
<div class="line"><span class="lineno"> 2494</span>            std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><span class="lineno"> 2495</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno"> 2496</span>                std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno"> 2497</span>            }</div>
<div class="line"><span class="lineno"> 2498</span> </div>
<div class="line"><span class="lineno"> 2499</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno"> 2500</span>                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs_Mat_vol[k]; i++) {</div>
<div class="line"><span class="lineno"> 2501</span>                    sol_qp[k]    += sol_eldofs_Mat[k][i] *   phi_fe_qp[SolFEType[k]][i];</div>
<div class="line"><span class="lineno"> 2502</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++)   sol_grad_qp[k][d] += sol_eldofs_Mat[k][i] * phi_x_fe_qp[SolFEType[k]][i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];</div>
<div class="line"><span class="lineno"> 2503</span>                }</div>
<div class="line"><span class="lineno"> 2504</span>            }</div>
<div class="line"><span class="lineno"> 2505</span><span class="comment">//========= fill gauss value quantities ==================</span></div>
<div class="line"><span class="lineno"> 2506</span> </div>
<div class="line"><span class="lineno"> 2507</span> </div>
<div class="line"><span class="lineno"> 2508</span> </div>
<div class="line"><span class="lineno"> 2509</span> </div>
<div class="line"><span class="lineno"> 2510</span> </div>
<div class="line"><span class="lineno"> 2511</span><span class="comment">//==========FILLING WITH THE EQUATIONS ===========</span></div>
<div class="line"><span class="lineno"> 2512</span>            <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno"> 2513</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof_max; i++) {</div>
<div class="line"><span class="lineno"> 2514</span> </div>
<div class="line"><span class="lineno"> 2515</span>                <span class="keywordtype">double</span> laplace_rhs_du_adj_i = 0.;</div>
<div class="line"><span class="lineno"> 2516</span>                <span class="keywordtype">double</span> laplace_rhs_dadj_u_i = 0.;</div>
<div class="line"><span class="lineno"> 2517</span>                <span class="keywordtype">double</span> laplace_rhs_dctrl_adj_ext_i = 0.;</div>
<div class="line"><span class="lineno"> 2518</span>                <span class="keywordtype">double</span> laplace_rhs_dadj_ext_ctrl_i = 0.;</div>
<div class="line"><span class="lineno"> 2519</span>                <span class="keywordtype">double</span> laplace_rhs_dctrl_ctrl_i = 0.;</div>
<div class="line"><span class="lineno"> 2520</span> </div>
<div class="line"><span class="lineno"> 2521</span>                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 2522</span>                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_state] )       laplace_rhs_du_adj_i          +=  (phi_x_fe_qp[SolFEType[pos_state]]   [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_adj][kdim]);</div>
<div class="line"><span class="lineno"> 2523</span>                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj] )         laplace_rhs_dadj_u_i          +=  (phi_x_fe_qp[SolFEType[pos_adj]]     [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_state][kdim]);</div>
<div class="line"><span class="lineno"> 2524</span>                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )        laplace_rhs_dctrl_adj_ext_i   +=  (phi_x_fe_qp[SolFEType[pos_ctrl]]    [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_adj_ext][kdim]);</div>
<div class="line"><span class="lineno"> 2525</span>                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext] )     laplace_rhs_dadj_ext_ctrl_i   +=  (phi_x_fe_qp[SolFEType[pos_adj_ext]] [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_ctrl][kdim]);</div>
<div class="line"><span class="lineno"> 2526</span>                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )        laplace_rhs_dctrl_ctrl_i      +=  (phi_x_fe_qp[SolFEType[pos_ctrl]]    [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_ctrl][kdim]);</div>
<div class="line"><span class="lineno"> 2527</span>                }</div>
<div class="line"><span class="lineno"> 2528</span> </div>
<div class="line"><span class="lineno"> 2529</span><span class="comment">//======================Volume Residuals - BEGIN =======================</span></div>
<div class="line"><span class="lineno"> 2530</span><span class="comment">//--- equations ---                </span></div>
<div class="line"><span class="lineno"> 2531</span>                <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> )     {</div>
<div class="line"><span class="lineno"> 2532</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_state,i) ]  += - weight_qp * (target_flag * phi_fe_qp[SolFEType[pos_state]][i] * ( sol_qp[pos_state] - u_des) - laplace_rhs_du_adj_i);</div>
<div class="line"><span class="lineno"> 2533</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_adj,i)]     += - weight_qp *  ( - laplace_rhs_dadj_u_i    - 0.) ;</div>
<div class="line"><span class="lineno"> 2534</span>                }</div>
<div class="line"><span class="lineno"> 2535</span> </div>
<div class="line"><span class="lineno"> 2536</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> )  {</div>
<div class="line"><span class="lineno"> 2537</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_ctrl,i) ]   += - weight_qp * ( <a class="code hl_define" href="../../df/d2a/07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a> * <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a> * phi_fe_qp[SolFEType[pos_ctrl]][i] * sol_qp[pos_ctrl]</div>
<div class="line"><span class="lineno"> 2538</span>                            + <a class="code hl_define" href="../../df/d2a/07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a> * <a class="code hl_variable" href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a> * laplace_rhs_dctrl_ctrl_i</div>
<div class="line"><span class="lineno"> 2539</span>                            - laplace_rhs_dctrl_adj_ext_i <span class="comment">/*+ 7000. * phi_fe_qp[SolFEType[pos_ctrl]][i]*/</span>);</div>
<div class="line"><span class="lineno"> 2540</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_adj_ext,i)] += - weight_qp *  ( - laplace_rhs_dadj_ext_ctrl_i - 0.);</div>
<div class="line"><span class="lineno"> 2541</span>                }</div>
<div class="line"><span class="lineno"> 2542</span> </div>
<div class="line"><span class="lineno"> 2543</span><span class="comment">//--- extensions to zero ---</span></div>
<div class="line"><span class="lineno"> 2544</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> exclude_Dirichlet_Gamma_c_for_Adjoint =  (1 - is_dof_on_Gamma_c[i]);</div>
<div class="line"><span class="lineno"> 2545</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> exclude_Dirichlet_Gamma_c_for_Adjoint_Ext =  (1 - is_dof_on_Gamma_c[i]);</div>
<div class="line"><span class="lineno"> 2546</span>            </div>
<div class="line"><span class="lineno"> 2547</span>                <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> )     {</div>
<div class="line"><span class="lineno"> 2548</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_adj_ext, i)] += - exclude_Dirichlet_Gamma_c_for_Adjoint_Ext * penalty_strong_ctrl * ( sol_eldofs_Mat[pos_adj_ext][i] - 0.);</div>
<div class="line"><span class="lineno"> 2549</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_ctrl, i)]    += - (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl * (sol_eldofs_Mat[pos_ctrl][i] - 0.);</div>
<div class="line"><span class="lineno"> 2550</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_mu, i)]      += - (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl * ( sol_eldofs_Mat[pos_mu][i] - 0.);</div>
<div class="line"><span class="lineno"> 2551</span>                }</div>
<div class="line"><span class="lineno"> 2552</span> </div>
<div class="line"><span class="lineno"> 2553</span>                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> )  {</div>
<div class="line"><span class="lineno"> 2554</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_adj, i)]     += - exclude_Dirichlet_Gamma_c_for_Adjoint * penalty_strong_u * (  sol_eldofs_Mat[pos_adj][i] - 0.);</div>
<div class="line"><span class="lineno"> 2555</span>                    Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_state, i) ]  += - (1 - is_dof_on_Gamma_c[i]) * penalty_strong_u * (sol_eldofs_Mat[pos_state][i] - 0.);</div>
<div class="line"><span class="lineno"> 2556</span>                }</div>
<div class="line"><span class="lineno"> 2557</span><span class="comment">//======================Volume Residuals - END =======================</span></div>
<div class="line"><span class="lineno"> 2558</span> </div>
<div class="line"><span class="lineno"> 2559</span>                <span class="keywordflow">if</span> (assembleMatrix) {</div>
<div class="line"><span class="lineno"> 2560</span> </div>
<div class="line"><span class="lineno"> 2561</span>                    <span class="comment">// *** phi_j loop ***</span></div>
<div class="line"><span class="lineno"> 2562</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof_max; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 2563</span> </div>
<div class="line"><span class="lineno"> 2564</span>                        <span class="keywordtype">double</span> laplace_mat_du_adj = 0.;</div>
<div class="line"><span class="lineno"> 2565</span>                        <span class="keywordtype">double</span> laplace_mat_dadj_u = 0.;</div>
<div class="line"><span class="lineno"> 2566</span>                        <span class="keywordtype">double</span> laplace_mat_dctrl_adj_ext = 0.;</div>
<div class="line"><span class="lineno"> 2567</span>                        <span class="keywordtype">double</span> laplace_mat_dadj_ext_ctrl = 0.;</div>
<div class="line"><span class="lineno"> 2568</span>                        <span class="keywordtype">double</span> laplace_mat_dctrl_ctrl = 0.;</div>
<div class="line"><span class="lineno"> 2569</span> </div>
<div class="line"><span class="lineno"> 2570</span>                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 2571</span>                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_state]   &amp;&amp; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_adj] )      laplace_mat_du_adj        += (phi_x_fe_qp[SolFEType[pos_state]]  [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_adj]]    [<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);</div>
<div class="line"><span class="lineno"> 2572</span>                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj]     &amp;&amp; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_state] )    laplace_mat_dadj_u        += (phi_x_fe_qp[SolFEType[pos_adj]]    [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_state]]  [<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);  <span class="comment">//equal to the previous</span></div>
<div class="line"><span class="lineno"> 2573</span>                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl]    &amp;&amp; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext] )  laplace_mat_dctrl_adj_ext += (phi_x_fe_qp[SolFEType[pos_ctrl]]   [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_adj_ext]][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);</div>
<div class="line"><span class="lineno"> 2574</span>                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext] &amp;&amp; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )     laplace_mat_dadj_ext_ctrl += (phi_x_fe_qp[SolFEType[pos_adj_ext]][i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_ctrl]]   [<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);  <span class="comment">//equal to the previous</span></div>
<div class="line"><span class="lineno"> 2575</span>                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl]    &amp;&amp; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )     laplace_mat_dctrl_ctrl    += (phi_x_fe_qp[SolFEType[pos_ctrl]]   [i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_ctrl]]   [<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);</div>
<div class="line"><span class="lineno"> 2576</span>                        }</div>
<div class="line"><span class="lineno"> 2577</span> </div>
<div class="line"><span class="lineno"> 2578</span> </div>
<div class="line"><span class="lineno"> 2579</span><span class="comment">//--- equations ---                </span></div>
<div class="line"><span class="lineno"> 2580</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) {</div>
<div class="line"><span class="lineno"> 2581</span> </div>
<div class="line"><span class="lineno"> 2582</span>                            Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_state, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ] += weight_qp * target_flag * phi_fe_qp[SolFEType[pos_state]][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * phi_fe_qp[SolFEType[pos_state]][i];</div>
<div class="line"><span class="lineno"> 2583</span>                            Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_adj, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]   += weight_qp * (-1.) * laplace_mat_du_adj;</div>
<div class="line"><span class="lineno"> 2584</span> </div>
<div class="line"><span class="lineno"> 2585</span>                            Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj, pos_state, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]   += weight_qp * (-1.) * laplace_mat_dadj_u;</div>
<div class="line"><span class="lineno"> 2586</span> </div>
<div class="line"><span class="lineno"> 2587</span>                        }</div>
<div class="line"><span class="lineno"> 2588</span> </div>
<div class="line"><span class="lineno"> 2589</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) {</div>
<div class="line"><span class="lineno"> 2590</span> </div>
<div class="line"><span class="lineno"> 2591</span>                            </div>
<div class="line"><span class="lineno"> 2592</span>                            Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_ctrl, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]     += weight_qp * ( </div>
<div class="line"><span class="lineno"> 2593</span>                                 <a class="code hl_define" href="../../df/d2a/07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a> * <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a> * phi_fe_qp[SolFEType[pos_ctrl]][i] * phi_fe_qp[SolFEType[pos_ctrl]][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]</div>
<div class="line"><span class="lineno"> 2594</span>                                + <a class="code hl_define" href="../../df/d2a/07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a> * <a class="code hl_variable" href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a> * laplace_mat_dctrl_ctrl</div>
<div class="line"><span class="lineno"> 2595</span>                                    );</div>
<div class="line"><span class="lineno"> 2596</span> </div>
<div class="line"><span class="lineno"> 2597</span>                            Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_adj_ext, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp * (-1.) * laplace_mat_dctrl_adj_ext;</div>
<div class="line"><span class="lineno"> 2598</span> </div>
<div class="line"><span class="lineno"> 2599</span>                            Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj_ext, pos_ctrl, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp * (-1.) * laplace_mat_dadj_ext_ctrl;</div>
<div class="line"><span class="lineno"> 2600</span> </div>
<div class="line"><span class="lineno"> 2601</span>                        }</div>
<div class="line"><span class="lineno"> 2602</span> </div>
<div class="line"><span class="lineno"> 2603</span>                        </div>
<div class="line"><span class="lineno"> 2604</span> </div>
<div class="line"><span class="lineno"> 2605</span><span class="comment">//--- extensions to zero ---                </span></div>
<div class="line"><span class="lineno"> 2606</span>                       <span class="keywordflow">if</span> (  i == <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ) {</div>
<div class="line"><span class="lineno"> 2607</span>                                </div>
<div class="line"><span class="lineno"> 2608</span>                        <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) {</div>
<div class="line"><span class="lineno"> 2609</span>                             Jac[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj_ext, pos_adj_ext, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)]  += exclude_Dirichlet_Gamma_c_for_Adjoint_Ext * penalty_strong_ctrl;</div>
<div class="line"><span class="lineno"> 2610</span>                             Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_ctrl, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]      += (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl;</div>
<div class="line"><span class="lineno"> 2611</span>                             Jac[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_mu, pos_mu, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]           += (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl;</div>
<div class="line"><span class="lineno"> 2612</span>                            }</div>
<div class="line"><span class="lineno"> 2613</span>                            </div>
<div class="line"><span class="lineno"> 2614</span>                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) {</div>
<div class="line"><span class="lineno"> 2615</span>                             Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj, pos_adj, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]      += exclude_Dirichlet_Gamma_c_for_Adjoint *  penalty_strong_u;</div>
<div class="line"><span class="lineno"> 2616</span>                             Jac[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_state, i, <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += (1 - is_dof_on_Gamma_c[i]) *  penalty_strong_u;</div>
<div class="line"><span class="lineno"> 2617</span>                            }</div>
<div class="line"><span class="lineno"> 2618</span> </div>
<div class="line"><span class="lineno"> 2619</span>                        }</div>
<div class="line"><span class="lineno"> 2620</span>                        </div>
<div class="line"><span class="lineno"> 2621</span>                        </div>
<div class="line"><span class="lineno"> 2622</span>                        </div>
<div class="line"><span class="lineno"> 2623</span>                        </div>
<div class="line"><span class="lineno"> 2624</span>                        </div>
<div class="line"><span class="lineno"> 2625</span>                        </div>
<div class="line"><span class="lineno"> 2626</span>                        </div>
<div class="line"><span class="lineno"> 2627</span>                    } <span class="comment">// end phi_j loop</span></div>
<div class="line"><span class="lineno"> 2628</span> </div>
<div class="line"><span class="lineno"> 2629</span>                } <span class="comment">// endif assemble_matrix</span></div>
<div class="line"><span class="lineno"> 2630</span> </div>
<div class="line"><span class="lineno"> 2631</span>            } <span class="comment">// end phi_i loop</span></div>
<div class="line"><span class="lineno"> 2632</span> </div>
<div class="line"><span class="lineno"> 2633</span>        } <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno"> 2634</span> </div>
<div class="line"><span class="lineno"> 2635</span> </div>
<div class="line"><span class="lineno"> 2636</span><span class="comment">//========== sum-based part ================================</span></div>
<div class="line"><span class="lineno"> 2637</span> </div>
<div class="line"><span class="lineno"> 2638</span>        RES-&gt;add_vector_blocked(Res, L2G_dofmap_Mat_AllVars);</div>
<div class="line"><span class="lineno"> 2639</span>        <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;add_matrix_blocked(Jac, L2G_dofmap_Mat_AllVars, L2G_dofmap_Mat_AllVars);</div>
<div class="line"><span class="lineno"> 2640</span> </div>
<div class="line"><span class="lineno"> 2641</span>        </div>
<div class="line"><span class="lineno"> 2642</span>        </div>
<div class="line"><span class="lineno"> 2643</span>     <span class="keywordflow">if</span> (print_algebra_local) {</div>
<div class="line"><span class="lineno"> 2644</span>    <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#af1d28f6f33acdba64d6e3c733d09f0aa">assemble_jacobian&lt;double,double&gt;::print_element_residual</a>(iel, Res, Sol_n_el_dofs_Mat_vol, 10, 5);</div>
<div class="line"><span class="lineno"> 2645</span>    <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a76626a28a3fa87cc055e76d189ed4660">assemble_jacobian&lt;double,double&gt;::print_element_jacobian</a>(iel, Jac, Sol_n_el_dofs_Mat_vol, 10, 5);</div>
<div class="line"><span class="lineno"> 2646</span>     }</div>
<div class="line"><span class="lineno"> 2647</span>        </div>
<div class="line"><span class="lineno"> 2648</span>  } <span class="comment">//end element loop for each process</span></div>
<div class="line"><span class="lineno"> 2649</span>       </div>
<div class="line"><span class="lineno"> 2650</span>       </div>
<div class="line"><span class="lineno"> 2651</span>       </div>
<div class="line"><span class="lineno"> 2652</span>     <span class="comment">//this part is to add a bunch of 1&#39;s in the residual, so it is not based on the element loop</span></div>
<div class="line"><span class="lineno"> 2653</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctrl_index = mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;control&quot;</span>);</div>
<div class="line"><span class="lineno"> 2654</span> </div>
<div class="line"><span class="lineno"> 2655</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> global_ctrl_size = pdeSys-&gt;KKoffset[ctrl_index+1][iproc] - pdeSys-&gt;KKoffset[ctrl_index][iproc];</div>
<div class="line"><span class="lineno"> 2656</span> </div>
<div class="line"><span class="lineno"> 2657</span>    std::vector&lt;double&gt;  one_times_mu(global_ctrl_size, 0.);</div>
<div class="line"><span class="lineno"> 2658</span>    std::vector&lt;int&gt;    positions(global_ctrl_size);</div>
<div class="line"><span class="lineno"> 2659</span> </div>
<div class="line"><span class="lineno"> 2660</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; positions.size(); i++) {</div>
<div class="line"><span class="lineno"> 2661</span>        positions[i] = pdeSys-&gt;KKoffset[ctrl_index][iproc] + i;</div>
<div class="line"><span class="lineno"> 2662</span>        one_times_mu[i] = ineq_flag * 1. * (*sol-&gt;_Sol[SolIndex[pos_mu]])(i<span class="comment">/*position_mu_i*/</span>) ;</div>
<div class="line"><span class="lineno"> 2663</span>    }</div>
<div class="line"><span class="lineno"> 2664</span>    RES-&gt;add_vector_blocked(one_times_mu, positions);</div>
<div class="line"><span class="lineno"> 2665</span> </div>
<div class="line"><span class="lineno"> 2666</span>    </div>
<div class="line"><span class="lineno"> 2667</span>    RES-&gt;close();</div>
<div class="line"><span class="lineno"> 2668</span>    <span class="keywordflow">if</span> (assembleMatrix)   JAC-&gt;close();</div>
<div class="line"><span class="lineno"> 2669</span>      <span class="comment">// ***************** ADD PART - END  *******************</span></div>
<div class="line"><span class="lineno"> 2670</span>      </div>
<div class="line"><span class="lineno"> 2671</span>        </div>
<div class="line"><span class="lineno"> 2672</span>        </div>
<div class="line"><span class="lineno"> 2673</span>        </div>
<div class="line"><span class="lineno"> 2674</span><span class="comment">//   ***************** INSERT PART - BEGIN (must go AFTER the sum, clearly) *******************</span></div>
<div class="line"><span class="lineno"> 2675</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno"> 2676</span> </div>
<div class="line"><span class="lineno"> 2677</span>      </div>
<div class="line"><span class="lineno"> 2678</span> </div>
<div class="line"><span class="lineno"> 2679</span><span class="comment">// -------</span></div>
<div class="line"><span class="lineno"> 2680</span>   geom_element_iel.set_coords_at_dofs_and_geom_type(iel, solType_coords);</div>
<div class="line"><span class="lineno"> 2681</span>      </div>
<div class="line"><span class="lineno"> 2682</span>   geom_element_iel.set_elem_center_3d(iel, solType_coords);</div>
<div class="line"><span class="lineno"> 2683</span><span class="comment">// -------</span></div>
<div class="line"><span class="lineno"> 2684</span>   </div>
<div class="line"><span class="lineno"> 2685</span><span class="comment">// -------</span></div>
<div class="line"><span class="lineno"> 2686</span>    <a class="code hl_function" href="../../d8/dea/namespacefemus.html#a83b704b37aa1188e8719918bef34ca1a">el_dofs_unknowns_vol</a>(sol, msh, pdeSys, iel,</div>
<div class="line"><span class="lineno"> 2687</span>                        SolFEType,</div>
<div class="line"><span class="lineno"> 2688</span>                        SolIndex,</div>
<div class="line"><span class="lineno"> 2689</span>                        SolPdeIndex,</div>
<div class="line"><span class="lineno"> 2690</span>                        Sol_n_el_dofs_Mat_vol,</div>
<div class="line"><span class="lineno"> 2691</span>                        sol_eldofs_Mat,</div>
<div class="line"><span class="lineno"> 2692</span>                        L2G_dofmap_Mat);</div>
<div class="line"><span class="lineno"> 2693</span>      </div>
<div class="line"><span class="lineno"> 2694</span>    <span class="comment">//***** set control flag ****************************</span></div>
<div class="line"><span class="lineno"> 2695</span>  <span class="keywordtype">int</span> control_el_flag = 0;</div>
<div class="line"><span class="lineno"> 2696</span>  control_el_flag = <a class="code hl_function" href="../../d7/d7b/classfemus_1_1ctrl_1_1square__or__cube_1_1lifting__internal.html#ae8b192bf476ac8b9b8aa23671e98bc84">ctrl:: square_or_cube:: lifting_internal &lt; ctrl::GAMMA_CONTROL_LIST_OF_FACES_WITH_EXTREMES &gt;::ControlDomainFlag_internal_restriction</a>(geom_element_iel.get_elem_center_3d());</div>
<div class="line"><span class="lineno"> 2697</span> </div>
<div class="line"><span class="lineno"> 2698</span>    </div>
<div class="line"><span class="lineno"> 2699</span>    <span class="keywordflow">if</span> (control_el_flag == 1) {</div>
<div class="line"><span class="lineno"> 2700</span> </div>
<div class="line"><span class="lineno"> 2701</span>        </div>
<div class="line"><span class="lineno"> 2702</span>  <a class="code hl_function" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#a53fcde6a8cb427b5da69375d0fe7cd14">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::update_active_set_flag_for_current_nonlinear_iteration</a></div>
<div class="line"><span class="lineno"> 2703</span>  (msh,</div>
<div class="line"><span class="lineno"> 2704</span>   sol,</div>
<div class="line"><span class="lineno"> 2705</span>   iel,</div>
<div class="line"><span class="lineno"> 2706</span>   geom_element_iel.get_coords_at_dofs<span class="comment">/*_3d*/</span>(),</div>
<div class="line"><span class="lineno"> 2707</span>   sol_eldofs_Mat,</div>
<div class="line"><span class="lineno"> 2708</span>   Sol_n_el_dofs_Mat_vol,</div>
<div class="line"><span class="lineno"> 2709</span>   c_compl,</div>
<div class="line"><span class="lineno"> 2710</span>   pos_mu_in_mat,</div>
<div class="line"><span class="lineno"> 2711</span>   pos_ctrl_in_mat,</div>
<div class="line"><span class="lineno"> 2712</span>   solIndex_act_flag_sol,</div>
<div class="line"><span class="lineno"> 2713</span>   ctrl_lower,</div>
<div class="line"><span class="lineno"> 2714</span>   ctrl_upper,</div>
<div class="line"><span class="lineno"> 2715</span>   sol_actflag);</div>
<div class="line"><span class="lineno"> 2716</span>  </div>
<div class="line"><span class="lineno"> 2717</span>      </div>
<div class="line"><span class="lineno"> 2718</span> </div>
<div class="line"><span class="lineno"> 2719</span> </div>
<div class="line"><span class="lineno"> 2720</span>    <a class="code hl_function" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#ab4b3a83d002791e1386aaeebd85f8bf0">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::node_insertion</a>(iel,</div>
<div class="line"><span class="lineno"> 2721</span>                   msh,</div>
<div class="line"><span class="lineno"> 2722</span>                   L2G_dofmap_Mat,</div>
<div class="line"><span class="lineno"> 2723</span>                   pos_mu_in_mat,</div>
<div class="line"><span class="lineno"> 2724</span>                   pos_ctrl_in_mat,</div>
<div class="line"><span class="lineno"> 2725</span>                   sol_eldofs_Mat,</div>
<div class="line"><span class="lineno"> 2726</span>                   Sol_n_el_dofs_Mat_vol,</div>
<div class="line"><span class="lineno"> 2727</span>                   sol_actflag,</div>
<div class="line"><span class="lineno"> 2728</span>                   ctrl_lower,</div>
<div class="line"><span class="lineno"> 2729</span>                   ctrl_upper,</div>
<div class="line"><span class="lineno"> 2730</span>                   ineq_flag,</div>
<div class="line"><span class="lineno"> 2731</span>                   c_compl,</div>
<div class="line"><span class="lineno"> 2732</span>                   JAC,</div>
<div class="line"><span class="lineno"> 2733</span>                   RES,</div>
<div class="line"><span class="lineno"> 2734</span>                   assembleMatrix</div>
<div class="line"><span class="lineno"> 2735</span>                   );</div>
<div class="line"><span class="lineno"> 2736</span>   </div>
<div class="line"><span class="lineno"> 2737</span> </div>
<div class="line"><span class="lineno"> 2738</span>       }</div>
<div class="line"><span class="lineno"> 2739</span>      </div>
<div class="line"><span class="lineno"> 2740</span>      </div>
<div class="line"><span class="lineno"> 2741</span><span class="comment">// // // //============= delta_mu row ===============================</span></div>
<div class="line"><span class="lineno"> 2742</span><span class="comment">// // //         std::vector&lt;double&gt; Res_mu (Sol_n_el_dofs[pos_mu]);</span></div>
<div class="line"><span class="lineno"> 2743</span><span class="comment">// // //         std::fill(Res_mu.begin(),Res_mu.end(), 0.);</span></div>
<div class="line"><span class="lineno"> 2744</span><span class="comment">// // //         for (unsigned i = 0; i &lt; sol_actflag.size(); i++) {</span></div>
<div class="line"><span class="lineno"> 2745</span><span class="comment">// // //             if (sol_actflag[i] == 0) {  //inactive</span></div>
<div class="line"><span class="lineno"> 2746</span><span class="comment">// // //                 Res_mu [i] = - ineq_flag * ( 1. * sol_eldofs[pos_mu][i] - 0. );</span></div>
<div class="line"><span class="lineno"> 2747</span><span class="comment">// // //             }</span></div>
<div class="line"><span class="lineno"> 2748</span><span class="comment">// // //             else if (sol_actflag[i] == 1) {  //active_a</span></div>
<div class="line"><span class="lineno"> 2749</span><span class="comment">// // //                 Res_mu [i] = - ineq_flag * ( c_compl *  sol_eldofs[pos_ctrl][i] - c_compl * ctrl_lower[i]);</span></div>
<div class="line"><span class="lineno"> 2750</span><span class="comment">// // //             }</span></div>
<div class="line"><span class="lineno"> 2751</span><span class="comment">// // //             else if (sol_actflag[i] == 2) {  //active_b</span></div>
<div class="line"><span class="lineno"> 2752</span><span class="comment">// // //                 Res_mu [i]  = - ineq_flag * ( c_compl * sol_eldofs[pos_ctrl][i] - c_compl * ctrl_upper[i]);</span></div>
<div class="line"><span class="lineno"> 2753</span><span class="comment">// // //             }</span></div>
<div class="line"><span class="lineno"> 2754</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno"> 2755</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno"> 2756</span><span class="comment">// // //      </span></div>
<div class="line"><span class="lineno"> 2757</span><span class="comment">// // //         RES-&gt;insert(Res_mu, L2G_dofmap_Mat[pos_mu]);</span></div>
<div class="line"><span class="lineno"> 2758</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno"> 2759</span><span class="comment">// // //         //============= delta_mu-delta_ctrl row ===============================</span></div>
<div class="line"><span class="lineno"> 2760</span><span class="comment">// // //         for (unsigned i = 0; i &lt; sol_actflag.size(); i++) if (sol_actflag[i] != 0 ) sol_actflag[i] = ineq_flag * c_compl;</span></div>
<div class="line"><span class="lineno"> 2761</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno"> 2762</span><span class="comment">// // //         JAC-&gt;matrix_set_off_diagonal_values_blocked(L2G_dofmap_Mat[pos_mu], L2G_dofmap_Mat[pos_ctrl], sol_actflag);</span></div>
<div class="line"><span class="lineno"> 2763</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno"> 2764</span><span class="comment">// // //         //============= delta_mu-delta_mu row ===============================</span></div>
<div class="line"><span class="lineno"> 2765</span><span class="comment">// // //         for (unsigned i = 0; i &lt; sol_actflag.size(); i++) sol_actflag[i] =  ineq_flag * (1 - sol_actflag[i]/c_compl)  + (1-ineq_flag) * 1.;</span></div>
<div class="line"><span class="lineno"> 2766</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno"> 2767</span><span class="comment">// // //         JAC-&gt;matrix_set_off_diagonal_values_blocked(L2G_dofmap_Mat[pos_mu], L2G_dofmap_Mat[pos_mu], sol_actflag );</span></div>
<div class="line"><span class="lineno"> 2768</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno"> 2769</span>     </div>
<div class="line"><span class="lineno"> 2770</span>        <span class="comment">//============= delta_ctrl-delta_mu row ===============================</span></div>
<div class="line"><span class="lineno"> 2771</span>        JAC-&gt;matrix_set_off_diagonal_values_blocked( L2G_dofmap_Mat[pos_ctrl], L2G_dofmap_Mat[pos_mu], ineq_flag * 1.);</div>
<div class="line"><span class="lineno"> 2772</span> </div>
<div class="line"><span class="lineno"> 2773</span>     </div>
<div class="line"><span class="lineno"> 2774</span>    } <span class="comment">//end element loop for each process    </span></div>
<div class="line"><span class="lineno"> 2775</span> <span class="comment">//   ***************** INSERT PART - END (must go AFTER the sum, clearly) *******************</span></div>
<div class="line"><span class="lineno"> 2776</span>   </div>
<div class="line"><span class="lineno"> 2777</span>  RES-&gt;close();</div>
<div class="line"><span class="lineno"> 2778</span>  <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;close();</div>
<div class="line"><span class="lineno"> 2779</span> </div>
<div class="line"><span class="lineno"> 2780</span> </div>
<div class="line"><span class="lineno"> 2781</span>  </div>
<div class="line"><span class="lineno"> 2782</span>  <a class="code hl_function" href="../../d8/dea/namespacefemus.html#a58e58ec75c1599370f2636943a6f6c33">print_global_residual_jacobian</a>(print_algebra_global,</div>
<div class="line"><span class="lineno"> 2783</span>                                 ml_prob,</div>
<div class="line"><span class="lineno"> 2784</span>                                 mlPdeSys,</div>
<div class="line"><span class="lineno"> 2785</span>                                 pdeSys,</div>
<div class="line"><span class="lineno"> 2786</span>                                 RES,</div>
<div class="line"><span class="lineno"> 2787</span>                                 JAC,</div>
<div class="line"><span class="lineno"> 2788</span>                                 iproc,</div>
<div class="line"><span class="lineno"> 2789</span>                                 assembleMatrix);</div>
<div class="line"><span class="lineno"> 2790</span>  </div>
<div class="line"><span class="lineno"> 2791</span> </div>
<div class="line"><span class="lineno"> 2792</span> </div>
<div class="line"><span class="lineno"> 2793</span>  </div>
<div class="line"><span class="lineno"> 2794</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno"> 2795</span>}</div>
<div class="ttc" id="a07__fractional_8cpp_html_a2b20da92637cd95fc41f37f3b0823724"><div class="ttname"><a href="../../df/d2a/07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a></div><div class="ttdeci">#define OP_H1</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/07__fractional_8cpp_source.html#l00040">07_fractional.cpp:40</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_aab33c985fc96acde267a7bf1a54b0a1e"><div class="ttname"><a href="../../df/d2a/07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a></div><div class="ttdeci">#define OP_L2</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/07__fractional_8cpp_source.html#l00039">07_fractional.cpp:39</a></div></div>
<div class="ttc" id="a_f_elem_type_enum__list_8hpp_html_aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957"><div class="ttname"><a href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a></div><div class="ttdeci">@ CONTINUOUS_BIQUADRATIC</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d70/_f_elem_type_enum__list_8hpp_source.html#l00029">FElemTypeEnum_list.hpp:29</a></div></div>
<div class="ttc" id="a_f_elem_type_enum__list_8hpp_html_ac6579c52f41d7124718cc41736bae6d1"><div class="ttname"><a href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a></div><div class="ttdeci">#define NFE_FAMS</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d70/_f_elem_type_enum__list_8hpp_source.html#l00022">FElemTypeEnum_list.hpp:22</a></div></div>
<div class="ttc" id="a_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp_html_a9424343761f8c4f4c1afe8f5b6bf471b"><div class="ttname"><a href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a></div><div class="ttdeci">double beta</div><div class="ttdef"><b>Definition</b> <a href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp_source.html#l00011">FSITimeDependentAssemblySupgNonConservativeTwoPressuresNewmark.hpp:11</a></div></div>
<div class="ttc" id="a_geom_el_type_enum_8hpp_html_a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c"><div class="ttname"><a href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c">QUAD</a></div><div class="ttdeci">@ QUAD</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d03/_geom_el_type_enum_8hpp_source.html#l00016">GeomElTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex6_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_navier_stokes___a_m_r_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp_source.html#l00034">NavierStokes_AMR.cpp:34</a></div></div>
<div class="ttc" id="aclassfemus_1_1_element_jac_res_html_adaae99208cf2f2f60e867d6409035f1d"><div class="ttname"><a href="../../d3/dc6/classfemus_1_1_element_jac_res.html#adaae99208cf2f2f60e867d6409035f1d">femus::ElementJacRes::compute_max_n_dofs</a></div><div class="ttdeci">static unsigned int compute_max_n_dofs(const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3e/_assemble__unknown__jacres_8hpp_source.html#l00069">Assemble_unknown_jacres.hpp:69</a></div></div>
<div class="ttc" id="aclassfemus_1_1_element_jac_res_html_af9f782d3aa6f1bcee95c7eb1af72b8ec"><div class="ttname"><a href="../../d3/dc6/classfemus_1_1_element_jac_res.html#af9f782d3aa6f1bcee95c7eb1af72b8ec">femus::ElementJacRes::compute_sum_n_dofs</a></div><div class="ttdeci">static unsigned int compute_sum_n_dofs(const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d3e/_assemble__unknown__jacres_8hpp_source.html#l00081">Assemble_unknown_jacres.hpp:81</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a298fb51789fa086f4ac3904b43336f76"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">femus::assemble_jacobian::res_row_index</a></div><div class="ttdeci">static unsigned int res_row_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int my_row_pos, const int i)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/db7/_assemble__jacobian_8hpp_source.html#l00289">Assemble_jacobian.hpp:289</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a76626a28a3fa87cc055e76d189ed4660"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a76626a28a3fa87cc055e76d189ed4660">femus::assemble_jacobian::print_element_jacobian</a></div><div class="ttdeci">static void print_element_jacobian(const unsigned int iel, const std::vector&lt; double &gt; &amp;Jac, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const unsigned int col_width_visualization, const unsigned int precision)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/db7/_assemble__jacobian_8hpp_source.html#l00226">Assemble_jacobian.hpp:226</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_af1d28f6f33acdba64d6e3c733d09f0aa"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#af1d28f6f33acdba64d6e3c733d09f0aa">femus::assemble_jacobian::print_element_residual</a></div><div class="ttdeci">static void print_element_residual(const unsigned int iel, const std::vector&lt; real_num &gt; &amp;Res, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const unsigned int col_width_visualization, const unsigned int precision)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/db7/_assemble__jacobian_8hpp_source.html#l00261">Assemble_jacobian.hpp:261</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_afafa42b312f4db1f55298eb039ada1c6"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">femus::assemble_jacobian::jac_row_col_index</a></div><div class="ttdeci">static unsigned int jac_row_col_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int nDof_AllVars, const int my_row_pos, const int my_col_pos, const int i, const int j)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/db7/_assemble__jacobian_8hpp_source.html#l00301">Assemble_jacobian.hpp:301</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality_html_a53fcde6a8cb427b5da69375d0fe7cd14"><div class="ttname"><a href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#a53fcde6a8cb427b5da69375d0fe7cd14">femus::ctrl::mixed_state_or_ctrl_inequality::update_active_set_flag_for_current_nonlinear_iteration</a></div><div class="ttdeci">static void update_active_set_flag_for_current_nonlinear_iteration(const femus::Mesh *msh, const femus::Solution *sol, const unsigned int iel, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_at_dofs, const std::vector&lt; std::vector&lt; double &gt; &gt; sol_eldofs, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const double c_compl, const std::vector&lt; unsigned int &gt; pos_mu, const std::vector&lt; unsigned int &gt; pos_ctrl, const std::vector&lt; unsigned int &gt; solIndex_act_flag, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_lower_dofs, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_upper_dofs, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;sol_actflag_dofs)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00031">03_opt_system_inequalities.hpp:31</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality_html_ab4b3a83d002791e1386aaeebd85f8bf0"><div class="ttname"><a href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#ab4b3a83d002791e1386aaeebd85f8bf0">femus::ctrl::mixed_state_or_ctrl_inequality::node_insertion</a></div><div class="ttdeci">static void node_insertion(const unsigned int iel, const Mesh *msh, const std::vector&lt; std::vector&lt; int &gt; &gt; &amp;L2G_dofmap_Mat, const std::vector&lt; unsigned int &gt; pos_mat_mu, const std::vector&lt; unsigned int &gt; pos_mat_ctrl, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;sol_eldofs_Mat, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;sol_actflag_dofs, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_lower_dofs, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_upper_dofs, const double ineq_flag, const double c_compl, SparseMatrix *KK, NumericVector *RES, const bool assembleMatrix)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00183">03_opt_system_inequalities.hpp:183</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality_html_ad8765c4d3fe1216148aa932896951aee"><div class="ttname"><a href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#ad8765c4d3fe1216148aa932896951aee">femus::ctrl::mixed_state_or_ctrl_inequality::store_act_flag_in_old</a></div><div class="ttdeci">static void store_act_flag_in_old(const NonLinearImplicitSystemWithPrimalDualActiveSetMethod *mlPdeSys, const MultiLevelSolution *ml_sol, Solution *sol, std::vector&lt; unsigned int &gt; &amp;solIndex_act_flag)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00426">03_opt_system_inequalities.hpp:426</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1square__or__cube_1_1lifting__internal_html_ae8b192bf476ac8b9b8aa23671e98bc84"><div class="ttname"><a href="../../d7/d7b/classfemus_1_1ctrl_1_1square__or__cube_1_1lifting__internal.html#ae8b192bf476ac8b9b8aa23671e98bc84">femus::ctrl::square_or_cube::lifting_internal::ControlDomainFlag_internal_restriction</a></div><div class="ttdeci">static int ControlDomainFlag_internal_restriction(const std::vector&lt; double &gt; &amp;elem_center)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d54/square__or__cube__01b__control__faces__domain__elements_8hpp_source.html#l00089">square_or_cube_01b_control_faces_domain_elements.hpp:89</a></div></div>
<div class="ttc" id="aclassfemus_1_1elliptic_1_1lifting__external_html_a86be6466c20a785bfa63545d1536fae9"><div class="ttname"><a href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a86be6466c20a785bfa63545d1536fae9">femus::elliptic::lifting_external::find_control_boundary_nodes</a></div><div class="ttdeci">static bool find_control_boundary_nodes(std::vector&lt; unsigned int &gt; &amp;interface_node_flag, const std::vector&lt; double &gt; &amp;elem_center_bdry, const unsigned int nDofu_bdry, const unsigned int iel, const int jface, const Mesh *msh)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01949">opt_systems_elliptic_dirichlet.hpp:1949</a></div></div>
<div class="ttc" id="aclassfemus_1_1elliptic_1_1lifting__external_html_af0a9ccb75bf6f983cdb5f8573000a33c"><div class="ttname"><a href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">femus::elliptic::lifting_external::compute_coordinates_bdry_one_face</a></div><div class="ttdeci">static void compute_coordinates_bdry_one_face(std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_at_dofs_bdry, const int solType_coords, const unsigned int iel, const int jface, const Mesh *msh)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01927">opt_systems_elliptic_dirichlet.hpp:1927</a></div></div>
<div class="ttc" id="aclassfemus_1_1lifting__external_html_a3a29ef8490dc93fc0f45f5376e323a61"><div class="ttname"><a href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">femus::lifting_external::_neumann_adjoint_explicit</a></div><div class="ttdeci">static constexpr int _neumann_adjoint_explicit</div><div class="ttdef"><b>Definition</b> <a href="../../db/d91/01__opt__system_8hpp_source.html#l00060">01_opt_system.hpp:60</a></div></div>
<div class="ttc" id="aclassfemus_1_1lifting__external_html_a65401ffd4bdad0456d123751e028576a"><div class="ttname"><a href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">femus::lifting_external::_u_minus_q_strong</a></div><div class="ttdeci">static constexpr int _u_minus_q_strong</div><div class="ttdef"><b>Definition</b> <a href="../../db/d91/01__opt__system_8hpp_source.html#l00062">01_opt_system.hpp:62</a></div></div>
<div class="ttc" id="aclassfemus_1_1lifting__external_html_ad347558b2dc39abe98d8ff7ced798a3c"><div class="ttname"><a href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">femus::lifting_external::_neumann_adjoint_continuity_sign</a></div><div class="ttdeci">static constexpr int _neumann_adjoint_continuity_sign</div><div class="ttdef"><b>Definition</b> <a href="../../db/d91/01__opt__system_8hpp_source.html#l00061">01_opt_system.hpp:61</a></div></div>
<div class="ttc" id="aelliptic__nonlin__param_8hpp_html_a4b681eb6859b04812f86861be922c517"><div class="ttname"><a href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a4b681eb6859b04812f86861be922c517">INEQ_FLAG</a></div><div class="ttdeci">#define INEQ_FLAG</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d47/elliptic__nonlin__param_8hpp_source.html#l00017">elliptic_nonlin_param.hpp:17</a></div></div>
<div class="ttc" id="aelliptic__nonlin__param_8hpp_html_a516ea8ebb0823e8c37feff8f4fe5afd1"><div class="ttname"><a href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a516ea8ebb0823e8c37feff8f4fe5afd1">BETA_CTRL_VOL</a></div><div class="ttdeci">#define BETA_CTRL_VOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d47/elliptic__nonlin__param_8hpp_source.html#l00013">elliptic_nonlin_param.hpp:13</a></div></div>
<div class="ttc" id="aelliptic__nonlin__param_8hpp_html_a90aa72cdc79d3af2036fdbb588d8c1d8"><div class="ttname"><a href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a90aa72cdc79d3af2036fdbb588d8c1d8">C_COMPL</a></div><div class="ttdeci">#define C_COMPL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d47/elliptic__nonlin__param_8hpp_source.html#l00018">elliptic_nonlin_param.hpp:18</a></div></div>
<div class="ttc" id="aelliptic__nonlin__param_8hpp_html_ab6042dc7aa551272ad555cac7a27efca"><div class="ttname"><a href="../../dc/d47/elliptic__nonlin__param_8hpp.html#ab6042dc7aa551272ad555cac7a27efca">ALPHA_CTRL_VOL</a></div><div class="ttdeci">#define ALPHA_CTRL_VOL</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d47/elliptic__nonlin__param_8hpp_source.html#l00012">elliptic_nonlin_param.hpp:12</a></div></div>
<div class="ttc" id="anamespacefemus_html_a58e58ec75c1599370f2636943a6f6c33"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a58e58ec75c1599370f2636943a6f6c33">femus::print_global_residual_jacobian</a></div><div class="ttdeci">void print_global_residual_jacobian(const bool print_algebra_global, const MultiLevelProblem &amp;ml_prob, const NonLinearImplicitSystem *mlPdeSys, LinearEquationSolver *pdeSys, NumericVector *RES, SparseMatrix *JAC, const unsigned iproc, const bool assembleMatrix)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2c/_assemble__useful__functions_8hpp_source.html#l00074">Assemble_useful_functions.hpp:74</a></div></div>
<div class="ttc" id="anamespacefemus_html_a83b704b37aa1188e8719918bef34ca1a"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a83b704b37aa1188e8719918bef34ca1a">femus::el_dofs_unknowns_vol</a></div><div class="ttdeci">void el_dofs_unknowns_vol(const Solution *sol, const Mesh *msh, const LinearEquationSolver *pdeSys, const unsigned int iel, const std::vector&lt; unsigned &gt; &amp;SolFEType, const std::vector&lt; unsigned &gt; &amp;SolIndex, const std::vector&lt; unsigned &gt; &amp;SolPdeIndex, std::vector&lt; unsigned &gt; &amp;Sol_n_el_dofs, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;sol_eldofs, std::vector&lt; std::vector&lt; int &gt; &gt; &amp;L2G_dofmap)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d2c/_assemble__useful__functions_8hpp_source.html#l00042">Assemble_useful_functions.hpp:42</a></div></div>
<div class="ttc" id="aparam_8hpp_html_ab3522889778a2c7dc1e90150a08c0d21"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a></div><div class="ttdeci">#define GROUP_INTERNAL</div><div class="ttdoc">‍********domain dependent -BEGIN</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0b/param_8hpp_source.html#l00184">param.hpp:184</a></div></div>
<div class="ttc" id="aparam_8hpp_html_acf7ddf5f7ed48e02b57e6573e82f53f4"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a></div><div class="ttdeci">#define GROUP_EXTERNAL</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0b/param_8hpp_source.html#l00185">param.hpp:185</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a20f4c4490bc8ecbdd1ffcb79acce6035"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdef"><b>Definition</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00026">solidopt_params.hpp:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0a9ccb75bf6f983cdb5f8573000a33c" name="af0a9ccb75bf6f983cdb5f8573000a33c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0a9ccb75bf6f983cdb5f8573000a33c">&#9670;&#160;</a></span>compute_coordinates_bdry_one_face()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void femus::elliptic::lifting_external::compute_coordinates_bdry_one_face </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>coords_at_dofs_bdry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>solType_coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>msh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01927">1927</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1927</span>                                                                                                                                                                                            {</div>
<div class="line"><span class="lineno"> 1928</span>    </div>
<div class="line"><span class="lineno"> 1929</span>     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = coords_at_dofs_bdry.size();</div>
<div class="line"><span class="lineno"> 1930</span>     </div>
<div class="line"><span class="lineno"> 1931</span>            <span class="keywordtype">unsigned</span> nDofx_bdry    = msh-&gt;GetElementFaceDofNumber(iel,jface,solType_coords);</div>
<div class="line"><span class="lineno"> 1932</span> </div>
<div class="line"><span class="lineno"> 1933</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno"> 1934</span>                coords_at_dofs_bdry[idim].resize(nDofx_bdry);</div>
<div class="line"><span class="lineno"> 1935</span>            }</div>
<div class="line"><span class="lineno"> 1936</span>            </div>
<div class="line"><span class="lineno"> 1937</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0; i &lt; nDofx_bdry; i++) {</div>
<div class="line"><span class="lineno"> 1938</span>                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, i);</div>
<div class="line"><span class="lineno"> 1939</span>                <span class="keywordtype">unsigned</span> iDof = msh-&gt;GetSolutionDof(i_vol, iel, solType_coords);</div>
<div class="line"><span class="lineno"> 1940</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno"> 1941</span>                    coords_at_dofs_bdry[idim][i]=(*msh-&gt;GetTopology()-&gt;_Sol[idim])(iDof);</div>
<div class="line"><span class="lineno"> 1942</span>                }</div>
<div class="line"><span class="lineno"> 1943</span>            }</div>
<div class="line"><span class="lineno"> 1944</span> </div>
<div class="line"><span class="lineno"> 1945</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a86be6466c20a785bfa63545d1536fae9" name="a86be6466c20a785bfa63545d1536fae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86be6466c20a785bfa63545d1536fae9">&#9670;&#160;</a></span>find_control_boundary_nodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool femus::elliptic::lifting_external::find_control_boundary_nodes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>interface_node_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_center_bdry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nDofu_bdry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>msh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01949">1949</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1949</span>                                                                                                                                                                                                                              {</div>
<div class="line"><span class="lineno"> 1950</span>   </div>
<div class="line"><span class="lineno"> 1951</span>       <span class="keyword">enum</span> begin_end {begin = 0, end};</div>
<div class="line"><span class="lineno"> 1952</span>       </div>
<div class="line"><span class="lineno"> 1953</span>      std::vector&lt; std::vector&lt;double&gt; &gt; coords_bdry_control_face(2);</div>
<div class="line"><span class="lineno"> 1954</span>   </div>
<div class="line"><span class="lineno"> 1955</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> be = 0; be &lt; 2; be++)  {</div>
<div class="line"><span class="lineno"> 1956</span>                       coords_bdry_control_face[be].resize(elem_center_bdry.size());</div>
<div class="line"><span class="lineno"> 1957</span>                        std::fill(coords_bdry_control_face[be].begin(), coords_bdry_control_face[be].end(), 0.);</div>
<div class="line"><span class="lineno"> 1958</span>                    }</div>
<div class="line"><span class="lineno"> 1959</span>                    </div>
<div class="line"><span class="lineno"> 1960</span>                    coords_bdry_control_face[begin][0] = 1.;</div>
<div class="line"><span class="lineno"> 1961</span>                    coords_bdry_control_face[end][0] = 1.;</div>
<div class="line"><span class="lineno"> 1962</span>                    coords_bdry_control_face[begin][1] = <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#a15d2f12bb5524968e0c6a8bcec8cc08e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MIN</a>;</div>
<div class="line"><span class="lineno"> 1963</span>                    coords_bdry_control_face[end][1] = <a class="code hl_define" href="../../d4/d0b/param_8hpp.html#a5ea340eac1c4a4fed28126e4d9d5c26e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MAX</a>;</div>
<div class="line"><span class="lineno"> 1964</span>                    </div>
<div class="line"><span class="lineno"> 1965</span>     </div>
<div class="line"><span class="lineno"> 1966</span>  <span class="keywordtype">bool</span> interface_elem_flag = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno"> 1967</span>            <span class="keyword">const</span> <span class="keywordtype">double</span> my_eps = 1.e-6;</div>
<div class="line"><span class="lineno"> 1968</span>            </div>
<div class="line"><span class="lineno"> 1969</span><span class="comment">//             if (elem_center_bdry[0] &gt; 1. - my_eps   &amp;&amp; elem_center_bdry[0] &lt; 1.   + my_eps  &amp;&amp;</span></div>
<div class="line"><span class="lineno"> 1970</span><span class="comment">//                     elem_center_bdry[1] &gt; 0. - my_eps &amp;&amp; elem_center_bdry[1] &lt; 1. + my_eps)</span></div>
<div class="line"><span class="lineno"> 1971</span>            <span class="keywordflow">if</span> (elem_center_bdry[0] &gt; coords_bdry_control_face[begin][0] - my_eps   &amp;&amp; elem_center_bdry[0] &lt; coords_bdry_control_face[end][0] + my_eps  &amp;&amp;</div>
<div class="line"><span class="lineno"> 1972</span>                elem_center_bdry[1] &gt; coords_bdry_control_face[begin][1] - my_eps   &amp;&amp; elem_center_bdry[1] &lt; coords_bdry_control_face[end][1] + my_eps)</div>
<div class="line"><span class="lineno"> 1973</span>            {</div>
<div class="line"><span class="lineno"> 1974</span>                </div>
<div class="line"><span class="lineno"> 1975</span>                std::cout &lt;&lt; <span class="stringliteral">&quot; bdry elem on interface with center &quot;</span> &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; elem_center_bdry[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; elem_center_bdry[1] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1976</span>                </div>
<div class="line"><span class="lineno"> 1977</span>             interface_elem_flag = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno"> 1978</span>                </div>
<div class="line"><span class="lineno"> 1979</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_bdry = 0; i_bdry &lt; nDofu_bdry; i_bdry++)  {</div>
<div class="line"><span class="lineno"> 1980</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, i_bdry);</div>
<div class="line"><span class="lineno"> 1981</span>                    interface_node_flag[i_vol] = 1;</div>
<div class="line"><span class="lineno"> 1982</span>                   }</div>
<div class="line"><span class="lineno"> 1983</span> </div>
<div class="line"><span class="lineno"> 1984</span> </div>
<div class="line"><span class="lineno"> 1985</span>               }</div>
<div class="line"><span class="lineno"> 1986</span> </div>
<div class="line"><span class="lineno"> 1987</span>      <span class="keywordflow">return</span> interface_elem_flag;</div>
<div class="line"><span class="lineno"> 1988</span>      </div>
<div class="line"><span class="lineno"> 1989</span>}</div>
<div class="ttc" id="aparam_8hpp_html_a15d2f12bb5524968e0c6a8bcec8cc08e"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#a15d2f12bb5524968e0c6a8bcec8cc08e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MIN</a></div><div class="ttdeci">#define SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MIN</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0b/param_8hpp_source.html#l00019">param.hpp:19</a></div></div>
<div class="ttc" id="aparam_8hpp_html_a5ea340eac1c4a4fed28126e4d9d5c26e"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#a5ea340eac1c4a4fed28126e4d9d5c26e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MAX</a></div><div class="ttdeci">#define SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MAX</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d0b/param_8hpp_source.html#l00020">param.hpp:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad347558b2dc39abe98d8ff7ced798a3c" name="ad347558b2dc39abe98d8ff7ced798a3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad347558b2dc39abe98d8ff7ced798a3c">&#9670;&#160;</a></span>_neumann_adjoint_continuity_sign</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int femus::lifting_external::_neumann_adjoint_continuity_sign = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html#l00061">61</a> of file <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html">01_opt_system.hpp</a>.</p>

</div>
</div>
<a id="a3a29ef8490dc93fc0f45f5376e323a61" name="a3a29ef8490dc93fc0f45f5376e323a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a29ef8490dc93fc0f45f5376e323a61">&#9670;&#160;</a></span>_neumann_adjoint_explicit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int femus::lifting_external::_neumann_adjoint_explicit = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html#l00060">60</a> of file <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html">01_opt_system.hpp</a>.</p>

</div>
</div>
<a id="a65401ffd4bdad0456d123751e028576a" name="a65401ffd4bdad0456d123751e028576a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65401ffd4bdad0456d123751e028576a">&#9670;&#160;</a></span>_u_minus_q_strong</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int femus::lifting_external::_u_minus_q_strong = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html#l00062">62</a> of file <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html">01_opt_system.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>D:/femusDoxygen/source/applications/010_OptimalControl/<a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/dea/namespacefemus.html">femus</a></li><li class="navelem"><a class="el" href="../../df/d9f/namespacefemus_1_1elliptic.html">elliptic</a></li><li class="navelem"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html">lifting_external</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
