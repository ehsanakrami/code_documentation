<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: femus::TimeLoop Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/d4d/classfemus_1_1_time_loop.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pub-attribs">Public Attributes</a> &#124;
<a href="../../d1/d19/classfemus_1_1_time_loop-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">femus::TimeLoop Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for femus::TimeLoop:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d4/d4d/classfemus_1_1_time_loop.png" usemap="#femus::TimeLoop_map" alt=""/>
  <map id="femus::TimeLoop_map" name="femus::TimeLoop_map">
<area href="../../d6/d47/classfemus_1_1_opt_loop.html" alt="femus::OptLoop" shape="rect" coords="0,56,105,80"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:aac3f2690b36557508358233b6f8d5811"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#aac3f2690b36557508358233b6f8d5811">TimeLoop</a> (<a class="el" href="../../d6/d0b/classfemus_1_1_files.html">Files</a> &amp;files_in, const <a class="el" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser</a>&lt; double &gt; &amp;map_in)</td></tr>
<tr class="memdesc:aac3f2690b36557508358233b6f8d5811"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor.  <br /></td></tr>
<tr class="separator:aac3f2690b36557508358233b6f8d5811"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abe6310cd4725d406263319502a7b8300"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#abe6310cd4725d406263319502a7b8300">~TimeLoop</a> ()</td></tr>
<tr class="separator:abe6310cd4725d406263319502a7b8300"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3ec24f18fc745fde4e5ac0a2c2da094f"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a3ec24f18fc745fde4e5ac0a2c2da094f">MGTimeStep</a> (const <a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> iter, <a class="el" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> *eqn) const</td></tr>
<tr class="memdesc:a3ec24f18fc745fde4e5ac0a2c2da094f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function controls the time step operations:  <br /></td></tr>
<tr class="separator:a3ec24f18fc745fde4e5ac0a2c2da094f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a08750efcce7382813ae3045385b2693f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a08750efcce7382813ae3045385b2693f">OneTimestepEqnLoop</a> (const <a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> delta_t_step_in, const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;eqnmap) const</td></tr>
<tr class="memdesc:a08750efcce7382813ae3045385b2693f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function performes all the Physics time step routines.  <br /></td></tr>
<tr class="separator:a08750efcce7382813ae3045385b2693f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae06941f0786b5a6f7b5311ed5a4ba352"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae06941f0786b5a6f7b5311ed5a4ba352">TransientLoop</a> (const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;eqnmap)</td></tr>
<tr class="separator:ae06941f0786b5a6f7b5311ed5a4ba352"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a53b79d45d92d144d50b640418cf9b36e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a53b79d45d92d144d50b640418cf9b36e">TransientSetup</a> (const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;eqnmap)</td></tr>
<tr class="separator:a53b79d45d92d144d50b640418cf9b36e"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a3fd317c7b76accfc11bc90ef28faa314"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a3fd317c7b76accfc11bc90ef28faa314">check_time_par</a> (<a class="el" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser</a>&lt; double &gt; &amp;time_in)</td></tr>
<tr class="separator:a3fd317c7b76accfc11bc90ef28faa314"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-attribs" name="pub-attribs"></a>
Public Attributes</h2></td></tr>
<tr class="memitem:ae9163945615963893a94d21a63084676"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d6/d0b/classfemus_1_1_files.html">Files</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a></td></tr>
<tr class="memdesc:ae9163945615963893a94d21a63084676"><td class="mdescLeft">&#160;</td><td class="mdescRight">Utils pointer.  <br /></td></tr>
<tr class="separator:ae9163945615963893a94d21a63084676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ad720cecced417ce134d55b54b2425d"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser</a>&lt; double &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a></td></tr>
<tr class="separator:a0ad720cecced417ce134d55b54b2425d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad4afef07e11923ccc8660b3ecb312021"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a></td></tr>
<tr class="separator:ad4afef07e11923ccc8660b3ecb312021"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a70b7f421b4428653119817938db3ad04"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a></td></tr>
<tr class="separator:a70b7f421b4428653119817938db3ad04"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af6baf9c8f64e06b6c185c4da894992a7"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#af6baf9c8f64e06b6c185c4da894992a7">_t_idx_final</a></td></tr>
<tr class="separator:af6baf9c8f64e06b6c185c4da894992a7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9a639404e384df4da36a2a0c71c589"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a2f9a639404e384df4da36a2a0c71c589">_time_final</a></td></tr>
<tr class="separator:a2f9a639404e384df4da36a2a0c71c589"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af353bddb15dfc34a47296817b4eff67a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#af353bddb15dfc34a47296817b4eff67a">_curr_t_idx</a></td></tr>
<tr class="separator:af353bddb15dfc34a47296817b4eff67a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a49814512e2f085c3ea0c85681861744a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html#a49814512e2f085c3ea0c85681861744a">_curr_time</a></td></tr>
<tr class="separator:a49814512e2f085c3ea0c85681861744a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00033">33</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>
</div><h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="aac3f2690b36557508358233b6f8d5811" name="aac3f2690b36557508358233b6f8d5811"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac3f2690b36557508358233b6f8d5811">&#9670;&#160;</a></span>TimeLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">femus::TimeLoop::TimeLoop </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/d0b/classfemus_1_1_files.html">Files</a> &amp;&#160;</td>
          <td class="paramname"><em>files_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>map_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Constructor. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html#l00053">53</a> of file <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html">TimeLoop.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   53</span>                                                                           :</div>
<div class="line"><span class="lineno">   54</span> <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>(files_in),</div>
<div class="line"><span class="lineno">   55</span> <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a>(map_in)   {</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span> <span class="comment">//inizialize</span></div>
<div class="line"><span class="lineno">   58</span>   <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>  = 0;</div>
<div class="line"><span class="lineno">   59</span>    <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a>  = 0.;</div>
<div class="line"><span class="lineno">   60</span> <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#af6baf9c8f64e06b6c185c4da894992a7">_t_idx_final</a> = 0;</div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a2f9a639404e384df4da36a2a0c71c589">_time_final</a> = 0.;</div>
<div class="line"><span class="lineno">   62</span> <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#af353bddb15dfc34a47296817b4eff67a">_curr_t_idx</a>  = 0;</div>
<div class="line"><span class="lineno">   63</span>  <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a49814512e2f085c3ea0c85681861744a">_curr_time</a>  = 0.;</div>
<div class="line"><span class="lineno">   64</span> </div>
<div class="line"><span class="lineno">   65</span>}</div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_a0ad720cecced417ce134d55b54b2425d"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">femus::TimeLoop::_timemap</a></div><div class="ttdeci">FemusInputParser&lt; double &gt; _timemap</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00039">TimeLoop.hpp:39</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_a2f9a639404e384df4da36a2a0c71c589"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#a2f9a639404e384df4da36a2a0c71c589">femus::TimeLoop::_time_final</a></div><div class="ttdeci">double _time_final</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00044">TimeLoop.hpp:44</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_a49814512e2f085c3ea0c85681861744a"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#a49814512e2f085c3ea0c85681861744a">femus::TimeLoop::_curr_time</a></div><div class="ttdeci">double _curr_time</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00047">TimeLoop.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_a70b7f421b4428653119817938db3ad04"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">femus::TimeLoop::_time_in</a></div><div class="ttdeci">double _time_in</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00042">TimeLoop.hpp:42</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_ad4afef07e11923ccc8660b3ecb312021"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">femus::TimeLoop::_t_idx_in</a></div><div class="ttdeci">uint _t_idx_in</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00041">TimeLoop.hpp:41</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_ae9163945615963893a94d21a63084676"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">femus::TimeLoop::_files</a></div><div class="ttdeci">Files &amp; _files</div><div class="ttdoc">Utils pointer.</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00038">TimeLoop.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_af353bddb15dfc34a47296817b4eff67a"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#af353bddb15dfc34a47296817b4eff67a">femus::TimeLoop::_curr_t_idx</a></div><div class="ttdeci">uint _curr_t_idx</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00046">TimeLoop.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_af6baf9c8f64e06b6c185c4da894992a7"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#af6baf9c8f64e06b6c185c4da894992a7">femus::TimeLoop::_t_idx_final</a></div><div class="ttdeci">uint _t_idx_final</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00043">TimeLoop.hpp:43</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abe6310cd4725d406263319502a7b8300" name="abe6310cd4725d406263319502a7b8300"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abe6310cd4725d406263319502a7b8300">&#9670;&#160;</a></span>~TimeLoop()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::TimeLoop::~TimeLoop </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00051">51</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   51</span>{};</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a3fd317c7b76accfc11bc90ef28faa314" name="a3fd317c7b76accfc11bc90ef28faa314"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fd317c7b76accfc11bc90ef28faa314">&#9670;&#160;</a></span>check_time_par()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::TimeLoop::check_time_par </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser</a>&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>time_in</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html#l00041">41</a> of file <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html">TimeLoop.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   41</span>                                                                {</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  <span class="keywordflow">if</span> (time_in.<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;initial_step&quot;</span>) &lt; 0.) {std::cout &lt;&lt; <span class="stringliteral">&quot; negative restart ;;;;;;;;;;;;;;;;;;;&quot;</span> &lt;&lt; std::endl  ; abort();}</div>
<div class="line"><span class="lineno">   44</span> </div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">   46</span>}</div>
<div class="ttc" id="aclassfemus_1_1_femus_input_parser_html_a317bdaac200e745334dcd436d39d2832"><div class="ttname"><a href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">femus::FemusInputParser::get</a></div><div class="ttdeci">const T get(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d19/_femus_input_parser_8hpp_source.html#l00095">FemusInputParser.hpp:95</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3ec24f18fc745fde4e5ac0a2c2da094f" name="a3ec24f18fc745fde4e5ac0a2c2da094f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3ec24f18fc745fde4e5ac0a2c2da094f">&#9670;&#160;</a></span>MGTimeStep()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double femus::TimeLoop::MGTimeStep </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>iter</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> *&#160;</td>
          <td class="paramname"><em>eqn_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function controls the time step operations: </p>
<p>AAAAAAA TODO I have to use this for the PENALTY METHOD!!! In general, it is safer to call both of them because you may fill both Ke and Fe in both and they are needed at all levels Basically, the single time step consists in ASSEMBLING + SOLVING </p>
<p>A0) Put x_old into x_oold</p>
<p>A) Assemblying</p>
<p>std::cout &lt;&lt; " $$$$$$$$$ Prepared A for all levels and b for the fine level $$$$$$" &lt;&lt; std::endl;</p>
<p>D) <a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> of the linear MGsystem</p>
<p>std::cout &lt;&lt; "$$$$$$$$$ Computed the x with the MG method $$$$$$$" &lt;&lt; std::endl;</p>
<p>E) Update of the old solution at the top Level</p>
<p>std::cout &lt;&lt; "$$$$$$$$$ Check the convergence $$$$$$$" &lt;&lt; std::endl;</p>

<p class="definition">Definition at line <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html#l00103">103</a> of file <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html">TimeLoop.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  103</span>                                                                     {</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>    std::cout  &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; Solving &quot;</span> &lt;&lt; eqn_in-&gt;name() &lt;&lt; <span class="stringliteral">&quot; , step &quot;</span> &lt;&lt; iter &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>        std::unique_ptr&lt;NumericVector&gt; _x_oold = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>();</div>
<div class="line"><span class="lineno">  108</span>        _x_oold-&gt;init(eqn_in-&gt;_dofmap._Dim[eqn_in-&gt;GetGridn()-1],<span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>);</div>
<div class="line"><span class="lineno">  109</span>        std::unique_ptr&lt;NumericVector&gt; _x_tmp = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>();</div>
<div class="line"><span class="lineno">  110</span>         _x_tmp-&gt;init(eqn_in-&gt;_dofmap._Dim[eqn_in-&gt;GetGridn()-1],<span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>);</div>
<div class="line"><span class="lineno">  111</span> </div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  114</span>    *(_x_oold) = *( eqn_in-&gt;_LinSolver[eqn_in-&gt;GetGridn()-1]-&gt;_EPSC );</div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>    std::clock_t <a class="code hl_variable" href="../../d4/da1/_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a>=std::clock();</div>
<div class="line"><span class="lineno">  119</span> </div>
<div class="line"><span class="lineno">  120</span>    </div>
<div class="line"><span class="lineno">  121</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> Level = 0 ; Level &lt; eqn_in-&gt;GetGridn(); Level++) {</div>
<div class="line"><span class="lineno">  122</span>        eqn_in-&gt;SetLevelToAssemble(Level);</div>
<div class="line"><span class="lineno">  123</span>        eqn_in-&gt;GetAssembleFunction()(eqn_in-&gt;GetMLProb());</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>        eqn_in-&gt;_LinSolver[Level]-&gt;_KK-&gt;close();</div>
<div class="line"><span class="lineno">  127</span>        <span class="keywordtype">double</span> ANorm = eqn_in-&gt;_LinSolver[Level]-&gt;_KK-&gt;l1_norm();</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span><span class="comment">//      _LinSolver[Level]-&gt;_KK-&gt;print_graphic(true); TODO should pass this true or false as a parameter</span></div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span>        std::cout &lt;&lt; <span class="stringliteral">&quot; ANorm l1 &quot;</span> &lt;&lt; Level &lt;&lt; <span class="stringliteral">&quot; &quot;</span>  &lt;&lt; ANorm  &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>        </div>
<div class="line"><span class="lineno">  134</span>    }</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    std::clock_t end_time=std::clock();</div>
<div class="line"><span class="lineno">  138</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; ================ Assembly time = &quot;</span> &lt;&lt; double(end_time- <a class="code hl_variable" href="../../d4/da1/_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a>) / CLOCKS_PER_SEC</div>
<div class="line"><span class="lineno">  139</span>              &lt;&lt; <span class="stringliteral">&quot; s &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>              </div>
<div class="line"><span class="lineno">  143</span><span class="comment">// The matrices R and P for all levels were already prepared at read-time</span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">// and they do not depend on  time (because no adaptive refinement is performed)</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">// They only depend on the nodes (dofs!)</span></div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span>              std::clock_t start_time_sol = std::clock();</div>
<div class="line"><span class="lineno">  150</span> </div>
<div class="line"><span class="lineno">  151</span>              </div>
<div class="line"><span class="lineno">  152</span>        eqn_in-&gt;MGSolve( <a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a8249cc70cbdc6be41371a7f9874f1142">LinearImplicitSystem::eps_lsolv</a>() );</div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span> </div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>        std::clock_t end_time_sol = std::clock();</div>
<div class="line"><span class="lineno">  157</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; ================ Solver time = &quot;</span> &lt;&lt; double(end_time_sol- start_time_sol) / CLOCKS_PER_SEC</div>
<div class="line"><span class="lineno">  158</span>              &lt;&lt; <span class="stringliteral">&quot; s &quot;</span>&lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>              </div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  165</span>    eqn_in-&gt;_LinSolver[eqn_in-&gt;GetGridn()-1]-&gt;_EPS-&gt;localize(*(eqn_in-&gt;_LinSolver[eqn_in-&gt;GetGridn()-1]-&gt;_EPSC));   <span class="comment">// x_old = x</span></div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>    </div>
<div class="line"><span class="lineno">  168</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;$$$$$$$$$ Updated the x_old solution $$$$$$$$$&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>    </div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>    _x_tmp-&gt;zero();</div>
<div class="line"><span class="lineno">  174</span>    _x_tmp-&gt;add(+1.,*(_x_oold));</div>
<div class="line"><span class="lineno">  175</span>    _x_tmp-&gt;add(-1.,*(eqn_in-&gt;_LinSolver[eqn_in-&gt;GetGridn()-1]-&gt;_EPSC));</div>
<div class="line"><span class="lineno">  176</span>    <span class="comment">// x_oold -x_old =actually= (x_old - x)</span></div>
<div class="line"><span class="lineno">  177</span>    <span class="comment">//(x must not be touched, as you print from it)</span></div>
<div class="line"><span class="lineno">  178</span>    <span class="comment">//x_oold must not be touched ! Because it&#39;s used later for UPDATING Becont!</span></div>
<div class="line"><span class="lineno">  179</span>    <span class="comment">//so you must create a temporary vector necessarily.</span></div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>    _x_tmp-&gt;close();</div>
<div class="line"><span class="lineno">  182</span>    <span class="keywordtype">double</span> deltax_norm = _x_tmp-&gt;l2_norm();</div>
<div class="line"><span class="lineno">  183</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; $$$$$$ &quot;</span> &lt;&lt; eqn_in-&gt;name() &lt;&lt; <span class="stringliteral">&quot; error l2 &quot;</span> &lt;&lt; deltax_norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  184</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; $$$$$$ &quot;</span> &lt;&lt; eqn_in-&gt;name() &lt;&lt; <span class="stringliteral">&quot; error linfty &quot;</span> &lt;&lt; _x_tmp-&gt;linfty_norm() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  185</span><span class="comment">//AAA when the vectors have nan&#39;s, the norm becomes zero!</span></div>
<div class="line"><span class="lineno">  186</span><span class="comment">//when the residual norm in pre and post smoothing is too big,</span></div>
<div class="line"><span class="lineno">  187</span><span class="comment">//then it doesnt do any iterations, the solver doesnt solve anymore, so the solution remains frozen</span></div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordflow">return</span> deltax_norm;  <span class="comment">//TODO do we have to be based on l2norm or linfty norm???</span></div>
<div class="line"><span class="lineno">  190</span>}</div>
<div class="ttc" id="a_l_e__zlevel__poster_8cpp_html_affc511ee6672968dd4a00f341600ed36"><div class="ttname"><a href="../../d4/da1/_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a></div><div class="ttdeci">clock_t start_time</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da1/_l_e__zlevel__poster_8cpp_source.html#l00044">LE_zlevel_poster.cpp:44</a></div></div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a></div><div class="ttdeci">@ SERIAL</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00006">ParalleltypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_type_defs_and_type_casts_8hpp_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d37/_type_defs_and_type_casts_8hpp_source.html#l00012">TypeDefsAndTypeCasts.hpp:12</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a8249cc70cbdc6be41371a7f9874f1142"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a8249cc70cbdc6be41371a7f9874f1142">femus::LinearImplicitSystem::eps_lsolv</a></div><div class="ttdeci">static constexpr double eps_lsolv()</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00276">LinearImplicitSystem.hpp:276</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_aa554690df717f373d2b51e564fc421d6"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">femus::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector &gt; build(const SolverPackage solver_package=LSOLVER)</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbc/_numeric_vector_8cpp_source.html#l00036">NumericVector.cpp:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a08750efcce7382813ae3045385b2693f" name="a08750efcce7382813ae3045385b2693f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a08750efcce7382813ae3045385b2693f">&#9670;&#160;</a></span>OneTimestepEqnLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::TimeLoop::OneTimestepEqnLoop </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>&#160;</td>
          <td class="paramname"><em>delta_t_step_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>eqnmap</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function performes all the Physics time step routines. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html#l00195">195</a> of file <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html">TimeLoop.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  197</span>                                            {</div>
<div class="line"><span class="lineno">  198</span>    <span class="comment">// loop for time steps</span></div>
<div class="line"><span class="lineno">  199</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#ac9198f98c0374b5d00fe95e70685aed9">MultiLevelProblem::const_system_iterator</a> eqn = eqnmap.begin(); eqn != eqnmap.end(); eqn++)  {</div>
<div class="line"><span class="lineno">  200</span>        SystemTwo* equation = <span class="keyword">static_cast&lt;</span>SystemTwo*<span class="keyword">&gt;</span>(eqn-&gt;second);</div>
<div class="line"><span class="lineno">  201</span>        <a class="code hl_function" href="../../d4/d4d/classfemus_1_1_time_loop.html#a3ec24f18fc745fde4e5ac0a2c2da094f">MGTimeStep</a>(delta_t_step_in,equation);</div>
<div class="line"><span class="lineno">  202</span>    }</div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  204</span>}</div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_ac9198f98c0374b5d00fe95e70685aed9"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#ac9198f98c0374b5d00fe95e70685aed9">femus::MultiLevelProblem::const_system_iterator</a></div><div class="ttdeci">std::map&lt; std::string, System * &gt;::const_iterator const_system_iterator</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00315">MultiLevelProblem.hpp:315</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_a3ec24f18fc745fde4e5ac0a2c2da094f"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#a3ec24f18fc745fde4e5ac0a2c2da094f">femus::TimeLoop::MGTimeStep</a></div><div class="ttdeci">double MGTimeStep(const uint iter, SystemTwo *eqn) const</div><div class="ttdoc">This function controls the time step operations:</div><div class="ttdef"><b>Definition</b> <a href="../../d3/df0/_time_loop_8cpp_source.html#l00103">TimeLoop.cpp:103</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae06941f0786b5a6f7b5311ed5a4ba352" name="ae06941f0786b5a6f7b5311ed5a4ba352"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae06941f0786b5a6f7b5311ed5a4ba352">&#9670;&#160;</a></span>TransientLoop()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::TimeLoop::TransientLoop </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>eqnmap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html#l00364">364</a> of file <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html">TimeLoop.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  364</span>                                                              {</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>    <span class="comment">//  parameters</span></div>
<div class="line"><span class="lineno">  367</span>    <span class="keywordtype">double</span>         <a class="code hl_variable" href="../../d4/d3f/090___s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a>.<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;dt&quot;</span>);</div>
<div class="line"><span class="lineno">  368</span>    <span class="keywordtype">int</span> print_step =    <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a>.<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;printstep&quot;</span>);</div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span>    <span class="keywordtype">double</span> curr_time = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a>;  <span class="comment">//initialize current time</span></div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> curr_step = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a> + 1; curr_step &lt;= <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#af6baf9c8f64e06b6c185c4da894992a7">_t_idx_final</a>; curr_step++) {</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>        curr_time += <a class="code hl_variable" href="../../d4/d3f/090___s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><span class="lineno">  375</span>        <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a49814512e2f085c3ea0c85681861744a">_curr_time</a>  = curr_time;</div>
<div class="line"><span class="lineno">  376</span> </div>
<div class="line"><span class="lineno">  377</span> </div>
<div class="line"><span class="lineno">  378</span>        std::clock_t  <a class="code hl_variable" href="../../d4/da1/_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a>=std::clock();</div>
<div class="line"><span class="lineno">  379</span> </div>
<div class="line"><span class="lineno">  380</span>        </div>
<div class="line"><span class="lineno">  381</span>        <span class="comment">// set up the time step</span></div>
<div class="line"><span class="lineno">  382</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;\n  ** Solving time step &quot;</span> &lt;&lt; curr_step</div>
<div class="line"><span class="lineno">  383</span>                  &lt;&lt; <span class="stringliteral">&quot;, time = &quot;</span>                 &lt;&lt; curr_time  &lt;&lt; <span class="stringliteral">&quot; ***&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>        <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> delta_t_step = curr_step - <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>;</div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>        <span class="comment">//  time step for each system, without printing (good)</span></div>
<div class="line"><span class="lineno">  389</span>        <a class="code hl_function" href="../../d4/d4d/classfemus_1_1_time_loop.html#a08750efcce7382813ae3045385b2693f">OneTimestepEqnLoop</a>(delta_t_step,eqnmap);</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>        std::clock_t    end_time=std::clock();</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>        </div>
<div class="line"><span class="lineno">  395</span>        <span class="comment">// print solution</span></div>
<div class="line"><span class="lineno">  396</span>        <span class="keywordflow">if</span> (delta_t_step%print_step == 0) XDMFWriter::PrintSolLinear(<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),curr_step,curr_time,eqnmap);   <span class="comment">//print sol.N.h5 and sol.N.xmf</span></div>
<div class="line"><span class="lineno">  397</span> </div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>        std::clock_t    end_time2=std::clock();</div>
<div class="line"><span class="lineno">  401</span>        std::cout &lt;&lt;<span class="stringliteral">&quot; Time solver -----&gt;= &quot;</span>   &lt;&lt; double(end_time- <a class="code hl_variable" href="../../d4/da1/_l_e__zlevel__poster_8cpp.html#affc511ee6672968dd4a00f341600ed36">start_time</a>)/ CLOCKS_PER_SEC</div>
<div class="line"><span class="lineno">  402</span>                  &lt;&lt;<span class="stringliteral">&quot; Time printing -----&gt;= &quot;</span> &lt;&lt; double(end_time2- end_time) / CLOCKS_PER_SEC &lt;&lt;</div>
<div class="line"><span class="lineno">  403</span>                  std::endl;</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>                  </div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    }   <span class="comment">// end time loop</span></div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  410</span>}</div>
<div class="ttc" id="a090___s_w_2ex3_2ex3_8cpp_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="../../d4/d3f/090___s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d3f/090___s_w_2ex3_2ex3_8cpp_source.html#l00042">ex3.cpp:42</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00110">Files.hpp:110</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html_a08750efcce7382813ae3045385b2693f"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html#a08750efcce7382813ae3045385b2693f">femus::TimeLoop::OneTimestepEqnLoop</a></div><div class="ttdeci">void OneTimestepEqnLoop(const uint delta_t_step_in, const MultiLevelProblem &amp;eqnmap) const</div><div class="ttdoc">This function performes all the Physics time step routines.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/df0/_time_loop_8cpp_source.html#l00195">TimeLoop.cpp:195</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a53b79d45d92d144d50b640418cf9b36e" name="a53b79d45d92d144d50b640418cf9b36e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a53b79d45d92d144d50b640418cf9b36e">&#9670;&#160;</a></span>TransientSetup()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void femus::TimeLoop::TransientSetup </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>eqnmap</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html#l00210">210</a> of file <a class="el" href="../../d3/df0/_time_loop_8cpp_source.html">TimeLoop.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  210</span>                                                               {</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> initial_step = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a>.<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;initial_step&quot;</span>);</div>
<div class="line"><span class="lineno">  213</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ndigits      = XDMFWriter::n_digits_step_print;</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="keyword">const</span> std::string   lastrun_f =  <a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a2387b21fe7ccbae6de9374c2dd0d0610">Files::run_to_restart_from_string</a>();</div>
<div class="line"><span class="lineno">  216</span>    <span class="keyword">const</span> std::string     basesol = XDMFWriter::_solution_basename;</div>
<div class="line"><span class="lineno">  217</span>    <span class="keyword">const</span> std::string    ext_xdmf = XDMFWriter::_xdmf_extension;</div>
<div class="line"><span class="lineno">  218</span>    <span class="keyword">const</span> std::string      ext_h5 = XDMFWriter::_hdf5_extension;</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="keyword">const</span> std::string    basecase = XDMFWriter::_case_basename;</div>
<div class="line"><span class="lineno">  221</span>    <span class="keyword">const</span> std::string    basemesh = XDMFWriter::_mesh_basename;</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span><span class="comment">//now, every run, restart or not, has a new output dir.</span></div>
<div class="line"><span class="lineno">  225</span><span class="comment">//So, if you restart, you have to copy sol.N.h5 and sol.N.xmf</span></div>
<div class="line"><span class="lineno">  226</span><span class="comment">//to the new output directory</span></div>
<div class="line"><span class="lineno">  227</span><span class="comment">//just a raw copy, nothing more, because the file paths in sol.N.xmf</span></div>
<div class="line"><span class="lineno">  228</span><span class="comment">// DO NOT DEPEND ON THE OUTPUTDIR, only on the INPUT_DIR for now.</span></div>
<div class="line"><span class="lineno">  229</span><span class="comment">//the problem is that you have to know the PREVIOUS output_dir</span></div>
<div class="line"><span class="lineno">  230</span><span class="comment">// to automatically copy the files...</span></div>
<div class="line"><span class="lineno">  231</span><span class="comment">//let us just try by hand now...no we cant, because we will not know</span></div>
<div class="line"><span class="lineno">  232</span><span class="comment">// the NEW output_dir...</span></div>
<div class="line"><span class="lineno">  233</span><span class="comment">//We have to find a way to keep track of the PREVIOUS output dir.</span></div>
<div class="line"><span class="lineno">  234</span><span class="comment">//--- use a shell variable. $femus_last_run</span></div>
<div class="line"><span class="lineno">  235</span><span class="comment">//SORRY, BUT YOU CANT DO THAT!</span></div>
<div class="line"><span class="lineno">  236</span><span class="comment">// A process cannot export to parent processes.</span></div>
<div class="line"><span class="lineno">  237</span><span class="comment">// So the solution will be to print a very small file, called</span></div>
<div class="line"><span class="lineno">  238</span><span class="comment">// femus_last_run,that contains the name of the last output dir.</span></div>
<div class="line"><span class="lineno">  239</span> </div>
<div class="line"><span class="lineno">  240</span><span class="comment">//We know the NEW one at this point because we constructed it.</span></div>
<div class="line"><span class="lineno">  241</span><span class="comment">// Well, we put them in the main output and read from there.</span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">//So you see once more that it is important to make the difference</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment">// between the BASE_OUTPUT and the OVERALL_OUTPUT paths</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">//We will distinguish them later.</span></div>
<div class="line"><span class="lineno">  245</span> </div>
<div class="line"><span class="lineno">  246</span>    <span class="comment">//------initial data</span></div>
<div class="line"><span class="lineno">  247</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a1f3ce268d1166a56a3e3829324a6a2a5">GetRestartFlag</a>()) {</div>
<div class="line"><span class="lineno">  248</span>        <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>  = initial_step;</div>
<div class="line"><span class="lineno">  249</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;We wish to restart from time step &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  250</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;\n *+*+* TimeLoop::transient_setup: RESTART  &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>        <span class="keywordflow">if</span> (<a class="code hl_function" href="../../db/ded/namespacefemus_1_1_parallel.html#a112449ab6b32f2d8f562427b9fa960ab">Parallel::get_rank</a>() == 0) {</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>            std::stringstream tidxin;</div>
<div class="line"><span class="lineno">  256</span>            tidxin &lt;&lt; std::setw(ndigits) &lt;&lt; std::setfill(<span class="charliteral">&#39;0&#39;</span>) &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>;</div>
<div class="line"><span class="lineno">  257</span>            std::cout &lt;&lt; <span class="stringliteral">&quot; Restarting from run: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a645fc759501fc3869941f05d916b80e0">GetInputPath</a>() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  258</span>            std::ostringstream cp_src_xmf_stream;</div>
<div class="line"><span class="lineno">  259</span>            cp_src_xmf_stream &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a645fc759501fc3869941f05d916b80e0">GetInputPath</a>() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; basesol &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tidxin.str() &lt;&lt; <span class="stringliteral">&quot;_l&quot;</span> &lt;&lt; (eqnmap.GetMeshTwo()._NoLevels - 1) &lt;&lt; ext_xdmf;</div>
<div class="line"><span class="lineno">  260</span>            std::string cp_src_xmf = cp_src_xmf_stream.str();</div>
<div class="line"><span class="lineno">  261</span>            std::fstream file_cp_xmf(cp_src_xmf.c_str());</div>
<div class="line"><span class="lineno">  262</span>            <span class="keywordflow">if</span> (!file_cp_xmf.is_open()) {</div>
<div class="line"><span class="lineno">  263</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;No xmf file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  264</span>                abort();</div>
<div class="line"><span class="lineno">  265</span>            }</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span>            std::ostringstream cp_src_h5_stream;</div>
<div class="line"><span class="lineno">  268</span>            cp_src_h5_stream &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a645fc759501fc3869941f05d916b80e0">GetInputPath</a>() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; basesol &lt;&lt; <span class="stringliteral">&quot;.&quot;</span> &lt;&lt; tidxin.str() <span class="comment">/*&lt;&lt; &quot;_l&quot; &lt;&lt; (_mesh._NoLevels - 1)*/</span> &lt;&lt; ext_h5;</div>
<div class="line"><span class="lineno">  269</span>            std::string cp_src_h5 = cp_src_h5_stream.str();</div>
<div class="line"><span class="lineno">  270</span>            std::fstream file_cp_h5(cp_src_h5.c_str());</div>
<div class="line"><span class="lineno">  271</span>            <span class="keywordflow">if</span> (!file_cp_h5.is_open()) {</div>
<div class="line"><span class="lineno">  272</span>                std::cout &lt;&lt; <span class="stringliteral">&quot;No h5 file&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  273</span>                abort();</div>
<div class="line"><span class="lineno">  274</span>            }</div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span>            std::string cp_dest_dir = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>();</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>            std::string cp_cmd_xmf = <span class="stringliteral">&quot;cp &quot;</span> + cp_src_xmf  + <span class="stringliteral">&quot; &quot;</span> +  cp_dest_dir;</div>
<div class="line"><span class="lineno">  279</span>            std::string cp_cmd_h5  = <span class="stringliteral">&quot;cp &quot;</span> + cp_src_h5   + <span class="stringliteral">&quot; &quot;</span> +  cp_dest_dir;</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>            std::cout &lt;&lt; <span class="stringliteral">&quot;Copying the two restart files to the NEW output directory created before&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  282</span>            <span class="comment">//you should first check that sol.N.xmf and sol.N.h5 are there</span></div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span>            std::cout &lt;&lt;cp_cmd_xmf       &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  285</span>            std::cout &lt;&lt;cp_cmd_h5  &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  286</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> sys_out  = system(cp_cmd_xmf.c_str() );</div>
<div class="line"><span class="lineno">  287</span>            <span class="keyword">const</span> <span class="keywordtype">int</span> sys_out2 = system(cp_cmd_h5.c_str() );</div>
<div class="line"><span class="lineno">  288</span> </div>
<div class="line"><span class="lineno">  289</span>            <span class="comment">//TODO why did I not the CopyFile function from Files?</span></div>
<div class="line"><span class="lineno">  290</span>        }</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span><span class="comment">//here you should wait so that you are sure that sol.N.xmf and sol.N.h5 have been copied to the new directory</span></div>
<div class="line"><span class="lineno">  293</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;***** Barrier so that all the processors have the sol.N.xmf and sol.N.h5 to read from&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  294</span><span class="preprocessor">#ifdef HAVE_MPI</span></div>
<div class="line"><span class="lineno">  295</span>        MPI_Barrier(MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  296</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  297</span> </div>
<div class="line"><span class="lineno">  298</span><span class="comment">//now the question arises: if to restart,you need to re-read the sol. files,</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">//you will also need to</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">// - COPY the mesh.h5 and mesh_conn_lin.h5 (you can avoid regenerating them) (and also mesh.xmf to be able to read them)</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">// - COPY the MG OPERATORS (if you have them in your run) if you keep the same number of levels</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">//The rule is: what is connected to the PROBLEM to be solved (DOMAIN, BC&#39;s) should be:</span></div>
<div class="line"><span class="lineno">  303</span>        <span class="comment">// LEVEL INDEPENDENT</span></div>
<div class="line"><span class="lineno">  304</span>        <span class="comment">//PROCESSOR INDEPENDENT</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">//An appropriate RESTART of the solution of a problem should be</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">//INDEPENDENT of the METHOD to SOLVE the PROBLEM (multigrid or not, parallel computing or not...)</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">//So the files for the DOMAIN and the BOUNDARY CONDITIONS should reflect that.</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">// e.g. consider mesh.h5 and case.h5</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">//given some FINE DISCRETIZATION (I dont consider the case of RESTARTING with a DIFFERENT FINE discretization...</span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">//then during the run one might do adaptive mesh, but this is another thing... ),</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">//some parts of them are good for a SPECIFIC NOLEVELS or a SPECIFIC NO_PROCESSORS</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">//while others, IN PARTICULAR THOSE THAT ARE NECESSARY FOR RESTART, must be INDEPENDENT OF THAT.</span></div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>        XDMFWriter::ReadSol(<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>,<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a>,eqnmap); <span class="comment">//read  sol.N.h5 and sol.N.xmf</span></div>
<div class="line"><span class="lineno">  315</span>        <span class="comment">//AAA: here _t_idx_in is intent in, _time_in is intent out</span></div>
<div class="line"><span class="lineno">  316</span>        <span class="comment">//reading files can be done in parallel with no problems</span></div>
<div class="line"><span class="lineno">  317</span>        <span class="comment">//well, not really... reading can be done if you are sure that the file is there at the moment you call to read it</span></div>
<div class="line"><span class="lineno">  318</span>        <span class="comment">//so let&#39;s put this inside procid=0 .... NO, THIS READ IS DONE IN PARALLEL!</span></div>
<div class="line"><span class="lineno">  319</span> </div>
<div class="line"><span class="lineno">  320</span>    }</div>
<div class="line"><span class="lineno">  321</span> </div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  324</span>        <span class="comment">//Set up initial time step index and time value</span></div>
<div class="line"><span class="lineno">  325</span>        <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a> = 0;                            <span class="comment">//time step index</span></div>
<div class="line"><span class="lineno">  326</span>        <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a> = 0.;                           <span class="comment">//time absolute value</span></div>
<div class="line"><span class="lineno">  327</span> </div>
<div class="line"><span class="lineno">  328</span>        XDMFWriter::PrintSolLinear(<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>,<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a>,eqnmap);  <span class="comment">//print sol.0.h5 and sol.0.xmf</span></div>
<div class="line"><span class="lineno">  329</span>        <span class="comment">//AAA: here _t_idx_in is intent-in, and also _time_in is intent-in</span></div>
<div class="line"><span class="lineno">  330</span>    }</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\nInitial time index: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a></div>
<div class="line"><span class="lineno">  333</span>              &lt;&lt; <span class="stringliteral">&quot;, Initial time value: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>    <span class="comment">//-------final data</span></div>
<div class="line"><span class="lineno">  336</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> nsteps       = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a>.<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;nsteps&quot;</span>);</div>
<div class="line"><span class="lineno">  337</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d4/d3f/090___s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>        = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a>.<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;dt&quot;</span>);</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>    <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#af6baf9c8f64e06b6c185c4da894992a7">_t_idx_final</a> = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a> + nsteps;</div>
<div class="line"><span class="lineno">  340</span>    <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a2f9a639404e384df4da36a2a0c71c589">_time_final</a>  = <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a70b7f421b4428653119817938db3ad04">_time_in</a> + nsteps*<a class="code hl_variable" href="../../d4/d3f/090___s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\nFinal time index: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#af6baf9c8f64e06b6c185c4da894992a7">_t_idx_final</a></div>
<div class="line"><span class="lineno">  343</span>              &lt;&lt; <span class="stringliteral">&quot;, Final time value: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a2f9a639404e384df4da36a2a0c71c589">_time_final</a></div>
<div class="line"><span class="lineno">  344</span>              &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>    <span class="comment">//now you can update last_run with new_run for a following run</span></div>
<div class="line"><span class="lineno">  347</span>    <span class="comment">//well,actually before putting the last_run you should be sure that this run was completely finished.</span></div>
<div class="line"><span class="lineno">  348</span>    <span class="comment">//That is why I&#39;d better put this call at the end of the main program</span></div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span><span class="comment">//------- print</span></div>
<div class="line"><span class="lineno">  351</span>    <span class="comment">//this happens when the output dir is already set</span></div>
<div class="line"><span class="lineno">  352</span>    <span class="comment">//at this point this is already true</span></div>
<div class="line"><span class="lineno">  353</span>    XDMFWriter::PrintCaseLinear(<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>,eqnmap);       <span class="comment">//print caseN.xmf&amp;h5 = IC + BC flags</span></div>
<div class="line"><span class="lineno">  354</span>    XDMFWriter::transient_print_xmf(<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ae9163945615963893a94d21a63084676">_files</a>.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#ad4afef07e11923ccc8660b3ecb312021">_t_idx_in</a>,<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#af6baf9c8f64e06b6c185c4da894992a7">_t_idx_final</a>,<a class="code hl_variable" href="../../d4/d4d/classfemus_1_1_time_loop.html#a0ad720cecced417ce134d55b54b2425d">_timemap</a>.<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;printstep&quot;</span>),eqnmap.GetMeshTwo()._NoLevels); <span class="comment">//print timeN.xmf</span></div>
<div class="line"><span class="lineno">  355</span> </div>
<div class="line"><span class="lineno">  356</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  357</span>}</div>
<div class="ttc" id="aclassfemus_1_1_files_html_a1f3ce268d1166a56a3e3829324a6a2a5"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a1f3ce268d1166a56a3e3829324a6a2a5">femus::Files::GetRestartFlag</a></div><div class="ttdeci">bool GetRestartFlag() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00152">Files.hpp:152</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_a2387b21fe7ccbae6de9374c2dd0d0610"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a2387b21fe7ccbae6de9374c2dd0d0610">femus::Files::run_to_restart_from_string</a></div><div class="ttdeci">static const std::string run_to_restart_from_string()</div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00147">Files.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_a645fc759501fc3869941f05d916b80e0"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a645fc759501fc3869941f05d916b80e0">femus::Files::GetInputPath</a></div><div class="ttdeci">std::string GetInputPath() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00074">Files.hpp:74</a></div></div>
<div class="ttc" id="anamespacefemus_1_1_parallel_html_a112449ab6b32f2d8f562427b9fa960ab"><div class="ttname"><a href="../../db/ded/namespacefemus_1_1_parallel.html#a112449ab6b32f2d8f562427b9fa960ab">femus::Parallel::get_rank</a></div><div class="ttdeci">int get_rank()</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dec/_parallel_8hpp_source.html#l00065">Parallel.hpp:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="af353bddb15dfc34a47296817b4eff67a" name="af353bddb15dfc34a47296817b4eff67a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af353bddb15dfc34a47296817b4eff67a">&#9670;&#160;</a></span>_curr_t_idx</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> femus::TimeLoop::_curr_t_idx</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00046">46</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<a id="a49814512e2f085c3ea0c85681861744a" name="a49814512e2f085c3ea0c85681861744a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a49814512e2f085c3ea0c85681861744a">&#9670;&#160;</a></span>_curr_time</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double femus::TimeLoop::_curr_time</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00047">47</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<a id="ae9163945615963893a94d21a63084676" name="ae9163945615963893a94d21a63084676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae9163945615963893a94d21a63084676">&#9670;&#160;</a></span>_files</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d6/d0b/classfemus_1_1_files.html">Files</a>&amp; femus::TimeLoop::_files</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utils pointer. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00038">38</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<a id="af6baf9c8f64e06b6c185c4da894992a7" name="af6baf9c8f64e06b6c185c4da894992a7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af6baf9c8f64e06b6c185c4da894992a7">&#9670;&#160;</a></span>_t_idx_final</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> femus::TimeLoop::_t_idx_final</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00043">43</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<a id="ad4afef07e11923ccc8660b3ecb312021" name="ad4afef07e11923ccc8660b3ecb312021"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad4afef07e11923ccc8660b3ecb312021">&#9670;&#160;</a></span>_t_idx_in</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> femus::TimeLoop::_t_idx_in</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00041">41</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<a id="a2f9a639404e384df4da36a2a0c71c589" name="a2f9a639404e384df4da36a2a0c71c589"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9a639404e384df4da36a2a0c71c589">&#9670;&#160;</a></span>_time_final</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double femus::TimeLoop::_time_final</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00044">44</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<a id="a70b7f421b4428653119817938db3ad04" name="a70b7f421b4428653119817938db3ad04"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a70b7f421b4428653119817938db3ad04">&#9670;&#160;</a></span>_time_in</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double femus::TimeLoop::_time_in</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00042">42</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<a id="a0ad720cecced417ce134d55b54b2425d" name="a0ad720cecced417ce134d55b54b2425d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ad720cecced417ce134d55b54b2425d">&#9670;&#160;</a></span>_timemap</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser</a>&lt;double&gt; femus::TimeLoop::_timemap</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html#l00039">39</a> of file <a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>D:/femusDoxygen/source/src/08_equations/assemble/<a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a></li>
<li>D:/femusDoxygen/source/src/08_equations/assemble/<a class="el" href="../../d3/df0/_time_loop_8cpp_source.html">TimeLoop.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/dea/namespacefemus.html">femus</a></li><li class="navelem"><a class="el" href="../../d4/d4d/classfemus_1_1_time_loop.html">TimeLoop</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
