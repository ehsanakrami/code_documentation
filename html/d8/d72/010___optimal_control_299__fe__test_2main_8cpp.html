<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: D:/femusDoxygen/source/applications/010_OptimalControl/99_fe_test/main.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d8/d72/010___optimal_control_299__fe__test_2main_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">main.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &quot;FemusConfig.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/dec/_parallel_8hpp_source.html">Parallel.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d7c/_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d4e/_files_8hpp_source.html">Files.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d0c/_multi_level_mesh_two_8hpp_source.html">MultiLevelMeshTwo.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/db9/_gen_case_8hpp_source.html">GenCase.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp_source.html">FETypeEnum_deprecated.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/dbc/_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/dce/_multi_level_solution_8hpp_source.html">MultiLevelSolution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d37/_type_defs_and_type_casts_8hpp_source.html">TypeDefsAndTypeCasts.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d5f/_quantity_8hpp_source.html">Quantity.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df1/_box_8hpp_source.html">Box.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d1a/_x_d_m_f_writer_8hpp_source.html">XDMFWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/df8/99__fe__test_2_temp_quantities_8hpp_source.html">TempQuantities.hpp</a>&quot;</code><br />
</div>
<p><a href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8f96a52745858ba9cfe0f67b151d2de2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp.html#a8f96a52745858ba9cfe0f67b151d2de2">GenMatRhsT</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="memdesc:a8f96a52745858ba9cfe0f67b151d2de2"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function assembles the matrix and the rhs:  <br /></td></tr>
<tr class="separator:a8f96a52745858ba9cfe0f67b151d2de2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a8f96a52745858ba9cfe0f67b151d2de2" name="a8f96a52745858ba9cfe0f67b151d2de2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8f96a52745858ba9cfe0f67b151d2de2">&#9670;&#160;</a></span>GenMatRhsT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenMatRhsT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function assembles the matrix and the rhs: </p>

<p class="definition">Definition at line <a class="el" href="../../d8/d8c/02__elliptic__with__given__advection_2_eqn_t_8cpp_source.html#l00062">62</a> of file <a class="el" href="../../d8/d8c/02__elliptic__with__given__advection_2_eqn_t_8cpp_source.html">EqnT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   62</span>                                            {</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  <span class="comment">//if we are just a function not inside a class, we have to retrieve ourselves...</span></div>
<div class="line"><span class="lineno">   65</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; my_system = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_T&quot;</span>);</div>
<div class="line"><span class="lineno">   66</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Level = my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>();</div>
<div class="line"><span class="lineno">   67</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   68</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>          *mymsh          =  ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(Level);</div>
<div class="line"><span class="lineno">   69</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>          *myel           =  mymsh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a10501173ab167b815f14a69de37c0d2b">GetMeshElements</a>();</div>
<div class="line"><span class="lineno">   70</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> myproc  = mymsh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">   71</span>        </div>
<div class="line"><span class="lineno">   72</span>  </div>
<div class="line"><span class="lineno">   73</span>  <span class="comment">//======== ELEMENT MAPPING =======</span></div>
<div class="line"><span class="lineno">   74</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> space_dim =       ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">   75</span> </div>
<div class="line"><span class="lineno">   76</span>  <span class="comment">//====== reference values ========================</span></div>
<div class="line"><span class="lineno">   77</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> IRe = 1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Re&quot;</span>);</div>
<div class="line"><span class="lineno">   78</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> IPr = 1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Pr&quot;</span>);</div>
<div class="line"><span class="lineno">   79</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> alphaT  = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;alphaT&quot;</span>);</div>
<div class="line"><span class="lineno">   80</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> alphaL2 = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;alphaL2&quot;</span>);</div>
<div class="line"><span class="lineno">   81</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> alphaH1 = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;alphaH1&quot;</span>);</div>
<div class="line"><span class="lineno">   82</span>  </div>
<div class="line"><span class="lineno">   83</span>  <span class="comment">//==== AUXILIARY ==============</span></div>
<div class="line"><span class="lineno">   84</span>    std::vector&lt;double&gt; dphijdx_g(space_dim);</div>
<div class="line"><span class="lineno">   85</span>    std::vector&lt;double&gt; dphiidx_g(space_dim);</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">_LinSolver</a>[Level]-&gt;_KK-&gt;zero();</div>
<div class="line"><span class="lineno">   88</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">_LinSolver</a>[Level]-&gt;_RESC-&gt;zero();</div>
<div class="line"><span class="lineno">   89</span> </div>
<div class="line"><span class="lineno">   90</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   91</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   92</span> {<span class="comment">//BEGIN VOLUME</span></div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mesh_vb = <a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>;</div>
<div class="line"><span class="lineno">   95</span>   </div>
<div class="line"><span class="lineno">   96</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_b = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level];</div>
<div class="line"><span class="lineno">   97</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_e = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level+1];</div>
<div class="line"><span class="lineno">   98</span> </div>
<div class="line"><span class="lineno">   99</span>   </div>
<div class="line"><span class="lineno">  100</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> iel = 0; iel &lt; (nel_e - nel_b); iel++) {</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span><span class="comment">//   for (uint iel_two = nel_beg; iel_two &lt; nel_end; iel_two++) {</span></div>
<div class="line"><span class="lineno">  103</span>  </div>
<div class="line"><span class="lineno">  104</span>  <a class="code hl_class" href="../../d4/d0f/classfemus_1_1_current_elem.html">CurrentElem&lt;double&gt;</a>       currelem(iel,myproc,Level,<a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>,&amp;my_system,ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>(), NULL,mymsh);    </div>
<div class="line"><span class="lineno">  105</span>  <span class="comment">//   CurrentGaussPointBase &amp; currgp = //   CurrentGaussPointBase::build(currelem,ml_prob.GetQuadratureRule(currelem.GetDim()));</span></div>
<div class="line"><span class="lineno">  106</span>  </div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span><span class="comment">//=========INTERNAL QUANTITIES (unknowns of the equation) =========     </span></div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Tempold(currelem);</div>
<div class="line"><span class="lineno">  110</span>    Tempold._SolName = <span class="stringliteral">&quot;Qty_Temperature&quot;</span>;</div>
<div class="line"><span class="lineno">  111</span>    Tempold._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Temperature&quot;</span>); </div>
<div class="line"><span class="lineno">  112</span>    Tempold.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  113</span>    Tempold.Allocate();</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span><span class="comment">//====================================</span></div>
<div class="line"><span class="lineno">  116</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Tlift(currelem);</div>
<div class="line"><span class="lineno">  117</span>    Tlift._SolName = <span class="stringliteral">&quot;Qty_TempLift&quot;</span>;</div>
<div class="line"><span class="lineno">  118</span>    Tlift._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_TempLift&quot;</span>);</div>
<div class="line"><span class="lineno">  119</span>    Tlift.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  120</span>    Tlift.Allocate();</div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span><span class="comment">//=====================================</span></div>
<div class="line"><span class="lineno">  123</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> TAdj(currelem);</div>
<div class="line"><span class="lineno">  124</span>    TAdj._SolName = <span class="stringliteral">&quot;Qty_TempAdj&quot;</span>;</div>
<div class="line"><span class="lineno">  125</span>    TAdj._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_TempAdj&quot;</span>); </div>
<div class="line"><span class="lineno">  126</span>    TAdj.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  127</span>    TAdj.Allocate();</div>
<div class="line"><span class="lineno">  128</span>   </div>
<div class="line"><span class="lineno">  129</span><span class="comment">//=========EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">  130</span>    <span class="comment">//========= //DOMAIN MAPPING</span></div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> xyz(currelem);  <span class="comment">//no quantity</span></div>
<div class="line"><span class="lineno">  132</span>    xyz._dim      = space_dim;</div>
<div class="line"><span class="lineno">  133</span>    xyz._FEord    = <a class="code hl_define" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a>;</div>
<div class="line"><span class="lineno">  134</span>    xyz._ndof     = currelem.GetElemType(xyz._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">  135</span>    xyz.Allocate();</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <span class="comment">//==================</span></div>
<div class="line"><span class="lineno">  138</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> velX(currelem);</div>
<div class="line"><span class="lineno">  139</span>    velX._SolName = <span class="stringliteral">&quot;Qty_Velocity0&quot;</span>;</div>
<div class="line"><span class="lineno">  140</span>    velX._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>); </div>
<div class="line"><span class="lineno">  141</span>    velX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  142</span>    velX.Allocate();</div>
<div class="line"><span class="lineno">  143</span>    </div>
<div class="line"><span class="lineno">  144</span>  <span class="comment">//==================</span></div>
<div class="line"><span class="lineno">  145</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> velY(currelem);</div>
<div class="line"><span class="lineno">  146</span>    velY._SolName = <span class="stringliteral">&quot;Qty_Velocity1&quot;</span>;</div>
<div class="line"><span class="lineno">  147</span>    velY._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>); </div>
<div class="line"><span class="lineno">  148</span>    velY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  149</span>    velY.Allocate();    </div>
<div class="line"><span class="lineno">  150</span>    </div>
<div class="line"><span class="lineno">  151</span><span class="comment">//===============Tdes=====================</span></div>
<div class="line"><span class="lineno">  152</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Tdes(currelem);</div>
<div class="line"><span class="lineno">  153</span>    Tdes._SolName = <span class="stringliteral">&quot;Qty_TempDes&quot;</span>;</div>
<div class="line"><span class="lineno">  154</span>    Tdes._dim      = Tempold._dim;</div>
<div class="line"><span class="lineno">  155</span>    Tdes._FEord    = Tempold._FEord;</div>
<div class="line"><span class="lineno">  156</span>    Tdes._ndof     = Tempold._ndof;</div>
<div class="line"><span class="lineno">  157</span>    Tdes.Allocate();</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  </div>
<div class="line"><span class="lineno">  160</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">  161</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>    currelem.Mat().zero();</div>
<div class="line"><span class="lineno">  164</span>    currelem.Rhs().zero(); </div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span>    currelem.SetDofobjConnCoords();</div>
<div class="line"><span class="lineno">  167</span>    currelem.SetElDofsBc();</div>
<div class="line"><span class="lineno">  168</span>    </div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>  Tempold.GetElemDofs();</div>
<div class="line"><span class="lineno">  171</span>    Tlift.GetElemDofs();</div>
<div class="line"><span class="lineno">  172</span>     TAdj.GetElemDofs();</div>
<div class="line"><span class="lineno">  173</span>     </div>
<div class="line"><span class="lineno">  174</span>     velX.GetElemDofs();</div>
<div class="line"><span class="lineno">  175</span>     velY.GetElemDofs();</div>
<div class="line"><span class="lineno">  176</span>   </div>
<div class="line"><span class="lineno">  177</span>     <a class="code hl_function" href="../../d8/dea/namespacefemus.html#a456d791a719bf9eb4c58b2826f8eac68">TempDesired</a>(Tdes,currelem);</div>
<div class="line"><span class="lineno">  178</span>     </div>
<div class="line"><span class="lineno">  179</span>    currelem.ConvertElemCoordsToMappingOrd(xyz);</div>
<div class="line"><span class="lineno">  180</span>    xyz.SetElemAverage();</div>
<div class="line"><span class="lineno">  181</span>    <span class="keywordtype">int</span> domain_flag = <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ab28051e8fceaf9b05bfae63a6522fdc4">ElFlagControl</a>(xyz._el_average,ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>);</div>
<div class="line"><span class="lineno">  182</span><span class="comment">//====================    </span></div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> el_ngauss = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno">  185</span>   </div>
<div class="line"><span class="lineno">  186</span>   <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qp=0; qp&lt; el_ngauss; qp++) {</div>
<div class="line"><span class="lineno">  187</span> </div>
<div class="line"><span class="lineno">  188</span><span class="comment">//======= &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  189</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)   { </div>
<div class="line"><span class="lineno">  190</span><span class="comment">//   currgp.SetPhiElDofsFEVB_g (fe,qp);</span></div>
<div class="line"><span class="lineno">  191</span><span class="comment">//   currgp.SetDPhiDxezetaElDofsFEVB_g (fe,qp); </span></div>
<div class="line"><span class="lineno">  192</span>}</div>
<div class="line"><span class="lineno">  193</span>          </div>
<div class="line"><span class="lineno">  194</span><span class="keyword">const</span> <span class="keywordtype">double</span>      det = 1.; <span class="comment">//currgp.JacVectVV_g(xyz);</span></div>
<div class="line"><span class="lineno">  195</span><span class="keyword">const</span> <span class="keywordtype">double</span> dtxJxW_g = det*ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">GetGaussWeight</a>(qp);</div>
<div class="line"><span class="lineno">  196</span><span class="keyword">const</span> <span class="keywordtype">double</span>     detb = det/el_ngauss;</div>
<div class="line"><span class="lineno">  197</span>          </div>
<div class="line"><span class="lineno">  198</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     { </div>
<div class="line"><span class="lineno">  199</span><span class="comment">//   currgp.SetDPhiDxyzElDofsFEVB_g   (fe,qp);</span></div>
<div class="line"><span class="lineno">  200</span><span class="comment">//   currgp.ExtendDphiDxyzElDofsFEVB_g(fe);</span></div>
<div class="line"><span class="lineno">  201</span>}</div>
<div class="line"><span class="lineno">  202</span><span class="comment">//======= end of the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>        Tempold.val_g(); </div>
<div class="line"><span class="lineno">  205</span>          Tlift.val_g(); </div>
<div class="line"><span class="lineno">  206</span>           TAdj.val_g(); </div>
<div class="line"><span class="lineno">  207</span>           velX.val_g(); </div>
<div class="line"><span class="lineno">  208</span>           velY.val_g(); </div>
<div class="line"><span class="lineno">  209</span>           Tdes.val_g();</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span><span class="comment">// // //       for (uint i=0; i &lt; Tempold._ndof; i++)     {</span></div>
<div class="line"><span class="lineno">  212</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  213</span><span class="comment">// // //         const double phii_g = currgp._phi_ndsQLVB_g[Tempold._FEord][i];</span></div>
<div class="line"><span class="lineno">  214</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  215</span><span class="comment">// // //         for (uint idim = 0; idim &lt; space_dim; idim++) dphiidx_g[idim] = currgp._dphidxyz_ndsQLVB_g[Tempold._FEord][i+idim*Tempold._ndof];</span></div>
<div class="line"><span class="lineno">  216</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  217</span><span class="comment">// // // //=========== FIRST ROW ===============</span></div>
<div class="line"><span class="lineno">  218</span><span class="comment">// // //         currelem.Rhs()(i) +=      </span></div>
<div class="line"><span class="lineno">  219</span><span class="comment">// // //            currelem.GetBCDofFlag()[i]*dtxJxW_g*( 0. )</span></div>
<div class="line"><span class="lineno">  220</span><span class="comment">// // //           + (1-currelem.GetBCDofFlag()[i])*detb*(Tempold._val_dofs[i]);</span></div>
<div class="line"><span class="lineno">  221</span><span class="comment">// // //         </span></div>
<div class="line"><span class="lineno">  222</span><span class="comment">// // //         currelem.Mat()(i,i) +=  (1-currelem.GetBCDofFlag()[i])*detb;</span></div>
<div class="line"><span class="lineno">  223</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  224</span><span class="comment">// // // //========= SECOND ROW (CONTROL) =====================</span></div>
<div class="line"><span class="lineno">  225</span><span class="comment">// // //         int ip1 = i + /* 1* */Tempold._ndof;   //suppose that T&#39; T_0 T_adj have the same order</span></div>
<div class="line"><span class="lineno">  226</span><span class="comment">// // //         currelem.Rhs()(ip1) +=      </span></div>
<div class="line"><span class="lineno">  227</span><span class="comment">// // //            currelem.GetBCDofFlag()[ip1]*dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  228</span><span class="comment">// // //                      + alphaT*domain_flag*(Tdes._val_g[0])*phii_g // T_d delta T_0</span></div>
<div class="line"><span class="lineno">  229</span><span class="comment">// // //          )</span></div>
<div class="line"><span class="lineno">  230</span><span class="comment">// // //           + (1-currelem.GetBCDofFlag()[ip1])*detb*(Tlift._val_dofs[i]);</span></div>
<div class="line"><span class="lineno">  231</span><span class="comment">// // //         </span></div>
<div class="line"><span class="lineno">  232</span><span class="comment">// // //          currelem.Mat()(ip1,ip1) +=  (1-currelem.GetBCDofFlag()[ip1])*detb;</span></div>
<div class="line"><span class="lineno">  233</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  234</span><span class="comment">// // // //======= THIRD ROW (ADJOINT) ===================================</span></div>
<div class="line"><span class="lineno">  235</span><span class="comment">// // //         int ip2 = i + 2 * Tempold._ndof;   //suppose that T&#39; T_0 T_adj have the same order</span></div>
<div class="line"><span class="lineno">  236</span><span class="comment">// // //            currelem.Rhs()(ip2) +=      </span></div>
<div class="line"><span class="lineno">  237</span><span class="comment">// // //            currelem.GetBCDofFlag()[ip2]*dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  238</span><span class="comment">// // //                 + alphaT*domain_flag*(Tdes._val_g[0])*phii_g // T_d delta T&#39;</span></div>
<div class="line"><span class="lineno">  239</span><span class="comment">// // //             )</span></div>
<div class="line"><span class="lineno">  240</span><span class="comment">// // //           + (1-currelem.GetBCDofFlag()[ip2])*detb*(Tempold._val_dofs[i]);</span></div>
<div class="line"><span class="lineno">  241</span><span class="comment">// // //         </span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">// // //         currelem.Mat()(ip2,ip2) +=  (1-currelem.GetBCDofFlag()[ip2])*detb;</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">// // //         // Matrix Assemblying ---------------------------</span></div>
<div class="line"><span class="lineno">  245</span><span class="comment">// // //         for (uint j=0; j&lt;Tempold._ndof; j++) {</span></div>
<div class="line"><span class="lineno">  246</span><span class="comment">// // //           double phij_g = currgp._phi_ndsQLVB_g[Tempold._FEord][j];</span></div>
<div class="line"><span class="lineno">  247</span><span class="comment">// // //          </span></div>
<div class="line"><span class="lineno">  248</span><span class="comment">// // //         for (uint idim = 0; idim &lt; space_dim; idim++)  dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[Tempold._FEord][j+idim*Tempold._ndof]; </span></div>
<div class="line"><span class="lineno">  249</span><span class="comment">// // //            </span></div>
<div class="line"><span class="lineno">  250</span><span class="comment">// // //    </span></div>
<div class="line"><span class="lineno">  251</span><span class="comment">// // //           double Lap_g   = Math::dot(&amp;dphijdx_g[0],&amp;dphiidx_g[0],space_dim);</span></div>
<div class="line"><span class="lineno">  252</span><span class="comment">// // //           double Advection = velX._val_g[0]*dphijdx_g[0] + velY._val_g[0]*dphijdx_g[1]; //Math::dot(&amp;vel._val_g[0],&amp;dphijdx_g[0],space_dim);</span></div>
<div class="line"><span class="lineno">  253</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  254</span><span class="comment">// // //            int ip1 = i + Tempold._ndof;</span></div>
<div class="line"><span class="lineno">  255</span><span class="comment">// // //            int jp1 = j + Tempold._ndof;</span></div>
<div class="line"><span class="lineno">  256</span><span class="comment">// // //            int ip2 = i + 2*Tempold._ndof;</span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">// // //            int jp2 = j + 2*Tempold._ndof;</span></div>
<div class="line"><span class="lineno">  258</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  259</span><span class="comment">// // // //                T     T_0     T_adj</span></div>
<div class="line"><span class="lineno">  260</span><span class="comment">// // //            </span></div>
<div class="line"><span class="lineno">  261</span><span class="comment">// // // //         T      X      X       O</span></div>
<div class="line"><span class="lineno">  262</span><span class="comment">// // //             </span></div>
<div class="line"><span class="lineno">  263</span><span class="comment">// // // //         T_0   </span></div>
<div class="line"><span class="lineno">  264</span><span class="comment">// // //            </span></div>
<div class="line"><span class="lineno">  265</span><span class="comment">// // // //         T_adj</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">// // //            </span></div>
<div class="line"><span class="lineno">  267</span><span class="comment">// // //            </span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">// // // //============ FIRST ROW state  delta T ===============</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">// // // //======= DIAGONAL =============================</span></div>
<div class="line"><span class="lineno">  270</span><span class="comment">// // //           currelem.Mat()(i,j) +=        </span></div>
<div class="line"><span class="lineno">  271</span><span class="comment">// // //             currelem.GetBCDofFlag()[i]*dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  272</span><span class="comment">// // //             + Advection*phii_g</span></div>
<div class="line"><span class="lineno">  273</span><span class="comment">// // //             + IRe*IPr*Lap_g  </span></div>
<div class="line"><span class="lineno">  274</span><span class="comment">// // //             );</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  276</span><span class="comment">// // // //===============================</span></div>
<div class="line"><span class="lineno">  277</span><span class="comment">// // //     //same operators for T and T_0</span></div>
<div class="line"><span class="lineno">  278</span><span class="comment">// // //            currelem.Mat()(i,jp1) +=        </span></div>
<div class="line"><span class="lineno">  279</span><span class="comment">// // //             currelem.GetBCDofFlag()[i]*dtxJxW_g*(    </span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">// // //             + Advection*phii_g</span></div>
<div class="line"><span class="lineno">  281</span><span class="comment">// // //             + IRe*IPr*Lap_g</span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">// // //            );</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">// // // //====================================</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">// // //           currelem.Mat()(i,jp2) +=        </span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">// // //             currelem.GetBCDofFlag()[i]*dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">// // //                 0.</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">// // //             );</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">// // //            </span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">// // // //============= SECOND ROW (LIFTING) delta T_0 =============</span></div>
<div class="line"><span class="lineno">  292</span><span class="comment">// // // //===== DIAGONAL ===========================</span></div>
<div class="line"><span class="lineno">  293</span><span class="comment">// // //          currelem.Mat()(ip1,jp1) +=        </span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">// // //             currelem.GetBCDofFlag()[ip1]*</span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">// // //             dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">// // //              + alphaL2*phij_g*phii_g  //L_2 control norm</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">// // //              + alphaH1*Lap_g          //H_1 control norm</span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">// // //               + alphaT*domain_flag*(phij_g)*phii_g  //T_0 delta T_0  //ADDED///////////////</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">// // //             ); </span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">// // // //====================================</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">// // //           currelem.Mat()(ip1,j) +=        </span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">// // //             currelem.GetBCDofFlag()[ip1]*</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">// // //             dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">// // //                 + alphaT*domain_flag*(phij_g)*phii_g  //T&#39; delta T_0     //ADDED///////////////</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">// // //             );</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">// // // //====================================</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">// // //           currelem.Mat()(ip1,jp2) +=        </span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">// // //             currelem.GetBCDofFlag()[ip1]*</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">// // //              dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">// // //                  -Advection*phii_g</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">// // //                 + IRe*IPr*Lap_g</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">// // //            );</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  314</span><span class="comment">// // // //============= THIRD ROW (ADJOINT) =============</span></div>
<div class="line"><span class="lineno">  315</span><span class="comment">// // // //======= DIAGONAL ==================</span></div>
<div class="line"><span class="lineno">  316</span><span class="comment">// // //           currelem.Mat()(ip2,jp2) +=        </span></div>
<div class="line"><span class="lineno">  317</span><span class="comment">// // //             currelem.GetBCDofFlag()[ip2]*</span></div>
<div class="line"><span class="lineno">  318</span><span class="comment">// // //               dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">// // //             - Advection*phii_g  //minus sign</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">// // //             + IRe*IPr*Lap_g</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">// // //                </span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">// // //             ); </span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">// // // //====================================</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">// // //           currelem.Mat()(ip2,j) +=        </span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">// // //             currelem.GetBCDofFlag()[ip2]*</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">// // //             dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">// // //                + alphaT*domain_flag*(phij_g)*phii_g  //T&#39; delta T&#39;</span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">// // //             );</span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">// // // //====================================</span></div>
<div class="line"><span class="lineno">  330</span><span class="comment">// // //           currelem.Mat()(ip2,jp1) +=        </span></div>
<div class="line"><span class="lineno">  331</span><span class="comment">// // //             currelem.GetBCDofFlag()[ip2]*</span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">// // //             dtxJxW_g*( </span></div>
<div class="line"><span class="lineno">  333</span><span class="comment">// // //                + alphaT*domain_flag*(phij_g)*phii_g  //T_0 delta T&#39;     ///ADDED///////</span></div>
<div class="line"><span class="lineno">  334</span><span class="comment">// // //             );</span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  336</span><span class="comment">// // //         }  //end j (col)</span></div>
<div class="line"><span class="lineno">  337</span><span class="comment">// // //       }   //end i (row)</span></div>
<div class="line"><span class="lineno">  338</span>    } <span class="comment">// end of the quadrature point qp-loop</span></div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>       my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">_LinSolver</a>[Level]-&gt;_KK-&gt;add_matrix(currelem.Mat(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  341</span>       my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">_LinSolver</a>[Level]-&gt;_RESC-&gt;add_vector(currelem.Rhs(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  342</span>  } <span class="comment">// end of element loop</span></div>
<div class="line"><span class="lineno">  343</span>  <span class="comment">// *****************************************************************</span></div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>   }<span class="comment">//END VOLUME</span></div>
<div class="line"><span class="lineno">  347</span>  </div>
<div class="line"><span class="lineno">  348</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">_LinSolver</a>[Level]-&gt;_KK-&gt;close();</div>
<div class="line"><span class="lineno">  349</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">_LinSolver</a>[Level]-&gt;_RESC-&gt;close();</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>  std::cout &lt;&lt; <span class="stringliteral">&quot; Matrix and RHS assembled for equation &quot;</span> &lt;&lt; my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">name</a>()</div>
<div class="line"><span class="lineno">  353</span>            &lt;&lt; <span class="stringliteral">&quot; Level &quot;</span>&lt;&lt; Level &lt;&lt; <span class="stringliteral">&quot; dofs &quot;</span> &lt;&lt; my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">_LinSolver</a>[Level]-&gt;_KK-&gt;n() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  354</span> </div>
<div class="line"><span class="lineno">  355</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  356</span>}</div>
<div class="ttc" id="a_f_e_type_enum__deprecated_8hpp_html_ac5219afbbd6ed7b35c076e508ac752ff"><div class="ttname"><a href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a></div><div class="ttdeci">#define MESH_MAPPING_FE</div><div class="ttdef"><b>Definition</b> <a href="../../db/d1d/_f_e_type_enum__deprecated_8hpp_source.html#l00010">FETypeEnum_deprecated.hpp:10</a></div></div>
<div class="ttc" id="a_f_e_type_enum__deprecated_8hpp_html_aca285339f9cf24489fdc0af5b51a5fde"><div class="ttname"><a href="../../db/d1d/_f_e_type_enum__deprecated_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a></div><div class="ttdeci">#define QL</div><div class="ttdef"><b>Definition</b> <a href="../../db/d1d/_f_e_type_enum__deprecated_8hpp_source.html#l00008">FETypeEnum_deprecated.hpp:8</a></div></div>
<div class="ttc" id="a_type_defs_and_type_casts_8hpp_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="../../dd/d37/_type_defs_and_type_casts_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d37/_type_defs_and_type_casts_8hpp_source.html#l00012">TypeDefsAndTypeCasts.hpp:12</a></div></div>
<div class="ttc" id="a_v_b_type_enum_8hpp_html_a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e"><div class="ttname"><a href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a></div><div class="ttdeci">@ VV</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9e/_v_b_type_enum_8hpp_source.html#l00004">VBTypeEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_current_elem_html"><div class="ttname"><a href="../../d4/d0f/classfemus_1_1_current_elem.html">femus::CurrentElem</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/dbc/_current_elem_8hpp_source.html#l00039">CurrentElem.hpp:39</a></div></div>
<div class="ttc" id="aclassfemus_1_1_current_quantity_html"><div class="ttname"><a href="../../de/d6e/classfemus_1_1_current_quantity.html">femus::CurrentQuantity</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d49/_current_quantity_8hpp_source.html#l00018">CurrentQuantity.hpp:18</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_input_parser_html_a317bdaac200e745334dcd436d39d2832"><div class="ttname"><a href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">femus::FemusInputParser::get</a></div><div class="ttdeci">const T get(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d19/_femus_input_parser_8hpp_source.html#l00095">FemusInputParser.hpp:95</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gauss_html_a9aed14f6d02b6aad6b6eb59db1001438"><div class="ttname"><a href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">femus::Gauss::GetGaussWeight</a></div><div class="ttdeci">const double GetGaussWeight(const unsigned ig) const</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d65/quadrature__interface_8hpp_source.html#l00047">quadrature_interface.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gauss_html_ab1eb96997b69ce4ebec7283eb3bf1c01"><div class="ttname"><a href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">femus::Gauss::GetGaussPointsNumber</a></div><div class="ttdeci">const unsigned GetGaussPointsNumber() const</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d65/quadrature__interface_8hpp_source.html#l00051">quadrature_interface.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a6ba19fa5932202ec6698d00d191d6985"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a6ba19fa5932202ec6698d00d191d6985">femus::LinearImplicitSystem::_LinSolver</a></div><div class="ttdeci">std::vector&lt; LinearEquationSolver * &gt; _LinSolver</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00240">LinearImplicitSystem.hpp:240</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00061">Mesh.hpp:61</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a10501173ab167b815f14a69de37c0d2b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a10501173ab167b815f14a69de37c0d2b">femus::Mesh::GetMeshElements</a></div><div class="ttdeci">elem * GetMeshElements() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00139">Mesh.hpp:139</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a65dabdf1e308c1a44ebe5c6a41d09284"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">femus::MultiLevelMesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00116">MultiLevelMesh.cpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00181">MultiLevelMesh.hpp:181</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a68f3f358a51963417fbaeb9255d2c2c3"><div class="ttname"><a href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">femus::MultiLevelMeshTwo::_NoLevels</a></div><div class="ttdeci">uint _NoLevels</div><div class="ttdoc">Number of subdomains (subdomain P)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d0c/_multi_level_mesh_two_8hpp_source.html#l00072">MultiLevelMeshTwo.hpp:72</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a7508c00c363175fd124c4fec42e0637c"><div class="ttname"><a href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">femus::MultiLevelMeshTwo::_off_el</a></div><div class="ttdeci">int ** _off_el</div><div class="ttdoc">[VB][L] Number of Elements</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d0c/_multi_level_mesh_two_8hpp_source.html#l00083">MultiLevelMeshTwo.hpp:83</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a34890e6aa9d88946571fa050ee544c39"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">femus::MultiLevelProblem::GetQuadratureRule</a></div><div class="ttdeci">const Gauss &amp; GetQuadratureRule(const unsigned geom_elem_type) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00133">MultiLevelProblem.hpp:133</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a692d73df5b51e09d9c1eef430376113c"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">femus::MultiLevelProblem::GetInputParser</a></div><div class="ttdeci">const FemusInputParser&lt; double &gt; &amp; GetInputParser() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00088">MultiLevelProblem.hpp:88</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a895a29b587ab7f4dae3927fd46858254"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">femus::MultiLevelProblem::GetQtyMap</a></div><div class="ttdeci">const QuantityMap &amp; GetQtyMap() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00288">MultiLevelProblem.hpp:288</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00232">MultiLevelProblem.hpp:232</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a960b21c0989774f946312b8f5869f721"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">femus::MultiLevelProblem::GetMeshTwo</a></div><div class="ttdeci">const MultiLevelMeshTwo &amp; GetMeshTwo() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00247">MultiLevelProblem.hpp:247</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_a6865a3e6d5abf01a8a17994635a1f109"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">femus::QuantityMap::GetQuantity</a></div><div class="ttdeci">Quantity * GetQuantity(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00082">Quantity.hpp:82</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a16af0d7b8849d6ea983a5e425fb90fee"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">femus::System::GetLevelToAssemble</a></div><div class="ttdeci">unsigned GetLevelToAssemble() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/def/_system_8hpp_source.html#l00121">System.hpp:121</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a1a007c176529dae649887bbd1cb46103"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">femus::System::name</a></div><div class="ttdeci">const std::string &amp; name() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/def/_system_8hpp_source.html#l00261">System.hpp:261</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_two_html"><div class="ttname"><a href="../../dd/d68/classfemus_1_1_system_two.html">femus::SystemTwo</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/da5/_system_two_8hpp_source.html#l00047">SystemTwo.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00045">Elem.hpp:45</a></div></div>
<div class="ttc" id="anamespacefemus_html_a456d791a719bf9eb4c58b2826f8eac68"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a456d791a719bf9eb4c58b2826f8eac68">femus::TempDesired</a></div><div class="ttdeci">void TempDesired(CurrentQuantity &amp;myvect, const CurrentElem&lt; double &gt; &amp;currelem)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d9a/02__elliptic__with__given__advection_2_opt_loop_8cpp_source.html#l00358">OptLoop.cpp:358</a></div></div>
<div class="ttc" id="anamespacefemus_html_ab28051e8fceaf9b05bfae63a6522fdc4"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#ab28051e8fceaf9b05bfae63a6522fdc4">femus::ElFlagControl</a></div><div class="ttdeci">int ElFlagControl(const std::vector&lt; double &gt; el_xm, const MultiLevelMesh *mesh)</div><div class="ttdoc">AAA questa funzione NON lavora se tu fai solo DUE SUDDIVISIONI PER LATO e nolevels=1 !...</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d9a/02__elliptic__with__given__advection_2_opt_loop_8cpp_source.html#l00305">OptLoop.cpp:305</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp_source.html#l00047">47</a> of file <a class="el" href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   47</span>                                 {</div>
<div class="line"><span class="lineno">   48</span> </div>
<div class="line"><span class="lineno">   49</span><span class="preprocessor">#ifdef HAVE_LIBMESH</span></div>
<div class="line"><span class="lineno">   50</span>   libMesh::LibMeshInit init(argc,argv);</div>
<div class="line"><span class="lineno">   51</span><span class="preprocessor">#else   </span></div>
<div class="line"><span class="lineno">   52</span>   <a class="code hl_class" href="../../da/d5e/classfemus_1_1_femus_init.html">FemusInit</a> init(argc,argv);</div>
<div class="line"><span class="lineno">   53</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   54</span>  </div>
<div class="line"><span class="lineno">   55</span> <span class="comment">// ======= Files ========================</span></div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_class" href="../../d6/d0b/classfemus_1_1_files.html">Files</a> files; </div>
<div class="line"><span class="lineno">   57</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a38c38ec2557fb275bf3c301f93e9e958">ConfigureRestart</a>();</div>
<div class="line"><span class="lineno">   58</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">CheckIODirectories</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   59</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a513b4baed4cd225643cdaa2c5884de0f">CopyInputFiles</a>();   <span class="comment">// at this point everything is in the folder of the current run!!!!</span></div>
<div class="line"><span class="lineno">   60</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">RedirectCout</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   61</span> </div>
<div class="line"><span class="lineno">   62</span>  <span class="comment">// ======= MyPhysics (implemented as child of Physics) ========================</span></div>
<div class="line"><span class="lineno">   63</span>  <a class="code hl_class" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser&lt;double&gt;</a> physics_map(<span class="stringliteral">&quot;Physics&quot;</span>,files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>());</div>
<div class="line"><span class="lineno">   64</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> Lref  =  physics_map.get(<span class="stringliteral">&quot;Lref&quot;</span>);     <span class="comment">// reference L</span></div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>  <span class="comment">// ======= Mesh =====</span></div>
<div class="line"><span class="lineno">   67</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NoLevels = 3;</div>
<div class="line"><span class="lineno">   68</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = 2;</div>
<div class="line"><span class="lineno">   69</span>  <span class="keyword">const</span> <a class="code hl_enumeration" href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031d">GeomElType</a> geomel_type = <a class="code hl_enumvalue" href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c">QUAD</a>;</div>
<div class="line"><span class="lineno">   70</span> </div>
<div class="line"><span class="lineno">   71</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob_temp;</div>
<div class="line"><span class="lineno">   72</span>  <a class="code hl_class" href="../../d5/dc2/classfemus_1_1_gen_case.html">GenCase</a> mesh(NoLevels,<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,geomel_type,<span class="stringliteral">&quot;&quot;</span>, ml_prob_temp);</div>
<div class="line"><span class="lineno">   73</span>          mesh.SetLref(1.);  </div>
<div class="line"><span class="lineno">   74</span>          </div>
<div class="line"><span class="lineno">   75</span>  <span class="comment">// ======= MyDomainShape  (optional, implemented as child of Domain) ====================</span></div>
<div class="line"><span class="lineno">   76</span>  <a class="code hl_class" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser&lt;double&gt;</a> box_map(<span class="stringliteral">&quot;Box&quot;</span>,files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>());</div>
<div class="line"><span class="lineno">   77</span> </div>
<div class="line"><span class="lineno">   78</span>  <a class="code hl_class" href="../../da/d8d/classfemus_1_1_box.html">Box</a> mybox(mesh.get_dim(),box_map);</div>
<div class="line"><span class="lineno">   79</span>      mybox.InitAndNondimensionalize(mesh.get_Lref());</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>          mesh.SetDomain(&amp;mybox);    </div>
<div class="line"><span class="lineno">   82</span>          </div>
<div class="line"><span class="lineno">   83</span>          mesh.GenerateCase(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(), ml_prob_temp);</div>
<div class="line"><span class="lineno">   84</span> </div>
<div class="line"><span class="lineno">   85</span>          mesh.SetLref(Lref);</div>
<div class="line"><span class="lineno">   86</span>      mybox.InitAndNondimensionalize(mesh.get_Lref());</div>
<div class="line"><span class="lineno">   87</span>          </div>
<div class="line"><span class="lineno">   88</span>          <span class="comment">// XDMFWriter::ReadMeshAndNondimensionalizeBiquadraticHDF5(files.GetOutputPath(),mesh); </span></div>
<div class="line"><span class="lineno">   89</span>              <span class="comment">// XDMFWriter::PrintMeshXDMF(files.GetOutputPath(),mesh,CONTINUOUS_BIQUADRATIC);</span></div>
<div class="line"><span class="lineno">   90</span>          <span class="comment">// XDMFWriter::PrintMeshLinear(files.GetOutputPath(),mesh);</span></div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>          </div>
<div class="line"><span class="lineno">   93</span>  <span class="comment">// ===== QuantityMap =========================================</span></div>
<div class="line"><span class="lineno">   94</span>  <a class="code hl_class" href="../../d5/d5a/classfemus_1_1_quantity_map.html">QuantityMap</a>  qty_map;</div>
<div class="line"><span class="lineno">   95</span>  qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a5e91f9c899e60ee5249e57e0f746dc2c">SetMeshTwo</a>(&amp;mesh);</div>
<div class="line"><span class="lineno">   96</span>  qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a607c4c523156d00c75864679d301aa05">SetInputParser</a>(&amp;physics_map);</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span><span class="comment">//===============================================</span></div>
<div class="line"><span class="lineno">   99</span><span class="comment">//================== Add QUANTITIES ======================</span></div>
<div class="line"><span class="lineno">  100</span><span class="comment">//========================================================</span></div>
<div class="line"><span class="lineno">  101</span>  </div>
<div class="line"><span class="lineno">  102</span>  <a class="code hl_class" href="../../dc/d98/classapplications__opt__control_1_1_temperature.html">Temperature</a> temperature(<span class="stringliteral">&quot;Qty_Temperature&quot;</span>,qty_map,1,0<span class="comment">/*biquadratic*/</span>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;temperature);</div>
<div class="line"><span class="lineno">  103</span><span class="comment">//   Temperature temperature2(&quot;Qty_Temperature2&quot;,qty_map,1,1/*linear*/);        qty_map.AddQuantity(&amp;temperature2);</span></div>
<div class="line"><span class="lineno">  104</span><span class="comment">//   Temperature temperature3(&quot;Qty_Temperature3&quot;,qty_map,1,2/*constant*/);      qty_map.AddQuantity(&amp;temperature3);</span></div>
<div class="line"><span class="lineno">  105</span>  <span class="comment">// ===== end QuantityMap =========================================</span></div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span>  <span class="comment">// ====== Start new main =================================</span></div>
<div class="line"><span class="lineno">  108</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_msh;</div>
<div class="line"><span class="lineno">  109</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(8,8,0,0,1,0,1,0,1,<a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a>,<span class="stringliteral">&quot;fifth&quot;</span>); <span class="comment">//   ml_msh.GenerateCoarseBoxMesh(numelemx,numelemy,numelemz,xa,xb,ya,yb,za,zb,elemtype,&quot;seventh&quot;);</span></div>
<div class="line"><span class="lineno">  110</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">RefineMesh</a>(NoLevels,NoLevels,NULL);</div>
<div class="line"><span class="lineno">  111</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0bde72630bb85baa5e9200cc28be700a">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a1ecf10a71cc3a93dd89ded57adf55043">SetDomain</a>(&amp;mybox);    </div>
<div class="line"><span class="lineno">  114</span>  </div>
<div class="line"><span class="lineno">  115</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> ml_sol(&amp;ml_msh);</div>
<div class="line"><span class="lineno">  116</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;FAKE&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>,0);</div>
<div class="line"><span class="lineno">  117</span> </div>
<div class="line"><span class="lineno">  118</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob(&amp;ml_sol);  </div>
<div class="line"><span class="lineno">  119</span>  ml_prob.SetMeshTwo(&amp;mesh);</div>
<div class="line"><span class="lineno">  120</span>  ml_prob.SetQuadratureRuleAllGeomElems(<span class="stringliteral">&quot;fifth&quot;</span>);</div>
<div class="line"><span class="lineno">  121</span><span class="comment">//   ml_prob.SetElemTypeAllDims();</span></div>
<div class="line"><span class="lineno">  122</span>  ml_prob.SetInputParser(&amp;physics_map); </div>
<div class="line"><span class="lineno">  123</span>  ml_prob.SetQtyMap(&amp;qty_map);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span><span class="comment">//===============================================</span></div>
<div class="line"><span class="lineno">  126</span><span class="comment">//================== Add EQUATIONS AND ======================</span></div>
<div class="line"><span class="lineno">  127</span><span class="comment">//========= associate an EQUATION to QUANTITIES ========</span></div>
<div class="line"><span class="lineno">  128</span><span class="comment">//========================================================</span></div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp;  eqnT = ml_prob.add_system&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_T&quot;</span>);</div>
<div class="line"><span class="lineno">  131</span>          eqnT.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;FAKE&quot;</span>);</div>
<div class="line"><span class="lineno">  132</span>          eqnT.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;temperature); </div>
<div class="line"><span class="lineno">  133</span><span class="comment">//           eqnT.AddUnknownToSystemPDE(&amp;temperature2); </span></div>
<div class="line"><span class="lineno">  134</span><span class="comment">//           eqnT.AddUnknownToSystemPDE(&amp;temperature3); </span></div>
<div class="line"><span class="lineno">  135</span>          eqnT.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp.html#a8f96a52745858ba9cfe0f67b151d2de2">GenMatRhsT</a>);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span><span class="comment">//================================ </span></div>
<div class="line"><span class="lineno">  138</span><span class="comment">//========= End add EQUATIONS  and ========</span></div>
<div class="line"><span class="lineno">  139</span><span class="comment">//========= associate an EQUATION to QUANTITIES ========</span></div>
<div class="line"><span class="lineno">  140</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span><span class="comment">//Ok now that the mesh file is there i want to COMPUTE the MG OPERATORS... but I want to compute them ONCE and FOR ALL,</span></div>
<div class="line"><span class="lineno">  143</span><span class="comment">//not for every equation... but the functions belong to the single equation... I need to make them EXTERNAL</span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">// then I&#39;ll have A from the equation, PRL and REST from a MG object.</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">//So somehow i&#39;ll have to put these objects at a higher level... but so far let us see if we can COMPUTE and PRINT from HERE and not from the gencase</span></div>
<div class="line"><span class="lineno">  146</span>         </div>
<div class="line"><span class="lineno">  147</span>   <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#ac9198f98c0374b5d00fe95e70685aed9">MultiLevelProblem::const_system_iterator</a> eqn = ml_prob.begin(); eqn != ml_prob.end(); eqn++) {</div>
<div class="line"><span class="lineno">  148</span>     </div>
<div class="line"><span class="lineno">  149</span>        <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>* sys = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>*<span class="keyword">&gt;</span>(eqn-&gt;second);</div>
<div class="line"><span class="lineno">  150</span><span class="comment">// //=====================</span></div>
<div class="line"><span class="lineno">  151</span><span class="comment">//     sys -&gt; init_two();</span></div>
<div class="line"><span class="lineno">  152</span>    sys -&gt; _LinSolver[0]-&gt;set_solver_type(<a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>);  <span class="comment">//if I keep PREONLY it doesn&#39;t run</span></div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  155</span>    sys -&gt; init_unknown_vars();</div>
<div class="line"><span class="lineno">  156</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  157</span>    sys -&gt; _dofmap.ComputeMeshToDof();</div>
<div class="line"><span class="lineno">  158</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  159</span>    sys -&gt; initVectors();</div>
<div class="line"><span class="lineno">  160</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  161</span>    sys -&gt; Initialize();</div>
<div class="line"><span class="lineno">  162</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  163</span>    sys -&gt; _bcond.GenerateBdc();</div>
<div class="line"><span class="lineno">  164</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  165</span>    <a class="code hl_function" href="../../d5/dc2/classfemus_1_1_gen_case.html#a8ff0e1ca8e4b16e005e8a37799c43194">GenCase::ReadMGOps</a>(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),sys);</div>
<div class="line"><span class="lineno">  166</span>    </div>
<div class="line"><span class="lineno">  167</span>    }</div>
<div class="line"><span class="lineno">  168</span>    </div>
<div class="line"><span class="lineno">  169</span>  <span class="comment">// ======== Loop ===================================</span></div>
<div class="line"><span class="lineno">  170</span>  <a class="code hl_class" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser&lt;double&gt;</a> loop_map(<span class="stringliteral">&quot;TimeLoop&quot;</span>,files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>());</div>
<div class="line"><span class="lineno">  171</span>  <a class="code hl_class" href="../../d4/d4d/classfemus_1_1_time_loop.html">TimeLoop</a> time_loop(files,loop_map); </div>
<div class="line"><span class="lineno">  172</span> </div>
<div class="line"><span class="lineno">  173</span>  time_loop.TransientSetup(ml_prob);  <span class="comment">// reset the initial state (if restart) and print the Case</span></div>
<div class="line"><span class="lineno">  174</span> </div>
<div class="line"><span class="lineno">  175</span>  time_loop.TransientLoop(ml_prob);</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span><span class="comment">// at this point, the run has been completed </span></div>
<div class="line"><span class="lineno">  178</span>  files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#ab040fcbe943823f2f0febc9bc0f127a3">log_petsc</a>();</div>
<div class="line"><span class="lineno">  179</span>  </div>
<div class="line"><span class="lineno">  180</span><span class="comment">// ============  clean ================================</span></div>
<div class="line"><span class="lineno">  181</span>  ml_prob.clear();</div>
<div class="line"><span class="lineno">  182</span>  mesh.clear();</div>
<div class="line"><span class="lineno">  183</span>  </div>
<div class="line"><span class="lineno">  184</span>  </div>
<div class="line"><span class="lineno">  185</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  186</span>}</div>
<div class="ttc" id="a010___optimal_control_299__fe__test_2main_8cpp_html_a8f96a52745858ba9cfe0f67b151d2de2"><div class="ttname"><a href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp.html#a8f96a52745858ba9cfe0f67b151d2de2">GenMatRhsT</a></div><div class="ttdeci">void GenMatRhsT(MultiLevelProblem &amp;ml_prob)</div><div class="ttdoc">This function assembles the matrix and the rhs:</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d8c/02__elliptic__with__given__advection_2_eqn_t_8cpp_source.html#l00062">EqnT.cpp:62</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a></div><div class="ttdeci">@ QUAD9</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00016">ElemTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00023">FElemTypeEnum.hpp:22</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00010">FElemTypeEnum.hpp:10</a></div></div>
<div class="ttc" id="a_geom_el_type_enum_8hpp_html_a5f4d1ffd8f6d0e4930c05074e733031d"><div class="ttname"><a href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031d">GeomElType</a></div><div class="ttdeci">GeomElType</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d03/_geom_el_type_enum_8hpp_source.html#l00013">GeomElTypeEnum.hpp:13</a></div></div>
<div class="ttc" id="a_geom_el_type_enum_8hpp_html_a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c"><div class="ttname"><a href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c">QUAD</a></div><div class="ttdeci">@ QUAD</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d03/_geom_el_type_enum_8hpp_source.html#l00016">GeomElTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_navier_stokes___a_m_r_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp_source.html#l00034">NavierStokes_AMR.cpp:34</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a></div><div class="ttdeci">@ GMRES</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00016">SolvertypeEnum.hpp:16</a></div></div>
<div class="ttc" id="aclassapplications__opt__control_1_1_temperature_html"><div class="ttname"><a href="../../dc/d98/classapplications__opt__control_1_1_temperature.html">applications_opt_control::Temperature</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4b/02__elliptic__with__given__advection_2_temp_quantities_8hpp_source.html#l00020">TempQuantities.hpp:20</a></div></div>
<div class="ttc" id="aclassfemus_1_1_box_html"><div class="ttname"><a href="../../da/d8d/classfemus_1_1_box.html">femus::Box</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/df1/_box_8hpp_source.html#l00028">Box.hpp:28</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00050">FemusInit.hpp:50</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_input_parser_html"><div class="ttname"><a href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">femus::FemusInputParser</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/d19/_femus_input_parser_8hpp_source.html#l00036">FemusInputParser.hpp:36</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html">femus::Files</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00038">Files.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_a38c38ec2557fb275bf3c301f93e9e958"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a38c38ec2557fb275bf3c301f93e9e958">femus::Files::ConfigureRestart</a></div><div class="ttdeci">void ConfigureRestart()</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00066">Files.cpp:66</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_a513b4baed4cd225643cdaa2c5884de0f"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a513b4baed4cd225643cdaa2c5884de0f">femus::Files::CopyInputFiles</a></div><div class="ttdeci">void CopyInputFiles() const</div><div class="ttdoc">========== Copy Input Files ==========</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00450">Files.cpp:450</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_aac199200ffda7ba50611cc41f6a874bc"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">femus::Files::RedirectCout</a></div><div class="ttdeci">void RedirectCout(const bool redirect_cout_to_file) const</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00565">Files.cpp:565</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab040fcbe943823f2f0febc9bc0f127a3"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#ab040fcbe943823f2f0febc9bc0f127a3">femus::Files::log_petsc</a></div><div class="ttdeci">void log_petsc() const</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00626">Files.cpp:626</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab8c41974c4980d87c7e1467b153854e6"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">femus::Files::CheckIODirectories</a></div><div class="ttdeci">void CheckIODirectories(const bool use_output_time_folder)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00527">Files.cpp:527</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00110">Files.hpp:110</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html"><div class="ttname"><a href="../../d5/dc2/classfemus_1_1_gen_case.html">femus::GenCase</a></div><div class="ttdef"><b>Definition</b> <a href="../../d7/db9/_gen_case_8hpp_source.html#l00033">GenCase.hpp:33</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a8ff0e1ca8e4b16e005e8a37799c43194"><div class="ttname"><a href="../../d5/dc2/classfemus_1_1_gen_case.html#a8ff0e1ca8e4b16e005e8a37799c43194">femus::GenCase::ReadMGOps</a></div><div class="ttdeci">static void ReadMGOps(const std::string output_path, SystemTwo *mysys)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d36/_gen_case_8cpp_source.html#l02140">GenCase.cpp:2140</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00047">MultiLevelMesh.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a06c4fe014434c2bafdd2c6e94e018620"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">femus::MultiLevelMesh::RefineMesh</a></div><div class="ttdeci">void RefineMesh(const unsigned short &amp;igridn, const unsigned short &amp;igridr, bool(*SetRefinementFlag)(const std::vector&lt; double &gt; &amp;x, const int &amp;ElemGroupNumber, const int &amp;level))</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00287">MultiLevelMesh.cpp:287</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00215">MultiLevelMesh.cpp:215</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0bde72630bb85baa5e9200cc28be700a"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0bde72630bb85baa5e9200cc28be700a">femus::MultiLevelMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00123">MultiLevelMesh.cpp:123</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a1ecf10a71cc3a93dd89ded57adf55043"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a1ecf10a71cc3a93dd89ded57adf55043">femus::MultiLevelMesh::SetDomain</a></div><div class="ttdeci">void SetDomain(Domain *)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00665">MultiLevelMesh.cpp:665</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00060">MultiLevelProblem.hpp:60</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_ac9198f98c0374b5d00fe95e70685aed9"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#ac9198f98c0374b5d00fe95e70685aed9">femus::MultiLevelProblem::const_system_iterator</a></div><div class="ttdeci">std::map&lt; std::string, System * &gt;::const_iterator const_system_iterator</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00315">MultiLevelProblem.hpp:315</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00044">MultiLevelSolution.hpp:44</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html">femus::QuantityMap</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00073">Quantity.hpp:73</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_a5e91f9c899e60ee5249e57e0f746dc2c"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#a5e91f9c899e60ee5249e57e0f746dc2c">femus::QuantityMap::SetMeshTwo</a></div><div class="ttdeci">void SetMeshTwo(const MultiLevelMeshTwo *mesh_in)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00096">Quantity.hpp:96</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_a607c4c523156d00c75864679d301aa05"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#a607c4c523156d00c75864679d301aa05">femus::QuantityMap::SetInputParser</a></div><div class="ttdeci">void SetInputParser(const FemusInputParser&lt; double &gt; *parser_in)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00102">Quantity.hpp:102</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_ad491f645bc7537f47462cc352f0add25"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">femus::QuantityMap::AddQuantity</a></div><div class="ttdeci">void AddQuantity(Quantity *value)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00080">Quantity.hpp:80</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a42a5b5b5d2c7673b1d4c896762d8db9e"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">femus::System::SetAssembleFunction</a></div><div class="ttdeci">void SetAssembleFunction(AssembleFunctionType)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00071">System.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a606e07526d7a0d31eed638404ee2ed24"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">femus::System::AddSolutionToSystemPDE</a></div><div class="ttdeci">virtual void AddSolutionToSystemPDE(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00104">System.cpp:104</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_two_html_a34293cf806f9758e32d6bbbd232088b2"><div class="ttname"><a href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">femus::SystemTwo::AddUnknownToSystemPDE</a></div><div class="ttdeci">void AddUnknownToSystemPDE(Quantity *qty_in)</div><div class="ttdef"><b>Definition</b> <a href="../../de/da5/_system_two_8hpp_source.html#l00068">SystemTwo.hpp:68</a></div></div>
<div class="ttc" id="aclassfemus_1_1_time_loop_html"><div class="ttname"><a href="../../d4/d4d/classfemus_1_1_time_loop.html">femus::TimeLoop</a></div><div class="ttdef"><b>Definition</b> <a href="../../d9/d9f/_time_loop_8hpp_source.html#l00033">TimeLoop.hpp:33</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_80f1944ed3ab07eccc3fc4912c12d5bd.html">010_OptimalControl</a></li><li class="navelem"><a class="el" href="../../dir_80dd431347b7f09bcca360bfa3de364b.html">99_fe_test</a></li><li class="navelem"><a class="el" href="../../d8/d72/010___optimal_control_299__fe__test_2main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
