<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/applications/00_tutorial/ex20_time_dependent/ex20_time_dependent.cpp File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('ex20__time__dependent_8cpp.html',''); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">ex20_time_dependent.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="_multi_level_solution_8hpp_source.html">MultiLevelSolution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_transient_system_8hpp_source.html">TransientSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_numeric_vector_8hpp_source.html">NumericVector.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_fluid_8hpp_source.html">Fluid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_parameter_8hpp_source.html">Parameter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_sparse_matrix_8hpp_source.html">SparseMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_non_linear_implicit_system_8hpp_source.html">NonLinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_f_elem_type_enum_8hpp_source.html">FElemTypeEnum.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="_files_8hpp_source.html">Files.hpp</a>&quot;</code><br />
</div>
<p><a href="ex20__time__dependent_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="class_singularity.html">Singularity</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a6e794b4c3354c57cc3220c016f09ec39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex20__time__dependent_8cpp.html#a6e794b4c3354c57cc3220c016f09ec39">AssembleMatrixRes</a> (<a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:a6e794b4c3354c57cc3220c016f09ec39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad8e0a8089537cded2d83078fb2083df6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex20__time__dependent_8cpp.html#ad8e0a8089537cded2d83078fb2083df6">AssembleMatrixRes_VC</a> (<a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:ad8e0a8089537cded2d83078fb2083df6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab699f948498a8ffc7ed78f4e05a0441a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex20__time__dependent_8cpp.html#ab699f948498a8ffc7ed78f4e05a0441a">SetBoundaryCondition</a> (const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int FaceName, const double time)</td></tr>
<tr class="separator:ab699f948498a8ffc7ed78f4e05a0441a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab651207781b52680d3f1d7725793b81c"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a> (const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</td></tr>
<tr class="separator:ab651207781b52680d3f1d7725793b81c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="ex20__time__dependent_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a> (int argc, char **args)</td></tr>
<tr class="separator:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a6e794b4c3354c57cc3220c016f09ec39" name="a6e794b4c3354c57cc3220c016f09ec39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e794b4c3354c57cc3220c016f09ec39">&#9670;&#160;</a></span>AssembleMatrixRes()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AssembleMatrixRes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ex20__time__dependent_8cpp_source.html#l00343">343</a> of file <a class="el" href="ex20__time__dependent_8cpp_source.html">ex20_time_dependent.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  343</span>                                                   {</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>  <a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientNonlinearImplicitSystem</a>* mlPdeSys = &amp; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientNonlinearImplicitSystem</a>&gt;(<span class="stringliteral">&quot;Timedep&quot;</span>);</div>
<div class="line"><span class="lineno">  346</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><span class="lineno">  347</span> </div>
<div class="line"><span class="lineno">  348</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *ml_sol                  = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><span class="lineno">  349</span>  <a class="code hl_class" href="classfemus_1_1_solution.html">Solution</a>*  sol                              = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level);</div>
<div class="line"><span class="lineno">  350</span>  <a class="code hl_class" href="classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>*  pdeSys               = mlPdeSys-&gt;_LinSolver[level];</div>
<div class="line"><span class="lineno">  351</span>  <span class="keyword">const</span> <span class="keywordtype">char</span>* pdename                         = mlPdeSys-&gt;name().c_str();</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>*      msh           = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno">  354</span>  <a class="code hl_class" href="classfemus_1_1elem.html">elem</a>*      myel          = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">  355</span>  <a class="code hl_class" href="classfemus_1_1_sparse_matrix.html">SparseMatrix</a>*  JAC       = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><span class="lineno">  356</span>  <a class="code hl_class" href="classfemus_1_1_numeric_vector.html">NumericVector</a>* RES       = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>;</div>
<div class="line"><span class="lineno">  357</span> </div>
<div class="line"><span class="lineno">  358</span>  <span class="comment">// data</span></div>
<div class="line"><span class="lineno">  359</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  360</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><span class="lineno">  361</span>  <span class="keywordtype">unsigned</span> nel = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">GetNumberOfElements</a>();</div>
<div class="line"><span class="lineno">  362</span>  <span class="keywordtype">unsigned</span> igrid = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>();</div>
<div class="line"><span class="lineno">  363</span>  <span class="keywordtype">unsigned</span> iproc = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  364</span>  </div>
<div class="line"><span class="lineno">  365</span>  <span class="comment">// time dep data</span></div>
<div class="line"><span class="lineno">  366</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = mlPdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_transient_system.html#ac993f126734ae1c669e8470479d5c959">GetIntervalTime</a>();</div>
<div class="line"><span class="lineno">  367</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a> = 0.5;</div>
<div class="line"><span class="lineno">  368</span> </div>
<div class="line"><span class="lineno">  369</span>  <span class="comment">//************** geometry (at dofs and quadrature points) *************************************  </span></div>
<div class="line"><span class="lineno">  370</span>  vector &lt; vector &lt; double &gt; &gt; coords_at_dofs(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  371</span>  <span class="keywordtype">unsigned</span> coords_fe_type = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE BIQUADRATIC)</span></div>
<div class="line"><span class="lineno">  372</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; coords_at_dofs.size(); i++)    coords_at_dofs[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  373</span> </div>
<div class="line"><span class="lineno">  374</span>  vector &lt; double &gt; coord_at_qp(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  375</span>  </div>
<div class="line"><span class="lineno">  376</span>  <span class="comment">//************* shape functions (at dofs and quadrature points) **************************************  </span></div>
<div class="line"><span class="lineno">  377</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> solType_max = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>;  <span class="comment">//biquadratic</span></div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>  <span class="keywordtype">double</span> weight_qp; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  380</span>  </div>
<div class="line"><span class="lineno">  381</span>  vector &lt; vector &lt; double &gt; &gt; phi_fe_qp(<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno">  382</span>  vector &lt; vector &lt; double &gt; &gt; phi_x_fe_qp(<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno">  383</span>  vector &lt; vector &lt; double &gt; &gt; phi_xx_fe_qp(<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno">  384</span> </div>
<div class="line"><span class="lineno">  385</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {  </div>
<div class="line"><span class="lineno">  386</span>        phi_fe_qp[fe].reserve(max_size);</div>
<div class="line"><span class="lineno">  387</span>      phi_x_fe_qp[fe].reserve(max_size*<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  388</span>     phi_xx_fe_qp[fe].reserve(max_size*(3*(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>-1)));</div>
<div class="line"><span class="lineno">  389</span>   }</div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>  </div>
<div class="line"><span class="lineno">  392</span>  <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  393</span>  <span class="comment">//********* WHOLE SET OF VARIABLES ****************** </span></div>
<div class="line"><span class="lineno">  394</span>  <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  395</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span>  vector &lt; std::string &gt; Solname(n_unknowns);     Solname[0] = <span class="stringliteral">&quot;u&quot;</span>;</div>
<div class="line"><span class="lineno">  398</span>  vector &lt; unsigned &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><span class="lineno">  399</span>  vector &lt; unsigned &gt; SolIndex(n_unknowns);</div>
<div class="line"><span class="lineno">  400</span>  vector &lt; unsigned int &gt; SolFEType(n_unknowns);     <span class="comment">//FEtype of each MultilevelSolution       </span></div>
<div class="line"><span class="lineno">  401</span>  vector &lt; unsigned int &gt; Sol_n_el_dofs(n_unknowns); <span class="comment">//number of element dofs</span></div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span>  std::fill(Sol_n_el_dofs.begin(), Sol_n_el_dofs.end(), 0);</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno">  406</span>    SolPdeIndex[ivar] = mlPdeSys-&gt;GetSolPdeIndex(  Solname[ivar].c_str() );</div>
<div class="line"><span class="lineno">  407</span>       SolIndex[ivar] = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>         ( Solname[ivar].c_str() );</div>
<div class="line"><span class="lineno">  408</span>      SolFEType[ivar] = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>  ( SolIndex[ivar]);</div>
<div class="line"><span class="lineno">  409</span>  }</div>
<div class="line"><span class="lineno">  410</span>  </div>
<div class="line"><span class="lineno">  411</span>  <span class="comment">//------------ quantities (at quadrature points) ---------------------</span></div>
<div class="line"><span class="lineno">  412</span>          vector&lt;double&gt;        sol_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  413</span>          vector&lt;double&gt;    sol_old_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  414</span>  vector&lt; vector&lt;double&gt; &gt; sol_grad_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  415</span>  vector&lt; vector&lt;double&gt; &gt; sol_old_grad_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  416</span>    </div>
<div class="line"><span class="lineno">  417</span>  std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  418</span>  std::fill(sol_old_qp.begin(), sol_old_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  419</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  420</span>        sol_grad_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  421</span>        std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno">  422</span>        sol_old_grad_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  423</span>        std::fill(sol_old_grad_qp[k].begin(), sol_old_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno">  424</span>    }</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  <span class="comment">//----------- quantities (at dof objects) ------------------------------</span></div>
<div class="line"><span class="lineno">  427</span>  vector &lt; vector &lt; double &gt; &gt;     sol_eldofs(n_unknowns);</div>
<div class="line"><span class="lineno">  428</span>  vector &lt; vector &lt; double &gt; &gt;     sol_old_eldofs(n_unknowns);</div>
<div class="line"><span class="lineno">  429</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;n_unknowns; k++) { sol_eldofs[k].reserve(max_size);</div>
<div class="line"><span class="lineno">  430</span>                                sol_old_eldofs[k].reserve(max_size);</div>
<div class="line"><span class="lineno">  431</span>   }</div>
<div class="line"><span class="lineno">  432</span>  </div>
<div class="line"><span class="lineno">  433</span>  <span class="comment">//******** linear system *******************************************  </span></div>
<div class="line"><span class="lineno">  434</span>  vector &lt; vector &lt; int &gt; &gt; L2G_dofmap(n_unknowns);     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) { L2G_dofmap[i].reserve(max_size); }</div>
<div class="line"><span class="lineno">  435</span>            vector&lt; int &gt;   L2G_dofmap_AllVars; L2G_dofmap_AllVars.reserve( n_unknowns*max_size );</div>
<div class="line"><span class="lineno">  436</span>          </div>
<div class="line"><span class="lineno">  437</span>  vector&lt; vector&lt; double &gt; &gt; Res_el(n_unknowns);</div>
<div class="line"><span class="lineno">  438</span>  vector&lt; vector&lt; vector&lt; double &gt; &gt; &gt; Jac_el(n_unknowns);</div>
<div class="line"><span class="lineno">  439</span> </div>
<div class="line"><span class="lineno">  440</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) Res_el[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  441</span> </div>
<div class="line"><span class="lineno">  442</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) {</div>
<div class="line"><span class="lineno">  443</span>     Jac_el[i].resize(n_unknowns);</div>
<div class="line"><span class="lineno">  444</span>     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; n_unknowns; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  445</span>        Jac_el[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].reserve(max_size*max_size);</div>
<div class="line"><span class="lineno">  446</span>     }</div>
<div class="line"><span class="lineno">  447</span>   }</div>
<div class="line"><span class="lineno">  448</span>  </div>
<div class="line"><span class="lineno">  449</span>  <span class="comment">// Set to zero all the entries of the matrix</span></div>
<div class="line"><span class="lineno">  450</span>  RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  451</span>  JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">zero</a>();</div>
<div class="line"><span class="lineno">  452</span> </div>
<div class="line"><span class="lineno">  453</span>  <span class="comment">// *** element loop ***</span></div>
<div class="line"><span class="lineno">  454</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc+1]; iel++) {</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);    <span class="comment">// element geometry type</span></div>
<div class="line"><span class="lineno">  457</span>    </div>
<div class="line"><span class="lineno">  458</span>    <span class="comment">//******************** GEOMETRY ********************* </span></div>
<div class="line"><span class="lineno">  459</span>    <span class="keywordtype">unsigned</span> nDofx = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, coords_fe_type);       <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno">  460</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++)  coords_at_dofs[i].resize(nDofx);</div>
<div class="line"><span class="lineno">  461</span>    <span class="comment">// local storage of coordinates</span></div>
<div class="line"><span class="lineno">  462</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx; i++) {</div>
<div class="line"><span class="lineno">  463</span>      <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, coords_fe_type);       <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  466</span>        coords_at_dofs[jdim][i] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[jdim])(xDof);    <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  467</span>      }</div>
<div class="line"><span class="lineno">  468</span>    }</div>
<div class="line"><span class="lineno">  469</span>  <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  470</span>    </div>
<div class="line"><span class="lineno">  471</span>  <span class="comment">//all vars###################################################################  </span></div>
<div class="line"><span class="lineno">  472</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  473</span>    <span class="keywordtype">unsigned</span>  ndofs_unk = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolFEType[k]);</div>
<div class="line"><span class="lineno">  474</span>       Sol_n_el_dofs[k] = ndofs_unk;</div>
<div class="line"><span class="lineno">  475</span>          sol_eldofs[k].resize(ndofs_unk);</div>
<div class="line"><span class="lineno">  476</span>      sol_old_eldofs[k].resize(ndofs_unk);</div>
<div class="line"><span class="lineno">  477</span>          L2G_dofmap[k].resize(ndofs_unk); </div>
<div class="line"><span class="lineno">  478</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ndofs_unk; i++) {</div>
<div class="line"><span class="lineno">  479</span>            <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolFEType[k]);                    <span class="comment">// global to global mapping between solution node and solution dof </span></div>
<div class="line"><span class="lineno">  480</span>                                                                                            <span class="comment">// via local to global solution node</span></div>
<div class="line"><span class="lineno">  481</span>           sol_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex[k]])(solDof);                            <span class="comment">// global extraction and local storage for the solution</span></div>
<div class="line"><span class="lineno">  482</span>       sol_old_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5a9e3b150f6202162de4e350c39f544c">_SolOld</a>[SolIndex[k]])(solDof);                         <span class="comment">// This is OLD in TIME, not in nonlinear loop</span></div>
<div class="line"><span class="lineno">  483</span>           L2G_dofmap[k][i] = pdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(SolIndex[k], SolPdeIndex[k], i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><span class="lineno">  484</span>      }</div>
<div class="line"><span class="lineno">  485</span>    }</div>
<div class="line"><span class="lineno">  486</span>    </div>
<div class="line"><span class="lineno">  487</span>    </div>
<div class="line"><span class="lineno">  488</span>    <span class="keywordtype">unsigned</span> nDof_AllVars = 0;</div>
<div class="line"><span class="lineno">  489</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) { nDof_AllVars += Sol_n_el_dofs[k]; }</div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">// TODO COMPUTE MAXIMUM maximum number of element dofs for one scalar variable</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordtype">int</span> nDof_max    =  0;   </div>
<div class="line"><span class="lineno">  492</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++)     {</div>
<div class="line"><span class="lineno">  493</span>          <span class="keywordflow">if</span>(Sol_n_el_dofs[k] &gt; nDof_max)    nDof_max = Sol_n_el_dofs[k];</div>
<div class="line"><span class="lineno">  494</span>       }</div>
<div class="line"><span class="lineno">  495</span>    </div>
<div class="line"><span class="lineno">  496</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  497</span>      L2G_dofmap[k].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span>      Res_el[SolPdeIndex[k]].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  500</span>      memset(&amp; Res_el[SolPdeIndex[k]][0], 0., Sol_n_el_dofs[k] * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) );</div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>      Jac_el[SolPdeIndex[k]][SolPdeIndex[k]].resize(Sol_n_el_dofs[k] * Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  504</span>      memset(&amp; Jac_el[SolPdeIndex[k]][SolPdeIndex[k]][0], 0., Sol_n_el_dofs[k] * Sol_n_el_dofs[k] * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  505</span>    }</div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>  <span class="comment">//all vars###################################################################    </span></div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>      <span class="comment">// *** quadrature loop ***</span></div>
<div class="line"><span class="lineno">  510</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom).GetGaussPointsNumber(); <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  511</span>          </div>
<div class="line"><span class="lineno">  512</span>      <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno">  513</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><span class="lineno">  514</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][fe]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_at_dofs,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,phi_fe_qp[fe],phi_x_fe_qp[fe],phi_xx_fe_qp[fe]);</div>
<div class="line"><span class="lineno">  515</span>      }</div>
<div class="line"><span class="lineno">  516</span>      <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN</span></div>
<div class="line"><span class="lineno">  517</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coords_fe_type]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_at_dofs,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,phi_fe_qp[coords_fe_type],phi_x_fe_qp[coords_fe_type],phi_xx_fe_qp[coords_fe_type]);</div>
<div class="line"><span class="lineno">  518</span> </div>
<div class="line"><span class="lineno">  519</span>   <span class="comment">//========= fill gauss value quantities ==================   </span></div>
<div class="line"><span class="lineno">  520</span>   std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  521</span>   std::fill(sol_old_qp.begin(), sol_old_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  522</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) { std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.); </div>
<div class="line"><span class="lineno">  523</span>                                                std::fill(sol_old_grad_qp[k].begin(), sol_old_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno">  524</span>                                            }</div>
<div class="line"><span class="lineno">  525</span>    </div>
<div class="line"><span class="lineno">  526</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  527</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[k]; i++) {</div>
<div class="line"><span class="lineno">  528</span>                                                             sol_qp[k]    +=     sol_eldofs[k][i] *   phi_fe_qp[SolFEType[k]][i];</div>
<div class="line"><span class="lineno">  529</span>                                                         sol_old_qp[k]    += sol_old_eldofs[k][i] *   phi_fe_qp[SolFEType[k]][i];</div>
<div class="line"><span class="lineno">  530</span>                   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {      sol_grad_qp[k][d] +=     sol_eldofs[k][i] * phi_x_fe_qp[SolFEType[k]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d]; </div>
<div class="line"><span class="lineno">  531</span>                                                         sol_old_grad_qp[k][d] += sol_old_eldofs[k][i] * phi_x_fe_qp[SolFEType[k]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d]; </div>
<div class="line"><span class="lineno">  532</span>                                     }</div>
<div class="line"><span class="lineno">  533</span>       }        </div>
<div class="line"><span class="lineno">  534</span>    }</div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>  <span class="comment">//========= fill gauss value quantities ==================</span></div>
<div class="line"><span class="lineno">  537</span>         </div>
<div class="line"><span class="lineno">  538</span>    <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  539</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof_max; i++) {</div>
<div class="line"><span class="lineno">  540</span> </div>
<div class="line"><span class="lineno">  541</span>    <span class="comment">//BEGIN RESIDUALS A block ===========================</span></div>
<div class="line"><span class="lineno">  542</span>        <span class="keywordtype">double</span> Lap_rhs_i = 0.;</div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordtype">double</span> Lap_old_rhs_i = 0.;</div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0;  d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;  d++) {</div>
<div class="line"><span class="lineno">  545</span>          Lap_rhs_i     += phi_x_fe_qp[SolFEType[0]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] *     sol_grad_qp[0][d];</div>
<div class="line"><span class="lineno">  546</span>          Lap_old_rhs_i += phi_x_fe_qp[SolFEType[0]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] * sol_old_grad_qp[0][d];</div>
<div class="line"><span class="lineno">  547</span>        }</div>
<div class="line"><span class="lineno">  548</span>        Res_el[SolPdeIndex[0]][i] +=  - weight_qp * ( </div>
<div class="line"><span class="lineno">  549</span>                <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> * (</div>
<div class="line"><span class="lineno">  550</span>                     +       <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a>  * ( Lap_rhs_i     +  <a class="code hl_function" href="class_singularity.html#aa54e95abfc5f6e1311579328ccb446de">Singularity::function</a>(sol_qp[0])     * phi_fe_qp[ SolFEType[0] ][i] )     <span class="comment">// Laplacian + nonlinear term</span></div>
<div class="line"><span class="lineno">  551</span>                     + (1. - <a class="code hl_variable" href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">theta</a>) * ( Lap_old_rhs_i +  <a class="code hl_function" href="class_singularity.html#aa54e95abfc5f6e1311579328ccb446de">Singularity::function</a>(sol_old_qp[0]) * phi_fe_qp[ SolFEType[0] ][i] )     <span class="comment">// Laplacian + nonlinear term</span></div>
<div class="line"><span class="lineno">  552</span>                     ) </div>
<div class="line"><span class="lineno">  553</span>                    + (sol_qp[0] - sol_old_qp[0]) * phi_fe_qp[ SolFEType[0] ][i]        <span class="comment">// acceleration</span></div>
<div class="line"><span class="lineno">  554</span>            );</div>
<div class="line"><span class="lineno">  555</span>    <span class="comment">//END RESIDUALS A block ===========================</span></div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>        <span class="comment">// *** phi_j loop ***</span></div>
<div class="line"><span class="lineno">  559</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;nDof_max; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  560</span>            </div>
<div class="line"><span class="lineno">  561</span>          <span class="keywordtype">double</span> Lap_mat_i_j = 0.;</div>
<div class="line"><span class="lineno">  562</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) Lap_mat_i_j += phi_x_fe_qp[SolFEType[0]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] *</div>
<div class="line"><span class="lineno">  563</span>                                                           phi_x_fe_qp[SolFEType[0]][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span> </div>
<div class="line"><span class="lineno">  566</span>          Jac_el[SolPdeIndex[0]][SolPdeIndex[0]][i * Sol_n_el_dofs[0] + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += weight_qp * ( <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> * ( Lap_mat_i_j  + phi_fe_qp[ SolFEType[0] ][i] * <a class="code hl_function" href="class_singularity.html#a04bb9285472cbd58d0f42f03be773f15">Singularity::derivative</a>(  phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ) * phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] )</div>
<div class="line"><span class="lineno">  567</span>                                                                                                                + phi_fe_qp[ SolFEType[0] ][i] * phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] );</div>
<div class="line"><span class="lineno">  568</span>          </div>
<div class="line"><span class="lineno">  569</span>        }    <span class="comment">//end phij loop</span></div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>        </div>
<div class="line"><span class="lineno">  572</span>    }        <span class="comment">//end phii loop</span></div>
<div class="line"><span class="lineno">  573</span>    </div>
<div class="line"><span class="lineno">  574</span>  }          <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno">  575</span> </div>
<div class="line"><span class="lineno">  576</span><span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  577</span>    <span class="comment">//Sum the local matrices/vectors into the Global Matrix/Vector</span></div>
<div class="line"><span class="lineno">  578</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno">  579</span>      RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_el[SolPdeIndex[ivar]],L2G_dofmap[ivar]);</div>
<div class="line"><span class="lineno">  580</span>      JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">add_matrix_blocked</a>(Jac_el[SolPdeIndex[ivar]][SolPdeIndex[ivar]],L2G_dofmap[ivar],L2G_dofmap[ivar]);</div>
<div class="line"><span class="lineno">  581</span>    }</div>
<div class="line"><span class="lineno">  582</span>    <span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  583</span>  } <span class="comment">//end list of elements loop for each subdomain</span></div>
<div class="line"><span class="lineno">  584</span> </div>
<div class="line"><span class="lineno">  585</span>  JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">close</a>();</div>
<div class="line"><span class="lineno">  586</span>  RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  587</span>  <span class="comment">// ***************** END ASSEMBLY *******************</span></div>
<div class="line"><span class="lineno">  588</span>}</div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a789a31c8b16fddbe5ad66911ec7933c6"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a></div><div class="ttdeci">#define BIQUADR_FE</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00010">FETypeEnum.hpp:10</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_ac6579c52f41d7124718cc41736bae6d1"><div class="ttname"><a href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a></div><div class="ttdeci">#define NFE_FAMS</div><div class="ttdef"><b>Definition</b> <a href="_f_e_type_enum_8hpp_source.html#l00013">FETypeEnum.hpp:13</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex9_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="_m_g_a_m_r_2ex9_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_s_w_2ex3_2ex3_8cpp_html_a03e28be41881b703c836edbfe9b51b17"><div class="ttname"><a href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a></div><div class="ttdeci">double dt</div><div class="ttdef"><b>Definition</b> <a href="_s_w_2ex3_2ex3_8cpp_source.html#l00041">ex3.cpp:41</a></div></div>
<div class="ttc" id="aclass_singularity_html_a04bb9285472cbd58d0f42f03be773f15"><div class="ttname"><a href="class_singularity.html#a04bb9285472cbd58d0f42f03be773f15">Singularity::derivative</a></div><div class="ttdeci">static double derivative(const double &amp;v)</div><div class="ttdef"><b>Definition</b> <a href="ex20__time__dependent_8cpp_source.html#l00117">ex20_time_dependent.cpp:117</a></div></div>
<div class="ttc" id="aclass_singularity_html_aa54e95abfc5f6e1311579328ccb446de"><div class="ttname"><a href="class_singularity.html#aa54e95abfc5f6e1311579328ccb446de">Singularity::function</a></div><div class="ttdeci">static double function(const double &amp;v)</div><div class="ttdef"><b>Definition</b> <a href="ex20__time__dependent_8cpp_source.html#l00106">ex20_time_dependent.cpp:106</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a20ac8999e714492516cd8a2be53fb54f"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8cpp_source.html#l00071">LinearEquation.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_8hpp_source.html#l00118">LinearEquation.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html"><div class="ttname"><a href="classfemus_1_1_linear_equation_solver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition</b> <a href="_linear_equation_solver_8hpp_source.html#l00055">LinearEquationSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a24f5ab73a260d61b0ea9ff28f03bc815"><div class="ttname"><a href="classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">femus::Mesh::GetLevel</a></div><div class="ttdeci">unsigned GetLevel() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00260">Mesh.hpp:260</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a555c4982e81fc0042426c6741a792ca2"><div class="ttname"><a href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">femus::Mesh::_finiteElement</a></div><div class="ttdeci">const elem_type * _finiteElement[N_GEOM_ELS][5]</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00321">Mesh.hpp:321</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l01222">Mesh.cpp:1222</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ab5bcfd4be738d47ae025a06eddc66f61"><div class="ttname"><a href="classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">femus::Mesh::GetNumberOfElements</a></div><div class="ttdeci">unsigned GetNumberOfElements() const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00099">Mesh.hpp:99</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8hpp_source.html#l00162">Mesh.hpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="_mesh_8cpp_source.html#l01212">Mesh.cpp:1212</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a34890e6aa9d88946571fa050ee544c39"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">femus::MultiLevelProblem::GetQuadratureRule</a></div><div class="ttdeci">const Gauss &amp; GetQuadratureRule(const unsigned geom_elem_type) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00282">MultiLevelProblem.hpp:282</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a6dd8fec26a0ffbaae07e6df7ea42d12b"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">femus::MultiLevelProblem::_ml_sol</a></div><div class="ttdeci">MultiLevelSolution * _ml_sol</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00079">MultiLevelProblem.hpp:79</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00116">MultiLevelProblem.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_solution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition</b> <a href="_numeric_vector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a0440021963af01ac49a6f02df562e44b"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">femus::NumericVector::add_vector_blocked</a></div><div class="ttdeci">virtual void add_vector_blocked(const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)=0</div><div class="ttdoc">where v is a std::vector !!!fast</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5a9e3b150f6202162de4e350c39f544c"><div class="ttname"><a href="classfemus_1_1_solution.html#a5a9e3b150f6202162de4e350c39f544c">femus::Solution::_SolOld</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _SolOld</div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00167">Solution.hpp:167</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="_sparse_matrix_8hpp_source.html#l00047">SparseMatrix.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a45654dbe423d1970565b94c792ce6df3"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">femus::SparseMatrix::zero</a></div><div class="ttdeci">virtual void zero()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a6eb9fbd88830b0d10c88f0ce066b07ae"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">femus::SparseMatrix::close</a></div><div class="ttdeci">virtual void close() const =0</div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_aac0370cebbcc2d7111660dcf7115ebbf"><div class="ttname"><a href="classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">femus::SparseMatrix::add_matrix_blocked</a></div><div class="ttdeci">virtual void add_matrix_blocked(const std::vector&lt; double &gt; &amp;mat_value, const std::vector&lt; int &gt; &amp;rows, const std::vector&lt; int &gt; &amp;cols)=0</div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html"><div class="ttname"><a href="classfemus_1_1_transient_system.html">femus::TransientSystem</a></div><div class="ttdef"><b>Definition</b> <a href="_transient_system_8hpp_source.html#l00047">TransientSystem.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html_ac993f126734ae1c669e8470479d5c959"><div class="ttname"><a href="classfemus_1_1_transient_system.html#ac993f126734ae1c669e8470479d5c959">femus::TransientSystem::GetIntervalTime</a></div><div class="ttdeci">double GetIntervalTime() const</div><div class="ttdef"><b>Definition</b> <a href="_transient_system_8hpp_source.html#l00100">TransientSystem.hpp:100</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="_elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="anamespacefemus_html_a02e050d6adc3998272b7cd5fa4e7dc46"><div class="ttname"><a href="namespacefemus.html#a02e050d6adc3998272b7cd5fa4e7dc46">femus::theta</a></div><div class="ttdeci">double * theta</div><div class="ttdef"><b>Definition</b> <a href="_f_s_i_time_dependent_assembly_supg_g_c_l_8hpp_source.html#l00037">FSITimeDependentAssemblySupgGCL.hpp:37</a></div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition</b> <a href="_elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad8e0a8089537cded2d83078fb2083df6" name="ad8e0a8089537cded2d83078fb2083df6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad8e0a8089537cded2d83078fb2083df6">&#9670;&#160;</a></span>AssembleMatrixRes_VC()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void AssembleMatrixRes_VC </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ex20__time__dependent_8cpp_source.html#l00593">593</a> of file <a class="el" href="ex20__time__dependent_8cpp_source.html">ex20_time_dependent.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  593</span>                                                      {</div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span>  <a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientNonlinearImplicitSystem</a>* mlPdeSys = &amp; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientNonlinearImplicitSystem</a>&gt;(<span class="stringliteral">&quot;Timedep&quot;</span>);</div>
<div class="line"><span class="lineno">  596</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *ml_sol                  = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><span class="lineno">  599</span>  <a class="code hl_class" href="classfemus_1_1_solution.html">Solution</a>*  sol                              = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level);</div>
<div class="line"><span class="lineno">  600</span>  <a class="code hl_class" href="classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>*  pdeSys               = mlPdeSys-&gt;_LinSolver[level];</div>
<div class="line"><span class="lineno">  601</span>  <span class="keyword">const</span> <span class="keywordtype">char</span>* pdename                         = mlPdeSys-&gt;name().c_str();</div>
<div class="line"><span class="lineno">  602</span> </div>
<div class="line"><span class="lineno">  603</span>  <a class="code hl_class" href="classfemus_1_1_mesh.html">Mesh</a>*      msh           = ml_prob.<a class="code hl_variable" href="classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno">  604</span>  <a class="code hl_class" href="classfemus_1_1elem.html">elem</a>*      myel          = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">  605</span>  <a class="code hl_class" href="classfemus_1_1_sparse_matrix.html">SparseMatrix</a>*  JAC       = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><span class="lineno">  606</span>  <a class="code hl_class" href="classfemus_1_1_numeric_vector.html">NumericVector</a>* RES       = pdeSys-&gt;<a class="code hl_variable" href="classfemus_1_1_linear_equation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>;</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>  <span class="comment">// data</span></div>
<div class="line"><span class="lineno">  609</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  610</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><span class="lineno">  611</span>  <span class="keywordtype">unsigned</span> nel = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">GetNumberOfElements</a>();</div>
<div class="line"><span class="lineno">  612</span>  <span class="keywordtype">unsigned</span> igrid = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>();</div>
<div class="line"><span class="lineno">  613</span>  <span class="keywordtype">unsigned</span> iproc = msh-&gt;<a class="code hl_function" href="classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  614</span>  </div>
<div class="line"><span class="lineno">  615</span>  <span class="comment">// time dep data</span></div>
<div class="line"><span class="lineno">  616</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> = mlPdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_transient_system.html#ac993f126734ae1c669e8470479d5c959">GetIntervalTime</a>();</div>
<div class="line"><span class="lineno">  617</span><span class="comment">//   double theta = 0.5;</span></div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>  <span class="comment">//************** geometry (at dofs and quadrature points) *************************************  </span></div>
<div class="line"><span class="lineno">  620</span>  vector &lt; vector &lt; double &gt; &gt; coords_at_dofs(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  621</span>  <span class="keywordtype">unsigned</span> coords_fe_type = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE BIQUADRATIC)</span></div>
<div class="line"><span class="lineno">  622</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; coords_at_dofs.size(); i++)    coords_at_dofs[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  623</span> </div>
<div class="line"><span class="lineno">  624</span>  vector &lt; double &gt; coord_at_qp(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  625</span>  </div>
<div class="line"><span class="lineno">  626</span>  <span class="comment">//************* shape functions (at dofs and quadrature points) **************************************  </span></div>
<div class="line"><span class="lineno">  627</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> solType_max = <a class="code hl_define" href="_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>;  <span class="comment">//biquadratic</span></div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>  <span class="keywordtype">double</span> weight_qp; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  630</span>  </div>
<div class="line"><span class="lineno">  631</span>  vector &lt; vector &lt; double &gt; &gt; phi_fe_qp(<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno">  632</span>  vector &lt; vector &lt; double &gt; &gt; phi_x_fe_qp(<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno">  633</span>  vector &lt; vector &lt; double &gt; &gt; phi_xx_fe_qp(<a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {  </div>
<div class="line"><span class="lineno">  636</span>        phi_fe_qp[fe].reserve(max_size);</div>
<div class="line"><span class="lineno">  637</span>      phi_x_fe_qp[fe].reserve(max_size*<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  638</span>     phi_xx_fe_qp[fe].reserve(max_size*(3*(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>-1)));</div>
<div class="line"><span class="lineno">  639</span>   }</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>  </div>
<div class="line"><span class="lineno">  642</span>  <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  643</span>  <span class="comment">//********* WHOLE SET OF VARIABLES ****************** </span></div>
<div class="line"><span class="lineno">  644</span>  <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  645</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><span class="lineno">  646</span> </div>
<div class="line"><span class="lineno">  647</span>  vector &lt; std::string &gt; Solname(n_unknowns);     Solname[0] = <span class="stringliteral">&quot;u&quot;</span>;</div>
<div class="line"><span class="lineno">  648</span>  vector &lt; unsigned &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><span class="lineno">  649</span>  vector &lt; unsigned &gt; SolIndex(n_unknowns);</div>
<div class="line"><span class="lineno">  650</span>  vector &lt; unsigned int &gt; SolFEType(n_unknowns);     <span class="comment">//FEtype of each MultilevelSolution       </span></div>
<div class="line"><span class="lineno">  651</span>  vector &lt; unsigned int &gt; Sol_n_el_dofs(n_unknowns); <span class="comment">//number of element dofs</span></div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>  std::fill(Sol_n_el_dofs.begin(), Sol_n_el_dofs.end(), 0);</div>
<div class="line"><span class="lineno">  654</span> </div>
<div class="line"><span class="lineno">  655</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno">  656</span>    SolPdeIndex[ivar] = mlPdeSys-&gt;GetSolPdeIndex(  Solname[ivar].c_str() );</div>
<div class="line"><span class="lineno">  657</span>       SolIndex[ivar] = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>         ( Solname[ivar].c_str() );</div>
<div class="line"><span class="lineno">  658</span>      SolFEType[ivar] = ml_sol-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>  ( SolIndex[ivar]);</div>
<div class="line"><span class="lineno">  659</span>  }</div>
<div class="line"><span class="lineno">  660</span>  </div>
<div class="line"><span class="lineno">  661</span>  <span class="comment">//------------ quantities (at quadrature points) ---------------------</span></div>
<div class="line"><span class="lineno">  662</span>          vector&lt;double&gt;        sol_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  663</span>          vector&lt;double&gt;    sol_old_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  664</span>  vector&lt; vector&lt;double&gt; &gt; sol_grad_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  665</span>  vector&lt; vector&lt;double&gt; &gt; sol_old_grad_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  666</span>    </div>
<div class="line"><span class="lineno">  667</span>  std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  668</span>  std::fill(sol_old_qp.begin(), sol_old_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  669</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  670</span>        sol_grad_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  671</span>        std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno">  672</span>        sol_old_grad_qp[k].resize(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  673</span>        std::fill(sol_old_grad_qp[k].begin(), sol_old_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno">  674</span>    }</div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span>  <span class="comment">//----------- quantities (at dof objects) ------------------------------</span></div>
<div class="line"><span class="lineno">  677</span>  vector &lt; vector &lt; double &gt; &gt;     sol_eldofs(n_unknowns);</div>
<div class="line"><span class="lineno">  678</span>  vector &lt; vector &lt; double &gt; &gt;     sol_old_eldofs(n_unknowns);</div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;n_unknowns; k++) { sol_eldofs[k].reserve(max_size);</div>
<div class="line"><span class="lineno">  680</span>                                sol_old_eldofs[k].reserve(max_size);</div>
<div class="line"><span class="lineno">  681</span>   }</div>
<div class="line"><span class="lineno">  682</span>  </div>
<div class="line"><span class="lineno">  683</span>  <span class="comment">//******** linear system *******************************************  </span></div>
<div class="line"><span class="lineno">  684</span>  vector &lt; vector &lt; int &gt; &gt; L2G_dofmap(n_unknowns);     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) { L2G_dofmap[i].reserve(max_size); }</div>
<div class="line"><span class="lineno">  685</span>            vector&lt; int &gt;   L2G_dofmap_AllVars; L2G_dofmap_AllVars.reserve( n_unknowns*max_size );</div>
<div class="line"><span class="lineno">  686</span>          </div>
<div class="line"><span class="lineno">  687</span>  vector&lt; vector&lt; double &gt; &gt; Res_el(n_unknowns);</div>
<div class="line"><span class="lineno">  688</span>  vector&lt; vector&lt; vector&lt; double &gt; &gt; &gt; Jac_el(n_unknowns);</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) Res_el[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  691</span> </div>
<div class="line"><span class="lineno">  692</span>   <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) {</div>
<div class="line"><span class="lineno">  693</span>     Jac_el[i].resize(n_unknowns);</div>
<div class="line"><span class="lineno">  694</span>     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; n_unknowns; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  695</span>        Jac_el[i][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>].reserve(max_size*max_size);</div>
<div class="line"><span class="lineno">  696</span>     }</div>
<div class="line"><span class="lineno">  697</span>   }</div>
<div class="line"><span class="lineno">  698</span>  </div>
<div class="line"><span class="lineno">  699</span>  <span class="comment">// Set to zero all the entries of the matrix</span></div>
<div class="line"><span class="lineno">  700</span>  RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  701</span>  JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">zero</a>();</div>
<div class="line"><span class="lineno">  702</span>  </div>
<div class="line"><span class="lineno">  703</span>  </div>
<div class="line"><span class="lineno">  704</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> deltat_term = 1.;</div>
<div class="line"><span class="lineno">  705</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> lapl_term = 1.;</div>
<div class="line"><span class="lineno">  706</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> delta_g_term = 1.;</div>
<div class="line"><span class="lineno">  707</span> </div>
<div class="line"><span class="lineno">  708</span>  </div>
<div class="line"><span class="lineno">  709</span>  <span class="comment">// *** element loop ***</span></div>
<div class="line"><span class="lineno">  710</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc+1]; iel++) {</div>
<div class="line"><span class="lineno">  711</span> </div>
<div class="line"><span class="lineno">  712</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);    <span class="comment">// element geometry type</span></div>
<div class="line"><span class="lineno">  713</span>    </div>
<div class="line"><span class="lineno">  714</span>    <span class="comment">//******************** GEOMETRY ********************* </span></div>
<div class="line"><span class="lineno">  715</span>    <span class="keywordtype">unsigned</span> nDofx = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, coords_fe_type);       <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++)  coords_at_dofs[i].resize(nDofx);</div>
<div class="line"><span class="lineno">  717</span>    <span class="comment">// local storage of coordinates</span></div>
<div class="line"><span class="lineno">  718</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx; i++) {</div>
<div class="line"><span class="lineno">  719</span>      <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, coords_fe_type);       <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  720</span> </div>
<div class="line"><span class="lineno">  721</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  722</span>        coords_at_dofs[jdim][i] = (*msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[jdim])(xDof);    <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  723</span>      }</div>
<div class="line"><span class="lineno">  724</span>    }</div>
<div class="line"><span class="lineno">  725</span>  <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  726</span>    </div>
<div class="line"><span class="lineno">  727</span>  <span class="comment">//all vars###################################################################  </span></div>
<div class="line"><span class="lineno">  728</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordtype">unsigned</span>  ndofs_unk = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolFEType[k]);</div>
<div class="line"><span class="lineno">  730</span>       Sol_n_el_dofs[k] = ndofs_unk;</div>
<div class="line"><span class="lineno">  731</span>          sol_eldofs[k].resize(ndofs_unk);</div>
<div class="line"><span class="lineno">  732</span>      sol_old_eldofs[k].resize(ndofs_unk);</div>
<div class="line"><span class="lineno">  733</span>          L2G_dofmap[k].resize(ndofs_unk); </div>
<div class="line"><span class="lineno">  734</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ndofs_unk; i++) {</div>
<div class="line"><span class="lineno">  735</span>            <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolFEType[k]);                    <span class="comment">// global to global mapping between solution node and solution dof </span></div>
<div class="line"><span class="lineno">  736</span>                                                                                            <span class="comment">// via local to global solution node</span></div>
<div class="line"><span class="lineno">  737</span>           sol_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex[k]])(solDof);                            <span class="comment">// global extraction and local storage for the solution</span></div>
<div class="line"><span class="lineno">  738</span>       sol_old_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="classfemus_1_1_solution.html#a5a9e3b150f6202162de4e350c39f544c">_SolOld</a>[SolIndex[k]])(solDof);                         <span class="comment">// This is OLD in TIME, not in nonlinear loop</span></div>
<div class="line"><span class="lineno">  739</span>           L2G_dofmap[k][i] = pdeSys-&gt;<a class="code hl_function" href="classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(SolIndex[k], SolPdeIndex[k], i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><span class="lineno">  740</span>      }</div>
<div class="line"><span class="lineno">  741</span>    }</div>
<div class="line"><span class="lineno">  742</span>    </div>
<div class="line"><span class="lineno">  743</span>    </div>
<div class="line"><span class="lineno">  744</span>    <span class="keywordtype">unsigned</span> nDof_AllVars = 0;</div>
<div class="line"><span class="lineno">  745</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) { nDof_AllVars += Sol_n_el_dofs[k]; }</div>
<div class="line"><span class="lineno">  746</span>    <span class="comment">// TODO COMPUTE MAXIMUM maximum number of element dofs for one scalar variable</span></div>
<div class="line"><span class="lineno">  747</span>    <span class="keywordtype">int</span> nDof_max    =  0;   </div>
<div class="line"><span class="lineno">  748</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++)     {</div>
<div class="line"><span class="lineno">  749</span>          <span class="keywordflow">if</span>(Sol_n_el_dofs[k] &gt; nDof_max)    nDof_max = Sol_n_el_dofs[k];</div>
<div class="line"><span class="lineno">  750</span>       }</div>
<div class="line"><span class="lineno">  751</span>    </div>
<div class="line"><span class="lineno">  752</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  753</span>      L2G_dofmap[k].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  754</span> </div>
<div class="line"><span class="lineno">  755</span>      Res_el[SolPdeIndex[k]].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  756</span>      memset(&amp; Res_el[SolPdeIndex[k]][0], 0., Sol_n_el_dofs[k] * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>) );</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>      Jac_el[SolPdeIndex[k]][SolPdeIndex[k]].resize(Sol_n_el_dofs[k] * Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  760</span>      memset(&amp; Jac_el[SolPdeIndex[k]][SolPdeIndex[k]][0], 0., Sol_n_el_dofs[k] * Sol_n_el_dofs[k] * <span class="keyword">sizeof</span>(<span class="keywordtype">double</span>));</div>
<div class="line"><span class="lineno">  761</span>    }</div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>  <span class="comment">//all vars###################################################################    </span></div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>      <span class="comment">// *** quadrature loop ***</span></div>
<div class="line"><span class="lineno">  766</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_prob.<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom).GetGaussPointsNumber(); <a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  767</span>          </div>
<div class="line"><span class="lineno">  768</span>      <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno">  769</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code hl_define" href="_f_e_type_enum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><span class="lineno">  770</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][fe]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_at_dofs,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,phi_fe_qp[fe],phi_x_fe_qp[fe],phi_xx_fe_qp[fe]);</div>
<div class="line"><span class="lineno">  771</span>      }</div>
<div class="line"><span class="lineno">  772</span>      <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN</span></div>
<div class="line"><span class="lineno">  773</span>         msh-&gt;<a class="code hl_variable" href="classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coords_fe_type]-&gt;<a class="code hl_function" href="classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_at_dofs,<a class="code hl_variable" href="namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,phi_fe_qp[coords_fe_type],phi_x_fe_qp[coords_fe_type],phi_xx_fe_qp[coords_fe_type]);</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span>   <span class="comment">//========= fill gauss value quantities ==================   </span></div>
<div class="line"><span class="lineno">  776</span>   std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  777</span>   std::fill(sol_old_qp.begin(), sol_old_qp.end(), 0.);</div>
<div class="line"><span class="lineno">  778</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) { std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.); </div>
<div class="line"><span class="lineno">  779</span>                                                std::fill(sol_old_grad_qp[k].begin(), sol_old_grad_qp[k].end(), 0.);</div>
<div class="line"><span class="lineno">  780</span>                                            }</div>
<div class="line"><span class="lineno">  781</span>    </div>
<div class="line"><span class="lineno">  782</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  783</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[k]; i++) {</div>
<div class="line"><span class="lineno">  784</span>                                                             sol_qp[k]    +=     sol_eldofs[k][i] *   phi_fe_qp[SolFEType[k]][i];</div>
<div class="line"><span class="lineno">  785</span>                                                         sol_old_qp[k]    += sol_old_eldofs[k][i] *   phi_fe_qp[SolFEType[k]][i];</div>
<div class="line"><span class="lineno">  786</span>                   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {      sol_grad_qp[k][d] +=     sol_eldofs[k][i] * phi_x_fe_qp[SolFEType[k]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d]; </div>
<div class="line"><span class="lineno">  787</span>                                                         sol_old_grad_qp[k][d] += sol_old_eldofs[k][i] * phi_x_fe_qp[SolFEType[k]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d]; </div>
<div class="line"><span class="lineno">  788</span>                                     }</div>
<div class="line"><span class="lineno">  789</span>       }        </div>
<div class="line"><span class="lineno">  790</span>    }</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>  <span class="comment">//========= fill gauss value quantities ==================</span></div>
<div class="line"><span class="lineno">  793</span>         </div>
<div class="line"><span class="lineno">  794</span>    <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof_max; i++) {</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>    <span class="comment">//BEGIN RESIDUALS A block ===========================</span></div>
<div class="line"><span class="lineno">  798</span>        <span class="keywordtype">double</span> Lap_rhs_i = 0.;</div>
<div class="line"><span class="lineno">  799</span>        <span class="keywordtype">double</span> Lap_old_rhs_i = 0.;</div>
<div class="line"><span class="lineno">  800</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0;  d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;  d++) {</div>
<div class="line"><span class="lineno">  801</span>          Lap_rhs_i     += phi_x_fe_qp[SolFEType[0]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] *     sol_grad_qp[0][d];</div>
<div class="line"><span class="lineno">  802</span>          Lap_old_rhs_i += phi_x_fe_qp[SolFEType[0]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] * sol_old_grad_qp[0][d];</div>
<div class="line"><span class="lineno">  803</span>        }</div>
<div class="line"><span class="lineno">  804</span>        Res_el[SolPdeIndex[0]][i] +=  - weight_qp * ( </div>
<div class="line"><span class="lineno">  805</span>                       delta_g_term * <a class="code hl_function" href="class_singularity.html#aa54e95abfc5f6e1311579328ccb446de">Singularity::function</a>(sol_qp[0]) * <a class="code hl_function" href="class_singularity.html#a419eb3ec18055eb96f4335c22a091ceb">Singularity::g_vc</a>(sol_qp[0])     * phi_fe_qp[ SolFEType[0] ][i]</div>
<div class="line"><span class="lineno">  806</span>                     - delta_g_term * <a class="code hl_function" href="class_singularity.html#aa54e95abfc5f6e1311579328ccb446de">Singularity::function</a>(sol_qp[0]) * <a class="code hl_function" href="class_singularity.html#a419eb3ec18055eb96f4335c22a091ceb">Singularity::g_vc</a>(sol_old_qp[0]) * phi_fe_qp[ SolFEType[0] ][i]</div>
<div class="line"><span class="lineno">  807</span>                     + deltat_term * <a class="code hl_function" href="class_singularity.html#aa54e95abfc5f6e1311579328ccb446de">Singularity::function</a>(sol_qp[0]) * <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a>                               * phi_fe_qp[ SolFEType[0] ][i]</div>
<div class="line"><span class="lineno">  808</span>                     + lapl_term *  <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> * Lap_rhs_i</div>
<div class="line"><span class="lineno">  809</span>            );</div>
<div class="line"><span class="lineno">  810</span>    <span class="comment">//END RESIDUALS A block ===========================</span></div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span> </div>
<div class="line"><span class="lineno">  813</span>        <span class="comment">// *** phi_j loop ***</span></div>
<div class="line"><span class="lineno">  814</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>&lt;nDof_max; <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  815</span>            </div>
<div class="line"><span class="lineno">  816</span>          <span class="keywordtype">double</span> Lap_mat_i_j = 0.;</div>
<div class="line"><span class="lineno">  817</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) Lap_mat_i_j += phi_x_fe_qp[SolFEType[0]][i * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] *</div>
<div class="line"><span class="lineno">  818</span>                                                           phi_x_fe_qp[SolFEType[0]][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span> </div>
<div class="line"><span class="lineno">  821</span>          Jac_el[SolPdeIndex[0]][SolPdeIndex[0]][i * Sol_n_el_dofs[0] + <a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += weight_qp * (</div>
<div class="line"><span class="lineno">  822</span>                    + delta_g_term * phi_fe_qp[ SolFEType[0] ][i] * <a class="code hl_function" href="class_singularity.html#a04bb9285472cbd58d0f42f03be773f15">Singularity::derivative</a>(  phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ) * phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_function" href="class_singularity.html#a419eb3ec18055eb96f4335c22a091ceb">Singularity::g_vc</a>( phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ) </div>
<div class="line"><span class="lineno">  823</span>                    + delta_g_term * phi_fe_qp[ SolFEType[0] ][i] * <a class="code hl_function" href="class_singularity.html#aa54e95abfc5f6e1311579328ccb446de">Singularity::function</a>  (  phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ) * <a class="code hl_function" href="class_singularity.html#aa2109eae43d5912cd519b9cd9f11e5ff">Singularity::g_vc_derivative</a>( phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ) * phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] </div>
<div class="line"><span class="lineno">  824</span>                    </div>
<div class="line"><span class="lineno">  825</span>                    - delta_g_term * phi_fe_qp[ SolFEType[0] ][i] * <a class="code hl_function" href="class_singularity.html#a04bb9285472cbd58d0f42f03be773f15">Singularity::derivative</a>(  phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ) * phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_function" href="class_singularity.html#a419eb3ec18055eb96f4335c22a091ceb">Singularity::g_vc</a>( sol_old_qp[0] ) </div>
<div class="line"><span class="lineno">  826</span>                    </div>
<div class="line"><span class="lineno">  827</span>                    + deltat_term * phi_fe_qp[ SolFEType[0] ][i] * <a class="code hl_function" href="class_singularity.html#a04bb9285472cbd58d0f42f03be773f15">Singularity::derivative</a>(  phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] ) * phi_fe_qp[ SolFEType[0] ][<a class="code hl_variable" href="_m_g_a_m_r_2ex9_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> </div>
<div class="line"><span class="lineno">  828</span>                    + lapl_term * <a class="code hl_variable" href="_s_w_2ex3_2ex3_8cpp.html#a03e28be41881b703c836edbfe9b51b17">dt</a> * Lap_mat_i_j  </div>
<div class="line"><span class="lineno">  829</span>                                                                                          );</div>
<div class="line"><span class="lineno">  830</span>          </div>
<div class="line"><span class="lineno">  831</span>        }    <span class="comment">//end phij loop</span></div>
<div class="line"><span class="lineno">  832</span> </div>
<div class="line"><span class="lineno">  833</span>        </div>
<div class="line"><span class="lineno">  834</span>    }        <span class="comment">//end phii loop</span></div>
<div class="line"><span class="lineno">  835</span>    </div>
<div class="line"><span class="lineno">  836</span>  }          <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span><span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  839</span>    <span class="comment">//Sum the local matrices/vectors into the Global Matrix/Vector</span></div>
<div class="line"><span class="lineno">  840</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno">  841</span>      RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_el[SolPdeIndex[ivar]],L2G_dofmap[ivar]);</div>
<div class="line"><span class="lineno">  842</span>      JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">add_matrix_blocked</a>(Jac_el[SolPdeIndex[ivar]][SolPdeIndex[ivar]],L2G_dofmap[ivar],L2G_dofmap[ivar]);</div>
<div class="line"><span class="lineno">  843</span>    }</div>
<div class="line"><span class="lineno">  844</span>    <span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  845</span>  } <span class="comment">//end list of elements loop for each subdomain</span></div>
<div class="line"><span class="lineno">  846</span> </div>
<div class="line"><span class="lineno">  847</span>  JAC-&gt;<a class="code hl_function" href="classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">close</a>();</div>
<div class="line"><span class="lineno">  848</span>  RES-&gt;<a class="code hl_function" href="classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno">  849</span>  <span class="comment">// ***************** END ASSEMBLY *******************</span></div>
<div class="line"><span class="lineno">  850</span>}</div>
<div class="ttc" id="aclass_singularity_html_a419eb3ec18055eb96f4335c22a091ceb"><div class="ttname"><a href="class_singularity.html#a419eb3ec18055eb96f4335c22a091ceb">Singularity::g_vc</a></div><div class="ttdeci">static double g_vc(const double &amp;v)</div><div class="ttdef"><b>Definition</b> <a href="ex20__time__dependent_8cpp_source.html#l00129">ex20_time_dependent.cpp:129</a></div></div>
<div class="ttc" id="aclass_singularity_html_aa2109eae43d5912cd519b9cd9f11e5ff"><div class="ttname"><a href="class_singularity.html#aa2109eae43d5912cd519b9cd9f11e5ff">Singularity::g_vc_derivative</a></div><div class="ttdeci">static double g_vc_derivative(const double &amp;v)</div><div class="ttdef"><b>Definition</b> <a href="ex20__time__dependent_8cpp_source.html#l00138">ex20_time_dependent.cpp:138</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a29781a20c5dd4153c3c1cecf0ff328" name="a7a29781a20c5dd4153c3c1cecf0ff328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a29781a20c5dd4153c3c1cecf0ff328">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ex20__time__dependent_8cpp_source.html#l00154">154</a> of file <a class="el" href="ex20__time__dependent_8cpp_source.html">ex20_time_dependent.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  154</span>                               {</div>
<div class="line"><span class="lineno">  155</span> </div>
<div class="line"><span class="lineno">  156</span>  <span class="comment">// ======= Initialize ========================</span></div>
<div class="line"><span class="lineno">  157</span>  <span class="comment">// init Petsc-MPI communicator</span></div>
<div class="line"><span class="lineno">  158</span>  <a class="code hl_class" href="classfemus_1_1_femus_init.html">FemusInit</a> mpinit(argc, args, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  159</span>  </div>
<div class="line"><span class="lineno">  160</span>  <span class="comment">// ======= Files ========================</span></div>
<div class="line"><span class="lineno">  161</span>  <a class="code hl_class" href="classfemus_1_1_files.html">Files</a> files; </div>
<div class="line"><span class="lineno">  162</span>        files.<a class="code hl_function" href="classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">CheckIODirectories</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  163</span>        files.<a class="code hl_function" href="classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">RedirectCout</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <span class="comment">// ======= Quad Rule ===================</span></div>
<div class="line"><span class="lineno">  166</span>  std::string fe_quad_rule(<span class="stringliteral">&quot;seventh&quot;</span>);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>  <span class="comment">// ======= Mesh ========================</span></div>
<div class="line"><span class="lineno">  169</span>  <span class="comment">//Nondimensional quantity (Lref)</span></div>
<div class="line"><span class="lineno">  170</span>  <span class="keywordtype">double</span> Lref = 1.;</div>
<div class="line"><span class="lineno">  171</span>  </div>
<div class="line"><span class="lineno">  172</span><span class="comment">// 2d</span></div>
<div class="line"><span class="lineno">  173</span><span class="comment">//   const unsigned int nsub_x = 16;</span></div>
<div class="line"><span class="lineno">  174</span><span class="comment">//   const unsigned int nsub_y = 16;</span></div>
<div class="line"><span class="lineno">  175</span><span class="comment">//   const unsigned int nsub_z = 0;</span></div>
<div class="line"><span class="lineno">  176</span><span class="comment">//   const std::vector&lt;double&gt; xyz_min = {0.,0.,0.};</span></div>
<div class="line"><span class="lineno">  177</span><span class="comment">//   const std::vector&lt;double&gt; xyz_max = {1.,1.,0.};</span></div>
<div class="line"><span class="lineno">  178</span><span class="comment">//   const ElemType geom_elem_type = QUAD9;</span></div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span><span class="comment">// 1d</span></div>
<div class="line"><span class="lineno">  181</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nsub_x = 16;</div>
<div class="line"><span class="lineno">  182</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nsub_y = 0;</div>
<div class="line"><span class="lineno">  183</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nsub_z = 0;</div>
<div class="line"><span class="lineno">  184</span>  <span class="keyword">const</span> std::vector&lt;double&gt; xyz_min = {0.,0.,0.};</div>
<div class="line"><span class="lineno">  185</span>  <span class="keyword">const</span> std::vector&lt;double&gt; xyz_max = {1.,0.,0.};</div>
<div class="line"><span class="lineno">  186</span>  <span class="keyword">const</span> <a class="code hl_enumeration" href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a> geom_elem_type = <a class="code hl_enumvalue" href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a>;</div>
<div class="line"><span class="lineno">  187</span>  </div>
<div class="line"><span class="lineno">  188</span><span class="comment">//    std::string input_file = &quot;Lshape_longer_y.med&quot;;</span></div>
<div class="line"><span class="lineno">  189</span><span class="comment">//    std::string input_file = &quot;Lshape.med&quot;;</span></div>
<div class="line"><span class="lineno">  190</span><span class="comment">//    std::string input_file = &quot;circle_tri6.med&quot;;</span></div>
<div class="line"><span class="lineno">  191</span><span class="comment">//    std::string input_file = &quot;ellipse_tri6.med&quot;;</span></div>
<div class="line"><span class="lineno">  192</span><span class="comment">//    std::string input_file = &quot;ellipse_with_hole_tri6.med&quot;;</span></div>
<div class="line"><span class="lineno">  193</span>   std::string input_file = <span class="stringliteral">&quot;interval.med&quot;</span>;</div>
<div class="line"><span class="lineno">  194</span>   std::ostringstream mystream; mystream &lt;&lt; <span class="stringliteral">&quot;./&quot;</span> &lt;&lt; <a class="code hl_define" href="_femus_default_8hpp.html#a8e12c4926d6c36bf00835a092bc0e310">DEFAULT_INPUTDIR</a> &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; input_file;</div>
<div class="line"><span class="lineno">  195</span>  <span class="keyword">const</span> std::string infile = mystream.str();</div>
<div class="line"><span class="lineno">  196</span>  </div>
<div class="line"><span class="lineno">  197</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_msh;</div>
<div class="line"><span class="lineno">  198</span>    ml_msh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(nsub_x,nsub_y,nsub_z,xyz_min[0],xyz_max[0],xyz_min[1],xyz_max[1],xyz_min[2],xyz_max[2],geom_elem_type,fe_quad_rule.c_str());</div>
<div class="line"><span class="lineno">  199</span><span class="comment">//   ml_msh.ReadCoarseMesh(infile.c_str(),fe_quad_rule.c_str(),Lref);</span></div>
<div class="line"><span class="lineno">  200</span> </div>
<div class="line"><span class="lineno">  201</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> = 1;</div>
<div class="line"><span class="lineno">  202</span>  <span class="keywordtype">unsigned</span> numberOfSelectiveLevels = 0;</div>
<div class="line"><span class="lineno">  203</span>  ml_msh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">RefineMesh</a>(<a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> , <a class="code hl_variable" href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> + numberOfSelectiveLevels, NULL);</div>
<div class="line"><span class="lineno">  204</span>  ml_msh.<a class="code hl_function" href="classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  <span class="comment">// ======= Solution ========================</span></div>
<div class="line"><span class="lineno">  207</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> ml_sol(&amp;ml_msh);  <span class="comment">// define the multilevel solution and attach the mlMsh object to it</span></div>
<div class="line"><span class="lineno">  208</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> time_dep_flag = 2;</div>
<div class="line"><span class="lineno">  209</span>  </div>
<div class="line"><span class="lineno">  210</span>  <span class="comment">// ======= Unknowns and Fields ========================</span></div>
<div class="line"><span class="lineno">  211</span>  std::string unknown = <span class="stringliteral">&quot;u&quot;</span>;</div>
<div class="line"><span class="lineno">  212</span>  ml_sol.AddSolution(unknown.c_str(), <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, time_dep_flag);</div>
<div class="line"><span class="lineno">  213</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;time&quot;</span>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>, <a class="code hl_enumvalue" href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>, time_dep_flag);</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  <span class="comment">// ======= Problem ========================</span></div>
<div class="line"><span class="lineno">  216</span>  <a class="code hl_class" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob(&amp;ml_sol);  <span class="comment">// define the multilevel problem attach the ml_sol object to it</span></div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span>  ml_prob.SetQuadratureRuleAllGeomElems(fe_quad_rule);</div>
<div class="line"><span class="lineno">  219</span>  ml_prob.SetFilesHandler(&amp;files);</div>
<div class="line"><span class="lineno">  220</span>  </div>
<div class="line"><span class="lineno">  221</span>  <span class="comment">// ======= Initial values ========================</span></div>
<div class="line"><span class="lineno">  222</span>  ml_sol.Initialize(<span class="stringliteral">&quot;All&quot;</span>);    <span class="comment">// initialize all variables to zero</span></div>
<div class="line"><span class="lineno">  223</span>  ml_sol.Initialize(unknown.c_str(),   <a class="code hl_function" href="ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  224</span> </div>
<div class="line"><span class="lineno">  225</span>  <span class="comment">// ======= Boundary Conditions ========================</span></div>
<div class="line"><span class="lineno">  226</span>  ml_sol.AttachSetBoundaryConditionFunction(<a class="code hl_function" href="ex20__time__dependent_8cpp.html#ab699f948498a8ffc7ed78f4e05a0441a">SetBoundaryCondition</a>);  <span class="comment">// attach the boundary condition function and generate boundary data</span></div>
<div class="line"><span class="lineno">  227</span>  ml_sol.GenerateBdc(unknown.c_str()); <span class="comment">//&quot;Time_dependent&quot;);</span></div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>  <span class="comment">// ======= System ========================</span></div>
<div class="line"><span class="lineno">  230</span>  <a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientNonlinearImplicitSystem</a> &amp; system = ml_prob.add_system&lt;<a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientNonlinearImplicitSystem</a>&gt; (<span class="stringliteral">&quot;Timedep&quot;</span>);</div>
<div class="line"><span class="lineno">  231</span>  system.AddSolutionToSystemPDE(unknown.c_str());</div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>  system.init();  <span class="comment">// does it have to stay here or later?</span></div>
<div class="line"><span class="lineno">  234</span> </div>
<div class="line"><span class="lineno">  235</span>  system.SetAssembleFunction(<a class="code hl_function" href="ex20__time__dependent_8cpp.html#ad8e0a8089537cded2d83078fb2083df6">AssembleMatrixRes_VC</a>);</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>  system.SetOuterSolver(<a class="code hl_enumvalue" href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>);</div>
<div class="line"><span class="lineno">  238</span>  system.SetSolverFineGrids(<a class="code hl_enumvalue" href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>);</div>
<div class="line"><span class="lineno">  239</span>  system.SetPreconditionerFineGrids(<a class="code hl_enumvalue" href="_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da">MLU_PRECOND</a>);</div>
<div class="line"><span class="lineno">  240</span>  </div>
<div class="line"><span class="lineno">  241</span><span class="comment">//   system.SetMaxNumberOfLinearIterations(1);</span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">//   system.SetAbsoluteLinearConvergenceTolerance(1.e-8);</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment">//   system.SetMgType(V_CYCLE);</span></div>
<div class="line"><span class="lineno">  244</span>  system.SetMaxNumberOfNonLinearIterations(30);</div>
<div class="line"><span class="lineno">  245</span>  system.SetNonLinearConvergenceTolerance(1.e-8);</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  <span class="comment">//**************</span></div>
<div class="line"><span class="lineno">  248</span>  ml_sol.SetWriter(<a class="code hl_enumvalue" href="_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);   <span class="comment">//need to move this here for the DebugNonlinear function</span></div>
<div class="line"><span class="lineno">  249</span>  ml_sol.GetWriter()-&gt;SetDebugOutput(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  250</span><span class="comment">//   system.SetDebugNonlinear(true);</span></div>
<div class="line"><span class="lineno">  251</span>  <span class="comment">//**************</span></div>
<div class="line"><span class="lineno">  252</span>  </div>
<div class="line"><span class="lineno">  253</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> fine_lev = ml_sol._mlMesh-&gt;GetNumberOfLevels() - 1;</div>
<div class="line"><span class="lineno">  254</span>  </div>
<div class="line"><span class="lineno">  255</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> total_time = 1.;  </div>
<div class="line"><span class="lineno">  256</span>  </div>
<div class="line"><span class="lineno">  257</span>  std::vector&lt; unsigned int &gt; n_steps =  {2000<span class="comment">/*6*/</span><span class="comment">/*2, */</span><span class="comment">/*4, 8, 16*/</span>};</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span><span class="comment">//   std::vector&lt; MultiLevelSolution &gt;  last_sol(n_steps.size(),  &amp; ml_msh);  </span></div>
<div class="line"><span class="lineno">  260</span><span class="comment">//   std::vector&lt; Solution &gt;  last_sol(n_steps.size(),  ml_msh.GetLevel(fine_lev) );  </span></div>
<div class="line"><span class="lineno">  261</span>  std::vector&lt; NumericVector* &gt;  last_sol(n_steps.size());</div>
<div class="line"><span class="lineno">  262</span>  </div>
<div class="line"><span class="lineno">  263</span>  </div>
<div class="line"><span class="lineno">  264</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; n_steps.size(); i++) {</div>
<div class="line"><span class="lineno">  265</span>      </div>
<div class="line"><span class="lineno">  266</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> interval_time = total_time/n_steps[i];</div>
<div class="line"><span class="lineno">  267</span>  </div>
<div class="line"><span class="lineno">  268</span>  system.<a class="code hl_function" href="classfemus_1_1_transient_system.html#ac4c3f2853cb04407fbe2975d18c9bf2a">SetIntervalTime</a>(interval_time);</div>
<div class="line"><span class="lineno">  269</span>  </div>
<div class="line"><span class="lineno">  270</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> write_interval = 1.; <span class="comment">//n_steps[i];</span></div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>  <span class="keyword">const</span> <span class="keywordtype">bool</span> detect_quench = <span class="keyword">false</span>; <span class="comment">// Set to 0 for no adaptation and 1 for adaptation (which starts at a specified solution magnitude)</span></div>
<div class="line"><span class="lineno">  273</span>     </div>
<div class="line"><span class="lineno">  274</span>     </div>
<div class="line"><span class="lineno">  275</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> time_step = 0; time_step &lt; n_steps[i]; time_step++) {</div>
<div class="line"><span class="lineno">  276</span>      </div>
<div class="line"><span class="lineno">  277</span>  <span class="comment">// ======= Check for quenching ==========</span></div>
<div class="line"><span class="lineno">  278</span>    <span class="keywordflow">if</span> ( detect_quench == <span class="keyword">true</span> ) {</div>
<div class="line"><span class="lineno">  279</span>      <span class="keywordflow">if</span> ( (ml_sol.GetSolutionLevel( fine_lev ) )-&gt;GetSolutionName( unknown.c_str() ).linfty_norm() &gt;= 0.99 ) { std::cout &lt;&lt; <span class="stringliteral">&quot;Detected quenching&quot;</span> &lt;&lt; std::endl; exit(0); }</div>
<div class="line"><span class="lineno">  280</span>    }</div>
<div class="line"><span class="lineno">  281</span>      </div>
<div class="line"><span class="lineno">  282</span>  <span class="comment">// ======= Print ========================</span></div>
<div class="line"><span class="lineno">  283</span>    <span class="keywordflow">if</span> ( !(time_step % write_interval) ) {</div>
<div class="line"><span class="lineno">  284</span> </div>
<div class="line"><span class="lineno">  285</span>        std::vector &lt; std::string &gt; variablesToBePrinted;</div>
<div class="line"><span class="lineno">  286</span>        variablesToBePrinted.push_back(<span class="stringliteral">&quot;all&quot;</span>);</div>
<div class="line"><span class="lineno">  287</span>        std::string run_prefix = <span class="stringliteral">&quot;n_steps_&quot;</span> + std::to_string(n_steps[i]);</div>
<div class="line"><span class="lineno">  288</span>        ml_sol.GetWriter()-&gt;Write(run_prefix, files.<a class="code hl_function" href="classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(), <span class="stringliteral">&quot;biquadratic&quot;</span>, variablesToBePrinted, time_step);    <span class="comment">// print solutions</span></div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>    }</div>
<div class="line"><span class="lineno">  291</span>    </div>
<div class="line"><span class="lineno">  292</span>    <span class="comment">// ======= Solve ========================</span></div>
<div class="line"><span class="lineno">  293</span>    std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  294</span>    std::cout &lt;&lt; <span class="stringliteral">&quot; *********** Timedep ************ &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>    system.SetOuterSolver(<a class="code hl_enumvalue" href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>);</div>
<div class="line"><span class="lineno">  297</span>    system.<a class="code hl_function" href="classfemus_1_1_transient_system.html#adea269a19e84a9f6db792b96d159318b">MGsolve</a>();</div>
<div class="line"><span class="lineno">  298</span>    </div>
<div class="line"><span class="lineno">  299</span>    </div>
<div class="line"><span class="lineno">  300</span>      ml_sol.Set(<span class="stringliteral">&quot;time&quot;</span>, <a class="code hl_function" href="ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  301</span>      </div>
<div class="line"><span class="lineno">  302</span><span class="comment">//       system.compute_convergence_rate();</span></div>
<div class="line"><span class="lineno">  303</span>      </div>
<div class="line"><span class="lineno">  304</span>    <span class="comment">// ======= Update Solution ===============</span></div>
<div class="line"><span class="lineno">  305</span>    system.<a class="code hl_function" href="classfemus_1_1_transient_system.html#a6bbd657b80c05844fca4b683c90d879e">CopySolutionToOldSolution</a>();</div>
<div class="line"><span class="lineno">  306</span>    </div>
<div class="line"><span class="lineno">  307</span>     </div>
<div class="line"><span class="lineno">  308</span>     <span class="keywordtype">bool</span> adapt_flag = 0; <span class="comment">// Set to 0 for no adaptation and 1 for adaptation (which starts at a specified solution magnitude)</span></div>
<div class="line"><span class="lineno">  309</span>     </div>
<div class="line"><span class="lineno">  310</span>      <span class="keywordflow">if</span> ( adapt_flag == 1 ) {</div>
<div class="line"><span class="lineno">  311</span>      </div>
<div class="line"><span class="lineno">  312</span>        <span class="keywordtype">double</span> AdaptStarter = 0.85; <span class="comment">// Value of ||u||_\infty at which to start adaptation</span></div>
<div class="line"><span class="lineno">  313</span>        <span class="keywordflow">if</span> ( (ml_sol.GetSolutionLevel( fine_lev ) )-&gt;GetSolutionName( unknown.c_str() ).linfty_norm() &gt;= AdaptStarter ) {</div>
<div class="line"><span class="lineno">  314</span>     </div>
<div class="line"><span class="lineno">  315</span>            <span class="keywordtype">double</span> NonlinearityTracker = 0.1 * <a class="code hl_function" href="class_singularity.html#a04bb9285472cbd58d0f42f03be773f15">Singularity::derivative</a>( (ml_sol.GetSolutionLevel( fine_lev ) )-&gt;GetSolutionName( unknown.c_str() ).linfty_norm() ) ;</div>
<div class="line"><span class="lineno">  316</span>            <span class="keywordtype">double</span> NewTime = std::min( system.<a class="code hl_function" href="classfemus_1_1_transient_system.html#ac993f126734ae1c669e8470479d5c959">GetIntervalTime</a>(), NonlinearityTracker );</div>
<div class="line"><span class="lineno">  317</span>            <span class="keywordtype">double</span> minTimeStep = 0.001; <span class="comment">// Minimum step-size controller</span></div>
<div class="line"><span class="lineno">  318</span>            <span class="keywordtype">double</span> NewTimeFixed = std::max( NewTime , minTimeStep );</div>
<div class="line"><span class="lineno">  319</span>            system.<a class="code hl_function" href="classfemus_1_1_transient_system.html#ac4c3f2853cb04407fbe2975d18c9bf2a">SetIntervalTime</a>(NewTimeFixed);</div>
<div class="line"><span class="lineno">  320</span>          }    </div>
<div class="line"><span class="lineno">  321</span>     </div>
<div class="line"><span class="lineno">  322</span>        }</div>
<div class="line"><span class="lineno">  323</span>       </div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>     } <span class="comment">//end loop timestep</span></div>
<div class="line"><span class="lineno">  326</span>     </div>
<div class="line"><span class="lineno">  327</span>     <span class="comment">//here is where we store the ends of the simulations</span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">//      last_sol[i] =  ml_sol;</span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">//      last_sol[i] = *( ml_sol.GetSolutionLevel( fine_lev ) )/*-&gt;GetSolutionName( unknown.c_str() )*/;</span></div>
<div class="line"><span class="lineno">  330</span>     last_sol[i] =  &amp;( ml_sol.GetSolutionLevel( fine_lev ) )-&gt;GetSolutionName( unknown.c_str() );</div>
<div class="line"><span class="lineno">  331</span>  </div>
<div class="line"><span class="lineno">  332</span>  }</div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span><span class="comment">//   last_sol[0]-&gt;add(-1., *(last_sol[1]));    const double numerator   = last_sol[0]-&gt;linfty_norm();</span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">//   last_sol[2]-&gt;add(-1., *(last_sol[1]));   const double denominator = last_sol[2]-&gt;linfty_norm();</span></div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  338</span>}</div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627"><div class="ttname"><a href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition</b> <a href="_elem_type_enum_8hpp_source.html#l00006">ElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134"><div class="ttname"><a href="_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a></div><div class="ttdeci">@ EDGE3</div><div class="ttdef"><b>Definition</b> <a href="_elem_type_enum_8hpp_source.html#l00008">ElemTypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a></div><div class="ttdeci">@ ZERO</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00014">FElemTypeEnum.hpp:14</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a></div><div class="ttdeci">@ DISCONTINUOUS_POLYNOMIAL</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00006">FElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_a8e12c4926d6c36bf00835a092bc0e310"><div class="ttname"><a href="_femus_default_8hpp.html#a8e12c4926d6c36bf00835a092bc0e310">DEFAULT_INPUTDIR</a></div><div class="ttdeci">#define DEFAULT_INPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="_femus_default_8hpp_source.html#l00039">FemusDefault.hpp:39</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_a0aca793820b6ff7705450e2043256938"><div class="ttname"><a href="_i_s_m_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a></div><div class="ttdeci">unsigned numberOfUniformLevels</div><div class="ttdef"><b>Definition</b> <a href="_i_s_m_2ex4_2ex4_8cpp_source.html#l00089">ex4.cpp:89</a></div></div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da"><div class="ttname"><a href="_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfab3d0bb9f65f94b9bb926882ed6abc7da">MLU_PRECOND</a></div><div class="ttdeci">@ MLU_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="_precondtype_enum_8hpp_source.html#l00024">PrecondtypeEnum.hpp:24</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab"><div class="ttname"><a href="_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a></div><div class="ttdeci">@ PREONLY</div><div class="ttdef"><b>Definition</b> <a href="_solvertype_enum_8hpp_source.html#l00028">SolvertypeEnum.hpp:27</a></div></div>
<div class="ttc" id="a_writer_enum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition</b> <a href="_writer_enum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html"><div class="ttname"><a href="classfemus_1_1_files.html">femus::Files</a></div><div class="ttdef"><b>Definition</b> <a href="_files_8hpp_source.html#l00040">Files.hpp:40</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_aac199200ffda7ba50611cc41f6a874bc"><div class="ttname"><a href="classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">femus::Files::RedirectCout</a></div><div class="ttdeci">void RedirectCout(const bool redirect_cout_to_file) const</div><div class="ttdef"><b>Definition</b> <a href="_files_8cpp_source.html#l00553">Files.cpp:553</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab8c41974c4980d87c7e1467b153854e6"><div class="ttname"><a href="classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">femus::Files::CheckIODirectories</a></div><div class="ttdeci">void CheckIODirectories(const bool use_output_time_folder)</div><div class="ttdef"><b>Definition</b> <a href="_files_8cpp_source.html#l00515">Files.cpp:515</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition</b> <a href="_files_8hpp_source.html#l00064">Files.hpp:64</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a06c4fe014434c2bafdd2c6e94e018620"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">femus::MultiLevelMesh::RefineMesh</a></div><div class="ttdeci">void RefineMesh(const unsigned short &amp;igridn, const unsigned short &amp;igridr, bool(*SetRefinementFlag)(const std::vector&lt; double &gt; &amp;x, const int &amp;ElemGroupNumber, const int &amp;level))</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00495">MultiLevelMesh.cpp:495</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a09c12975f18035d5369ae411c0208648"><div class="ttname"><a href="classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">femus::MultiLevelMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo()</div><div class="ttdef"><b>Definition</b> <a href="_multi_level_mesh_8cpp_source.html#l00462">MultiLevelMesh.cpp:462</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html_a6bbd657b80c05844fca4b683c90d879e"><div class="ttname"><a href="classfemus_1_1_transient_system.html#a6bbd657b80c05844fca4b683c90d879e">femus::TransientSystem::CopySolutionToOldSolution</a></div><div class="ttdeci">virtual void CopySolutionToOldSolution()</div><div class="ttdef"><b>Definition</b> <a href="_transient_system_8cpp_source.html#l00059">TransientSystem.cpp:59</a></div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html_ac4c3f2853cb04407fbe2975d18c9bf2a"><div class="ttname"><a href="classfemus_1_1_transient_system.html#ac4c3f2853cb04407fbe2975d18c9bf2a">femus::TransientSystem::SetIntervalTime</a></div><div class="ttdeci">void SetIntervalTime(const double dt)</div><div class="ttdef"><b>Definition</b> <a href="_transient_system_8hpp_source.html#l00094">TransientSystem.hpp:94</a></div></div>
<div class="ttc" id="aclassfemus_1_1_transient_system_html_adea269a19e84a9f6db792b96d159318b"><div class="ttname"><a href="classfemus_1_1_transient_system.html#adea269a19e84a9f6db792b96d159318b">femus::TransientSystem::MGsolve</a></div><div class="ttdeci">virtual void MGsolve(const MgSmootherType &amp;mgSmootherType=MULTIPLICATIVE)</div><div class="ttdef"><b>Definition</b> <a href="_transient_system_8cpp_source.html#l00104">TransientSystem.cpp:104</a></div></div>
<div class="ttc" id="aex20__time__dependent_8cpp_html_ab651207781b52680d3f1d7725793b81c"><div class="ttname"><a href="ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a></div><div class="ttdeci">double SetInitialCondition(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</div><div class="ttdef"><b>Definition</b> <a href="ex20__time__dependent_8cpp_source.html#l00084">ex20_time_dependent.cpp:84</a></div></div>
<div class="ttc" id="aex20__time__dependent_8cpp_html_ab699f948498a8ffc7ed78f4e05a0441a"><div class="ttname"><a href="ex20__time__dependent_8cpp.html#ab699f948498a8ffc7ed78f4e05a0441a">SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int FaceName, const double time)</div><div class="ttdef"><b>Definition</b> <a href="ex20__time__dependent_8cpp_source.html#l00056">ex20_time_dependent.cpp:56</a></div></div>
<div class="ttc" id="aex20__time__dependent_8cpp_html_ad8e0a8089537cded2d83078fb2083df6"><div class="ttname"><a href="ex20__time__dependent_8cpp.html#ad8e0a8089537cded2d83078fb2083df6">AssembleMatrixRes_VC</a></div><div class="ttdeci">void AssembleMatrixRes_VC(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="ex20__time__dependent_8cpp_source.html#l00593">ex20_time_dependent.cpp:593</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab699f948498a8ffc7ed78f4e05a0441a" name="ab699f948498a8ffc7ed78f4e05a0441a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab699f948498a8ffc7ed78f4e05a0441a">&#9670;&#160;</a></span>SetBoundaryCondition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryCondition </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>FaceName</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ex20__time__dependent_8cpp_source.html#l00056">56</a> of file <a class="el" href="ex20__time__dependent_8cpp_source.html">ex20_time_dependent.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>                                                                   {</div>
<div class="line"><span class="lineno">   58</span>  <span class="keywordtype">bool</span> test = 1; <span class="comment">//Dirichlet</span></div>
<div class="line"><span class="lineno">   59</span>  value = 0.;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span><span class="comment">//   if(!strcmp(name,&quot;u&quot;)) {</span></div>
<div class="line"><span class="lineno">   62</span><span class="comment">//     if (1==FaceName) { //inflow</span></div>
<div class="line"><span class="lineno">   63</span><span class="comment">//       test=1;</span></div>
<div class="line"><span class="lineno">   64</span><span class="comment">//      value=0.;</span></div>
<div class="line"><span class="lineno">   65</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">   66</span><span class="comment">//     else if(2==FaceName ){  //outflow</span></div>
<div class="line"><span class="lineno">   67</span><span class="comment">//      test=1;</span></div>
<div class="line"><span class="lineno">   68</span><span class="comment">//      value=0.;</span></div>
<div class="line"><span class="lineno">   69</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">   70</span><span class="comment">//     else if(3==FaceName ){  // no-slip fluid wall</span></div>
<div class="line"><span class="lineno">   71</span><span class="comment">//       test=1;</span></div>
<div class="line"><span class="lineno">   72</span><span class="comment">//       value=0.;</span></div>
<div class="line"><span class="lineno">   73</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">   74</span><span class="comment">//     else if(4==FaceName ){  // no-slip solid wall</span></div>
<div class="line"><span class="lineno">   75</span><span class="comment">//       test=1;</span></div>
<div class="line"><span class="lineno">   76</span><span class="comment">//       value=0.;</span></div>
<div class="line"><span class="lineno">   77</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">   78</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  <span class="keywordflow">return</span> test;</div>
<div class="line"><span class="lineno">   82</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab651207781b52680d3f1d7725793b81c" name="ab651207781b52680d3f1d7725793b81c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab651207781b52680d3f1d7725793b81c">&#9670;&#160;</a></span>SetInitialCondition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double SetInitialCondition </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="ex20__time__dependent_8cpp_source.html#l00084">84</a> of file <a class="el" href="ex20__time__dependent_8cpp_source.html">ex20_time_dependent.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   84</span>                                                                                                                 {</div>
<div class="line"><span class="lineno">   85</span>         </div>
<div class="line"><span class="lineno">   86</span>           <span class="keywordtype">double</span> value = 0.;</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>             <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;u&quot;</span>)) {</div>
<div class="line"><span class="lineno">   89</span>                 value = 0.; <span class="comment">// sin(M_PI * x[0]) * sin(M_PI * x[1]);</span></div>
<div class="line"><span class="lineno">   90</span>             }</div>
<div class="line"><span class="lineno">   91</span>             <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;time&quot;</span>)) {</div>
<div class="line"><span class="lineno">   92</span>                 value = ml_prob-&gt;<a class="code hl_function" href="classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="classfemus_1_1_transient_system.html">TransientNonlinearImplicitSystem</a>&gt;(<span class="stringliteral">&quot;Timedep&quot;</span>).GetTime();</div>
<div class="line"><span class="lineno">   93</span>             }</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>           </div>
<div class="line"><span class="lineno">   96</span>      <span class="keywordflow">return</span> value;   </div>
<div class="line"><span class="lineno">   97</span>}</div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="dir_e4a47d695701f5c84fc8b0d5cd2e604d.html">00_tutorial</a></li><li class="navelem"><a class="el" href="dir_75d530c558ba9eac13a0e5fd3423e08f.html">ex20_time_dependent</a></li><li class="navelem"><a class="el" href="ex20__time__dependent_8cpp.html">ex20_time_dependent.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
