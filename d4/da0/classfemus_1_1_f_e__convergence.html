<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: femus::FE_convergence&lt; real_num &gt; Class Template Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d4/da0/classfemus_1_1_f_e__convergence.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pri-static-methods">Static Private Member Functions</a> &#124;
<a href="#pri-static-attribs">Static Private Attributes</a> &#124;
<a href="../../d2/dfd/classfemus_1_1_f_e__convergence-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">femus::FE_convergence&lt; real_num &gt; Class Template Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>&gt;</code></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:a17e49fc38b543aca1c7d97e188f392eb"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a17e49fc38b543aca1c7d97e188f392eb">convergence_study</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob, <a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;ml_mesh, <a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> *ml_mesh_all_levels_needed_for_incremental, const unsigned max_number_of_meshes, const std::vector&lt; bool &gt; convergence_rate_computation_method_Flag, const std::vector&lt; bool &gt; volume_or_boundary_Flag, const std::vector&lt; bool &gt; sobolev_norms_Flag, const bool main_in_has_equation_solve, const <a class="el" href="../../dc/dba/classfemus_1_1_solution__generation__single__level.html">Solution_generation_single_level</a> &amp;main_in, const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns, const std::vector&lt; <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; double &gt; * &gt; &amp;exact_sol, const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a51e1cff061477ba02672e5ef790c465f">MultiLevelSolution::InitFuncMLProb</a> <a class="el" href="../../d8/dea/namespacefemus.html#ad7f0d0e656e4d135c7dd2869a4d87c1d">SetInitialCondition</a>, const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac2ecfa36125c8626b6fdf20f71dbde0c">MultiLevelSolution::BoundaryFuncMLProb</a> <a class="el" href="../../d8/dea/namespacefemus.html#a47ed9315ef75de950a13364e002d5311">SetBoundaryCondition</a>)</td></tr>
<tr class="separator:a17e49fc38b543aca1c7d97e188f392eb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3d845c73067be4a8865f78c7133239a8"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3d845c73067be4a8865f78c7133239a8">output_convergence_order</a> (const std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;norm, const unsigned int u, const unsigned int i)</td></tr>
<tr class="separator:a3d845c73067be4a8865f78c7133239a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-methods" name="pri-static-methods"></a>
Static Private Member Functions</h2></td></tr>
<tr class="memitem:a5f019f4ec34524e79a5a6e4de37e90e1"><td class="memItemLeft" align="right" valign="top">static const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a5f019f4ec34524e79a5a6e4de37e90e1">initialize_convergence_study</a> (const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob, const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns, const std::vector&lt; <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; double &gt; * &gt; &amp;exact_sol, <a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;ml_mesh_all_levels_needed_for_incremental, const unsigned max_number_of_meshes, const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a51e1cff061477ba02672e5ef790c465f">MultiLevelSolution::InitFuncMLProb</a> SetInitialCondition_in, const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac2ecfa36125c8626b6fdf20f71dbde0c">MultiLevelSolution::BoundaryFuncMLProb</a> <a class="el" href="../../d8/dea/namespacefemus.html#a47ed9315ef75de950a13364e002d5311">SetBoundaryCondition</a>, const bool main_in_has_equation_solve)</td></tr>
<tr class="separator:a5f019f4ec34524e79a5a6e4de37e90e1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad95c3acc820b1640285ec723f0648644"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; std::vector&lt; real_num &gt; &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#ad95c3acc820b1640285ec723f0648644">initialize_vector_of_norms</a> (const unsigned unknowns_size, const unsigned max_number_of_meshes)</td></tr>
<tr class="separator:ad95c3acc820b1640285ec723f0648644"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a10e7518aaa5bfefd09a918860b0d64d7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a10e7518aaa5bfefd09a918860b0d64d7">output_convergence_order_all</a> (const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns, const std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;norms, const unsigned sobolev_norms, const unsigned volume_or_boundary, const unsigned convergence_computation_method)</td></tr>
<tr class="separator:a10e7518aaa5bfefd09a918860b0d64d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb3b9278b60366eeb98c14ad512c94d9"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#adb3b9278b60366eeb98c14ad512c94d9">output_convergence_rate</a> (double norm_i, double norm_ip1, std::string norm_name, unsigned maxNumberOfMeshes, int loop_i)</td></tr>
<tr class="separator:adb3b9278b60366eeb98c14ad512c94d9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1a65f8a8e81a8a13093a1ef34d55a40d"><td class="memItemLeft" align="right" valign="top">static std::vector&lt; real_num &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a1a65f8a8e81a8a13093a1ef34d55a40d">compute_error_norms_volume_or_boundary_with_analytical_sol_or_not</a> (const std::vector&lt; std::vector&lt; <a class="el" href="../../da/ddf/classfemus_1_1elem__type__templ__base.html">elem_type_templ_base</a>&lt; real_num, double &gt; * &gt; &gt; &amp;elem_all, const std::vector&lt; <a class="el" href="../../db/db8/classfemus_1_1_gauss.html">Gauss</a> &gt; &amp;quad_rules, const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *ml_sol, const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *ml_sol_all_levels_needed_for_incremental, const std::string &amp;unknown, const <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; real_num &gt; *ex_sol_in, const unsigned current_level, const unsigned sobolev_norms, const unsigned convergence_rate_computation_method, const unsigned volume_or_boundary)</td></tr>
<tr class="separator:a1a65f8a8e81a8a13093a1ef34d55a40d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa0a1dc7c62520f7573a2d19b383f6f97"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#aa0a1dc7c62520f7573a2d19b383f6f97">compute_error_norms_per_unknown_per_level</a> (const std::vector&lt; std::vector&lt; <a class="el" href="../../da/ddf/classfemus_1_1elem__type__templ__base.html">elem_type_templ_base</a>&lt; real_num, double &gt; * &gt; &gt; &amp;elem_all, const std::vector&lt; <a class="el" href="../../db/db8/classfemus_1_1_gauss.html">Gauss</a> &gt; &amp;quad_rules, const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *ml_sol_single_level, <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *ml_sol_all_levels_needed_for_incremental, const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns, const std::vector&lt; <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; real_num &gt; * &gt; &amp;ex_sol_in, std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;norms, const unsigned i, const unsigned sobolev_norms, const unsigned volume_or_boundary, const unsigned convergence_rate_computation_method)</td></tr>
<tr class="separator:aa0a1dc7c62520f7573a2d19b383f6f97"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-static-attribs" name="pri-static-attribs"></a>
Static Private Attributes</h2></td></tr>
<tr class="memitem:a3fd9d8b24165dfde984e1cff795982be"><td class="memItemLeft" align="right" valign="top">static const std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3fd9d8b24165dfde984e1cff795982be">norm_names</a> = {&quot;L2-NORM&quot;, &quot;H1-SEMINORM&quot;}</td></tr>
<tr class="separator:a3fd9d8b24165dfde984e1cff795982be"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae5fde53ca79bcb98cffa4ab41ea66b23"><td class="memItemLeft" align="right" valign="top">static const std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#ae5fde53ca79bcb98cffa4ab41ea66b23">convergence_computation_names</a> = {&quot;Incremental&quot;, &quot;Absolute, with analytical sol&quot;}</td></tr>
<tr class="separator:ae5fde53ca79bcb98cffa4ab41ea66b23"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af549488009a4290018e8b86931eb0b44"><td class="memItemLeft" align="right" valign="top">static const std::vector&lt; std::string &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#af549488009a4290018e8b86931eb0b44">volume_or_boundary_names</a> = {&quot;Volume&quot;, &quot;Boundary&quot;}</td></tr>
<tr class="separator:af549488009a4290018e8b86931eb0b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><div class="compoundTemplParams">template&lt;class real_num = double&gt;<br />
class femus::FE_convergence&lt; real_num &gt;</div><p>The idea of this class is to generate a certain amount of MultilevelSolutions and to compute the convergence rate. It may be used either to study Approximation Theory or to study Convergence of FE <a class="el" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a> of PDEs </p>

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00029">29</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="aa0a1dc7c62520f7573a2d19b383f6f97" name="aa0a1dc7c62520f7573a2d19b383f6f97"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa0a1dc7c62520f7573a2d19b383f6f97">&#9670;&#160;</a></span>compute_error_norms_per_unknown_per_level()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::compute_error_norms_per_unknown_per_level </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; <a class="el" href="../../da/ddf/classfemus_1_1elem__type__templ__base.html">elem_type_templ_base</a>&lt; real_num, double &gt; * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../db/db8/classfemus_1_1_gauss.html">Gauss</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>quad_rules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *&#160;</td>
          <td class="paramname"><em>ml_sol_single_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *&#160;</td>
          <td class="paramname"><em>ml_sol_all_levels_needed_for_incremental</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; real_num &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>ex_sol_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>lev</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>sobolev_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>volume_or_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>convergence_rate_computation_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000182">Todo:</a></b></dt><dd>do it || x_h - x_{h/2} || where the vectors are algebraic </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00966">966</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  978</span>                                           {</div>
<div class="line"><span class="lineno">  979</span>     </div>
<div class="line"><span class="lineno">  980</span>    </div>
<div class="line"><span class="lineno">  981</span>        <span class="comment">// ======= Control - BEGIN</span></div>
<div class="line"><span class="lineno">  982</span>            <span class="keywordflow">if</span> (volume_or_boundary == 0) {</div>
<div class="line"><span class="lineno">  983</span>            }</div>
<div class="line"><span class="lineno">  984</span>            <span class="keywordflow">else</span> <span class="keywordflow">if</span> (volume_or_boundary == 1) {</div>
<div class="line"><span class="lineno">  985</span>            }</div>
<div class="line"><span class="lineno">  986</span>            <span class="keywordflow">else</span> { std::cout &lt;&lt; <span class="stringliteral">&quot;Boundary of boundary not implemented in function &quot;</span> &lt;&lt; __func__; abort(); }</div>
<div class="line"><span class="lineno">  987</span>        <span class="comment">// ======= Control - END</span></div>
<div class="line"><span class="lineno">  988</span>            </div>
<div class="line"><span class="lineno">  989</span>            </div>
<div class="line"><span class="lineno">  990</span>   </div>
<div class="line"><span class="lineno">  991</span>        <span class="keywordflow">if</span> ( lev &gt; 0 ) {</div>
<div class="line"><span class="lineno">  992</span> </div>
<div class="line"><span class="lineno">  993</span>            <span class="comment">// ======= prolongate to the current level (lev) from the coarser level (lev-1) (so that you can compare the two) ========================</span></div>
<div class="line"><span class="lineno">  994</span>            ml_sol_all_levels_needed_for_incremental-&gt;RefineSolution(lev);</div>
<div class="line"><span class="lineno">  995</span>            </div>
<div class="line"><span class="lineno">  996</span>            <span class="comment">// =======  compute the error norm at the current level (lev) ========================</span></div>
<div class="line"><span class="lineno">  997</span>      </div>
<div class="line"><span class="lineno">  998</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++) {  <span class="comment">//this loop could be inside the below function</span></div>
<div class="line"><span class="lineno">  999</span>                </div>
<div class="line"><span class="lineno"> 1000</span>            std::vector&lt; real_num &gt; norm_out;</div>
<div class="line"><span class="lineno"> 1001</span>            </div>
<div class="line"><span class="lineno"> 1002</span>            norm_out = <a class="code hl_function" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a1a65f8a8e81a8a13093a1ef34d55a40d">FE_convergence::compute_error_norms_volume_or_boundary_with_analytical_sol_or_not</a> (elem_all,</div>
<div class="line"><span class="lineno"> 1003</span>                                                                                                   quad_rules, </div>
<div class="line"><span class="lineno"> 1004</span>                                                                                                   ml_sol_single_level,</div>
<div class="line"><span class="lineno"> 1005</span>                                                                                                   ml_sol_all_levels_needed_for_incremental, </div>
<div class="line"><span class="lineno"> 1006</span>                                                                                                   unknowns[u]._name,</div>
<div class="line"><span class="lineno"> 1007</span>                                                                                                   ex_sol_in[u], </div>
<div class="line"><span class="lineno"> 1008</span>                                                                                                   lev,</div>
<div class="line"><span class="lineno"> 1009</span>                                                                                                   sobolev_norms, </div>
<div class="line"><span class="lineno"> 1010</span>                                                                                                   convergence_rate_computation_method, </div>
<div class="line"><span class="lineno"> 1011</span>                                                                                                   volume_or_boundary);</div>
<div class="line"><span class="lineno"> 1012</span>            </div>
<div class="line"><span class="lineno"> 1013</span>            </div>
<div class="line"><span class="lineno"> 1014</span>            norms[u][lev-1] = norm_out[sobolev_norms];</div>
<div class="line"><span class="lineno"> 1015</span>                                       </div>
<div class="line"><span class="lineno"> 1016</span>                   }</div>
<div class="line"><span class="lineno"> 1017</span>                   </div>
<div class="line"><span class="lineno"> 1018</span> </div>
<div class="line"><span class="lineno"> 1019</span>        }         </div>
<div class="line"><span class="lineno"> 1020</span>                 </div>
<div class="line"><span class="lineno"> 1021</span>              <span class="comment">// ======= store the last computed solution to prepare the next iteration (the current level i is now overwritten) ========================</span></div>
<div class="line"><span class="lineno"> 1022</span>              <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level_to_pick_from = ml_sol_single_level-&gt;GetMLMesh()-&gt;GetNumberOfLevels() - 1;</div>
<div class="line"><span class="lineno"> 1023</span>            ml_sol_all_levels_needed_for_incremental-&gt;fill_at_level_from_level(lev, level_to_pick_from, *ml_sol_single_level);</div>
<div class="line"><span class="lineno"> 1024</span>        </div>
<div class="line"><span class="lineno"> 1025</span>                 </div>
<div class="line"><span class="lineno"> 1026</span>                 </div>
<div class="line"><span class="lineno"> 1027</span>                 </div>
<div class="line"><span class="lineno"> 1028</span> } </div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_a1a65f8a8e81a8a13093a1ef34d55a40d"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a1a65f8a8e81a8a13093a1ef34d55a40d">femus::FE_convergence::compute_error_norms_volume_or_boundary_with_analytical_sol_or_not</a></div><div class="ttdeci">static std::vector&lt; real_num &gt; compute_error_norms_volume_or_boundary_with_analytical_sol_or_not(const std::vector&lt; std::vector&lt; elem_type_templ_base&lt; real_num, double &gt; * &gt; &gt; &amp;elem_all, const std::vector&lt; Gauss &gt; &amp;quad_rules, const MultiLevelSolution *ml_sol, const MultiLevelSolution *ml_sol_all_levels_needed_for_incremental, const std::string &amp;unknown, const Math::Function&lt; real_num &gt; *ex_sol_in, const unsigned current_level, const unsigned sobolev_norms, const unsigned convergence_rate_computation_method, const unsigned volume_or_boundary)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00489">FE_convergence.hpp:489</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1a65f8a8e81a8a13093a1ef34d55a40d" name="a1a65f8a8e81a8a13093a1ef34d55a40d"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1a65f8a8e81a8a13093a1ef34d55a40d">&#9670;&#160;</a></span>compute_error_norms_volume_or_boundary_with_analytical_sol_or_not()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; real_num &gt; <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::compute_error_norms_volume_or_boundary_with_analytical_sol_or_not </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; <a class="el" href="../../da/ddf/classfemus_1_1elem__type__templ__base.html">elem_type_templ_base</a>&lt; real_num, double &gt; * &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_all</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../db/db8/classfemus_1_1_gauss.html">Gauss</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>quad_rules</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *&#160;</td>
          <td class="paramname"><em>ml_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> *&#160;</td>
          <td class="paramname"><em>ml_sol_all_levels_needed_for_incremental</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::string &amp;&#160;</td>
          <td class="paramname"><em>unknown</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; real_num &gt; *&#160;</td>
          <td class="paramname"><em>ex_sol_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>current_level</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>sobolev_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>convergence_rate_computation_method</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>volume_or_boundary</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000181">Todo:</a></b></dt><dd>THIS IS WRONG! It is NOT the SURFACE GRADIENTTTT, so we have to be careful when we have more than one boundary face!!! </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00489">489</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  500</span>                                               {</div>
<div class="line"><span class="lineno">  501</span>     </div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>  </div>
<div class="line"><span class="lineno">  504</span><span class="comment">// ||u_h - u_(h/2)||/||u_(h/2)-u_(h/4)|| = 2^alpha, alpha is order of conv </span></div>
<div class="line"><span class="lineno">  505</span><span class="comment">//i.e. ||prol_(u_(i-1)) - u_(i)|| = err(i) =&gt; err(i-1)/err(i) = 2^alpha ,implemented as log(err(i)/err(i+1))/log2</span></div>
<div class="line"><span class="lineno">  506</span> </div>
<div class="line"><span class="lineno">  507</span>   <span class="keywordflow">if</span> (convergence_rate_computation_method == 1 &amp;&amp; ex_sol_in == NULL) { std::cout &lt;&lt; <span class="stringliteral">&quot;Please provide analytical solution&quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  508</span>   </div>
<div class="line"><span class="lineno">  509</span>    </div>
<div class="line"><span class="lineno">  510</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> num_norms = <a class="code hl_variable" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3fd9d8b24165dfde984e1cff795982be">norm_names</a>.size();</div>
<div class="line"><span class="lineno">  511</span> </div>
<div class="line"><span class="lineno">  512</span>  <span class="comment">//norms that we are computing here //first L2, then H1 - BEGIN ============</span></div>
<div class="line"><span class="lineno">  513</span>  std::vector&lt; real_num &gt; norms_exact_function_at_qp(num_norms);                  std::fill(norms_exact_function_at_qp.begin(), norms_exact_function_at_qp.end(), 0.);   </div>
<div class="line"><span class="lineno">  514</span>  std::vector&lt; real_num &gt; norms_exact_function_at_dofs(num_norms);       std::fill(norms_exact_function_at_dofs.begin(), norms_exact_function_at_dofs.end(), 0.);</div>
<div class="line"><span class="lineno">  515</span>  std::vector&lt; real_num &gt; norms_inexact_dofs(num_norms);     std::fill(norms_inexact_dofs.begin(), norms_inexact_dofs.end(), 0.);</div>
<div class="line"><span class="lineno">  516</span>  <span class="comment">//norms that we are computing here //first L2, then H1 - END ============</span></div>
<div class="line"><span class="lineno">  517</span>  </div>
<div class="line"><span class="lineno">  518</span>  </div>
<div class="line"><span class="lineno">  519</span>  <span class="keywordtype">unsigned</span> level = ml_sol_single_level-&gt;GetMLMesh()-&gt;GetNumberOfLevels() - 1u; <span class="comment">//this is supposed to be zero because a single level is used</span></div>
<div class="line"><span class="lineno">  520</span>  </div>
<div class="line"><span class="lineno">  521</span>  <span class="comment">//  extract pointers to the several objects that we are going to use</span></div>
<div class="line"><span class="lineno">  522</span>  <span class="keyword">const</span> Mesh*     msh = ml_sol_single_level-&gt;GetMLMesh()-&gt;GetLevel(level);</div>
<div class="line"><span class="lineno">  523</span>  <span class="keyword">const</span> Solution* sol = ml_sol_single_level-&gt;GetSolutionLevel(level);</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;GetDimension();</div>
<div class="line"><span class="lineno">  526</span>  <span class="keywordtype">unsigned</span> dim2 = (3 * (<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1));        <span class="comment">// dim2 is the number of second order partial derivatives (1,3,6 depending on the dimension)</span></div>
<div class="line"><span class="lineno">  527</span> </div>
<div class="line"><span class="lineno">  528</span> <span class="keywordtype">unsigned</span> iproc = msh-&gt;processor_id();</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>  </div>
<div class="line"><span class="lineno">  531</span> <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  532</span>  <span class="keyword">constexpr</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> space_dim = 3;</div>
<div class="line"><span class="lineno">  533</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dim_offset_grad = 3;</div>
<div class="line"><span class="lineno">  534</span> </div>
<div class="line"><span class="lineno">  535</span>  <span class="comment">// ======================================</span></div>
<div class="line"><span class="lineno">  536</span>  <span class="comment">// reserve memory for the local standar vectors</span></div>
<div class="line"><span class="lineno">  537</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><span class="lineno">  538</span>  </div>
<div class="line"><span class="lineno">  539</span>   </div>
<div class="line"><span class="lineno">  540</span>  <span class="comment">//solution variable</span></div>
<div class="line"><span class="lineno">  541</span>  <span class="keywordtype">unsigned</span> sol_uIndex = ml_sol_single_level-&gt;GetIndex(unknown.c_str());</div>
<div class="line"><span class="lineno">  542</span>  <span class="keywordtype">unsigned</span> sol_uType  = ml_sol_single_level-&gt;GetSolutionType(sol_uIndex);    <span class="comment">// get the finite element type for &quot;u&quot;</span></div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>  </div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>  </div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>  CurrentElem &lt; double &gt; geom_element_iel(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, msh);</div>
<div class="line"><span class="lineno">  549</span> </div>
<div class="line"><span class="lineno">  550</span>  </div>
<div class="line"><span class="lineno">  551</span><span class="comment">//-----------------  VOLUME, common to both - BEGIN</span></div>
<div class="line"><span class="lineno">  552</span>  std::vector &lt; real_num &gt;  sol_u;                               sol_u.reserve(max_size);</div>
<div class="line"><span class="lineno">  553</span>  std::vector &lt; real_num &gt;  sol_u_exact_at_dofs;   sol_u_exact_at_dofs.reserve(max_size);</div>
<div class="line"><span class="lineno">  554</span>  std::vector &lt; real_num &gt;  sol_u_inexact_prolongated_from_coarser_level;     sol_u_inexact_prolongated_from_coarser_level.reserve(max_size);</div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>  </div>
<div class="line"><span class="lineno">  557</span>  </div>
<div class="line"><span class="lineno">  558</span>  <span class="keywordtype">unsigned</span> solType_coords = <a class="code hl_enumvalue" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a>;</div>
<div class="line"><span class="lineno">  559</span>  std::vector &lt; std::vector &lt; real_num &gt; &gt; x(dim_offset_grad);    <span class="comment">// local coordinates</span></div>
<div class="line"><span class="lineno">  560</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; x.size(); i++)   x[i].reserve(max_size);</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span><span class="comment">//-----------------  VOLUME, common to both - END</span></div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>  </div>
<div class="line"><span class="lineno">  565</span><span class="comment">//-----------------  VOLUME initialization - BEGIN</span></div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span><span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  568</span>   std::vector &lt; std::vector &lt; double &gt; &gt;  JacI_qp(space_dim);</div>
<div class="line"><span class="lineno">  569</span>   std::vector &lt; std::vector &lt; double &gt; &gt;  Jac_qp(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  570</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) { Jac_qp[d].resize(space_dim); }</div>
<div class="line"><span class="lineno">  571</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; space_dim; d++) { JacI_qp[d].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>); }</div>
<div class="line"><span class="lineno">  572</span>    </div>
<div class="line"><span class="lineno">  573</span>  real_num detJac_qp = 0.;</div>
<div class="line"><span class="lineno">  574</span>  real_num weight = 0.; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  575</span> <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span> </div>
<div class="line"><span class="lineno">  578</span>  std::vector &lt; real_num &gt; <a class="code hl_variable" href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;</div>
<div class="line"><span class="lineno">  579</span>  std::vector &lt; real_num &gt; phi_x;</div>
<div class="line"><span class="lineno">  580</span>  </div>
<div class="line"><span class="lineno">  581</span>  <a class="code hl_variable" href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.reserve(max_size);</div>
<div class="line"><span class="lineno">  582</span>  phi_x.reserve(max_size * dim_offset_grad);</div>
<div class="line"><span class="lineno">  583</span>  </div>
<div class="line"><span class="lineno">  584</span>  </div>
<div class="line"><span class="lineno">  585</span>  </div>
<div class="line"><span class="lineno">  586</span>  std::vector &lt; real_num &gt; phi_coords;</div>
<div class="line"><span class="lineno">  587</span>  std::vector &lt; real_num &gt; phi_coords_x;</div>
<div class="line"><span class="lineno">  588</span> </div>
<div class="line"><span class="lineno">  589</span>  phi_coords.reserve(max_size);</div>
<div class="line"><span class="lineno">  590</span>  phi_coords_x.reserve(max_size * dim_offset_grad);</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span> </div>
<div class="line"><span class="lineno">  593</span> </div>
<div class="line"><span class="lineno">  594</span> </div>
<div class="line"><span class="lineno">  595</span><span class="comment">//-----------------  VOLUME initialization - END</span></div>
<div class="line"><span class="lineno">  596</span> </div>
<div class="line"><span class="lineno">  597</span>  </div>
<div class="line"><span class="lineno">  598</span>  </div>
<div class="line"><span class="lineno">  599</span>  </div>
<div class="line"><span class="lineno">  600</span><span class="comment">//-----------------  BOUNDARY initialization - BEGIN</span></div>
<div class="line"><span class="lineno">  601</span>    </div>
<div class="line"><span class="lineno">  602</span> <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  603</span>     std::vector &lt; std::vector &lt; double &gt; &gt;  JacI_qp_bdry(space_dim);</div>
<div class="line"><span class="lineno">  604</span>     std::vector &lt; std::vector &lt; double &gt; &gt;  Jac_qp_bdry(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>-1);</div>
<div class="line"><span class="lineno">  605</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; Jac_qp_bdry.size(); d++) {   Jac_qp_bdry[d].resize(space_dim); }</div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; JacI_qp_bdry.size(); d++) { JacI_qp_bdry[d].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>-1); }</div>
<div class="line"><span class="lineno">  607</span>    </div>
<div class="line"><span class="lineno">  608</span>    real_num detJac_iqp_bdry = 0.;</div>
<div class="line"><span class="lineno">  609</span>  real_num weight_iqp_bdry = 0.;</div>
<div class="line"><span class="lineno">  610</span> <span class="comment">//***************************************************  </span></div>
<div class="line"><span class="lineno">  611</span>    </div>
<div class="line"><span class="lineno">  612</span>  std::vector &lt;double&gt; phi_u_bdry;  </div>
<div class="line"><span class="lineno">  613</span>  std::vector &lt;double&gt; phi_u_x_bdry; </div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>  phi_u_bdry.reserve(max_size);</div>
<div class="line"><span class="lineno">  616</span>  phi_u_x_bdry.reserve(max_size * dim_offset_grad);</div>
<div class="line"><span class="lineno">  617</span>  </div>
<div class="line"><span class="lineno">  618</span>  </div>
<div class="line"><span class="lineno">  619</span>  std::vector &lt; real_num &gt; phi_coords_bdry;</div>
<div class="line"><span class="lineno">  620</span>  std::vector &lt; real_num &gt; phi_coords_x_bdry;</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>  phi_coords_bdry.reserve(max_size);</div>
<div class="line"><span class="lineno">  623</span>  phi_coords_x_bdry.reserve(max_size * dim_offset_grad);</div>
<div class="line"><span class="lineno">  624</span> </div>
<div class="line"><span class="lineno">  625</span><span class="comment">//-----------------  BOUNDARY initialization - END</span></div>
<div class="line"><span class="lineno">  626</span> </div>
<div class="line"><span class="lineno">  627</span>  </div>
<div class="line"><span class="lineno">  628</span>  </div>
<div class="line"><span class="lineno">  629</span>  </div>
<div class="line"><span class="lineno">  630</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  631</span> </div>
<div class="line"><span class="lineno">  632</span><span class="comment">//---------------- Geometry - BEGIN</span></div>
<div class="line"><span class="lineno">  633</span>      geom_element_iel.set_coords_at_dofs_and_geom_type(iel, solType_coords);</div>
<div class="line"><span class="lineno">  634</span>        </div>
<div class="line"><span class="lineno">  635</span>    <span class="keywordtype">unsigned</span> nDofx = msh-&gt;GetElementDofNumber(iel, solType_coords);</div>
<div class="line"><span class="lineno">  636</span>    </div>
<div class="line"><span class="lineno">  637</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; x.size(); i++) {</div>
<div class="line"><span class="lineno">  638</span>      x[i].resize(nDofx);</div>
<div class="line"><span class="lineno">  639</span>    }</div>
<div class="line"><span class="lineno">  640</span> </div>
<div class="line"><span class="lineno">  641</span>    <span class="comment">// local storage of coordinates</span></div>
<div class="line"><span class="lineno">  642</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx; i++) {</div>
<div class="line"><span class="lineno">  643</span>      <span class="keywordtype">unsigned</span> xDof  = msh-&gt;GetSolutionDof(i, iel, solType_coords);    <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><span class="lineno">  644</span> </div>
<div class="line"><span class="lineno">  645</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; dim_offset_grad<span class="comment">/*dim*/</span>; jdim++) {</div>
<div class="line"><span class="lineno">  646</span>        x[jdim][i] = (*msh-&gt;GetTopology()-&gt;_Sol[jdim])(xDof);  <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><span class="lineno">  647</span>      }</div>
<div class="line"><span class="lineno">  648</span>    }</div>
<div class="line"><span class="lineno">  649</span>    </div>
<div class="line"><span class="lineno">  650</span><span class="comment">//---------------- Geometry - END</span></div>
<div class="line"><span class="lineno">  651</span>    </div>
<div class="line"><span class="lineno">  652</span>    </div>
<div class="line"><span class="lineno">  653</span><span class="comment">//---------------- Solution - BEGIN</span></div>
<div class="line"><span class="lineno">  654</span>    <span class="keywordtype">unsigned</span> nDofu  = msh-&gt;GetElementDofNumber(iel, sol_uType);</div>
<div class="line"><span class="lineno">  655</span> </div>
<div class="line"><span class="lineno">  656</span>    <span class="comment">// resize local arrays</span></div>
<div class="line"><span class="lineno">  657</span>    sol_u.resize(nDofu);</div>
<div class="line"><span class="lineno">  658</span>    sol_u_exact_at_dofs.resize(nDofu);</div>
<div class="line"><span class="lineno">  659</span>    sol_u_inexact_prolongated_from_coarser_level.resize(nDofu);</div>
<div class="line"><span class="lineno">  660</span> </div>
<div class="line"><span class="lineno">  661</span>    </div>
<div class="line"><span class="lineno">  662</span>    <span class="comment">// local storage of global mapping and solution</span></div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  664</span>        </div>
<div class="line"><span class="lineno">  665</span>        std::vector&lt; real_num &gt; x_at_dof(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  666</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; x_at_dof.size(); jdim++) x_at_dof[jdim] = x[jdim][i];</div>
<div class="line"><span class="lineno">  667</span>        </div>
<div class="line"><span class="lineno">  668</span>      <span class="keywordtype">unsigned</span> solDof = msh-&gt;GetSolutionDof(i, iel, sol_uType);</div>
<div class="line"><span class="lineno">  669</span>                   sol_u[i]  =                                        (*sol-&gt;_Sol[sol_uIndex])(solDof);</div>
<div class="line"><span class="lineno">  670</span>      sol_u_inexact_prolongated_from_coarser_level[i]  = (*ml_sol_all_levels_needed_for_incremental-&gt;GetSolutionLevel(current_level)-&gt;_Sol[sol_uIndex])(solDof);</div>
<div class="line"><span class="lineno">  671</span>      <span class="keywordflow">if</span> (ex_sol_in != NULL) sol_u_exact_at_dofs[i] = ex_sol_in-&gt;value(x_at_dof);</div>
<div class="line"><span class="lineno">  672</span>    }</div>
<div class="line"><span class="lineno">  673</span><span class="comment">//---------------- Solution - END</span></div>
<div class="line"><span class="lineno">  674</span> </div>
<div class="line"><span class="lineno">  675</span> </div>
<div class="line"><span class="lineno">  676</span><span class="comment">// *** VOLUME - BEGIN ***</span></div>
<div class="line"><span class="lineno">  677</span> <span class="keywordflow">if</span> (volume_or_boundary == 0) {  </div>
<div class="line"><span class="lineno">  678</span>      </div>
<div class="line"><span class="lineno">  679</span>      </div>
<div class="line"><span class="lineno">  680</span>    <span class="keyword">const</span> <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = geom_element_iel.geom_type();</div>
<div class="line"><span class="lineno">  681</span>    </div>
<div class="line"><span class="lineno">  682</span>   </div>
<div class="line"><span class="lineno">  683</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ig = 0; ig &lt; quad_rules[ielGeom].GetGaussPointsNumber(); ig++) {</div>
<div class="line"><span class="lineno">  684</span> </div>
<div class="line"><span class="lineno">  685</span>      <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno">  686</span>        elem_all[ielGeom][solType_coords]-&gt;JacJacInv(x, ig, Jac_qp, JacI_qp, detJac_qp, space_dim);</div>
<div class="line"><span class="lineno">  687</span>    elem_all[ielGeom][sol_uType]-&gt;shape_funcs_current_elem(ig, JacI_qp, <a class="code hl_variable" href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x, boost::none, space_dim);</div>
<div class="line"><span class="lineno">  688</span>    </div>
<div class="line"><span class="lineno">  689</span>    elem_all[ielGeom][solType_coords]-&gt;shape_funcs_current_elem(ig, JacI_qp, phi_coords, phi_coords_x,  boost::none, space_dim);</div>
<div class="line"><span class="lineno">  690</span>    </div>
<div class="line"><span class="lineno">  691</span>    weight = detJac_qp * quad_rules[ielGeom].GetGaussWeightsPointer()[ig];</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span>    </div>
<div class="line"><span class="lineno">  694</span>                 <span class="comment">//========== QP eval - BEGIN ===============================================</span></div>
<div class="line"><span class="lineno">  695</span>      real_num sol_u_gss = 0.;</div>
<div class="line"><span class="lineno">  696</span>      real_num exactSol_from_dofs_gss = 0.;</div>
<div class="line"><span class="lineno">  697</span>      real_num sol_u_inexact_prolongated_from_coarser_level_gss = 0.;</div>
<div class="line"><span class="lineno">  698</span>      </div>
<div class="line"><span class="lineno">  699</span>      std::vector &lt; real_num &gt; gradSolu_gss(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  700</span>      std::vector &lt; real_num &gt; gradSolu_exact_at_dofs_gss(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  701</span>      std::vector &lt; real_num &gt; gradSolu_inexact_prolongated_from_coarser_level_gss(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; <a class="code hl_variable" href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>.size(); i++) {</div>
<div class="line"><span class="lineno">  705</span>        sol_u_gss                += <a class="code hl_variable" href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * sol_u[i];</div>
<div class="line"><span class="lineno">  706</span>        exactSol_from_dofs_gss  += <a class="code hl_variable" href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * sol_u_exact_at_dofs[i];</div>
<div class="line"><span class="lineno">  707</span>        sol_u_inexact_prolongated_from_coarser_level_gss   += <a class="code hl_variable" href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * sol_u_inexact_prolongated_from_coarser_level[i];</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; dim_offset_grad; jdim++) {</div>
<div class="line"><span class="lineno">  710</span>          gradSolu_gss[jdim]                += phi_x[i * dim_offset_grad + jdim] * sol_u[i];</div>
<div class="line"><span class="lineno">  711</span>          gradSolu_exact_at_dofs_gss[jdim]  += phi_x[i * dim_offset_grad + jdim] * sol_u_exact_at_dofs[i];</div>
<div class="line"><span class="lineno">  712</span>          gradSolu_inexact_prolongated_from_coarser_level_gss[jdim]   += phi_x[i * dim_offset_grad + jdim] * sol_u_inexact_prolongated_from_coarser_level[i];</div>
<div class="line"><span class="lineno">  713</span>        }</div>
<div class="line"><span class="lineno">  714</span>        </div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span>      }</div>
<div class="line"><span class="lineno">  717</span>      </div>
<div class="line"><span class="lineno">  718</span>      </div>
<div class="line"><span class="lineno">  719</span>      std::vector &lt; real_num &gt; x_gss(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  720</span>      </div>
<div class="line"><span class="lineno">  721</span>       <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; phi_coords.size(); i++) {</div>
<div class="line"><span class="lineno">  722</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; dim_offset_grad; jdim++) {</div>
<div class="line"><span class="lineno">  723</span>           x_gss[jdim] += x[jdim][i] * phi_coords[i];</div>
<div class="line"><span class="lineno">  724</span>          }</div>
<div class="line"><span class="lineno">  725</span>       }</div>
<div class="line"><span class="lineno">  726</span>                 <span class="comment">//========== QP eval - END ===============================================</span></div>
<div class="line"><span class="lineno">  727</span>      </div>
<div class="line"><span class="lineno">  728</span>      </div>
<div class="line"><span class="lineno">  729</span>      </div>
<div class="line"><span class="lineno">  730</span>      </div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span><span class="comment">// H^0 ==============      </span></div>
<div class="line"><span class="lineno">  733</span>    <span class="keywordflow">if</span> (sobolev_norms == 0) {</div>
<div class="line"><span class="lineno">  734</span>      real_num exactSol = 0.; <span class="keywordflow">if</span> (ex_sol_in != NULL) exactSol = ex_sol_in-&gt;value(x_gss);</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>      norms_exact_function_at_qp[0] += (sol_u_gss - exactSol)                * (sol_u_gss - exactSol)       * weight;</div>
<div class="line"><span class="lineno">  737</span>      norms_exact_function_at_dofs[0]     += (sol_u_gss - exactSol_from_dofs_gss)  * (sol_u_gss - exactSol_from_dofs_gss) * weight;</div>
<div class="line"><span class="lineno">  738</span>      norms_inexact_dofs[0]   += (sol_u_gss - sol_u_inexact_prolongated_from_coarser_level_gss)   * (sol_u_gss - sol_u_inexact_prolongated_from_coarser_level_gss)  * weight;</div>
<div class="line"><span class="lineno">  739</span>    }</div>
<div class="line"><span class="lineno">  740</span>    </div>
<div class="line"><span class="lineno">  741</span><span class="comment">// H^1 ==============</span></div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sobolev_norms == 1) {</div>
<div class="line"><span class="lineno">  743</span>      std::vector &lt; real_num &gt; exactGradSol(dim_offset_grad,0.);    <span class="keywordflow">if</span> (ex_sol_in != NULL) exactGradSol = ex_sol_in-&gt;gradient(x_gss);</div>
<div class="line"><span class="lineno">  744</span> </div>
<div class="line"><span class="lineno">  745</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; dim_offset_grad ; d++) {</div>
<div class="line"><span class="lineno">  746</span>        norms_exact_function_at_qp[1] += ((gradSolu_gss[d] - exactGradSol[d])               * (gradSolu_gss[d]  - exactGradSol[d])) * weight;</div>
<div class="line"><span class="lineno">  747</span>        norms_exact_function_at_dofs[1]     += ((gradSolu_gss[d] - gradSolu_exact_at_dofs_gss[d]) * (gradSolu_gss[d] - gradSolu_exact_at_dofs_gss[d])) * weight;</div>
<div class="line"><span class="lineno">  748</span>        norms_inexact_dofs[1]   += ((gradSolu_gss[d] - gradSolu_inexact_prolongated_from_coarser_level_gss[d])  * (gradSolu_gss[d] - gradSolu_inexact_prolongated_from_coarser_level_gss[d]))  * weight;</div>
<div class="line"><span class="lineno">  749</span>      }</div>
<div class="line"><span class="lineno">  750</span>   }</div>
<div class="line"><span class="lineno">  751</span>      </div>
<div class="line"><span class="lineno">  752</span>   } <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno">  753</span>  }</div>
<div class="line"><span class="lineno">  754</span><span class="comment">// *** VOLUME - END ***</span></div>
<div class="line"><span class="lineno">  755</span>  </div>
<div class="line"><span class="lineno">  756</span> </div>
<div class="line"><span class="lineno">  757</span>  </div>
<div class="line"><span class="lineno">  758</span><span class="comment">// *** BOUNDARY - BEGIN ***</span></div>
<div class="line"><span class="lineno">  759</span><span class="keywordflow">else</span> <span class="keywordflow">if</span> (volume_or_boundary == 1 )      {</div>
<div class="line"><span class="lineno">  760</span>  </div>
<div class="line"><span class="lineno">  761</span>          std::vector&lt;double&gt; normal_at_qp_bdry(space_dim, 0.);</div>
<div class="line"><span class="lineno">  762</span>               </div>
<div class="line"><span class="lineno">  763</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> iface = 0; iface &lt; msh-&gt;GetElementFaceNumber(iel); iface++) {</div>
<div class="line"><span class="lineno">  764</span>          </div>
<div class="line"><span class="lineno">  765</span>       <span class="keyword">const</span> <span class="keywordtype">unsigned</span> ielGeom_bdry = msh-&gt;GetElementFaceType(iel, iface);    </div>
<div class="line"><span class="lineno">  766</span>       </div>
<div class="line"><span class="lineno">  767</span><span class="comment">// ----------</span></div>
<div class="line"><span class="lineno">  768</span>       geom_element_iel.set_coords_at_dofs_bdry_3d(iel, iface, solType_coords);</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span><span class="comment">// ----------</span></div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>                            <span class="keyword">const</span> <span class="keywordtype">int</span> bdry_index_j = msh-&gt;el-&gt;GetFaceElementIndex(iel, iface);</div>
<div class="line"><span class="lineno">  773</span> </div>
<div class="line"><span class="lineno">  774</span>            <span class="keywordflow">if</span>(  bdry_index_j &lt; 0 ) {</div>
<div class="line"><span class="lineno">  775</span> </div>
<div class="line"><span class="lineno">  776</span>        </div>
<div class="line"><span class="lineno">  777</span>                </div>
<div class="line"><span class="lineno">  778</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ig_bdry = 0; ig_bdry &lt; quad_rules[ielGeom_bdry].GetGaussPointsNumber(); ig_bdry++) {</div>
<div class="line"><span class="lineno">  779</span>                  </div>
<div class="line"><span class="lineno">  780</span>    elem_all[ielGeom_bdry][solType_coords]-&gt;JacJacInv(geom_element_iel.get_coords_at_dofs_bdry_3d(), ig_bdry, Jac_qp_bdry, JacI_qp_bdry, detJac_iqp_bdry, space_dim);</div>
<div class="line"><span class="lineno">  781</span>    weight_iqp_bdry = detJac_iqp_bdry * quad_rules[ielGeom_bdry].GetGaussWeightsPointer()[ig_bdry];</div>
<div class="line"><span class="lineno">  782</span>    </div>
<div class="line"><span class="lineno">  783</span>    elem_all[ielGeom_bdry][sol_uType]     -&gt;shape_funcs_current_elem(ig_bdry, JacI_qp_bdry, phi_u_bdry, phi_u_x_bdry, boost::none, space_dim);</div>
<div class="line"><span class="lineno">  784</span>    elem_all[ielGeom_bdry][solType_coords]-&gt;shape_funcs_current_elem(ig_bdry, JacI_qp_bdry, phi_coords_bdry, phi_coords_x_bdry,  boost::none, space_dim);</div>
<div class="line"><span class="lineno">  785</span>        elem_all[ielGeom_bdry][solType_coords]-&gt;compute_normal(Jac_qp_bdry, normal_at_qp_bdry);</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>                  </div>
<div class="line"><span class="lineno">  788</span>                 <span class="comment">//========== QP eval - BEGIN ===============================================</span></div>
<div class="line"><span class="lineno">  789</span>      real_num            sol_u_bdry_gss = 0.;</div>
<div class="line"><span class="lineno">  790</span>      real_num exactSol_from_dofs_bdry_gss = 0.;</div>
<div class="line"><span class="lineno">  791</span>      real_num sol_u_inexact_prolongated_from_coarser_level_gss = 0.;</div>
<div class="line"><span class="lineno">  792</span>          </div>
<div class="line"><span class="lineno">  793</span>      std::vector &lt; real_num &gt;  sol_u_x_bdry_gss(space_dim, 0.);</div>
<div class="line"><span class="lineno">  794</span>      std::vector &lt; real_num &gt;  gradSolu_exact_at_dofs_bdry_gss(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  795</span>      std::vector &lt; real_num &gt;  gradSolu_inexact_prolongated_from_coarser_level_bdry_gss(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  796</span> </div>
<div class="line"><span class="lineno">  797</span>                  </div>
<div class="line"><span class="lineno">  798</span>                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_bdry = 0; i_bdry &lt; phi_u_bdry.size(); i_bdry++)  {</div>
<div class="line"><span class="lineno">  799</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;GetLocalFaceVertexIndex(iel, iface, i_bdry);</div>
<div class="line"><span class="lineno">  800</span>                        </div>
<div class="line"><span class="lineno">  801</span>                        sol_u_bdry_gss                                    +=  sol_u[i_vol]              * phi_u_bdry[i_bdry];</div>
<div class="line"><span class="lineno">  802</span>            exactSol_from_dofs_bdry_gss                       += sol_u_exact_at_dofs[i_vol] * phi_u_bdry[i_bdry];</div>
<div class="line"><span class="lineno">  803</span>            </div>
<div class="line"><span class="lineno">  804</span>            sol_u_inexact_prolongated_from_coarser_level_gss  += sol_u_inexact_prolongated_from_coarser_level[i_vol]              * phi_u_bdry[i_bdry];</div>
<div class="line"><span class="lineno">  805</span>        </div>
<div class="line"><span class="lineno">  806</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; space_dim; d++) {</div>
<div class="line"><span class="lineno">  807</span>                              sol_u_x_bdry_gss[d] += sol_u[i_vol] * phi_u_x_bdry[i_bdry * space_dim + d];</div>
<div class="line"><span class="lineno">  808</span>                  gradSolu_exact_at_dofs_bdry_gss[d] += sol_u_exact_at_dofs[i_vol] * phi_u_x_bdry[i_bdry * space_dim + d];</div>
<div class="line"><span class="lineno">  809</span>                              gradSolu_inexact_prolongated_from_coarser_level_bdry_gss[d] += sol_u_inexact_prolongated_from_coarser_level[i_vol] * phi_u_x_bdry[i_bdry * space_dim + d];</div>
<div class="line"><span class="lineno">  810</span>                            }</div>
<div class="line"><span class="lineno">  811</span>                    }</div>
<div class="line"><span class="lineno">  812</span>                      </div>
<div class="line"><span class="lineno">  813</span>                      <span class="keywordtype">double</span> laplace_u_bdry = 0.;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; space_dim; d++) { laplace_u_bdry += sol_u_x_bdry_gss[d] * sol_u_x_bdry_gss[d]; }</div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span> </div>
<div class="line"><span class="lineno">  816</span>       std::vector &lt; real_num &gt; x_gss_bdry(dim_offset_grad, 0.);</div>
<div class="line"><span class="lineno">  817</span>       </div>
<div class="line"><span class="lineno">  818</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; phi_coords_bdry.size(); i++) {</div>
<div class="line"><span class="lineno">  819</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; dim_offset_grad; jdim++) {</div>
<div class="line"><span class="lineno">  820</span>           x_gss_bdry[jdim] += geom_element_iel.get_coords_at_dofs_bdry_3d()[jdim][i] * phi_coords_bdry[i];</div>
<div class="line"><span class="lineno">  821</span>          }</div>
<div class="line"><span class="lineno">  822</span>       }</div>
<div class="line"><span class="lineno">  823</span>                 <span class="comment">//========== QP eval - END ===============================================</span></div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span><span class="comment">// H^0 - BEGIN ============== </span></div>
<div class="line"><span class="lineno">  826</span> <span class="keywordflow">if</span> (sobolev_norms == 0) {</div>
<div class="line"><span class="lineno">  827</span>      real_num exactSol_bdry = 0.; <span class="keywordflow">if</span> (ex_sol_in != NULL) exactSol_bdry = ex_sol_in-&gt;value(x_gss_bdry);</div>
<div class="line"><span class="lineno">  828</span>      </div>
<div class="line"><span class="lineno">  829</span>      norms_exact_function_at_qp[0] += (sol_u_bdry_gss - exactSol_bdry) * (sol_u_bdry_gss - exactSol_bdry) * weight_iqp_bdry;</div>
<div class="line"><span class="lineno">  830</span>      </div>
<div class="line"><span class="lineno">  831</span>      norms_exact_function_at_dofs[0]  += (sol_u_bdry_gss - exactSol_from_dofs_bdry_gss)  * </div>
<div class="line"><span class="lineno">  832</span>                                          (sol_u_bdry_gss - exactSol_from_dofs_bdry_gss) * weight;</div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>      norms_inexact_dofs[0]   += (sol_u_bdry_gss - sol_u_inexact_prolongated_from_coarser_level_gss)   * (sol_u_bdry_gss - sol_u_inexact_prolongated_from_coarser_level_gss)  * weight_iqp_bdry;</div>
<div class="line"><span class="lineno">  835</span>  }</div>
<div class="line"><span class="lineno">  836</span><span class="comment">// H^0 - END ==============      </span></div>
<div class="line"><span class="lineno">  837</span>                  </div>
<div class="line"><span class="lineno">  838</span>                  </div>
<div class="line"><span class="lineno">  839</span>                  </div>
<div class="line"><span class="lineno">  840</span><span class="comment">// H^1 - BEGIN ==============</span></div>
<div class="line"><span class="lineno">  841</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sobolev_norms == 1) {</div>
<div class="line"><span class="lineno">  842</span>      </div>
<div class="line"><span class="lineno">  843</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Here you have to ROTATE the boundary element appropriately, I think&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  844</span>      </div>
<div class="line"><span class="lineno">  845</span>      std::vector &lt; real_num &gt; exactGradSol_bdry(dim_offset_grad, 0.);    <span class="keywordflow">if</span> (ex_sol_in != NULL) exactGradSol_bdry = ex_sol_in-&gt;gradient(x_gss_bdry);  </div>
<div class="line"><span class="lineno">  847</span>      </div>
<div class="line"><span class="lineno">  848</span>      std::vector &lt; real_num &gt; exactGradSol_bdry_dot_tangent =  <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a8cc628585642221c8f364d86376abdf8">Math::tangent_vector_from_normal</a>( exactGradSol_bdry, normal_at_qp_bdry, exactGradSol_bdry.size() );</div>
<div class="line"><span class="lineno">  849</span>      </div>
<div class="line"><span class="lineno">  850</span>      std::vector &lt; real_num &gt; sol_u_x_bdry_gss_dot_tangent =  <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a8cc628585642221c8f364d86376abdf8">Math::tangent_vector_from_normal</a>( sol_u_x_bdry_gss, normal_at_qp_bdry, sol_u_x_bdry_gss.size() );</div>
<div class="line"><span class="lineno">  851</span> </div>
<div class="line"><span class="lineno">  852</span>      std::vector &lt; real_num &gt; gradSolu_exact_at_dofs_bdry_gss_dot_tangent =  <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a8cc628585642221c8f364d86376abdf8">Math::tangent_vector_from_normal</a>( gradSolu_exact_at_dofs_bdry_gss, normal_at_qp_bdry, gradSolu_exact_at_dofs_bdry_gss.size() );</div>
<div class="line"><span class="lineno">  853</span>      </div>
<div class="line"><span class="lineno">  854</span>      std::vector &lt; real_num &gt; gradSolu_inexact_prolongated_from_coarser_level_bdry_gss_dot_tangent =  <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a8cc628585642221c8f364d86376abdf8">Math::tangent_vector_from_normal</a>( gradSolu_inexact_prolongated_from_coarser_level_bdry_gss, normal_at_qp_bdry, gradSolu_inexact_prolongated_from_coarser_level_bdry_gss.size() );</div>
<div class="line"><span class="lineno">  855</span> </div>
<div class="line"><span class="lineno">  856</span>      </div>
<div class="line"><span class="lineno">  857</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; dim_offset_grad ; d++) {</div>
<div class="line"><span class="lineno">  858</span>        norms_exact_function_at_qp[1] += ( (sol_u_x_bdry_gss_dot_tangent[d] - exactGradSol_bdry_dot_tangent[d])  *  </div>
<div class="line"><span class="lineno">  859</span>                                     (sol_u_x_bdry_gss_dot_tangent[d] - exactGradSol_bdry_dot_tangent[d]) ) * weight_iqp_bdry;</div>
<div class="line"><span class="lineno">  860</span>        </div>
<div class="line"><span class="lineno">  861</span>        norms_exact_function_at_dofs[1]   += (( sol_u_x_bdry_gss_dot_tangent[d] - gradSolu_exact_at_dofs_bdry_gss_dot_tangent[d]) * </div>
<div class="line"><span class="lineno">  862</span>                                              ( sol_u_x_bdry_gss_dot_tangent[d] - gradSolu_exact_at_dofs_bdry_gss_dot_tangent[d])) * weight_iqp_bdry;</div>
<div class="line"><span class="lineno">  863</span>                                     </div>
<div class="line"><span class="lineno">  864</span>        norms_inexact_dofs[1]   += ( (sol_u_x_bdry_gss_dot_tangent[d] - gradSolu_inexact_prolongated_from_coarser_level_bdry_gss_dot_tangent[d])   *</div>
<div class="line"><span class="lineno">  865</span>                                     (sol_u_x_bdry_gss_dot_tangent[d] - gradSolu_inexact_prolongated_from_coarser_level_bdry_gss_dot_tangent[d]) ) * weight_iqp_bdry;</div>
<div class="line"><span class="lineno">  866</span>      }</div>
<div class="line"><span class="lineno">  867</span>   }</div>
<div class="line"><span class="lineno">  868</span><span class="comment">// H^1 - END ==============</span></div>
<div class="line"><span class="lineno">  869</span>                  </div>
<div class="line"><span class="lineno">  870</span>        }</div>
<div class="line"><span class="lineno">  871</span>            </div>
<div class="line"><span class="lineno">  872</span>        </div>
<div class="line"><span class="lineno">  873</span>              } <span class="comment">//end face</span></div>
<div class="line"><span class="lineno">  874</span>              </div>
<div class="line"><span class="lineno">  875</span>          }  <span class="comment">// loop over element faces   </span></div>
<div class="line"><span class="lineno">  876</span>          </div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span><span class="comment">//=====================================================================================================================  </span></div>
<div class="line"><span class="lineno">  879</span><span class="comment">//=====================================================================================================================  </span></div>
<div class="line"><span class="lineno">  880</span><span class="comment">//=====================================================================================================================  </span></div>
<div class="line"><span class="lineno">  881</span>     </div>
<div class="line"><span class="lineno">  882</span>    </div>
<div class="line"><span class="lineno">  883</span>}   </div>
<div class="line"><span class="lineno">  884</span><span class="comment">// *** BOUNDARY - END ***</span></div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>  </div>
<div class="line"><span class="lineno">  887</span>  </div>
<div class="line"><span class="lineno">  888</span>  } <span class="comment">//end element loop for each process</span></div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>  </div>
<div class="line"><span class="lineno">  891</span><span class="comment">// *** Add norms to all processes - BEGIN ***</span></div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>  NumericVector* norm_vec_exact_using_qp;</div>
<div class="line"><span class="lineno">  894</span>                 norm_vec_exact_using_qp = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  895</span>                 norm_vec_exact_using_qp-&gt;init(msh-&gt;n_processors(), 1 , <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>);</div>
<div class="line"><span class="lineno">  896</span> </div>
<div class="line"><span class="lineno">  897</span>         <span class="keywordflow">if</span> (sobolev_norms == 0) { norm_vec_exact_using_qp-&gt;set(iproc, norms_exact_function_at_qp[0]);  norm_vec_exact_using_qp-&gt;close();  norms_exact_function_at_qp[0] = norm_vec_exact_using_qp-&gt;l1_norm(); }</div>
<div class="line"><span class="lineno">  898</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sobolev_norms == 1) { norm_vec_exact_using_qp-&gt;set(iproc, norms_exact_function_at_qp[1]);  norm_vec_exact_using_qp-&gt;close();  norms_exact_function_at_qp[1] = norm_vec_exact_using_qp-&gt;l1_norm(); }</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>          <span class="keyword">delete</span> norm_vec_exact_using_qp;</div>
<div class="line"><span class="lineno">  901</span> </div>
<div class="line"><span class="lineno">  902</span>   <span class="comment">// add the norms of all processes</span></div>
<div class="line"><span class="lineno">  903</span>  NumericVector* norm_vec_exact_using_dofs;</div>
<div class="line"><span class="lineno">  904</span>                 norm_vec_exact_using_dofs = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  905</span>                 norm_vec_exact_using_dofs-&gt;init(msh-&gt;n_processors(), 1 , <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>);</div>
<div class="line"><span class="lineno">  906</span> </div>
<div class="line"><span class="lineno">  907</span>         <span class="keywordflow">if</span> (sobolev_norms == 0) { norm_vec_exact_using_dofs-&gt;set(iproc, norms_exact_function_at_dofs[0]);  norm_vec_exact_using_dofs-&gt;close();  norms_exact_function_at_dofs[0] = norm_vec_exact_using_dofs-&gt;l1_norm(); }</div>
<div class="line"><span class="lineno">  908</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sobolev_norms == 1) { norm_vec_exact_using_dofs-&gt;set(iproc, norms_exact_function_at_dofs[1]);  norm_vec_exact_using_dofs-&gt;close();  norms_exact_function_at_dofs[1] = norm_vec_exact_using_dofs-&gt;l1_norm(); }</div>
<div class="line"><span class="lineno">  909</span> </div>
<div class="line"><span class="lineno">  910</span>          <span class="keyword">delete</span> norm_vec_exact_using_dofs;</div>
<div class="line"><span class="lineno">  911</span> </div>
<div class="line"><span class="lineno">  912</span>  <span class="comment">// add the norms of all processes</span></div>
<div class="line"><span class="lineno">  913</span>  NumericVector* norm_vec_inexact;</div>
<div class="line"><span class="lineno">  914</span>                 norm_vec_inexact = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">NumericVector::build</a>().release();</div>
<div class="line"><span class="lineno">  915</span>                 norm_vec_inexact-&gt;init(msh-&gt;n_processors(), 1 , <span class="keyword">false</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>);</div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span>         <span class="keywordflow">if</span> (sobolev_norms == 0) { norm_vec_inexact-&gt;set(iproc, norms_inexact_dofs[0]);  norm_vec_inexact-&gt;close();  norms_inexact_dofs[0] = norm_vec_inexact-&gt;l1_norm(); }</div>
<div class="line"><span class="lineno">  918</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sobolev_norms == 1) { norm_vec_inexact-&gt;set(iproc, norms_inexact_dofs[1]);  norm_vec_inexact-&gt;close();  norms_inexact_dofs[1] = norm_vec_inexact-&gt;l1_norm(); }</div>
<div class="line"><span class="lineno">  919</span> </div>
<div class="line"><span class="lineno">  920</span>          <span class="keyword">delete</span> norm_vec_inexact;</div>
<div class="line"><span class="lineno">  921</span> </div>
<div class="line"><span class="lineno">  922</span>          </div>
<div class="line"><span class="lineno">  923</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> n = 0; n &lt; norms_exact_function_at_qp.size(); n++) { </div>
<div class="line"><span class="lineno">  924</span>     norms_exact_function_at_qp[n] = sqrt(norms_exact_function_at_qp[n]);                                            </div>
<div class="line"><span class="lineno">  925</span>   norms_exact_function_at_dofs[n] = sqrt(norms_exact_function_at_dofs[n]);                                            </div>
<div class="line"><span class="lineno">  926</span>             norms_inexact_dofs[n] = sqrt(norms_inexact_dofs[n]);</div>
<div class="line"><span class="lineno">  927</span>    }</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span><span class="comment">// *** Add norms to all processes - END ***</span></div>
<div class="line"><span class="lineno">  930</span>    </div>
<div class="line"><span class="lineno">  931</span>    </div>
<div class="line"><span class="lineno">  932</span><span class="keywordflow">if</span> (convergence_rate_computation_method == 0)  <span class="keywordflow">return</span> norms_inexact_dofs;</div>
<div class="line"><span class="lineno">  933</span><span class="keywordflow">if</span> (convergence_rate_computation_method == 1)  <span class="keywordflow">return</span> norms_exact_function_at_qp;</div>
<div class="line"><span class="lineno">  934</span><span class="comment">// if (convergence_rate_computation_method == 1)  return   norms_exact_function_at_dofs; //@todo this one does not work in the ABSOLUTE case but only in the INCREMENTAL case</span></div>
<div class="line"><span class="lineno">  935</span> </div>
<div class="line"><span class="lineno">  936</span> </div>
<div class="line"><span class="lineno">  937</span>} </div>
<div class="ttc" id="a090___s_w_2ex2_2ex2_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">double phi</div><div class="ttdef"><b>Definition</b> <a href="../../da/d8c/090___s_w_2ex2_2ex2_8cpp_source.html#l00039">ex2.cpp:39</a></div></div>
<div class="ttc" id="a_f_elem_type_enum__list_8hpp_html_aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957"><div class="ttname"><a href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a></div><div class="ttdeci">@ CONTINUOUS_BIQUADRATIC</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d70/_f_elem_type_enum__list_8hpp_source.html#l00029">FElemTypeEnum_list.hpp:29</a></div></div>
<div class="ttc" id="a_navier_stokes___a_m_r_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp_source.html#l00034">NavierStokes_AMR.cpp:34</a></div></div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></div><div class="ttdeci">@ AUTOMATIC</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00005">ParalleltypeEnum.hpp:5</a></div></div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_a3fd9d8b24165dfde984e1cff795982be"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3fd9d8b24165dfde984e1cff795982be">femus::FE_convergence::norm_names</a></div><div class="ttdeci">static const std::vector&lt; std::string &gt; norm_names</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00060">FE_convergence.hpp:60</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_aa554690df717f373d2b51e564fc421d6"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">femus::NumericVector::build</a></div><div class="ttdeci">static std::unique_ptr&lt; NumericVector &gt; build(const SolverPackage solver_package=LSOLVER)</div><div class="ttdef"><b>Definition</b> <a href="../../de/dbc/_numeric_vector_8cpp_source.html#l00036">NumericVector.cpp:36</a></div></div>
<div class="ttc" id="anamespacefemus_1_1_math_html_a8cc628585642221c8f364d86376abdf8"><div class="ttname"><a href="../../d0/d3b/namespacefemus_1_1_math.html#a8cc628585642221c8f364d86376abdf8">femus::Math::tangent_vector_from_normal</a></div><div class="ttdeci">std::vector&lt; double &gt; tangent_vector_from_normal(const std::vector&lt; double &gt; orig_vector, const std::vector&lt; double &gt; normal, const uint spacedim)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/df6/_vector_operations_8hpp_source.html#l00091">VectorOperations.hpp:91</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a17e49fc38b543aca1c7d97e188f392eb" name="a17e49fc38b543aca1c7d97e188f392eb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a17e49fc38b543aca1c7d97e188f392eb">&#9670;&#160;</a></span>convergence_study()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::convergence_study </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_mesh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> *&#160;</td>
          <td class="paramname"><em>ml_mesh_all_levels_needed_for_incremental</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>max_number_of_meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>convergence_rate_computation_method_Flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>volume_or_boundary_Flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; bool &gt;&#160;</td>
          <td class="paramname"><em>sobolev_norms_Flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>main_in_has_equation_solve</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../dc/dba/classfemus_1_1_solution__generation__single__level.html">Solution_generation_single_level</a> &amp;&#160;</td>
          <td class="paramname"><em>main_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; double &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>exact_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a51e1cff061477ba02672e5ef790c465f">MultiLevelSolution::InitFuncMLProb</a>&#160;</td>
          <td class="paramname"><em>SetInitialCondition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac2ecfa36125c8626b6fdf20f71dbde0c">MultiLevelSolution::BoundaryFuncMLProb</a>&#160;</td>
          <td class="paramname"><em>SetBoundaryCondition</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00139">139</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  152</span>                                                   {</div>
<div class="line"><span class="lineno">  153</span>   </div>
<div class="line"><span class="lineno">  154</span>      <span class="comment">// Controls - BEGIN </span></div>
<div class="line"><span class="lineno">  155</span>      <span class="keywordflow">if</span> ( main_in_has_equation_solve == <span class="keyword">true</span> &amp;&amp;  <a class="code hl_function" href="../../d8/dea/namespacefemus.html#a47ed9315ef75de950a13364e002d5311">SetBoundaryCondition</a> == NULL)  { std::cout &lt;&lt; <span class="stringliteral">&quot;Must provide a BC function&quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  156</span>      </div>
<div class="line"><span class="lineno">  157</span>       <span class="keywordflow">if</span> (convergence_rate_computation_method_Flag[0] == <span class="keyword">true</span> &amp;&amp;  ml_mesh_all_levels_needed_for_incremental == NULL)  {</div>
<div class="line"><span class="lineno">  158</span>         std::cout &lt;&lt; <span class="stringliteral">&quot;Incremental method requires auxiliary mesh for all levels&quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  159</span>         </div>
<div class="line"><span class="lineno">  160</span>       <span class="keywordflow">if</span> (convergence_rate_computation_method_Flag[1] == <span class="keyword">true</span> &amp;&amp; exact_sol.size() == 0)  { std::cout &lt;&lt; <span class="stringliteral">&quot;Must provide exact sol&quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  161</span> </div>
<div class="line"><span class="lineno">  162</span>    </div>
<div class="line"><span class="lineno">  163</span>    <span class="keywordflow">if</span> ( convergence_rate_computation_method_Flag.size() !=   <a class="code hl_variable" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#ae5fde53ca79bcb98cffa4ab41ea66b23">convergence_computation_names</a>.size() ) { std::cout &lt;&lt; <span class="stringliteral">&quot;Not implemented&quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  164</span>    <span class="keywordflow">if</span> ( volume_or_boundary_Flag.size() != <a class="code hl_variable" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#af549488009a4290018e8b86931eb0b44">volume_or_boundary_names</a>.size() )                  { std::cout &lt;&lt; <span class="stringliteral">&quot;Not implemented&quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  165</span>    <span class="keywordflow">if</span> ( sobolev_norms_Flag.size() != <a class="code hl_variable" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3fd9d8b24165dfde984e1cff795982be">norm_names</a>.size() )                       { std::cout &lt;&lt; <span class="stringliteral">&quot;Not implemented&quot;</span> &lt;&lt; std::endl; abort(); }</div>
<div class="line"><span class="lineno">  166</span>       <span class="comment">// Controls - END</span></div>
<div class="line"><span class="lineno">  167</span>  </div>
<div class="line"><span class="lineno">  168</span>    </div>
<div class="line"><span class="lineno">  169</span>    <span class="comment">// ================= initialize norms - BEGIN </span></div>
<div class="line"><span class="lineno">  170</span>    </div>
<div class="line"><span class="lineno">  171</span>     std::vector &lt; std::vector &lt; std::vector &lt; std::vector &lt; std::vector &lt; double &gt; &gt; &gt; &gt; &gt;   norms;</div>
<div class="line"><span class="lineno">  172</span>     </div>
<div class="line"><span class="lineno">  173</span>     norms.resize(convergence_rate_computation_method_Flag.size());</div>
<div class="line"><span class="lineno">  174</span>     </div>
<div class="line"><span class="lineno">  175</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> convergence_rate_computation_method = 0; </div>
<div class="line"><span class="lineno">  176</span>                    convergence_rate_computation_method &lt; convergence_rate_computation_method_Flag.size(); </div>
<div class="line"><span class="lineno">  177</span>                    convergence_rate_computation_method++) {</div>
<div class="line"><span class="lineno">  178</span>        <span class="comment">//0: incremental 1: absolute (with analytical sol)  2: absolute (with projection of finest sol)...</span></div>
<div class="line"><span class="lineno">  179</span>        </div>
<div class="line"><span class="lineno">  180</span>     norms[convergence_rate_computation_method].resize( volume_or_boundary_Flag.size() );  </div>
<div class="line"><span class="lineno">  181</span> </div>
<div class="line"><span class="lineno">  182</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> volume_or_boundary = 0;</div>
<div class="line"><span class="lineno">  183</span>                    volume_or_boundary &lt; volume_or_boundary_Flag.size(); </div>
<div class="line"><span class="lineno">  184</span>                    volume_or_boundary++) {<span class="comment">// (//0 = only V: //1 = only B) </span></div>
<div class="line"><span class="lineno">  185</span> </div>
<div class="line"><span class="lineno">  186</span>        norms[convergence_rate_computation_method][volume_or_boundary].resize( sobolev_norms_Flag.size() );   </div>
<div class="line"><span class="lineno">  187</span>     </div>
<div class="line"><span class="lineno">  188</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> sobolev_norms = 0; </div>
<div class="line"><span class="lineno">  189</span>                    sobolev_norms &lt; sobolev_norms_Flag.size();</div>
<div class="line"><span class="lineno">  190</span>                    sobolev_norms++) {  <span class="comment">//  what Sobolev norms to compute //0 = only L2: //1 = only H1)</span></div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>     <span class="comment">// norms[convergence_rate_computation_method][volume_or_boundary][sobolev_norms].resize( unknowns.size() );</span></div>
<div class="line"><span class="lineno">  193</span> </div>
<div class="line"><span class="lineno">  194</span>     norms[convergence_rate_computation_method][volume_or_boundary][sobolev_norms] = <a class="code hl_function" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#ad95c3acc820b1640285ec723f0648644">FE_convergence::initialize_vector_of_norms</a> (unknowns.size(), max_number_of_meshes);</div>
<div class="line"><span class="lineno">  195</span>     </div>
<div class="line"><span class="lineno">  196</span>           }</div>
<div class="line"><span class="lineno">  197</span>        }</div>
<div class="line"><span class="lineno">  198</span>      }</div>
<div class="line"><span class="lineno">  199</span>     </div>
<div class="line"><span class="lineno">  200</span>    <span class="comment">// ================= initialize norms - END</span></div>
<div class="line"><span class="lineno">  201</span>     </div>
<div class="line"><span class="lineno">  202</span>    </div>
<div class="line"><span class="lineno">  203</span>    <span class="comment">// ================= initialize convergence study, ONLY FOR INCREMENTAL - BEGIN </span></div>
<div class="line"><span class="lineno">  204</span>     MultiLevelSolution         ml_sol_all_levels_needed_for_incremental = <a class="code hl_function" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a5f019f4ec34524e79a5a6e4de37e90e1">FE_convergence::initialize_convergence_study</a>(ml_prob,</div>
<div class="line"><span class="lineno">  205</span>                                                                                                 unknowns,</div>
<div class="line"><span class="lineno">  206</span>                                                                                                 exact_sol,</div>
<div class="line"><span class="lineno">  207</span>                                                                                                 *ml_mesh_all_levels_needed_for_incremental, </div>
<div class="line"><span class="lineno">  208</span>                                                                                                 max_number_of_meshes, </div>
<div class="line"><span class="lineno">  209</span>                                                                                                 <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ad7f0d0e656e4d135c7dd2869a4d87c1d">SetInitialCondition</a>, </div>
<div class="line"><span class="lineno">  210</span>                                                                                                 <a class="code hl_function" href="../../d8/dea/namespacefemus.html#a47ed9315ef75de950a13364e002d5311">SetBoundaryCondition</a>,</div>
<div class="line"><span class="lineno">  211</span>                                                                                                 main_in_has_equation_solve);</div>
<div class="line"><span class="lineno">  212</span>    <span class="comment">// ================= initialize convergence study, ONLY FOR INCREMENTAL - END</span></div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>    <span class="comment">// ================= Error computation at all levels - BEGIN =============</span></div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span>     </div>
<div class="line"><span class="lineno">  218</span>    <span class="comment">// ================= FE Evaluations at Quadrature - BEGIN </span></div>
<div class="line"><span class="lineno">  219</span>  <span class="comment">//prepare Abstract quantities for all fe fams for all geom elems: all quadrature evaluations are performed beforehand in the main function</span></div>
<div class="line"><span class="lineno">  220</span>  std::vector &lt; std::vector &lt; <span class="comment">/*const*/</span> elem_type_templ_base&lt;real_num, double&gt; *  &gt; &gt; elem_all;</div>
<div class="line"><span class="lineno">  221</span>  ml_prob.get_all_abstract_fe(elem_all);</div>
<div class="line"><span class="lineno">  222</span>    <span class="comment">// ================= FE Evaluations at Quadrature - END</span></div>
<div class="line"><span class="lineno">  223</span>  </div>
<div class="line"><span class="lineno">  224</span>  </div>
<div class="line"><span class="lineno">  225</span>            </div>
<div class="line"><span class="lineno">  226</span>       <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; max_number_of_meshes; lev++) {</div>
<div class="line"><span class="lineno">  227</span>         </div>
<div class="line"><span class="lineno">  228</span>                  </div>
<div class="line"><span class="lineno">  229</span>    <span class="comment">// ================= Compute solution - BEGIN </span></div>
<div class="line"><span class="lineno">  230</span>            <span class="keyword">const</span> MultiLevelSolution ml_sol_single_level = main_in.run_on_single_level(ml_prob,</div>
<div class="line"><span class="lineno">  231</span>                                                                                       ml_mesh,</div>
<div class="line"><span class="lineno">  232</span>                                                                                       lev,</div>
<div class="line"><span class="lineno">  233</span>                                                                                       unknowns,</div>
<div class="line"><span class="lineno">  234</span>                                                                                       exact_sol,</div>
<div class="line"><span class="lineno">  235</span>                                                                                       <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ad7f0d0e656e4d135c7dd2869a4d87c1d">SetInitialCondition</a>, </div>
<div class="line"><span class="lineno">  236</span>                                                                                       <a class="code hl_function" href="../../d8/dea/namespacefemus.html#a47ed9315ef75de950a13364e002d5311">SetBoundaryCondition</a>,</div>
<div class="line"><span class="lineno">  237</span>                                                                                       main_in_has_equation_solve</div>
<div class="line"><span class="lineno">  238</span>                                                                                      );</div>
<div class="line"><span class="lineno">  239</span>    <span class="comment">// ================= Compute solution - END</span></div>
<div class="line"><span class="lineno">  240</span>            </div>
<div class="line"><span class="lineno">  241</span>            </div>
<div class="line"><span class="lineno">  242</span>    <span class="comment">// ================= Compute error - BEGIN </span></div>
<div class="line"><span class="lineno">  243</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> convergence_rate_computation_method = 0; </div>
<div class="line"><span class="lineno">  244</span>                    convergence_rate_computation_method &lt; convergence_rate_computation_method_Flag.size();</div>
<div class="line"><span class="lineno">  245</span>                    convergence_rate_computation_method++) {</div>
<div class="line"><span class="lineno">  246</span>        <span class="keywordflow">if</span>( convergence_rate_computation_method_Flag[convergence_rate_computation_method] ) {</div>
<div class="line"><span class="lineno">  247</span>        </div>
<div class="line"><span class="lineno">  248</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> volume_or_boundary = 0;</div>
<div class="line"><span class="lineno">  249</span>                      volume_or_boundary &lt; volume_or_boundary_Flag.size();</div>
<div class="line"><span class="lineno">  250</span>                      volume_or_boundary++) { </div>
<div class="line"><span class="lineno">  251</span>          <span class="keywordflow">if</span>( volume_or_boundary_Flag[volume_or_boundary] ) {</div>
<div class="line"><span class="lineno">  252</span> </div>
<div class="line"><span class="lineno">  253</span>     </div>
<div class="line"><span class="lineno">  254</span>           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> sobolev_norms = 0; </div>
<div class="line"><span class="lineno">  255</span>                         sobolev_norms &lt; sobolev_norms_Flag.size();</div>
<div class="line"><span class="lineno">  256</span>                         sobolev_norms++) {</div>
<div class="line"><span class="lineno">  257</span>          <span class="keywordflow">if</span>( sobolev_norms_Flag[sobolev_norms] ) {</div>
<div class="line"><span class="lineno">  258</span>        </div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>            <a class="code hl_function" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#aa0a1dc7c62520f7573a2d19b383f6f97">FE_convergence::compute_error_norms_per_unknown_per_level</a> ( elem_all,</div>
<div class="line"><span class="lineno">  261</span>                                                                        ml_prob.GetQuadratureRuleAllGeomElems(),</div>
<div class="line"><span class="lineno">  262</span>                                                                        &amp; ml_sol_single_level,</div>
<div class="line"><span class="lineno">  263</span>                                                                        &amp; ml_sol_all_levels_needed_for_incremental,</div>
<div class="line"><span class="lineno">  264</span>                                                                        unknowns,</div>
<div class="line"><span class="lineno">  265</span>                                                                        exact_sol,</div>
<div class="line"><span class="lineno">  266</span>                                                                        norms[convergence_rate_computation_method][volume_or_boundary][sobolev_norms],</div>
<div class="line"><span class="lineno">  267</span>                                                                        lev,</div>
<div class="line"><span class="lineno">  268</span>                                                                        sobolev_norms,</div>
<div class="line"><span class="lineno">  269</span>                                                                        volume_or_boundary,</div>
<div class="line"><span class="lineno">  270</span>                                                                        convergence_rate_computation_method);</div>
<div class="line"><span class="lineno">  271</span>           }}</div>
<div class="line"><span class="lineno">  272</span>        }}</div>
<div class="line"><span class="lineno">  273</span>       }}</div>
<div class="line"><span class="lineno">  274</span>    <span class="comment">// ================= Compute error - END </span></div>
<div class="line"><span class="lineno">  275</span>        </div>
<div class="line"><span class="lineno">  276</span>        </div>
<div class="line"><span class="lineno">  277</span>      }</div>
<div class="line"><span class="lineno">  278</span>      </div>
<div class="line"><span class="lineno">  279</span>    <span class="comment">// ================= Error computation at all levels - END =============</span></div>
<div class="line"><span class="lineno">  280</span>      </div>
<div class="line"><span class="lineno">  281</span>   </div>
<div class="line"><span class="lineno">  282</span>    <span class="comment">// ================= Error output - BEGIN </span></div>
<div class="line"><span class="lineno">  283</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> convergence_rate_computation_method = 0; </div>
<div class="line"><span class="lineno">  284</span>                    convergence_rate_computation_method &lt; convergence_rate_computation_method_Flag.size();</div>
<div class="line"><span class="lineno">  285</span>                    convergence_rate_computation_method++) {</div>
<div class="line"><span class="lineno">  286</span>        <span class="keywordflow">if</span>( convergence_rate_computation_method_Flag[convergence_rate_computation_method] ) {</div>
<div class="line"><span class="lineno">  287</span>        </div>
<div class="line"><span class="lineno">  288</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> volume_or_boundary = 0;</div>
<div class="line"><span class="lineno">  289</span>                      volume_or_boundary &lt; volume_or_boundary_Flag.size();</div>
<div class="line"><span class="lineno">  290</span>                      volume_or_boundary++) { </div>
<div class="line"><span class="lineno">  291</span>          <span class="keywordflow">if</span>( volume_or_boundary_Flag[volume_or_boundary] ) {</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>     </div>
<div class="line"><span class="lineno">  294</span>           <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> sobolev_norms = 0; </div>
<div class="line"><span class="lineno">  295</span>                         sobolev_norms &lt; sobolev_norms_Flag.size();</div>
<div class="line"><span class="lineno">  296</span>                         sobolev_norms++) {</div>
<div class="line"><span class="lineno">  297</span>          <span class="keywordflow">if</span>( sobolev_norms_Flag[sobolev_norms] ) {</div>
<div class="line"><span class="lineno">  298</span>                     </div>
<div class="line"><span class="lineno">  299</span>       <a class="code hl_function" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a10e7518aaa5bfefd09a918860b0d64d7">FE_convergence::output_convergence_order_all</a>(unknowns,</div>
<div class="line"><span class="lineno">  300</span>                                                    norms[convergence_rate_computation_method][volume_or_boundary][sobolev_norms],</div>
<div class="line"><span class="lineno">  301</span>                                                    sobolev_norms,</div>
<div class="line"><span class="lineno">  302</span>                                                    volume_or_boundary,</div>
<div class="line"><span class="lineno">  303</span>                                                    convergence_rate_computation_method);</div>
<div class="line"><span class="lineno">  304</span>       </div>
<div class="line"><span class="lineno">  305</span>             }}</div>
<div class="line"><span class="lineno">  306</span>          }}</div>
<div class="line"><span class="lineno">  307</span>        }}</div>
<div class="line"><span class="lineno">  308</span>    <span class="comment">// ================= Error output - END </span></div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>}</div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_a10e7518aaa5bfefd09a918860b0d64d7"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a10e7518aaa5bfefd09a918860b0d64d7">femus::FE_convergence::output_convergence_order_all</a></div><div class="ttdeci">static void output_convergence_order_all(const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;norms, const unsigned sobolev_norms, const unsigned volume_or_boundary, const unsigned convergence_computation_method)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00433">FE_convergence.hpp:433</a></div></div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_a5f019f4ec34524e79a5a6e4de37e90e1"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a5f019f4ec34524e79a5a6e4de37e90e1">femus::FE_convergence::initialize_convergence_study</a></div><div class="ttdeci">static const MultiLevelSolution initialize_convergence_study(const MultiLevelProblem &amp;ml_prob, const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; Math::Function&lt; double &gt; * &gt; &amp;exact_sol, MultiLevelMesh &amp;ml_mesh_all_levels_needed_for_incremental, const unsigned max_number_of_meshes, const MultiLevelSolution::InitFuncMLProb SetInitialCondition_in, const MultiLevelSolution::BoundaryFuncMLProb SetBoundaryCondition, const bool main_in_has_equation_solve)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00317">FE_convergence.hpp:317</a></div></div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_aa0a1dc7c62520f7573a2d19b383f6f97"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#aa0a1dc7c62520f7573a2d19b383f6f97">femus::FE_convergence::compute_error_norms_per_unknown_per_level</a></div><div class="ttdeci">static void compute_error_norms_per_unknown_per_level(const std::vector&lt; std::vector&lt; elem_type_templ_base&lt; real_num, double &gt; * &gt; &gt; &amp;elem_all, const std::vector&lt; Gauss &gt; &amp;quad_rules, const MultiLevelSolution *ml_sol_single_level, MultiLevelSolution *ml_sol_all_levels_needed_for_incremental, const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; Math::Function&lt; real_num &gt; * &gt; &amp;ex_sol_in, std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;norms, const unsigned i, const unsigned sobolev_norms, const unsigned volume_or_boundary, const unsigned convergence_rate_computation_method)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00966">FE_convergence.hpp:966</a></div></div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_ad95c3acc820b1640285ec723f0648644"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#ad95c3acc820b1640285ec723f0648644">femus::FE_convergence::initialize_vector_of_norms</a></div><div class="ttdeci">static std::vector&lt; std::vector&lt; real_num &gt; &gt; initialize_vector_of_norms(const unsigned unknowns_size, const unsigned max_number_of_meshes)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00377">FE_convergence.hpp:377</a></div></div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_ae5fde53ca79bcb98cffa4ab41ea66b23"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#ae5fde53ca79bcb98cffa4ab41ea66b23">femus::FE_convergence::convergence_computation_names</a></div><div class="ttdeci">static const std::vector&lt; std::string &gt; convergence_computation_names</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00061">FE_convergence.hpp:61</a></div></div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_af549488009a4290018e8b86931eb0b44"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#af549488009a4290018e8b86931eb0b44">femus::FE_convergence::volume_or_boundary_names</a></div><div class="ttdeci">static const std::vector&lt; std::string &gt; volume_or_boundary_names</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00062">FE_convergence.hpp:62</a></div></div>
<div class="ttc" id="anamespacefemus_html_a47ed9315ef75de950a13364e002d5311"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a47ed9315ef75de950a13364e002d5311">femus::SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;xp, const char name[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d9a/02__elliptic__with__given__advection_2_opt_loop_8cpp_source.html#l00374">OptLoop.cpp:374</a></div></div>
<div class="ttc" id="anamespacefemus_html_ad7f0d0e656e4d135c7dd2869a4d87c1d"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#ad7f0d0e656e4d135c7dd2869a4d87c1d">femus::SetInitialCondition</a></div><div class="ttdeci">double SetInitialCondition(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;xp, const char name[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d9a/02__elliptic__with__given__advection_2_opt_loop_8cpp_source.html#l00583">OptLoop.cpp:583</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5f019f4ec34524e79a5a6e4de37e90e1" name="a5f019f4ec34524e79a5a6e4de37e90e1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5f019f4ec34524e79a5a6e4de37e90e1">&#9670;&#160;</a></span>initialize_convergence_study()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::initialize_convergence_study </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../da/d19/classfemus_1_1_math_1_1_function.html">Math::Function</a>&lt; double &gt; * &gt; &amp;&#160;</td>
          <td class="paramname"><em>exact_sol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_mesh_all_levels_needed_for_incremental</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>max_number_of_meshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a51e1cff061477ba02672e5ef790c465f">MultiLevelSolution::InitFuncMLProb</a>&#160;</td>
          <td class="paramname"><em>SetInitialCondition_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac2ecfa36125c8626b6fdf20f71dbde0c">MultiLevelSolution::BoundaryFuncMLProb</a>&#160;</td>
          <td class="paramname"><em>SetBoundaryCondition</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>main_in_has_equation_solve</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00317">317</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  325</span>                                                                                              {</div>
<div class="line"><span class="lineno">  326</span> </div>
<div class="line"><span class="lineno">  327</span> <span class="comment">//Problem - BEGIN ==================</span></div>
<div class="line"><span class="lineno">  328</span>  MultiLevelProblem  ml_prob_aux(ml_prob);</div>
<div class="line"><span class="lineno">  329</span> <span class="comment">//Problem - END ==================</span></div>
<div class="line"><span class="lineno">  330</span>  </div>
<div class="line"><span class="lineno">  331</span>  </div>
<div class="line"><span class="lineno">  332</span> <span class="comment">//Mesh: construct all levels - BEGIN  ==================</span></div>
<div class="line"><span class="lineno">  333</span>        <span class="keywordtype">unsigned</span> numberOfUniformLevels_finest = max_number_of_meshes;</div>
<div class="line"><span class="lineno">  334</span>        ml_mesh_all_levels_needed_for_incremental.RefineMesh(numberOfUniformLevels_finest, numberOfUniformLevels_finest, NULL);</div>
<div class="line"><span class="lineno">  335</span><span class="comment">//      ml_mesh_all_levels_needed_for_incremental.EraseCoarseLevels(numberOfUniformLevels - 2);  // need to keep at least two levels to send u_(i-1) projected(prolongated) into next refinement</span></div>
<div class="line"><span class="lineno">  336</span> <span class="comment">//Mesh: construct all levels - END ==================</span></div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span> <span class="comment">//Solution - BEGIN ==================</span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">// MultiLevelSolution *   ml_sol_all_levels_needed_for_incremental = new MultiLevelSolution (&amp; ml_mesh_all_levels_needed_for_incremental);  </span></div>
<div class="line"><span class="lineno">  341</span>          <span class="comment">//with the declaration outside and a &quot;new&quot; inside it persists outside the loop scopes</span></div>
<div class="line"><span class="lineno">  342</span>               MultiLevelSolution ml_sol_all_levels_needed_for_incremental(&amp; ml_mesh_all_levels_needed_for_incremental);</div>
<div class="line"><span class="lineno">  343</span> <span class="comment">//Solution - END ==================</span></div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span> <span class="comment">//Problem - BEGIN ==================</span></div>
<div class="line"><span class="lineno">  346</span>  ml_prob_aux.SetMultiLevelMeshAndSolution(&amp; ml_sol_all_levels_needed_for_incremental);</div>
<div class="line"><span class="lineno">  347</span> <span class="comment">//Problem - END ==================</span></div>
<div class="line"><span class="lineno">  348</span>               </div>
<div class="line"><span class="lineno">  349</span>               </div>
<div class="line"><span class="lineno">  350</span>  <span class="comment">//Solution, Initialize - BEGIN ==================</span></div>
<div class="line"><span class="lineno">  351</span>               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++) {</div>
<div class="line"><span class="lineno">  352</span>               ml_sol_all_levels_needed_for_incremental.AddSolution(unknowns[u]._name.c_str(), unknowns[u]._fe_family, unknowns[u]._fe_order);  <span class="comment">//We have to do so to avoid buildup of AddSolution with different FE families</span></div>
<div class="line"><span class="lineno">  353</span>               ml_sol_all_levels_needed_for_incremental.set_analytical_function(unknowns[u]._name.c_str(), exact_sol[u]);   </div>
<div class="line"><span class="lineno">  354</span>               ml_sol_all_levels_needed_for_incremental.Initialize(unknowns[u]._name.c_str(), SetInitialCondition_in, &amp; ml_prob_aux);</div>
<div class="line"><span class="lineno">  355</span>               }</div>
<div class="line"><span class="lineno">  356</span>  <span class="comment">//Solution, Initialize - END ==================</span></div>
<div class="line"><span class="lineno">  357</span>               </div>
<div class="line"><span class="lineno">  358</span>               </div>
<div class="line"><span class="lineno">  359</span> <span class="comment">// Only for an EQUATION - BEGIN  ==================</span></div>
<div class="line"><span class="lineno">  360</span>         <span class="keywordflow">if</span> (main_in_has_equation_solve) {</div>
<div class="line"><span class="lineno">  361</span>             </div>
<div class="line"><span class="lineno">  362</span>         ml_sol_all_levels_needed_for_incremental.AttachSetBoundaryConditionFunction(SetBoundaryCondition_in);</div>
<div class="line"><span class="lineno">  363</span>               <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++) {</div>
<div class="line"><span class="lineno">  364</span>               ml_sol_all_levels_needed_for_incremental.GenerateBdc(unknowns[u]._name.c_str(), <span class="stringliteral">&quot;Steady&quot;</span>, &amp; ml_prob_aux);</div>
<div class="line"><span class="lineno">  365</span>               }</div>
<div class="line"><span class="lineno">  366</span>               </div>
<div class="line"><span class="lineno">  367</span>         }</div>
<div class="line"><span class="lineno">  368</span> <span class="comment">// Only for an EQUATION - END  ==================</span></div>
<div class="line"><span class="lineno">  369</span> </div>
<div class="line"><span class="lineno">  370</span> <span class="keywordflow">return</span> ml_sol_all_levels_needed_for_incremental;</div>
<div class="line"><span class="lineno">  371</span>} </div>
</div><!-- fragment -->
</div>
</div>
<a id="ad95c3acc820b1640285ec723f0648644" name="ad95c3acc820b1640285ec723f0648644"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad95c3acc820b1640285ec723f0648644">&#9670;&#160;</a></span>initialize_vector_of_norms()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::vector&lt; std::vector&lt; real_num &gt; &gt; <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::initialize_vector_of_norms </td>
          <td>(</td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>unknowns_size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>max_number_of_meshes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00377">377</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  378</span>                                                                                                     {</div>
<div class="line"><span class="lineno">  379</span>   </div>
<div class="line"><span class="lineno">  380</span>           </div>
<div class="line"><span class="lineno">  381</span>   std::vector &lt; std::vector &lt; real_num &gt; &gt;   norms( unknowns_size );</div>
<div class="line"><span class="lineno">  382</span>   </div>
<div class="line"><span class="lineno">  383</span>  </div>
<div class="line"><span class="lineno">  384</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; norms.size(); u++) {</div>
<div class="line"><span class="lineno">  385</span>              norms[u].resize( max_number_of_meshes );</div>
<div class="line"><span class="lineno">  386</span>               std::fill(norms[u].begin(), norms[u].end(), 0.);</div>
<div class="line"><span class="lineno">  387</span>       }</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>    </div>
<div class="line"><span class="lineno">  390</span>    <span class="keywordflow">return</span> norms; </div>
<div class="line"><span class="lineno">  391</span>       </div>
<div class="line"><span class="lineno">  392</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3d845c73067be4a8865f78c7133239a8" name="a3d845c73067be4a8865f78c7133239a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3d845c73067be4a8865f78c7133239a8">&#9670;&#160;</a></span>output_convergence_order()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::output_convergence_order </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>norm</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>u</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00400">400</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  403</span>                                                                        {</div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>   <span class="keywordflow">if</span>(mesh_lev &lt; norm[solution].size() - 2)  {</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>    std::cout &lt;&lt; mesh_lev + 1;</div>
<div class="line"><span class="lineno">  408</span>    </div>
<div class="line"><span class="lineno">  409</span>    <span class="comment">//error value</span></div>
<div class="line"><span class="lineno">  410</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span>;</div>
<div class="line"><span class="lineno">  411</span>    std::cout.precision(14);</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>    std::cout &lt;&lt; norm[solution][mesh_lev] &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>    std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  416</span>  </div>
<div class="line"><span class="lineno">  417</span>    <span class="comment">//convergence rate value</span></div>
<div class="line"><span class="lineno">  418</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> <span class="comment">/*&lt;&lt;  std::fixed*/</span>;</div>
<div class="line"><span class="lineno">  419</span>    std::cout.precision(3);</div>
<div class="line"><span class="lineno">  420</span> </div>
<div class="line"><span class="lineno">  421</span>    std::cout &lt;&lt; log( norm[solution][mesh_lev] / norm[solution][mesh_lev + 1] ) / log(2.);</div>
<div class="line"><span class="lineno">  422</span> </div>
<div class="line"><span class="lineno">  423</span>    std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  424</span>      </div>
<div class="line"><span class="lineno">  425</span>    }</div>
<div class="line"><span class="lineno">  426</span>    </div>
<div class="line"><span class="lineno">  427</span>  </div>
<div class="line"><span class="lineno">  428</span>  </div>
<div class="line"><span class="lineno">  429</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a10e7518aaa5bfefd09a918860b0d64d7" name="a10e7518aaa5bfefd09a918860b0d64d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a10e7518aaa5bfefd09a918860b0d64d7">&#9670;&#160;</a></span>output_convergence_order_all()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::output_convergence_order_all </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>sobolev_norms</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>volume_or_boundary</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned&#160;</td>
          <td class="paramname"><em>convergence_computation_method</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00433">433</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  437</span>                                                                                       {</div>
<div class="line"><span class="lineno">  438</span>    </div>
<div class="line"><span class="lineno">  439</span>    </div>
<div class="line"><span class="lineno">  440</span>    assert( unknowns.size() == norms.size() );</div>
<div class="line"><span class="lineno">  441</span>    </div>
<div class="line"><span class="lineno">  442</span>    std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  443</span>      </div>
<div class="line"><span class="lineno">  444</span>        </div>
<div class="line"><span class="lineno">  445</span>     std::cout &lt;&lt; <span class="stringliteral">&quot;==== Convergence computation method: &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#ae5fde53ca79bcb98cffa4ab41ea66b23">convergence_computation_names</a>[convergence_computation_method] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  446</span>     </div>
<div class="line"><span class="lineno">  447</span>     std::cout &lt;&lt; <span class="stringliteral">&quot;==== Volume = 0, boundary = 1: here we have &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#af549488009a4290018e8b86931eb0b44">volume_or_boundary_names</a>[volume_or_boundary] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>     std::cout &lt;&lt; <span class="stringliteral">&quot;==== ERROR and ORDER OF CONVERGENCE for the norm &quot;</span> &lt;&lt; <a class="code hl_variable" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3fd9d8b24165dfde984e1cff795982be">norm_names</a>[sobolev_norms] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  450</span> </div>
<div class="line"><span class="lineno">  451</span>    </div>
<div class="line"><span class="lineno">  452</span>     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++) {</div>
<div class="line"><span class="lineno">  453</span>         </div>
<div class="line"><span class="lineno">  454</span>            std::cout &lt;&lt; unknowns[u]._name          &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; </div>
<div class="line"><span class="lineno">  455</span>            <span class="stringliteral">&quot; FE Family &quot;</span> &lt;&lt; unknowns[u]._fe_family &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt;</div>
<div class="line"><span class="lineno">  456</span>            <span class="stringliteral">&quot; FE Order &quot;</span>  &lt;&lt; unknowns[u]._fe_order  &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  457</span>            </div>
<div class="line"><span class="lineno">  458</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> lev = 0; lev &lt; norms[u].size(); lev++) {</div>
<div class="line"><span class="lineno">  459</span>                <a class="code hl_function" href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3d845c73067be4a8865f78c7133239a8">output_convergence_order</a>(norms, u, lev);</div>
<div class="line"><span class="lineno">  460</span>            }</div>
<div class="line"><span class="lineno">  461</span>            std::cout &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  462</span>            </div>
<div class="line"><span class="lineno">  463</span>       }</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>      </div>
<div class="line"><span class="lineno">  466</span> }</div>
<div class="ttc" id="aclassfemus_1_1_f_e__convergence_html_a3d845c73067be4a8865f78c7133239a8"><div class="ttname"><a href="../../d4/da0/classfemus_1_1_f_e__convergence.html#a3d845c73067be4a8865f78c7133239a8">femus::FE_convergence::output_convergence_order</a></div><div class="ttdeci">static void output_convergence_order(const std::vector&lt; std::vector&lt; real_num &gt; &gt; &amp;norm, const unsigned int u, const unsigned int i)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00400">FE_convergence.hpp:400</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="adb3b9278b60366eeb98c14ad512c94d9" name="adb3b9278b60366eeb98c14ad512c94d9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb3b9278b60366eeb98c14ad512c94d9">&#9670;&#160;</a></span>output_convergence_rate()</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::output_convergence_rate </td>
          <td>(</td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>norm_i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double&#160;</td>
          <td class="paramname"><em>norm_ip1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::string&#160;</td>
          <td class="paramname"><em>norm_name</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">unsigned&#160;</td>
          <td class="paramname"><em>maxNumberOfMeshes</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>loop_i</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00471">471</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  475</span>                                                                                 {</div>
<div class="line"><span class="lineno">  476</span> </div>
<div class="line"><span class="lineno">  477</span>    std::cout &lt;&lt; loop_i + 1 &lt;&lt; <span class="stringliteral">&quot;\t\t&quot;</span> &lt;&lt;  std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt; norm_i &lt;&lt; <span class="stringliteral">&quot;\t\t\t\t&quot;</span> ;</div>
<div class="line"><span class="lineno">  478</span>  </div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">if</span> (loop_i &lt; maxNumberOfMeshes<span class="comment">/*norm.size()*/</span> - 2) {</div>
<div class="line"><span class="lineno">  480</span>      std::cout &lt;&lt; std::setprecision(3) &lt;&lt; log( norm_i/ norm_ip1 ) / log(2.) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  481</span>    }</div>
<div class="line"><span class="lineno">  482</span>  </div>
<div class="line"><span class="lineno">  483</span>} </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ae5fde53ca79bcb98cffa4ab41ea66b23" name="ae5fde53ca79bcb98cffa4ab41ea66b23"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae5fde53ca79bcb98cffa4ab41ea66b23">&#9670;&#160;</a></span>convergence_computation_names</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::string &gt; <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::convergence_computation_names = {&quot;Incremental&quot;, &quot;Absolute, with analytical sol&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00061">61</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>

</div>
</div>
<a id="a3fd9d8b24165dfde984e1cff795982be" name="a3fd9d8b24165dfde984e1cff795982be"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3fd9d8b24165dfde984e1cff795982be">&#9670;&#160;</a></span>norm_names</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::string &gt; <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::norm_names = {&quot;L2-NORM&quot;, &quot;H1-SEMINORM&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00060">60</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>

</div>
</div>
<a id="af549488009a4290018e8b86931eb0b44" name="af549488009a4290018e8b86931eb0b44"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af549488009a4290018e8b86931eb0b44">&#9670;&#160;</a></span>volume_or_boundary_names</h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class real_num &gt; </div>
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; std::string &gt; <a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">femus::FE_convergence</a>&lt; real_num &gt;::volume_or_boundary_names = {&quot;Volume&quot;, &quot;Boundary&quot;}</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html#l00062">62</a> of file <a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>D:/femusDoxygen/source/src/06_solution/01_multiple_levels/02_FE_convergence/<a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/dea/namespacefemus.html">femus</a></li><li class="navelem"><a class="el" href="../../d4/da0/classfemus_1_1_f_e__convergence.html">FE_convergence</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
