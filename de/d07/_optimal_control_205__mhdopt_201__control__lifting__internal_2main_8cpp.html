<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/applications/OptimalControl/05_mhdopt/01_control_lifting_internal/main.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle"><div class="title">main.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &lt;sys/stat.h&gt;</code><br />
<code>#include &lt;sys/types.h&gt;</code><br />
<code>#include &lt;iostream&gt;</code><br />
<code>#include &lt;cstdlib&gt;</code><br />
<code>#include &lt;sstream&gt;</code><br />
<code>#include &quot;FemusConfig.hpp&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/dcd/paral_8hpp_source.html">paral.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/df8/_femus_default_8hpp_source.html">FemusDefault.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d7c/_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d4e/_files_8hpp_source.html">Files.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/d0c/_multi_level_mesh_two_8hpp_source.html">MultiLevelMeshTwo.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/dbc/_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../da/dce/_multi_level_solution_8hpp_source.html">MultiLevelSolution.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d7/db9/_gen_case_8hpp_source.html">GenCase.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dd/d9a/_f_e_type_enum_8hpp_source.html">FETypeEnum.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df9/_elem_type_8hpp_source.html">ElemType.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d9/d9f/_time_loop_8hpp_source.html">TimeLoop.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d5/dd2/_typedefs_8hpp_source.html">Typedefs.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d7d/_cmd_line_8hpp_source.html">CmdLine.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d5f/_quantity_8hpp_source.html">Quantity.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df1/_box_8hpp_source.html">Box.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d1a/_x_d_m_f_writer_8hpp_source.html">XDMFWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d68/05__mhdopt_201__control__lifting__internal_2_opt_loop_8hpp_source.html">OptLoop.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/dc2/_opt_quantities_8hpp_source.html">OptQuantities.hpp</a>&quot;</code><br />
</div>
<p><a href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a59d1be9e4af7c0f1408260c0bcc9c90b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a59d1be9e4af7c0f1408260c0bcc9c90b">GenMatRhsNS</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="memdesc:a59d1be9e4af7c0f1408260c0bcc9c90b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function assembles the matrix and the rhs:  <br /></td></tr>
<tr class="separator:a59d1be9e4af7c0f1408260c0bcc9c90b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef5d4eadfcb1d008a82cef4e8369a9ae"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#aef5d4eadfcb1d008a82cef4e8369a9ae">GenMatRhsNSAD</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:aef5d4eadfcb1d008a82cef4e8369a9ae"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa760825e3c49aa86e2451d09389412fa"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#aa760825e3c49aa86e2451d09389412fa">GenMatRhsMHD</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:aa760825e3c49aa86e2451d09389412fa"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3087d027394e34e7bf59b1bab68a0906"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a3087d027394e34e7bf59b1bab68a0906">GenMatRhsMHDAD</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:a3087d027394e34e7bf59b1bab68a0906"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38ac6282d8c343af5bf7a5db488f7a5b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a38ac6282d8c343af5bf7a5db488f7a5b">GenMatRhsMHDCONT</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:a38ac6282d8c343af5bf7a5db488f7a5b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="aa760825e3c49aa86e2451d09389412fa" name="aa760825e3c49aa86e2451d09389412fa"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa760825e3c49aa86e2451d09389412fa">&#9670;&#160;</a></span>GenMatRhsMHD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenMatRhsMHD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add element matrix and rhs to the global ones.</p>

<p class="definition">Definition at line <a class="el" href="../../dc/dd6/_eqn_m_h_d_8cpp_source.html#l00027">27</a> of file <a class="el" href="../../dc/dd6/_eqn_m_h_d_8cpp_source.html">EqnMHD.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   27</span>                                              {</div>
<div class="line"><span class="lineno">   28</span> </div>
<div class="line"><span class="lineno">   29</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; my_system = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_MHD&quot;</span>);</div>
<div class="line"><span class="lineno">   30</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Level = my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>();</div>
<div class="line"><span class="lineno">   31</span>  </div>
<div class="line"><span class="lineno">   32</span>  <span class="comment">//========= reference values =========</span></div>
<div class="line"><span class="lineno">   33</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> IRem = 1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Rem&quot;</span>);</div>
<div class="line"><span class="lineno">   34</span><span class="comment">//============================</span></div>
<div class="line"><span class="lineno">   35</span>  </div>
<div class="line"><span class="lineno">   36</span><span class="comment">//======== GEOMETRICAL ELEMENT =======</span></div>
<div class="line"><span class="lineno">   37</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> space_dim =       ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span><span class="comment">//==== Operators @ gauss ======== </span></div>
<div class="line"><span class="lineno">   40</span>  std::vector&lt;double&gt; Vel_vec_val_g(space_dim);</div>
<div class="line"><span class="lineno">   41</span>  std::vector&lt;double&gt; Vel_vec_val_g3D(3);</div>
<div class="line"><span class="lineno">   42</span>  std::vector&lt;double&gt; Bext_vec_val_g(space_dim);</div>
<div class="line"><span class="lineno">   43</span>  std::vector&lt;double&gt; Bext_vec_val_g3D(3);</div>
<div class="line"><span class="lineno">   44</span>  <span class="keywordtype">double</span>         vXBe_g3D[3];</div>
<div class="line"><span class="lineno">   45</span>  <span class="keywordtype">double</span>   vXBeXdphii_g3D[3];  </div>
<div class="line"><span class="lineno">   46</span>  <span class="keywordtype">double</span> curlBeXdphii_g3D[3];</div>
<div class="line"><span class="lineno">   47</span>  </div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordtype">double</span> LapBe_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   49</span><span class="comment">//============================</span></div>
<div class="line"><span class="lineno">   50</span>  </div>
<div class="line"><span class="lineno">   51</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;zero();</div>
<div class="line"><span class="lineno">   52</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;zero();</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   55</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>      *mymsh      =  ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(Level);</div>
<div class="line"><span class="lineno">   56</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>      *myel       =  mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">   57</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> myproc  = mymsh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">   58</span>    </div>
<div class="line"><span class="lineno">   59</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   60</span><span class="comment">// ==========================================</span></div>
<div class="line"><span class="lineno">   61</span>  </div>
<div class="line"><span class="lineno">   62</span>  {<span class="comment">//BEGIN VOLUME</span></div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mesh_vb = <a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>;</div>
<div class="line"><span class="lineno">   65</span>   </div>
<div class="line"><span class="lineno">   66</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_e = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level+1];</div>
<div class="line"><span class="lineno">   67</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_b = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level];</div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> iel=0; iel &lt; (nel_e - nel_b); iel++) {</div>
<div class="line"><span class="lineno">   70</span>   </div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_class" href="../../d4/d0f/classfemus_1_1_current_elem.html">CurrentElem&lt;double&gt;</a>       currelem(iel,myproc,Level,<a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>,&amp;my_system,ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>(),ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#aecca332d087e3bf5546d13b2bfe2b7e1">GetElemType</a>(),mymsh);</div>
<div class="line"><span class="lineno">   72</span>    <span class="comment">//   CurrentGaussPointBase &amp; currgp = //   CurrentGaussPointBase::build(currelem,ml_prob.GetQuadratureRule(currelem.GetDim()));</span></div>
<div class="line"><span class="lineno">   73</span>    </div>
<div class="line"><span class="lineno">   74</span><span class="comment">//=========INTERNAL QUANTITIES (unknowns of the equation) ==================</span></div>
<div class="line"><span class="lineno">   75</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomOldX(currelem);</div>
<div class="line"><span class="lineno">   76</span>    BhomOldX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom0&quot;</span>); </div>
<div class="line"><span class="lineno">   77</span>    BhomOldX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   78</span>    BhomOldX.Allocate();</div>
<div class="line"><span class="lineno">   79</span>    </div>
<div class="line"><span class="lineno">   80</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomOldY(currelem);</div>
<div class="line"><span class="lineno">   81</span>    BhomOldY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom1&quot;</span>); </div>
<div class="line"><span class="lineno">   82</span>    BhomOldY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   83</span>    BhomOldY.Allocate();</div>
<div class="line"><span class="lineno">   84</span>    </div>
<div class="line"><span class="lineno">   85</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomOldZ(currelem);</div>
<div class="line"><span class="lineno">   86</span>    BhomOldZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom2&quot;</span>); </div>
<div class="line"><span class="lineno">   87</span>    BhomOldZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   88</span>    BhomOldZ.Allocate();</div>
<div class="line"><span class="lineno">   89</span>    </div>
<div class="line"><span class="lineno">   90</span>    std::vector&lt;CurrentQuantity*&gt; BhomOld_vec;   </div>
<div class="line"><span class="lineno">   91</span>    BhomOld_vec.push_back(&amp;BhomOldX);</div>
<div class="line"><span class="lineno">   92</span>    BhomOld_vec.push_back(&amp;BhomOldY);</div>
<div class="line"><span class="lineno">   93</span>    BhomOld_vec.push_back(&amp;BhomOldZ);</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> LagMultOld(currelem);</div>
<div class="line"><span class="lineno">   96</span>    LagMultOld._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMult&quot;</span>);</div>
<div class="line"><span class="lineno">   97</span>    LagMultOld.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   98</span>    LagMultOld.Allocate();</div>
<div class="line"><span class="lineno">   99</span><span class="comment">//========= END INTERNAL QUANTITIES (unknowns of the equation) =================</span></div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    </div>
<div class="line"><span class="lineno">  102</span><span class="comment">//========= tEST AND SHAPE FOR QTYZERO AND QTYONE =================</span></div>
<div class="line"><span class="lineno">  103</span><span class="comment">//QTYZERO SHAPE: shape of the first Unknown</span></div>
<div class="line"><span class="lineno">  104</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Phij(currelem); <span class="comment">//TODO this is another Vect that doesnt have an associated quantity still</span></div>
<div class="line"><span class="lineno">  105</span>    Phij._dim      = 1;                                                         <span class="comment">//scalar!</span></div>
<div class="line"><span class="lineno">  106</span>    Phij._FEord    = BhomOldX._FEord;</div>
<div class="line"><span class="lineno">  107</span>    Phij._ndof     = currelem.GetElemType(Phij._FEord)-&gt;GetNDofs(); </div>
<div class="line"><span class="lineno">  108</span>    Phij.Allocate();</div>
<div class="line"><span class="lineno">  109</span>        </div>
<div class="line"><span class="lineno">  110</span><span class="comment">//QTYZERO tEST:  test of the first Unknown    </span></div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Phii(currelem);</div>
<div class="line"><span class="lineno">  112</span>    Phii._dim      = 1;</div>
<div class="line"><span class="lineno">  113</span>    Phii._FEord    = BhomOldX._FEord;</div>
<div class="line"><span class="lineno">  114</span>    Phii._ndof     = currelem.GetElemType(Phii._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">  115</span>    Phii.Allocate();</div>
<div class="line"><span class="lineno">  116</span>    </div>
<div class="line"><span class="lineno">  117</span><span class="comment">//QTYONE SHAPE: Shape of the second Unknown</span></div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Psij(currelem);</div>
<div class="line"><span class="lineno">  119</span>    Psij._dim      = 1;</div>
<div class="line"><span class="lineno">  120</span>    Psij._FEord    = LagMultOld._FEord;</div>
<div class="line"><span class="lineno">  121</span>    Psij._ndof     = currelem.GetElemType(Psij._FEord)-&gt;GetNDofs(); </div>
<div class="line"><span class="lineno">  122</span>    Psij.Allocate();</div>
<div class="line"><span class="lineno">  123</span>    </div>
<div class="line"><span class="lineno">  124</span><span class="comment">//QTYONE tEST: test of the second Unknown</span></div>
<div class="line"><span class="lineno">  125</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Psii(currelem);</div>
<div class="line"><span class="lineno">  126</span>    Psii._dim      = 1;</div>
<div class="line"><span class="lineno">  127</span>    Psii._FEord    = LagMultOld._FEord;</div>
<div class="line"><span class="lineno">  128</span>    Psii._ndof     = currelem.GetElemType(Psii._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">  129</span>    Psii.Allocate();</div>
<div class="line"><span class="lineno">  130</span> </div>
<div class="line"><span class="lineno">  131</span><span class="comment">//========= END tEST AND SHAPE FOR QTYZERO AND QTYONE =================</span></div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>    </div>
<div class="line"><span class="lineno">  134</span><span class="comment">//=========EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">  135</span>  <span class="comment">//========= //DOMAIN MAPPING</span></div>
<div class="line"><span class="lineno">  136</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> xyz(currelem);</div>
<div class="line"><span class="lineno">  137</span>    xyz._dim      = <a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>;</div>
<div class="line"><span class="lineno">  138</span>    xyz._FEord    = <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a>;</div>
<div class="line"><span class="lineno">  139</span>    xyz._ndof     = currelem.GetElemType(xyz._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">  140</span>    xyz.Allocate();</div>
<div class="line"><span class="lineno">  141</span>    </div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextX(currelem);</div>
<div class="line"><span class="lineno">  144</span>    BextX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt0&quot;</span>); </div>
<div class="line"><span class="lineno">  145</span>    BextX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  146</span>    BextX.Allocate();</div>
<div class="line"><span class="lineno">  147</span>    </div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextY(currelem);</div>
<div class="line"><span class="lineno">  149</span>    BextY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt1&quot;</span>); </div>
<div class="line"><span class="lineno">  150</span>    BextY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  151</span>    BextY.Allocate();</div>
<div class="line"><span class="lineno">  152</span>    </div>
<div class="line"><span class="lineno">  153</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextZ(currelem);</div>
<div class="line"><span class="lineno">  154</span>    BextZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt2&quot;</span>); </div>
<div class="line"><span class="lineno">  155</span>    BextZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  156</span>    BextZ.Allocate();</div>
<div class="line"><span class="lineno">  157</span>    </div>
<div class="line"><span class="lineno">  158</span>    std::vector&lt;CurrentQuantity*&gt; Bext_vec;   </div>
<div class="line"><span class="lineno">  159</span>    Bext_vec.push_back(&amp;BextX);</div>
<div class="line"><span class="lineno">  160</span>    Bext_vec.push_back(&amp;BextY);</div>
<div class="line"><span class="lineno">  161</span>    Bext_vec.push_back(&amp;BextZ);</div>
<div class="line"><span class="lineno">  162</span>  </div>
<div class="line"><span class="lineno">  163</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Bext_vecQuant(currelem);   <span class="comment">//without quantity, nor equation</span></div>
<div class="line"><span class="lineno">  164</span>    Bext_vecQuant._dim     = Bext_vec.size();</div>
<div class="line"><span class="lineno">  165</span>    Bext_vecQuant._FEord   = Bext_vec[0]-&gt;_FEord;</div>
<div class="line"><span class="lineno">  166</span>    Bext_vecQuant._ndof    = Bext_vec[0]-&gt;_ndof;</div>
<div class="line"><span class="lineno">  167</span>    Bext_vecQuant.Allocate();</div>
<div class="line"><span class="lineno">  168</span>   </div>
<div class="line"><span class="lineno">  169</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelX(currelem);</div>
<div class="line"><span class="lineno">  170</span>    VelX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>); </div>
<div class="line"><span class="lineno">  171</span>    VelX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  172</span>    VelX.Allocate();</div>
<div class="line"><span class="lineno">  173</span>    </div>
<div class="line"><span class="lineno">  174</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelY(currelem);</div>
<div class="line"><span class="lineno">  175</span>    VelY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>); </div>
<div class="line"><span class="lineno">  176</span>    VelY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  177</span>    VelY.Allocate();</div>
<div class="line"><span class="lineno">  178</span>    </div>
<div class="line"><span class="lineno">  179</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelZ(currelem);</div>
<div class="line"><span class="lineno">  180</span>    VelZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity2&quot;</span>); </div>
<div class="line"><span class="lineno">  181</span>    VelZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  182</span>    VelZ.Allocate();</div>
<div class="line"><span class="lineno">  183</span>    </div>
<div class="line"><span class="lineno">  184</span>    std::vector&lt;CurrentQuantity*&gt; Vel_vec;   </div>
<div class="line"><span class="lineno">  185</span>    Vel_vec.push_back(&amp;VelX);</div>
<div class="line"><span class="lineno">  186</span>    Vel_vec.push_back(&amp;VelY);</div>
<div class="line"><span class="lineno">  187</span>    Vel_vec.push_back(&amp;VelZ);</div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span><span class="comment">//=========END EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">  190</span><span class="comment">//======================</span></div>
<div class="line"><span class="lineno">  191</span><span class="comment">//======================</span></div>
<div class="line"><span class="lineno">  192</span>    </div>
<div class="line"><span class="lineno">  193</span>    </div>
<div class="line"><span class="lineno">  194</span>    currelem.Mat().zero();</div>
<div class="line"><span class="lineno">  195</span>    currelem.Rhs().zero();</div>
<div class="line"><span class="lineno">  196</span> </div>
<div class="line"><span class="lineno">  197</span>    currelem.SetDofobjConnCoords();</div>
<div class="line"><span class="lineno">  198</span>     currelem.SetElDofsBc();</div>
<div class="line"><span class="lineno">  199</span>    </div>
<div class="line"><span class="lineno">  200</span>    currelem.ConvertElemCoordsToMappingOrd(xyz);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    </div>
<div class="line"><span class="lineno">  203</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim &lt; space_dim; idim++)    {    </div>
<div class="line"><span class="lineno">  204</span>        BhomOld_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  205</span>            Vel_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  206</span>           Bext_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  207</span>    }</div>
<div class="line"><span class="lineno">  208</span>    </div>
<div class="line"><span class="lineno">  209</span>   Bext_vecQuant.GetElemDofs(Bext_vec); </div>
<div class="line"><span class="lineno">  210</span>   </div>
<div class="line"><span class="lineno">  211</span>    </div>
<div class="line"><span class="lineno">  212</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> el_ngauss = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qp = 0; qp &lt; el_ngauss; qp++) {</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span><span class="comment">//======= here starts the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  217</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     { </div>
<div class="line"><span class="lineno">  218</span><span class="comment">//   currgp.SetPhiElDofsFEVB_g (fe,qp);</span></div>
<div class="line"><span class="lineno">  219</span><span class="comment">//   currgp.SetDPhiDxezetaElDofsFEVB_g (fe,qp);  </span></div>
<div class="line"><span class="lineno">  220</span>}</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span> <span class="keyword">const</span> <span class="keywordtype">double</span>      det = 1.;  <span class="comment">//currgp.JacVectVV_g(xyz);</span></div>
<div class="line"><span class="lineno">  223</span> <span class="keyword">const</span> <span class="keywordtype">double</span> dtxJxW_g = det*ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">GetGaussWeight</a>(qp);</div>
<div class="line"><span class="lineno">  224</span> <span class="keyword">const</span> <span class="keywordtype">double</span>     detb = det/el_ngauss;</div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     {    </div>
<div class="line"><span class="lineno">  227</span><span class="comment">//   currgp.SetDPhiDxyzElDofsFEVB_g (fe,qp);</span></div>
<div class="line"><span class="lineno">  228</span><span class="comment">//   currgp.ExtendDphiDxyzElDofsFEVB_g (fe); </span></div>
<div class="line"><span class="lineno">  229</span>}</div>
<div class="line"><span class="lineno">  230</span><span class="comment">//======= end of the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span> </div>
<div class="line"><span class="lineno">  233</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim &lt; space_dim; idim++)  {</div>
<div class="line"><span class="lineno">  234</span>        BhomOld_vec[idim]-&gt;val_g();</div>
<div class="line"><span class="lineno">  235</span>            Vel_vec[idim]-&gt;val_g();            <span class="comment">//---- for Advection MAT &amp; RHS</span></div>
<div class="line"><span class="lineno">  236</span>      Vel_vec_val_g[idim] = Vel_vec[idim]-&gt;_val_g[0];</div>
<div class="line"><span class="lineno">  237</span>           Bext_vec[idim]-&gt;val_g();          <span class="comment">//----- for Advection RHS</span></div>
<div class="line"><span class="lineno">  238</span>     Bext_vec_val_g[idim] = Bext_vec[idim]-&gt;_val_g[0];</div>
<div class="line"><span class="lineno">  239</span>           Bext_vec[idim]-&gt;grad_g();          <span class="comment">//----- for Laplacian RHS</span></div>
<div class="line"><span class="lineno">  240</span>    }</div>
<div class="line"><span class="lineno">  241</span>    </div>
<div class="line"><span class="lineno">  242</span>      Bext_vecQuant.curl_g();          <span class="comment">//----- for Curl Curl RHS         //THE EXTENSION of the DOFS to 3D is done INSIDE!!</span></div>
<div class="line"><span class="lineno">  243</span> </div>
<div class="line"><span class="lineno">  244</span>       <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a7c61609663b61259ec67232f7eba0d3c">Math::extend</a>(&amp;Vel_vec_val_g[0],&amp;Vel_vec_val_g3D[0],space_dim);                    <span class="comment">//----- for Advection RHS</span></div>
<div class="line"><span class="lineno">  245</span>       <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a7c61609663b61259ec67232f7eba0d3c">Math::extend</a>(&amp;Bext_vec_val_g[0],&amp;Bext_vec_val_g3D[0],space_dim);                    <span class="comment">//----- for Advection RHS</span></div>
<div class="line"><span class="lineno">  246</span>       <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a06daa97a94cd109a7d0229d4e23a40d6">Math::cross</a>(&amp;Vel_vec_val_g3D[0],&amp;Bext_vec_val_g3D[0],vXBe_g3D);          <span class="comment">//----- for Advection RHS</span></div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  249</span><span class="comment">//========= FILLING ELEMENT MAT/RHS</span></div>
<div class="line"><span class="lineno">  250</span><span class="comment">//=================================</span></div>
<div class="line"><span class="lineno">  251</span><span class="comment">// // //        for (uint i=0; i &lt; BhomOldX._ndof; i++)     {</span></div>
<div class="line"><span class="lineno">  252</span><span class="comment">// // // //============ preparation for (i) (Phii) ============</span></div>
<div class="line"><span class="lineno">  253</span><span class="comment">// // //            Phii._val_g[0]       =      currgp._phi_ndsQLVB_g[Phii._FEord][i];          /*const double  phii_g*/ </span></div>
<div class="line"><span class="lineno">  254</span><span class="comment">// // //         for (uint idim=0; idim&lt;space_dim; idim++)</span></div>
<div class="line"><span class="lineno">  255</span><span class="comment">// // //      Phii._grad_g[0][idim] = currgp._dphidxyz_ndsQLVB_g[Phii._FEord][i+idim*Phii._ndof];   /*dphiidx_g*/</span></div>
<div class="line"><span class="lineno">  256</span><span class="comment">// // // //=== from this point on, the dependency on /*(i)*/, the ROW INDEX, of the quantities is given by Phii  </span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">// // // //===  /*(i)*/ is ONLY used for the POSITIONS, later</span></div>
<div class="line"><span class="lineno">  258</span><span class="comment">// // //      </span></div>
<div class="line"><span class="lineno">  259</span><span class="comment">// // //     //--------- LAPLACIAN: Operator, RHS: grad Be . grad phi ---------------------</span></div>
<div class="line"><span class="lineno">  260</span><span class="comment">// // //     for (uint idim=0; idim&lt;space_dim/*Bext._dim*/; idim++) LapBe_g[idim]=0.;</span></div>
<div class="line"><span class="lineno">  261</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  262</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim/*Bext._dim*/; idim++) {</span></div>
<div class="line"><span class="lineno">  263</span><span class="comment">// // //        for (uint jdim=0; jdim&lt;space_dim; jdim++) {</span></div>
<div class="line"><span class="lineno">  264</span><span class="comment">// // //               LapBe_g[idim] += Bext_vec[idim]-&gt;_grad_g[0][jdim]*Phii._grad_g[0][jdim];</span></div>
<div class="line"><span class="lineno">  265</span><span class="comment">// // //        }</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">// // //      }</span></div>
<div class="line"><span class="lineno">  267</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">// // //              Math::extend(&amp;Phii._grad_g[0][0],&amp;Phii._grad_g3D[0][0],space_dim);</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  270</span><span class="comment">// // //     //--------- CURL CURL: Operator, RHS: curl Be . curl phi -------------------</span></div>
<div class="line"><span class="lineno">  271</span><span class="comment">// // //              Math::cross(&amp;Bext_vecQuant._curl_g3D[0],&amp;Phii._grad_g3D[0][0],curlBeXdphii_g3D);</span></div>
<div class="line"><span class="lineno">  272</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  273</span><span class="comment">// // //     //--------- ADVECTION: Operator, RHS: v x Be . curl phi -------------------</span></div>
<div class="line"><span class="lineno">  274</span><span class="comment">// // //              Math::cross(      vXBe_g3D,&amp;Phii._grad_g3D[0][0],  vXBeXdphii_g3D);       // _utils.cross(vXBe_g3D,dphiidx_g3D,vXBeXdphii_g3D);</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">// // // //============end preparation for (i) ============</span></div>
<div class="line"><span class="lineno">  276</span><span class="comment">// // //         </span></div>
<div class="line"><span class="lineno">  277</span><span class="comment">// // //          for (uint idim=0; idim&lt;space_dim/*bhomOld._dim*/; idim++) {</span></div>
<div class="line"><span class="lineno">  278</span><span class="comment">// // //             const uint irowq = i + idim*BhomOldX._ndof;</span></div>
<div class="line"><span class="lineno">  279</span><span class="comment">// // //             </span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">// // //             currelem.Rhs()(irowq) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  281</span><span class="comment">// // //                            - LAP_MHD*IRem*LapBe_g[idim]</span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">// // //                             - (1-LAP_MHD)*IRem*curlBeXdphii_g3D[idim]              //phii of bhomOld /*CurlCurl(RHS,vb,Phij,Phii,idim,idimp1);*/</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">// // //                            + ADV_MHD*           vXBeXdphii_g3D[idim]               //phii of bhomOld</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">// // //                          )</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">// // //                          + (1-currelem.GetBCDofFlag()[irowq])*detb*BhomOld_vec[idim]-&gt;_val_dofs[i]; //Dirichlet bc</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">// // //         for (uint idim=0; idim&lt;space_dim/*bhomOld._dim*/; idim++) { // filling diagonal block for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">// // //           const uint irowq = i + idim*BhomOldX._ndof;</span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">// // //           currelem.Mat()(irowq,irowq) += (1-currelem.GetBCDofFlag()[irowq])*detb;</span></div>
<div class="line"><span class="lineno">  292</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  293</span><span class="comment">// // //                                            // end filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">// // //     </span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">// // //         for (uint j=0; j&lt;BhomOldX._ndof; j++) {  // A element matrix</span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">// // // //============ preparation for (j) (Phij) ============</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">// // //             Phij._val_g[0]        =      currgp._phi_ndsQLVB_g[Phij._FEord][j]; </span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++)</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">// // //        Phij._grad_g[0][idim] = currgp._dphidxyz_ndsQLVB_g[Phij._FEord][j+idim*Phij._ndof];   //real shape  /*dphijdx_g[idim]*/</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">// // // //=== from this point on, the dependency on /*(j)*/, the COLUMN INDEX, of the quantities is given by Phij  </span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">// // // //===  /*(j)*/ is ONLY used for the POSITIONS, later</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">// // //     //--------- LAPLACIAN: Operator, MAT: grad b . grad phi ---------------------</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">// // //           double     Lap_g = Math::dot(&amp;Phij._grad_g[0][0],&amp;Phii._grad_g[0][0],space_dim);   /*(i,j)*/  //part independent of idim</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">// // //     //--------- ADVECTION: Operator, MAT: v x b . curl phi -------------------</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">// // //           double Advphii_g = Math::dot( &amp;Vel_vec_val_g[0],&amp;Phii._grad_g[0][0],space_dim);  /*(i)*/ //part independent of idim //TODO what about putting it OUTSIDE?</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">// // //      </span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim/*bhomOld._dim*/; idim++) { //filled in as 1-2-3 // 5-6-4 // 9-7-8</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">// // //             int irowq=i+idim*BhomOldX._ndof;   //idim gives the row index  //test of bhomOld</span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">// // //             // diagonal blocks [1-5-9]  idim = row index = column index  //shape of bhomOld</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">// // //             currelem.Mat()(irowq,j+idim*BhomOldX._ndof)</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment">// // //                  + LAP_MHD*IRem*(Lap_g) </span></div>
<div class="line"><span class="lineno">  314</span><span class="comment">// // //                  + (1-LAP_MHD)*IRem*(           Lap_g -  Phij._grad_g[0][idim]*Phii._grad_g[0][idim] )</span></div>
<div class="line"><span class="lineno">  315</span><span class="comment">// // //                  - ADV_MHD * Phij._val_g[0]* (Advphii_g -   Vel_vec[idim]-&gt;_val_g[0]    *Phii._grad_g[0][idim] )   //TODO Phij here does not depend on idim, but it depends on j</span></div>
<div class="line"><span class="lineno">  316</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  317</span><span class="comment">// // //             // block +1 [2-6-7]</span></div>
<div class="line"><span class="lineno">  318</span><span class="comment">// // //             int idimp1=(idim+1)%space_dim;</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">// // //        //idim: component of the SHAPE</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">// // //        //idimp1: component of the tEST</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp1*BhomOldX._ndof)</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">// // //                   + (1-LAP_MHD)*IRem*(        - Phij._grad_g[0][idim]*Phii._grad_g[0][idimp1] )       /*(i,j)*/    /*CurlCurl(MAT,vb,Phij,Phii,idim,idimp1);*/</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">// // //                   - ADV_MHD * Phij._val_g[0]* ( -  Vel_vec[idim]-&gt;_val_g[0] * Phii._grad_g[0][idimp1] )       /*(i,j)*/    /*AdvCurl(MAT,Vel,Phij,Phii,idim,idimp1)*/</span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">// // // #if (DIMENSION==3)</span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">// // //             // block +2 [3-4-8] </span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">// // //        int idimp2=(idim+2)%space_dim;//idimp2 column index</span></div>
<div class="line"><span class="lineno">  330</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp2*BhomOldX._ndof)</span></div>
<div class="line"><span class="lineno">  331</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">// // //                   + (1-LAP_MHD)*IRem*(       - Phij._grad_g[0][idim]*Phii._grad_g[0][idimp2] )               /*(i,j)*/</span></div>
<div class="line"><span class="lineno">  333</span><span class="comment">// // //                   - ADV_MHD * Phij._val_g[0]* ( -  Vel_vec[idim]-&gt;_val_g[0]    *Phii._grad_g[0][idimp2] )               /*(i,j)*/</span></div>
<div class="line"><span class="lineno">  334</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">// // // #endif</span></div>
<div class="line"><span class="lineno">  336</span><span class="comment">// // //           }</span></div>
<div class="line"><span class="lineno">  337</span><span class="comment">// // //                     </span></div>
<div class="line"><span class="lineno">  338</span><span class="comment">// // //         } </span></div>
<div class="line"><span class="lineno">  339</span><span class="comment">// // //                                       // end A element matrix</span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">// // //                      </span></div>
<div class="line"><span class="lineno">  341</span><span class="comment">// // //        for (uint j = 0; j &lt; LagMultOld._ndof; j++) {// B^T element matrix ( p*div(v) )</span></div>
<div class="line"><span class="lineno">  342</span><span class="comment">// // //           Psij._val_g[0] = currgp._phi_ndsQLVB_g[Psij._FEord][j];   /*const double psij_g */</span></div>
<div class="line"><span class="lineno">  343</span><span class="comment">// // //           const int jclml= j+/*bhomOld._dim*/space_dim*BhomOldX._ndof;</span></div>
<div class="line"><span class="lineno">  344</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) {  //bhomOld._dim==spacedimension</span></div>
<div class="line"><span class="lineno">  345</span><span class="comment">// // //             uint irowq=i+idim*BhomOldX._ndof;</span></div>
<div class="line"><span class="lineno">  346</span><span class="comment">// // //             currelem.Mat()(irowq,jclml) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*( - Psij._val_g[0]*Phii._grad_g[0][idim] );   /*(i,j)*/ /*PDiv(MAT,Psij,Phii,idim)*/</span></div>
<div class="line"><span class="lineno">  347</span><span class="comment">// // //            }</span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  349</span><span class="comment">// // //                                      // end B^T element matrix</span></div>
<div class="line"><span class="lineno">  350</span><span class="comment">// // //  //============ begin linear rows</span></div>
<div class="line"><span class="lineno">  351</span><span class="comment">// // //           if (i &lt; LagMultOld._ndof) {</span></div>
<div class="line"><span class="lineno">  352</span><span class="comment">// // //            Psii._val_g[0]  = currgp._phi_ndsQLVB_g[Psii._FEord][i];   /*double psii_g*/</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment">// // //      const uint irowl=i+space_dim*BhomOldX._ndof;</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">// // //           currelem.Rhs()(irowl)=0.;</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  356</span><span class="comment">// // //           for (uint j=0; j&lt;BhomOldX._ndof; j++) { // B element matrix q*div(u)</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) Phij._grad_g[0][idim] =  currgp._dphidxyz_ndsQLVB_g[Phij._FEord][j+idim*Phij._ndof];</span></div>
<div class="line"><span class="lineno">  358</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) currelem.Mat()(irowl,j+idim*BhomOldX._ndof) += - dtxJxW_g*Psii._val_g[0]*Phij._grad_g[0][idim];  /*(i,j)*/  /*PDiv(MAT,Psii,Phij,idim)*/</span></div>
<div class="line"><span class="lineno">  359</span><span class="comment">// // //                 }</span></div>
<div class="line"><span class="lineno">  360</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  361</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  362</span><span class="comment">// // // //============ end linear rows</span></div>
<div class="line"><span class="lineno">  363</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  364</span><span class="comment">// // //     //end filling element mat/rhs (i loop)</span></div>
<div class="line"><span class="lineno">  365</span>    }</div>
<div class="line"><span class="lineno">  366</span>    <span class="comment">// end element gaussian integration loop</span></div>
<div class="line"><span class="lineno">  367</span>    </div>
<div class="line"><span class="lineno">  369</span>                      my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;add_matrix(currelem.Mat(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  370</span>                      my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;add_vector(currelem.Rhs(),currelem.GetDofIndices()); </div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>  } </div>
<div class="line"><span class="lineno">  373</span>  <span class="comment">// end of element loop</span></div>
<div class="line"><span class="lineno">  374</span>  </div>
<div class="line"><span class="lineno">  375</span> </div>
<div class="line"><span class="lineno">  376</span>  }<span class="comment">//END VOLUME</span></div>
<div class="line"><span class="lineno">  377</span>  </div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;close();</div>
<div class="line"><span class="lineno">  380</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;close();</div>
<div class="line"><span class="lineno">  381</span>    </div>
<div class="line"><span class="lineno">  382</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno">  383</span> std::cout &lt;&lt; <span class="stringliteral">&quot; GenMatRhs &quot;</span> &lt;&lt; my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">name</a>() &lt;&lt; <span class="stringliteral">&quot;: assembled  Level &quot;</span> &lt;&lt; Level</div>
<div class="line"><span class="lineno">  384</span>           &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;m() &lt;&lt; <span class="stringliteral">&quot; dofs &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  385</span><span class="preprocessor">#endif     </span></div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span> </div>
<div class="line"><span class="lineno">  388</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  389</span>}</div>
<div class="ttc" id="a02__elliptic__with__given__advection_2_opt_loop_8hpp_html_aa1c0281395a97150474c058710b42bb2"><div class="ttname"><a href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a></div><div class="ttdeci">#define DIMENSION</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp_source.html#l00053">OptLoop.hpp:53</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_ac5219afbbd6ed7b35c076e508ac752ff"><div class="ttname"><a href="../../dd/d9a/_f_e_type_enum_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a></div><div class="ttdeci">#define MESH_MAPPING_FE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9a/_f_e_type_enum_8hpp_source.html#l00015">FETypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_aca285339f9cf24489fdc0af5b51a5fde"><div class="ttname"><a href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a></div><div class="ttdeci">#define QL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9a/_f_e_type_enum_8hpp_source.html#l00008">FETypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_typedefs_8hpp_html_a91ad9478d81a7aaf2593e8d9c3d06a14"><div class="ttname"><a href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a></div><div class="ttdeci">unsigned int uint</div><div class="ttdef"><b>Definition</b> <a href="../../d5/dd2/_typedefs_8hpp_source.html#l00005">Typedefs.hpp:5</a></div></div>
<div class="ttc" id="a_v_b_type_enum_8hpp_html_a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e"><div class="ttname"><a href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a></div><div class="ttdeci">@ VV</div><div class="ttdef"><b>Definition</b> <a href="../../df/d9e/_v_b_type_enum_8hpp_source.html#l00004">VBTypeEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_current_elem_html"><div class="ttname"><a href="../../d4/d0f/classfemus_1_1_current_elem.html">femus::CurrentElem</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/dbc/_current_elem_8hpp_source.html#l00038">CurrentElem.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_current_quantity_html"><div class="ttname"><a href="../../de/d6e/classfemus_1_1_current_quantity.html">femus::CurrentQuantity</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d49/_current_quantity_8hpp_source.html#l00018">CurrentQuantity.hpp:18</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_input_parser_html_a317bdaac200e745334dcd436d39d2832"><div class="ttname"><a href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">femus::FemusInputParser::get</a></div><div class="ttdeci">const T get(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d19/_femus_input_parser_8hpp_source.html#l00094">FemusInputParser.hpp:94</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gauss_html_a9aed14f6d02b6aad6b6eb59db1001438"><div class="ttname"><a href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">femus::Gauss::GetGaussWeight</a></div><div class="ttdeci">const double GetGaussWeight(const unsigned ig) const</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d64/_gauss_points_8hpp_source.html#l00132">GaussPoints.hpp:132</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gauss_html_ab1eb96997b69ce4ebec7283eb3bf1c01"><div class="ttname"><a href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">femus::Gauss::GetGaussPointsNumber</a></div><div class="ttdeci">const unsigned GetGaussPointsNumber() const</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d64/_gauss_points_8hpp_source.html#l00136">GaussPoints.hpp:136</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a58ebbec8ab1f2eb863cba438f30404e0"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">femus::LinearImplicitSystem::_LinSolver</a></div><div class="ttdeci">vector&lt; LinearEquationSolver * &gt; _LinSolver</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00077">LinearImplicitSystem.hpp:77</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a65dabdf1e308c1a44ebe5c6a41d09284"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">femus::MultiLevelMesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00541">MultiLevelMesh.cpp:541</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a68f3f358a51963417fbaeb9255d2c2c3"><div class="ttname"><a href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">femus::MultiLevelMeshTwo::_NoLevels</a></div><div class="ttdeci">uint _NoLevels</div><div class="ttdoc">Number of subdomains (subdomain P)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d0c/_multi_level_mesh_two_8hpp_source.html#l00071">MultiLevelMeshTwo.hpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_two_html_a7508c00c363175fd124c4fec42e0637c"><div class="ttname"><a href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">femus::MultiLevelMeshTwo::_off_el</a></div><div class="ttdeci">int ** _off_el</div><div class="ttdoc">[VB][L] Number of Elements</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d0c/_multi_level_mesh_two_8hpp_source.html#l00082">MultiLevelMeshTwo.hpp:82</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a34890e6aa9d88946571fa050ee544c39"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">femus::MultiLevelProblem::GetQuadratureRule</a></div><div class="ttdeci">const Gauss &amp; GetQuadratureRule(const unsigned geom_elem_type) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00282">MultiLevelProblem.hpp:282</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a692d73df5b51e09d9c1eef430376113c"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">femus::MultiLevelProblem::GetInputParser</a></div><div class="ttdeci">const FemusInputParser&lt; double &gt; &amp; GetInputParser() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00409">MultiLevelProblem.hpp:409</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a895a29b587ab7f4dae3927fd46858254"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">femus::MultiLevelProblem::GetQtyMap</a></div><div class="ttdeci">const QuantityMap &amp; GetQtyMap() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00101">MultiLevelProblem.hpp:101</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00116">MultiLevelProblem.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a960b21c0989774f946312b8f5869f721"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">femus::MultiLevelProblem::GetMeshTwo</a></div><div class="ttdeci">const MultiLevelMeshTwo &amp; GetMeshTwo() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00131">MultiLevelProblem.hpp:131</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_aecca332d087e3bf5546d13b2bfe2b7e1"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#aecca332d087e3bf5546d13b2bfe2b7e1">femus::MultiLevelProblem::GetElemType</a></div><div class="ttdeci">const std::vector&lt; const elem_type * &gt; &amp; GetElemType(const unsigned dim) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00381">MultiLevelProblem.hpp:381</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_a6865a3e6d5abf01a8a17994635a1f109"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">femus::QuantityMap::GetQuantity</a></div><div class="ttdeci">Quantity * GetQuantity(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00082">Quantity.hpp:82</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a16af0d7b8849d6ea983a5e425fb90fee"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">femus::System::GetLevelToAssemble</a></div><div class="ttdeci">unsigned GetLevelToAssemble() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/def/_system_8hpp_source.html#l00116">System.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a1a007c176529dae649887bbd1cb46103"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">femus::System::name</a></div><div class="ttdeci">const std::string &amp; name() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/def/_system_8hpp_source.html#l00175">System.hpp:175</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_two_html"><div class="ttname"><a href="../../dd/d68/classfemus_1_1_system_two.html">femus::SystemTwo</a></div><div class="ttdef"><b>Definition</b> <a href="../../de/da5/_system_two_8hpp_source.html#l00049">SystemTwo.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="anamespacefemus_1_1_math_html_a06daa97a94cd109a7d0229d4e23a40d6"><div class="ttname"><a href="../../d0/d3b/namespacefemus_1_1_math.html#a06daa97a94cd109a7d0229d4e23a40d6">femus::Math::cross</a></div><div class="ttdeci">void cross(const double *a, const double *b, double *res)</div><div class="ttdoc">Cross product.</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dba/_math_8hpp_source.html#l00060">Math.hpp:60</a></div></div>
<div class="ttc" id="anamespacefemus_1_1_math_html_a7c61609663b61259ec67232f7eba0d3c"><div class="ttname"><a href="../../d0/d3b/namespacefemus_1_1_math.html#a7c61609663b61259ec67232f7eba0d3c">femus::Math::extend</a></div><div class="ttdeci">void extend(const double *a, double *a3D, const uint spacedim)</div><div class="ttdoc">extend to a 3D vector a vector with dimension</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dba/_math_8hpp_source.html#l00069">Math.hpp:69</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3087d027394e34e7bf59b1bab68a0906" name="a3087d027394e34e7bf59b1bab68a0906"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3087d027394e34e7bf59b1bab68a0906">&#9670;&#160;</a></span>GenMatRhsMHDAD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenMatRhsMHDAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000150">Todo:</a></b></dt><dd>probably this Allocate not needed here </dd></dl>
<p>Add element matrix and rhs to the global ones.</p>

<p class="definition">Definition at line <a class="el" href="../../d6/dd3/_eqn_m_h_d_a_d_8cpp_source.html#l00025">25</a> of file <a class="el" href="../../d6/dd3/_eqn_m_h_d_a_d_8cpp_source.html">EqnMHDAD.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   25</span>                                                 {</div>
<div class="line"><span class="lineno">   26</span> </div>
<div class="line"><span class="lineno">   27</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; my_system = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_MHDAD&quot;</span>);</div>
<div class="line"><span class="lineno">   28</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Level = my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>();</div>
<div class="line"><span class="lineno">   29</span>  </div>
<div class="line"><span class="lineno">   30</span>  <span class="comment">//========= parameters</span></div>
<div class="line"><span class="lineno">   31</span>   <span class="keywordtype">double</span> IRem =  1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Rem&quot;</span>);</div>
<div class="line"><span class="lineno">   32</span>   <span class="keywordtype">double</span> S    = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;S&quot;</span>);</div>
<div class="line"><span class="lineno">   33</span>  </div>
<div class="line"><span class="lineno">   34</span><span class="comment">//======== GEOMETRICAL ELEMENT =======</span></div>
<div class="line"><span class="lineno">   35</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> space_dim =       ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">   36</span> </div>
<div class="line"><span class="lineno">   37</span>  <span class="comment">//=========== Operators </span></div>
<div class="line"><span class="lineno">   38</span>  std::vector&lt;double&gt; VelAdj_vec_val_g(space_dim);</div>
<div class="line"><span class="lineno">   39</span>  std::vector&lt;double&gt; VelAdj_vec_val_g3D(3);</div>
<div class="line"><span class="lineno">   40</span>  <span class="keywordtype">double</span> dphijdx_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   41</span>  <span class="keywordtype">double</span> dphiidx_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   42</span>  <span class="keywordtype">double</span>  curlBXlambda_g3D[3]; </div>
<div class="line"><span class="lineno">   43</span>    </div>
<div class="line"><span class="lineno">   44</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;zero();</div>
<div class="line"><span class="lineno">   45</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;zero();</div>
<div class="line"><span class="lineno">   46</span> </div>
<div class="line"><span class="lineno">   47</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>      *mymsh      =  ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(Level);</div>
<div class="line"><span class="lineno">   49</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>      *myel       =  mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">   50</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> myproc  = mymsh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">   51</span>    </div>
<div class="line"><span class="lineno">   52</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   53</span><span class="comment">// ========================================== </span></div>
<div class="line"><span class="lineno">   54</span>  </div>
<div class="line"><span class="lineno">   55</span>   {<span class="comment">//BEGIN VOLUME    </span></div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mesh_vb = <a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>;</div>
<div class="line"><span class="lineno">   58</span>    </div>
<div class="line"><span class="lineno">   59</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_e = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level+1];</div>
<div class="line"><span class="lineno">   60</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_b = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level];</div>
<div class="line"><span class="lineno">   61</span>    </div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> iel=0; iel &lt; (nel_e - nel_b); iel++) {</div>
<div class="line"><span class="lineno">   63</span>  </div>
<div class="line"><span class="lineno">   64</span>    <a class="code hl_class" href="../../d4/d0f/classfemus_1_1_current_elem.html">CurrentElem&lt;double&gt;</a>       currelem(iel,myproc,Level,<a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>,&amp;my_system,ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>(),ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#aecca332d087e3bf5546d13b2bfe2b7e1">GetElemType</a>(),mymsh);</div>
<div class="line"><span class="lineno">   65</span>    <span class="comment">//   CurrentGaussPointBase &amp; currgp = //   CurrentGaussPointBase::build(currelem,ml_prob.GetQuadratureRule(currelem.GetDim()));</span></div>
<div class="line"><span class="lineno">   66</span>   </div>
<div class="line"><span class="lineno">   67</span><span class="comment">//=========INTERNAL QUANTITIES (unknowns of the equation) ==================</span></div>
<div class="line"><span class="lineno">   68</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjOldX(currelem);</div>
<div class="line"><span class="lineno">   69</span>    BhomAdjOldX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj0&quot;</span>); </div>
<div class="line"><span class="lineno">   70</span>    BhomAdjOldX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   71</span>    BhomAdjOldX.Allocate();</div>
<div class="line"><span class="lineno">   72</span>    </div>
<div class="line"><span class="lineno">   73</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjOldY(currelem);</div>
<div class="line"><span class="lineno">   74</span>    BhomAdjOldY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj1&quot;</span>); </div>
<div class="line"><span class="lineno">   75</span>    BhomAdjOldY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   76</span>    BhomAdjOldY.Allocate();</div>
<div class="line"><span class="lineno">   77</span>    </div>
<div class="line"><span class="lineno">   78</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjOldZ(currelem);</div>
<div class="line"><span class="lineno">   79</span>    BhomAdjOldZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj2&quot;</span>); </div>
<div class="line"><span class="lineno">   80</span>    BhomAdjOldZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   81</span>    BhomAdjOldZ.Allocate();</div>
<div class="line"><span class="lineno">   82</span>    </div>
<div class="line"><span class="lineno">   83</span>    std::vector&lt;CurrentQuantity*&gt; BhomAdjOld_vec;   </div>
<div class="line"><span class="lineno">   84</span>    BhomAdjOld_vec.push_back(&amp;BhomAdjOldX);</div>
<div class="line"><span class="lineno">   85</span>    BhomAdjOld_vec.push_back(&amp;BhomAdjOldY);</div>
<div class="line"><span class="lineno">   86</span>    BhomAdjOld_vec.push_back(&amp;BhomAdjOldZ);</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomLagMultAdjOld(currelem);</div>
<div class="line"><span class="lineno">   89</span>    BhomLagMultAdjOld._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMultAdj&quot;</span>);</div>
<div class="line"><span class="lineno">   90</span>    BhomLagMultAdjOld.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   91</span>    BhomLagMultAdjOld.Allocate();    </div>
<div class="line"><span class="lineno">   92</span><span class="comment">//========= END INTERNAL QUANTITIES (unknowns of the equation) ================= </span></div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span><span class="comment">//=========EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span> <span class="comment">//========= DOMAIN MAPPING</span></div>
<div class="line"><span class="lineno">   97</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> xyz(currelem);</div>
<div class="line"><span class="lineno">   98</span>    xyz._dim      = <a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>;</div>
<div class="line"><span class="lineno">   99</span>    xyz._FEord    = <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a>;</div>
<div class="line"><span class="lineno">  100</span>    xyz._ndof     = currelem.GetElemType(xyz._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">  101</span>    xyz.Allocate();    </div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>  <span class="comment">//==========</span></div>
<div class="line"><span class="lineno">  104</span>      <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelX(currelem);</div>
<div class="line"><span class="lineno">  105</span>    VelX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>); </div>
<div class="line"><span class="lineno">  106</span>    VelX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  107</span>    VelX.Allocate();</div>
<div class="line"><span class="lineno">  108</span>    </div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelY(currelem);</div>
<div class="line"><span class="lineno">  110</span>    VelY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>); </div>
<div class="line"><span class="lineno">  111</span>    VelY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  112</span>    VelY.Allocate();</div>
<div class="line"><span class="lineno">  113</span>    </div>
<div class="line"><span class="lineno">  114</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelZ(currelem);</div>
<div class="line"><span class="lineno">  115</span>    VelZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity2&quot;</span>); </div>
<div class="line"><span class="lineno">  116</span>    VelZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  117</span>    VelZ.Allocate();</div>
<div class="line"><span class="lineno">  118</span>    </div>
<div class="line"><span class="lineno">  119</span>    std::vector&lt;CurrentQuantity*&gt; Vel_vec;   </div>
<div class="line"><span class="lineno">  120</span>    Vel_vec.push_back(&amp;VelX);</div>
<div class="line"><span class="lineno">  121</span>    Vel_vec.push_back(&amp;VelY);</div>
<div class="line"><span class="lineno">  122</span>    Vel_vec.push_back(&amp;VelZ);</div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  <span class="comment">//==========</span></div>
<div class="line"><span class="lineno">  125</span>      <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjX(currelem);</div>
<div class="line"><span class="lineno">  126</span>    VelAdjX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj0&quot;</span>); </div>
<div class="line"><span class="lineno">  127</span>    VelAdjX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  128</span>    VelAdjX.Allocate();</div>
<div class="line"><span class="lineno">  129</span>    </div>
<div class="line"><span class="lineno">  130</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjY(currelem);</div>
<div class="line"><span class="lineno">  131</span>    VelAdjY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj1&quot;</span>); </div>
<div class="line"><span class="lineno">  132</span>    VelAdjY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  133</span>    VelAdjY.Allocate();</div>
<div class="line"><span class="lineno">  134</span>    </div>
<div class="line"><span class="lineno">  135</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjZ(currelem);</div>
<div class="line"><span class="lineno">  136</span>    VelAdjZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj2&quot;</span>); </div>
<div class="line"><span class="lineno">  137</span>    VelAdjZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  138</span>    VelAdjZ.Allocate();</div>
<div class="line"><span class="lineno">  139</span>    </div>
<div class="line"><span class="lineno">  140</span>    std::vector&lt;CurrentQuantity*&gt; VelAdj_vec;</div>
<div class="line"><span class="lineno">  141</span>    VelAdj_vec.push_back(&amp;VelAdjX);</div>
<div class="line"><span class="lineno">  142</span>    VelAdj_vec.push_back(&amp;VelAdjY);</div>
<div class="line"><span class="lineno">  143</span>    VelAdj_vec.push_back(&amp;VelAdjZ);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>    <span class="comment">//==========    </span></div>
<div class="line"><span class="lineno">  146</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomX(currelem);</div>
<div class="line"><span class="lineno">  147</span>    BhomX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom0&quot;</span>); </div>
<div class="line"><span class="lineno">  148</span>    BhomX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  149</span>    BhomX.Allocate();</div>
<div class="line"><span class="lineno">  150</span>    </div>
<div class="line"><span class="lineno">  151</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomY(currelem);</div>
<div class="line"><span class="lineno">  152</span>    BhomY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom1&quot;</span>); </div>
<div class="line"><span class="lineno">  153</span>    BhomY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  154</span>    BhomY.Allocate();</div>
<div class="line"><span class="lineno">  155</span>    </div>
<div class="line"><span class="lineno">  156</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomZ(currelem);</div>
<div class="line"><span class="lineno">  157</span>    BhomZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom2&quot;</span>); </div>
<div class="line"><span class="lineno">  158</span>    BhomZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  159</span>    BhomZ.Allocate();</div>
<div class="line"><span class="lineno">  160</span>    </div>
<div class="line"><span class="lineno">  161</span>    std::vector&lt;CurrentQuantity*&gt; Bhom_vec;   </div>
<div class="line"><span class="lineno">  162</span>    Bhom_vec.push_back(&amp;BhomX);</div>
<div class="line"><span class="lineno">  163</span>    Bhom_vec.push_back(&amp;BhomY);</div>
<div class="line"><span class="lineno">  164</span>    Bhom_vec.push_back(&amp;BhomZ);</div>
<div class="line"><span class="lineno">  165</span> </div>
<div class="line"><span class="lineno">  166</span><span class="comment">//=========</span></div>
<div class="line"><span class="lineno">  167</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextX(currelem);</div>
<div class="line"><span class="lineno">  168</span>    BextX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt0&quot;</span>); </div>
<div class="line"><span class="lineno">  169</span>    BextX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  170</span>    BextX.Allocate();</div>
<div class="line"><span class="lineno">  171</span>    </div>
<div class="line"><span class="lineno">  172</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextY(currelem);</div>
<div class="line"><span class="lineno">  173</span>    BextY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt1&quot;</span>); </div>
<div class="line"><span class="lineno">  174</span>    BextY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  175</span>    BextY.Allocate();</div>
<div class="line"><span class="lineno">  176</span>    </div>
<div class="line"><span class="lineno">  177</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextZ(currelem);</div>
<div class="line"><span class="lineno">  178</span>    BextZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt2&quot;</span>); </div>
<div class="line"><span class="lineno">  179</span>    BextZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  180</span>    BextZ.Allocate();</div>
<div class="line"><span class="lineno">  181</span>    </div>
<div class="line"><span class="lineno">  182</span>    std::vector&lt;CurrentQuantity*&gt; Bext_vec;   </div>
<div class="line"><span class="lineno">  183</span>    Bext_vec.push_back(&amp;BextX);</div>
<div class="line"><span class="lineno">  184</span>    Bext_vec.push_back(&amp;BextY);</div>
<div class="line"><span class="lineno">  185</span>    Bext_vec.push_back(&amp;BextZ);</div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span><span class="comment">//========= auxiliary, must be AFTER Bhom!</span></div>
<div class="line"><span class="lineno">  188</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Bmag(currelem); <span class="comment">//total</span></div>
<div class="line"><span class="lineno">  189</span>    Bmag._dim        = Bhom_vec.size();</div>
<div class="line"><span class="lineno">  190</span>    Bmag._FEord      = BhomX._FEord;</div>
<div class="line"><span class="lineno">  191</span>    Bmag._ndof       = BhomX._ndof;</div>
<div class="line"><span class="lineno">  192</span>    Bmag.Allocate();    </div>
<div class="line"><span class="lineno">  193</span>    </div>
<div class="line"><span class="lineno">  194</span><span class="comment">//========= END EXTERNAL QUANTITIES =================</span></div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  197</span><span class="comment">//=====================    </span></div>
<div class="line"><span class="lineno">  198</span> </div>
<div class="line"><span class="lineno">  199</span>    currelem.Mat().zero();</div>
<div class="line"><span class="lineno">  200</span>    currelem.Rhs().zero(); </div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>    currelem.SetDofobjConnCoords();</div>
<div class="line"><span class="lineno">  203</span>    </div>
<div class="line"><span class="lineno">  204</span>    currelem.ConvertElemCoordsToMappingOrd(xyz);    </div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>    currelem.SetElDofsBc();</div>
<div class="line"><span class="lineno">  207</span>    </div>
<div class="line"><span class="lineno">  208</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim &lt; space_dim; idim++)    {</div>
<div class="line"><span class="lineno">  209</span>           BhomAdjOld_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  210</span>                  Vel_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  211</span>               VelAdj_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  212</span>                 Bhom_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  213</span>                 Bext_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  214</span>    }</div>
<div class="line"><span class="lineno">  215</span>    </div>
<div class="line"><span class="lineno">  216</span> </div>
<div class="line"><span class="lineno">  217</span><span class="comment">//======SUM Bhom and Bext  //from now on, you&#39;ll only use Bmag //Bmag,Bext and Bhom must have the same orders!</span></div>
<div class="line"><span class="lineno">  218</span>    <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a1ac507af12e3ceaf078b640984b82059">Math::zeroN</a>(&amp;Bmag._val_dofs[0],Bmag._dim*Bmag._ndof);</div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ivarq=0; ivarq &lt; Bmag._dim; ivarq++)    { <span class="comment">//ivarq is like idim</span></div>
<div class="line"><span class="lineno">  221</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> d=0; d &lt; Bmag._ndof; d++)    {</div>
<div class="line"><span class="lineno">  222</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>     indxq  =         d + ivarq*Bmag._ndof;</div>
<div class="line"><span class="lineno">  223</span>          Bmag._val_dofs[indxq] = Bext_vec[ivarq]-&gt;_val_dofs[d] + Bhom_vec[ivarq]-&gt;_val_dofs[d];</div>
<div class="line"><span class="lineno">  224</span>      }</div>
<div class="line"><span class="lineno">  225</span>    }    </div>
<div class="line"><span class="lineno">  226</span><span class="comment">//=======</span></div>
<div class="line"><span class="lineno">  227</span> </div>
<div class="line"><span class="lineno">  228</span> </div>
<div class="line"><span class="lineno">  229</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> el_ngauss = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno">  230</span>    </div>
<div class="line"><span class="lineno">  231</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qp = 0; qp &lt; el_ngauss; qp++) {</div>
<div class="line"><span class="lineno">  232</span><span class="comment">//=======here starts the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  233</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     {          </div>
<div class="line"><span class="lineno">  234</span><span class="comment">//   currgp.SetPhiElDofsFEVB_g (fe,qp); </span></div>
<div class="line"><span class="lineno">  235</span><span class="comment">//   currgp.SetDPhiDxezetaElDofsFEVB_g (fe,qp);  </span></div>
<div class="line"><span class="lineno">  236</span>}  </div>
<div class="line"><span class="lineno">  237</span>      </div>
<div class="line"><span class="lineno">  238</span><span class="keyword">const</span> <span class="keywordtype">double</span>      det = 1.; <span class="comment">//currgp.JacVectVV_g(xyz);</span></div>
<div class="line"><span class="lineno">  239</span><span class="keyword">const</span> <span class="keywordtype">double</span> dtxJxW_g = det * ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">GetGaussWeight</a>(qp);</div>
<div class="line"><span class="lineno">  240</span><span class="keyword">const</span> <span class="keywordtype">double</span>     detb = det/el_ngauss;</div>
<div class="line"><span class="lineno">  241</span>      </div>
<div class="line"><span class="lineno">  242</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     { </div>
<div class="line"><span class="lineno">  243</span><span class="comment">//   currgp.SetDPhiDxyzElDofsFEVB_g   (fe,qp);</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">//   currgp.ExtendDphiDxyzElDofsFEVB_g(fe);</span></div>
<div class="line"><span class="lineno">  245</span>}</div>
<div class="line"><span class="lineno">  246</span><span class="comment">//=======end of the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>      Bmag.curl_g();</div>
<div class="line"><span class="lineno">  250</span>      Bmag.val_g();</div>
<div class="line"><span class="lineno">  251</span>      </div>
<div class="line"><span class="lineno">  252</span>      <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim&lt;space_dim; idim++)  {</div>
<div class="line"><span class="lineno">  253</span>          BhomAdjOld_vec[idim]-&gt;val_g(); </div>
<div class="line"><span class="lineno">  254</span>                 Vel_vec[idim]-&gt;val_g(); </div>
<div class="line"><span class="lineno">  255</span>              VelAdj_vec[idim]-&gt;val_g(); </div>
<div class="line"><span class="lineno">  256</span>    VelAdj_vec_val_g[idim] = VelAdj_vec[idim]-&gt;_val_g[0];</div>
<div class="line"><span class="lineno">  257</span>      }</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span> <span class="comment">//vector product</span></div>
<div class="line"><span class="lineno">  260</span>          <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a7c61609663b61259ec67232f7eba0d3c">Math::extend</a>(&amp;VelAdj_vec_val_g[0],&amp;VelAdj_vec_val_g3D[0],space_dim);</div>
<div class="line"><span class="lineno">  261</span>          <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a06daa97a94cd109a7d0229d4e23a40d6">Math::cross</a>(&amp;Bmag._curl_g3D[0],&amp;VelAdj_vec_val_g3D[0],curlBXlambda_g3D);</div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  264</span><span class="comment">//========= FILLING ELEMENT MAT/RHS (i loop) ====================</span></div>
<div class="line"><span class="lineno">  265</span><span class="comment">//============================================================== </span></div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span><span class="comment">// // //        for (uint i=0; i &lt; BhomAdjOldX._ndof; i++)     {</span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">// // // //=======&quot;COMMON tEST PART for QTYZERO&quot;: func and derivative, of the QTYZERO FE ORD ==========</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">// // //         const double phii_g = currgp._phi_ndsQLVB_g[BhomAdjOldX._FEord][i];</span></div>
<div class="line"><span class="lineno">  270</span><span class="comment">// // //         for (uint idim=0; idim&lt;space_dim; idim++)  dphiidx_g[idim] = currgp._dphidxyz_ndsQLVB_g[BhomAdjOldX._FEord][i+idim*BhomAdjOldX._ndof];</span></div>
<div class="line"><span class="lineno">  271</span><span class="comment">// // // //======= END &quot;COMMON tEST PART for QTYZERO&quot; ==========</span></div>
<div class="line"><span class="lineno">  272</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  273</span><span class="comment">// // //          double BDdphii_g      = Math::dot(  &amp;Bmag._val_g[0],dphiidx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  274</span><span class="comment">// // //      double lambdaDdphii_g = Math::dot(&amp;VelAdj_vec_val_g[0],dphiidx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">// // //      </span></div>
<div class="line"><span class="lineno">  276</span><span class="comment">// // //          for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  277</span><span class="comment">// // //             const uint irowq = i+idim*BhomAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  278</span><span class="comment">// // //            currelem.Rhs()(irowq) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  279</span><span class="comment">// // //                             - S*curlBXlambda_g3D[idim]*phii_g                             //from NS</span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">// // //                             + S*(BDdphii_g*VelAdj_vec_val_g[idim] - lambdaDdphii_g*Bmag._val_g[idim])     //from NS</span></div>
<div class="line"><span class="lineno">  281</span><span class="comment">// // //                         )</span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">// // //                            + (1-currelem.GetBCDofFlag()[irowq])*detb*BhomAdjOld_vec[idim]-&gt;_val_dofs[i]; //Dirichlet bc</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">// // //         for (uint idim=0; idim&lt;space_dim; idim++) { // filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">// // //           const uint irowq = i+idim*BhomAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">// // //           currelem.Mat()(irowq,irowq) += (1-currelem.GetBCDofFlag()[irowq])*detb;</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">// // //         }        // end filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">// // //     </span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">// // //         for (uint j=0; j&lt;BhomAdjOldX._ndof; j++) {// A element matrix</span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">// // // //=======&quot;COMMON SHAPE PART for QTYZERO&quot;: ==========</span></div>
<div class="line"><span class="lineno">  292</span><span class="comment">// // //            double                                  phij_g       =      currgp._phi_ndsQLVB_g[BhomAdjOldX._FEord][j];</span></div>
<div class="line"><span class="lineno">  293</span><span class="comment">// // //            for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[BhomAdjOldX._FEord][j+idim*BhomAdjOldX._ndof];</span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">// // // //======= END &quot;COMMON SHAPE PART for QTYZERO&quot; ==========</span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">// // //            double Lap_g    = Math::dot(dphijdx_g,dphiidx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">// // //      double Advphij_g = 0.;</span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">// // //      for (uint idim=0; idim&lt;space_dim; idim++) Advphij_g += Vel_vec[idim]-&gt;_val_g[0]*dphijdx_g[idim];</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">// // //           </span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) { //filled in as 1-2-3 // 4-5-6 // 7-8-9</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">// // //             int irowq = i+idim*BhomAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">// // //             // diagonal blocks [1-5-9]</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">// // //             currelem.Mat()(irowq,j+idim*BhomAdjOldX._ndof)</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">// // //                  + LAP_MHD*IRem*(Lap_g)</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">// // //                  + (1-LAP_MHD)*IRem*(   Lap_g - dphijdx_g[idim]* dphiidx_g[idim] )</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">// // //                  - phii_g*(         Advphij_g - dphijdx_g[idim]*Vel_vec[idim]-&gt;_val_g[0] )</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">// // //             // block +1 [2-6-7]</span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">// // //             int idimp1=(idim+1)%space_dim;</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp1*BhomAdjOldX._ndof)</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment">// // //                  + (1-LAP_MHD)*IRem*(  -dphijdx_g[idim]* dphiidx_g[idimp1] )</span></div>
<div class="line"><span class="lineno">  314</span><span class="comment">// // //                  - phii_g*(            -dphijdx_g[idim]*Vel_vec[idimp1]-&gt;_val_g[0] )</span></div>
<div class="line"><span class="lineno">  315</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  316</span><span class="comment">// // // #if (DIMENSION==3)</span></div>
<div class="line"><span class="lineno">  317</span><span class="comment">// // //             // block +2 [3-4-8]</span></div>
<div class="line"><span class="lineno">  318</span><span class="comment">// // //             int idimp2=(idim+2)%space_dim;</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp2*BhomAdjOldX._ndof)</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">// // //                   + (1-LAP_MHD)*IRem*(-dphijdx_g[idim]* dphiidx_g[idimp2] )</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">// // //                   - phii_g*(          -dphijdx_g[idim]*Vel_vec[idimp2]-&gt;_val_g[0] )</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">// // //                  );</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">// // // #endif</span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">// // //           }</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">// // //  </span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">// // //         } </span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">// // //                                       // end A element matrix</span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">// // //       </span></div>
<div class="line"><span class="lineno">  330</span><span class="comment">// // //        for (uint j=0; j &lt; BhomLagMultAdjOld._ndof; j++) {// B^T element matrix ( p*div(v) )</span></div>
<div class="line"><span class="lineno">  331</span><span class="comment">// // //           const double psij_g =  currgp._phi_ndsQLVB_g[BhomLagMultAdjOld._FEord][j];</span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">// // //           const int jclml= j + space_dim*BhomAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  333</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  334</span><span class="comment">// // //             uint irowq = i+idim*BhomAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">// // //             currelem.Mat()(irowq,jclml) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(-psij_g*dphiidx_g[idim]);</span></div>
<div class="line"><span class="lineno">  336</span><span class="comment">// // //            }</span></div>
<div class="line"><span class="lineno">  337</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  338</span><span class="comment">// // //                                      // end B^T element matrix</span></div>
<div class="line"><span class="lineno">  339</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">// // //           if (i&lt;BhomLagMultAdjOld._ndof) {//  pressure equation (KOMP dp/dt=rho*div) </span></div>
<div class="line"><span class="lineno">  341</span><span class="comment">// // //           double psii_g = currgp._phi_ndsQLVB_g[BhomLagMultAdjOld._FEord][i];</span></div>
<div class="line"><span class="lineno">  342</span><span class="comment">// // //      const uint irowl = i+space_dim*BhomAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  343</span><span class="comment">// // //           currelem.Rhs()(irowl)=0.;  // rhs</span></div>
<div class="line"><span class="lineno">  344</span><span class="comment">// // //  //             currelem.Mat()(irowl,j+space_dim*el_ndof_q)  += dtxJxW_g*(psii_g*psij_g)*_Komp_fac/dt;</span></div>
<div class="line"><span class="lineno">  345</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  346</span><span class="comment">// // //           for (uint j=0; j&lt;BhomAdjOldX._ndof; j++) { // B element matrix q*div(u)</span></div>
<div class="line"><span class="lineno">  347</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[BhomAdjOldX._FEord][j+idim*BhomAdjOldX._ndof];</span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) currelem.Mat()(irowl,j+idim*BhomAdjOldX._ndof) += -dtxJxW_g*psii_g*dphijdx_g[idim]; </span></div>
<div class="line"><span class="lineno">  349</span><span class="comment">// // //                 }</span></div>
<div class="line"><span class="lineno">  350</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  351</span><span class="comment">// // //                          // end pressure eq (cont)</span></div>
<div class="line"><span class="lineno">  352</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">//========= END FILLING ELEMENT MAT/RHS (i loop) =====================</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  356</span> </div>
<div class="line"><span class="lineno">  357</span>    }</div>
<div class="line"><span class="lineno">  358</span>    <span class="comment">// end element gaussian integration loop</span></div>
<div class="line"><span class="lineno">  359</span>    </div>
<div class="line"><span class="lineno">  361</span>    my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;add_matrix(currelem.Mat(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  362</span>    my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;add_vector(currelem.Rhs(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  363</span>    </div>
<div class="line"><span class="lineno">  364</span>  } </div>
<div class="line"><span class="lineno">  365</span>  <span class="comment">// end of element loop</span></div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>  }<span class="comment">//END VOLUME</span></div>
<div class="line"><span class="lineno">  368</span>  </div>
<div class="line"><span class="lineno">  369</span>    <span class="comment">// *****************************************************************</span></div>
<div class="line"><span class="lineno">  370</span>    <span class="comment">// *****************************************************************</span></div>
<div class="line"><span class="lineno">  371</span>    <span class="comment">// *****************************************************************</span></div>
<div class="line"><span class="lineno">  372</span> </div>
<div class="line"><span class="lineno">  373</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;close();</div>
<div class="line"><span class="lineno">  374</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;close();</div>
<div class="line"><span class="lineno">  375</span>  </div>
<div class="line"><span class="lineno">  376</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno">  377</span> std::cout &lt;&lt; <span class="stringliteral">&quot; GenMatRhs &quot;</span> &lt;&lt; my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">name</a>() &lt;&lt; <span class="stringliteral">&quot;: assembled  Level &quot;</span> &lt;&lt; Level</div>
<div class="line"><span class="lineno">  378</span>           &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;m() &lt;&lt; <span class="stringliteral">&quot; dofs &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  379</span><span class="preprocessor">#endif     </span></div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  382</span>}</div>
<div class="ttc" id="anamespacefemus_1_1_math_html_a1ac507af12e3ceaf078b640984b82059"><div class="ttname"><a href="../../d0/d3b/namespacefemus_1_1_math.html#a1ac507af12e3ceaf078b640984b82059">femus::Math::zeroN</a></div><div class="ttdeci">void zeroN(double *x, const uint N)</div><div class="ttdoc">set to zero - n components</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dba/_math_8hpp_source.html#l00032">Math.hpp:32</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a38ac6282d8c343af5bf7a5db488f7a5b" name="a38ac6282d8c343af5bf7a5db488f7a5b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38ac6282d8c343af5bf7a5db488f7a5b">&#9670;&#160;</a></span>GenMatRhsMHDCONT()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenMatRhsMHDCONT </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>Add element matrix and rhs to the global ones.</p>

<p class="definition">Definition at line <a class="el" href="../../d1/d4b/_eqn_m_h_d_c_o_n_t_8cpp_source.html#l00028">28</a> of file <a class="el" href="../../d1/d4b/_eqn_m_h_d_c_o_n_t_8cpp_source.html">EqnMHDCONT.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   28</span>                                                   {</div>
<div class="line"><span class="lineno">   29</span> </div>
<div class="line"><span class="lineno">   30</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; my_system = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_MHDCONT&quot;</span>);</div>
<div class="line"><span class="lineno">   31</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Level = my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>();</div>
<div class="line"><span class="lineno">   32</span>  </div>
<div class="line"><span class="lineno">   33</span><span class="comment">//======== GEOMETRICAL ELEMENT =======</span></div>
<div class="line"><span class="lineno">   34</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> space_dim =       ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span>  <span class="comment">//====== Physics</span></div>
<div class="line"><span class="lineno">   37</span>  <span class="keywordtype">double</span>       IRem = 1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Rem&quot;</span>);</div>
<div class="line"><span class="lineno">   38</span>  <span class="keywordtype">double</span>          S = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;S&quot;</span>);</div>
<div class="line"><span class="lineno">   39</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> betaL2   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;betaL2&quot;</span>);</div>
<div class="line"><span class="lineno">   40</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> gammaLap = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;gammaLap&quot;</span>);</div>
<div class="line"><span class="lineno">   41</span><span class="comment">//===========================</span></div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>  <span class="comment">//==== Operators @ gauss ========</span></div>
<div class="line"><span class="lineno">   44</span>  std::vector&lt;double&gt; Vel_vec_val_g(space_dim);</div>
<div class="line"><span class="lineno">   45</span>  std::vector&lt;double&gt; Vel_vec_val_g3D(3);</div>
<div class="line"><span class="lineno">   46</span>  std::vector&lt;double&gt; VelAdj_vec_val_g(space_dim);</div>
<div class="line"><span class="lineno">   47</span>  std::vector&lt;double&gt; VelAdj_vec_val_g3D(3);</div>
<div class="line"><span class="lineno">   48</span>  <span class="keywordtype">double</span> dphijdx_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   49</span>  <span class="keywordtype">double</span> dphiidx_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordtype">double</span>      dphiidx_g3D[3];</div>
<div class="line"><span class="lineno">   51</span>  <span class="keywordtype">double</span> curlxiXdphii_g3D[3];</div>
<div class="line"><span class="lineno">   52</span>  <span class="keywordtype">double</span>   curlxiXvel_g3D[3];</div>
<div class="line"><span class="lineno">   53</span>  <span class="keywordtype">double</span> curlbXlambda_g3D[3];</div>
<div class="line"><span class="lineno">   54</span>  <span class="keywordtype">double</span>        Lapxi_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   55</span><span class="comment">//===========================</span></div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>  my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;zero();</div>
<div class="line"><span class="lineno">   58</span>  my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;zero();</div>
<div class="line"><span class="lineno">   59</span> </div>
<div class="line"><span class="lineno">   60</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   61</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>      *mymsh      =  ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(Level);</div>
<div class="line"><span class="lineno">   62</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>      *myel       =  mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">   63</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> myproc  = mymsh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">   64</span>    </div>
<div class="line"><span class="lineno">   65</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   66</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   67</span>  </div>
<div class="line"><span class="lineno">   68</span>  {<span class="comment">//BEGIN VOLUME</span></div>
<div class="line"><span class="lineno">   69</span> </div>
<div class="line"><span class="lineno">   70</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mesh_vb = <a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>;</div>
<div class="line"><span class="lineno">   71</span>  </div>
<div class="line"><span class="lineno">   72</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_e = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level+1];</div>
<div class="line"><span class="lineno">   73</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_b = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level];</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> iel=0; iel &lt; (nel_e - nel_b); iel++) {</div>
<div class="line"><span class="lineno">   76</span>  </div>
<div class="line"><span class="lineno">   77</span>    <a class="code hl_class" href="../../d4/d0f/classfemus_1_1_current_elem.html">CurrentElem&lt;double&gt;</a>       currelem(iel,myproc,Level,<a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>,&amp;my_system,ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>(),ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#aecca332d087e3bf5546d13b2bfe2b7e1">GetElemType</a>(),mymsh);</div>
<div class="line"><span class="lineno">   78</span>    <span class="comment">//   CurrentGaussPointBase &amp; currgp = //   CurrentGaussPointBase::build(currelem,ml_prob.GetQuadratureRule(currelem.GetDim()));</span></div>
<div class="line"><span class="lineno">   79</span>    </div>
<div class="line"><span class="lineno">   80</span><span class="comment">//=========INTERNAL QUANTITIES (unknowns of the equation) ==================</span></div>
<div class="line"><span class="lineno">   81</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextOldX(currelem);</div>
<div class="line"><span class="lineno">   82</span>    BextOldX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt0&quot;</span>); </div>
<div class="line"><span class="lineno">   83</span>    BextOldX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   84</span>    BextOldX.Allocate();</div>
<div class="line"><span class="lineno">   85</span>    </div>
<div class="line"><span class="lineno">   86</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextOldY(currelem);</div>
<div class="line"><span class="lineno">   87</span>    BextOldY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt1&quot;</span>); </div>
<div class="line"><span class="lineno">   88</span>    BextOldY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   89</span>    BextOldY.Allocate();</div>
<div class="line"><span class="lineno">   90</span>    </div>
<div class="line"><span class="lineno">   91</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextOldZ(currelem);</div>
<div class="line"><span class="lineno">   92</span>    BextOldZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt2&quot;</span>); </div>
<div class="line"><span class="lineno">   93</span>    BextOldZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   94</span>    BextOldZ.Allocate();</div>
<div class="line"><span class="lineno">   95</span>    </div>
<div class="line"><span class="lineno">   96</span>    std::vector&lt;CurrentQuantity*&gt; BextOld_vec;   </div>
<div class="line"><span class="lineno">   97</span>    BextOld_vec.push_back(&amp;BextOldX);</div>
<div class="line"><span class="lineno">   98</span>    BextOld_vec.push_back(&amp;BextOldY);</div>
<div class="line"><span class="lineno">   99</span>    BextOld_vec.push_back(&amp;BextOldZ);</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> LagMultOld(currelem);</div>
<div class="line"><span class="lineno">  102</span>    LagMultOld._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExtLagMult&quot;</span>);</div>
<div class="line"><span class="lineno">  103</span>    LagMultOld.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  104</span>    LagMultOld.Allocate();</div>
<div class="line"><span class="lineno">  105</span><span class="comment">//========= END INTERNAL QUANTITIES (unknowns of the equation) =================</span></div>
<div class="line"><span class="lineno">  106</span> </div>
<div class="line"><span class="lineno">  107</span><span class="comment">//=========EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">  108</span>  <span class="comment">//========= //DOMAIN MAPPING</span></div>
<div class="line"><span class="lineno">  109</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> xyz(currelem);</div>
<div class="line"><span class="lineno">  110</span>    xyz._dim      = <a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>;</div>
<div class="line"><span class="lineno">  111</span>    xyz._FEord    = <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a>;</div>
<div class="line"><span class="lineno">  112</span>    xyz._ndof     = currelem.GetElemType(xyz._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">  113</span>    xyz.Allocate();</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>  </div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelX(currelem);</div>
<div class="line"><span class="lineno">  118</span>    VelX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>); </div>
<div class="line"><span class="lineno">  119</span>    VelX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  120</span>    VelX.Allocate();</div>
<div class="line"><span class="lineno">  121</span>    </div>
<div class="line"><span class="lineno">  122</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelY(currelem);</div>
<div class="line"><span class="lineno">  123</span>    VelY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>); </div>
<div class="line"><span class="lineno">  124</span>    VelY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  125</span>    VelY.Allocate();</div>
<div class="line"><span class="lineno">  126</span>    </div>
<div class="line"><span class="lineno">  127</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelZ(currelem);</div>
<div class="line"><span class="lineno">  128</span>    VelZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity2&quot;</span>); </div>
<div class="line"><span class="lineno">  129</span>    VelZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  130</span>    VelZ.Allocate();</div>
<div class="line"><span class="lineno">  131</span>    </div>
<div class="line"><span class="lineno">  132</span>    std::vector&lt;CurrentQuantity*&gt; Vel_vec;   </div>
<div class="line"><span class="lineno">  133</span>    Vel_vec.push_back(&amp;VelX);</div>
<div class="line"><span class="lineno">  134</span>    Vel_vec.push_back(&amp;VelY);</div>
<div class="line"><span class="lineno">  135</span>    Vel_vec.push_back(&amp;VelZ);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <span class="comment">//==========</span></div>
<div class="line"><span class="lineno">  138</span>      <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjX(currelem);</div>
<div class="line"><span class="lineno">  139</span>    VelAdjX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj0&quot;</span>); </div>
<div class="line"><span class="lineno">  140</span>    VelAdjX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  141</span>    VelAdjX.Allocate();</div>
<div class="line"><span class="lineno">  142</span>    </div>
<div class="line"><span class="lineno">  143</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjY(currelem);</div>
<div class="line"><span class="lineno">  144</span>    VelAdjY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj1&quot;</span>); </div>
<div class="line"><span class="lineno">  145</span>    VelAdjY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  146</span>    VelAdjY.Allocate();</div>
<div class="line"><span class="lineno">  147</span>    </div>
<div class="line"><span class="lineno">  148</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjZ(currelem);</div>
<div class="line"><span class="lineno">  149</span>    VelAdjZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj2&quot;</span>); </div>
<div class="line"><span class="lineno">  150</span>    VelAdjZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  151</span>    VelAdjZ.Allocate();</div>
<div class="line"><span class="lineno">  152</span>    </div>
<div class="line"><span class="lineno">  153</span>    std::vector&lt;CurrentQuantity*&gt; VelAdj_vec;</div>
<div class="line"><span class="lineno">  154</span>    VelAdj_vec.push_back(&amp;VelAdjX);</div>
<div class="line"><span class="lineno">  155</span>    VelAdj_vec.push_back(&amp;VelAdjY);</div>
<div class="line"><span class="lineno">  156</span>    VelAdj_vec.push_back(&amp;VelAdjZ);</div>
<div class="line"><span class="lineno">  157</span>    </div>
<div class="line"><span class="lineno">  158</span>    </div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomX(currelem);</div>
<div class="line"><span class="lineno">  161</span>    BhomX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom0&quot;</span>); </div>
<div class="line"><span class="lineno">  162</span>    BhomX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  163</span>    BhomX.Allocate();</div>
<div class="line"><span class="lineno">  164</span>    </div>
<div class="line"><span class="lineno">  165</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomY(currelem);</div>
<div class="line"><span class="lineno">  166</span>    BhomY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom1&quot;</span>); </div>
<div class="line"><span class="lineno">  167</span>    BhomY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  168</span>    BhomY.Allocate();</div>
<div class="line"><span class="lineno">  169</span>    </div>
<div class="line"><span class="lineno">  170</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomZ(currelem);</div>
<div class="line"><span class="lineno">  171</span>    BhomZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom2&quot;</span>); </div>
<div class="line"><span class="lineno">  172</span>    BhomZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  173</span>    BhomZ.Allocate();</div>
<div class="line"><span class="lineno">  174</span>    </div>
<div class="line"><span class="lineno">  175</span>    std::vector&lt;CurrentQuantity*&gt; Bhom_vec;   </div>
<div class="line"><span class="lineno">  176</span>    Bhom_vec.push_back(&amp;BhomX);</div>
<div class="line"><span class="lineno">  177</span>    Bhom_vec.push_back(&amp;BhomY);</div>
<div class="line"><span class="lineno">  178</span>    Bhom_vec.push_back(&amp;BhomZ);</div>
<div class="line"><span class="lineno">  179</span> </div>
<div class="line"><span class="lineno">  180</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Bhom_vecQuant(currelem);   <span class="comment">//without quantity, nor equation</span></div>
<div class="line"><span class="lineno">  181</span>    Bhom_vecQuant._dim     = Bhom_vec.size();</div>
<div class="line"><span class="lineno">  182</span>    Bhom_vecQuant._FEord   = Bhom_vec[0]-&gt;_FEord;</div>
<div class="line"><span class="lineno">  183</span>    Bhom_vecQuant._ndof    = Bhom_vec[0]-&gt;_ndof;</div>
<div class="line"><span class="lineno">  184</span>    Bhom_vecQuant.Allocate();</div>
<div class="line"><span class="lineno">  185</span>   </div>
<div class="line"><span class="lineno">  186</span><span class="comment">//===============</span></div>
<div class="line"><span class="lineno">  187</span><span class="comment">//===============</span></div>
<div class="line"><span class="lineno">  188</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjX(currelem);</div>
<div class="line"><span class="lineno">  189</span>    BhomAdjX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj0&quot;</span>); </div>
<div class="line"><span class="lineno">  190</span>    BhomAdjX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  191</span>    BhomAdjX.Allocate();</div>
<div class="line"><span class="lineno">  192</span>    </div>
<div class="line"><span class="lineno">  193</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjY(currelem);</div>
<div class="line"><span class="lineno">  194</span>    BhomAdjY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj1&quot;</span>); </div>
<div class="line"><span class="lineno">  195</span>    BhomAdjY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  196</span>    BhomAdjY.Allocate();</div>
<div class="line"><span class="lineno">  197</span>    </div>
<div class="line"><span class="lineno">  198</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjZ(currelem);</div>
<div class="line"><span class="lineno">  199</span>    BhomAdjZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj2&quot;</span>); </div>
<div class="line"><span class="lineno">  200</span>    BhomAdjZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  201</span>    BhomAdjZ.Allocate();</div>
<div class="line"><span class="lineno">  202</span>    </div>
<div class="line"><span class="lineno">  203</span>    std::vector&lt;CurrentQuantity*&gt; BhomAdj_vec;</div>
<div class="line"><span class="lineno">  204</span>    BhomAdj_vec.push_back(&amp;BhomAdjX);</div>
<div class="line"><span class="lineno">  205</span>    BhomAdj_vec.push_back(&amp;BhomAdjY);</div>
<div class="line"><span class="lineno">  206</span>    BhomAdj_vec.push_back(&amp;BhomAdjZ);</div>
<div class="line"><span class="lineno">  207</span>    </div>
<div class="line"><span class="lineno">  208</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdj_vecQuant(currelem);   <span class="comment">//without quantity, nor equation</span></div>
<div class="line"><span class="lineno">  209</span>    BhomAdj_vecQuant._dim     = BhomAdj_vec.size();</div>
<div class="line"><span class="lineno">  210</span>    BhomAdj_vecQuant._FEord   = BhomAdj_vec[0]-&gt;_FEord;</div>
<div class="line"><span class="lineno">  211</span>    BhomAdj_vecQuant._ndof    = BhomAdj_vec[0]-&gt;_ndof;</div>
<div class="line"><span class="lineno">  212</span>    BhomAdj_vecQuant.Allocate();</div>
<div class="line"><span class="lineno">  213</span>  <span class="comment">//=========END EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>    currelem.Mat().zero();</div>
<div class="line"><span class="lineno">  217</span>    currelem.Rhs().zero(); </div>
<div class="line"><span class="lineno">  218</span>     </div>
<div class="line"><span class="lineno">  219</span>    currelem.SetDofobjConnCoords();</div>
<div class="line"><span class="lineno">  220</span>    </div>
<div class="line"><span class="lineno">  221</span>    currelem.ConvertElemCoordsToMappingOrd(xyz);</div>
<div class="line"><span class="lineno">  222</span> </div>
<div class="line"><span class="lineno">  223</span>    currelem.SetElDofsBc();</div>
<div class="line"><span class="lineno">  224</span>    </div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim &lt; space_dim; idim++)    {</div>
<div class="line"><span class="lineno">  227</span>          BextOld_vec[idim]-&gt;GetElemDofs(); </div>
<div class="line"><span class="lineno">  228</span>              Vel_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  229</span>           VelAdj_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  230</span>          BhomAdj_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  231</span>             Bhom_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  232</span>    }</div>
<div class="line"><span class="lineno">  233</span>    </div>
<div class="line"><span class="lineno">  234</span>    </div>
<div class="line"><span class="lineno">  235</span>    BhomAdj_vecQuant.GetElemDofs(BhomAdj_vec);</div>
<div class="line"><span class="lineno">  236</span>    Bhom_vecQuant.GetElemDofs(Bhom_vec);</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  239</span><span class="comment">//================== GAUSS LOOP (qp loop) ======================</span></div>
<div class="line"><span class="lineno">  240</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  241</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> el_ngauss = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno">  242</span>    </div>
<div class="line"><span class="lineno">  243</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qp = 0; qp &lt; el_ngauss; qp++) {</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span><span class="comment">//======= here starts the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  246</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     {          </div>
<div class="line"><span class="lineno">  247</span><span class="comment">//   currgp.SetPhiElDofsFEVB_g (fe,qp);</span></div>
<div class="line"><span class="lineno">  248</span><span class="comment">//   currgp.SetDPhiDxezetaElDofsFEVB_g (fe,qp);  </span></div>
<div class="line"><span class="lineno">  249</span>}</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span> <span class="keyword">const</span> <span class="keywordtype">double</span>      det = 1.;<span class="comment">//currgp.JacVectVV_g(xyz);</span></div>
<div class="line"><span class="lineno">  252</span> <span class="keyword">const</span> <span class="keywordtype">double</span> dtxJxW_g = det*ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">GetGaussWeight</a>(qp);</div>
<div class="line"><span class="lineno">  253</span> <span class="keyword">const</span> <span class="keywordtype">double</span>     detb = det/el_ngauss;</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     {    </div>
<div class="line"><span class="lineno">  256</span><span class="comment">//   currgp.SetDPhiDxyzElDofsFEVB_g (fe,qp);</span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">//   currgp.ExtendDphiDxyzElDofsFEVB_g (fe); </span></div>
<div class="line"><span class="lineno">  258</span>}</div>
<div class="line"><span class="lineno">  259</span><span class="comment">//======= end of the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  260</span> </div>
<div class="line"><span class="lineno">  261</span><span class="comment">//========preparation for things that are independent of (i,j), dofs of test and shape =====================</span></div>
<div class="line"><span class="lineno">  262</span>       BhomAdj_vecQuant.curl_g();</div>
<div class="line"><span class="lineno">  263</span>       Bhom_vecQuant.curl_g();</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>   <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim&lt;space_dim; idim++)   {</div>
<div class="line"><span class="lineno">  266</span>      BhomAdj_vec[idim]-&gt;grad_g();</div>
<div class="line"><span class="lineno">  267</span>         Bhom_vec[idim]-&gt;val_g();</div>
<div class="line"><span class="lineno">  268</span>          Vel_vec[idim]-&gt;val_g();</div>
<div class="line"><span class="lineno">  269</span>       VelAdj_vec[idim]-&gt;val_g();</div>
<div class="line"><span class="lineno">  270</span>          Vel_vec_val_g[idim] =  Vel_vec[idim]-&gt;_val_g[0];</div>
<div class="line"><span class="lineno">  271</span>       VelAdj_vec_val_g[idim] =  VelAdj_vec[idim]-&gt;_val_g[0];</div>
<div class="line"><span class="lineno">  272</span>   }</div>
<div class="line"><span class="lineno">  273</span>    </div>
<div class="line"><span class="lineno">  274</span><span class="comment">// vector product</span></div>
<div class="line"><span class="lineno">  275</span>      <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a7c61609663b61259ec67232f7eba0d3c">Math::extend</a>(   &amp;Vel_vec_val_g[0],   &amp;Vel_vec_val_g3D[0],space_dim);</div>
<div class="line"><span class="lineno">  276</span>      <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a7c61609663b61259ec67232f7eba0d3c">Math::extend</a>(&amp;VelAdj_vec_val_g[0],&amp;VelAdj_vec_val_g3D[0],space_dim);</div>
<div class="line"><span class="lineno">  277</span> </div>
<div class="line"><span class="lineno">  278</span>      <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a06daa97a94cd109a7d0229d4e23a40d6">Math::cross</a>(&amp;BhomAdj_vecQuant._curl_g3D[0],   &amp;Vel_vec_val_g3D[0],curlxiXvel_g3D ); </div>
<div class="line"><span class="lineno">  279</span>      <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a06daa97a94cd109a7d0229d4e23a40d6">Math::cross</a>(   &amp;Bhom_vecQuant._curl_g3D[0],&amp;VelAdj_vec_val_g3D[0],curlbXlambda_g3D );</div>
<div class="line"><span class="lineno">  280</span><span class="comment">//========end preparation for things that are independent of (i,j) dofs of test and shape =====================</span></div>
<div class="line"><span class="lineno">  281</span>  </div>
<div class="line"><span class="lineno">  282</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">//========= FILLING ELEMENT MAT/RHS</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">//=================================</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">//============ QTYZERO dofs (rows) ============</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">//=================================</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">// // // //actually this is used for both QTYZERO and QTYONE,</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">// // // //because the dofs of pressure are FEWER...</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">// // //        for (uint i = 0; i &lt; BextOldX._ndof; i++)     {</span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">// // // //============ preparation for (i) ============</span></div>
<div class="line"><span class="lineno">  292</span><span class="comment">// // // //(i) is used only for the RHS or for both MATRIX and RHS</span></div>
<div class="line"><span class="lineno">  293</span><span class="comment">// // // //first, you put whatever is related to the Test Functions of THESE rows:</span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">// // // //test function value, test function first derivative</span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">// // //         const double                             phii_g       =      currgp._phi_ndsQLVB_g[BextOldX._FEord][i];</span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">// // //         for (uint idim=0; idim&lt;space_dim; idim++)  dphiidx_g[idim] = currgp._dphidxyz_ndsQLVB_g[BextOldX._FEord][i+idim*BextOldX._ndof];</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">// // //     Math::extend(dphiidx_g,dphiidx_g3D,space_dim);</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">// // //     Math::cross(&amp;BhomAdj_vecQuant._curl_g3D[0],dphiidx_g3D,curlxiXdphii_g3D);</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">// // //      double bDdphii_g = 0.;</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">// // //      for (uint idim=0; idim&lt;space_dim; idim++)  bDdphii_g += Bhom_vec[idim]-&gt;_val_g[0]*dphiidx_g[idim];</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">// // //      </span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">// // //      double lambdaDdphii_g = Math::dot(&amp;VelAdj_vec_val_g[0],dphiidx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">// // //      for (uint idim=0; idim&lt;space_dim; idim++) Lapxi_g[idim]=0.;</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">// // //      for (uint idim=0; idim&lt;space_dim; idim++)  {</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">// // //          for (uint jdim=0; jdim&lt;space_dim; jdim++) {</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">// // //                     Lapxi_g[idim] += BhomAdj_vec[idim]-&gt;_grad_g[0][jdim]*dphiidx_g[jdim];  //TODO CHECK THIS</span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">// // //                           }</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">// // //      }</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">// // // //============end preparation for (i) ============</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  314</span><span class="comment">// // // //============ QTYZERO rhs ============</span></div>
<div class="line"><span class="lineno">  315</span><span class="comment">// // //          for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  316</span><span class="comment">// // //             const uint irowq = i+idim*BextOldX._ndof;</span></div>
<div class="line"><span class="lineno">  317</span><span class="comment">// // //             </span></div>
<div class="line"><span class="lineno">  318</span><span class="comment">// // //             currelem.Rhs()(irowq) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">// // //                            -(1-LAP_MHD)*IRem*curlxiXdphii_g3D[idim]                 //from MHD  1</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">// // //                                -LAP_MHD*IRem*Lapxi_g[idim]                              //from MHD  2</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">// // //                            + curlxiXvel_g3D[idim]*phii_g                            //from MHD</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">// // //                            - S*curlbXlambda_g3D[idim]*phii_g                             //from NS</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">// // //                            + S*(bDdphii_g*VelAdj_vec[idim]-&gt;_val_g[0] - lambdaDdphii_g*Bhom_vec[idim]-&gt;_val_g[0])     //from NS</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">// // //                          )</span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">// // //                          +(1-currelem.GetBCDofFlag()[irowq])*detb*BextOld_vec[idim]-&gt;_val_dofs[i]; //Dirichlet bc</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">// // // //============ END QTYZERO rhs ============</span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">// // //         for (uint idim=0; idim&lt;space_dim; idim++) { // filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  330</span><span class="comment">// // //           const uint irowq = i+idim*BextOldX._ndof;</span></div>
<div class="line"><span class="lineno">  331</span><span class="comment">// // //           currelem.Mat()(irowq,irowq) += (1-currelem.GetBCDofFlag()[irowq])*detb;</span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  333</span><span class="comment">// // //                                            // end filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  334</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">// // // //============ QTYZERO x QTYZERO dofs matrix (A matrix) ============</span></div>
<div class="line"><span class="lineno">  336</span><span class="comment">// // //         for (uint j=0; j&lt;BextOldX._ndof; j++) {</span></div>
<div class="line"><span class="lineno">  337</span><span class="comment">// // // //============preparation for (j) ============</span></div>
<div class="line"><span class="lineno">  338</span><span class="comment">// // // //here you put things that depend either on (j) or on (i,j)</span></div>
<div class="line"><span class="lineno">  339</span><span class="comment">// // //           double                                  phij_g       =      currgp._phi_ndsQLVB_g[BextOldX._FEord][j];</span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[BextOldX._FEord][j+idim*BextOldX._ndof];</span></div>
<div class="line"><span class="lineno">  341</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  342</span><span class="comment">// // //      double Lap_g = Math::dot(dphijdx_g,dphiidx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  343</span><span class="comment">// // //      double lambdaDdphii_g = Math::dot(&amp;VelAdj_vec_val_g[0],dphiidx_g,space_dim);  //TODO why did i recompute it?</span></div>
<div class="line"><span class="lineno">  344</span><span class="comment">// // //      double lambdaDdphij_g = Math::dot(&amp;VelAdj_vec_val_g[0],dphijdx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  345</span><span class="comment">// // // //============ end preparation for (j) ============</span></div>
<div class="line"><span class="lineno">  346</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  347</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">// // //             int irowq = i+idim*BextOldX._ndof;</span></div>
<div class="line"><span class="lineno">  349</span><span class="comment">// // //             // diagonal blocks [1-5-9]</span></div>
<div class="line"><span class="lineno">  350</span><span class="comment">// // //             currelem.Mat()(irowq,j+idim*BextOldX._ndof)</span></div>
<div class="line"><span class="lineno">  351</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  352</span><span class="comment">// // //                  + betaL2*phij_g*phii_g</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment">// // //                  + gammaLap*Lap_g</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">// // //                  + S*phij_g*(lambdaDdphii_g  - VelAdj_vec[idim]-&gt;_val_g[0]*dphiidx_g[idim] )</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment">// // //                  + S*phii_g*(lambdaDdphij_g  - VelAdj_vec[idim]-&gt;_val_g[0]*dphijdx_g[idim] )</span></div>
<div class="line"><span class="lineno">  356</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment">// // //             // block +1 [2-6-7]</span></div>
<div class="line"><span class="lineno">  358</span><span class="comment">// // //             int idimp1=(idim+1)%space_dim;</span></div>
<div class="line"><span class="lineno">  359</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp1*BextOldX._ndof)</span></div>
<div class="line"><span class="lineno">  360</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  361</span><span class="comment">// // //                  + S*phij_g*( -VelAdj_vec[idim]-&gt;_val_g[0]*dphiidx_g[idimp1])</span></div>
<div class="line"><span class="lineno">  362</span><span class="comment">// // //                  + S*phii_g*( -VelAdj_vec[idimp1]-&gt;_val_g[0]*dphijdx_g[idim])</span></div>
<div class="line"><span class="lineno">  363</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  364</span><span class="comment">// // // #if (DIMENSION==3)</span></div>
<div class="line"><span class="lineno">  365</span><span class="comment">// // //             // block +2 [3-4-8]</span></div>
<div class="line"><span class="lineno">  366</span><span class="comment">// // //             int idimp2=(idim+2)%space_dim;</span></div>
<div class="line"><span class="lineno">  367</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp2*BextOldX._ndof)</span></div>
<div class="line"><span class="lineno">  368</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  369</span><span class="comment">// // //                   + S*phij_g*( -VelAdj_vec[idim]-&gt;_val_g[0]*dphiidx_g[idimp2]) </span></div>
<div class="line"><span class="lineno">  370</span><span class="comment">// // //                   + S*phii_g*( -VelAdj_vec[idimp2]-&gt;_val_g[0]*dphijdx_g[idim])</span></div>
<div class="line"><span class="lineno">  371</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  372</span><span class="comment">// // // #endif</span></div>
<div class="line"><span class="lineno">  373</span><span class="comment">// // //           }</span></div>
<div class="line"><span class="lineno">  374</span><span class="comment">// // //                     </span></div>
<div class="line"><span class="lineno">  375</span><span class="comment">// // //         } </span></div>
<div class="line"><span class="lineno">  376</span><span class="comment">// // // //============ END QTYZERO x QTYZERO dofs matrix (A matrix) ============</span></div>
<div class="line"><span class="lineno">  377</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  378</span><span class="comment">// // // //============ QTYZERO x QTYONE dofs matrix (B^T matrix) // ( p*div(v) ) (NS eq) ============</span></div>
<div class="line"><span class="lineno">  379</span><span class="comment">// // //        for (uint j=0; j &lt; LagMultOld._ndof; j++) {</span></div>
<div class="line"><span class="lineno">  380</span><span class="comment">// // //           const double psij_g = currgp._phi_ndsQLVB_g[LagMultOld._FEord][j];</span></div>
<div class="line"><span class="lineno">  381</span><span class="comment">// // //           const int jclml = j+space_dim*BextOldX._ndof;</span></div>
<div class="line"><span class="lineno">  382</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  383</span><span class="comment">// // //             uint irowq=i+idim*BextOldX._ndof;</span></div>
<div class="line"><span class="lineno">  384</span><span class="comment">// // //             currelem.Mat()(irowq,jclml) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(-psij_g*dphiidx_g[idim]);</span></div>
<div class="line"><span class="lineno">  385</span><span class="comment">// // //            }</span></div>
<div class="line"><span class="lineno">  386</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  387</span><span class="comment">// // // //============ END QTYZERO x QTYONE dofs matrix (B^T matrix) ============</span></div>
<div class="line"><span class="lineno">  388</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  389</span><span class="comment">// // // //===================================================================</span></div>
<div class="line"><span class="lineno">  390</span><span class="comment">// // // //============ END QTYZERO dofs (rows) ============</span></div>
<div class="line"><span class="lineno">  391</span><span class="comment">// // // //===================================================================</span></div>
<div class="line"><span class="lineno">  392</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  393</span><span class="comment">// // // //============================================</span></div>
<div class="line"><span class="lineno">  394</span><span class="comment">// // // //============ QTYONE dofs (rows) ============</span></div>
<div class="line"><span class="lineno">  395</span><span class="comment">// // // //===============================================</span></div>
<div class="line"><span class="lineno">  396</span><span class="comment">// // //           if ( i &lt; LagMultOld._ndof ) {</span></div>
<div class="line"><span class="lineno">  397</span><span class="comment">// // // //============ preparation for (i) ============</span></div>
<div class="line"><span class="lineno">  398</span><span class="comment">// // //           double psii_g = currgp._phi_ndsQLVB_g[LagMultOld._FEord][i];</span></div>
<div class="line"><span class="lineno">  399</span><span class="comment">// // //      const uint irowl = i+space_dim*BextOldX._ndof;</span></div>
<div class="line"><span class="lineno">  400</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  401</span><span class="comment">// // // //============ QTYONE rhs ============</span></div>
<div class="line"><span class="lineno">  402</span><span class="comment">// // //           currelem.Rhs()(irowl)=0.;</span></div>
<div class="line"><span class="lineno">  403</span><span class="comment">// // // //============ END QTYONE rhs ============</span></div>
<div class="line"><span class="lineno">  404</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  405</span><span class="comment">// // // //============ QTYONE x QTYONE ============</span></div>
<div class="line"><span class="lineno">  406</span><span class="comment">// // //  //             currelem.Mat()(irowl,j+space_dim*el_ndof_q)  += dtxJxW_g*(psii_g*psij_g)*_Komp_fac/dt; // (KOMP dp/dt=rho*div) </span></div>
<div class="line"><span class="lineno">  407</span><span class="comment">// // // //============ END QTYONE x QTYONE ============</span></div>
<div class="line"><span class="lineno">  408</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  409</span><span class="comment">// // // //============ QTYONE x QTYZERO (B matrix) q*div(u) ============</span></div>
<div class="line"><span class="lineno">  410</span><span class="comment">// // //           for (uint j = 0; j &lt; BextOldX._ndof; j++) { // B element matrix </span></div>
<div class="line"><span class="lineno">  411</span><span class="comment">// // // //============ preparation for (j) ============</span></div>
<div class="line"><span class="lineno">  412</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim]= currgp._dphidxyz_ndsQLVB_g[BextOldX._FEord][j+idim*BextOldX._ndof];</span></div>
<div class="line"><span class="lineno">  413</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) currelem.Mat()(irowl,j+idim*BextOldX._ndof) += -dtxJxW_g*psii_g*dphijdx_g[idim]; </span></div>
<div class="line"><span class="lineno">  414</span><span class="comment">// // //                 }</span></div>
<div class="line"><span class="lineno">  415</span><span class="comment">// // // //============ END QTYONE x QTYZERO ============</span></div>
<div class="line"><span class="lineno">  416</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  417</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  418</span><span class="comment">// // // //===============================================</span></div>
<div class="line"><span class="lineno">  419</span><span class="comment">// // // //============ END QTYONE dofs (rows) ============</span></div>
<div class="line"><span class="lineno">  420</span><span class="comment">// // // //================================================</span></div>
<div class="line"><span class="lineno">  421</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  422</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  423</span><span class="comment">//========= END FILLING ELEMENT MAT/RHS (i loop) =====================</span></div>
<div class="line"><span class="lineno">  424</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>    }</div>
<div class="line"><span class="lineno">  427</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  428</span><span class="comment">//================== END GAUSS LOOP (qp loop) ======================</span></div>
<div class="line"><span class="lineno">  429</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  430</span>    </div>
<div class="line"><span class="lineno">  432</span>    my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;add_matrix(currelem.Mat(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  433</span>    my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;add_vector(currelem.Rhs(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  434</span>    </div>
<div class="line"><span class="lineno">  435</span>  } </div>
<div class="line"><span class="lineno">  436</span>  <span class="comment">// end of element loop</span></div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>  </div>
<div class="line"><span class="lineno">  439</span>  }<span class="comment">//END VOLUME</span></div>
<div class="line"><span class="lineno">  440</span>  </div>
<div class="line"><span class="lineno">  441</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;close();</div>
<div class="line"><span class="lineno">  442</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;close();</div>
<div class="line"><span class="lineno">  443</span>  </div>
<div class="line"><span class="lineno">  444</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno">  445</span> std::cout &lt;&lt; <span class="stringliteral">&quot; GenMatRhs &quot;</span> &lt;&lt; my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">name</a>() &lt;&lt; <span class="stringliteral">&quot;: assembled  Level &quot;</span> &lt;&lt; Level</div>
<div class="line"><span class="lineno">  446</span>           &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;m() &lt;&lt; <span class="stringliteral">&quot; dofs &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  447</span><span class="preprocessor">#endif     </span></div>
<div class="line"><span class="lineno">  448</span> </div>
<div class="line"><span class="lineno">  449</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  450</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a59d1be9e4af7c0f1408260c0bcc9c90b" name="a59d1be9e4af7c0f1408260c0bcc9c90b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a59d1be9e4af7c0f1408260c0bcc9c90b">&#9670;&#160;</a></span>GenMatRhsNS()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenMatRhsNS </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function assembles the matrix and the rhs: </p>
<p>Add element matrix and rhs to the global ones.</p>
<p>Add element matrix and rhs to the global ones.</p>

<p class="definition">Definition at line <a class="el" href="../../d3/dfd/02__elliptic__with__given__advection_2_eqn_n_s_8cpp_source.html#l00029">29</a> of file <a class="el" href="../../d3/dfd/02__elliptic__with__given__advection_2_eqn_n_s_8cpp_source.html">EqnNS.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span>                                               {</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>   <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; my_system = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_NS&quot;</span>);</div>
<div class="line"><span class="lineno">   32</span>   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Level = my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>();</div>
<div class="line"><span class="lineno">   33</span>    </div>
<div class="line"><span class="lineno">   34</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>   _AdvPic_fl = 1;</div>
<div class="line"><span class="lineno">   35</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>   _AdvNew_fl = 0;</div>
<div class="line"><span class="lineno">   36</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>   _Stab_fl = 0;</div>
<div class="line"><span class="lineno">   37</span>   <span class="keyword">const</span> <span class="keywordtype">double</span> _Komp_fac = 0.;</div>
<div class="line"><span class="lineno">   38</span> </div>
<div class="line"><span class="lineno">   39</span>  <span class="comment">//========== GEOMETRIC ELEMENT ========</span></div>
<div class="line"><span class="lineno">   40</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>           space_dim = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">   41</span> </div>
<div class="line"><span class="lineno">   42</span>  <span class="comment">//====== reference values ========================</span></div>
<div class="line"><span class="lineno">   43</span><span class="comment">//====== related to Quantities on which Operators act, and to the choice of the &quot;LEADING&quot; EQUATION Operator</span></div>
<div class="line"><span class="lineno">   44</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> IRe = 1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Re&quot;</span>);</div>
<div class="line"><span class="lineno">   45</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> IFr = 1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Fr&quot;</span>);</div>
<div class="line"><span class="lineno">   46</span><span class="comment">//================================================  </span></div>
<div class="line"><span class="lineno">   47</span> </div>
<div class="line"><span class="lineno">   48</span><span class="comment">//================================================  </span></div>
<div class="line"><span class="lineno">   49</span><span class="comment">//=======Operators @ gauss =======================</span></div>
<div class="line"><span class="lineno">   50</span>  std::vector&lt;double&gt;    dphijdx_g(space_dim); <span class="comment">// ShapeDer(): used for Laplacian,Divergence, ..., associated to an Unknown Quantity</span></div>
<div class="line"><span class="lineno">   51</span>  std::vector&lt;double&gt;    dphiidx_g(space_dim); <span class="comment">// Test(): used for Laplacian,Advection,Divergence... associated to an Unknown Quantity</span></div>
<div class="line"><span class="lineno">   52</span>  std::vector&lt;double&gt;     AdvRhs_g(space_dim); <span class="comment">//Operator: Adv(u,u,phi)</span></div>
<div class="line"><span class="lineno">   53</span><span class="comment">//================================================  </span></div>
<div class="line"><span class="lineno">   54</span> </div>
<div class="line"><span class="lineno">   55</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;zero();</div>
<div class="line"><span class="lineno">   56</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;zero();</div>
<div class="line"><span class="lineno">   57</span> </div>
<div class="line"><span class="lineno">   58</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   59</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>      *mymsh      =  ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(Level);</div>
<div class="line"><span class="lineno">   60</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>      *myel       =  mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">   61</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> myproc  = mymsh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">   62</span>    </div>
<div class="line"><span class="lineno">   63</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   64</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>  {<span class="comment">//BEGIN VOLUME</span></div>
<div class="line"><span class="lineno">   67</span><span class="comment">//========================</span></div>
<div class="line"><span class="lineno">   68</span><span class="comment">//========================</span></div>
<div class="line"><span class="lineno">   69</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mesh_vb = <a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>;</div>
<div class="line"><span class="lineno">   70</span>  </div>
<div class="line"><span class="lineno">   71</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_e = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level+1];</div>
<div class="line"><span class="lineno">   72</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_b = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level];</div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel=0; iel &lt; (nel_e - nel_b); iel++) {</div>
<div class="line"><span class="lineno">   75</span>    </div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_class" href="../../d4/d0f/classfemus_1_1_current_elem.html">CurrentElem&lt;double&gt;</a>       currelem(iel,myproc,Level,<a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>,&amp;my_system,ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>(),ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#aecca332d087e3bf5546d13b2bfe2b7e1">GetElemType</a>(),mymsh);</div>
<div class="line"><span class="lineno">   77</span>    <span class="comment">//   CurrentGaussPointBase &amp; currgp = //   CurrentGaussPointBase::build(currelem,ml_prob.GetQuadratureRule(currelem.GetDim()));</span></div>
<div class="line"><span class="lineno">   78</span> </div>
<div class="line"><span class="lineno">   79</span>  </div>
<div class="line"><span class="lineno">   80</span><span class="comment">//=========INTERNAL QUANTITIES (unknowns of the equation) ==================</span></div>
<div class="line"><span class="lineno">   81</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelOldX(currelem);</div>
<div class="line"><span class="lineno">   82</span>    VelOldX._qtyptr  = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>);</div>
<div class="line"><span class="lineno">   83</span>    VelOldX._SolName = <span class="stringliteral">&quot;Qty_Velocity0&quot;</span>;</div>
<div class="line"><span class="lineno">   84</span>    VelOldX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   85</span>    VelOldX.Allocate();</div>
<div class="line"><span class="lineno">   86</span> </div>
<div class="line"><span class="lineno">   87</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelOldY(currelem);</div>
<div class="line"><span class="lineno">   88</span>    VelOldY._qtyptr  = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>);</div>
<div class="line"><span class="lineno">   89</span>    VelOldY._SolName = <span class="stringliteral">&quot;Qty_Velocity1&quot;</span>;</div>
<div class="line"><span class="lineno">   90</span>    VelOldY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   91</span>    VelOldY.Allocate();</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>    std::vector&lt;CurrentQuantity*&gt; VelOld_vec;   </div>
<div class="line"><span class="lineno">   94</span>    VelOld_vec.push_back(&amp;VelOldX);</div>
<div class="line"><span class="lineno">   95</span>    VelOld_vec.push_back(&amp;VelOldY);</div>
<div class="line"><span class="lineno">   96</span>    </div>
<div class="line"><span class="lineno">   97</span>  </div>
<div class="line"><span class="lineno">   98</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>   qtyzero_ord  = VelOldX.<a class="code hl_variable" href="../../d8/d5a/classfemus_1_1_quantity.html#a4deff955409b251411cabda37da8454b">_FEord</a>;</div>
<div class="line"><span class="lineno">   99</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>   qtyzero_ndof = VelOldX._ndof;  <span class="comment">//same as Y </span></div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span><span class="comment">//=========</span></div>
<div class="line"><span class="lineno">  102</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> pressOld(currelem);</div>
<div class="line"><span class="lineno">  103</span>    pressOld._qtyptr  = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Pressure&quot;</span>);</div>
<div class="line"><span class="lineno">  104</span>    pressOld._SolName = <span class="stringliteral">&quot;Qty_Pressure&quot;</span>;</div>
<div class="line"><span class="lineno">  105</span>    pressOld.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  106</span>    pressOld.Allocate();</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qtyone_ord  = pressOld.<a class="code hl_variable" href="../../d8/d5a/classfemus_1_1_quantity.html#a4deff955409b251411cabda37da8454b">_FEord</a>;</div>
<div class="line"><span class="lineno">  109</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qtyone_ndof = pressOld._ndof; </div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>   <span class="comment">//order</span></div>
<div class="line"><span class="lineno">  112</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>  qtyZeroToOne_DofOffset = VelOldX._ndof + VelOldY._ndof;<span class="comment">//VelOld._ndof*VelOld._dim;</span></div>
<div class="line"><span class="lineno">  113</span>   </div>
<div class="line"><span class="lineno">  114</span><span class="comment">//========= END INTERNAL QUANTITIES (unknowns of the equation) =================</span></div>
<div class="line"><span class="lineno">  115</span> </div>
<div class="line"><span class="lineno">  116</span><span class="comment">//=========EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">  117</span>  <span class="comment">//========= //DOMAIN MAPPING</span></div>
<div class="line"><span class="lineno">  118</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> xyz(currelem); <span class="comment">//domain</span></div>
<div class="line"><span class="lineno">  119</span>    xyz._dim      = space_dim;</div>
<div class="line"><span class="lineno">  120</span>    xyz._FEord    = <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a>;</div>
<div class="line"><span class="lineno">  121</span>    xyz._ndof     = currelem.GetElemType(xyz._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">  122</span>    xyz.Allocate();</div>
<div class="line"><span class="lineno">  123</span>    </div>
<div class="line"><span class="lineno">  124</span><span class="comment">//other Physical constant Quantities</span></div>
<div class="line"><span class="lineno">  125</span><span class="comment">//=======gravity==================================</span></div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> <a class="code hl_variable" href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a>(currelem);</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_variable" href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a>._dim = space_dim;</div>
<div class="line"><span class="lineno">  128</span><span class="comment">//   gravity.Allocate(); CANNOT DO THIS NOW BECAUSE NOT ALL THE DATA FOR THE ALLOCATION ARE FILLED</span></div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_variable" href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a>._val_g.resize(<a class="code hl_variable" href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a>._dim);</div>
<div class="line"><span class="lineno">  130</span>  <a class="code hl_variable" href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a>._val_g[0] = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;dirgx&quot;</span>);</div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_variable" href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a>._val_g[1] = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;dirgy&quot;</span>);</div>
<div class="line"><span class="lineno">  132</span>  <span class="keywordflow">if</span> ( space_dim == 3 )   <a class="code hl_variable" href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a>._val_g[2] = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;dirgz&quot;</span>); </div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span><span class="comment">//========================</span></div>
<div class="line"><span class="lineno">  135</span><span class="comment">//========================</span></div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>    currelem.Mat().zero();</div>
<div class="line"><span class="lineno">  138</span>    currelem.Rhs().zero(); </div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>    currelem.SetDofobjConnCoords();</div>
<div class="line"><span class="lineno">  141</span>    currelem.SetElDofsBc();</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span>    currelem.ConvertElemCoordsToMappingOrd(xyz);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span><span class="comment">//=======RETRIEVE the DOFS of the UNKNOWN QUANTITIES,i.e. MY EQUATION</span></div>
<div class="line"><span class="lineno">  146</span>     VelOldX.GetElemDofs();</div>
<div class="line"><span class="lineno">  147</span>     VelOldY.GetElemDofs();</div>
<div class="line"><span class="lineno">  148</span>    pressOld.GetElemDofs();</div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> el_ngauss = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno">  151</span>   </div>
<div class="line"><span class="lineno">  152</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qp = 0; qp &lt; el_ngauss; qp++) {  </div>
<div class="line"><span class="lineno">  153</span> </div>
<div class="line"><span class="lineno">  154</span><span class="comment">//=======here starts the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  155</span><span class="comment">// the call of these things should be related to the Operator</span></div>
<div class="line"><span class="lineno">  156</span><span class="comment">//also, the choice of the QuadratureRule should be dependent of the Involved Operators</span></div>
<div class="line"><span class="lineno">  157</span><span class="comment">//and the FE orders on which these Operators act</span></div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span><span class="comment">//these  phi and dphi are used for the different stages:</span></div>
<div class="line"><span class="lineno">  160</span><span class="comment">//BEFORE i: by the interpolation functions</span></div>
<div class="line"><span class="lineno">  161</span><span class="comment">//INSIDE i: for the tEST functions and derivatives</span></div>
<div class="line"><span class="lineno">  162</span><span class="comment">//INSIDE j: for the SHAPE functions and derivatives</span></div>
<div class="line"><span class="lineno">  163</span><span class="comment">//again, it should be the Operator to decide what functions to be called,</span></div>
<div class="line"><span class="lineno">  164</span><span class="comment">//for what FE ORDER and what DERIVATIVE ORDER</span></div>
<div class="line"><span class="lineno">  165</span><span class="comment">//if we decide that the PREPARATION of the tEST and SHAPE </span></div>
<div class="line"><span class="lineno">  166</span><span class="comment">//of a certain Unknown are COMMON TO ALL,</span></div>
<div class="line"><span class="lineno">  167</span><span class="comment">//Then we must only concentrate on preparing the OTHER involved quantities in that Operator</span></div>
<div class="line"><span class="lineno">  168</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     {          </div>
<div class="line"><span class="lineno">  169</span><span class="comment">//   currgp.SetPhiElDofsFEVB_g (fe,qp);</span></div>
<div class="line"><span class="lineno">  170</span><span class="comment">//   currgp.SetDPhiDxezetaElDofsFEVB_g (fe,qp);  </span></div>
<div class="line"><span class="lineno">  171</span>  }</div>
<div class="line"><span class="lineno">  172</span>      </div>
<div class="line"><span class="lineno">  173</span><span class="keyword">const</span> <span class="keywordtype">double</span>      det = 1.; <span class="comment">//currgp.JacVectVV_g(xyz);</span></div>
<div class="line"><span class="lineno">  174</span><span class="keyword">const</span> <span class="keywordtype">double</span> dtxJxW_g = det*ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">GetGaussWeight</a>(qp);</div>
<div class="line"><span class="lineno">  175</span><span class="keyword">const</span> <span class="keywordtype">double</span>     detb = det/el_ngauss;</div>
<div class="line"><span class="lineno">  176</span>      </div>
<div class="line"><span class="lineno">  177</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     { </div>
<div class="line"><span class="lineno">  178</span><span class="comment">//   currgp.SetDPhiDxyzElDofsFEVB_g   (fe,qp);</span></div>
<div class="line"><span class="lineno">  179</span><span class="comment">//   currgp.ExtendDphiDxyzElDofsFEVB_g(fe);</span></div>
<div class="line"><span class="lineno">  180</span>  }</div>
<div class="line"><span class="lineno">  181</span><span class="comment">//=======end of the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span><span class="comment">//now we want to fill the element matrix and rhs with ONLY values AT GAUSS POINTS</span></div>
<div class="line"><span class="lineno">  184</span><span class="comment">//we can divide the values at Gauss points into three parts:</span></div>
<div class="line"><span class="lineno">  185</span><span class="comment">//1-constant values</span></div>
<div class="line"><span class="lineno">  186</span><span class="comment">//2-values which depend on (i)</span></div>
<div class="line"><span class="lineno">  187</span><span class="comment">//3-values which depend on (i,j)</span></div>
<div class="line"><span class="lineno">  188</span><span class="comment">//1- can be used for filling both Ke and Fe</span></div>
<div class="line"><span class="lineno">  189</span><span class="comment">//2- can be used to fill Fe and also Ke</span></div>
<div class="line"><span class="lineno">  190</span><span class="comment">//3- can be used only for filling Ke</span></div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span><span class="comment">//Here, before entering the (i,j) loop, you compute quantities that DO NOT depend on (i,j),</span></div>
<div class="line"><span class="lineno">  193</span><span class="comment">//therefore the ELEMENT SUM, GAUSS SUM And tEST/SHAPE sums have ALL been performed</span></div>
<div class="line"><span class="lineno">  194</span><span class="comment">//but, these quantities depend on idim and jdim, because they are  involved in multiplications with tEST and SHAPE functions</span></div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span><span class="comment">//Internal Quantities</span></div>
<div class="line"><span class="lineno">  197</span>      VelOldX.val_g();</div>
<div class="line"><span class="lineno">  198</span>      VelOldX.grad_g();</div>
<div class="line"><span class="lineno">  199</span>      VelOldY.val_g();</div>
<div class="line"><span class="lineno">  200</span>      VelOldY.grad_g();</div>
<div class="line"><span class="lineno">  201</span>      </div>
<div class="line"><span class="lineno">  202</span><span class="comment">//Advection all VelOld</span></div>
<div class="line"><span class="lineno">  203</span>      <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim&lt;space_dim; idim++) { AdvRhs_g[idim]=0.;}</div>
<div class="line"><span class="lineno">  204</span>      </div>
<div class="line"><span class="lineno">  205</span>       <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim&lt;space_dim; idim++)  {</div>
<div class="line"><span class="lineno">  206</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>=0; <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>&lt;space_dim; <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>++) {</div>
<div class="line"><span class="lineno">  207</span>        AdvRhs_g[idim] += VelOld_vec[<a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>]-&gt;_val_g[0]*VelOld_vec[idim]-&gt;_grad_g[0][<a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>];</div>
<div class="line"><span class="lineno">  208</span>      } </div>
<div class="line"><span class="lineno">  209</span>      }   <span class="comment">// grad is [ivar][idim], i.e. [u v w][x y z]    </span></div>
<div class="line"><span class="lineno">  210</span>        </div>
<div class="line"><span class="lineno">  211</span><span class="comment">//Divergence VelOld</span></div>
<div class="line"><span class="lineno">  212</span>      <span class="keywordtype">double</span> Div_g=0.;</div>
<div class="line"><span class="lineno">  213</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim&lt;space_dim; idim++)    Div_g += VelOld_vec[idim]-&gt;_grad_g[0][idim];</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  216</span><span class="comment">//========= FILLING ELEMENT MAT/RHS (i loop) ====================</span></div>
<div class="line"><span class="lineno">  217</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  218</span><span class="comment">// TODO according to the order we should switch DIM loop and DOF loop</span></div>
<div class="line"><span class="lineno">  219</span><span class="comment">//     for (uint i=0; i&lt;qtyzero_ndof; i++)     {</span></div>
<div class="line"><span class="lineno">  220</span><span class="comment">// //=======&quot;COMMON tEST PART for QTYZERO&quot;: func and derivative, of the QTYZERO FE ORD ==========</span></div>
<div class="line"><span class="lineno">  221</span><span class="comment">//                                     const double phii_g       =      currgp._phi_ndsQLVB_g[qtyzero_ord][i];</span></div>
<div class="line"><span class="lineno">  222</span><span class="comment">//         for (uint idim=0; idim&lt;space_dim; idim++)  dphiidx_g[idim] = currgp._dphidxyz_ndsQLVB_g[qtyzero_ord][i+idim*qtyzero_ndof];</span></div>
<div class="line"><span class="lineno">  223</span><span class="comment">// //======= END &quot;COMMON tEST PART for QTYZERO&quot; ==========</span></div>
<div class="line"><span class="lineno">  224</span><span class="comment">//  </span></div>
<div class="line"><span class="lineno">  225</span><span class="comment">//    for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  226</span><span class="comment">//             const uint irowq=i+idim*qtyzero_ndof;  //  (i):       dof of the tEST function</span></div>
<div class="line"><span class="lineno">  227</span><span class="comment">//                                                   //(idim): component of the tEST function</span></div>
<div class="line"><span class="lineno">  228</span><span class="comment">//            currelem.Rhs()(irowq) += </span></div>
<div class="line"><span class="lineno">  229</span><span class="comment">//          currelem.GetBCDofFlag()[irowq]*</span></div>
<div class="line"><span class="lineno">  230</span><span class="comment">//            dtxJxW_g*(       + _AdvNew_fl*          AdvRhs_g[idim]*phii_g     // NONLIN</span></div>
<div class="line"><span class="lineno">  231</span><span class="comment">//                             +            IFr*gravity._val_g[idim]*phii_g     // gravity                           </span></div>
<div class="line"><span class="lineno">  232</span><span class="comment">//                                )</span></div>
<div class="line"><span class="lineno">  233</span><span class="comment">//             + (1-currelem.GetBCDofFlag()[irowq])*detb*VelOld_vec[idim]-&gt;_val_dofs[i] //Dirichlet bc    </span></div>
<div class="line"><span class="lineno">  234</span><span class="comment">//  ;</span></div>
<div class="line"><span class="lineno">  235</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  236</span><span class="comment">//            // end filling element rhs u</span></div>
<div class="line"><span class="lineno">  237</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  238</span><span class="comment">//   for (uint idim=0; idim&lt;space_dim; idim++) { // filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  239</span><span class="comment">//           const uint irowq = i+idim*qtyzero_ndof;</span></div>
<div class="line"><span class="lineno">  240</span><span class="comment">//           currelem.Mat()(irowq,irowq) += (1-currelem.GetBCDofFlag()[irowq])*detb;</span></div>
<div class="line"><span class="lineno">  241</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  242</span><span class="comment">//                                        // end filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  243</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">// //============ QTYZERO x QTYZERO dofs matrix (A matrix) ============</span></div>
<div class="line"><span class="lineno">  245</span><span class="comment">//         for (uint j=0; j&lt; qtyzero_ndof; j++) {</span></div>
<div class="line"><span class="lineno">  246</span><span class="comment">// //=======&quot;COMMON SHAPE PART for QTYZERO&quot;: func and derivative, of the QTYZERO FE ORD ==========</span></div>
<div class="line"><span class="lineno">  247</span><span class="comment">// //   (j):       dof of the SHAPE function</span></div>
<div class="line"><span class="lineno">  248</span><span class="comment">//            double                                  phij_g       =      currgp._phi_ndsQLVB_g[qtyzero_ord][j];</span></div>
<div class="line"><span class="lineno">  249</span><span class="comment">//            for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[qtyzero_ord][j+idim*qtyzero_ndof];</span></div>
<div class="line"><span class="lineno">  250</span><span class="comment">// //======= END &quot;COMMON SHAPE PART for QTYZERO&quot; ==========</span></div>
<div class="line"><span class="lineno">  251</span><span class="comment">//   </span></div>
<div class="line"><span class="lineno">  252</span><span class="comment">//           double Lap_g = Math::dot(&amp;dphijdx_g[0],&amp;dphiidx_g[0],space_dim);</span></div>
<div class="line"><span class="lineno">  253</span><span class="comment">//    double Adv_g=0.;</span></div>
<div class="line"><span class="lineno">  254</span><span class="comment">//    for (uint idim=0; idim&lt;space_dim; idim++) Adv_g += VelOld_vec[idim]-&gt;_val_g[0] * dphijdx_g[idim]; // =Math::dot(&amp;VelOld._val_g[0],dphijdx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  255</span><span class="comment">//          </span></div>
<div class="line"><span class="lineno">  256</span><span class="comment">//           for (uint idim=0; idim&lt;space_dim; idim++) { //filled in as 1-2-3 // 4-5-6 // 7-8-9</span></div>
<div class="line"><span class="lineno">  257</span><span class="comment">//             int irowq = i+idim*qtyzero_ndof;      //(i) is still the dof of the tEST functions</span></div>
<div class="line"><span class="lineno">  258</span><span class="comment">//                                                   //(idim): component of the tEST functions</span></div>
<div class="line"><span class="lineno">  259</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  260</span><span class="comment">//             currelem.Mat()(irowq,j+idim*qtyzero_ndof)  // diagonal blocks [1-5-9] [idim(rows),idim(columns)]  //(idim): component of the SHAPE functions</span></div>
<div class="line"><span class="lineno">  261</span><span class="comment">//                += </span></div>
<div class="line"><span class="lineno">  262</span><span class="comment">//             currelem.GetBCDofFlag()[irowq]*    </span></div>
<div class="line"><span class="lineno">  263</span><span class="comment">//             dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  264</span><span class="comment">//                  + _AdvPic_fl*                           Adv_g*phii_g                //TODO NONLIN</span></div>
<div class="line"><span class="lineno">  265</span><span class="comment">//                  + _AdvNew_fl*phij_g*VelOld_vec[idim]-&gt;_grad_g[0][idim]*phii_g        //TODO NONLIN</span></div>
<div class="line"><span class="lineno">  266</span><span class="comment">//                  + _AdvPic_fl*_Stab_fl*        0.5*Div_g*phij_g*phii_g                //TODO NONLIN</span></div>
<div class="line"><span class="lineno">  267</span><span class="comment">//                  +                         IRe*(      dphijdx_g[idim]*dphiidx_g[idim] + Lap_g)</span></div>
<div class="line"><span class="lineno">  268</span><span class="comment">//                );</span></div>
<div class="line"><span class="lineno">  269</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  270</span><span class="comment">//             int idimp1=(idim+1)%space_dim;    // block +1 [2-6-7] [idim(rows),idim+1(columns)]  //(idimp1): component of the SHAPE functions</span></div>
<div class="line"><span class="lineno">  271</span><span class="comment">//             currelem.Mat()(irowq,j+idimp1*qtyzero_ndof)</span></div>
<div class="line"><span class="lineno">  272</span><span class="comment">//                +=</span></div>
<div class="line"><span class="lineno">  273</span><span class="comment">//             currelem.GetBCDofFlag()[irowq]*</span></div>
<div class="line"><span class="lineno">  274</span><span class="comment">//             dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  275</span><span class="comment">//                    _AdvNew_fl*phij_g*VelOld_vec[idim]-&gt;_grad_g[0][idimp1]*phii_g           //TODO NONLIN</span></div>
<div class="line"><span class="lineno">  276</span><span class="comment">//                               +            IRe*(     dphijdx_g[idim]*dphiidx_g[idimp1])</span></div>
<div class="line"><span class="lineno">  277</span><span class="comment">//                );</span></div>
<div class="line"><span class="lineno">  278</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  279</span><span class="comment">//           }</span></div>
<div class="line"><span class="lineno">  280</span><span class="comment">//  </span></div>
<div class="line"><span class="lineno">  281</span><span class="comment">//         } </span></div>
<div class="line"><span class="lineno">  282</span><span class="comment">//============ END QTYZERO x QTYZERO dofs matrix (A matrix) ============</span></div>
<div class="line"><span class="lineno">  283</span> </div>
<div class="line"><span class="lineno">  284</span><span class="comment">//============ QTYZERO x QTYONE dofs matrix (B^T matrix) // ( p*div(v) ) (NS eq) ============</span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">//        for (uint j=0; j&lt;qtyone_ndof; j++) {</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">// //=======&quot;COMMON SHAPE PART for QTYONE&quot; ==================</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">//   const double psij_g = currgp._phi_ndsQLVB_g[qtyone_ord][j];</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">// //=======&quot;COMMON SHAPE PART for QTYONE&quot; - END ============</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">//           const int jclml = j + qtyZeroToOne_DofOffset;</span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">//           for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  292</span><span class="comment">//             uint irowq = i+idim*qtyzero_ndof;</span></div>
<div class="line"><span class="lineno">  293</span><span class="comment">//             currelem.Mat()(irowq,jclml) +=</span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">//                currelem.GetBCDofFlag()[irowq]*                    </span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">//                dtxJxW_g*(-psij_g*dphiidx_g[idim]);   /**   (-1.)*/</span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">//      </span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">//            } </span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">// //============ END QTYZERO x QTYONE dofs matrix (B^T matrix) ============</span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">//           if (i &lt; qtyone_ndof) {</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">// //=======&quot;COMMON tEST PART for QTYONE&quot; ============</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">//           double psii_g = currgp._phi_ndsQLVB_g[qtyone_ord][i];</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">// //======= &quot;COMMON tEST PART for QTYONE&quot; - END ============</span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">//    const uint irowl = i + qtyZeroToOne_DofOffset;</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">//           currelem.Rhs()(irowl)=0.;  // rhs</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">//  //             Mat()(irowl,j+space_dim*qtyzero_ndof)  += (1./dt)*dtxJxW_g*(psii_g*psij_g)*_Komp_fac/dt;  //no bc here (KOMP dp/dt=rho*div)</span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">//           for (uint j=0; j&lt;qtyzero_ndof; j++) { // B element matrix q*div(u)</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">// //=======&quot;COMMON SHAPE PART for QTYZERO&quot; ==================</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">//             for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[qtyzero_ord][j+idim*qtyzero_ndof];</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment">// //=======&quot;COMMON SHAPE PART for QTYZERO&quot; - END ============</span></div>
<div class="line"><span class="lineno">  314</span><span class="comment">//      </span></div>
<div class="line"><span class="lineno">  315</span><span class="comment">//             for (uint idim=0; idim&lt;space_dim; idim++) currelem.Mat()(irowl,j+idim*qtyzero_ndof) += -/*(1./dt)**/dtxJxW_g*psii_g*dphijdx_g[idim]; </span></div>
<div class="line"><span class="lineno">  316</span><span class="comment">//                 }</span></div>
<div class="line"><span class="lineno">  317</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  318</span><span class="comment">//         }</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">//                          // end pressure eq (cont)</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">//       }</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">//========= END FILLING ELEMENT MAT/RHS (i loop) =====================</span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  324</span>    }</div>
<div class="line"><span class="lineno">  325</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">//================== END GAUSS LOOP (qp loop) ======================</span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  328</span>    </div>
<div class="line"><span class="lineno">  330</span>                   my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;add_matrix(currelem.Mat(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  331</span>                   my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;add_vector(currelem.Rhs(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  332</span> </div>
<div class="line"><span class="lineno">  333</span>    </div>
<div class="line"><span class="lineno">  334</span>  } </div>
<div class="line"><span class="lineno">  335</span>  <span class="comment">// end of element loop</span></div>
<div class="line"><span class="lineno">  336</span> </div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>  }<span class="comment">//END VOLUME</span></div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;close();</div>
<div class="line"><span class="lineno">  341</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;close();</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span> </div>
<div class="line"><span class="lineno">  344</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno">  345</span> std::cout &lt;&lt; <span class="stringliteral">&quot; GenMatRhs &quot;</span> &lt;&lt; my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">name</a>() &lt;&lt; <span class="stringliteral">&quot;: assembled  Level &quot;</span> &lt;&lt; Level</div>
<div class="line"><span class="lineno">  346</span>           &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;m() &lt;&lt; <span class="stringliteral">&quot; dofs&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  347</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  350</span>}</div>
<div class="ttc" id="a_u_q_2ex12_2ex12_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp_source.html#l00053">ex12.cpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_html_a4deff955409b251411cabda37da8454b"><div class="ttname"><a href="../../d8/d5a/classfemus_1_1_quantity.html#a4deff955409b251411cabda37da8454b">femus::Quantity::_FEord</a></div><div class="ttdeci">uint _FEord</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00057">Quantity.hpp:57</a></div></div>
<div class="ttc" id="ampm_fem_8hpp_html_a3b98a21c9701599b0260b0e7e10f78b6"><div class="ttname"><a href="../../d1/dcf/mpm_fem_8hpp.html#a3b98a21c9701599b0260b0e7e10f78b6">gravity</a></div><div class="ttdeci">double gravity[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d1/dcf/mpm_fem_8hpp_source.html#l00008">mpmFem.hpp:8</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef5d4eadfcb1d008a82cef4e8369a9ae" name="aef5d4eadfcb1d008a82cef4e8369a9ae"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef5d4eadfcb1d008a82cef4e8369a9ae">&#9670;&#160;</a></span>GenMatRhsNSAD()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GenMatRhsNSAD </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">
<p>optimal control</p>
<p>Add element matrix and rhs to the global ones.</p>

<p class="definition">Definition at line <a class="el" href="../../df/d1f/_eqn_n_s_a_d_8cpp_source.html#l00026">26</a> of file <a class="el" href="../../df/d1f/_eqn_n_s_a_d_8cpp_source.html">EqnNSAD.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   26</span>                                                {</div>
<div class="line"><span class="lineno">   27</span> </div>
<div class="line"><span class="lineno">   28</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; my_system = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_NSAD&quot;</span>);</div>
<div class="line"><span class="lineno">   29</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> Level = my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a16af0d7b8849d6ea983a5e425fb90fee">GetLevelToAssemble</a>();</div>
<div class="line"><span class="lineno">   30</span>  </div>
<div class="line"><span class="lineno">   31</span>    <span class="comment">// ========= parameters</span></div>
<div class="line"><span class="lineno">   32</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> alphaVel = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;alphaVel&quot;</span>);</div>
<div class="line"><span class="lineno">   33</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> IRe      = 1./ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a692d73df5b51e09d9c1eef430376113c">GetInputParser</a>().<a class="code hl_function" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html#a317bdaac200e745334dcd436d39d2832">get</a>(<span class="stringliteral">&quot;Re&quot;</span>);</div>
<div class="line"><span class="lineno">   34</span> </div>
<div class="line"><span class="lineno">   35</span>  <span class="comment">//=========== Operators </span></div>
<div class="line"><span class="lineno">   36</span>  <span class="keywordtype">double</span> dphijdx_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   37</span>  <span class="keywordtype">double</span> dphiidx_g[<a class="code hl_define" href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp.html#aa1c0281395a97150474c058710b42bb2">DIMENSION</a>];</div>
<div class="line"><span class="lineno">   38</span>    <span class="keywordtype">double</span>    curlxiXB_g3D[3];</div>
<div class="line"><span class="lineno">   39</span> </div>
<div class="line"><span class="lineno">   40</span><span class="comment">// //======== GEOMETRICAL ELEMENT =======</span></div>
<div class="line"><span class="lineno">   41</span>  <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> space_dim = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">   42</span> </div>
<div class="line"><span class="lineno">   43</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;zero();</div>
<div class="line"><span class="lineno">   44</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;zero();</div>
<div class="line"><span class="lineno">   45</span>  </div>
<div class="line"><span class="lineno">   46</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   47</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>      *mymsh      =  ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(Level);</div>
<div class="line"><span class="lineno">   48</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>      *myel       =  mymsh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">   49</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> myproc  = mymsh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">   50</span>    </div>
<div class="line"><span class="lineno">   51</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   52</span><span class="comment">// ==========================================  </span></div>
<div class="line"><span class="lineno">   53</span>   {<span class="comment">//BEGIN VOLUME    </span></div>
<div class="line"><span class="lineno">   54</span>   </div>
<div class="line"><span class="lineno">   55</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> mesh_vb = <a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>;</div>
<div class="line"><span class="lineno">   56</span> </div>
<div class="line"><span class="lineno">   57</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_e = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level+1];</div>
<div class="line"><span class="lineno">   58</span>    <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> nel_b = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a7508c00c363175fd124c4fec42e0637c">_off_el</a>[mesh_vb][ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>().<a class="code hl_variable" href="../../d9/d52/classfemus_1_1_multi_level_mesh_two.html#a68f3f358a51963417fbaeb9255d2c2c3">_NoLevels</a>*myproc+Level];</div>
<div class="line"><span class="lineno">   59</span>    </div>
<div class="line"><span class="lineno">   60</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> iel=0; iel &lt; (nel_e - nel_b); iel++) {</div>
<div class="line"><span class="lineno">   61</span>    </div>
<div class="line"><span class="lineno">   62</span>    <a class="code hl_class" href="../../d4/d0f/classfemus_1_1_current_elem.html">CurrentElem&lt;double&gt;</a>       currelem(iel,myproc,Level,<a class="code hl_enumvalue" href="../../df/d9e/_v_b_type_enum_8hpp.html#a6130f3add5b9fe43338b4c6307ebcdcda9914e76c7304d3934461c9e7d3d3b75e">VV</a>,&amp;my_system,ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a960b21c0989774f946312b8f5869f721">GetMeshTwo</a>(),ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#aecca332d087e3bf5546d13b2bfe2b7e1">GetElemType</a>(),mymsh);</div>
<div class="line"><span class="lineno">   63</span>    <span class="comment">//   CurrentGaussPointBase &amp; currgp = //   CurrentGaussPointBase::build(currelem,ml_prob.GetQuadratureRule(currelem.GetDim()));</span></div>
<div class="line"><span class="lineno">   64</span>   </div>
<div class="line"><span class="lineno">   65</span><span class="comment">//=========INTERNAL QUANTITIES (unknowns of the equation) ==================</span></div>
<div class="line"><span class="lineno">   66</span>      <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjOldX(currelem);</div>
<div class="line"><span class="lineno">   67</span>    VelAdjOldX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj0&quot;</span>); </div>
<div class="line"><span class="lineno">   68</span>    VelAdjOldX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   69</span>    VelAdjOldX.Allocate();</div>
<div class="line"><span class="lineno">   70</span>    </div>
<div class="line"><span class="lineno">   71</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjOldY(currelem);</div>
<div class="line"><span class="lineno">   72</span>    VelAdjOldY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj1&quot;</span>); </div>
<div class="line"><span class="lineno">   73</span>    VelAdjOldY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   74</span>    VelAdjOldY.Allocate();</div>
<div class="line"><span class="lineno">   75</span>    </div>
<div class="line"><span class="lineno">   76</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelAdjOldZ(currelem);</div>
<div class="line"><span class="lineno">   77</span>    VelAdjOldZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_VelocityAdj2&quot;</span>); </div>
<div class="line"><span class="lineno">   78</span>    VelAdjOldZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   79</span>    VelAdjOldZ.Allocate();</div>
<div class="line"><span class="lineno">   80</span>    </div>
<div class="line"><span class="lineno">   81</span>    std::vector&lt;CurrentQuantity*&gt; VelAdjOld_vec;</div>
<div class="line"><span class="lineno">   82</span>    VelAdjOld_vec.push_back(&amp;VelAdjOldX);</div>
<div class="line"><span class="lineno">   83</span>    VelAdjOld_vec.push_back(&amp;VelAdjOldY);</div>
<div class="line"><span class="lineno">   84</span>    VelAdjOld_vec.push_back(&amp;VelAdjOldZ);</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> PressAdjOld(currelem);</div>
<div class="line"><span class="lineno">   87</span>    PressAdjOld._qtyptr   = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_PressureAdj&quot;</span>);</div>
<div class="line"><span class="lineno">   88</span>    PressAdjOld.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">   89</span>    PressAdjOld.Allocate();</div>
<div class="line"><span class="lineno">   90</span><span class="comment">//========= END INTERNAL QUANTITIES (unknowns of the equation) =================</span></div>
<div class="line"><span class="lineno">   91</span>  </div>
<div class="line"><span class="lineno">   92</span><span class="comment">//=========EXTERNAL QUANTITIES (couplings) =====</span></div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span><span class="comment">//========= DOMAIN MAPPING</span></div>
<div class="line"><span class="lineno">   95</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> xyz(currelem);</div>
<div class="line"><span class="lineno">   96</span>    xyz._dim      = space_dim;</div>
<div class="line"><span class="lineno">   97</span>    xyz._FEord    = <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#ac5219afbbd6ed7b35c076e508ac752ff">MESH_MAPPING_FE</a>;</div>
<div class="line"><span class="lineno">   98</span>    xyz._ndof     = currelem.GetElemType(xyz._FEord)-&gt;GetNDofs();</div>
<div class="line"><span class="lineno">   99</span>    xyz.Allocate();</div>
<div class="line"><span class="lineno">  100</span> </div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelX(currelem);</div>
<div class="line"><span class="lineno">  102</span>    VelX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>); </div>
<div class="line"><span class="lineno">  103</span>    VelX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  104</span>    VelX.Allocate();</div>
<div class="line"><span class="lineno">  105</span>    </div>
<div class="line"><span class="lineno">  106</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelY(currelem);</div>
<div class="line"><span class="lineno">  107</span>    VelY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>); </div>
<div class="line"><span class="lineno">  108</span>    VelY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  109</span>    VelY.Allocate();</div>
<div class="line"><span class="lineno">  110</span>    </div>
<div class="line"><span class="lineno">  111</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelZ(currelem);</div>
<div class="line"><span class="lineno">  112</span>    VelZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_Velocity2&quot;</span>); </div>
<div class="line"><span class="lineno">  113</span>    VelZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  114</span>    VelZ.Allocate();</div>
<div class="line"><span class="lineno">  115</span>    </div>
<div class="line"><span class="lineno">  116</span>    std::vector&lt;CurrentQuantity*&gt; Vel_vec;   </div>
<div class="line"><span class="lineno">  117</span>    Vel_vec.push_back(&amp;VelX);</div>
<div class="line"><span class="lineno">  118</span>    Vel_vec.push_back(&amp;VelY);</div>
<div class="line"><span class="lineno">  119</span>    Vel_vec.push_back(&amp;VelZ);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span> </div>
<div class="line"><span class="lineno">  122</span>    </div>
<div class="line"><span class="lineno">  123</span>    </div>
<div class="line"><span class="lineno">  124</span>  <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelDesX(currelem);</div>
<div class="line"><span class="lineno">  125</span>    VelDesX._dim        = 1;</div>
<div class="line"><span class="lineno">  126</span>    VelDesX._FEord      = VelX._FEord;</div>
<div class="line"><span class="lineno">  127</span>    VelDesX._ndof       = VelX._ndof;</div>
<div class="line"><span class="lineno">  128</span>    VelDesX.Allocate();</div>
<div class="line"><span class="lineno">  129</span> </div>
<div class="line"><span class="lineno">  130</span>  <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelDesY(currelem);</div>
<div class="line"><span class="lineno">  131</span>    VelDesY._dim        = 1;</div>
<div class="line"><span class="lineno">  132</span>    VelDesY._FEord      = VelX._FEord;</div>
<div class="line"><span class="lineno">  133</span>    VelDesY._ndof       = VelX._ndof;</div>
<div class="line"><span class="lineno">  134</span>    VelDesY.Allocate();</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>  <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> VelDesZ(currelem);</div>
<div class="line"><span class="lineno">  137</span>    VelDesZ._dim        = 1;</div>
<div class="line"><span class="lineno">  138</span>    VelDesZ._FEord      = VelX._FEord;</div>
<div class="line"><span class="lineno">  139</span>    VelDesZ._ndof       = VelX._ndof;</div>
<div class="line"><span class="lineno">  140</span>    VelDesZ.Allocate();</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  std::vector&lt;CurrentQuantity*&gt; VelDes_vec;   </div>
<div class="line"><span class="lineno">  143</span>    VelDes_vec.push_back(&amp;VelDesX);</div>
<div class="line"><span class="lineno">  144</span>    VelDes_vec.push_back(&amp;VelDesY);</div>
<div class="line"><span class="lineno">  145</span>    VelDes_vec.push_back(&amp;VelDesZ);</div>
<div class="line"><span class="lineno">  146</span>    </div>
<div class="line"><span class="lineno">  147</span>    </div>
<div class="line"><span class="lineno">  148</span>    </div>
<div class="line"><span class="lineno">  149</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomX(currelem);</div>
<div class="line"><span class="lineno">  150</span>    BhomX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom0&quot;</span>); </div>
<div class="line"><span class="lineno">  151</span>    BhomX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  152</span>    BhomX.Allocate();</div>
<div class="line"><span class="lineno">  153</span>    </div>
<div class="line"><span class="lineno">  154</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomY(currelem);</div>
<div class="line"><span class="lineno">  155</span>    BhomY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom1&quot;</span>); </div>
<div class="line"><span class="lineno">  156</span>    BhomY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  157</span>    BhomY.Allocate();</div>
<div class="line"><span class="lineno">  158</span>    </div>
<div class="line"><span class="lineno">  159</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomZ(currelem);</div>
<div class="line"><span class="lineno">  160</span>    BhomZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHom2&quot;</span>); </div>
<div class="line"><span class="lineno">  161</span>    BhomZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  162</span>    BhomZ.Allocate();</div>
<div class="line"><span class="lineno">  163</span>    </div>
<div class="line"><span class="lineno">  164</span>    std::vector&lt;CurrentQuantity*&gt; Bhom_vec;   </div>
<div class="line"><span class="lineno">  165</span>    Bhom_vec.push_back(&amp;BhomX);</div>
<div class="line"><span class="lineno">  166</span>    Bhom_vec.push_back(&amp;BhomY);</div>
<div class="line"><span class="lineno">  167</span>    Bhom_vec.push_back(&amp;BhomZ);</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>    <span class="comment">//Bhom only to retrieve the dofs</span></div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextX(currelem);</div>
<div class="line"><span class="lineno">  172</span>    BextX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt0&quot;</span>); </div>
<div class="line"><span class="lineno">  173</span>    BextX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  174</span>    BextX.Allocate();</div>
<div class="line"><span class="lineno">  175</span>    </div>
<div class="line"><span class="lineno">  176</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextY(currelem);</div>
<div class="line"><span class="lineno">  177</span>    BextY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt1&quot;</span>); </div>
<div class="line"><span class="lineno">  178</span>    BextY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  179</span>    BextY.Allocate();</div>
<div class="line"><span class="lineno">  180</span>    </div>
<div class="line"><span class="lineno">  181</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BextZ(currelem);</div>
<div class="line"><span class="lineno">  182</span>    BextZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldExt2&quot;</span>); </div>
<div class="line"><span class="lineno">  183</span>    BextZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  184</span>    BextZ.Allocate();</div>
<div class="line"><span class="lineno">  185</span>    </div>
<div class="line"><span class="lineno">  186</span>    std::vector&lt;CurrentQuantity*&gt; Bext_vec;   </div>
<div class="line"><span class="lineno">  187</span>    Bext_vec.push_back(&amp;BextX);</div>
<div class="line"><span class="lineno">  188</span>    Bext_vec.push_back(&amp;BextY);</div>
<div class="line"><span class="lineno">  189</span>    Bext_vec.push_back(&amp;BextZ);</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span><span class="comment">//========= auxiliary, must be AFTER Bhom!   //TODO this doesnt have any associated quantity!</span></div>
<div class="line"><span class="lineno">  192</span>  <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> Bmag(currelem); <span class="comment">//total</span></div>
<div class="line"><span class="lineno">  193</span>    Bmag._dim        = Bhom_vec.size();</div>
<div class="line"><span class="lineno">  194</span>    Bmag._FEord      = BhomX._FEord;</div>
<div class="line"><span class="lineno">  195</span>    Bmag._ndof       = BhomX._ndof;</div>
<div class="line"><span class="lineno">  196</span>    Bmag.Allocate();</div>
<div class="line"><span class="lineno">  197</span>    </div>
<div class="line"><span class="lineno">  198</span><span class="comment">//===============</span></div>
<div class="line"><span class="lineno">  199</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjX(currelem);</div>
<div class="line"><span class="lineno">  200</span>    BhomAdjX._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj0&quot;</span>); </div>
<div class="line"><span class="lineno">  201</span>    BhomAdjX.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  202</span>    BhomAdjX.Allocate();</div>
<div class="line"><span class="lineno">  203</span>    </div>
<div class="line"><span class="lineno">  204</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjY(currelem);</div>
<div class="line"><span class="lineno">  205</span>    BhomAdjY._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj1&quot;</span>); </div>
<div class="line"><span class="lineno">  206</span>    BhomAdjY.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  207</span>    BhomAdjY.Allocate();</div>
<div class="line"><span class="lineno">  208</span>    </div>
<div class="line"><span class="lineno">  209</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdjZ(currelem);</div>
<div class="line"><span class="lineno">  210</span>    BhomAdjZ._qtyptr      = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a895a29b587ab7f4dae3927fd46858254">GetQtyMap</a>().<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a6865a3e6d5abf01a8a17994635a1f109">GetQuantity</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj2&quot;</span>); </div>
<div class="line"><span class="lineno">  211</span>    BhomAdjZ.VectWithQtyFillBasic();</div>
<div class="line"><span class="lineno">  212</span>    BhomAdjZ.Allocate();</div>
<div class="line"><span class="lineno">  213</span>    </div>
<div class="line"><span class="lineno">  214</span>    std::vector&lt;CurrentQuantity*&gt; BhomAdj_vec;</div>
<div class="line"><span class="lineno">  215</span>    BhomAdj_vec.push_back(&amp;BhomAdjX);</div>
<div class="line"><span class="lineno">  216</span>    BhomAdj_vec.push_back(&amp;BhomAdjY);</div>
<div class="line"><span class="lineno">  217</span>    BhomAdj_vec.push_back(&amp;BhomAdjZ);</div>
<div class="line"><span class="lineno">  218</span>    </div>
<div class="line"><span class="lineno">  219</span>    <a class="code hl_class" href="../../de/d6e/classfemus_1_1_current_quantity.html">CurrentQuantity</a> BhomAdj_vecQuant(currelem);   <span class="comment">//without quantity, nor equation</span></div>
<div class="line"><span class="lineno">  220</span>    BhomAdj_vecQuant._dim     = BhomAdj_vec.size();</div>
<div class="line"><span class="lineno">  221</span>    BhomAdj_vecQuant._FEord   = BhomAdj_vec[0]-&gt;_FEord;</div>
<div class="line"><span class="lineno">  222</span>    BhomAdj_vecQuant._ndof    = BhomAdj_vec[0]-&gt;_ndof;</div>
<div class="line"><span class="lineno">  223</span>    BhomAdj_vecQuant.Allocate();</div>
<div class="line"><span class="lineno">  224</span><span class="comment">//========= END EXTERNAL QUANTITIES =================</span></div>
<div class="line"><span class="lineno">  225</span> </div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>    currelem.Mat().zero();</div>
<div class="line"><span class="lineno">  228</span>    currelem.Rhs().zero(); </div>
<div class="line"><span class="lineno">  229</span> </div>
<div class="line"><span class="lineno">  230</span>    currelem.SetDofobjConnCoords();</div>
<div class="line"><span class="lineno">  231</span>    </div>
<div class="line"><span class="lineno">  232</span>    currelem.ConvertElemCoordsToMappingOrd(xyz);</div>
<div class="line"><span class="lineno">  233</span> </div>
<div class="line"><span class="lineno">  234</span>    currelem.SetElDofsBc();</div>
<div class="line"><span class="lineno">  235</span>    </div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>    </div>
<div class="line"><span class="lineno">  238</span> <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim &lt; space_dim; idim++)    {</div>
<div class="line"><span class="lineno">  239</span>    VelAdjOld_vec[idim]-&gt;GetElemDofs();  </div>
<div class="line"><span class="lineno">  240</span>          Vel_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  241</span>      BhomAdj_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  242</span>         Bhom_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  243</span>         Bext_vec[idim]-&gt;GetElemDofs();</div>
<div class="line"><span class="lineno">  244</span>    <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ac95696b180b1768fbfd3f7babfed93c5">VelDesired</a>(&amp;ml_prob,*VelDes_vec[idim],currelem,idim);</div>
<div class="line"><span class="lineno">  245</span> }</div>
<div class="line"><span class="lineno">  246</span>    </div>
<div class="line"><span class="lineno">  247</span>    </div>
<div class="line"><span class="lineno">  248</span>    BhomAdj_vecQuant.GetElemDofs(BhomAdj_vec);  <span class="comment">//this must be AFTER filling the scalar components</span></div>
<div class="line"><span class="lineno">  249</span>    PressAdjOld.GetElemDofs();</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span><span class="comment">//======SUM Bhom and Bext  //from now on, you&#39;ll only use Bmag //Bmag,Bext and Bhom must have the same orders!</span></div>
<div class="line"><span class="lineno">  253</span>    <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a1ac507af12e3ceaf078b640984b82059">Math::zeroN</a>(&amp;Bmag._val_dofs[0],Bmag._dim*Bmag._ndof);</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>    <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> ivarq=0; ivarq &lt; Bmag._dim; ivarq++)    { <span class="comment">//ivarq is like idim</span></div>
<div class="line"><span class="lineno">  256</span>          <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> d=0; d &lt; Bmag._ndof; d++)    {</div>
<div class="line"><span class="lineno">  257</span>          <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a>     indxq  =         d + ivarq*Bmag._ndof;</div>
<div class="line"><span class="lineno">  258</span>          Bmag._val_dofs[indxq] = Bext_vec[ivarq]-&gt;_val_dofs[d] + Bhom_vec[ivarq]-&gt;_val_dofs[d];</div>
<div class="line"><span class="lineno">  259</span>      }</div>
<div class="line"><span class="lineno">  260</span>    }    </div>
<div class="line"><span class="lineno">  261</span><span class="comment">//=======    </span></div>
<div class="line"><span class="lineno">  262</span>    </div>
<div class="line"><span class="lineno">  264</span>    xyz.SetElemAverage();</div>
<div class="line"><span class="lineno">  265</span>  <span class="keywordtype">int</span> el_flagdom = <a class="code hl_function" href="../../d8/dea/namespacefemus.html#ab28051e8fceaf9b05bfae63a6522fdc4">ElFlagControl</a>(xyz._el_average,ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>);</div>
<div class="line"><span class="lineno">  266</span> </div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>   <span class="keyword">const</span> <a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> el_ngauss = ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>();</div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>   <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> qp = 0; qp &lt; el_ngauss; qp++) {</div>
<div class="line"><span class="lineno">  271</span><span class="comment">//=======here starts the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  272</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     { </div>
<div class="line"><span class="lineno">  273</span><span class="comment">//   currgp.SetPhiElDofsFEVB_g (fe,qp);  </span></div>
<div class="line"><span class="lineno">  274</span><span class="comment">//   currgp.SetDPhiDxezetaElDofsFEVB_g (fe,qp);  </span></div>
<div class="line"><span class="lineno">  275</span>}  </div>
<div class="line"><span class="lineno">  276</span>      </div>
<div class="line"><span class="lineno">  277</span><span class="keyword">const</span> <span class="keywordtype">double</span>      det = 1.; <span class="comment">// currgp.JacVectVV_g(xyz);</span></div>
<div class="line"><span class="lineno">  278</span><span class="keyword">const</span> <span class="keywordtype">double</span> dtxJxW_g = det*ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(currelem.GetDim()).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#a9aed14f6d02b6aad6b6eb59db1001438">GetGaussWeight</a>(qp);</div>
<div class="line"><span class="lineno">  279</span><span class="keyword">const</span> <span class="keywordtype">double</span>     detb = det/el_ngauss;</div>
<div class="line"><span class="lineno">  280</span>      </div>
<div class="line"><span class="lineno">  281</span><span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> fe = 0; fe &lt; <a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#aca285339f9cf24489fdc0af5b51a5fde">QL</a>; fe++)     { </div>
<div class="line"><span class="lineno">  282</span><span class="comment">//   currgp.SetDPhiDxyzElDofsFEVB_g   (fe,qp);</span></div>
<div class="line"><span class="lineno">  283</span><span class="comment">//   currgp.ExtendDphiDxyzElDofsFEVB_g(fe); </span></div>
<div class="line"><span class="lineno">  284</span>}</div>
<div class="line"><span class="lineno">  285</span><span class="comment">//=======end of the &quot;COMMON SHAPE PART&quot;==================</span></div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>     BhomAdj_vecQuant.curl_g();</div>
<div class="line"><span class="lineno">  288</span>     Bmag.val_g();</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../d5/dd2/_typedefs_8hpp.html#a91ad9478d81a7aaf2593e8d9c3d06a14">uint</a> idim=0; idim &lt; space_dim; idim++) {</div>
<div class="line"><span class="lineno">  291</span>    VelAdjOld_vec[idim]-&gt;val_g();</div>
<div class="line"><span class="lineno">  292</span>    VelDes_vec[idim]-&gt;val_g();</div>
<div class="line"><span class="lineno">  293</span>    Vel_vec[idim]-&gt;val_g();</div>
<div class="line"><span class="lineno">  294</span>    Vel_vec[idim]-&gt;grad_g();</div>
<div class="line"><span class="lineno">  295</span>  }</div>
<div class="line"><span class="lineno">  296</span>  </div>
<div class="line"><span class="lineno">  297</span><span class="comment">//vector product</span></div>
<div class="line"><span class="lineno">  298</span>        <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a7c61609663b61259ec67232f7eba0d3c">Math::extend</a>(&amp;Bmag._val_g[0],&amp;Bmag._val_g3D[0],space_dim);</div>
<div class="line"><span class="lineno">  299</span>        <a class="code hl_function" href="../../d0/d3b/namespacefemus_1_1_math.html#a06daa97a94cd109a7d0229d4e23a40d6">Math::cross</a>(&amp;BhomAdj_vecQuant._curl_g3D[0],&amp;Bmag._val_g3D[0],curlxiXB_g3D);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">//========= FILLING ELEMENT MAT/RHS (i loop) ====================</span></div>
<div class="line"><span class="lineno">  303</span><span class="comment">//==============================================================</span></div>
<div class="line"><span class="lineno">  304</span><span class="comment">// // //        for (uint i = 0; i &lt; VelAdjOldX._ndof; i++)     {</span></div>
<div class="line"><span class="lineno">  305</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  306</span><span class="comment">// // //    const double phii_g = currgp._phi_ndsQLVB_g[VelAdjOldX._FEord][i];</span></div>
<div class="line"><span class="lineno">  307</span><span class="comment">// // //         for (uint idim=0; idim&lt;space_dim; idim++)  dphiidx_g[idim]= currgp._dphidxyz_ndsQLVB_g[VelAdjOldX._FEord][i+idim*VelAdjOldX._ndof];</span></div>
<div class="line"><span class="lineno">  308</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  309</span><span class="comment">// // //          for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  310</span><span class="comment">// // //             const uint irowq=i+idim*VelAdjOldX._ndof;  //quadratic rows index</span></div>
<div class="line"><span class="lineno">  311</span><span class="comment">// // //            currelem.Rhs()(irowq) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  312</span><span class="comment">// // //                            - curlxiXB_g3D[idim]*phii_g                    //this is due to the variation of velocity in the MAGNETIC ADVECTION, so it is due to a   NONLINEAR COUPLING &quot;u times B&quot;, &quot;MY_STATE times OTHER_STATE&quot;</span></div>
<div class="line"><span class="lineno">  313</span><span class="comment">// // //                            - alphaVel*el_flagdom*(Vel_vec[idim]-&gt;_val_g[0] - VelDes_vec[idim]-&gt;_val_g[0])*phii_g    //this is the dependence that counts</span></div>
<div class="line"><span class="lineno">  314</span><span class="comment">// // //                            )</span></div>
<div class="line"><span class="lineno">  315</span><span class="comment">// // //                            + (1-currelem.GetBCDofFlag()[irowq])*detb*VelAdjOld_vec[idim]-&gt;_val_dofs[i]; //Dirichlet bc</span></div>
<div class="line"><span class="lineno">  316</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  317</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  318</span><span class="comment">// // //   for (uint idim=0; idim&lt;space_dim; idim++) { // filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">// // //           const uint irowq = i+idim*VelAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">// // //           currelem.Mat()(irowq,irowq) += (1-currelem.GetBCDofFlag()[irowq])*detb;</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">// // //         }// end filling diagonal for Dirichlet bc</span></div>
<div class="line"><span class="lineno">  322</span><span class="comment">// // //     </span></div>
<div class="line"><span class="lineno">  323</span><span class="comment">// // //         for (uint j=0; j&lt;VelAdjOldX._ndof; j++) {// A element matrix</span></div>
<div class="line"><span class="lineno">  324</span><span class="comment">// // //      </span></div>
<div class="line"><span class="lineno">  325</span><span class="comment">// // //            double                                  phij_g       =      currgp._phi_ndsQLVB_g[VelAdjOldX._FEord][j];</span></div>
<div class="line"><span class="lineno">  326</span><span class="comment">// // //            for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[VelAdjOldX._FEord][j+idim*VelAdjOldX._ndof];</span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  328</span><span class="comment">// // //           double     Lap_g = Math::dot(dphijdx_g,dphiidx_g,space_dim);</span></div>
<div class="line"><span class="lineno">  329</span><span class="comment">// // //      double Advphii_g = 0.;</span></div>
<div class="line"><span class="lineno">  330</span><span class="comment">// // //      for (uint idim=0; idim&lt;space_dim; idim++) Advphii_g += Vel_vec[idim]-&gt;_val_g[0]*dphiidx_g[idim];   //TODO can put it outside</span></div>
<div class="line"><span class="lineno">  331</span><span class="comment">// // //           </span></div>
<div class="line"><span class="lineno">  332</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) { //filled in as 1-2-3 // 4-5-6 // 7-8-9</span></div>
<div class="line"><span class="lineno">  333</span><span class="comment">// // //             int irowq = i+idim*VelAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  334</span><span class="comment">// // //             // diagonal blocks [1-5-9]</span></div>
<div class="line"><span class="lineno">  335</span><span class="comment">// // //             currelem.Mat()(irowq,j+idim*VelAdjOldX._ndof)</span></div>
<div class="line"><span class="lineno">  336</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  337</span><span class="comment">// // //                    + IRe*(dphijdx_g[idim]*dphiidx_g[idim] + Lap_g)      //Adjoint of D is D, Adjoint of Laplacian is Laplacian</span></div>
<div class="line"><span class="lineno">  338</span><span class="comment">// // //                    + phij_g*phii_g*/*dveldx_g*/Vel_vec[idim]-&gt;_grad_g[0][idim]  //Adjoint of Advection 1 delta(u) DOT grad(u): adj of nonlinear stuff has 2 TERMS (well, not always)</span></div>
<div class="line"><span class="lineno">  339</span><span class="comment">// // //                    + phij_g*Advphii_g                                   //Adjoint of Advection 2 u DOT grad (delta(u)): adj of nonlinear stuff has 2 TERMS</span></div>
<div class="line"><span class="lineno">  340</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  341</span><span class="comment">// // //             // block +1 [2-6-7]</span></div>
<div class="line"><span class="lineno">  342</span><span class="comment">// // //             int idimp1=(idim+1)%space_dim;</span></div>
<div class="line"><span class="lineno">  343</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp1*VelAdjOldX._ndof)</span></div>
<div class="line"><span class="lineno">  344</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  345</span><span class="comment">// // //                    + IRe*(dphijdx_g[idim]*dphiidx_g[idimp1])</span></div>
<div class="line"><span class="lineno">  346</span><span class="comment">// // //                    + phij_g*phii_g*/*dveldx_g*/Vel_vec[idimp1]-&gt;_grad_g[0][idim]</span></div>
<div class="line"><span class="lineno">  347</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  348</span><span class="comment">// // // #if (DIMENSION==3)</span></div>
<div class="line"><span class="lineno">  349</span><span class="comment">// // //             // block +2 [3-4-8]</span></div>
<div class="line"><span class="lineno">  350</span><span class="comment">// // //             int idimp2=(idim+2)%space_dim;</span></div>
<div class="line"><span class="lineno">  351</span><span class="comment">// // //             currelem.Mat()(irowq,j+idimp2*VelAdjOldX._ndof)</span></div>
<div class="line"><span class="lineno">  352</span><span class="comment">// // //             += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(</span></div>
<div class="line"><span class="lineno">  353</span><span class="comment">// // //                   + IRe*(dphijdx_g[idim]*dphiidx_g[idimp2])</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">// // //                   + phij_g*phii_g*/*dveldx_g*/Vel_vec[idimp2]-&gt;_grad_g[0][idim]</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment">// // //                );</span></div>
<div class="line"><span class="lineno">  356</span><span class="comment">// // // #endif</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment">// // //           }</span></div>
<div class="line"><span class="lineno">  358</span><span class="comment">// // //  </span></div>
<div class="line"><span class="lineno">  359</span><span class="comment">// // //         } </span></div>
<div class="line"><span class="lineno">  360</span><span class="comment">// // //                                       // end A element matrix</span></div>
<div class="line"><span class="lineno">  361</span><span class="comment">// // //       </span></div>
<div class="line"><span class="lineno">  362</span><span class="comment">// // //        for (uint j=0; j&lt;PressAdjOld._ndof; j++) {// B^T element matrix ( p*div(v) ) (NS eq)</span></div>
<div class="line"><span class="lineno">  363</span><span class="comment">// // //           const double psij_g =  currgp._phi_ndsQLVB_g[PressAdjOld._FEord][j];</span></div>
<div class="line"><span class="lineno">  364</span><span class="comment">// // //           const int jclml= j + space_dim*VelAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  365</span><span class="comment">// // //           for (uint idim=0; idim&lt;space_dim; idim++) {</span></div>
<div class="line"><span class="lineno">  366</span><span class="comment">// // //             uint irowq = i+idim*VelAdjOldX._ndof;</span></div>
<div class="line"><span class="lineno">  367</span><span class="comment">// // //             currelem.Mat()(irowq,jclml) += currelem.GetBCDofFlag()[irowq]*dtxJxW_g*(-psij_g*dphiidx_g[idim]);</span></div>
<div class="line"><span class="lineno">  368</span><span class="comment">// // //            }</span></div>
<div class="line"><span class="lineno">  369</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  370</span><span class="comment">// // //                                      // end B^T element matrix</span></div>
<div class="line"><span class="lineno">  371</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  372</span><span class="comment">// // //           if (i&lt;PressAdjOld._ndof) {//  pressure equation (KOMP dp/dt=rho*div) </span></div>
<div class="line"><span class="lineno">  373</span><span class="comment">// // //           double psii_g = currgp._phi_ndsQLVB_g[PressAdjOld._FEord][i];</span></div>
<div class="line"><span class="lineno">  374</span><span class="comment">// // //      const uint irowl = i+space_dim*VelAdjOldX._ndof;  //vertical offset</span></div>
<div class="line"><span class="lineno">  375</span><span class="comment">// // //           currelem.Rhs()(irowl)=0.;  // rhs</span></div>
<div class="line"><span class="lineno">  376</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  377</span><span class="comment">// // //           for (uint j=0; j&lt;VelAdjOldX._ndof; j++) { // B element matrix q*div(u)</span></div>
<div class="line"><span class="lineno">  378</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) dphijdx_g[idim] = currgp._dphidxyz_ndsQLVB_g[VelAdjOldX._FEord][j+idim*VelAdjOldX._ndof];</span></div>
<div class="line"><span class="lineno">  379</span><span class="comment">// // //             for (uint idim=0; idim&lt;space_dim; idim++) currelem.Mat()(irowl,j+idim*VelAdjOldX._ndof) += -dtxJxW_g*psii_g*dphijdx_g[idim]; </span></div>
<div class="line"><span class="lineno">  380</span><span class="comment">// // //                 }</span></div>
<div class="line"><span class="lineno">  381</span><span class="comment">// // // </span></div>
<div class="line"><span class="lineno">  382</span><span class="comment">// // //         }</span></div>
<div class="line"><span class="lineno">  383</span><span class="comment">// // //                          // end pressure eq (cont)</span></div>
<div class="line"><span class="lineno">  384</span><span class="comment">// // //       }</span></div>
<div class="line"><span class="lineno">  385</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  386</span><span class="comment">//========= END FILLING ELEMENT MAT/RHS (i loop) =====================</span></div>
<div class="line"><span class="lineno">  387</span><span class="comment">//===================================================================</span></div>
<div class="line"><span class="lineno">  388</span>      </div>
<div class="line"><span class="lineno">  389</span>    }</div>
<div class="line"><span class="lineno">  390</span>    <span class="comment">// end element gaussian integration loop</span></div>
<div class="line"><span class="lineno">  391</span>    </div>
<div class="line"><span class="lineno">  393</span>    my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;add_matrix(currelem.Mat(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  394</span>    my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;add_vector(currelem.Rhs(),currelem.GetDofIndices());</div>
<div class="line"><span class="lineno">  395</span>    </div>
<div class="line"><span class="lineno">  396</span>  } </div>
<div class="line"><span class="lineno">  397</span>  <span class="comment">// end of element loop</span></div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span> </div>
<div class="line"><span class="lineno">  400</span>  }<span class="comment">//END VOLUME</span></div>
<div class="line"><span class="lineno">  401</span>  </div>
<div class="line"><span class="lineno">  402</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;close();</div>
<div class="line"><span class="lineno">  403</span>        my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_RESC-&gt;close();</div>
<div class="line"><span class="lineno">  404</span>  </div>
<div class="line"><span class="lineno">  405</span><span class="preprocessor">#ifdef DEFAULT_PRINT_INFO</span></div>
<div class="line"><span class="lineno">  406</span> std::cout &lt;&lt; <span class="stringliteral">&quot; GenMatRhs &quot;</span> &lt;&lt; my_system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a1a007c176529dae649887bbd1cb46103">name</a>() &lt;&lt; <span class="stringliteral">&quot;: assembled  Level &quot;</span> &lt;&lt; Level</div>
<div class="line"><span class="lineno">  407</span>           &lt;&lt; <span class="stringliteral">&quot; with &quot;</span> &lt;&lt; my_system.<a class="code hl_variable" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a58ebbec8ab1f2eb863cba438f30404e0">_LinSolver</a>[Level]-&gt;_KK-&gt;m() &lt;&lt; <span class="stringliteral">&quot; dofs&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  408</span><span class="preprocessor">#endif    </span></div>
<div class="line"><span class="lineno">  409</span> </div>
<div class="line"><span class="lineno">  410</span><span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  411</span>}</div>
<div class="ttc" id="anamespacefemus_html_ab28051e8fceaf9b05bfae63a6522fdc4"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#ab28051e8fceaf9b05bfae63a6522fdc4">femus::ElFlagControl</a></div><div class="ttdeci">int ElFlagControl(const std::vector&lt; double &gt; el_xm, const MultiLevelMesh *mesh)</div><div class="ttdoc">AAA questa funzione NON lavora se tu fai solo DUE SUDDIVISIONI PER LATO e nolevels=1 !...</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d9a/02__elliptic__with__given__advection_2_opt_loop_8cpp_source.html#l00306">OptLoop.cpp:306</a></div></div>
<div class="ttc" id="anamespacefemus_html_ac95696b180b1768fbfd3f7babfed93c5"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#ac95696b180b1768fbfd3f7babfed93c5">femus::VelDesired</a></div><div class="ttdeci">void VelDesired(const MultiLevelProblem *ml_prob, CurrentQuantity &amp;myvect, const CurrentElem&lt; double &gt; &amp;currelem, const uint idim)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d63/05__mhdopt_201__control__lifting__internal_2_opt_loop_8cpp_source.html#l00638">OptLoop.cpp:638</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_source.html#l00048">48</a> of file <a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_source.html">main.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   48</span>                                {</div>
<div class="line"><span class="lineno">   49</span> </div>
<div class="line"><span class="lineno">   50</span><span class="preprocessor">#ifdef HAVE_LIBMESH</span></div>
<div class="line"><span class="lineno">   51</span>   libMesh::LibMeshInit init(argc,argv);</div>
<div class="line"><span class="lineno">   52</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">   53</span>   <a class="code hl_class" href="../../da/d5e/classfemus_1_1_femus_init.html">FemusInit</a> init(argc,argv);</div>
<div class="line"><span class="lineno">   54</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   55</span> </div>
<div class="line"><span class="lineno">   56</span><span class="comment">// ======= Files ========================</span></div>
<div class="line"><span class="lineno">   57</span>  <a class="code hl_class" href="../../d6/d0b/classfemus_1_1_files.html">Files</a> files;</div>
<div class="line"><span class="lineno">   58</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a38c38ec2557fb275bf3c301f93e9e958">ConfigureRestart</a>();</div>
<div class="line"><span class="lineno">   59</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">CheckIODirectories</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   60</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a513b4baed4cd225643cdaa2c5884de0f">CopyInputFiles</a>();</div>
<div class="line"><span class="lineno">   61</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">RedirectCout</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">   62</span> </div>
<div class="line"><span class="lineno">   63</span>  <span class="comment">// ======= Physics ========================</span></div>
<div class="line"><span class="lineno">   64</span>  <a class="code hl_class" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser&lt;double&gt;</a> physics_map(<span class="stringliteral">&quot;Physics&quot;</span>,files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>());</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> rhof   = physics_map.get(<span class="stringliteral">&quot;rho0&quot;</span>);</div>
<div class="line"><span class="lineno">   67</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> Uref   = physics_map.get(<span class="stringliteral">&quot;Uref&quot;</span>);</div>
<div class="line"><span class="lineno">   68</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> Lref   = physics_map.get(<span class="stringliteral">&quot;Lref&quot;</span>);</div>
<div class="line"><span class="lineno">   69</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>  muf   = physics_map.get(<span class="stringliteral">&quot;mu0&quot;</span>);</div>
<div class="line"><span class="lineno">   70</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> MUMHD  = physics_map.get(<span class="stringliteral">&quot;MUMHD&quot;</span>);</div>
<div class="line"><span class="lineno">   71</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> SIGMHD = physics_map.get(<span class="stringliteral">&quot;SIGMHD&quot;</span>);</div>
<div class="line"><span class="lineno">   72</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   Bref = physics_map.get(<span class="stringliteral">&quot;Bref&quot;</span>);</div>
<div class="line"><span class="lineno">   73</span>  <span class="keyword">const</span> <span class="keywordtype">double</span> sigma  = physics_map.get(<span class="stringliteral">&quot;sigma&quot;</span>);</div>
<div class="line"><span class="lineno">   74</span> </div>
<div class="line"><span class="lineno">   75</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _pref = rhof*Uref*Uref;             physics_map.set(<span class="stringliteral">&quot;pref&quot;</span>,_pref);</div>
<div class="line"><span class="lineno">   76</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _Re  = (rhof*Uref*Lref)/muf;        physics_map.set(<span class="stringliteral">&quot;Re&quot;</span>,_Re);</div>
<div class="line"><span class="lineno">   77</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _Fr  = (Uref*Uref)/(9.81*Lref);     physics_map.set(<span class="stringliteral">&quot;Fr&quot;</span>,_Fr);</div>
<div class="line"><span class="lineno">   78</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _Pr=muf/rhof;                       physics_map.set(<span class="stringliteral">&quot;Pr&quot;</span>,_Pr);</div>
<div class="line"><span class="lineno">   79</span> </div>
<div class="line"><span class="lineno">   80</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _Rem = MUMHD*SIGMHD*Uref*Lref;      physics_map.set(<span class="stringliteral">&quot;Rem&quot;</span>,_Rem);</div>
<div class="line"><span class="lineno">   81</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _Hm  = Bref*Lref*sqrt(SIGMHD/muf);  physics_map.set(<span class="stringliteral">&quot;Hm&quot;</span>,_Hm);</div>
<div class="line"><span class="lineno">   82</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _S   = _Hm*_Hm/(_Re*_Rem);          physics_map.set(<span class="stringliteral">&quot;S&quot;</span>,_S);</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  <span class="keyword">const</span> <span class="keywordtype">double</span>   _We  = (Uref*Uref*Lref*rhof)/sigma; physics_map.set(<span class="stringliteral">&quot;We&quot;</span>,_We);</div>
<div class="line"><span class="lineno">   85</span> </div>
<div class="line"><span class="lineno">   86</span>  <span class="comment">// ======= Mesh =====</span></div>
<div class="line"><span class="lineno">   87</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> NoLevels = 1;</div>
<div class="line"><span class="lineno">   88</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = 3;</div>
<div class="line"><span class="lineno">   89</span>  <span class="keyword">const</span> <a class="code hl_enumeration" href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031d">GeomElType</a> geomel_type = <a class="code hl_enumvalue" href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dad3c20094c5fe3327350484d01c44c137">HEX</a>;</div>
<div class="line"><span class="lineno">   90</span>    <a class="code hl_class" href="../../d5/dc2/classfemus_1_1_gen_case.html">GenCase</a> mesh(NoLevels,<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,geomel_type,<span class="stringliteral">&quot;&quot;</span>);</div>
<div class="line"><span class="lineno">   91</span>          mesh.SetLref(1.);</div>
<div class="line"><span class="lineno">   92</span> </div>
<div class="line"><span class="lineno">   93</span>  <span class="comment">// ======= MyDomainShape  (optional, implemented as child of Domain) ====================</span></div>
<div class="line"><span class="lineno">   94</span>  <a class="code hl_class" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser&lt;double&gt;</a> box_map(<span class="stringliteral">&quot;Box&quot;</span>,files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>());</div>
<div class="line"><span class="lineno">   95</span>  <a class="code hl_class" href="../../da/d8d/classfemus_1_1_box.html">Box</a> mybox(mesh.get_dim(),box_map);</div>
<div class="line"><span class="lineno">   96</span>      mybox.InitAndNondimensionalize(mesh.get_Lref());</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span>          mesh.SetDomain(&amp;mybox);</div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>          mesh.GenerateCase(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>());</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>          mesh.SetLref(Lref);</div>
<div class="line"><span class="lineno">  103</span>      mybox.InitAndNondimensionalize(mesh.get_Lref());</div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>          XDMFWriter::ReadMeshAndNondimensionalizeBiquadraticHDF5(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),mesh);</div>
<div class="line"><span class="lineno">  106</span>      XDMFWriter::PrintMeshXDMF(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),mesh,<a class="code hl_define" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>);</div>
<div class="line"><span class="lineno">  107</span>          XDMFWriter::PrintMeshLinear(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),mesh);</div>
<div class="line"><span class="lineno">  108</span> </div>
<div class="line"><span class="lineno">  109</span>  <span class="comment">// ===== QuantityMap =========================================</span></div>
<div class="line"><span class="lineno">  110</span>  <a class="code hl_class" href="../../d5/d5a/classfemus_1_1_quantity_map.html">QuantityMap</a>  qty_map;</div>
<div class="line"><span class="lineno">  111</span>  qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a5e91f9c899e60ee5249e57e0f746dc2c">SetMeshTwo</a>(&amp;mesh);</div>
<div class="line"><span class="lineno">  112</span>  qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#a607c4c523156d00c75864679d301aa05">SetInputParser</a>(&amp;physics_map);</div>
<div class="line"><span class="lineno">  113</span> </div>
<div class="line"><span class="lineno">  114</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  115</span><span class="comment">// ======= Add QUANTITIES ========</span></div>
<div class="line"><span class="lineno">  116</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  117</span>  <a class="code hl_class" href="../../d7/d43/class_velocity_x.html">VelocityX</a>  velocityX(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);   qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;velocityX);</div>
<div class="line"><span class="lineno">  118</span>  <a class="code hl_class" href="../../d5/dcb/class_velocity_y.html">VelocityY</a>  velocityY(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);   qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;velocityY);</div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_class" href="../../de/d74/class_velocity_z.html">VelocityZ</a>  velocityZ(<span class="stringliteral">&quot;Qty_Velocity2&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);   qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;velocityZ);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  <a class="code hl_class" href="../../d6/dd7/class_velocity_adj_x.html">VelocityAdjX</a>  velocity_adjX(<span class="stringliteral">&quot;Qty_VelocityAdj0&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);   qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;velocity_adjX);</div>
<div class="line"><span class="lineno">  122</span>  <a class="code hl_class" href="../../dc/d68/class_velocity_adj_y.html">VelocityAdjY</a>  velocity_adjY(<span class="stringliteral">&quot;Qty_VelocityAdj1&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);   qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;velocity_adjY);</div>
<div class="line"><span class="lineno">  123</span>  <a class="code hl_class" href="../../d4/d40/class_velocity_adj_z.html">VelocityAdjZ</a>  velocity_adjZ(<span class="stringliteral">&quot;Qty_VelocityAdj2&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);   qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;velocity_adjZ);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  <a class="code hl_class" href="../../d2/d97/class_magn_field_hom_adj_x.html">MagnFieldHomAdjX</a>    bhom_adjX(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj0&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);        qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhom_adjX);</div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_class" href="../../d9/d53/class_magn_field_hom_adj_y.html">MagnFieldHomAdjY</a>    bhom_adjY(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj1&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);        qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhom_adjY);</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_class" href="../../df/db6/class_magn_field_hom_adj_z.html">MagnFieldHomAdjZ</a>    bhom_adjZ(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj2&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);        qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhom_adjZ);</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <a class="code hl_class" href="../../d6/d8f/class_magn_field_hom_x.html">MagnFieldHomX</a> bhomX(<span class="stringliteral">&quot;Qty_MagnFieldHom0&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhomX);</div>
<div class="line"><span class="lineno">  130</span>  <a class="code hl_class" href="../../dc/d96/class_magn_field_hom_y.html">MagnFieldHomY</a> bhomY(<span class="stringliteral">&quot;Qty_MagnFieldHom1&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhomY);</div>
<div class="line"><span class="lineno">  131</span>  <a class="code hl_class" href="../../db/d57/class_magn_field_hom_z.html">MagnFieldHomZ</a> bhomZ(<span class="stringliteral">&quot;Qty_MagnFieldHom2&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhomZ);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  <a class="code hl_class" href="../../d2/dd7/class_magn_field_ext_x.html">MagnFieldExtX</a> BextX(<span class="stringliteral">&quot;Qty_MagnFieldExt0&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;BextX);</div>
<div class="line"><span class="lineno">  134</span>  <a class="code hl_class" href="../../d0/d3e/class_magn_field_ext_y.html">MagnFieldExtY</a> BextY(<span class="stringliteral">&quot;Qty_MagnFieldExt1&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;BextY);</div>
<div class="line"><span class="lineno">  135</span>  <a class="code hl_class" href="../../d9/d9f/class_magn_field_ext_z.html">MagnFieldExtZ</a> BextZ(<span class="stringliteral">&quot;Qty_MagnFieldExt2&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;BextZ);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  <a class="code hl_class" href="../../d4/dfa/class_magn_field_hom_lag_mult.html">MagnFieldHomLagMult</a>         bhom_lag_mult(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMult&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhom_lag_mult);</div>
<div class="line"><span class="lineno">  138</span>  <a class="code hl_class" href="../../d8/d57/class_magn_field_ext_lag_mult.html">MagnFieldExtLagMult</a>         Bext_lag_mult(<span class="stringliteral">&quot;Qty_MagnFieldExtLagMult&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>);     qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;Bext_lag_mult);</div>
<div class="line"><span class="lineno">  139</span>  <a class="code hl_class" href="../../d3/d9e/class_magn_field_hom_lag_mult_adj.html">MagnFieldHomLagMultAdj</a>  bhom_lag_mult_adj(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMultAdj&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>);  qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;bhom_lag_mult_adj);</div>
<div class="line"><span class="lineno">  140</span>  <a class="code hl_class" href="../../d2/da5/class_pressure.html">Pressure</a>                         pressure(<span class="stringliteral">&quot;Qty_Pressure&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>);                qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;pressure);</div>
<div class="line"><span class="lineno">  141</span>  <a class="code hl_class" href="../../d4/d47/class_pressure_adj.html">PressureAdj</a>                  pressure_adj(<span class="stringliteral">&quot;Qty_PressureAdj&quot;</span>,qty_map,1,<a class="code hl_enumvalue" href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a>);             qty_map.<a class="code hl_function" href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">AddQuantity</a>(&amp;pressure_adj);</div>
<div class="line"><span class="lineno">  142</span> </div>
<div class="line"><span class="lineno">  143</span><span class="comment">//consistency check</span></div>
<div class="line"><span class="lineno">  144</span><span class="comment">//  if (bhom._dim !=  Bext._dim)     {std::cout &lt;&lt; &quot;main: inconsistency&quot; &lt;&lt; std::endl;abort();}</span></div>
<div class="line"><span class="lineno">  145</span><span class="comment">//  if (bhom._FEord !=  Bext._FEord) {std::cout &lt;&lt; &quot;main: inconsistency&quot; &lt;&lt; std::endl;abort();}</span></div>
<div class="line"><span class="lineno">  146</span><span class="comment">//  if (velocity._dim !=  des_velocity._dim) {std::cout &lt;&lt; &quot;main: inconsistency&quot; &lt;&lt; std::endl; abort();}</span></div>
<div class="line"><span class="lineno">  147</span><span class="comment">//  if (velocity._FEord !=  des_velocity._FEord) {std::cout &lt;&lt; &quot;main: inconsistency&quot; &lt;&lt; std::endl; abort();}</span></div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  150</span><span class="comment">//==== END Add QUANTITIES ========</span></div>
<div class="line"><span class="lineno">  151</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>  <span class="comment">// ====== Start new main =================================</span></div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_msh;</div>
<div class="line"><span class="lineno">  155</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(8,8,8,0,1,0,2,0,1,<a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27">HEX27</a>,<span class="stringliteral">&quot;fifth&quot;</span>); <span class="comment">//   ml_msh.GenerateCoarseBoxMesh(numelemx,numelemy,numelemz,xa,xb,ya,yb,za,zb,elemtype,&quot;seventh&quot;);</span></div>
<div class="line"><span class="lineno">  156</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">RefineMesh</a>(NoLevels,NoLevels,NULL);</div>
<div class="line"><span class="lineno">  157</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><span class="lineno">  158</span> </div>
<div class="line"><span class="lineno">  159</span>  ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a1ecf10a71cc3a93dd89ded57adf55043">SetDomain</a>(&amp;mybox);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> ml_sol(&amp;ml_msh);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  ml_sol.AddSolutionVector(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_MagnFieldHom&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>,0);</div>
<div class="line"><span class="lineno">  164</span>  ml_sol.AddSolutionVector(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_MagnFieldExt&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>,0);</div>
<div class="line"><span class="lineno">  165</span>  ml_sol.AddSolutionVector(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_MagnFieldHomAdj&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>,0);</div>
<div class="line"><span class="lineno">  166</span>  ml_sol.AddSolutionVector(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_Velocity&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>,0);</div>
<div class="line"><span class="lineno">  167</span>  ml_sol.AddSolutionVector(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_VelocityAdj&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>,0);</div>
<div class="line"><span class="lineno">  168</span> </div>
<div class="line"><span class="lineno">  169</span>  ml_sol.AddSolutionVector(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_DesVelocity&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>,0,<span class="keyword">false</span>);</div>
<div class="line"><span class="lineno">  170</span> </div>
<div class="line"><span class="lineno">  171</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;Qty_Pressure&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>,0);</div>
<div class="line"><span class="lineno">  172</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;Qty_PressureAdj&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>,0);</div>
<div class="line"><span class="lineno">  173</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMult&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>,0);</div>
<div class="line"><span class="lineno">  174</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;Qty_MagnFieldExtLagMult&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>,0);</div>
<div class="line"><span class="lineno">  175</span>  ml_sol.AddSolution(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMultAdj&quot;</span>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>,<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>,0);</div>
<div class="line"><span class="lineno">  176</span> </div>
<div class="line"><span class="lineno">  177</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob(&amp;ml_sol);</div>
<div class="line"><span class="lineno">  178</span>  ml_prob.SetMeshTwo(&amp;mesh);</div>
<div class="line"><span class="lineno">  179</span>  ml_prob.SetQuadratureRuleAllGeomElems(<span class="stringliteral">&quot;fifth&quot;</span>);</div>
<div class="line"><span class="lineno">  180</span><span class="comment">//   ml_prob.SetElemTypeAllDims();</span></div>
<div class="line"><span class="lineno">  181</span>  ml_prob.SetInputParser(&amp;physics_map);</div>
<div class="line"><span class="lineno">  182</span>  ml_prob.SetQtyMap(&amp;qty_map);</div>
<div class="line"><span class="lineno">  183</span> </div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>   <span class="comment">// ******* Initial condition *******</span></div>
<div class="line"><span class="lineno">  186</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  187</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  188</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_Velocity2&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  189</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_VelocityAdj0&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  190</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_VelocityAdj1&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  191</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_VelocityAdj2&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  192</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHom0&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  193</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHom1&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  194</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHom2&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  195</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldExt0&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  196</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldExt1&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  197</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldExt2&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  198</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj0&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  199</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj1&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  200</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj2&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_DesVelocity0&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  203</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_DesVelocity1&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  204</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_DesVelocity2&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  205</span> </div>
<div class="line"><span class="lineno">  206</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_Pressure&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  207</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_PressureAdj&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  208</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMult&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  209</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldExtLagMult&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  210</span>  ml_sol.Initialize(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMultAdj&quot;</span>,<a class="code hl_function" href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a>, &amp;ml_prob);</div>
<div class="line"><span class="lineno">  211</span> </div>
<div class="line"><span class="lineno">  212</span>  <span class="comment">// ******* Set boundary function function *******</span></div>
<div class="line"><span class="lineno">  213</span>  ml_sol.AttachSetBoundaryConditionFunction(<a class="code hl_function" href="../../d8/dd4/00__laplacian__all__dims__dir__neu_8cpp.html#a7732c3f33d29ade096cab9095c2fd987">SetBoundaryCondition</a>);</div>
<div class="line"><span class="lineno">  214</span> </div>
<div class="line"><span class="lineno">  215</span>  <span class="comment">// ******* Generate boundary conditions *******</span></div>
<div class="line"><span class="lineno">  216</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_Velocity0&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  217</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_Velocity1&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  218</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_Velocity2&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  219</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_VelocityAdj0&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  220</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_VelocityAdj1&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  221</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_VelocityAdj2&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  222</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHom0&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  223</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHom1&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  224</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHom2&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  225</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldExt0&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  226</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldExt1&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  227</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldExt2&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  228</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj0&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  229</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj1&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  230</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHomAdj2&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  231</span> </div>
<div class="line"><span class="lineno">  232</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_Pressure&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  233</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_PressureAdj&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  234</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMult&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  235</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldExtLagMult&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  236</span>  ml_sol.GenerateBdc(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMultAdj&quot;</span>,<span class="stringliteral">&quot;Steady&quot;</span>,&amp;ml_prob);</div>
<div class="line"><span class="lineno">  237</span> </div>
<div class="line"><span class="lineno">  238</span>  <span class="comment">// ******* Debug *******</span></div>
<div class="line"><span class="lineno">  239</span>  ml_sol.SetWriter(<a class="code hl_enumvalue" href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);</div>
<div class="line"><span class="lineno">  240</span>  std::vector&lt;std::string&gt; print_vars(1); print_vars[0] = <span class="stringliteral">&quot;All&quot;</span>; <span class="comment">// we should find a way to make this easier</span></div>
<div class="line"><span class="lineno">  241</span>  ml_sol.GetWriter()-&gt;Write(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),<span class="stringliteral">&quot;biquadratic&quot;</span>,print_vars);</div>
<div class="line"><span class="lineno">  242</span> </div>
<div class="line"><span class="lineno">  243</span><span class="comment">//===============================================</span></div>
<div class="line"><span class="lineno">  244</span><span class="comment">//================== Add EQUATIONS  AND ======================</span></div>
<div class="line"><span class="lineno">  245</span><span class="comment">//========= associate an EQUATION to QUANTITIES ========</span></div>
<div class="line"><span class="lineno">  246</span><span class="comment">//========================================================</span></div>
<div class="line"><span class="lineno">  247</span> </div>
<div class="line"><span class="lineno">  248</span><span class="preprocessor">#if NS_EQUATIONS==1</span></div>
<div class="line"><span class="lineno">  249</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; eqnNS = ml_prob.add_system&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_NS&quot;</span>);</div>
<div class="line"><span class="lineno">  250</span> </div>
<div class="line"><span class="lineno">  251</span>          eqnNS.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a54c8e2e5af5b8b63ecdf7720bd93452d">AddSolutionToSystemPDEVector</a>(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_Velocity&quot;</span>);</div>
<div class="line"><span class="lineno">  252</span>      eqnNS.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;Qty_Pressure&quot;</span>);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>          eqnNS.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;velocityX);</div>
<div class="line"><span class="lineno">  255</span>          eqnNS.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;velocityY);</div>
<div class="line"><span class="lineno">  256</span>          eqnNS.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;velocityZ);</div>
<div class="line"><span class="lineno">  257</span>          eqnNS.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;pressure);</div>
<div class="line"><span class="lineno">  258</span> </div>
<div class="line"><span class="lineno">  259</span>          eqnNS.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a59d1be9e4af7c0f1408260c0bcc9c90b">GenMatRhsNS</a>);</div>
<div class="line"><span class="lineno">  260</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span><span class="preprocessor">#if NSAD_EQUATIONS==1</span></div>
<div class="line"><span class="lineno">  263</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; eqnNSAD = ml_prob.add_system&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_NSAD&quot;</span>);</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>            eqnNSAD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a54c8e2e5af5b8b63ecdf7720bd93452d">AddSolutionToSystemPDEVector</a>(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_VelocityAdj&quot;</span>);</div>
<div class="line"><span class="lineno">  266</span>            eqnNSAD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;Qty_PressureAdj&quot;</span>);</div>
<div class="line"><span class="lineno">  267</span> </div>
<div class="line"><span class="lineno">  268</span>            eqnNSAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;velocity_adjX);</div>
<div class="line"><span class="lineno">  269</span>            eqnNSAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;velocity_adjY);</div>
<div class="line"><span class="lineno">  270</span>            eqnNSAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;velocity_adjZ);</div>
<div class="line"><span class="lineno">  271</span>            eqnNSAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;pressure_adj);</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>            eqnNSAD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#aef5d4eadfcb1d008a82cef4e8369a9ae">GenMatRhsNSAD</a>);</div>
<div class="line"><span class="lineno">  274</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  275</span> </div>
<div class="line"><span class="lineno">  276</span><span class="preprocessor">#if MHD_EQUATIONS==1</span></div>
<div class="line"><span class="lineno">  277</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; eqnMHD = ml_prob.add_system&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_MHD&quot;</span>);</div>
<div class="line"><span class="lineno">  278</span> </div>
<div class="line"><span class="lineno">  279</span>           eqnMHD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a54c8e2e5af5b8b63ecdf7720bd93452d">AddSolutionToSystemPDEVector</a>(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_MagnFieldHom&quot;</span>);</div>
<div class="line"><span class="lineno">  280</span>           eqnMHD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMult&quot;</span>);</div>
<div class="line"><span class="lineno">  281</span> </div>
<div class="line"><span class="lineno">  282</span>           eqnMHD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhomX);</div>
<div class="line"><span class="lineno">  283</span>           eqnMHD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhomY);</div>
<div class="line"><span class="lineno">  284</span>           eqnMHD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhomZ);</div>
<div class="line"><span class="lineno">  285</span>           eqnMHD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhom_lag_mult);</div>
<div class="line"><span class="lineno">  286</span> </div>
<div class="line"><span class="lineno">  287</span>           eqnMHD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#aa760825e3c49aa86e2451d09389412fa">GenMatRhsMHD</a>);</div>
<div class="line"><span class="lineno">  288</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span><span class="preprocessor">#if MHDAD_EQUATIONS==1</span></div>
<div class="line"><span class="lineno">  291</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; eqnMHDAD = ml_prob.add_system&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_MHDAD&quot;</span>);</div>
<div class="line"><span class="lineno">  292</span> </div>
<div class="line"><span class="lineno">  293</span>             eqnMHDAD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a54c8e2e5af5b8b63ecdf7720bd93452d">AddSolutionToSystemPDEVector</a>(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_MagnFieldHomAdj&quot;</span>);</div>
<div class="line"><span class="lineno">  294</span>             eqnMHDAD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;Qty_MagnFieldHomLagMultAdj&quot;</span>);</div>
<div class="line"><span class="lineno">  295</span> </div>
<div class="line"><span class="lineno">  296</span>             eqnMHDAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhom_adjX);</div>
<div class="line"><span class="lineno">  297</span>             eqnMHDAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhom_adjY);</div>
<div class="line"><span class="lineno">  298</span>             eqnMHDAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhom_adjZ);</div>
<div class="line"><span class="lineno">  299</span>             eqnMHDAD.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;bhom_lag_mult_adj);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>             eqnMHDAD.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a3087d027394e34e7bf59b1bab68a0906">GenMatRhsMHDAD</a>);</div>
<div class="line"><span class="lineno">  302</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  303</span> </div>
<div class="line"><span class="lineno">  304</span><span class="preprocessor">#if MHDCONT_EQUATIONS==1</span></div>
<div class="line"><span class="lineno">  305</span>  <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a> &amp; eqnMHDCONT = ml_prob.add_system&lt;<a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>&gt;(<span class="stringliteral">&quot;Eqn_MHDCONT&quot;</span>);</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>               eqnMHDCONT.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a54c8e2e5af5b8b63ecdf7720bd93452d">AddSolutionToSystemPDEVector</a>(ml_msh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>(),<span class="stringliteral">&quot;Qty_MagnFieldExt&quot;</span>);</div>
<div class="line"><span class="lineno">  308</span>               eqnMHDCONT.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(<span class="stringliteral">&quot;Qty_MagnFieldExtLagMult&quot;</span>);</div>
<div class="line"><span class="lineno">  309</span> </div>
<div class="line"><span class="lineno">  310</span>               eqnMHDCONT.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;BextX);</div>
<div class="line"><span class="lineno">  311</span>               eqnMHDCONT.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;BextY);</div>
<div class="line"><span class="lineno">  312</span>               eqnMHDCONT.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;BextZ);</div>
<div class="line"><span class="lineno">  313</span>           eqnMHDCONT.<a class="code hl_function" href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">AddUnknownToSystemPDE</a>(&amp;Bext_lag_mult);</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>               eqnMHDCONT.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>(<a class="code hl_function" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a38ac6282d8c343af5bf7a5db488f7a5b">GenMatRhsMHDCONT</a>);</div>
<div class="line"><span class="lineno">  316</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  317</span> </div>
<div class="line"><span class="lineno">  318</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  319</span><span class="comment">//========= End add EQUATIONS  and ========</span></div>
<div class="line"><span class="lineno">  320</span><span class="comment">//========= associate an EQUATION to QUANTITIES ========</span></div>
<div class="line"><span class="lineno">  321</span><span class="comment">//================================</span></div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>   <span class="keywordflow">for</span> (<a class="code hl_typedef" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#ac9198f98c0374b5d00fe95e70685aed9">MultiLevelProblem::const_system_iterator</a> eqn = ml_prob.begin(); eqn != ml_prob.end(); eqn++) {</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>        <a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>* sys = <span class="keyword">static_cast&lt;</span><a class="code hl_class" href="../../dd/d68/classfemus_1_1_system_two.html">SystemTwo</a>*<span class="keyword">&gt;</span>(eqn-&gt;second);</div>
<div class="line"><span class="lineno">  326</span><span class="comment">// //=====================</span></div>
<div class="line"><span class="lineno">  327</span><span class="comment">//     sys -&gt; init_two();</span></div>
<div class="line"><span class="lineno">  328</span>    sys -&gt; _LinSolver[0]-&gt;set_solver_type(<a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>);  <span class="comment">//if I keep PREONLY it doesn&#39;t run</span></div>
<div class="line"><span class="lineno">  329</span> </div>
<div class="line"><span class="lineno">  330</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  331</span>    sys -&gt; init_unknown_vars();</div>
<div class="line"><span class="lineno">  332</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  333</span>    sys -&gt; _dofmap.ComputeMeshToDof();</div>
<div class="line"><span class="lineno">  334</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  335</span>    sys -&gt; initVectors();</div>
<div class="line"><span class="lineno">  336</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  337</span>    sys -&gt; Initialize();</div>
<div class="line"><span class="lineno">  338</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  339</span>    sys -&gt; _bcond.GenerateBdc();</div>
<div class="line"><span class="lineno">  340</span><span class="comment">//=====================</span></div>
<div class="line"><span class="lineno">  341</span>    <a class="code hl_function" href="../../d5/dc2/classfemus_1_1_gen_case.html#a8ff0e1ca8e4b16e005e8a37799c43194">GenCase::ReadMGOps</a>(files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),sys);</div>
<div class="line"><span class="lineno">  342</span> </div>
<div class="line"><span class="lineno">  343</span>    }</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>  <span class="comment">// ======== OptLoop ===================================</span></div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_class" href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">FemusInputParser&lt;double&gt;</a> loop_map(<span class="stringliteral">&quot;TimeLoop&quot;</span>,files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>());</div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_class" href="../../d6/d47/classfemus_1_1_opt_loop.html">OptLoop</a> opt_loop(files,loop_map);</div>
<div class="line"><span class="lineno">  348</span> </div>
<div class="line"><span class="lineno">  349</span>  opt_loop.TransientSetup(ml_prob);  <span class="comment">// reset the initial state (if restart) and print the Case   /*TODO fileIO */</span></div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>  opt_loop.optimization_loop(ml_prob);</div>
<div class="line"><span class="lineno">  352</span> </div>
<div class="line"><span class="lineno">  353</span><span class="comment">//============= prepare default for next restart ==========</span></div>
<div class="line"><span class="lineno">  354</span><span class="comment">// at this point, the run has been completed</span></div>
<div class="line"><span class="lineno">  355</span><span class="comment">// well, we do not know whether for the whole time range time.N-M.xmf</span></div>
<div class="line"><span class="lineno">  356</span><span class="comment">// or the optimization loop stopped before</span></div>
<div class="line"><span class="lineno">  357</span><span class="comment">// we could also print the last step number</span></div>
<div class="line"><span class="lineno">  358</span>  files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#a0b6d9e8921f6e9e8cde6677eb035268d">PrintRunForRestart</a>(<a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#a28c053773e242ca00c1f63ddcd3c2168">DEFAULT_LAST_RUN</a>); <span class="comment">/*(iproc==0)*/</span></div>
<div class="line"><span class="lineno">  359</span>  files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#ab040fcbe943823f2f0febc9bc0f127a3">log_petsc</a>();</div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span><span class="comment">// ============  clean ================================</span></div>
<div class="line"><span class="lineno">  362</span>  ml_prob.clear();</div>
<div class="line"><span class="lineno">  363</span>  mesh.clear();</div>
<div class="line"><span class="lineno">  364</span> </div>
<div class="line"><span class="lineno">  365</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  366</span> </div>
<div class="line"><span class="lineno">  367</span>}</div>
<div class="ttc" id="a00__laplacian__all__dims__dir__neu_8cpp_html_a7732c3f33d29ade096cab9095c2fd987"><div class="ttname"><a href="../../d8/dd4/00__laplacian__all__dims__dir__neu_8cpp.html#a7732c3f33d29ade096cab9095c2fd987">SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int face_name, const double time)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/dd4/00__laplacian__all__dims__dir__neu_8cpp_source.html#l00048">00_laplacian_all_dims_dir_neu.cpp:48</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a18bf208a1e2588cc489ad2f207b75a27">HEX27</a></div><div class="ttdeci">@ HEX27</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00023">ElemTypeEnum.hpp:23</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20"><div class="ttname"><a href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba11ea57bac296f79f8acbaf6fdf6bcc20">LL</a></div><div class="ttdeci">@ LL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9a/_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f"><div class="ttname"><a href="../../dd/d9a/_f_e_type_enum_8hpp.html#a31f830fd5deccf18a6e312b026bbe13ba665a6396699753f148b8d8582446975f">QQ</a></div><div class="ttdeci">@ QQ</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9a/_f_e_type_enum_8hpp_source.html#l00005">FETypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_f_e_type_enum_8hpp_html_a789a31c8b16fddbe5ad66911ec7933c6"><div class="ttname"><a href="../../dd/d9a/_f_e_type_enum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a></div><div class="ttdeci">#define BIQUADR_FE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d9a/_f_e_type_enum_8hpp_source.html#l00010">FETypeEnum.hpp:10</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00018">FElemTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_a28c053773e242ca00c1f63ddcd3c2168"><div class="ttname"><a href="../../de/df8/_femus_default_8hpp.html#a28c053773e242ca00c1f63ddcd3c2168">DEFAULT_LAST_RUN</a></div><div class="ttdeci">#define DEFAULT_LAST_RUN</div><div class="ttdef"><b>Definition</b> <a href="../../de/df8/_femus_default_8hpp_source.html#l00031">FemusDefault.hpp:31</a></div></div>
<div class="ttc" id="a_geom_el_type_enum_8hpp_html_a5f4d1ffd8f6d0e4930c05074e733031d"><div class="ttname"><a href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031d">GeomElType</a></div><div class="ttdeci">GeomElType</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d03/_geom_el_type_enum_8hpp_source.html#l00014">GeomElTypeEnum.hpp:14</a></div></div>
<div class="ttc" id="a_geom_el_type_enum_8hpp_html_a5f4d1ffd8f6d0e4930c05074e733031dad3c20094c5fe3327350484d01c44c137"><div class="ttname"><a href="../../d1/d03/_geom_el_type_enum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dad3c20094c5fe3327350484d01c44c137">HEX</a></div><div class="ttdeci">@ HEX</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d03/_geom_el_type_enum_8hpp_source.html#l00014">GeomElTypeEnum.hpp:14</a></div></div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_html_a3087d027394e34e7bf59b1bab68a0906"><div class="ttname"><a href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a3087d027394e34e7bf59b1bab68a0906">GenMatRhsMHDAD</a></div><div class="ttdeci">void GenMatRhsMHDAD(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dd3/_eqn_m_h_d_a_d_8cpp_source.html#l00025">EqnMHDAD.cpp:25</a></div></div>
<div class="ttc" id="a_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_html_a38ac6282d8c343af5bf7a5db488f7a5b"><div class="ttname"><a href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a38ac6282d8c343af5bf7a5db488f7a5b">GenMatRhsMHDCONT</a></div><div class="ttdeci">void GenMatRhsMHDCONT(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d4b/_eqn_m_h_d_c_o_n_t_8cpp_source.html#l00028">EqnMHDCONT.cpp:28</a></div></div>
<div class="ttc" id="a_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_html_a59d1be9e4af7c0f1408260c0bcc9c90b"><div class="ttname"><a href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#a59d1be9e4af7c0f1408260c0bcc9c90b">GenMatRhsNS</a></div><div class="ttdeci">void GenMatRhsNS(MultiLevelProblem &amp;ml_prob)</div><div class="ttdoc">This function assembles the matrix and the rhs:</div><div class="ttdef"><b>Definition</b> <a href="../../d3/dfd/02__elliptic__with__given__advection_2_eqn_n_s_8cpp_source.html#l00029">EqnNS.cpp:29</a></div></div>
<div class="ttc" id="a_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_html_aa760825e3c49aa86e2451d09389412fa"><div class="ttname"><a href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#aa760825e3c49aa86e2451d09389412fa">GenMatRhsMHD</a></div><div class="ttdeci">void GenMatRhsMHD(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dd6/_eqn_m_h_d_8cpp_source.html#l00027">EqnMHD.cpp:27</a></div></div>
<div class="ttc" id="a_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp_html_aef5d4eadfcb1d008a82cef4e8369a9ae"><div class="ttname"><a href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html#aef5d4eadfcb1d008a82cef4e8369a9ae">GenMatRhsNSAD</a></div><div class="ttdeci">void GenMatRhsNSAD(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../df/d1f/_eqn_n_s_a_d_8cpp_source.html#l00026">EqnNSAD.cpp:26</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a></div><div class="ttdeci">@ GMRES</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00016">SolvertypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_writer_enum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition</b> <a href="../../db/d1c/_writer_enum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclass_magn_field_ext_lag_mult_html"><div class="ttname"><a href="../../d8/d57/class_magn_field_ext_lag_mult.html">MagnFieldExtLagMult</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00150">OptQuantities.hpp:150</a></div></div>
<div class="ttc" id="aclass_magn_field_ext_x_html"><div class="ttname"><a href="../../d2/dd7/class_magn_field_ext_x.html">MagnFieldExtX</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00088">OptQuantities.hpp:88</a></div></div>
<div class="ttc" id="aclass_magn_field_ext_y_html"><div class="ttname"><a href="../../d0/d3e/class_magn_field_ext_y.html">MagnFieldExtY</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00100">OptQuantities.hpp:100</a></div></div>
<div class="ttc" id="aclass_magn_field_ext_z_html"><div class="ttname"><a href="../../d9/d9f/class_magn_field_ext_z.html">MagnFieldExtZ</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00112">OptQuantities.hpp:112</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_adj_x_html"><div class="ttname"><a href="../../d2/d97/class_magn_field_hom_adj_x.html">MagnFieldHomAdjX</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00052">OptQuantities.hpp:52</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_adj_y_html"><div class="ttname"><a href="../../d9/d53/class_magn_field_hom_adj_y.html">MagnFieldHomAdjY</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00064">OptQuantities.hpp:64</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_adj_z_html"><div class="ttname"><a href="../../df/db6/class_magn_field_hom_adj_z.html">MagnFieldHomAdjZ</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00076">OptQuantities.hpp:76</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_lag_mult_adj_html"><div class="ttname"><a href="../../d3/d9e/class_magn_field_hom_lag_mult_adj.html">MagnFieldHomLagMultAdj</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00137">OptQuantities.hpp:137</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_lag_mult_html"><div class="ttname"><a href="../../d4/dfa/class_magn_field_hom_lag_mult.html">MagnFieldHomLagMult</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00124">OptQuantities.hpp:124</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_x_html"><div class="ttname"><a href="../../d6/d8f/class_magn_field_hom_x.html">MagnFieldHomX</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00016">OptQuantities.hpp:16</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_y_html"><div class="ttname"><a href="../../dc/d96/class_magn_field_hom_y.html">MagnFieldHomY</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00028">OptQuantities.hpp:28</a></div></div>
<div class="ttc" id="aclass_magn_field_hom_z_html"><div class="ttname"><a href="../../db/d57/class_magn_field_hom_z.html">MagnFieldHomZ</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00040">OptQuantities.hpp:40</a></div></div>
<div class="ttc" id="aclass_pressure_adj_html"><div class="ttname"><a href="../../d4/d47/class_pressure_adj.html">PressureAdj</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00177">OptQuantities.hpp:177</a></div></div>
<div class="ttc" id="aclass_pressure_html"><div class="ttname"><a href="../../d2/da5/class_pressure.html">Pressure</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4b/02__elliptic__with__given__advection_2_temp_quantities_8hpp_source.html#l00047">TempQuantities.hpp:47</a></div></div>
<div class="ttc" id="aclass_velocity_adj_x_html"><div class="ttname"><a href="../../d6/dd7/class_velocity_adj_x.html">VelocityAdjX</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00228">OptQuantities.hpp:228</a></div></div>
<div class="ttc" id="aclass_velocity_adj_y_html"><div class="ttname"><a href="../../dc/d68/class_velocity_adj_y.html">VelocityAdjY</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00241">OptQuantities.hpp:241</a></div></div>
<div class="ttc" id="aclass_velocity_adj_z_html"><div class="ttname"><a href="../../d4/d40/class_velocity_adj_z.html">VelocityAdjZ</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00254">OptQuantities.hpp:254</a></div></div>
<div class="ttc" id="aclass_velocity_x_html"><div class="ttname"><a href="../../d7/d43/class_velocity_x.html">VelocityX</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4b/02__elliptic__with__given__advection_2_temp_quantities_8hpp_source.html#l00060">TempQuantities.hpp:60</a></div></div>
<div class="ttc" id="aclass_velocity_y_html"><div class="ttname"><a href="../../d5/dcb/class_velocity_y.html">VelocityY</a></div><div class="ttdef"><b>Definition</b> <a href="../../d4/d4b/02__elliptic__with__given__advection_2_temp_quantities_8hpp_source.html#l00070">TempQuantities.hpp:70</a></div></div>
<div class="ttc" id="aclass_velocity_z_html"><div class="ttname"><a href="../../de/d74/class_velocity_z.html">VelocityZ</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/dc2/_opt_quantities_8hpp_source.html#l00214">OptQuantities.hpp:214</a></div></div>
<div class="ttc" id="aclassfemus_1_1_box_html"><div class="ttname"><a href="../../da/d8d/classfemus_1_1_box.html">femus::Box</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/df1/_box_8hpp_source.html#l00028">Box.hpp:28</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_input_parser_html"><div class="ttname"><a href="../../d5/dbd/classfemus_1_1_femus_input_parser.html">femus::FemusInputParser</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/d19/_femus_input_parser_8hpp_source.html#l00036">FemusInputParser.hpp:36</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html">femus::Files</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00040">Files.hpp:40</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_a0b6d9e8921f6e9e8cde6677eb035268d"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a0b6d9e8921f6e9e8cde6677eb035268d">femus::Files::PrintRunForRestart</a></div><div class="ttdeci">void PrintRunForRestart(const std::string run_name_in) const</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00253">Files.cpp:253</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_a38c38ec2557fb275bf3c301f93e9e958"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a38c38ec2557fb275bf3c301f93e9e958">femus::Files::ConfigureRestart</a></div><div class="ttdeci">void ConfigureRestart()</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00054">Files.cpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_a513b4baed4cd225643cdaa2c5884de0f"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#a513b4baed4cd225643cdaa2c5884de0f">femus::Files::CopyInputFiles</a></div><div class="ttdeci">void CopyInputFiles() const</div><div class="ttdoc">========== Copy Input Files ==========</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00438">Files.cpp:438</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_aac199200ffda7ba50611cc41f6a874bc"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">femus::Files::RedirectCout</a></div><div class="ttdeci">void RedirectCout(const bool redirect_cout_to_file) const</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00553">Files.cpp:553</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab040fcbe943823f2f0febc9bc0f127a3"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#ab040fcbe943823f2f0febc9bc0f127a3">femus::Files::log_petsc</a></div><div class="ttdeci">void log_petsc() const</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00614">Files.cpp:614</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab8c41974c4980d87c7e1467b153854e6"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">femus::Files::CheckIODirectories</a></div><div class="ttdeci">void CheckIODirectories(const bool use_output_time_folder)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00515">Files.cpp:515</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00064">Files.hpp:64</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html"><div class="ttname"><a href="../../d5/dc2/classfemus_1_1_gen_case.html">femus::GenCase</a></div><div class="ttdef"><b>Definition</b> <a href="../../d7/db9/_gen_case_8hpp_source.html#l00032">GenCase.hpp:32</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gen_case_html_a8ff0e1ca8e4b16e005e8a37799c43194"><div class="ttname"><a href="../../d5/dc2/classfemus_1_1_gen_case.html#a8ff0e1ca8e4b16e005e8a37799c43194">femus::GenCase::ReadMGOps</a></div><div class="ttdeci">static void ReadMGOps(const std::string output_path, SystemTwo *mysys)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d36/_gen_case_8cpp_source.html#l02118">GenCase.cpp:2118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a06c4fe014434c2bafdd2c6e94e018620"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a06c4fe014434c2bafdd2c6e94e018620">femus::MultiLevelMesh::RefineMesh</a></div><div class="ttdeci">void RefineMesh(const unsigned short &amp;igridn, const unsigned short &amp;igridr, bool(*SetRefinementFlag)(const std::vector&lt; double &gt; &amp;x, const int &amp;ElemGroupNumber, const int &amp;level))</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00495">MultiLevelMesh.cpp:495</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a09c12975f18035d5369ae411c0208648"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a09c12975f18035d5369ae411c0208648">femus::MultiLevelMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo()</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00462">MultiLevelMesh.cpp:462</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a1ecf10a71cc3a93dd89ded57adf55043"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a1ecf10a71cc3a93dd89ded57adf55043">femus::MultiLevelMesh::SetDomain</a></div><div class="ttdeci">void SetDomain(Domain *)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00546">MultiLevelMesh.cpp:546</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_ac9198f98c0374b5d00fe95e70685aed9"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#ac9198f98c0374b5d00fe95e70685aed9">femus::MultiLevelProblem::const_system_iterator</a></div><div class="ttdeci">std::map&lt; std::string, System * &gt;::const_iterator const_system_iterator</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00160">MultiLevelProblem.hpp:160</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_opt_loop_html"><div class="ttname"><a href="../../d6/d47/classfemus_1_1_opt_loop.html">femus::OptLoop</a></div><div class="ttdef"><b>Definition</b> <a href="../../dc/d3d/02__elliptic__with__given__advection_2_opt_loop_8hpp_source.html#l00020">OptLoop.hpp:20</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html">femus::QuantityMap</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00073">Quantity.hpp:73</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_a5e91f9c899e60ee5249e57e0f746dc2c"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#a5e91f9c899e60ee5249e57e0f746dc2c">femus::QuantityMap::SetMeshTwo</a></div><div class="ttdeci">void SetMeshTwo(const MultiLevelMeshTwo *mesh_in)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00096">Quantity.hpp:96</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_a607c4c523156d00c75864679d301aa05"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#a607c4c523156d00c75864679d301aa05">femus::QuantityMap::SetInputParser</a></div><div class="ttdeci">void SetInputParser(const FemusInputParser&lt; double &gt; *parser_in)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00102">Quantity.hpp:102</a></div></div>
<div class="ttc" id="aclassfemus_1_1_quantity_map_html_ad491f645bc7537f47462cc352f0add25"><div class="ttname"><a href="../../d5/d5a/classfemus_1_1_quantity_map.html#ad491f645bc7537f47462cc352f0add25">femus::QuantityMap::AddQuantity</a></div><div class="ttdeci">void AddQuantity(Quantity *value)</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d5f/_quantity_8hpp_source.html#l00080">Quantity.hpp:80</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a42a5b5b5d2c7673b1d4c896762d8db9e"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">femus::System::SetAssembleFunction</a></div><div class="ttdeci">void SetAssembleFunction(AssembleFunctionType)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00058">System.cpp:58</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a54c8e2e5af5b8b63ecdf7720bd93452d"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a54c8e2e5af5b8b63ecdf7720bd93452d">femus::System::AddSolutionToSystemPDEVector</a></div><div class="ttdeci">void AddSolutionToSystemPDEVector(const unsigned n_components, const std::string name)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00065">System.cpp:65</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a606e07526d7a0d31eed638404ee2ed24"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">femus::System::AddSolutionToSystemPDE</a></div><div class="ttdeci">virtual void AddSolutionToSystemPDE(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00075">System.cpp:75</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_two_html_a34293cf806f9758e32d6bbbd232088b2"><div class="ttname"><a href="../../dd/d68/classfemus_1_1_system_two.html#a34293cf806f9758e32d6bbbd232088b2">femus::SystemTwo::AddUnknownToSystemPDE</a></div><div class="ttdeci">void AddUnknownToSystemPDE(Quantity *qty_in)</div><div class="ttdef"><b>Definition</b> <a href="../../de/da5/_system_two_8hpp_source.html#l00070">SystemTwo.hpp:70</a></div></div>
<div class="ttc" id="aex20__time__dependent_8cpp_html_ab651207781b52680d3f1d7725793b81c"><div class="ttname"><a href="../../d5/d65/ex20__time__dependent_8cpp.html#ab651207781b52680d3f1d7725793b81c">SetInitialCondition</a></div><div class="ttdeci">double SetInitialCondition(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d65/ex20__time__dependent_8cpp_source.html#l00084">ex20_time_dependent.cpp:84</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_0011fd9907a18ae0e94bfb1b854040dc.html">OptimalControl</a></li><li class="navelem"><a class="el" href="../../dir_c0b5bce7e29a50af4ed1bf2ceb244e95.html">05_mhdopt</a></li><li class="navelem"><a class="el" href="../../dir_e316632e4f88c11dd044e95239cc8c20.html">01_control_lifting_internal</a></li><li class="navelem"><a class="el" href="../../de/d07/_optimal_control_205__mhdopt_201__control__lifting__internal_2main_8cpp.html">main.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
