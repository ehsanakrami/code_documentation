<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: C:/Users/Ehsan/OneDrive - Dublin City University/Desktop/femus/source/applications/NonLocal/ex1/ex1.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d0/d8e/_non_local_2ex1_2ex1_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">ex1.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../df/d7c/_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/dbc/_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df7/_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d7f/_transient_system_8hpp_source.html">TransientSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/dc5/_non_linear_implicit_system_8hpp_source.html">NonLinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>&quot;</code><br />
<code>#include &quot;adept.h&quot;</code><br />
<code>#include &quot;petsc.h&quot;</code><br />
<code>#include &quot;petscmat.h&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d31/_petsc_matrix_8hpp_source.html">PetscMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;slepceps.h&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp_source.html">../include/nonlocal_assembly.hpp</a>&quot;</code><br />
</div>
<p><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a4794900b572c7f3529d6a86e64cb1bb4"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a4794900b572c7f3529d6a86e64cb1bb4">InitalValueU</a> (const std::vector&lt; double &gt; &amp;x)</td></tr>
<tr class="separator:a4794900b572c7f3529d6a86e64cb1bb4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0adefeff8794d51147e5c97d56baf714"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0adefeff8794d51147e5c97d56baf714">GetL2Norm</a> (<a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;mlSol, <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;mlSolFine)</td></tr>
<tr class="separator:a0adefeff8794d51147e5c97d56baf714"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3eda797314ab7e3db22c2bb7661ed247"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a3eda797314ab7e3db22c2bb7661ed247">GetL2NormLocalConnectedNonlocalFine</a> (<a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;mlSol, <a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;mlSolFine)</td></tr>
<tr class="separator:a3eda797314ab7e3db22c2bb7661ed247"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a868f493464e4506415b1f8b6cc492800"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a868f493464e4506415b1f8b6cc492800">PutADoubleNodeAtTheInterface</a> (<a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;mlMsh, const double &amp;meshSize, double &amp;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a>, double &amp;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a>)</td></tr>
<tr class="separator:a868f493464e4506415b1f8b6cc492800"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf9c8cb2738ee78e3c891630faaef46a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#aaf9c8cb2738ee78e3c891630faaef46a">ShiftTheExtrema</a> (<a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;mlMsh, const double &amp;meshSize, const double &amp;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp.html#aad49095e956c6c9460542240b8de5104">delta1Shift</a>, const double &amp;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp.html#ae6d7e00b4db89f0ac554feff2d08fdda">delta2Shift</a>, double &amp;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a>, double &amp;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a>)</td></tr>
<tr class="separator:aaf9c8cb2738ee78e3c891630faaef46a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a342565aa59a97f7a10bacd104d65a353"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a342565aa59a97f7a10bacd104d65a353">BuildElementSkipFlags</a> (<a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;mlMsh, std::vector&lt; unsigned &gt; &amp;<a class="el" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>)</td></tr>
<tr class="separator:a342565aa59a97f7a10bacd104d65a353"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a> (const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:ab8b0d45993b678f2b4a8aea9fff7fc87"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a3c04138a5bfe5d72780bb7e82a18e627">main</a> (int argc, char **argv)</td></tr>
<tr class="separator:a3c04138a5bfe5d72780bb7e82a18e627"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a0aca793820b6ff7705450e2043256938"><td class="memItemLeft" align="right" valign="top">unsigned&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> = 1</td></tr>
<tr class="separator:a0aca793820b6ff7705450e2043256938"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a id="a342565aa59a97f7a10bacd104d65a353" name="a342565aa59a97f7a10bacd104d65a353"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a342565aa59a97f7a10bacd104d65a353">&#9670;&#160;</a></span>BuildElementSkipFlags()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BuildElementSkipFlags </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mlMsh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>elementSkipFlags</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00873">873</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  873</span>                                                                                           {</div>
<div class="line"><span class="lineno">  874</span> </div>
<div class="line"><span class="lineno">  875</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span>  <span class="keywordtype">unsigned</span> xType = 2;</div>
<div class="line"><span class="lineno">  878</span> </div>
<div class="line"><span class="lineno">  879</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* msh = mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> (level);</div>
<div class="line"><span class="lineno">  880</span> </div>
<div class="line"><span class="lineno">  881</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  882</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>(); <span class="comment">// get the noumber of processes (for parallel computation)</span></div>
<div class="line"><span class="lineno">  883</span> </div>
<div class="line"><span class="lineno">  884</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d5a5a4dc9a9129e4d48694eccc32b06">numberOfElements</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">GetNumberOfElements</a>();</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>  <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>.assign (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d5a5a4dc9a9129e4d48694eccc32b06">numberOfElements</a>, 0);</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  889</span> </div>
<div class="line"><span class="lineno">  890</span>    <span class="keywordtype">unsigned</span> xMinDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (0, iel, xType);</div>
<div class="line"><span class="lineno">  891</span>    <span class="keywordtype">unsigned</span> xMaxDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (1, iel, xType);</div>
<div class="line"><span class="lineno">  892</span> </div>
<div class="line"><span class="lineno">  893</span>    <span class="keywordtype">double</span> xMin = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMinDof);</div>
<div class="line"><span class="lineno">  894</span>    <span class="keywordtype">double</span> xMax = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMaxDof);</div>
<div class="line"><span class="lineno">  895</span> </div>
<div class="line"><span class="lineno">  896</span>    <span class="keywordflow">if</span> (fabs (xMax - xMin) &lt;= 1.e-14) <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>[iel] = 1;</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>  }</div>
<div class="line"><span class="lineno">  899</span> </div>
<div class="line"><span class="lineno">  900</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> iel = 0; iel &lt; <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d5a5a4dc9a9129e4d48694eccc32b06">numberOfElements</a>; iel++) {</div>
<div class="line"><span class="lineno">  901</span>    <span class="keywordtype">unsigned</span> flag = 0;</div>
<div class="line"><span class="lineno">  902</span>    MPI_Allreduce (&amp;<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>[iel], &amp;flag, 1, MPI_UNSIGNED, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  903</span>    <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>[iel] = flag;</div>
<div class="line"><span class="lineno">  904</span>  }</div>
<div class="line"><span class="lineno">  905</span> </div>
<div class="line"><span class="lineno">  906</span>  <span class="comment">//BEGIN TO REMOVE (use with serial)</span></div>
<div class="line"><span class="lineno">  907</span><span class="comment">//   for (unsigned iel = 0; iel &lt; numberOfElements; iel++) {</span></div>
<div class="line"><span class="lineno">  908</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  909</span><span class="comment">//     unsigned xMinDof  = msh-&gt;GetSolutionDof (0, iel, xType);</span></div>
<div class="line"><span class="lineno">  910</span><span class="comment">//     unsigned xMaxDof  = msh-&gt;GetSolutionDof (1, iel, xType);</span></div>
<div class="line"><span class="lineno">  911</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  912</span><span class="comment">//     double xMin = (*msh-&gt;_topology-&gt;_Sol[0]) (xMinDof);</span></div>
<div class="line"><span class="lineno">  913</span><span class="comment">//     double xMax = (*msh-&gt;_topology-&gt;_Sol[0]) (xMaxDof);</span></div>
<div class="line"><span class="lineno">  914</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  915</span><span class="comment">//     std::cout &lt;&lt; xMin &lt;&lt; &quot; , &quot; &lt;&lt; xMax &lt;&lt; &quot; , &quot; &lt;&lt; &quot;flag = &quot; &lt;&lt; elementSkipFlags[iel] &lt;&lt; std::endl ;</span></div>
<div class="line"><span class="lineno">  916</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  917</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  918</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  919</span>  <span class="comment">//END TO REMOVE</span></div>
<div class="line"><span class="lineno">  920</span> </div>
<div class="line"><span class="lineno">  921</span>}</div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ab5bcfd4be738d47ae025a06eddc66f61"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">femus::Mesh::GetNumberOfElements</a></div><div class="ttdeci">unsigned GetNumberOfElements() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00099">Mesh.hpp:99</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00162">Mesh.hpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a89a77678df230dce7f2dd2ff171c71b4"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">femus::MultiLevelMesh::GetNumberOfLevels</a></div><div class="ttdeci">unsigned GetNumberOfLevels()</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00157">MultiLevelMesh.hpp:157</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_af6629fca51be192be664c76eb8aecc79"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">femus::ParallelObject::n_processors</a></div><div class="ttdeci">int n_processors() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00048">ParallelObject.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a5d5a5a4dc9a9129e4d48694eccc32b06"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d5a5a4dc9a9129e4d48694eccc32b06">numberOfElements</a></div><div class="ttdeci">unsigned numberOfElements</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00035">nonlocal_assembly.hpp:35</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a6187056a485ddd3e3f6f0ea19c54f7a0"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; elementSkipFlags</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00046">nonlocal_assembly.hpp:46</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0adefeff8794d51147e5c97d56baf714" name="a0adefeff8794d51147e5c97d56baf714"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0adefeff8794d51147e5c97d56baf714">&#9670;&#160;</a></span>GetL2Norm()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetL2Norm </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>mlSol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>mlSolFine</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00295">295</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  295</span>                                                                            {</div>
<div class="line"><span class="lineno">  296</span> </div>
<div class="line"><span class="lineno">  297</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  298</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* msh = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> (level);</div>
<div class="line"><span class="lineno">  299</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>* sol  = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a> (level);</div>
<div class="line"><span class="lineno">  300</span> </div>
<div class="line"><span class="lineno">  301</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> levelFine = mlSolFine.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  302</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* mshFine = mlSolFine.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> (levelFine);</div>
<div class="line"><span class="lineno">  303</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>* solFine  = mlSolFine.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a> (levelFine);</div>
<div class="line"><span class="lineno">  304</span> </div>
<div class="line"><span class="lineno">  305</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  306</span> </div>
<div class="line"><span class="lineno">  307</span>  <span class="keywordtype">unsigned</span> xType = 2; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE QUADRATIC)</span></div>
<div class="line"><span class="lineno">  308</span> </div>
<div class="line"><span class="lineno">  309</span>  <span class="keywordtype">double</span> error_solExact_norm2 = 0.;</div>
<div class="line"><span class="lineno">  310</span> </div>
<div class="line"><span class="lineno">  311</span>  <span class="keywordtype">double</span> error_solExact_local_norm2 = 0.;</div>
<div class="line"><span class="lineno">  312</span> </div>
<div class="line"><span class="lineno">  313</span>  <span class="keywordtype">double</span> error_solLocal_norm2 = 0.;</div>
<div class="line"><span class="lineno">  314</span> </div>
<div class="line"><span class="lineno">  315</span>  <span class="keywordtype">double</span> error_NonLocCoarse_NonLocFine_norm2 = 0.;</div>
<div class="line"><span class="lineno">  316</span> </div>
<div class="line"><span class="lineno">  317</span>  <span class="keywordtype">double</span> solNonlocal_norm2 = 0.;</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>  <span class="keywordtype">double</span> solNonlocalFine_norm2 = 0.;</div>
<div class="line"><span class="lineno">  320</span> </div>
<div class="line"><span class="lineno">  321</span>  <span class="keywordtype">double</span> solLocal_norm2 = 0.;</div>
<div class="line"><span class="lineno">  322</span> </div>
<div class="line"><span class="lineno">  323</span>  <span class="keywordtype">double</span> sol_exact_norm2 = 0.;</div>
<div class="line"><span class="lineno">  324</span> </div>
<div class="line"><span class="lineno">  325</span>  <span class="keywordtype">unsigned</span> soluIndex;</div>
<div class="line"><span class="lineno">  326</span>  soluIndex = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> (<span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line"><span class="lineno">  327</span>  <span class="keywordtype">unsigned</span> soluType = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> (soluIndex);</div>
<div class="line"><span class="lineno">  328</span> </div>
<div class="line"><span class="lineno">  329</span>  <span class="keywordtype">unsigned</span> soluIndexLocal;</div>
<div class="line"><span class="lineno">  330</span>  soluIndexLocal = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> (<span class="stringliteral">&quot;u_local&quot;</span>);</div>
<div class="line"><span class="lineno">  331</span> </div>
<div class="line"><span class="lineno">  332</span>  <span class="keywordtype">unsigned</span> soluIndexFine;</div>
<div class="line"><span class="lineno">  333</span>  soluIndexFine = mlSolFine.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> (<span class="stringliteral">&quot;u_fine&quot;</span>);</div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  336</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>();</div>
<div class="line"><span class="lineno">  337</span> </div>
<div class="line"><span class="lineno">  338</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  339</span> </div>
<div class="line"><span class="lineno">  340</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>[iel] == 0) {</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>      <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a> (iel);</div>
<div class="line"><span class="lineno">  343</span>      <span class="keywordtype">unsigned</span> nDofu  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a> (iel, soluType);</div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span>      vector &lt; vector &lt; double &gt; &gt; x1 (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  346</span> </div>
<div class="line"><span class="lineno">  347</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {</div>
<div class="line"><span class="lineno">  348</span>        x1[i].resize (nDofu);</div>
<div class="line"><span class="lineno">  349</span>      }</div>
<div class="line"><span class="lineno">  350</span> </div>
<div class="line"><span class="lineno">  351</span>      vector &lt; double &gt;  soluNonLoc (nDofu);</div>
<div class="line"><span class="lineno">  352</span>      vector &lt; double &gt;  soluLoc (nDofu);</div>
<div class="line"><span class="lineno">  353</span> </div>
<div class="line"><span class="lineno">  354</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  355</span>        <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (i, iel, soluType);</div>
<div class="line"><span class="lineno">  356</span>        soluNonLoc[i] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndex]) (solDof);</div>
<div class="line"><span class="lineno">  357</span>        soluLoc[i] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndexLocal]) (solDof);</div>
<div class="line"><span class="lineno">  358</span>      }</div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  361</span>        <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (i, iel, xType);</div>
<div class="line"><span class="lineno">  362</span> </div>
<div class="line"><span class="lineno">  363</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  364</span>          x1[jdim][i] = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[jdim]) (xDof);</div>
<div class="line"><span class="lineno">  365</span>        }</div>
<div class="line"><span class="lineno">  366</span>      }</div>
<div class="line"><span class="lineno">  367</span> </div>
<div class="line"><span class="lineno">  368</span>      vector &lt;double&gt; <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno">  369</span>      vector &lt;double&gt; phi_x; <span class="comment">// local test function first order partial derivatives</span></div>
<div class="line"><span class="lineno">  370</span>      <span class="keywordtype">double</span> weight; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  371</span> </div>
<div class="line"><span class="lineno">  372</span>      <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno">  373</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>(); <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  374</span>        <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno">  375</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a> (x1, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno">  376</span>        <span class="keywordtype">double</span> soluNonLoc_gss = 0.;</div>
<div class="line"><span class="lineno">  377</span>        <span class="keywordtype">double</span> soluLoc_gss = 0.;</div>
<div class="line"><span class="lineno">  378</span>        <span class="keywordtype">double</span> soluExact_gss = 0.;</div>
<div class="line"><span class="lineno">  379</span>        <span class="keywordtype">double</span> x_gss = 0.;</div>
<div class="line"><span class="lineno">  380</span> </div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofu; i++) {</div>
<div class="line"><span class="lineno">  383</span>          soluNonLoc_gss += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * soluNonLoc[i];</div>
<div class="line"><span class="lineno">  384</span>          soluLoc_gss += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * soluLoc[i];</div>
<div class="line"><span class="lineno">  385</span>          x_gss += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * x1[0][i]; <span class="comment">// this is x at the Gauss point</span></div>
<div class="line"><span class="lineno">  386</span> </div>
<div class="line"><span class="lineno">  387</span>        }</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span>        <span class="keywordtype">double</span> u1 = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d015a3751aec61f2442b957cb6f517a">a1</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a84e4813f421c80250583ae23e3f4f100">b1</a> * x_gss - 1. / (2. * <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6f666e9bb67f39191f9f969af23ebe70">kappa1</a>) * x_gss * x_gss;</div>
<div class="line"><span class="lineno">  390</span>        <span class="keywordtype">double</span> u2 = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a35d10c1e721e67a3616511e45aa89f34">b2</a> * x_gss - 1. / (2. * <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a0c5c57a31dd2eeb3ae1db16a86fd0053">kappa2</a>) * x_gss * x_gss;</div>
<div class="line"><span class="lineno">  391</span> </div>
<div class="line"><span class="lineno">  392</span>        soluExact_gss = (x_gss &lt; 0.) ? u1 : u2;</div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span> </div>
<div class="line"><span class="lineno">  395</span><span class="comment">//       soluExact_gss = soluExact_gss * soluExact_gss * soluExact_gss * soluExact_gss + 0.1 * soluExact_gss * soluExact_gss; // this is x^4 + delta * x^2</span></div>
<div class="line"><span class="lineno">  396</span> </div>
<div class="line"><span class="lineno">  397</span><span class="comment">//       soluExact_gss = soluExact_gss * soluExact_gss; // this is x^2</span></div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span><span class="comment">//       soluExact_gss = soluExact_gss * soluExact_gss * soluExact_gss; // this is x^3</span></div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span><span class="comment">//       soluExact_gss = soluExact_gss * soluExact_gss * soluExact_gss * soluExact_gss; // this is x^4</span></div>
<div class="line"><span class="lineno">  402</span> </div>
<div class="line"><span class="lineno">  403</span><span class="comment">//       soluExact_gss = 2 * soluExact_gss  + soluExact_gss * soluExact_gss * soluExact_gss * soluExact_gss * soluExact_gss ; // this is 2x + x^5</span></div>
<div class="line"><span class="lineno">  404</span> </div>
<div class="line"><span class="lineno">  405</span>        error_solExact_norm2 += (soluNonLoc_gss - soluExact_gss) * (soluNonLoc_gss - soluExact_gss) * weight;</div>
<div class="line"><span class="lineno">  406</span> </div>
<div class="line"><span class="lineno">  407</span>        error_solExact_local_norm2 += (soluLoc_gss - soluExact_gss) * (soluLoc_gss - soluExact_gss) * weight;</div>
<div class="line"><span class="lineno">  408</span> </div>
<div class="line"><span class="lineno">  409</span>        error_solLocal_norm2 += (soluNonLoc_gss - soluLoc_gss) * (soluNonLoc_gss - soluLoc_gss) * weight;</div>
<div class="line"><span class="lineno">  410</span> </div>
<div class="line"><span class="lineno">  411</span>        solNonlocal_norm2 += soluNonLoc_gss * soluNonLoc_gss * weight;</div>
<div class="line"><span class="lineno">  412</span> </div>
<div class="line"><span class="lineno">  413</span>        solLocal_norm2 += soluLoc_gss * soluLoc_gss * weight;</div>
<div class="line"><span class="lineno">  414</span> </div>
<div class="line"><span class="lineno">  415</span>        sol_exact_norm2 += soluExact_gss * soluExact_gss * weight;</div>
<div class="line"><span class="lineno">  416</span>      }</div>
<div class="line"><span class="lineno">  417</span>    }</div>
<div class="line"><span class="lineno">  418</span>  }</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordtype">double</span> norm2 = 0.;</div>
<div class="line"><span class="lineno">  421</span>  MPI_Allreduce (&amp;error_solExact_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  422</span>  <span class="keywordtype">double</span> norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  423</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  424</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of ERROR: Nonlocal - exact = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  425</span> </div>
<div class="line"><span class="lineno">  426</span>  norm2 = 0.;</div>
<div class="line"><span class="lineno">  427</span>  MPI_Allreduce (&amp;error_solExact_local_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  428</span>  norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  429</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  430</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of ERROR: Local - exact = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  431</span> </div>
<div class="line"><span class="lineno">  432</span>  norm2 = 0.;</div>
<div class="line"><span class="lineno">  433</span>  MPI_Allreduce (&amp;error_solLocal_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  434</span>  norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  435</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  436</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of ERROR: Nonlocal - local = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  437</span> </div>
<div class="line"><span class="lineno">  438</span>  norm2 = 0.;</div>
<div class="line"><span class="lineno">  439</span>  MPI_Allreduce (&amp;solNonlocal_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  440</span>  norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  441</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  442</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of NONLOCAL soln = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span>  norm2 = 0.;</div>
<div class="line"><span class="lineno">  445</span>  MPI_Allreduce (&amp;solLocal_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  446</span>  norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  447</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  448</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of LOCAL soln = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  449</span> </div>
<div class="line"><span class="lineno">  450</span>  norm2 = 0.;</div>
<div class="line"><span class="lineno">  451</span>  MPI_Allreduce (&amp;sol_exact_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  452</span>  norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  453</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  454</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of EXACT soln = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  455</span> </div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>  <span class="comment">//BEGIN computation of the l2 and linfinity norms</span></div>
<div class="line"><span class="lineno">  458</span> </div>
<div class="line"><span class="lineno">  459</span><span class="comment">//   double littleL2norm = 0.;</span></div>
<div class="line"><span class="lineno">  460</span><span class="comment">//   std::vector&lt;double&gt; littleLInfinitynorm (nprocs, 0.);</span></div>
<div class="line"><span class="lineno">  461</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  462</span><span class="comment">//   for (unsigned i =  msh-&gt;_dofOffset[soluType][iproc]; i &lt;  msh-&gt;_dofOffset[soluType][iproc + 1]; i++) {</span></div>
<div class="line"><span class="lineno">  463</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  464</span><span class="comment">//     double nonLocalNodalValue = (*sol-&gt;_Sol[soluIndex]) (i);</span></div>
<div class="line"><span class="lineno">  465</span><span class="comment">//     double LocalNodalValue = (*sol-&gt;_Sol[soluIndexLocal]) (i);</span></div>
<div class="line"><span class="lineno">  466</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  467</span><span class="comment">//     double difference = fabs (nonLocalNodalValue - LocalNodalValue);</span></div>
<div class="line"><span class="lineno">  468</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  469</span><span class="comment">//     if (difference &gt; littleLInfinitynorm[iproc]) littleLInfinitynorm[iproc] = difference;</span></div>
<div class="line"><span class="lineno">  470</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  471</span><span class="comment">//     littleL2norm += difference * difference;</span></div>
<div class="line"><span class="lineno">  472</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  473</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  474</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  475</span><span class="comment">//   norm2 = 0.;</span></div>
<div class="line"><span class="lineno">  476</span><span class="comment">//   MPI_Allreduce (&amp;littleL2norm, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</span></div>
<div class="line"><span class="lineno">  477</span><span class="comment">//   norm = sqrt (norm2);</span></div>
<div class="line"><span class="lineno">  478</span><span class="comment">//   std::cout.precision (16);</span></div>
<div class="line"><span class="lineno">  479</span><span class="comment">//   std::cout &lt;&lt; &quot;l2 norm of ERROR: Nonlocal - local = &quot; &lt;&lt; norm &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  480</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  481</span><span class="comment">//   for (int kproc = 0; kproc &lt; nprocs; kproc++) {</span></div>
<div class="line"><span class="lineno">  482</span><span class="comment">//     MPI_Bcast (&amp;littleLInfinitynorm[iproc], 1, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</span></div>
<div class="line"><span class="lineno">  483</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  484</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  485</span><span class="comment">//   double littleLInfinityNorm = littleLInfinitynorm[0];</span></div>
<div class="line"><span class="lineno">  486</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  487</span><span class="comment">//   for (unsigned kproc = 0; kproc &lt; nprocs; kproc++) {</span></div>
<div class="line"><span class="lineno">  488</span><span class="comment">//     if (littleLInfinitynorm[kproc] &gt; littleLInfinityNorm) littleLInfinityNorm = littleLInfinitynorm[kproc];</span></div>
<div class="line"><span class="lineno">  489</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  490</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  491</span><span class="comment">//   std::cout.precision (16);</span></div>
<div class="line"><span class="lineno">  492</span><span class="comment">//   std::cout &lt;&lt; &quot;linfinity norm of ERROR: Nonlocal - local = &quot; &lt;&lt; littleLInfinityNorm &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  493</span> </div>
<div class="line"><span class="lineno">  494</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  495</span> </div>
<div class="line"><span class="lineno">  496</span>  <span class="comment">//BEGIN nonlocal fine - coarse L2 norm on fine grid</span></div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------- &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  <span class="keywordtype">unsigned</span>    iprocFine = mshFine-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  501</span> </div>
<div class="line"><span class="lineno">  502</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ielFine = solFine-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iprocFine]; ielFine &lt; solFine-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iprocFine + 1]; ielFine ++) {</div>
<div class="line"><span class="lineno">  503</span> </div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a026ab0a0315d23dcd42fc919eef102ea">elementSkipFlagsFine</a>[ielFine] == 0) {</div>
<div class="line"><span class="lineno">  505</span> </div>
<div class="line"><span class="lineno">  506</span>      <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielFineGeom = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a> (ielFine);</div>
<div class="line"><span class="lineno">  507</span>      <span class="keywordtype">unsigned</span> nDofFine  = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a> (ielFine, soluType);</div>
<div class="line"><span class="lineno">  508</span> </div>
<div class="line"><span class="lineno">  509</span>      vector &lt; double &gt;  soluNonLocFine (nDofFine);</div>
<div class="line"><span class="lineno">  510</span> </div>
<div class="line"><span class="lineno">  511</span>      std::vector &lt; std::vector &lt;double&gt; &gt; xFine (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  512</span> </div>
<div class="line"><span class="lineno">  513</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  514</span>        xFine[k].assign (nDofFine, 0.);</div>
<div class="line"><span class="lineno">  515</span>      }</div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofFine; i++) {</div>
<div class="line"><span class="lineno">  518</span>        <span class="keywordtype">unsigned</span> solDof = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (i, ielFine, soluType);</div>
<div class="line"><span class="lineno">  519</span>        soluNonLocFine[i] = (*solFine-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndexFine]) (solDof);</div>
<div class="line"><span class="lineno">  520</span>      }</div>
<div class="line"><span class="lineno">  521</span> </div>
<div class="line"><span class="lineno">  522</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofFine; i++) {</div>
<div class="line"><span class="lineno">  523</span>        <span class="keywordtype">unsigned</span> xDof  = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (i, ielFine, xType);</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  526</span>          xFine[jdim][i] = (*mshFine-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[jdim]) (xDof);</div>
<div class="line"><span class="lineno">  527</span>        }</div>
<div class="line"><span class="lineno">  528</span>      }</div>
<div class="line"><span class="lineno">  529</span> </div>
<div class="line"><span class="lineno">  530</span>      vector &lt;double&gt; <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno">  531</span>      vector &lt;double&gt; phi_x; <span class="comment">// local test function first order partial derivatives</span></div>
<div class="line"><span class="lineno">  532</span>      <span class="keywordtype">double</span> weight; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>      <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno">  535</span>      <span class="keywordtype">unsigned</span> igNumber = mshFine-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielFineGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>();</div>
<div class="line"><span class="lineno">  536</span><span class="comment">//     unsigned igNumber = femQuadrature-&gt;GetGaussPointNumber();</span></div>
<div class="line"><span class="lineno">  537</span> </div>
<div class="line"><span class="lineno">  538</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; igNumber; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno">  539</span>        <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno">  540</span>        mshFine-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielFineGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a> (xFine, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno">  541</span><span class="comment">//       femQuadrature-&gt;Jacobian (xFine, ig, weight, phi, phi_x);</span></div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>        <span class="keywordtype">double</span> soluNonLocCoarse_gss = 0.;</div>
<div class="line"><span class="lineno">  544</span>        <span class="keywordtype">double</span> soluNonLocFine_gss = 0.;</div>
<div class="line"><span class="lineno">  545</span>        <span class="keywordtype">double</span> x_gss_fine = 0.;</div>
<div class="line"><span class="lineno">  546</span> </div>
<div class="line"><span class="lineno">  547</span> </div>
<div class="line"><span class="lineno">  548</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofFine; i++) {</div>
<div class="line"><span class="lineno">  549</span>          soluNonLocFine_gss += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * soluNonLocFine[i];</div>
<div class="line"><span class="lineno">  550</span>          x_gss_fine += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * xFine[0][i]; <span class="comment">// this is x at the Gauss point</span></div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>        }</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>        <span class="comment">//BEGIN computation of the coarse solution at the fine Gauss point</span></div>
<div class="line"><span class="lineno">  555</span> </div>
<div class="line"><span class="lineno">  556</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ielCoarse = sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; ielCoarse &lt; sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; ielCoarse++) {</div>
<div class="line"><span class="lineno">  557</span> </div>
<div class="line"><span class="lineno">  558</span>          <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>[ielCoarse] == 0) {</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>            <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeomCoarse = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a> (ielCoarse);</div>
<div class="line"><span class="lineno">  561</span>            <span class="keywordtype">unsigned</span> nDofCoarse  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a> (ielCoarse, soluType);</div>
<div class="line"><span class="lineno">  562</span> </div>
<div class="line"><span class="lineno">  563</span>            vector &lt; double &gt;  soluNonLocCoarse (nDofCoarse);</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>            std::vector &lt; std::vector &lt;double&gt; &gt; xCoarse (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  566</span> </div>
<div class="line"><span class="lineno">  567</span>            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  568</span>              xCoarse[k].assign (nDofCoarse, 0.);</div>
<div class="line"><span class="lineno">  569</span>            }</div>
<div class="line"><span class="lineno">  570</span> </div>
<div class="line"><span class="lineno">  571</span>            <span class="keywordtype">unsigned</span>  xLeftDof = sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (0, ielCoarse, 2);</div>
<div class="line"><span class="lineno">  572</span>            <span class="keywordtype">unsigned</span>  xRightDof = sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (1, ielCoarse, 2);</div>
<div class="line"><span class="lineno">  573</span> </div>
<div class="line"><span class="lineno">  574</span>            xCoarse[0][0] = (*sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xLeftDof);</div>
<div class="line"><span class="lineno">  575</span>            xCoarse[0][1] = (*sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xRightDof);</div>
<div class="line"><span class="lineno">  576</span> </div>
<div class="line"><span class="lineno">  577</span>            <span class="keywordflow">if</span> ( (x_gss_fine &gt; xCoarse[0][0] &amp;&amp; x_gss_fine &lt; xCoarse[0][1]) || fabs (x_gss_fine - xCoarse[0][0]) &lt; 1.e-10 || fabs (x_gss_fine - xCoarse[0][1]) &lt; 1.e-10) {</div>
<div class="line"><span class="lineno">  578</span> </div>
<div class="line"><span class="lineno">  579</span><span class="comment">//           std::cout.precision (16);</span></div>
<div class="line"><span class="lineno">  580</span><span class="comment">//           std::cout &lt;&lt; &quot;FOUND ----------&gt; &quot; &lt;&lt; xCoarse[0][0] &lt;&lt; &quot; , &quot; &lt;&lt; xCoarse[0][1] &lt;&lt; &quot; , &quot; &lt;&lt; x_gss_fine &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  581</span> </div>
<div class="line"><span class="lineno">  582</span>              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdof = 0; jdof &lt; nDofCoarse; jdof++) {</div>
<div class="line"><span class="lineno">  583</span>                <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (jdof, ielCoarse, soluType);</div>
<div class="line"><span class="lineno">  584</span>                soluNonLocCoarse[jdof] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndex]) (solDof);</div>
<div class="line"><span class="lineno">  585</span>              }</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>              std::vector&lt;double&gt; x_gss_fine_Local (1, 0.);</div>
<div class="line"><span class="lineno">  588</span>              x_gss_fine_Local[0] = - 1. + 2. * (x_gss_fine - xCoarse[0][0]) / (xCoarse[0][1] - xCoarse[0][0]);</div>
<div class="line"><span class="lineno">  589</span> </div>
<div class="line"><span class="lineno">  590</span><span class="comment">//           std::cout &lt;&lt; &quot;=====-------------------==== x_gss_fine_Local[0] = &quot; &lt;&lt; x_gss_fine_Local[0] &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>              vector &lt;double&gt; phi2;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno">  593</span>              vector &lt;double&gt; phi_x2; <span class="comment">// local test function first order partial derivatives</span></div>
<div class="line"><span class="lineno">  594</span>              <span class="keywordtype">double</span> weight2; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno">  595</span>              msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeomCoarse][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a> (xCoarse, x_gss_fine_Local, weight2, phi2, phi_x2);</div>
<div class="line"><span class="lineno">  596</span><span class="comment">//           femQuadrature-&gt;Jacobian (xCoarse, x_gss_fine_Local, weight2, phi2, phi_x2);</span></div>
<div class="line"><span class="lineno">  597</span> </div>
<div class="line"><span class="lineno">  598</span>              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdof = 0; jdof &lt; nDofCoarse; jdof++) {</div>
<div class="line"><span class="lineno">  599</span>                soluNonLocCoarse_gss += soluNonLocCoarse[jdof] * phi2[jdof];</div>
<div class="line"><span class="lineno">  600</span>              }</div>
<div class="line"><span class="lineno">  601</span> </div>
<div class="line"><span class="lineno">  602</span>              <span class="keywordflow">break</span>;</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>            }</div>
<div class="line"><span class="lineno">  605</span> </div>
<div class="line"><span class="lineno">  606</span>          }</div>
<div class="line"><span class="lineno">  607</span> </div>
<div class="line"><span class="lineno">  608</span>        }</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>        <span class="comment">//END computation of the fine solution at the coarse Gauss point</span></div>
<div class="line"><span class="lineno">  611</span> </div>
<div class="line"><span class="lineno">  612</span> </div>
<div class="line"><span class="lineno">  613</span>        error_NonLocCoarse_NonLocFine_norm2 += (soluNonLocCoarse_gss - soluNonLocFine_gss) * (soluNonLocCoarse_gss - soluNonLocFine_gss) * weight;</div>
<div class="line"><span class="lineno">  614</span> </div>
<div class="line"><span class="lineno">  615</span>        solNonlocalFine_norm2 += soluNonLocFine_gss * soluNonLocFine_gss * weight;</div>
<div class="line"><span class="lineno">  616</span> </div>
<div class="line"><span class="lineno">  617</span>      }</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>    }</div>
<div class="line"><span class="lineno">  620</span> </div>
<div class="line"><span class="lineno">  621</span>  }</div>
<div class="line"><span class="lineno">  622</span> </div>
<div class="line"><span class="lineno">  623</span>  norm2 = 0.;</div>
<div class="line"><span class="lineno">  624</span>  MPI_Allreduce (&amp;error_NonLocCoarse_NonLocFine_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  625</span>  norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  626</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  627</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of ERROR: Nonlocal - Nonlocal Fine = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  628</span> </div>
<div class="line"><span class="lineno">  629</span>  norm2 = 0.;</div>
<div class="line"><span class="lineno">  630</span>  MPI_Allreduce (&amp;solNonlocalFine_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  631</span>  norm = sqrt (norm2);</div>
<div class="line"><span class="lineno">  632</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  633</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of NONLOCAL FINE soln = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  636</span> </div>
<div class="line"><span class="lineno">  637</span><span class="comment">//   for (int iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</span></div>
<div class="line"><span class="lineno">  638</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  639</span><span class="comment">//     unsigned xDof = msh-&gt;GetSolutionDof (0, iel, soluType);</span></div>
<div class="line"><span class="lineno">  640</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  641</span><span class="comment">//     double x = (*msh-&gt;_topology-&gt;_Sol[0]) (xDof);</span></div>
<div class="line"><span class="lineno">  642</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  643</span><span class="comment">//     double u = (*sol-&gt;_Sol[soluIndex]) (xDof);</span></div>
<div class="line"><span class="lineno">  644</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  645</span><span class="comment">//     double u_local = (*sol-&gt;_Sol[soluIndexLocal]) (xDof);</span></div>
<div class="line"><span class="lineno">  646</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  647</span><span class="comment">//     double u_exact = x * x ;</span></div>
<div class="line"><span class="lineno">  648</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  649</span><span class="comment">//     std::cout &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; u &lt;&lt; &quot; &quot; &lt;&lt; u_local &lt;&lt; &quot; &quot; &lt;&lt; u_exact &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  650</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  651</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span><span class="comment">//   for (unsigned idof = msh-&gt;_dofOffset[0][iproc]; idof &lt; msh-&gt;_dofOffset[0][iproc + 1]; idof++) {</span></div>
<div class="line"><span class="lineno">  654</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  655</span><span class="comment">//     double x = (*msh-&gt;_topology-&gt;_Sol[0]) (idof);</span></div>
<div class="line"><span class="lineno">  656</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  657</span><span class="comment">//     double u = (*sol-&gt;_Sol[soluIndex]) (idof);</span></div>
<div class="line"><span class="lineno">  658</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  659</span><span class="comment">//     double u_local = (*sol-&gt;_Sol[soluIndexLocal]) (idof);</span></div>
<div class="line"><span class="lineno">  660</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  661</span><span class="comment">//     double u1 = a1 + b1 * x - 1. / (2. * kappa1) * x * x;</span></div>
<div class="line"><span class="lineno">  662</span><span class="comment">//     double u2 = a2 + b2 * x - 1. / (2. * kappa2) * x * x;</span></div>
<div class="line"><span class="lineno">  663</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  664</span><span class="comment">//     double u_exact = (x &lt; 0.) ? u1 : u2;</span></div>
<div class="line"><span class="lineno">  665</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  666</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  667</span><span class="comment">//     std::cout &lt;&lt; x &lt;&lt; &quot; &quot; &lt;&lt; u &lt;&lt; &quot; &quot; &lt;&lt; u_local &lt;&lt; &quot; &quot; &lt;&lt; u_exact &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  668</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  669</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>}</div>
<div class="ttc" id="a_i_s_m_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="a_s_w_2ex2_2ex2_8cpp_html_adae8d8a6ff28515e505bb1c07f2b33c8"><div class="ttname"><a href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a></div><div class="ttdeci">double phi</div><div class="ttdef"><b>Definition</b> <a href="../../de/d25/_s_w_2ex2_2ex2_8cpp_source.html#l00038">ex2.cpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a555c4982e81fc0042426c6741a792ca2"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">femus::Mesh::_finiteElement</a></div><div class="ttdeci">const elem_type * _finiteElement[N_GEOM_ELS][5]</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00321">Mesh.hpp:321</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01222">Mesh.cpp:1222</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01212">Mesh.cpp:1212</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0b3054885210f9a51ebff160e52ec2df"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">femus::MultiLevelSolution::_mlMesh</a></div><div class="ttdeci">MultiLevelMesh * _mlMesh</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00148">MultiLevelSolution.hpp:148</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db0/_multi_level_solution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a531327847462642025f4687af850c7ec"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">femus::Solution::GetMesh</a></div><div class="ttdeci">Mesh * GetMesh()</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00096">Solution.hpp:96</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a3fa8f889f9ae97586b3db574acb4448e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">femus::elem_type::GetGaussPointNumber</a></div><div class="ttdeci">unsigned GetGaussPointNumber() const</div><div class="ttdef"><b>Definition</b> <a href="../../d8/df9/_elem_type_8hpp_source.html#l00208">ElemType.hpp:208</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a026ab0a0315d23dcd42fc919eef102ea"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a026ab0a0315d23dcd42fc919eef102ea">elementSkipFlagsFine</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; elementSkipFlagsFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00047">nonlocal_assembly.hpp:47</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a0c5c57a31dd2eeb3ae1db16a86fd0053"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a0c5c57a31dd2eeb3ae1db16a86fd0053">kappa2</a></div><div class="ttdeci">double kappa2</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00013">nonlocal_assembly.hpp:13</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a35d10c1e721e67a3616511e45aa89f34"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a35d10c1e721e67a3616511e45aa89f34">b2</a></div><div class="ttdeci">double b2</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00062">nonlocal_assembly.hpp:62</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a5d015a3751aec61f2442b957cb6f517a"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d015a3751aec61f2442b957cb6f517a">a1</a></div><div class="ttdeci">double a1</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00059">nonlocal_assembly.hpp:59</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a6f666e9bb67f39191f9f969af23ebe70"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a6f666e9bb67f39191f9f969af23ebe70">kappa1</a></div><div class="ttdeci">double kappa1</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00012">nonlocal_assembly.hpp:12</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a84e4813f421c80250583ae23e3f4f100"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a84e4813f421c80250583ae23e3f4f100">b1</a></div><div class="ttdeci">double b1</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00060">nonlocal_assembly.hpp:60</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_ac55c2d269ed76bd9bdb7fb25f3533a4e"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a></div><div class="ttdeci">double a2</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00061">nonlocal_assembly.hpp:61</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3eda797314ab7e3db22c2bb7661ed247" name="a3eda797314ab7e3db22c2bb7661ed247"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3eda797314ab7e3db22c2bb7661ed247">&#9670;&#160;</a></span>GetL2NormLocalConnectedNonlocalFine()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void GetL2NormLocalConnectedNonlocalFine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>mlSol</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> &amp;&#160;</td>
          <td class="paramname"><em>mlSolFine</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00923">923</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  923</span>                                                                                                      {</div>
<div class="line"><span class="lineno">  924</span> </div>
<div class="line"><span class="lineno">  925</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  926</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* msh = mlSol.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> (level);</div>
<div class="line"><span class="lineno">  927</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>* sol  = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a> (level);</div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> levelFine = mlSolFine.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a89a77678df230dce7f2dd2ff171c71b4">GetNumberOfLevels</a>() - 1;</div>
<div class="line"><span class="lineno">  930</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* mshFine = mlSolFine.<a class="code hl_variable" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0b3054885210f9a51ebff160e52ec2df">_mlMesh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> (levelFine);</div>
<div class="line"><span class="lineno">  931</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>* solFine  = mlSolFine.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a> (levelFine);</div>
<div class="line"><span class="lineno">  932</span> </div>
<div class="line"><span class="lineno">  933</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  934</span> </div>
<div class="line"><span class="lineno">  935</span>  <span class="keywordtype">unsigned</span> xType = 2; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE QUADRATIC)</span></div>
<div class="line"><span class="lineno">  936</span> </div>
<div class="line"><span class="lineno">  937</span>  <span class="keywordtype">unsigned</span> soluIndexLocal;</div>
<div class="line"><span class="lineno">  938</span>  soluIndexLocal = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> (<span class="stringliteral">&quot;u_local&quot;</span>);</div>
<div class="line"><span class="lineno">  939</span>  <span class="keywordtype">unsigned</span> soluType = mlSol.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a> (soluIndexLocal);</div>
<div class="line"><span class="lineno">  940</span> </div>
<div class="line"><span class="lineno">  941</span>  <span class="keywordtype">unsigned</span> soluIndexFine;</div>
<div class="line"><span class="lineno">  942</span>  soluIndexFine = mlSolFine.<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a> (<span class="stringliteral">&quot;u_fine&quot;</span>);</div>
<div class="line"><span class="lineno">  943</span> </div>
<div class="line"><span class="lineno">  944</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  945</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>();</div>
<div class="line"><span class="lineno">  946</span> </div>
<div class="line"><span class="lineno">  947</span>  <span class="keywordtype">double</span> error_Loc_NonLocFine_norm2 = 0.;</div>
<div class="line"><span class="lineno">  948</span> </div>
<div class="line"><span class="lineno">  949</span>  <span class="comment">//BEGIN ||local on connected grid - nonlocal on nonconnected grid||_L2 on nonconnected grid</span></div>
<div class="line"><span class="lineno">  950</span> </div>
<div class="line"><span class="lineno">  951</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;------------------------------------- &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  952</span> </div>
<div class="line"><span class="lineno">  953</span>  <span class="keywordtype">unsigned</span>    iprocFine = mshFine-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  954</span> </div>
<div class="line"><span class="lineno">  955</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> kproc = 0; kproc &lt; nprocs; kproc++) {</div>
<div class="line"><span class="lineno">  956</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ielLocal = sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[kproc]; ielLocal &lt; sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[kproc + 1]; ielLocal++) {</div>
<div class="line"><span class="lineno">  957</span> </div>
<div class="line"><span class="lineno">  958</span>      <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeomLocal;</div>
<div class="line"><span class="lineno">  959</span>      <span class="keywordtype">unsigned</span> nDofLocal;</div>
<div class="line"><span class="lineno">  960</span> </div>
<div class="line"><span class="lineno">  961</span>      <span class="keywordflow">if</span> (iproc == kproc) {</div>
<div class="line"><span class="lineno">  962</span>        ielGeomLocal = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a> (ielLocal);</div>
<div class="line"><span class="lineno">  963</span>        nDofLocal  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a> (ielLocal, soluType);</div>
<div class="line"><span class="lineno">  964</span>      }</div>
<div class="line"><span class="lineno">  965</span> </div>
<div class="line"><span class="lineno">  966</span>      MPI_Bcast (&amp;ielGeomLocal, 1, MPI_UNSIGNED_SHORT, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  967</span>      MPI_Bcast (&amp;nDofLocal, 1, MPI_UNSIGNED, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  968</span> </div>
<div class="line"><span class="lineno">  969</span> </div>
<div class="line"><span class="lineno">  970</span>      std::vector &lt; std::vector &lt;double&gt; &gt; xLocal (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  971</span>      vector &lt; double &gt;  soluLocLocal (nDofLocal);</div>
<div class="line"><span class="lineno">  972</span> </div>
<div class="line"><span class="lineno">  973</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  974</span>        xLocal[k].resize (nDofLocal);</div>
<div class="line"><span class="lineno">  975</span>      }</div>
<div class="line"><span class="lineno">  976</span> </div>
<div class="line"><span class="lineno">  977</span>      <span class="keywordflow">if</span> (iproc == kproc) {</div>
<div class="line"><span class="lineno">  978</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdof = 0; jdof &lt; nDofLocal; jdof++) {</div>
<div class="line"><span class="lineno">  979</span>          <span class="keywordtype">unsigned</span> xDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (jdof, ielLocal, xType);</div>
<div class="line"><span class="lineno">  980</span>          <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (jdof, ielLocal, soluType);</div>
<div class="line"><span class="lineno">  981</span>          soluLocLocal[jdof] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndexLocal]) (solDof);</div>
<div class="line"><span class="lineno">  982</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  983</span>            xLocal[k][jdof] = (*sol-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[k]) (xDof);</div>
<div class="line"><span class="lineno">  984</span>          }</div>
<div class="line"><span class="lineno">  985</span>        }</div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span>        std::vector&lt;int&gt; dofsTemp (nDofLocal);</div>
<div class="line"><span class="lineno">  988</span><span class="comment">//         ReorderElement (dofsTemp, soluLocLocal, xLocal);</span></div>
<div class="line"><span class="lineno">  989</span>      }</div>
<div class="line"><span class="lineno">  990</span> </div>
<div class="line"><span class="lineno">  991</span>      MPI_Bcast (&amp;soluLocLocal[0], nDofLocal, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  992</span> </div>
<div class="line"><span class="lineno">  993</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno">  994</span>        MPI_Bcast (&amp; xLocal[k][0], nDofLocal, MPI_DOUBLE, kproc, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  995</span>      }</div>
<div class="line"><span class="lineno">  996</span> </div>
<div class="line"><span class="lineno">  997</span>      std::vector&lt;double&gt; xMinAndMax (nDofLocal);</div>
<div class="line"><span class="lineno">  998</span>      xMinAndMax.assign (2, 0.);</div>
<div class="line"><span class="lineno">  999</span> </div>
<div class="line"><span class="lineno"> 1000</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofLocal; i++) {</div>
<div class="line"><span class="lineno"> 1001</span>        xMinAndMax[i] = xLocal[0][i];</div>
<div class="line"><span class="lineno"> 1002</span>      }</div>
<div class="line"><span class="lineno"> 1003</span> </div>
<div class="line"><span class="lineno"> 1004</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofLocal; i++) {</div>
<div class="line"><span class="lineno"> 1005</span>        <span class="keywordflow">if</span> (xLocal[0][i] &lt; xMinAndMax[0]) xMinAndMax[0] = xLocal[0][i];</div>
<div class="line"><span class="lineno"> 1006</span> </div>
<div class="line"><span class="lineno"> 1007</span>        <span class="keywordflow">if</span> (xLocal[0][i] &gt; xMinAndMax[1]) xMinAndMax[1] = xLocal[0][i];</div>
<div class="line"><span class="lineno"> 1008</span>      }</div>
<div class="line"><span class="lineno"> 1009</span> </div>
<div class="line"><span class="lineno"> 1010</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ielFine = solFine-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iprocFine]; ielFine &lt; solFine-&gt;<a class="code hl_function" href="../../d4/d40/classfemus_1_1_solution.html#a531327847462642025f4687af850c7ec">GetMesh</a>()-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iprocFine + 1]; ielFine ++) {</div>
<div class="line"><span class="lineno"> 1011</span> </div>
<div class="line"><span class="lineno"> 1012</span>        <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielFineGeom = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a> (ielFine);</div>
<div class="line"><span class="lineno"> 1013</span>        <span class="keywordtype">unsigned</span> nDofFine  = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a> (ielFine, soluType);</div>
<div class="line"><span class="lineno"> 1014</span> </div>
<div class="line"><span class="lineno"> 1015</span>        vector &lt; double &gt;  soluNonLocFine (nDofFine);</div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>        std::vector &lt; std::vector &lt;double&gt; &gt; xFine (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1018</span> </div>
<div class="line"><span class="lineno"> 1019</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> k = 0; k &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1020</span>          xFine[k].assign (nDofFine, 0.);</div>
<div class="line"><span class="lineno"> 1021</span>        }</div>
<div class="line"><span class="lineno"> 1022</span> </div>
<div class="line"><span class="lineno"> 1023</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofFine; i++) {</div>
<div class="line"><span class="lineno"> 1024</span>          <span class="keywordtype">unsigned</span> solDof = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (i, ielFine, soluType);</div>
<div class="line"><span class="lineno"> 1025</span>          soluNonLocFine[i] = (*solFine-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[soluIndexFine]) (solDof);</div>
<div class="line"><span class="lineno"> 1026</span>          <span class="keywordtype">unsigned</span> xDof  = mshFine-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (i, ielFine, xType);</div>
<div class="line"><span class="lineno"> 1027</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno"> 1028</span>            xFine[jdim][i] = (*mshFine-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[jdim]) (xDof);</div>
<div class="line"><span class="lineno"> 1029</span>          }</div>
<div class="line"><span class="lineno"> 1030</span>        }</div>
<div class="line"><span class="lineno"> 1031</span> </div>
<div class="line"><span class="lineno"> 1032</span>        vector &lt;double&gt; <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno"> 1033</span>        vector &lt;double&gt; phi_x; <span class="comment">// local test function first order partial derivatives</span></div>
<div class="line"><span class="lineno"> 1034</span>        <span class="keywordtype">double</span> weight; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno"> 1035</span> </div>
<div class="line"><span class="lineno"> 1036</span>        <span class="keywordtype">unsigned</span> igNumberFine = mshFine-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielFineGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a3fa8f889f9ae97586b3db574acb4448e">GetGaussPointNumber</a>();</div>
<div class="line"><span class="lineno"> 1037</span><span class="comment">//     unsigned igNumberFine = femQuadrature-&gt;GetGaussPointNumber();</span></div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>        <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno"> 1040</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; igNumberFine; <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><span class="lineno"> 1041</span>          <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><span class="lineno"> 1042</span>          mshFine-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielFineGeom][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a> (xFine, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight, <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>, phi_x);</div>
<div class="line"><span class="lineno"> 1043</span><span class="comment">//       femQuadrature-&gt;Jacobian (xFine, ig, weight, phi, phi_x);</span></div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>          <span class="keywordtype">double</span> soluLoc_gss = 0.;</div>
<div class="line"><span class="lineno"> 1046</span>          <span class="keywordtype">double</span> soluNonLocFine_gss = 0.;</div>
<div class="line"><span class="lineno"> 1047</span>          std::vector &lt;double&gt; x_gss_fine (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno"> 1048</span> </div>
<div class="line"><span class="lineno"> 1049</span> </div>
<div class="line"><span class="lineno"> 1050</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofFine; i++) {</div>
<div class="line"><span class="lineno"> 1051</span>            soluNonLocFine_gss += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * soluNonLocFine[i];</div>
<div class="line"><span class="lineno"> 1052</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno"> 1053</span>              x_gss_fine[jdim] += <a class="code hl_variable" href="../../de/d25/_s_w_2ex2_2ex2_8cpp.html#adae8d8a6ff28515e505bb1c07f2b33c8">phi</a>[i] * xFine[jdim][i];</div>
<div class="line"><span class="lineno"> 1054</span>            }</div>
<div class="line"><span class="lineno"> 1055</span>          }</div>
<div class="line"><span class="lineno"> 1056</span> </div>
<div class="line"><span class="lineno"> 1057</span>          <span class="keywordtype">unsigned</span> fineGaussPointInLocalMeshElem = 0;</div>
<div class="line"><span class="lineno"> 1058</span> </div>
<div class="line"><span class="lineno"> 1059</span>          <span class="keywordflow">if</span> ( (x_gss_fine[0] &gt; xMinAndMax[0] &amp;&amp; x_gss_fine[0] &lt; xMinAndMax[1]) || fabs (x_gss_fine[0] - xMinAndMax[0]) &lt; 1.e-10 || fabs (x_gss_fine[0] - xMinAndMax[1]) &lt; 1.e-10) {</div>
<div class="line"><span class="lineno"> 1060</span>            fineGaussPointInLocalMeshElem++;</div>
<div class="line"><span class="lineno"> 1061</span>          }</div>
<div class="line"><span class="lineno"> 1062</span> </div>
<div class="line"><span class="lineno"> 1063</span>          <span class="keywordflow">if</span> (fineGaussPointInLocalMeshElem == <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>) {</div>
<div class="line"><span class="lineno"> 1064</span> </div>
<div class="line"><span class="lineno"> 1065</span> </div>
<div class="line"><span class="lineno"> 1066</span>            std::vector&lt;double&gt; x_gss_fine_Local (<a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><span class="lineno"> 1067</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ii = 0; ii &lt; <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ii++) {</div>
<div class="line"><span class="lineno"> 1068</span>              x_gss_fine_Local[ii] = - 1. + 2. * (x_gss_fine[ii] - xLocal[ii][ii]) / (xLocal[ii][ii + 1] - xLocal[ii][ii]);</div>
<div class="line"><span class="lineno"> 1069</span>            }</div>
<div class="line"><span class="lineno"> 1070</span> </div>
<div class="line"><span class="lineno"> 1071</span>            vector &lt;double&gt; phi2;  <span class="comment">// local test function</span></div>
<div class="line"><span class="lineno"> 1072</span>            vector &lt;double&gt; phi_x2; <span class="comment">// local test function first order partial derivatives</span></div>
<div class="line"><span class="lineno"> 1073</span>            <span class="keywordtype">double</span> weight2; <span class="comment">// gauss point weight</span></div>
<div class="line"><span class="lineno"> 1074</span>            msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeomLocal][soluType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a> (xLocal, x_gss_fine_Local, weight2, phi2, phi_x2);</div>
<div class="line"><span class="lineno"> 1075</span><span class="comment">//           femQuadrature-&gt;Jacobian (xLocal, x_gss_fine_Local, weight2, phi2, phi_x2);</span></div>
<div class="line"><span class="lineno"> 1076</span> </div>
<div class="line"><span class="lineno"> 1077</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdof = 0; jdof &lt; nDofLocal; jdof++) {</div>
<div class="line"><span class="lineno"> 1078</span>              soluLoc_gss += soluLocLocal[jdof] * phi2[jdof];</div>
<div class="line"><span class="lineno"> 1079</span>            }</div>
<div class="line"><span class="lineno"> 1080</span> </div>
<div class="line"><span class="lineno"> 1081</span>            error_Loc_NonLocFine_norm2 += (soluLoc_gss - soluNonLocFine_gss) * (soluLoc_gss - soluNonLocFine_gss) * weight;</div>
<div class="line"><span class="lineno"> 1082</span> </div>
<div class="line"><span class="lineno"> 1083</span>          }</div>
<div class="line"><span class="lineno"> 1084</span>        }</div>
<div class="line"><span class="lineno"> 1085</span>      }</div>
<div class="line"><span class="lineno"> 1086</span> </div>
<div class="line"><span class="lineno"> 1087</span>    }</div>
<div class="line"><span class="lineno"> 1088</span> </div>
<div class="line"><span class="lineno"> 1089</span>  }</div>
<div class="line"><span class="lineno"> 1090</span> </div>
<div class="line"><span class="lineno"> 1091</span>  <span class="keywordtype">double</span> norm2 = 0.;</div>
<div class="line"><span class="lineno"> 1092</span>  MPI_Allreduce (&amp;error_Loc_NonLocFine_norm2, &amp;norm2, 1, MPI_DOUBLE, MPI_SUM, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno"> 1093</span>  <span class="keywordtype">double</span> norm = sqrt (norm2);</div>
<div class="line"><span class="lineno"> 1094</span>  std::cout.precision (14);</div>
<div class="line"><span class="lineno"> 1095</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;L2 norm of ERROR: Local (connected grid) - Nonlocal (nonconnected grid) = &quot;</span> &lt;&lt; norm &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1096</span> </div>
<div class="line"><span class="lineno"> 1097</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno"> 1098</span> </div>
<div class="line"><span class="lineno"> 1099</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4794900b572c7f3529d6a86e64cb1bb4" name="a4794900b572c7f3529d6a86e64cb1bb4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4794900b572c7f3529d6a86e64cb1bb4">&#9670;&#160;</a></span>InitalValueU()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double InitalValueU </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00029">29</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   29</span>                                                    {</div>
<div class="line"><span class="lineno">   30</span> </div>
<div class="line"><span class="lineno">   31</span>  <span class="keywordtype">double</span> u1 = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d015a3751aec61f2442b957cb6f517a">a1</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a84e4813f421c80250583ae23e3f4f100">b1</a> * x[0] - 1. / (2. * <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6f666e9bb67f39191f9f969af23ebe70">kappa1</a>) * x[0] * x[0];</div>
<div class="line"><span class="lineno">   32</span>  <span class="keywordtype">double</span> u2 = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a35d10c1e721e67a3616511e45aa89f34">b2</a> * x[0] - 1. / (2. * <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a0c5c57a31dd2eeb3ae1db16a86fd0053">kappa2</a>) * x[0] * x[0];</div>
<div class="line"><span class="lineno">   33</span> </div>
<div class="line"><span class="lineno">   34</span>  <span class="keywordtype">double</span> value = (x[0] &lt; 0.) ? u1 : u2;</div>
<div class="line"><span class="lineno">   35</span> </div>
<div class="line"><span class="lineno">   36</span><span class="comment">//     return x[0] + 0. * ( 0.51 * 0.51 - x[0] * x[0] ) * ( 0.51 * 0.51 - x[1] * x[1] );</span></div>
<div class="line"><span class="lineno">   37</span><span class="comment">//     return x[0];</span></div>
<div class="line"><span class="lineno">   38</span><span class="comment">//     return x[0] * x[0];</span></div>
<div class="line"><span class="lineno">   39</span><span class="comment">//     return x[0] * x[0] * x[0];</span></div>
<div class="line"><span class="lineno">   40</span><span class="comment">//     return x[0] * x[0] * x[0] * x[0] + 0.1 * x[0] * x[0]; //this is x^4 + delta x^2</span></div>
<div class="line"><span class="lineno">   41</span><span class="comment">//     return x[0] * x[0] * x[0] * x[0]; //this is x^4</span></div>
<div class="line"><span class="lineno">   42</span><span class="comment">//     return 2 * x[0] + x[0] * x[0] * x[0] * x[0] * x[0]; //this is 2x + x^5</span></div>
<div class="line"><span class="lineno">   43</span> </div>
<div class="line"><span class="lineno">   44</span>  <span class="keywordflow">return</span> value;</div>
<div class="line"><span class="lineno">   45</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a3c04138a5bfe5d72780bb7e82a18e627" name="a3c04138a5bfe5d72780bb7e82a18e627"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3c04138a5bfe5d72780bb7e82a18e627">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>argv</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00079">79</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   79</span>                                 {</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  <span class="comment">// init Petsc-MPI communicator</span></div>
<div class="line"><span class="lineno">   82</span>  <a class="code hl_class" href="../../da/d5e/classfemus_1_1_femus_init.html">FemusInit</a> mpinit (argc, argv, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> mlMsh;</div>
<div class="line"><span class="lineno">   85</span>  <span class="keywordtype">double</span> scalingFactor = 1.;</div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordtype">unsigned</span> numberOfSelectiveLevels = 0;</div>
<div class="line"><span class="lineno">   87</span> </div>
<div class="line"><span class="lineno">   88</span>  <span class="comment">//coarse soln mesh</span></div>
<div class="line"><span class="lineno">   89</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ae8f13ffa8e7e349a5ea34f3691dfc303">xMinCoarseBox</a> = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a> - <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a514457b1a7f7e254fcb7a412eeeede54">delta1Mesh</a>;</div>
<div class="line"><span class="lineno">   90</span>  <span class="keywordtype">double</span> <a class="code hl_variable" href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ad5dba520f8dfc464e140bd88aa9fa4f1">xMaxCoarseBox</a> = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#afb570f4be8d359be8e738f725cb8b5f3">delta2Mesh</a>;</div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>  mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d5a5a4dc9a9129e4d48694eccc32b06">numberOfElements</a>, 0, 0, <a class="code hl_variable" href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ae8f13ffa8e7e349a5ea34f3691dfc303">xMinCoarseBox</a>, <a class="code hl_variable" href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ad5dba520f8dfc464e140bd88aa9fa4f1">xMaxCoarseBox</a>, 0., 0., 0., 0., <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a>, <span class="stringliteral">&quot;fifth&quot;</span>);</div>
<div class="line"><span class="lineno">   93</span> </div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a7f0cbb4545e86a21a60670b5f50e5243">doubleIntefaceNode</a>) <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a868f493464e4506415b1f8b6cc492800">PutADoubleNodeAtTheInterface</a> (mlMsh, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#aadaee16034c208f24a56472f7df95ca8">desiredMeshSize</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a>);</div>
<div class="line"><span class="lineno">   95</span> </div>
<div class="line"><span class="lineno">   96</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#af9d0c51d7083cdb1559b2610ac41b515">shiftExternalNodes</a>) <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#aaf9c8cb2738ee78e3c891630faaef46a">ShiftTheExtrema</a> (mlMsh, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#aadaee16034c208f24a56472f7df95ca8">desiredMeshSize</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#aad49095e956c6c9460542240b8de5104">delta1Shift</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ae6d7e00b4db89f0ac554feff2d08fdda">delta2Shift</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a>);</div>
<div class="line"><span class="lineno">   97</span> </div>
<div class="line"><span class="lineno">   98</span><span class="comment">//   mlMsh.RefineMesh (numberOfUniformLevels + numberOfSelectiveLevels, numberOfUniformLevels , NULL);</span></div>
<div class="line"><span class="lineno">   99</span> </div>
<div class="line"><span class="lineno">  100</span>  <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a342565aa59a97f7a10bacd104d65a353">BuildElementSkipFlags</a> (mlMsh, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6187056a485ddd3e3f6f0ea19c54f7a0">elementSkipFlags</a>);</div>
<div class="line"><span class="lineno">  101</span> </div>
<div class="line"><span class="lineno">  102</span>  mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ac474afe18c6be4e181b2bb72695f57e9">EraseCoarseLevels</a> (<a class="code hl_variable" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1);</div>
<div class="line"><span class="lineno">  103</span><span class="comment">//     numberOfUniformLevels = 1;</span></div>
<div class="line"><span class="lineno">  104</span> </div>
<div class="line"><span class="lineno">  105</span>  <span class="comment">//fine soln mesh</span></div>
<div class="line"><span class="lineno">  106</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> mlMshFine;</div>
<div class="line"><span class="lineno">  107</span> </div>
<div class="line"><span class="lineno">  108</span>  <span class="keywordtype">double</span> xMinCoarseBoxFine = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a1f57d0d17ea72937cd7250a9cbf8d30b">leftBoundFine</a> - <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a514457b1a7f7e254fcb7a412eeeede54">delta1Mesh</a>;</div>
<div class="line"><span class="lineno">  109</span>  <span class="keywordtype">double</span> xMaxCoarseBoxFine = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a50936d2baa8c75f748f530ea8b9f1dc2">rightBoundFine</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#afb570f4be8d359be8e738f725cb8b5f3">delta2Mesh</a>;</div>
<div class="line"><span class="lineno">  110</span> </div>
<div class="line"><span class="lineno">  111</span>  mlMshFine.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6636da023a93f538bcc899de26b8f387">numberOfElementsFine</a>, 0, 0, xMinCoarseBoxFine, xMaxCoarseBoxFine, 0., 0., 0., 0., <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a>, <span class="stringliteral">&quot;fifth&quot;</span>);</div>
<div class="line"><span class="lineno">  112</span> </div>
<div class="line"><span class="lineno">  113</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6429101df1895cfea0588fea4e8a933c">doubleIntefaceNodeFine</a>) <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a868f493464e4506415b1f8b6cc492800">PutADoubleNodeAtTheInterface</a> (mlMshFine, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ae287e9c4dbb56188bf2e7752b8035928">desiredMeshSizeFine</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a1f57d0d17ea72937cd7250a9cbf8d30b">leftBoundFine</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a50936d2baa8c75f748f530ea8b9f1dc2">rightBoundFine</a>);</div>
<div class="line"><span class="lineno">  114</span> </div>
<div class="line"><span class="lineno">  115</span>  <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#af9d0c51d7083cdb1559b2610ac41b515">shiftExternalNodes</a>) <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#aaf9c8cb2738ee78e3c891630faaef46a">ShiftTheExtrema</a> (mlMshFine, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ae287e9c4dbb56188bf2e7752b8035928">desiredMeshSizeFine</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a767b67a2724aebbc4af04350f25a8eaa">delta1ShiftFine</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a71a09d2287b3844936bf886ddc3af64f">delta2ShiftFine</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a1f57d0d17ea72937cd7250a9cbf8d30b">leftBoundFine</a>, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a50936d2baa8c75f748f530ea8b9f1dc2">rightBoundFine</a>);</div>
<div class="line"><span class="lineno">  116</span> </div>
<div class="line"><span class="lineno">  117</span><span class="comment">//   mlMshFine.RefineMesh (numberOfUniformLevels + numberOfSelectiveLevels, numberOfUniformLevels , NULL);</span></div>
<div class="line"><span class="lineno">  118</span> </div>
<div class="line"><span class="lineno">  119</span>  <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a342565aa59a97f7a10bacd104d65a353">BuildElementSkipFlags</a> (mlMshFine, <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a026ab0a0315d23dcd42fc919eef102ea">elementSkipFlagsFine</a>);</div>
<div class="line"><span class="lineno">  120</span> </div>
<div class="line"><span class="lineno">  121</span>  mlMshFine.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ac474afe18c6be4e181b2bb72695f57e9">EraseCoarseLevels</a> (<a class="code hl_variable" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1);</div>
<div class="line"><span class="lineno">  122</span><span class="comment">//     numberOfUniformLevels = 1;</span></div>
<div class="line"><span class="lineno">  123</span> </div>
<div class="line"><span class="lineno">  124</span>  <span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../d1/d67/_i_s_m_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();</div>
<div class="line"><span class="lineno">  125</span> </div>
<div class="line"><span class="lineno">  126</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> mlSol (&amp;mlMsh);</div>
<div class="line"><span class="lineno">  127</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a> mlSolFine (&amp;mlMshFine);</div>
<div class="line"><span class="lineno">  128</span> </div>
<div class="line"><span class="lineno">  129</span>  <span class="comment">// add variables to mlSol</span></div>
<div class="line"><span class="lineno">  130</span>  mlSol.AddSolution (<span class="stringliteral">&quot;u&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, 2);</div>
<div class="line"><span class="lineno">  131</span>  mlSolFine.AddSolution (<span class="stringliteral">&quot;u_fine&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, 2);</div>
<div class="line"><span class="lineno">  132</span> </div>
<div class="line"><span class="lineno">  133</span>  mlSol.AddSolution (<span class="stringliteral">&quot;u_local&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, 2);</div>
<div class="line"><span class="lineno">  134</span> </div>
<div class="line"><span class="lineno">  135</span>  mlSol.AddSolution (<span class="stringliteral">&quot;u_exact&quot;</span>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>, <a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>, 2);</div>
<div class="line"><span class="lineno">  136</span> </div>
<div class="line"><span class="lineno">  137</span>  mlSol.Initialize (<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  138</span>  mlSolFine.Initialize (<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  139</span> </div>
<div class="line"><span class="lineno">  140</span>  mlSol.Initialize (<span class="stringliteral">&quot;u_exact&quot;</span>, <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a4794900b572c7f3529d6a86e64cb1bb4">InitalValueU</a>);</div>
<div class="line"><span class="lineno">  141</span> </div>
<div class="line"><span class="lineno">  142</span>  mlSol.AttachSetBoundaryConditionFunction (<a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a>);</div>
<div class="line"><span class="lineno">  143</span>  mlSolFine.AttachSetBoundaryConditionFunction (<a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a>);</div>
<div class="line"><span class="lineno">  144</span> </div>
<div class="line"><span class="lineno">  145</span>  <span class="comment">// ******* Set boundary conditions *******</span></div>
<div class="line"><span class="lineno">  146</span>  mlSol.GenerateBdc (<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  147</span>  mlSolFine.GenerateBdc (<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  148</span> </div>
<div class="line"><span class="lineno">  149</span> </div>
<div class="line"><span class="lineno">  150</span>  <span class="comment">//BEGIN assemble and solve nonlocal problem</span></div>
<div class="line"><span class="lineno">  151</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob (&amp;mlSol);</div>
<div class="line"><span class="lineno">  152</span> </div>
<div class="line"><span class="lineno">  153</span>  <span class="comment">// ******* Add FEM system to the MultiLevel problem *******</span></div>
<div class="line"><span class="lineno">  154</span>  <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&amp; system = ml_prob.add_system &lt; <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a> &gt; (<span class="stringliteral">&quot;NonLocal&quot;</span>);</div>
<div class="line"><span class="lineno">  155</span>  system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a> (<span class="stringliteral">&quot;u&quot;</span>);</div>
<div class="line"><span class="lineno">  156</span> </div>
<div class="line"><span class="lineno">  157</span>  <span class="comment">// ******* System FEM Assembly *******</span></div>
<div class="line"><span class="lineno">  158</span>  system.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a> (<a class="code hl_function" href="../../d0/d15/nonlocal__assembly_8hpp.html#a240330df07f27f8f05b716c6d597e1dd">AssembleNonLocalSys</a>);</div>
<div class="line"><span class="lineno">  159</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aac52d38a95ff85409abd6e2d92a7c73a">SetMaxNumberOfLinearIterations</a> (1);</div>
<div class="line"><span class="lineno">  160</span>  <span class="comment">// ******* set MG-Solver *******</span></div>
<div class="line"><span class="lineno">  161</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">SetMgType</a> (<a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a>);</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">SetAbsoluteLinearConvergenceTolerance</a> (1.e-50);</div>
<div class="line"><span class="lineno">  164</span>  <span class="comment">//   system.SetNonLinearConvergenceTolerance(1.e-9);</span></div>
<div class="line"><span class="lineno">  165</span><span class="comment">//   system.SetMaxNumberOfNonLinearIterations(20);</span></div>
<div class="line"><span class="lineno">  166</span> </div>
<div class="line"><span class="lineno">  167</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">SetNumberPreSmoothingStep</a> (1);</div>
<div class="line"><span class="lineno">  168</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">SetNumberPostSmoothingStep</a> (1);</div>
<div class="line"><span class="lineno">  169</span> </div>
<div class="line"><span class="lineno">  170</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">SetLinearEquationSolverType</a> ( <a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a> );</div>
<div class="line"><span class="lineno">  171</span> </div>
<div class="line"><span class="lineno">  172</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a7ce98d965ba0ccc8fe4c103052a04e6c">SetSparsityPatternMinimumSize</a> (10000u);   <span class="comment">//TODO tune was 500</span></div>
<div class="line"><span class="lineno">  173</span> </div>
<div class="line"><span class="lineno">  174</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4605bac9ea670bb7dbd4454358155670">init</a>();</div>
<div class="line"><span class="lineno">  175</span> </div>
<div class="line"><span class="lineno">  176</span>  <span class="comment">// ******* Set Smoother *******</span></div>
<div class="line"><span class="lineno">  177</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">SetSolverFineGrids</a> (<a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>);</div>
<div class="line"><span class="lineno">  178</span> </div>
<div class="line"><span class="lineno">  179</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">SetPreconditionerFineGrids</a> (<a class="code hl_enumvalue" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a>);</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">SetTolerances</a> (1.e-20, 1.e-20, 1.e+50, 100);</div>
<div class="line"><span class="lineno">  182</span> </div>
<div class="line"><span class="lineno">  183</span><span class="comment">// ******* Solution *******</span></div>
<div class="line"><span class="lineno">  184</span> </div>
<div class="line"><span class="lineno">  185</span>  system.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a68382fae5355ec80f88f0dca96086d51">MGsolve</a>(); <span class="comment">//TODO</span></div>
<div class="line"><span class="lineno">  186</span> </div>
<div class="line"><span class="lineno">  187</span>  <span class="comment">//END assemble and solve nonlocal problem</span></div>
<div class="line"><span class="lineno">  188</span> </div>
<div class="line"><span class="lineno">  189</span>  <span class="comment">//BEGIN assemble and solve local problem</span></div>
<div class="line"><span class="lineno">  190</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob2 (&amp;mlSol);</div>
<div class="line"><span class="lineno">  191</span> </div>
<div class="line"><span class="lineno">  192</span>  <span class="comment">// ******* Add FEM system to the MultiLevel problem *******</span></div>
<div class="line"><span class="lineno">  193</span>  <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&amp; system2 = ml_prob2.add_system &lt; <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a> &gt; (<span class="stringliteral">&quot;Local&quot;</span>);</div>
<div class="line"><span class="lineno">  194</span>  system2.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a> (<span class="stringliteral">&quot;u_local&quot;</span>);</div>
<div class="line"><span class="lineno">  195</span> </div>
<div class="line"><span class="lineno">  196</span>  <span class="comment">// ******* System FEM Assembly *******</span></div>
<div class="line"><span class="lineno">  197</span>  system2.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a> (<a class="code hl_function" href="../../d0/d15/nonlocal__assembly_8hpp.html#a33077af2bdb10181d40b9caf6e4b648d">AssembleLocalSys</a>);</div>
<div class="line"><span class="lineno">  198</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aac52d38a95ff85409abd6e2d92a7c73a">SetMaxNumberOfLinearIterations</a> (1);</div>
<div class="line"><span class="lineno">  199</span>  <span class="comment">// ******* set MG-Solver *******</span></div>
<div class="line"><span class="lineno">  200</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">SetMgType</a> (<a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a>);</div>
<div class="line"><span class="lineno">  201</span> </div>
<div class="line"><span class="lineno">  202</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">SetAbsoluteLinearConvergenceTolerance</a> (1.e-50);</div>
<div class="line"><span class="lineno">  203</span> </div>
<div class="line"><span class="lineno">  204</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">SetNumberPreSmoothingStep</a> (1);</div>
<div class="line"><span class="lineno">  205</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">SetNumberPostSmoothingStep</a> (1);</div>
<div class="line"><span class="lineno">  206</span> </div>
<div class="line"><span class="lineno">  207</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">SetLinearEquationSolverType</a> ( <a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a> );</div>
<div class="line"><span class="lineno">  208</span> </div>
<div class="line"><span class="lineno">  209</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4605bac9ea670bb7dbd4454358155670">init</a>();</div>
<div class="line"><span class="lineno">  210</span> </div>
<div class="line"><span class="lineno">  211</span>  <span class="comment">// ******* Set Smoother *******</span></div>
<div class="line"><span class="lineno">  212</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">SetSolverFineGrids</a> (<a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>);</div>
<div class="line"><span class="lineno">  213</span> </div>
<div class="line"><span class="lineno">  214</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">SetPreconditionerFineGrids</a> (<a class="code hl_enumvalue" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a>);</div>
<div class="line"><span class="lineno">  215</span> </div>
<div class="line"><span class="lineno">  216</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">SetTolerances</a> (1.e-20, 1.e-20, 1.e+50, 100);</div>
<div class="line"><span class="lineno">  217</span> </div>
<div class="line"><span class="lineno">  218</span><span class="comment">// ******* Solution *******</span></div>
<div class="line"><span class="lineno">  219</span> </div>
<div class="line"><span class="lineno">  220</span>  system2.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a68382fae5355ec80f88f0dca96086d51">MGsolve</a>();</div>
<div class="line"><span class="lineno">  221</span> </div>
<div class="line"><span class="lineno">  222</span>  <span class="comment">//END assemble and solve local problem</span></div>
<div class="line"><span class="lineno">  223</span> </div>
<div class="line"><span class="lineno">  224</span>  <span class="comment">//BEGIN assemble and solve fine nonlocal problem</span></div>
<div class="line"><span class="lineno">  225</span>  <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_probFine (&amp;mlSolFine);</div>
<div class="line"><span class="lineno">  226</span> </div>
<div class="line"><span class="lineno">  227</span>  <span class="comment">// ******* Add FEM system to the MultiLevel problem *******</span></div>
<div class="line"><span class="lineno">  228</span>  <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a>&amp; systemFine = ml_probFine.add_system &lt; <a class="code hl_class" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">LinearImplicitSystem</a> &gt; (<span class="stringliteral">&quot;NonLocalFine&quot;</span>);</div>
<div class="line"><span class="lineno">  229</span>  systemFine.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a> (<span class="stringliteral">&quot;u_fine&quot;</span>);</div>
<div class="line"><span class="lineno">  230</span> </div>
<div class="line"><span class="lineno">  231</span>  <span class="comment">// ******* System FEM Assembly *******</span></div>
<div class="line"><span class="lineno">  232</span>  systemFine.<a class="code hl_function" href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a> (<a class="code hl_function" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6b04d073f03fdd85670ebfd69a9aafe2">AssembleNonLocalSysFine</a>);</div>
<div class="line"><span class="lineno">  233</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aac52d38a95ff85409abd6e2d92a7c73a">SetMaxNumberOfLinearIterations</a> (1);</div>
<div class="line"><span class="lineno">  234</span>  <span class="comment">// ******* set MG-Solver *******</span></div>
<div class="line"><span class="lineno">  235</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">SetMgType</a> (<a class="code hl_enumvalue" href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a>);</div>
<div class="line"><span class="lineno">  236</span> </div>
<div class="line"><span class="lineno">  237</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">SetAbsoluteLinearConvergenceTolerance</a> (1.e-50);</div>
<div class="line"><span class="lineno">  238</span> </div>
<div class="line"><span class="lineno">  239</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">SetNumberPreSmoothingStep</a> (1);</div>
<div class="line"><span class="lineno">  240</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">SetNumberPostSmoothingStep</a> (1);</div>
<div class="line"><span class="lineno">  241</span> </div>
<div class="line"><span class="lineno">  242</span>  <span class="comment">// ******* Set Preconditioner *******</span></div>
<div class="line"><span class="lineno">  243</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">SetLinearEquationSolverType</a> ( <a class="code hl_enumvalue" href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a> );</div>
<div class="line"><span class="lineno">  244</span> </div>
<div class="line"><span class="lineno">  245</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a7ce98d965ba0ccc8fe4c103052a04e6c">SetSparsityPatternMinimumSize</a> (10000u);   <span class="comment">//TODO tune</span></div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4605bac9ea670bb7dbd4454358155670">init</a>();</div>
<div class="line"><span class="lineno">  248</span> </div>
<div class="line"><span class="lineno">  249</span>  <span class="comment">// ******* Set Smoother *******</span></div>
<div class="line"><span class="lineno">  250</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">SetSolverFineGrids</a> (<a class="code hl_enumvalue" href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a>);</div>
<div class="line"><span class="lineno">  251</span> </div>
<div class="line"><span class="lineno">  252</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">SetPreconditionerFineGrids</a> (<a class="code hl_enumvalue" href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a>);</div>
<div class="line"><span class="lineno">  253</span> </div>
<div class="line"><span class="lineno">  254</span>  systemFine.<a class="code hl_function" href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">SetTolerances</a> (1.e-20, 1.e-20, 1.e+50, 100);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span><span class="comment">// ******* Solution *******</span></div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span><span class="comment">//   systemFine.MGsolve();  //TODO uncomment</span></div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>  <span class="comment">//END assemble and solve fine nonlocal problem</span></div>
<div class="line"><span class="lineno">  261</span> </div>
<div class="line"><span class="lineno">  262</span> </div>
<div class="line"><span class="lineno">  263</span>  clock_t L2norm_time = clock();</div>
<div class="line"><span class="lineno">  264</span> </div>
<div class="line"><span class="lineno">  265</span>  <span class="comment">//BEGIN compute errors</span></div>
<div class="line"><span class="lineno">  266</span>  <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0adefeff8794d51147e5c97d56baf714">GetL2Norm</a> (mlSol, mlSolFine);</div>
<div class="line"><span class="lineno">  267</span>  <a class="code hl_function" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a3eda797314ab7e3db22c2bb7661ed247">GetL2NormLocalConnectedNonlocalFine</a> (mlSol, mlSolFine);</div>
<div class="line"><span class="lineno">  268</span>  <span class="comment">//END compute errors</span></div>
<div class="line"><span class="lineno">  269</span> </div>
<div class="line"><span class="lineno">  270</span>  std::cout &lt;&lt; std::endl &lt;&lt; <span class="stringliteral">&quot; L2 norm CPU time : &quot;</span> &lt;&lt; std::setw (11) &lt;&lt; std::setprecision (6) &lt;&lt; std::fixed</div>
<div class="line"><span class="lineno">  271</span>            &lt;&lt; <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> ( (clock() - L2norm_time)) / CLOCKS_PER_SEC &lt;&lt; <span class="stringliteral">&quot; s&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  272</span> </div>
<div class="line"><span class="lineno">  273</span>  <span class="comment">// ******* Print solution *******</span></div>
<div class="line"><span class="lineno">  274</span>  mlSol.SetWriter (<a class="code hl_enumvalue" href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);</div>
<div class="line"><span class="lineno">  275</span>  std::vector&lt;std::string&gt; print_vars;</div>
<div class="line"><span class="lineno">  276</span>  print_vars.push_back (<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  277</span>  mlSol.GetWriter()-&gt;SetDebugOutput (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  278</span>  mlSol.GetWriter()-&gt;Write (<a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;nonlocal_local_exact&quot;</span>, print_vars, 0);</div>
<div class="line"><span class="lineno">  279</span> </div>
<div class="line"><span class="lineno">  280</span>  mlSolFine.SetWriter (<a class="code hl_enumvalue" href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);</div>
<div class="line"><span class="lineno">  281</span>  std::vector&lt;std::string&gt; print_vars2;</div>
<div class="line"><span class="lineno">  282</span>  print_vars2.push_back (<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><span class="lineno">  283</span>  mlSolFine.GetWriter()-&gt;SetDebugOutput (<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  284</span>  mlSolFine.GetWriter()-&gt;Write (<a class="code hl_define" href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a>, <span class="stringliteral">&quot;fine&quot;</span>, print_vars2, 0);</div>
<div class="line"><span class="lineno">  285</span> </div>
<div class="line"><span class="lineno">  286</span>  std::cout.precision (16);</div>
<div class="line"><span class="lineno">  287</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Mesh size h = &quot;</span> &lt;&lt; (<a class="code hl_variable" href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ad5dba520f8dfc464e140bd88aa9fa4f1">xMaxCoarseBox</a> - <a class="code hl_variable" href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ae8f13ffa8e7e349a5ea34f3691dfc303">xMinCoarseBox</a>) / (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d5a5a4dc9a9129e4d48694eccc32b06">numberOfElements</a> * pow (2, <a class="code hl_variable" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1)) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  288</span>  std::cout &lt;&lt; <span class="stringliteral">&quot;Mesh size fine h = &quot;</span> &lt;&lt; (xMaxCoarseBoxFine - xMinCoarseBoxFine) / (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6636da023a93f538bcc899de26b8f387">numberOfElementsFine</a> * pow (2, <a class="code hl_variable" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1)) &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  289</span> </div>
<div class="line"><span class="lineno">  290</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  291</span> </div>
<div class="line"><span class="lineno">  292</span>} <span class="comment">//end main</span></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627a393a8cb5927b22182bbc7546271e0134">EDGE3</a></div><div class="ttdeci">@ EDGE3</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00008">ElemTypeEnum.hpp:8</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="a_femus_default_8hpp_html_af12829f27afb4207fd7c58ef847b9d8b"><div class="ttname"><a href="../../de/df8/_femus_default_8hpp.html#af12829f27afb4207fd7c58ef847b9d8b">DEFAULT_OUTPUTDIR</a></div><div class="ttdeci">#define DEFAULT_OUTPUTDIR</div><div class="ttdef"><b>Definition</b> <a href="../../de/df8/_femus_default_8hpp_source.html#l00040">FemusDefault.hpp:40</a></div></div>
<div class="ttc" id="a_linear_equation_solver_enum_8hpp_html_a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0"><div class="ttname"><a href="../../d2/db5/_linear_equation_solver_enum_8hpp.html#a931bb4cb47bfd614eb33cd0e2b822ef9a1ca9d6f841c98739c7bbfbecffbe12f0">FEMuS_DEFAULT</a></div><div class="ttdeci">@ FEMuS_DEFAULT</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db5/_linear_equation_solver_enum_8hpp_source.html#l00005">LinearEquationSolverEnum.hpp:5</a></div></div>
<div class="ttc" id="a_mg_type_enum_8hpp_html_a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb"><div class="ttname"><a href="../../d5/d41/_mg_type_enum_8hpp.html#a35aafc39068a269f658aac64338aa781a3f9d0f8f4400b01209d16d6bd07058cb">V_CYCLE</a></div><div class="ttdeci">@ V_CYCLE</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d41/_mg_type_enum_8hpp_source.html#l00006">MgTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_a0aca793820b6ff7705450e2043256938"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a></div><div class="ttdeci">unsigned numberOfUniformLevels</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00077">ex1.cpp:77</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_a0adefeff8794d51147e5c97d56baf714"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a0adefeff8794d51147e5c97d56baf714">GetL2Norm</a></div><div class="ttdeci">void GetL2Norm(MultiLevelSolution &amp;mlSol, MultiLevelSolution &amp;mlSolFine)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00295">ex1.cpp:295</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_a342565aa59a97f7a10bacd104d65a353"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a342565aa59a97f7a10bacd104d65a353">BuildElementSkipFlags</a></div><div class="ttdeci">void BuildElementSkipFlags(MultiLevelMesh &amp;mlMsh, std::vector&lt; unsigned &gt; &amp;elementSkipFlags)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00873">ex1.cpp:873</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_a3eda797314ab7e3db22c2bb7661ed247"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a3eda797314ab7e3db22c2bb7661ed247">GetL2NormLocalConnectedNonlocalFine</a></div><div class="ttdeci">void GetL2NormLocalConnectedNonlocalFine(MultiLevelSolution &amp;mlSol, MultiLevelSolution &amp;mlSolFine)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00923">ex1.cpp:923</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_a4794900b572c7f3529d6a86e64cb1bb4"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a4794900b572c7f3529d6a86e64cb1bb4">InitalValueU</a></div><div class="ttdeci">double InitalValueU(const std::vector&lt; double &gt; &amp;x)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00029">ex1.cpp:29</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_a868f493464e4506415b1f8b6cc492800"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#a868f493464e4506415b1f8b6cc492800">PutADoubleNodeAtTheInterface</a></div><div class="ttdeci">void PutADoubleNodeAtTheInterface(MultiLevelMesh &amp;mlMsh, const double &amp;meshSize, double &amp;leftBound, double &amp;rightBound)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00675">ex1.cpp:675</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_aaf9c8cb2738ee78e3c891630faaef46a"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#aaf9c8cb2738ee78e3c891630faaef46a">ShiftTheExtrema</a></div><div class="ttdeci">void ShiftTheExtrema(MultiLevelMesh &amp;mlMsh, const double &amp;meshSize, const double &amp;delta1Shift, const double &amp;delta2Shift, double &amp;leftBound, double &amp;rightBound)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00799">ex1.cpp:799</a></div></div>
<div class="ttc" id="a_non_local_2ex1_2ex1_8cpp_html_ab8b0d45993b678f2b4a8aea9fff7fc87"><div class="ttname"><a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html#ab8b0d45993b678f2b4a8aea9fff7fc87">SetBoundaryCondition</a></div><div class="ttdeci">bool SetBoundaryCondition(const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00057">ex1.cpp:57</a></div></div>
<div class="ttc" id="a_precondtype_enum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea"><div class="ttname"><a href="../../dc/d70/_precondtype_enum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfaf7ac1af5ee2fade15e26febb60feffea">ILU_PRECOND</a></div><div class="ttdeci">@ ILU_PRECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d70/_precondtype_enum_8hpp_source.html#l00016">PrecondtypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_solvertype_enum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2"><div class="ttname"><a href="../../de/dd2/_solvertype_enum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecac8f49d1c89cf479bb8dc2878524b71d2">GMRES</a></div><div class="ttdeci">@ GMRES</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd2/_solvertype_enum_8hpp_source.html#l00016">SolvertypeEnum.hpp:16</a></div></div>
<div class="ttc" id="a_u_q_2ex10_2ex10_8cpp_html_ad5dba520f8dfc464e140bd88aa9fa4f1"><div class="ttname"><a href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ad5dba520f8dfc464e140bd88aa9fa4f1">xMaxCoarseBox</a></div><div class="ttdeci">double xMaxCoarseBox</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp_source.html#l00061">ex10.cpp:61</a></div></div>
<div class="ttc" id="a_u_q_2ex10_2ex10_8cpp_html_ae8f13ffa8e7e349a5ea34f3691dfc303"><div class="ttname"><a href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp.html#ae8f13ffa8e7e349a5ea34f3691dfc303">xMinCoarseBox</a></div><div class="ttdeci">double xMinCoarseBox</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d5f/_u_q_2ex10_2ex10_8cpp_source.html#l00060">ex10.cpp:60</a></div></div>
<div class="ttc" id="a_writer_enum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="../../db/d1c/_writer_enum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition</b> <a href="../../db/d1c/_writer_enum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html">femus::LinearImplicitSystem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00038">LinearImplicitSystem.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a03b082409d094d87e46e023356c4cb8e"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a03b082409d094d87e46e023356c4cb8e">femus::LinearImplicitSystem::SetSolverFineGrids</a></div><div class="ttdeci">void SetSolverFineGrids(const SolverType &amp;solvertype)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l01029">LinearImplicitSystem.cpp:1029</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a3e3ca74a8990338254d7907397402bac"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a3e3ca74a8990338254d7907397402bac">femus::LinearImplicitSystem::SetMgType</a></div><div class="ttdeci">void SetMgType(const MgType mgtype)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00110">LinearImplicitSystem.hpp:110</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a4605bac9ea670bb7dbd4454358155670"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4605bac9ea670bb7dbd4454358155670">femus::LinearImplicitSystem::init</a></div><div class="ttdeci">virtual void init()</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00129">LinearImplicitSystem.cpp:129</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a4c8a469ba9b68aa14c0780f3a7b61d58"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a4c8a469ba9b68aa14c0780f3a7b61d58">femus::LinearImplicitSystem::SetAbsoluteLinearConvergenceTolerance</a></div><div class="ttdeci">void SetAbsoluteLinearConvergenceTolerance(const double &amp;absolute_convergence_tolerance)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00102">LinearImplicitSystem.hpp:102</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a68382fae5355ec80f88f0dca96086d51"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a68382fae5355ec80f88f0dca96086d51">femus::LinearImplicitSystem::MGsolve</a></div><div class="ttdeci">virtual void MGsolve(const MgSmootherType &amp;mgSmootherType=MULTIPLICATIVE)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00275">LinearImplicitSystem.cpp:275</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a7ce98d965ba0ccc8fe4c103052a04e6c"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a7ce98d965ba0ccc8fe4c103052a04e6c">femus::LinearImplicitSystem::SetSparsityPatternMinimumSize</a></div><div class="ttdeci">void SetSparsityPatternMinimumSize(const unsigned &amp;minimumSize, const std::string variableName=&quot;All&quot;)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00114">LinearImplicitSystem.cpp:114</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_a85fc9c2a6bb9b384c298b1d42d2fba59"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#a85fc9c2a6bb9b384c298b1d42d2fba59">femus::LinearImplicitSystem::SetNumberPreSmoothingStep</a></div><div class="ttdeci">void SetNumberPreSmoothingStep(const unsigned &amp;npre)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00204">LinearImplicitSystem.hpp:204</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aac52d38a95ff85409abd6e2d92a7c73a"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aac52d38a95ff85409abd6e2d92a7c73a">femus::LinearImplicitSystem::SetMaxNumberOfLinearIterations</a></div><div class="ttdeci">void SetMaxNumberOfLinearIterations(unsigned int max_lin_it)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00084">LinearImplicitSystem.hpp:84</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aaff342b69e3dd0e77a1bc084030f795c"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aaff342b69e3dd0e77a1bc084030f795c">femus::LinearImplicitSystem::SetPreconditionerFineGrids</a></div><div class="ttdeci">void SetPreconditionerFineGrids(const PreconditionerType &amp;preconditioner_type)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l01047">LinearImplicitSystem.cpp:1047</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_aba6bff678d322a8d98c38360e93dab14"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#aba6bff678d322a8d98c38360e93dab14">femus::LinearImplicitSystem::SetLinearEquationSolverType</a></div><div class="ttdeci">void SetLinearEquationSolverType(const LinearEquationSolverType LinearEquationSolverType, const CoarseLevelInclude &amp;includeCoarseLevel=INCLUDE_COARSE_LEVEL_FALSE)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l00981">LinearImplicitSystem.cpp:981</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_abee928911384fcf422b7df9e89bd192c"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#abee928911384fcf422b7df9e89bd192c">femus::LinearImplicitSystem::SetTolerances</a></div><div class="ttdeci">void SetTolerances(const double &amp;rtol, const double &amp;atol, const double &amp;divtol, const unsigned &amp;maxits, const unsigned &amp;restart=30)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d7e/_linear_implicit_system_8cpp_source.html#l01057">LinearImplicitSystem.cpp:1057</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_implicit_system_html_ac02a64ba83b4d1a33a889a677da875fb"><div class="ttname"><a href="../../d8/d4a/classfemus_1_1_linear_implicit_system.html#ac02a64ba83b4d1a33a889a677da875fb">femus::LinearImplicitSystem::SetNumberPostSmoothingStep</a></div><div class="ttdeci">void SetNumberPostSmoothingStep(const unsigned &amp;npost)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d69/_linear_implicit_system_8hpp_source.html#l00213">LinearImplicitSystem.hpp:213</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a65dabdf1e308c1a44ebe5c6a41d09284"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">femus::MultiLevelMesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00541">MultiLevelMesh.cpp:541</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_ac474afe18c6be4e181b2bb72695f57e9"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ac474afe18c6be4e181b2bb72695f57e9">femus::MultiLevelMesh::EraseCoarseLevels</a></div><div class="ttdeci">void EraseCoarseLevels(unsigned levels_to_be_erased)</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00449">MultiLevelMesh.cpp:449</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a42a5b5b5d2c7673b1d4c896762d8db9e"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a42a5b5b5d2c7673b1d4c896762d8db9e">femus::System::SetAssembleFunction</a></div><div class="ttdeci">void SetAssembleFunction(AssembleFunctionType)</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00058">System.cpp:58</a></div></div>
<div class="ttc" id="aclassfemus_1_1_system_html_a606e07526d7a0d31eed638404ee2ed24"><div class="ttname"><a href="../../d5/dc7/classfemus_1_1_system.html#a606e07526d7a0d31eed638404ee2ed24">femus::System::AddSolutionToSystemPDE</a></div><div class="ttdeci">virtual void AddSolutionToSystemPDE(const char solname[])</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de5/_system_8cpp_source.html#l00075">System.cpp:75</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a1f57d0d17ea72937cd7250a9cbf8d30b"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a1f57d0d17ea72937cd7250a9cbf8d30b">leftBoundFine</a></div><div class="ttdeci">double leftBoundFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00043">nonlocal_assembly.hpp:43</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a240330df07f27f8f05b716c6d597e1dd"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a240330df07f27f8f05b716c6d597e1dd">AssembleNonLocalSys</a></div><div class="ttdeci">void AssembleNonLocalSys(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00091">nonlocal_assembly.hpp:91</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a33077af2bdb10181d40b9caf6e4b648d"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a33077af2bdb10181d40b9caf6e4b648d">AssembleLocalSys</a></div><div class="ttdeci">void AssembleLocalSys(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00512">nonlocal_assembly.hpp:512</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a42395ee6e95ff0d7727efcb3ee223606"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a></div><div class="ttdeci">double leftBound</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00036">nonlocal_assembly.hpp:36</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a50936d2baa8c75f748f530ea8b9f1dc2"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a50936d2baa8c75f748f530ea8b9f1dc2">rightBoundFine</a></div><div class="ttdeci">double rightBoundFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00044">nonlocal_assembly.hpp:44</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a514457b1a7f7e254fcb7a412eeeede54"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a514457b1a7f7e254fcb7a412eeeede54">delta1Mesh</a></div><div class="ttdeci">double delta1Mesh</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00020">nonlocal_assembly.hpp:20</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a6429101df1895cfea0588fea4e8a933c"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a6429101df1895cfea0588fea4e8a933c">doubleIntefaceNodeFine</a></div><div class="ttdeci">bool doubleIntefaceNodeFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00039">nonlocal_assembly.hpp:39</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a6636da023a93f538bcc899de26b8f387"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a6636da023a93f538bcc899de26b8f387">numberOfElementsFine</a></div><div class="ttdeci">unsigned numberOfElementsFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00042">nonlocal_assembly.hpp:42</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a6b04d073f03fdd85670ebfd69a9aafe2"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a6b04d073f03fdd85670ebfd69a9aafe2">AssembleNonLocalSysFine</a></div><div class="ttdeci">void AssembleNonLocalSysFine(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00741">nonlocal_assembly.hpp:741</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a71a09d2287b3844936bf886ddc3af64f"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a71a09d2287b3844936bf886ddc3af64f">delta2ShiftFine</a></div><div class="ttdeci">double delta2ShiftFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00028">nonlocal_assembly.hpp:28</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a767b67a2724aebbc4af04350f25a8eaa"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a767b67a2724aebbc4af04350f25a8eaa">delta1ShiftFine</a></div><div class="ttdeci">double delta1ShiftFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00027">nonlocal_assembly.hpp:27</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a7f0cbb4545e86a21a60670b5f50e5243"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a7f0cbb4545e86a21a60670b5f50e5243">doubleIntefaceNode</a></div><div class="ttdeci">bool doubleIntefaceNode</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00030">nonlocal_assembly.hpp:30</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_a9a6a1a63afa851a9aca8c37fa30262f8"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a></div><div class="ttdeci">double rightBound</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00037">nonlocal_assembly.hpp:37</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_aad49095e956c6c9460542240b8de5104"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#aad49095e956c6c9460542240b8de5104">delta1Shift</a></div><div class="ttdeci">double delta1Shift</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00022">nonlocal_assembly.hpp:22</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_aadaee16034c208f24a56472f7df95ca8"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#aadaee16034c208f24a56472f7df95ca8">desiredMeshSize</a></div><div class="ttdeci">double desiredMeshSize</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00016">nonlocal_assembly.hpp:16</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_ae287e9c4dbb56188bf2e7752b8035928"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#ae287e9c4dbb56188bf2e7752b8035928">desiredMeshSizeFine</a></div><div class="ttdeci">double desiredMeshSizeFine</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00017">nonlocal_assembly.hpp:17</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_ae6d7e00b4db89f0ac554feff2d08fdda"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#ae6d7e00b4db89f0ac554feff2d08fdda">delta2Shift</a></div><div class="ttdeci">double delta2Shift</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00023">nonlocal_assembly.hpp:23</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_af9d0c51d7083cdb1559b2610ac41b515"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#af9d0c51d7083cdb1559b2610ac41b515">shiftExternalNodes</a></div><div class="ttdeci">bool shiftExternalNodes</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00019">nonlocal_assembly.hpp:19</a></div></div>
<div class="ttc" id="anonlocal__assembly_8hpp_html_afb570f4be8d359be8e738f725cb8b5f3"><div class="ttname"><a href="../../d0/d15/nonlocal__assembly_8hpp.html#afb570f4be8d359be8e738f725cb8b5f3">delta2Mesh</a></div><div class="ttdeci">double delta2Mesh</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d15/nonlocal__assembly_8hpp_source.html#l00021">nonlocal_assembly.hpp:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a868f493464e4506415b1f8b6cc492800" name="a868f493464e4506415b1f8b6cc492800"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a868f493464e4506415b1f8b6cc492800">&#9670;&#160;</a></span>PutADoubleNodeAtTheInterface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void PutADoubleNodeAtTheInterface </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mlMsh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>meshSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>leftBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rightBound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00675">675</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  675</span>                                                                                                                             {</div>
<div class="line"><span class="lineno">  676</span> </div>
<div class="line"><span class="lineno">  677</span>  <span class="keywordtype">unsigned</span> level = 0;</div>
<div class="line"><span class="lineno">  678</span> </div>
<div class="line"><span class="lineno">  679</span>  <span class="keywordtype">unsigned</span> xType = 2;</div>
<div class="line"><span class="lineno">  680</span> </div>
<div class="line"><span class="lineno">  681</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* msh = mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> (level);</div>
<div class="line"><span class="lineno">  682</span> </div>
<div class="line"><span class="lineno">  683</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  684</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>(); <span class="comment">// get the noumber of processes (for parallel computation)</span></div>
<div class="line"><span class="lineno">  685</span> </div>
<div class="line"><span class="lineno">  686</span>  <span class="comment">//BEGIN TO REMOVE</span></div>
<div class="line"><span class="lineno">  687</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  688</span> </div>
<div class="line"><span class="lineno">  689</span>    <span class="keywordtype">unsigned</span> xMinDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (0, iel, xType);</div>
<div class="line"><span class="lineno">  690</span>    <span class="keywordtype">unsigned</span> xMaxDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (1, iel, xType);</div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordtype">unsigned</span> xMidDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (2, iel, xType);</div>
<div class="line"><span class="lineno">  692</span> </div>
<div class="line"><span class="lineno">  693</span> </div>
<div class="line"><span class="lineno">  694</span>    <span class="keywordtype">double</span> xMin = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMinDof);</div>
<div class="line"><span class="lineno">  695</span>    <span class="keywordtype">double</span> xMax = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMaxDof);</div>
<div class="line"><span class="lineno">  696</span>    <span class="keywordtype">double</span> xMid = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMidDof);</div>
<div class="line"><span class="lineno">  697</span> </div>
<div class="line"><span class="lineno">  698</span>    std::cout.precision (16);</div>
<div class="line"><span class="lineno">  699</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;xMin prima del move= &quot;</span> &lt;&lt; xMin &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; <span class="stringliteral">&quot;xMid = &quot;</span> &lt;&lt; xMid &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; <span class="stringliteral">&quot;xMax = &quot;</span> &lt;&lt; xMax &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  700</span> </div>
<div class="line"><span class="lineno">  701</span>  }</div>
<div class="line"><span class="lineno">  702</span> </div>
<div class="line"><span class="lineno">  703</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  704</span> </div>
<div class="line"><span class="lineno">  705</span>  <span class="keywordtype">unsigned</span> numberOfNodes = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af2c24133f4e09b566e6d92bcc3a417c3">GetNumberOfNodes</a>();</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>  std::vector&lt;unsigned&gt; nodeShiftFlags (numberOfNodes, 0);</div>
<div class="line"><span class="lineno">  708</span> </div>
<div class="line"><span class="lineno">  709</span>  <span class="keywordtype">unsigned</span> leftDofsIproc = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[xType][iproc];</div>
<div class="line"><span class="lineno">  710</span> </div>
<div class="line"><span class="lineno">  711</span>  <span class="keywordtype">unsigned</span> rightDofsIproc = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">_dofOffset</a>[xType][iproc + 1];</div>
<div class="line"><span class="lineno">  712</span> </div>
<div class="line"><span class="lineno">  713</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  714</span> </div>
<div class="line"><span class="lineno">  715</span>    <span class="keywordtype">unsigned</span> xMinDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (0, iel, xType);</div>
<div class="line"><span class="lineno">  716</span>    <span class="keywordtype">unsigned</span> xMaxDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (1, iel, xType);</div>
<div class="line"><span class="lineno">  717</span>    <span class="keywordtype">unsigned</span> xMidDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (2, iel, xType);</div>
<div class="line"><span class="lineno">  718</span> </div>
<div class="line"><span class="lineno">  719</span>    <span class="keywordtype">double</span> xMin = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMinDof);</div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordtype">double</span> xMax = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMaxDof);</div>
<div class="line"><span class="lineno">  721</span>    <span class="keywordtype">double</span> xMid = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMidDof);</div>
<div class="line"><span class="lineno">  722</span> </div>
<div class="line"><span class="lineno">  723</span><span class="comment">//     if (fabs (xMid) &lt;= 1.e-14) {</span></div>
<div class="line"><span class="lineno">  724</span><span class="comment">//       elementToSkip = iel;</span></div>
<div class="line"><span class="lineno">  725</span><span class="comment">//       elementToSkipFound = true;</span></div>
<div class="line"><span class="lineno">  726</span><span class="comment">//       procWhoFoundIt = iproc;</span></div>
<div class="line"><span class="lineno">  727</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">  728</span> </div>
<div class="line"><span class="lineno">  729</span>    <span class="keywordtype">bool</span> iprocOwnsXmin = (leftDofsIproc &lt;= xMinDof &lt; rightDofsIproc) ? <span class="keyword">true</span> : false;</div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordtype">bool</span> iprocOwnsXmax = (leftDofsIproc &lt;= xMaxDof &lt; rightDofsIproc) ? <span class="keyword">true</span> : false;</div>
<div class="line"><span class="lineno">  731</span> </div>
<div class="line"><span class="lineno">  732</span>    <span class="keywordflow">if</span> (nodeShiftFlags[xMinDof] == 0 &amp;&amp; iprocOwnsXmin) {</div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span>      <span class="keywordflow">if</span> (xMin &lt; 0.) msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMinDof, xMin + 0.5 * meshSize);</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>      <span class="keywordflow">else</span> msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMinDof, xMin - 0.5 * meshSize);</div>
<div class="line"><span class="lineno">  737</span> </div>
<div class="line"><span class="lineno">  738</span>      nodeShiftFlags[xMinDof] = 1;</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    }</div>
<div class="line"><span class="lineno">  741</span> </div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">if</span> (nodeShiftFlags[xMaxDof] == 0 &amp;&amp; iprocOwnsXmax) {</div>
<div class="line"><span class="lineno">  743</span> </div>
<div class="line"><span class="lineno">  744</span>      <span class="keywordflow">if</span> (xMax &lt; 0.) msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMaxDof, xMax + 0.5 * meshSize);</div>
<div class="line"><span class="lineno">  745</span> </div>
<div class="line"><span class="lineno">  746</span>      <span class="keywordflow">else</span> msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMaxDof, xMax - 0.5 * meshSize);</div>
<div class="line"><span class="lineno">  747</span> </div>
<div class="line"><span class="lineno">  748</span>      nodeShiftFlags[xMaxDof] = 1;</div>
<div class="line"><span class="lineno">  749</span> </div>
<div class="line"><span class="lineno">  750</span>    }</div>
<div class="line"><span class="lineno">  751</span> </div>
<div class="line"><span class="lineno">  752</span>  }</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span>  msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;close();</div>
<div class="line"><span class="lineno">  755</span> </div>
<div class="line"><span class="lineno">  756</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>    <span class="keywordtype">unsigned</span> xMinDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (0, iel, xType);</div>
<div class="line"><span class="lineno">  759</span>    <span class="keywordtype">unsigned</span> xMaxDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (1, iel, xType);</div>
<div class="line"><span class="lineno">  760</span>    <span class="keywordtype">unsigned</span> xMidDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (2, iel, xType);</div>
<div class="line"><span class="lineno">  761</span> </div>
<div class="line"><span class="lineno">  762</span> </div>
<div class="line"><span class="lineno">  763</span>    <span class="keywordtype">double</span> xMin = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMinDof);</div>
<div class="line"><span class="lineno">  764</span>    <span class="keywordtype">double</span> xMax = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMaxDof);</div>
<div class="line"><span class="lineno">  765</span> </div>
<div class="line"><span class="lineno">  766</span>    msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMidDof, 0.5 * (xMin + xMax));</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>  }</div>
<div class="line"><span class="lineno">  769</span> </div>
<div class="line"><span class="lineno">  770</span>  msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;close();</div>
<div class="line"><span class="lineno">  771</span> </div>
<div class="line"><span class="lineno">  772</span>  <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a> += 0.5 * meshSize;</div>
<div class="line"><span class="lineno">  773</span>  <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a> -= 0.5 * meshSize;</div>
<div class="line"><span class="lineno">  774</span> </div>
<div class="line"><span class="lineno">  775</span><span class="comment">//         //BEGIN TO REMOVE</span></div>
<div class="line"><span class="lineno">  776</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  777</span> </div>
<div class="line"><span class="lineno">  778</span>    <span class="keywordtype">unsigned</span> xMinDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (0, iel, xType);</div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordtype">unsigned</span> xMaxDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (1, iel, xType);</div>
<div class="line"><span class="lineno">  780</span>    <span class="keywordtype">unsigned</span> xMidDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (2, iel, xType);</div>
<div class="line"><span class="lineno">  781</span> </div>
<div class="line"><span class="lineno">  782</span> </div>
<div class="line"><span class="lineno">  783</span>    <span class="keywordtype">double</span> xMin = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMinDof);</div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordtype">double</span> xMax = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMaxDof);</div>
<div class="line"><span class="lineno">  785</span>    <span class="keywordtype">double</span> xMid = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMidDof);</div>
<div class="line"><span class="lineno">  786</span> </div>
<div class="line"><span class="lineno">  787</span>    std::cout.precision (16);</div>
<div class="line"><span class="lineno">  788</span>    std::cout &lt;&lt; <span class="stringliteral">&quot;xMin mesh spostato= &quot;</span> &lt;&lt; xMin &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; <span class="stringliteral">&quot;xMid = &quot;</span> &lt;&lt; xMid &lt;&lt; <span class="stringliteral">&quot; , &quot;</span> &lt;&lt; <span class="stringliteral">&quot;xMax = &quot;</span> &lt;&lt; xMax &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>  }</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>  <span class="comment">//END</span></div>
<div class="line"><span class="lineno">  793</span> </div>
<div class="line"><span class="lineno">  794</span><span class="comment">//         END</span></div>
<div class="line"><span class="lineno">  795</span> </div>
<div class="line"><span class="lineno">  796</span>}</div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a36b27d856d33d9d5554bda71401a5800"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a36b27d856d33d9d5554bda71401a5800">femus::Mesh::_dofOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _dofOffset[5]</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00399">Mesh.hpp:399</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af2c24133f4e09b566e6d92bcc3a417c3"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af2c24133f4e09b566e6d92bcc3a417c3">femus::Mesh::GetNumberOfNodes</a></div><div class="ttdeci">unsigned GetNumberOfNodes() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00089">Mesh.hpp:89</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab8b0d45993b678f2b4a8aea9fff7fc87" name="ab8b0d45993b678f2b4a8aea9fff7fc87"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab8b0d45993b678f2b4a8aea9fff7fc87">&#9670;&#160;</a></span>SetBoundaryCondition()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool SetBoundaryCondition </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>SolName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00057">57</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   57</span>                                                                                                                                      {</div>
<div class="line"><span class="lineno">   58</span> </div>
<div class="line"><span class="lineno">   59</span>  <span class="keywordtype">bool</span> dirichlet = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">   60</span> </div>
<div class="line"><span class="lineno">   61</span>  <span class="keywordtype">double</span> u1 = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a5d015a3751aec61f2442b957cb6f517a">a1</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a84e4813f421c80250583ae23e3f4f100">b1</a> * x[0] - 1. / (2. * <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a6f666e9bb67f39191f9f969af23ebe70">kappa1</a>) * x[0] * x[0];</div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordtype">double</span> u2 = <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ac55c2d269ed76bd9bdb7fb25f3533a4e">a2</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a35d10c1e721e67a3616511e45aa89f34">b2</a> * x[0] - 1. / (2. * <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a0c5c57a31dd2eeb3ae1db16a86fd0053">kappa2</a>) * x[0] * x[0];</div>
<div class="line"><span class="lineno">   63</span> </div>
<div class="line"><span class="lineno">   64</span>  value = (x[0] &lt; 0.) ? u1 : u2;</div>
<div class="line"><span class="lineno">   65</span> </div>
<div class="line"><span class="lineno">   66</span><span class="comment">//     value = 0.;</span></div>
<div class="line"><span class="lineno">   67</span><span class="comment">//     value = x[0];</span></div>
<div class="line"><span class="lineno">   68</span><span class="comment">//     value = x[0] * x[0];</span></div>
<div class="line"><span class="lineno">   69</span><span class="comment">//     value = x[0] * x[0] * x[0];</span></div>
<div class="line"><span class="lineno">   70</span><span class="comment">//     value = x[0] * x[0] * x[0] * x[0] + 0.1 * x[0] * x[0]; //this is x^4 + delta x^2</span></div>
<div class="line"><span class="lineno">   71</span><span class="comment">//     value = x[0] * x[0] * x[0] * x[0];</span></div>
<div class="line"><span class="lineno">   72</span><span class="comment">//     value =  2 * x[0] + x[0] * x[0] * x[0] * x[0] * x[0]; //this is 2x + x^5</span></div>
<div class="line"><span class="lineno">   73</span> </div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><span class="lineno">   75</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aaf9c8cb2738ee78e3c891630faaef46a" name="aaf9c8cb2738ee78e3c891630faaef46a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aaf9c8cb2738ee78e3c891630faaef46a">&#9670;&#160;</a></span>ShiftTheExtrema()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void ShiftTheExtrema </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> &amp;&#160;</td>
          <td class="paramname"><em>mlMsh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>meshSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>delta1Shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double &amp;&#160;</td>
          <td class="paramname"><em>delta2Shift</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>leftBound</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>rightBound</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00799">799</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  799</span>                                                                                                                                                                        {</div>
<div class="line"><span class="lineno">  800</span> </div>
<div class="line"><span class="lineno">  801</span>  <span class="keywordtype">unsigned</span> level = 0;</div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>  <span class="keywordtype">unsigned</span> xType = 2;</div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>* msh = mlMsh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a> (level);</div>
<div class="line"><span class="lineno">  806</span> </div>
<div class="line"><span class="lineno">  807</span>  <span class="keywordtype">unsigned</span>    iproc = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>(); <span class="comment">// get the process_id (for parallel computation)</span></div>
<div class="line"><span class="lineno">  808</span>  <span class="keywordtype">unsigned</span>    nprocs = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#af6629fca51be192be664c76eb8aecc79">n_processors</a>(); <span class="comment">// get the noumber of processes (for parallel computation)</span></div>
<div class="line"><span class="lineno">  809</span> </div>
<div class="line"><span class="lineno">  810</span><span class="comment">//   //         //BEGIN TO REMOVE</span></div>
<div class="line"><span class="lineno">  811</span><span class="comment">//   for (int iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</span></div>
<div class="line"><span class="lineno">  812</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  813</span><span class="comment">//     unsigned xMinDof  = msh-&gt;GetSolutionDof (0, iel, xType);</span></div>
<div class="line"><span class="lineno">  814</span><span class="comment">//     unsigned xMaxDof  = msh-&gt;GetSolutionDof (1, iel, xType);</span></div>
<div class="line"><span class="lineno">  815</span><span class="comment">//     unsigned xMidDof  = msh-&gt;GetSolutionDof (2, iel, xType);</span></div>
<div class="line"><span class="lineno">  816</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  817</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  818</span><span class="comment">//     double xMin = (*msh-&gt;_topology-&gt;_Sol[0]) (xMinDof);</span></div>
<div class="line"><span class="lineno">  819</span><span class="comment">//     double xMax = (*msh-&gt;_topology-&gt;_Sol[0]) (xMaxDof);</span></div>
<div class="line"><span class="lineno">  820</span><span class="comment">//     double xMid = (*msh-&gt;_topology-&gt;_Sol[0]) (xMidDof);</span></div>
<div class="line"><span class="lineno">  821</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  822</span><span class="comment">//     std::cout &lt;&lt; &quot;xMin prima dello shift= &quot; &lt;&lt; xMin &lt;&lt; &quot; , &quot; &lt;&lt; &quot;xMid = &quot; &lt;&lt; xMid &lt;&lt; &quot; , &quot; &lt;&lt; &quot;xMax = &quot; &lt;&lt; xMax &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  823</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  824</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  825</span><span class="comment">//   //END</span></div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span>  <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a7f0cbb4545e86a21a60670b5f50e5243">doubleIntefaceNode</a>) {</div>
<div class="line"><span class="lineno">  828</span>    <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a> += 0.5 * meshSize;</div>
<div class="line"><span class="lineno">  829</span>    <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a> -= 0.5 * meshSize;</div>
<div class="line"><span class="lineno">  830</span>  }</div>
<div class="line"><span class="lineno">  831</span> </div>
<div class="line"><span class="lineno">  832</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  833</span> </div>
<div class="line"><span class="lineno">  834</span>    <span class="keywordtype">unsigned</span> xMinDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (0, iel, xType);</div>
<div class="line"><span class="lineno">  835</span>    <span class="keywordtype">unsigned</span> xMaxDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (1, iel, xType);</div>
<div class="line"><span class="lineno">  836</span>    <span class="keywordtype">unsigned</span> xMidDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a> (2, iel, xType);</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>    <span class="keywordtype">double</span> xMin = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMinDof);</div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordtype">double</span> xMax = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]) (xMaxDof);</div>
<div class="line"><span class="lineno">  840</span> </div>
<div class="line"><span class="lineno">  841</span>    <span class="keywordflow">if</span> (fabs (xMin - (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a42395ee6e95ff0d7727efcb3ee223606">leftBound</a> - <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a514457b1a7f7e254fcb7a412eeeede54">delta1Mesh</a>)) &lt;= 1.e-10) {</div>
<div class="line"><span class="lineno">  842</span>      msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMinDof, xMin + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#aad49095e956c6c9460542240b8de5104">delta1Shift</a>);</div>
<div class="line"><span class="lineno">  843</span>      msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMidDof, 0.5 * (xMin + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#aad49095e956c6c9460542240b8de5104">delta1Shift</a> + xMax));</div>
<div class="line"><span class="lineno">  844</span>    }</div>
<div class="line"><span class="lineno">  845</span> </div>
<div class="line"><span class="lineno">  846</span>    <span class="keywordflow">if</span> (fabs (xMax - (<a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#a9a6a1a63afa851a9aca8c37fa30262f8">rightBound</a> + <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#afb570f4be8d359be8e738f725cb8b5f3">delta2Mesh</a>)) &lt;= 1.e-10) {</div>
<div class="line"><span class="lineno">  847</span>      msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMaxDof, xMax - <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ae6d7e00b4db89f0ac554feff2d08fdda">delta2Shift</a>);</div>
<div class="line"><span class="lineno">  848</span>      msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;set (xMidDof, 0.5 * (xMin + xMax - <a class="code hl_variable" href="../../d0/d15/nonlocal__assembly_8hpp.html#ae6d7e00b4db89f0ac554feff2d08fdda">delta2Shift</a>));</div>
<div class="line"><span class="lineno">  849</span>    }</div>
<div class="line"><span class="lineno">  850</span> </div>
<div class="line"><span class="lineno">  851</span>  }</div>
<div class="line"><span class="lineno">  852</span> </div>
<div class="line"><span class="lineno">  853</span>  msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[0]-&gt;close();</div>
<div class="line"><span class="lineno">  854</span> </div>
<div class="line"><span class="lineno">  855</span><span class="comment">//   //         //BEGIN TO REMOVE</span></div>
<div class="line"><span class="lineno">  856</span><span class="comment">//   for (int iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</span></div>
<div class="line"><span class="lineno">  857</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  858</span><span class="comment">//     unsigned xMinDof  = msh-&gt;GetSolutionDof (0, iel, xType);</span></div>
<div class="line"><span class="lineno">  859</span><span class="comment">//     unsigned xMaxDof  = msh-&gt;GetSolutionDof (1, iel, xType);</span></div>
<div class="line"><span class="lineno">  860</span><span class="comment">//     unsigned xMidDof  = msh-&gt;GetSolutionDof (2, iel, xType);</span></div>
<div class="line"><span class="lineno">  861</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  862</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  863</span><span class="comment">//     double xMin = (*msh-&gt;_topology-&gt;_Sol[0]) (xMinDof);</span></div>
<div class="line"><span class="lineno">  864</span><span class="comment">//     double xMax = (*msh-&gt;_topology-&gt;_Sol[0]) (xMaxDof);</span></div>
<div class="line"><span class="lineno">  865</span><span class="comment">//     double xMid = (*msh-&gt;_topology-&gt;_Sol[0]) (xMidDof);</span></div>
<div class="line"><span class="lineno">  866</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  867</span><span class="comment">//     std::cout &lt;&lt; &quot;xMin dopo lo shift= &quot; &lt;&lt; xMin &lt;&lt; &quot; , &quot; &lt;&lt; &quot;xMid = &quot; &lt;&lt; xMid &lt;&lt; &quot; , &quot; &lt;&lt; &quot;xMax = &quot; &lt;&lt; xMax &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  868</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  869</span><span class="comment">//   }</span></div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span>}</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a0aca793820b6ff7705450e2043256938" name="a0aca793820b6ff7705450e2043256938"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0aca793820b6ff7705450e2043256938">&#9670;&#160;</a></span>numberOfUniformLevels</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">unsigned numberOfUniformLevels = 1</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html#l00077">77</a> of file <a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp_source.html">ex1.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_726472302f3de098e361d779fbba4ddb.html">NonLocal</a></li><li class="navelem"><a class="el" href="../../dir_7352fb35abfcddb9a77e8f75aec47240.html">ex1</a></li><li class="navelem"><a class="el" href="../../d0/d8e/_non_local_2ex1_2ex1_8cpp.html">ex1.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
