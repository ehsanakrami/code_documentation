<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: /home/ehsan/Desktop/insync_Poweredge/work/doxygen/femus/applications/OptimalControl/04_solidopt/00_solid_state/00_solid_state.cpp Source File</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d5/d7e/00__solid__state_8cpp_source.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">00_solid_state.cpp</div>  </div>
</div><!--header-->
<div class="contents">
<a href="../../d5/d7e/00__solid__state_8cpp.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/d0d/FemusInit_8hpp.html">FemusInit.hpp</a>&quot;</span></div>
<div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d8/d29/MultiLevelSolution_8hpp.html">MultiLevelSolution.hpp</a>&quot;</span></div>
<div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../da/de0/MultiLevelProblem_8hpp.html">MultiLevelProblem.hpp</a>&quot;</span></div>
<div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../df/d05/NumericVector_8hpp.html">NumericVector.hpp</a>&quot;</span></div>
<div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d5/d64/VTKWriter_8hpp.html">VTKWriter.hpp</a>&quot;</span></div>
<div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dab/NonLinearImplicitSystem_8hpp.html">NonLinearImplicitSystem.hpp</a>&quot;</span></div>
<div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/d22/LinearImplicitSystem_8hpp.html">LinearImplicitSystem.hpp</a>&quot;</span></div>
<div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../db/dce/Parameter_8hpp.html">Parameter.hpp</a>&quot;</span></div>
<div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../dc/df5/Solid_8hpp.html">Solid.hpp</a>&quot;</span></div>
<div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d4/dc0/Files_8hpp.html">Files.hpp</a>&quot;</span></div>
<div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../d7/dd6/FE__convergence_8hpp.html">FE_convergence.hpp</a>&quot;</span></div>
<div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="../../de/d73/Assemble__jacobian_8hpp.html">Assemble_jacobian.hpp</a>&quot;</span></div>
<div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="preprocessor">#include &quot;adept.h&quot;</span></div>
<div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160; </div>
<div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160; </div>
<div class="line"><a name="l00016"></a><span class="lineno"><a class="line" href="../../d5/d7e/00__solid__state_8cpp.html#a7c60e913478d07a44ac15c6fb2c5937f">   16</a></span>&#160;<span class="preprocessor">#define MODEL &quot;Linear_elastic&quot;</span></div>
<div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">// #define MODEL &quot;Mooney-Rivlin&quot; </span></div>
<div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="comment">// #define MODEL &quot;Neo-Hookean&quot;</span></div>
<div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160; </div>
<div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="keyword">using namespace </span><a class="code" href="../../d8/dea/namespacefemus.html">femus</a>;</div>
<div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160; </div>
<div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;  </div>
<div class="line"><a name="l00023"></a><span class="lineno"><a class="line" href="../../d5/d7e/00__solid__state_8cpp.html#a5dec9191b407f5f1913e563b23777741">   23</a></span>&#160;<span class="keywordtype">double</span> <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a> * ml_prob, <span class="keyword">const</span> std::vector &lt; double &gt;&amp; x, <span class="keyword">const</span> <span class="keywordtype">char</span> name[]) {</div>
<div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;         </div>
<div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;           <span class="keywordtype">double</span> value = 0.;</div>
<div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160; </div>
<div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;             <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DX&quot;</span>)) {</div>
<div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;                 value = 0.;</div>
<div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;             }</div>
<div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DY&quot;</span>)) {</div>
<div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;                 value = 0.;</div>
<div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;             }</div>
<div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DZ&quot;</span>)) {</div>
<div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;                 value = 0.;</div>
<div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;             }</div>
<div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;P&quot;</span>)) {</div>
<div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;                 value = 0.;</div>
<div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;             }</div>
<div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;           </div>
<div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;    </div>
<div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;      <span class="keywordflow">return</span> value;   </div>
<div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;}  </div>
<div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;  </div>
<div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;  </div>
<div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;  </div>
<div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160; </div>
<div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="../../d5/d7e/00__solid__state_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">   47</a></span>&#160;<span class="keywordtype">bool</span> <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a>(<span class="keyword">const</span> <a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a> * ml_prob, <span class="keyword">const</span> std::vector &lt; double &gt;&amp; x, <span class="keyword">const</span> <span class="keywordtype">char</span> SolName[], <span class="keywordtype">double</span>&amp; value, <span class="keyword">const</span> <span class="keywordtype">int</span> facename, <span class="keyword">const</span> <span class="keywordtype">double</span> time) {</div>
<div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;  <span class="comment">//1: bottom (y=y_min) //2: right (x=x_max)  //3: top (y=y_max)  //4: left (x=)  (in 2D)</span></div>
<div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;  <span class="comment">//1: bottom (y=y_min) //2: right (x=x_max)  //3: top (y=y_max)  //4: left (x=) //5: (z=z_min)  //6:  (z=z_max) (in 3D, I guess...)</span></div>
<div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;  </div>
<div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;  <span class="keywordtype">bool</span> dirichlet; </div>
<div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  </div>
<div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;      <span class="keywordflow">if</span> (facename == 1) {</div>
<div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;       <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; }</div>
<div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        </div>
<div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;      }</div>
<div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160; </div>
<div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;      <span class="keywordflow">if</span> (facename == 2) {</div>
<div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;       <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX&quot;</span>))    { dirichlet = <span class="keyword">false</span><span class="comment">/*true*/</span>; value = 0.; }</div>
<div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY&quot;</span>))    { dirichlet = <span class="keyword">false</span><span class="comment">/*true*/</span>; value = 0.; } </div>
<div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;        </div>
<div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;      }</div>
<div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160; </div>
<div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;      <span class="keywordflow">if</span> (facename == 3) {</div>
<div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;       <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; }</div>
<div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        </div>
<div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;      }</div>
<div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160; </div>
<div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">if</span> (facename == 4) {</div>
<div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;       <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX&quot;</span>))    { dirichlet = <span class="keyword">false</span><span class="comment">/*true*/</span>; value = 0.; }</div>
<div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY&quot;</span>))    { dirichlet = <span class="keyword">false</span><span class="comment">/*true*/</span>; value = 0.; } </div>
<div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;        </div>
<div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;      }</div>
<div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;      </div>
<div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;      <span class="keywordflow">if</span> (facename == 5) {</div>
<div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;       <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX&quot;</span>))    { dirichlet = <span class="keyword">false</span>; value = 0.; }</div>
<div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY&quot;</span>))    { dirichlet = <span class="keyword">false</span>; value = 0.; } </div>
<div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;      }</div>
<div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;      </div>
<div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;      <span class="keywordflow">if</span> (facename == 6) {</div>
<div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;       <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX&quot;</span>))    { dirichlet = <span class="keyword">false</span>; value = 0.; }</div>
<div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY&quot;</span>))    { dirichlet = <span class="keyword">false</span>; value = 0.; } </div>
<div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;  <span class="keywordflow">else</span> <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ&quot;</span>))    { dirichlet = <span class="keyword">true</span>; value = 0.; } </div>
<div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;      }</div>
<div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;      </div>
<div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;  <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;}</div>
<div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160; </div>
<div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160; </div>
<div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160; </div>
<div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">class</span> system_type, <span class="keyword">class</span> real_num, <span class="keyword">class</span> real_num_mov &gt;</div>
<div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#aea610d910b5d696b3e500ed9636d8367">AssembleSolidMech</a>(<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a>&amp; ml_prob);</div>
<div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160; </div>
<div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160; </div>
<div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">class</span> system_type, <span class="keyword">class</span> real_num, <span class="keyword">class</span> real_num_mov &gt;</div>
<div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#aea610d910b5d696b3e500ed9636d8367">AssembleSolidMech</a>(<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a>&amp; ml_prob,</div>
<div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;                       <span class="keyword">const</span> <a class="code" href="../../d3/d04/classfemus_1_1Solid.html">Solid</a> &amp; solid_in,</div>
<div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;                       system_type * mlPdeSys,</div>
<div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                       <span class="keyword">const</span> std::vector&lt; Unknown &gt; &amp;  unknowns);</div>
<div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160; </div>
<div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160; </div>
<div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160; </div>
<div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160; </div>
<div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160; </div>
<div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160; <span class="comment">//Unknown definition  ==================</span></div>
<div class="line"><a name="l00113"></a><span class="lineno"><a class="line" href="../../d5/d7e/00__solid__state_8cpp.html#a6917621ec8f1cbd9eda71cf3f12de89c">  113</a></span>&#160; <span class="keyword">const</span> std::vector&lt; Unknown &gt;  <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a6917621ec8f1cbd9eda71cf3f12de89c">provide_list_of_unknowns</a>(<span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dimension) {</div>
<div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;     </div>
<div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;     </div>
<div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;  std::vector&lt; FEFamily &gt; feFamily;</div>
<div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;  std::vector&lt; FEOrder &gt;   feOrder;</div>
<div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160; </div>
<div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;                        feFamily.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a><span class="comment">/*DISCONTINUOUS_POLYNOMIAL*/</span>);</div>
<div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;                        feFamily.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                        feFamily.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;  <span class="keywordflow">if</span> (dimension == 3)   feFamily.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;  </div>
<div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;                        feOrder.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>);</div>
<div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;                        feOrder.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;                        feOrder.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;  <span class="keywordflow">if</span> (dimension == 3)   feOrder.push_back(<a class="code" href="../../db/dc8/FElemTypeEnum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;  </div>
<div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;  assert( feFamily.size() == feOrder.size() );</div>
<div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160; </div>
<div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160; std::vector&lt; Unknown &gt;  unknowns(feFamily.size());</div>
<div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160; </div>
<div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;                        unknowns[0]._name      = <span class="stringliteral">&quot;P&quot;</span>;</div>
<div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                        unknowns[1]._name      = <span class="stringliteral">&quot;DX&quot;</span>;</div>
<div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                        unknowns[2]._name      = <span class="stringliteral">&quot;DY&quot;</span>;</div>
<div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;  <span class="keywordflow">if</span> (dimension == 3)   unknowns[3]._name      = <span class="stringliteral">&quot;DZ&quot;</span>;</div>
<div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160; </div>
<div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++) {</div>
<div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;         </div>
<div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;              unknowns[u]._fe_family = feFamily[u];</div>
<div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;              unknowns[u]._fe_order  = feOrder[u];</div>
<div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;              unknowns[u]._time_order = 0;</div>
<div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;              unknowns[u]._is_pde_unknown = <span class="keyword">true</span>;</div>
<div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;              </div>
<div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;     }</div>
<div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160; </div>
<div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160; </div>
<div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;   <span class="keywordflow">return</span> unknowns;</div>
<div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;     </div>
<div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;}</div>
<div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160; </div>
<div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160; </div>
<div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160; </div>
<div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160; </div>
<div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">class</span> real_num &gt; </div>
<div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="keyword">class </span><a class="code" href="../../dd/dc9/classSolution__generation__1.html">Solution_generation_1</a> : <span class="keyword">public</span> <a class="code" href="../../d5/df1/classfemus_1_1Solution__generation__single__level.html">Solution_generation_single_level</a> {</div>
<div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    </div>
<div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;<span class="keyword">public</span>:</div>
<div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    </div>
<div class="line"><a name="l00160"></a><span class="lineno"><a class="line" href="../../dd/dc9/classSolution__generation__1.html#a68765d1e79777165c518157310035844">  160</a></span>&#160;    <span class="keyword">const</span> <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html">MultiLevelSolution</a>  <a class="code" href="../../dd/dc9/classSolution__generation__1.html#a68765d1e79777165c518157310035844">run_on_single_level</a>(<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a> &amp; ml_prob,</div>
<div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;                                                  <a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html">MultiLevelMesh</a> &amp; ml_mesh,</div>
<div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> i,</div>
<div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                                                  <span class="keyword">const</span> std::vector&lt; Unknown &gt; &amp; unknowns,</div>
<div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                                                  <span class="keyword">const</span> std::vector&lt; <a class="code" href="../../db/dc9/classfemus_1_1Math_1_1Function.html">Math::Function&lt; double &gt;</a> * &gt; &amp;  exact_sol,</div>
<div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;                                                  <span class="keyword">const</span> <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html#a51e1cff061477ba02672e5ef790c465f">MultiLevelSolution::InitFuncMLProb</a> SetInitialCondition_in,</div>
<div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;                                                  <span class="keyword">const</span> <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html#ac2ecfa36125c8626b6fdf20f71dbde0c">MultiLevelSolution::BoundaryFuncMLProb</a> SetBoundaryCondition_in,</div>
<div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">bool</span> equation_sol</div>
<div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                                                 ) <span class="keyword">const</span>;</div>
<div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;  </div>
<div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;};</div>
<div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160; </div>
<div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160; </div>
<div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160; </div>
<div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160; </div>
<div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160; </div>
<div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160; </div>
<div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160; </div>
<div class="line"><a name="l00178"></a><span class="lineno"><a class="line" href="../../d5/d7e/00__solid__state_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">  178</a></span>&#160;<span class="keywordtype">int</span> <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a>(<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span>** args) {</div>
<div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160; </div>
<div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;  <span class="comment">// ======= Init ==========================</span></div>
<div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;  <a class="code" href="../../d6/d8c/classfemus_1_1FemusInit.html">FemusInit</a> mpinit(argc, args, MPI_COMM_WORLD);</div>
<div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160; </div>
<div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;  <span class="comment">// ======= Files ==================</span></div>
<div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;  <a class="code" href="../../d4/d91/classfemus_1_1Files.html">Files</a> files;</div>
<div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        files.<a class="code" href="../../d4/d91/classfemus_1_1Files.html#ab8c41974c4980d87c7e1467b153854e6">CheckIODirectories</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;        files.<a class="code" href="../../d4/d91/classfemus_1_1Files.html#aac199200ffda7ba50611cc41f6a874bc">RedirectCout</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160; </div>
<div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;  <span class="comment">// ======= Quad Rule ========================</span></div>
<div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;  std::string quad_rule_order(<span class="stringliteral">&quot;seventh&quot;</span>);</div>
<div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160; </div>
<div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// ======= Problem ========================</span></div>
<div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a> ml_prob;</div>
<div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a8b72e984b63d5ff97c1e7a0f0a5eee5a">SetQuadratureRuleAllGeomElems</a>(quad_rule_order);</div>
<div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a623bdc2aefd83cf0c6d74fc265ee5c3f">SetFilesHandler</a>(&amp;files);</div>
<div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    </div>
<div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;  <span class="comment">// ======= Mesh ==================</span></div>
<div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d8/d65/ElemTypeEnum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a> geom_elem_type = <a class="code" href="../../d8/d65/ElemTypeEnum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a>;</div>
<div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;  <span class="keyword">const</span> std::vector&lt; unsigned int &gt; nsub = {4, 4, 0};</div>
<div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;  <span class="keyword">const</span> std::vector&lt; double &gt;      xyz_min = {0., 0., 0.};</div>
<div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;  <span class="keyword">const</span> std::vector&lt; double &gt;      xyz_max = {1., 1., 0.};</div>
<div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160; </div>
<div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;  <a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html">MultiLevelMesh</a> ml_mesh;</div>
<div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;  ml_mesh.<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(nsub[0],nsub[1],nsub[2],xyz_min[0],xyz_max[0],xyz_min[1],xyz_max[1],xyz_min[2],xyz_max[2],geom_elem_type,quad_rule_order.c_str());</div>
<div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160; </div>
<div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;  <span class="comment">// ======= Unknowns ========================</span></div>
<div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dimension = ml_mesh.<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();  </div>
<div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;  std::vector&lt; Unknown &gt; unknowns = <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a6917621ec8f1cbd9eda71cf3f12de89c">provide_list_of_unknowns</a>(dimension);</div>
<div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;  </div>
<div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;  <span class="comment">// ======= Normal run ========================   //if you don&#39;t want the convergence study</span></div>
<div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;  <a class="code" href="../../dd/dc9/classSolution__generation__1.html">Solution_generation_1</a>&lt; <span class="comment">/*adept::a*/</span><span class="keywordtype">double</span> &gt; my_main;</div>
<div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;<span class="comment">//     const unsigned int n_levels = 1;</span></div>
<div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;<span class="comment">//      my_main.run_on_single_level(...); //if you don&#39;t want the convergence study</span></div>
<div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160; </div>
<div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;  </div>
<div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  </div>
<div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;  <span class="comment">// ======= Convergence study ========================</span></div>
<div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    </div>
<div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;   <span class="comment">//set coarse storage mesh (should write the copy constructor or &quot;=&quot; operator to copy the previous mesh) ==================</span></div>
<div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;   <a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html">MultiLevelMesh</a> ml_mesh_all_levels;</div>
<div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;   ml_mesh_all_levels.<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(nsub[0],nsub[1],nsub[2],xyz_min[0],xyz_max[0],xyz_min[1],xyz_max[1],xyz_min[2],xyz_max[2],geom_elem_type,quad_rule_order.c_str());</div>
<div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;   <span class="comment">//   ml_mesh_all_levels.ReadCoarseMesh(infile.c_str(),quad_rule_order.c_str(),1.);</span></div>
<div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160; </div>
<div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;   <span class="comment">// convergence choices ================  </span></div>
<div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;   <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> max_number_of_meshes;               <span class="comment">// set total number of levels ================  </span></div>
<div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160; </div>
<div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;   <span class="keywordflow">if</span> (nsub[2] == 0)   max_number_of_meshes = 2;</div>
<div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;   <span class="keywordflow">else</span>                max_number_of_meshes = 4;</div>
<div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;  </div>
<div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;<span class="comment">//    My_exact_solution&lt;&gt; exact_sol;                //provide exact solution, if available ==============</span></div>
<div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> conv_order_flag = 0;              <span class="comment">//Choose how to compute the convergence order ========= //0: incremental 1: absolute (with analytical sol)  2: absolute (with projection of finest sol)...</span></div>
<div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> norm_flag = 1;                    <span class="comment">//Choose what norms to compute (//0 = only L2: //1 = L2 + H1) ==============</span></div>
<div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160; </div>
<div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;    </div>
<div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;   <span class="comment">// object ================  </span></div>
<div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <a class="code" href="../../dd/d36/classfemus_1_1FE__convergence.html">FE_convergence&lt;&gt;</a>  fe_convergence;</div>
<div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    </div>
<div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> volume_or_boundary = 0;</div>
<div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    fe_convergence.<a class="code" href="../../dd/d36/classfemus_1_1FE__convergence.html#a456fb5ad6cbd7cf1322725a317a00d49">convergence_study</a>(ml_prob,</div>
<div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                                     ml_mesh, </div>
<div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                                     ml_mesh_all_levels,</div>
<div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                                     max_number_of_meshes,</div>
<div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                                     norm_flag,</div>
<div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                                     conv_order_flag,</div>
<div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                                     volume_or_boundary,</div>
<div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                                     <span class="keyword">true</span>,</div>
<div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                                     my_main,</div>
<div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                                     unknowns,</div>
<div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                                     std::vector&lt; <a class="code" href="../../db/dc9/classfemus_1_1Math_1_1Function.html">Math::Function&lt; double &gt;</a> * &gt; (),</div>
<div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                                     <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a>, </div>
<div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;                                     <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a></div>
<div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                                    );</div>
<div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  </div>
<div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="keywordflow">return</span> 0;</div>
<div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;}</div>
<div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160; </div>
<div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160; </div>
<div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160; </div>
<div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">class</span> system_type, <span class="keyword">class</span> real_num, <span class="keyword">class</span> real_num_mov = <span class="keywordtype">double</span> &gt;</div>
<div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="../../d5/d7e/00__solid__state_8cpp.html#aea610d910b5d696b3e500ed9636d8367">  259</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#aea610d910b5d696b3e500ed9636d8367">AssembleSolidMech</a>(<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a>&amp; ml_prob) {</div>
<div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    </div>
<div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> current_system_number = 0;  </div>
<div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    </div>
<div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;  AssembleSolidMech&lt; system_type, real_num, real_num_mov &gt; (  ml_prob, </div>
<div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                                                              ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a537b31965e5402b9c9febebce96ce01c">parameters</a>.<a class="code" href="../../d1/daa/classfemus_1_1Parameters.html#a419ddd3d0965dbca868a5072249b8374">get</a>&lt;<a class="code" href="../../d3/d04/classfemus_1_1Solid.html">Solid</a>&gt;(<span class="stringliteral">&quot;Solid&quot;</span>), </div>
<div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                                                            &amp; ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(current_system_number), </div>
<div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                                                              ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(current_system_number).get_unknown_list_for_assembly());</div>
<div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160; </div>
<div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;}</div>
<div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160; </div>
<div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160; </div>
<div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160; </div>
<div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">class</span> system_type, <span class="keyword">class</span> real_num, <span class="keyword">class</span> real_num_mov = <span class="keywordtype">double</span> &gt;</div>
<div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="../../d5/d7e/00__solid__state_8cpp.html#a96a01d4289cc795fc7506b8b67ba84bc">  273</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#aea610d910b5d696b3e500ed9636d8367">AssembleSolidMech</a>(<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a>&amp; ml_prob,</div>
<div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                       <span class="keyword">const</span> <a class="code" href="../../d3/d04/classfemus_1_1Solid.html">Solid</a> &amp; solid_in,</div>
<div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                       system_type * mlPdeSys,</div>
<div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                       <span class="keyword">const</span> std::vector&lt; Unknown &gt; &amp;  unknowns) {</div>
<div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;    </div>
<div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;  <span class="comment">//  ml_prob is the global object from/to where get/set all the data</span></div>
<div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;  <span class="comment">//  level is the level of the PDE system to be assembled</span></div>
<div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;  <span class="comment">//  levelMax is the Maximum level of the MultiLevelProblem</span></div>
<div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;  <span class="comment">//  assembleMatrix is a flag that tells if only the residual or also the matrix should be assembled</span></div>
<div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160; </div>
<div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160; </div>
<div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>                level               = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;  <span class="keywordtype">bool</span>                  assembleMatrix              = mlPdeSys-&gt;GetAssembleMatrix(); </div>
<div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160; </div>
<div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;  <a class="code" href="../../d6/db7/classfemus_1_1Mesh.html">Mesh</a>*                         msh             = ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#ae5e4557f7784330822b988d83e2b6a40">GetLevel</a>(level);</div>
<div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;  <a class="code" href="../../db/d2e/classfemus_1_1elem.html">elem</a>*                         el              = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160; </div>
<div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;  <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html">MultiLevelSolution</a>*           ml_sol  = ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;  <a class="code" href="../../d0/da2/classfemus_1_1Solution.html">Solution</a>*                     sol             = ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html#afe428eaa84d414762c4cc3b8a1d4f4a7">GetSolutionLevel</a>(level); </div>
<div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160; </div>
<div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160; </div>
<div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;  <a class="code" href="../../d7/d8c/classfemus_1_1LinearEquationSolver.html">LinearEquationSolver</a>*         pdeSys  = mlPdeSys-&gt;_LinSolver[level];</div>
<div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;  <a class="code" href="../../d4/d37/classfemus_1_1SparseMatrix.html">SparseMatrix</a>*                 JAC             = pdeSys-&gt;<a class="code" href="../../d8/d3d/classfemus_1_1LinearEquation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;  <a class="code" href="../../db/dcb/classfemus_1_1NumericVector.html">NumericVector</a>*                RES         = pdeSys-&gt;<a class="code" href="../../d8/d3d/classfemus_1_1LinearEquation.html#a20ac8999e714492516cd8a2be53fb54f">_RES</a>;</div>
<div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160; </div>
<div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160; </div>
<div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>         <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>    dim2 = (3 * (<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1));</div>
<div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  iproc  = msh-&gt;<a class="code" href="../../d2/df1/classfemus_1_1ParallelObject.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;  <span class="comment">// reserve memory for the local standard vectors</span></div>
<div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size_elem_dofs = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;  </div>
<div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160; </div>
<div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;  <span class="comment">//=======================================================</span></div>
<div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;  adept::Stack &amp; stack = <a class="code" href="../../d6/d8c/classfemus_1_1FemusInit.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;  <span class="comment">// call the adept stack object for potential use of AD</span></div>
<div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;  <span class="keyword">const</span> <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html">assemble_jacobian</a>&lt; real_num, <span class="keywordtype">double</span><span class="comment">/*real_num_mov*/</span> &gt; assemble_jac;</div>
<div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;  </div>
<div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160; </div>
<div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;  <span class="comment">//=============== Integration ========================================</span></div>
<div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;  real_num_mov weight_qp = 0.;</div>
<div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    <span class="keywordtype">double</span> weight_hat_qp = 0.;</div>
<div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160; </div>
<div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    </div>
<div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;  <span class="comment">//=============== Geometry ========================================</span></div>
<div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;  <span class="comment">// at dofs --------------------------------</span></div>
<div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;  vector&lt; vector &lt; real_num_mov &gt; &gt;   coords(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;  vector  &lt; vector  &lt; double &gt; &gt;  coords_hat(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;  <span class="keywordtype">unsigned</span> coordsType = <a class="code" href="../../df/d21/FETypeEnum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE TENSOR-PRODUCT-QUADRATIC)</span></div>
<div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {   </div>
<div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;           coords[i].reserve(max_size_elem_dofs); </div>
<div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;       coords_hat[i].reserve(max_size_elem_dofs); </div>
<div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160; }</div>
<div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160; </div>
<div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160; <span class="comment">//************** geometry phi **************************</span></div>
<div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp_domain(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp_domain(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp_domain(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp_domain_hat(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_x_dof_qp_domain_hat(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_xx_dof_qp_domain_hat(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160; </div>
<div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe = 0; fe &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; fe++) {</div>
<div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;        phi_dof_qp_domain[fe].reserve(max_size_elem_dofs);</div>
<div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      phi_x_dof_qp_domain[fe].reserve(max_size_elem_dofs * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;     phi_xx_dof_qp_domain[fe].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        phi_dof_qp_domain_hat[fe].reserve(max_size_elem_dofs);</div>
<div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;      phi_x_dof_qp_domain_hat[fe].reserve(max_size_elem_dofs * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;     phi_xx_dof_qp_domain_hat[fe].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;   }</div>
<div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160; </div>
<div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160; </div>
<div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;  <span class="comment">//=============== Unknowns ========================================</span></div>
<div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;   </div>
<div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;<span class="comment">//   constexpr int sol_pde_index_displ = 0;     //known at compile time</span></div>
<div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;<span class="comment">//   const     int sol_pde_index_press = dim;      //known at run time</span></div>
<div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;  constexpr <span class="keywordtype">int</span> sol_pde_index_displ = 1;</div>
<div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_pde_index_press = 0;</div>
<div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160; </div>
<div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;  vector &lt; std::string &gt;      Solname(n_unknowns);</div>
<div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;  vector &lt; unsigned int &gt;    SolIndex(n_unknowns);  </div>
<div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  vector &lt; unsigned int &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  vector &lt; unsigned int &gt;   SolFEType(n_unknowns);  </div>
<div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160; </div>
<div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160; </div>
<div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;          Solname[ivar] = unknowns[ivar]._name;</div>
<div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;         SolIndex[ivar] = ml_sol-&gt;<a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>        (Solname[ivar].c_str());</div>
<div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;      SolPdeIndex[ivar] = mlPdeSys-&gt;GetSolPdeIndex(Solname[ivar].c_str());</div>
<div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;      assert(ivar == SolPdeIndex[ivar]);  <span class="comment">//I would like this ivar order to coincide either with SolIndex or with SolPdeIndex, otherwise too many orders... it has to be  with SolPdeIndex, because SolIndex is related to the Solution object which can have more fields... This has to match the order of the unknowns[] argument</span></div>
<div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;      SolFEType[ivar] = ml_sol-&gt;<a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html#ac6285c5a1907ad1f93ad7b380a08dabe">GetSolutionType</a>(SolIndex[ivar]);</div>
<div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  }</div>
<div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  </div>
<div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  constexpr <span class="keywordtype">int</span> solFEType_max = <a class="code" href="../../df/d21/FETypeEnum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>;  <span class="comment">//biquadratic, this is the highest-order FE </span></div>
<div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160; </div>
<div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;   vector &lt; unsigned int &gt; Sol_n_el_dofs(n_unknowns);</div>
<div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;  </div>
<div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;  <span class="comment">//----------- of dofs and at quadrature points ------------------------------</span></div>
<div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_dof_qp(n_unknowns);</div>
<div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp(n_unknowns);   <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here  //some of these should be real_num, some real_num_mov...</span></div>
<div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;  vector &lt; vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp(n_unknowns);  <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here</span></div>
<div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;  </div>
<div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_hat_dof_qp(n_unknowns);</div>
<div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_x_hat_dof_qp(n_unknowns);</div>
<div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;  vector &lt; vector &lt; double &gt; &gt; phi_xx_hat_dof_qp(n_unknowns);</div>
<div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160; </div>
<div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; n_unknowns; fe++) {  </div>
<div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;        phi_dof_qp[fe].reserve(max_size_elem_dofs);</div>
<div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    phi_hat_dof_qp[fe].reserve(max_size_elem_dofs);</div>
<div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      phi_x_dof_qp[fe].reserve(max_size_elem_dofs * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;  phi_x_hat_dof_qp[fe].reserve(max_size_elem_dofs * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;     phi_xx_dof_qp[fe].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160; phi_xx_hat_dof_qp[fe].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;   }</div>
<div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;   </div>
<div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;  <span class="comment">//----------- at dofs ------------------------------</span></div>
<div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;  vector &lt; double &gt;   Jac;   Jac.reserve( n_unknowns * max_size_elem_dofs * n_unknowns * max_size_elem_dofs);</div>
<div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;  vector &lt; real_num &gt; Res;   Res.reserve( n_unknowns * max_size_elem_dofs);</div>
<div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;           vector &lt; int &gt;       L2G_dofmap_AllVars;   L2G_dofmap_AllVars.reserve( n_unknowns *max_size_elem_dofs);</div>
<div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;  vector &lt; vector &lt; int &gt; &gt;         L2G_dofmap(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) {    L2G_dofmap[i].reserve(max_size_elem_dofs); }</div>
<div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;  vector &lt; vector &lt; real_num &gt; &gt; SolVAR_eldofs(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { SolVAR_eldofs[k].reserve(max_size_elem_dofs); }</div>
<div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;  </div>
<div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160; </div>
<div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;  <span class="comment">//----------- at quadrature points ------------------------------</span></div>
<div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    vector &lt; real_num &gt; SolVAR_qp(n_unknowns);</div>
<div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    vector &lt; vector &lt; real_num &gt; &gt; gradSolVAR_qp(n_unknowns);</div>
<div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    vector &lt; vector &lt; real_num &gt; &gt; gradSolVAR_hat_qp(n_unknowns);</div>
<div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { </div>
<div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;          gradSolVAR_qp[k].resize(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      gradSolVAR_hat_qp[k].resize(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    }</div>
<div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      </div>
<div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160; </div>
<div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;  <span class="comment">//=============== Physics ========================================</span></div>
<div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span>    solid_model  = solid_in.<a class="code" href="../../d3/d04/classfemus_1_1Solid.html#a19ca2da625aede63d5277cb034584718">get_physical_model</a>();</div>
<div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> mu_lame          = solid_in.<a class="code" href="../../d3/d04/classfemus_1_1Solid.html#a5f3228eab52c343a13167eaf73f568bc">get_lame_shear_modulus</a>();</div>
<div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> lambda_lame  = solid_in.<a class="code" href="../../d3/d04/classfemus_1_1Solid.html#a25307ed3e65fea474b2d74b130348e4b">get_lame_lambda</a>();</div>
<div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160; </div>
<div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> incompressible = (0.5  ==  solid_in.<a class="code" href="../../d3/d04/classfemus_1_1Solid.html#a3d971cfb0d2a1810e6b31830f1f4b900">get_poisson_coeff</a>()) ? 1 : 0;</div>
<div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> penalty = solid_in.<a class="code" href="../../d3/d04/classfemus_1_1Solid.html#a032c01f0f6e345f2818a7ffe24bad883">get_if_penalty</a>();</div>
<div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160; </div>
<div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <span class="comment">// gravity</span></div>
<div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    <span class="keywordtype">double</span> <a class="code" href="../../de/d58/solidopt__params_8hpp.html#a491774c0485f249809d76f7933b79419">_gravity</a>[3] = {1000., 0., 0.};</div>
<div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    </div>
<div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160; </div>
<div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;  <span class="comment">//-----------------------------------------</span></div>
<div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    RES-&gt;<a class="code" href="../../db/dcb/classfemus_1_1NumericVector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;  <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;<a class="code" href="../../d4/d37/classfemus_1_1SparseMatrix.html#a45654dbe423d1970565b94c792ce6df3">zero</a>();</div>
<div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;  </div>
<div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160; </div>
<div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160; </div>
<div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</div>
<div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160; </div>
<div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160; </div>
<div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;  <span class="comment">//=============== Unknowns ========================================</span></div>
<div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;    <span class="keywordtype">unsigned</span> ndofs_unk = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolFEType[k]);</div>
<div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;       Sol_n_el_dofs[k] = ndofs_unk;</div>
<div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;       SolVAR_eldofs[k].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;          L2G_dofmap[k].resize(Sol_n_el_dofs[k]); </div>
<div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; SolVAR_eldofs[k].size(); i++) {</div>
<div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;       <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolFEType[k]);</div>
<div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;       SolVAR_eldofs[k][i] = (*sol-&gt;<a class="code" href="../../d0/da2/classfemus_1_1Solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex[k]])(solDof);</div>
<div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;          L2G_dofmap[k][i] = pdeSys-&gt;<a class="code" href="../../d8/d3d/classfemus_1_1LinearEquation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(SolIndex[k], SolPdeIndex[k], i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;      }</div>
<div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    }</div>
<div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    </div>
<div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    L2G_dofmap_AllVars.resize(0);</div>
<div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++)     L2G_dofmap_AllVars.insert(L2G_dofmap_AllVars.end(),L2G_dofmap[k].begin(),L2G_dofmap[k].end());</div>
<div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160; </div>
<div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="keywordtype">unsigned</span> sum_Sol_n_el_dofs = 0;</div>
<div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) { sum_Sol_n_el_dofs += Sol_n_el_dofs[k]; }</div>
<div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    </div>
<div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    Jac.resize(sum_Sol_n_el_dofs * sum_Sol_n_el_dofs);  std::fill(Jac.begin(), Jac.end(), 0.);</div>
<div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;    Res.resize(sum_Sol_n_el_dofs);                      std::fill(Res.begin(), Res.end(), 0.);</div>
<div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">//=============== Unknowns end ========================================</span></div>
<div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    </div>
<div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    </div>
<div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;  <span class="comment">//=============== Geometry (has to come AFTER unknowns here!!!) ========================================</span></div>
<div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160; </div>
<div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    <span class="keywordtype">unsigned</span> nDofsX = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, coordsType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    assert(nDofsX == Sol_n_el_dofs[sol_pde_index_displ]);</div>
<div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    </div>
<div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ivar=0; ivar&lt;<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      coords[ivar].resize(nDofsX);</div>
<div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      coords_hat[ivar].resize(nDofsX);</div>
<div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    }</div>
<div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;    </div>
<div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;      <span class="keywordtype">unsigned</span> coordsDof  = msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, coordsType);    <span class="comment">// global to global mapping between coordinates node and coordinate dof // via local to global solution node</span></div>
<div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;          <span class="comment">//Fixed coordinates (Reference frame)</span></div>
<div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        coords_hat[ivar][i] = (*msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code" href="../../d0/da2/classfemus_1_1Solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[ivar])(coordsDof);</div>
<div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;      }</div>
<div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;    }</div>
<div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160; </div>
<div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;  <span class="comment">//***************************************  </span></div>
<div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">//Moving coordinates (Moving frame)</span></div>
<div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofsX; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;          coords[idim][<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = coords_hat[idim][<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + SolVAR_eldofs[SolIndex[idim]][<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        }</div>
<div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;      }</div>
<div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;  <span class="comment">//=============== Geometry end ========================================</span></div>
<div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;  </div>
<div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160; </div>
<div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;      </div>
<div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;     assemble_jac.prepare_before_integration_loop(stack);</div>
<div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;     </div>
<div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;  </div>
<div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a2c8b1b9f67127156c65b24ca7ba6bc46">GetQuadratureRule</a>(ielGeom).<a class="code" href="../../da/da7/classfemus_1_1Gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>(); <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160; </div>
<div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      <span class="comment">// *** get Jacobian and test function and test function derivatives ***</span></div>
<div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; n_unknowns; fe++) {</div>
<div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[fe]]-&gt;<a class="code" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,    phi_dof_qp[fe],    phi_x_dof_qp[fe],    phi_xx_dof_qp[fe]);</div>
<div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][SolFEType[fe]]-&gt;<a class="code" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,<a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_hat_qp,phi_hat_dof_qp[fe],phi_x_hat_dof_qp[fe],phi_xx_hat_dof_qp[fe]);</div>
<div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;      }</div>
<div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;      </div>
<div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;  <span class="comment">//=============== Integration at qp ========================================</span></div>
<div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;         <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN...</span></div>
<div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;         msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_qp,    phi_dof_qp_domain[d],     phi_x_dof_qp_domain[d],     phi_xx_dof_qp_domain[d]);</div>
<div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;         msh-&gt;<a class="code" href="../../d6/db7/classfemus_1_1Mesh.html#a555c4982e81fc0042426c6741a792ca2">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,<a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>, weight_hat_qp,phi_dof_qp_domain_hat[d], phi_x_dof_qp_domain_hat[d], phi_xx_dof_qp_domain_hat[d]);</div>
<div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;      }</div>
<div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160; </div>
<div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;  <span class="comment">//=============== Unknowns at qp ========================================</span></div>
<div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> unk = 0; unk &lt;  n_unknowns; unk++) {</div>
<div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;          SolVAR_qp[unk] = 0.;</div>
<div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160; </div>
<div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) { </div>
<div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;            gradSolVAR_qp[unk][ivar2] = 0.; </div>
<div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;            gradSolVAR_hat_qp[unk][ivar2] = 0.; </div>
<div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;          }</div>
<div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;          </div>
<div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[unk]; i++) {</div>
<div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;            SolVAR_qp[unk]    += phi_dof_qp[unk][i] * SolVAR_eldofs[unk][i];</div>
<div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2 &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {</div>
<div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;              gradSolVAR_qp[unk][ivar2]     += phi_x_dof_qp[unk][i*<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[unk][i]; </div>
<div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;              gradSolVAR_hat_qp[unk][ivar2] += phi_x_hat_dof_qp[unk][i*<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[unk][i]; </div>
<div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;            }</div>
<div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;          }</div>
<div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;          </div>
<div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;        }  </div>
<div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;  <span class="comment">//=============== Unknowns at qp - end ========================================</span></div>
<div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160; </div>
<div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160; </div>
<div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;<span class="comment">//     assemble_jacobian&lt; real_num, real_num_mov &gt;::mass_residual (Res, Sol_n_el_dofs, sum_Sol_n_el_dofs, SolPdeIndex, phi_dof_qp, SolVAR_qp, weight_hat_qp);</span></div>
<div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160; </div>
<div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160; </div>
<div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160; <span class="comment">//*******************************************************************************************************</span></div>
<div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;   vector &lt; vector &lt; real_num_mov &gt; &gt; Cauchy(3); <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Cauchy.size(); i++) Cauchy[i].resize(3);</div>
<div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;   real_num_mov J_hat;</div>
<div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;   real_num_mov trace_e_hat;</div>
<div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;   </div>
<div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160; </div>
<div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    Cauchy = Solid::get_Cauchy_stress_tensor&lt; real_num_mov &gt;(solid_model, mu_lame, lambda_lame, incompressible, <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, sol_pde_index_displ, sol_pde_index_press, gradSolVAR_hat_qp, SolVAR_qp, SolPdeIndex, J_hat, trace_e_hat);</div>
<div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160; </div>
<div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    </div>
<div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160; </div>
<div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;              <span class="comment">//BEGIN residual Solid Momentum in moving domain</span></div>
<div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_pde_index_displ]; i++) {</div>
<div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160; </div>
<div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;              real_num_mov Cauchy_direction[3] = {0., 0., 0.};</div>
<div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160; </div>
<div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0.; idim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jdim = 0.; jdim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;                  Cauchy_direction[idim] += phi_x_dof_qp[ SolPdeIndex[sol_pde_index_displ + idim] ][i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + jdim] * Cauchy[idim][jdim];</div>
<div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;                }</div>
<div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;              }</div>
<div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160; </div>
<div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;                Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[sol_pde_index_displ + idim], i) ] += ( Cauchy_direction[idim] -  phi_dof_qp[SolPdeIndex[sol_pde_index_displ+idim]][i] * <a class="code" href="../../de/d58/solidopt__params_8hpp.html#a491774c0485f249809d76f7933b79419">_gravity</a>[idim] ) * weight_qp;</div>
<div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;              }</div>
<div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160; </div>
<div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;            }</div>
<div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;              <span class="comment">//END residual Solid Momentum in moving domain</span></div>
<div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;              </div>
<div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160; </div>
<div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;              <span class="comment">//BEGIN residual solid mass balance in reference domain</span></div>
<div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_pde_index_press]; i++) {</div>
<div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;                </div>
<div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;              Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[sol_pde_index_press], i) ] += </div>
<div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;              weight_hat_qp * phi_dof_qp[SolPdeIndex[sol_pde_index_press]][i] * Solid::get_mass_balance_reference_domain&lt; real_num_mov &gt;(solid_model, penalty, incompressible, lambda_lame, trace_e_hat, J_hat, SolVAR_qp, SolPdeIndex, sol_pde_index_press);</div>
<div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;<span class="comment">//               weight_qp * phi_dof_qp[sol_pde_index_press][i] * Solid::get_mass_balance_moving_domain&lt; real_num_mov &gt;(gradSolVAR_qp, SolPdeIndex);</span></div>
<div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;                </div>
<div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            }</div>
<div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;              <span class="comment">//END residual solid mass balance in reference domain</span></div>
<div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160; </div>
<div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160; </div>
<div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    } <span class="comment">// end gauss point loop</span></div>
<div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160; </div>
<div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160; </div>
<div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160; </div>
<div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="keywordflow">if</span> (assembleMatrix) assemble_jac.compute_jacobian_outside_integration_loop(stack, SolVAR_eldofs, Res, Jac, L2G_dofmap_AllVars, RES, JAC);</div>
<div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160; </div>
<div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#af1d28f6f33acdba64d6e3c733d09f0aa">assemble_jacobian&lt;real_num,real_num_mov&gt;::print_element_residual</a>(iel, Res, Sol_n_el_dofs, 9, 5);</div>
<div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a76626a28a3fa87cc055e76d189ed4660">assemble_jacobian&lt;real_num,real_num_mov&gt;::print_element_jacobian</a>(iel, Jac, Sol_n_el_dofs, 9, 5);</div>
<div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    </div>
<div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;  } <span class="comment">//end element loop for each process</span></div>
<div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160; </div>
<div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160; </div>
<div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160; <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;<a class="code" href="../../d4/d37/classfemus_1_1SparseMatrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">close</a>();</div>
<div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;                     RES-&gt;<a class="code" href="../../db/dcb/classfemus_1_1NumericVector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;  </div>
<div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;  </div>
<div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;  </div>
<div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;    <span class="comment">//print JAC and RES to files</span></div>
<div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;<span class="comment">//     const unsigned nonlin_iter = mlPdeSys-&gt;GetNonlinearIt();</span></div>
<div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;<span class="comment">//     assemble_jacobian&lt; real_num_mov,double &gt;::print_global_jacobian(assembleMatrix, ml_prob, JAC, nonlin_iter);</span></div>
<div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;<span class="comment">//     assemble_jacobian&lt; real_num_mov,double &gt;::print_global_residual(ml_prob, RES, nonlin_iter);</span></div>
<div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160; </div>
<div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;  </div>
<div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;}</div>
<div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160; </div>
<div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160; </div>
<div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160; </div>
<div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160; </div>
<div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;<span class="keyword">template</span> &lt; <span class="keyword">class</span> real_num &gt; </div>
<div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;<span class="keyword">const</span> <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html">MultiLevelSolution</a>  <a class="code" href="../../dd/dc9/classSolution__generation__1.html#a2a0001fac52be7a97cc9cc3c901c5f9f">Solution_generation_1&lt; real_num &gt;::run_on_single_level</a>(<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a> &amp; ml_prob,</div>
<div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;                                                                                <a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html">MultiLevelMesh</a> &amp; ml_mesh,</div>
<div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;                                                                                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> lev,</div>
<div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;                                                                               <span class="keyword">const</span> std::vector&lt; Unknown &gt; &amp;  unknowns,  </div>
<div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;                                                                                <span class="keyword">const</span> std::vector&lt; <a class="code" href="../../db/dc9/classfemus_1_1Math_1_1Function.html">Math::Function&lt; double &gt;</a> * &gt; &amp;  exact_sol,</div>
<div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;                                                                                 <span class="keyword">const</span> <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html#a51e1cff061477ba02672e5ef790c465f">MultiLevelSolution::InitFuncMLProb</a> SetInitialCondition_in,</div>
<div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;                                                                               <span class="keyword">const</span> <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html#ac2ecfa36125c8626b6fdf20f71dbde0c">MultiLevelSolution::BoundaryFuncMLProb</a> SetBoundaryCondition_in,</div>
<div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;                                                  <span class="keyword">const</span> <span class="keywordtype">bool</span> equation_sol</div>
<div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;                                                                                 )<span class="keyword"> const </span>{</div>
<div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;                                                                                    </div>
<div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  <span class="comment">// ======= Mesh  ==================</span></div>
<div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;            <span class="keywordtype">unsigned</span> <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> = lev + 1;  <span class="comment">//this has to have a + 1 for the convergence study</span></div>
<div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;            <span class="keywordtype">unsigned</span> numberOfSelectiveLevels = 0;</div>
<div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;            ml_mesh.<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a06c4fe014434c2bafdd2c6e94e018620">RefineMesh</a>(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> , <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> + numberOfSelectiveLevels, NULL);</div>
<div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;            ml_mesh.<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#ac474afe18c6be4e181b2bb72695f57e9">EraseCoarseLevels</a>(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a> - 1);</div>
<div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160; </div>
<div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;            ml_mesh.<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a09c12975f18035d5369ae411c0208648">PrintInfo</a>();</div>
<div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;                                                                                    </div>
<div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;  <span class="comment">// ======= Solution  ==================</span></div>
<div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  <a class="code" href="../../db/d17/classfemus_1_1MultiLevelSolution.html">MultiLevelSolution</a> ml_sol(&amp;ml_mesh);</div>
<div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;  </div>
<div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;  ml_sol.SetWriter(<a class="code" href="../../d1/d89/WriterEnum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a>);</div>
<div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;  ml_sol.GetWriter()-&gt;SetDebugOutput(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160; </div>
<div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  <span class="comment">// ======= Problem ========================</span></div>
<div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;  ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#ad86fcf047c83e4a719e09455a2fa247a">SetMultiLevelMeshAndSolution</a>(&amp; ml_sol);</div>
<div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160; </div>
<div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;  ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#ab3dfba9dd931564038c9a800e76d45ce">get_systems_map</a>().clear();</div>
<div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    </div>
<div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;  <span class="comment">//Material  ==================</span></div>
<div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;              <span class="comment">//Nondimensional quantity (Lref,Uref)</span></div>
<div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> Lref = 1.;</div>
<div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> Uref = 1.;</div>
<div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;            <a class="code" href="../../d0/d0e/classfemus_1_1Parameter.html">Parameter</a> par(Lref,Uref);</div>
<div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            </div>
<div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;            <span class="comment">// Generate Solid Object</span></div>
<div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> E = 1500000;</div>
<div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> ni = 0.5;</div>
<div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> rhos = 1000;</div>
<div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;            <span class="keyword">const</span> <a class="code" href="../../d3/d04/classfemus_1_1Solid.html">Solid</a> solid(par, E, ni, rhos, <a class="code" href="../../d5/d7e/00__solid__state_8cpp.html#a7c60e913478d07a44ac15c6fb2c5937f">MODEL</a>);</div>
<div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160; </div>
<div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;            std::cout &lt;&lt; <span class="stringliteral">&quot;Solid properties: &quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;            std::cout &lt;&lt; solid &lt;&lt; std::endl;</div>
<div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;            </div>
<div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;            ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a537b31965e5402b9c9febebce96ce01c">parameters</a>.<a class="code" href="../../d1/daa/classfemus_1_1Parameters.html#a552a70edef7b7d9119b1cd4797af776b">set</a>&lt;<a class="code" href="../../d3/d04/classfemus_1_1Solid.html">Solid</a>&gt;(<span class="stringliteral">&quot;Solid&quot;</span>) = solid;</div>
<div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;  <span class="comment">//Material end ==================</span></div>
<div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160; </div>
<div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;  <span class="comment">// ======= Solution, II ==================</span></div>
<div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160; </div>
<div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;  ml_sol.AttachSetBoundaryConditionFunction(SetBoundaryCondition_in);</div>
<div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++)  {</div>
<div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    ml_sol.AddSolution(unknowns[u]._name.c_str(), unknowns[u]._fe_family, unknowns[u]._fe_order, unknowns[u]._time_order, unknowns[u]._is_pde_unknown);</div>
<div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;  <span class="comment">//initial conditions</span></div>
<div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;    ml_sol.Initialize(unknowns[u]._name.c_str(), SetInitialCondition_in, &amp;ml_prob);</div>
<div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;  <span class="comment">//boundary conditions</span></div>
<div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;  ml_sol.GenerateBdc(unknowns[u]._name.c_str(), <span class="stringliteral">&quot;Steady&quot;</span>, &amp; ml_prob);</div>
<div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;  }</div>
<div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160; </div>
<div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;  <span class="comment">// ======= System ========================</span></div>
<div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;  <a class="code" href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html">NonLinearImplicitSystem</a>&amp; system = ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#ad54bc6b7254d2331491ac48b58a2d9e3">add_system</a> &lt; <a class="code" href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html">NonLinearImplicitSystem</a> &gt; (<span class="stringliteral">&quot;SolidMech&quot;</span>);</div>
<div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160; </div>
<div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++)   system.<a class="code" href="../../d4/d23/classfemus_1_1System.html#a606e07526d7a0d31eed638404ee2ed24">AddSolutionToSystemPDE</a>(unknowns[u]._name.c_str());</div>
<div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160; </div>
<div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  system.<a class="code" href="../../d4/d23/classfemus_1_1System.html#ae3c161c5a12d55227effe9acf01b6535">set_unknown_list_for_assembly</a>(unknowns); </div>
<div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;            </div>
<div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;  system.<a class="code" href="../../d4/d23/classfemus_1_1System.html#a42a5b5b5d2c7673b1d4c896762d8db9e">SetAssembleFunction</a>( AssembleSolidMech&lt; NonLinearImplicitSystem, adept::adouble, adept::adouble &gt;);</div>
<div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160; </div>
<div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;  <span class="comment">// initialize and solve the system</span></div>
<div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;  system.<a class="code" href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html#ad2d20975e0c919a9d99bdd9368a0212a">init</a>();</div>
<div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;  </div>
<div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;  <span class="comment">// Solver and preconditioner</span></div>
<div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  system.<a class="code" href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#ad0a0195fe959aca497e2a7251b43405b">SetOuterSolver</a>(<a class="code" href="../../d5/d02/SolvertypeEnum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>);</div>
<div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;  system.<a class="code" href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#a03b082409d094d87e46e023356c4cb8e">SetSolverFineGrids</a>(<a class="code" href="../../d5/d02/SolvertypeEnum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a>);</div>
<div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;  system.<a class="code" href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#aaff342b69e3dd0e77a1bc084030f795c">SetPreconditionerFineGrids</a>(<a class="code" href="../../d3/d2d/PrecondtypeEnum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfad035adc4d5a17adbb5db52fa62a98f88">LU_PRECOND</a>);</div>
<div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160; </div>
<div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;  <span class="comment">//for Vanka   </span></div>
<div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;  system.<a class="code" href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#a71658025becd1238e92318c950792b4b">ClearVariablesToBeSolved</a>();</div>
<div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;  system.<a class="code" href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#ab0c6f96601a00ae5f20a44bd137592b8">AddVariableToBeSolved</a>(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160; </div>
<div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;  system.<a class="code" href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html#ad263ecc83efc0d9ea26200bfa3c4cadf">SetDebugNonlinear</a>(<span class="keyword">true</span>);</div>
<div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160; </div>
<div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;<span class="comment">//   system.SetMaxNumberOfNonLinearIterations(2);</span></div>
<div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;<span class="comment">//   system.SetNonLinearConvergenceTolerance(1.e-30);</span></div>
<div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;<span class="comment">//   system.SetDebugLinear(true);</span></div>
<div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;<span class="comment">//   system.SetMaxNumberOfLinearIterations(4);</span></div>
<div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;<span class="comment">//   system.SetAbsoluteLinearConvergenceTolerance(1.e-10);</span></div>
<div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160; </div>
<div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;  system.<a class="code" href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html#a438462e18c01e8fb08358526c04c50b5">MGsolve</a>();</div>
<div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160; </div>
<div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;  <span class="comment">// ======= Print ========================</span></div>
<div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;  <span class="comment">// set moving variables</span></div>
<div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;  std::vector &lt; std::string &gt; mov_vars;</div>
<div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;  mov_vars.push_back(<span class="stringliteral">&quot;DX&quot;</span>);</div>
<div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;  mov_vars.push_back(<span class="stringliteral">&quot;DY&quot;</span>);</div>
<div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;  <span class="keywordflow">if</span> ( ml_mesh.<a class="code" href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>() == 3 ) mov_vars.push_back(<span class="stringliteral">&quot;DZ&quot;</span>);</div>
<div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  ml_sol.GetWriter()-&gt;SetMovingMesh(mov_vars);</div>
<div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;  </div>
<div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;  <span class="comment">// print solutions</span></div>
<div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;  std::vector &lt; std::string &gt; variablesToBePrinted;  variablesToBePrinted.push_back(<span class="stringliteral">&quot;All&quot;</span>);</div>
<div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;  ml_sol.GetWriter()-&gt;Write(ml_prob.<a class="code" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a17bbb9fcd25c71c60e5cddb033598a6a">GetFilesHandler</a>()-&gt;<a class="code" href="../../d4/d91/classfemus_1_1Files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>(),<span class="stringliteral">&quot;biquadratic&quot;</span>, variablesToBePrinted, lev);</div>
<div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160; </div>
<div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160; <span class="keywordflow">return</span> ml_sol;</div>
<div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160; </div>
<div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;}</div>
<div class="ttc" id="a00__solid__state_8cpp_html_a1afc17d1ddb3752caf6910ec9a7c39ef"><div class="ttname"><a href="../../d5/d7e/00__solid__state_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a></div><div class="ttdeci">bool Solution_set_boundary_conditions(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/00__solid__state_8cpp_source.html#l00047">00_solid_state.cpp:47</a></div></div>
<div class="ttc" id="a00__solid__state_8cpp_html_a5dec9191b407f5f1913e563b23777741"><div class="ttname"><a href="../../d5/d7e/00__solid__state_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a></div><div class="ttdeci">double Solution_set_initial_conditions(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/00__solid__state_8cpp_source.html#l00023">00_solid_state.cpp:23</a></div></div>
<div class="ttc" id="a00__solid__state_8cpp_html_a6917621ec8f1cbd9eda71cf3f12de89c"><div class="ttname"><a href="../../d5/d7e/00__solid__state_8cpp.html#a6917621ec8f1cbd9eda71cf3f12de89c">provide_list_of_unknowns</a></div><div class="ttdeci">const std::vector&lt; Unknown &gt; provide_list_of_unknowns(const unsigned int dimension)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/00__solid__state_8cpp_source.html#l00113">00_solid_state.cpp:113</a></div></div>
<div class="ttc" id="a00__solid__state_8cpp_html_a7a29781a20c5dd4153c3c1cecf0ff328"><div class="ttname"><a href="../../d5/d7e/00__solid__state_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a></div><div class="ttdeci">int main(int argc, char **args)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/00__solid__state_8cpp_source.html#l00178">00_solid_state.cpp:178</a></div></div>
<div class="ttc" id="a00__solid__state_8cpp_html_a7c60e913478d07a44ac15c6fb2c5937f"><div class="ttname"><a href="../../d5/d7e/00__solid__state_8cpp.html#a7c60e913478d07a44ac15c6fb2c5937f">MODEL</a></div><div class="ttdeci">#define MODEL</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/00__solid__state_8cpp_source.html#l00016">00_solid_state.cpp:16</a></div></div>
<div class="ttc" id="a00__solid__state_8cpp_html_aea610d910b5d696b3e500ed9636d8367"><div class="ttname"><a href="../../d5/d7e/00__solid__state_8cpp.html#aea610d910b5d696b3e500ed9636d8367">AssembleSolidMech</a></div><div class="ttdeci">void AssembleSolidMech(MultiLevelProblem &amp;ml_prob)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d7e/00__solid__state_8cpp_source.html#l00259">00_solid_state.cpp:259</a></div></div>
<div class="ttc" id="aAssemble__jacobian_8hpp_html"><div class="ttname"><a href="../../de/d73/Assemble__jacobian_8hpp.html">Assemble_jacobian.hpp</a></div></div>
<div class="ttc" id="aElemTypeEnum_8hpp_html_a1b014294b9757a001707c979e2bab627"><div class="ttname"><a href="../../d8/d65/ElemTypeEnum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d65/ElemTypeEnum_8hpp_source.html#l00006">ElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="aElemTypeEnum_8hpp_html_a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59"><div class="ttname"><a href="../../d8/d65/ElemTypeEnum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a></div><div class="ttdeci">@ QUAD9</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d65/ElemTypeEnum_8hpp_source.html#l00016">ElemTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="aFETypeEnum_8hpp_html_a789a31c8b16fddbe5ad66911ec7933c6"><div class="ttname"><a href="../../df/d21/FETypeEnum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a></div><div class="ttdeci">#define BIQUADR_FE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d21/FETypeEnum_8hpp_source.html#l00010">FETypeEnum.hpp:10</a></div></div>
<div class="ttc" id="aFE__convergence_8hpp_html"><div class="ttname"><a href="../../d7/dd6/FE__convergence_8hpp.html">FE_convergence.hpp</a></div></div>
<div class="ttc" id="aFElemTypeEnum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="../../db/dc8/FElemTypeEnum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc8/FElemTypeEnum_8hpp_source.html#l00015">FElemTypeEnum.hpp:15</a></div></div>
<div class="ttc" id="aFElemTypeEnum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="../../db/dc8/FElemTypeEnum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc8/FElemTypeEnum_8hpp_source.html#l00018">FElemTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="aFElemTypeEnum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../db/dc8/FElemTypeEnum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition:</b> <a href="../../db/dc8/FElemTypeEnum_8hpp_source.html#l00005">FElemTypeEnum.hpp:5</a></div></div>
<div class="ttc" id="aFemusInit_8hpp_html"><div class="ttname"><a href="../../da/d0d/FemusInit_8hpp.html">FemusInit.hpp</a></div></div>
<div class="ttc" id="aFiles_8hpp_html"><div class="ttname"><a href="../../d4/dc0/Files_8hpp.html">Files.hpp</a></div></div>
<div class="ttc" id="aISM_2ex4_2ex4_8cpp_html_a0aca793820b6ff7705450e2043256938"><div class="ttname"><a href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#a0aca793820b6ff7705450e2043256938">numberOfUniformLevels</a></div><div class="ttdeci">unsigned numberOfUniformLevels</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/ISM_2ex4_2ex4_8cpp_source.html#l00089">ex4.cpp:89</a></div></div>
<div class="ttc" id="aISM_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/ISM_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="aLinearImplicitSystem_8hpp_html"><div class="ttname"><a href="../../d7/d22/LinearImplicitSystem_8hpp.html">LinearImplicitSystem.hpp</a></div></div>
<div class="ttc" id="aMGAMR_2ex9_2MG__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="aMultiLevelProblem_8hpp_html"><div class="ttname"><a href="../../da/de0/MultiLevelProblem_8hpp.html">MultiLevelProblem.hpp</a></div></div>
<div class="ttc" id="aMultiLevelSolution_8hpp_html"><div class="ttname"><a href="../../d8/d29/MultiLevelSolution_8hpp.html">MultiLevelSolution.hpp</a></div></div>
<div class="ttc" id="aNonLinearImplicitSystem_8hpp_html"><div class="ttname"><a href="../../d4/dab/NonLinearImplicitSystem_8hpp.html">NonLinearImplicitSystem.hpp</a></div></div>
<div class="ttc" id="aNumericVector_8hpp_html"><div class="ttname"><a href="../../df/d05/NumericVector_8hpp.html">NumericVector.hpp</a></div></div>
<div class="ttc" id="aParameter_8hpp_html"><div class="ttname"><a href="../../db/dce/Parameter_8hpp.html">Parameter.hpp</a></div></div>
<div class="ttc" id="aPrecondtypeEnum_8hpp_html_a8b341faac6531c4543c9dc6e5e4592cfad035adc4d5a17adbb5db52fa62a98f88"><div class="ttname"><a href="../../d3/d2d/PrecondtypeEnum_8hpp.html#a8b341faac6531c4543c9dc6e5e4592cfad035adc4d5a17adbb5db52fa62a98f88">LU_PRECOND</a></div><div class="ttdeci">@ LU_PRECOND</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d2d/PrecondtypeEnum_8hpp_source.html#l00017">PrecondtypeEnum.hpp:17</a></div></div>
<div class="ttc" id="aSolid_8hpp_html"><div class="ttname"><a href="../../dc/df5/Solid_8hpp.html">Solid.hpp</a></div></div>
<div class="ttc" id="aSolvertypeEnum_8hpp_html_a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab"><div class="ttname"><a href="../../d5/d02/SolvertypeEnum_8hpp.html#a8b06041d7c1fb05f379714f4312306ecaac04ac264cd7722642583eccd43a75ab">PREONLY</a></div><div class="ttdeci">@ PREONLY</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d02/SolvertypeEnum_8hpp_source.html#l00028">SolvertypeEnum.hpp:27</a></div></div>
<div class="ttc" id="aVTKWriter_8hpp_html"><div class="ttname"><a href="../../d5/d64/VTKWriter_8hpp.html">VTKWriter.hpp</a></div></div>
<div class="ttc" id="aWriterEnum_8hpp_html_a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67"><div class="ttname"><a href="../../d1/d89/WriterEnum_8hpp.html#a18b827c3c1f62b8a57febdcad0c871a8a37fb55ddbbe1465cec5f3d154db73e67">VTK</a></div><div class="ttdeci">@ VTK</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d89/WriterEnum_8hpp_source.html#l00004">WriterEnum.hpp:4</a></div></div>
<div class="ttc" id="aclassSolution__generation__1_html"><div class="ttname"><a href="../../dd/dc9/classSolution__generation__1.html">Solution_generation_1</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/ex02__poisson__convergence_8cpp_source.html#l00116">ex02_poisson_convergence.cpp:116</a></div></div>
<div class="ttc" id="aclassSolution__generation__1_html_a2a0001fac52be7a97cc9cc3c901c5f9f"><div class="ttname"><a href="../../dd/dc9/classSolution__generation__1.html#a2a0001fac52be7a97cc9cc3c901c5f9f">Solution_generation_1::run_on_single_level</a></div><div class="ttdeci">const MultiLevelSolution run_on_single_level(MultiLevelProblem &amp;ml_prob, MultiLevelMesh &amp;ml_mesh, const unsigned i, const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; Math::Function&lt; double &gt; * &gt; &amp;exact_sol, const MultiLevelSolution::InitFuncMLProb SetInitialCondition_in, const MultiLevelSolution::BoundaryFuncMLProb SetBoundaryCondition_in, const bool equation_solve) const</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d2b/ex02__poisson__convergence_8cpp_source.html#l00307">ex02_poisson_convergence.cpp:307</a></div></div>
<div class="ttc" id="aclassSolution__generation__1_html_a68765d1e79777165c518157310035844"><div class="ttname"><a href="../../dd/dc9/classSolution__generation__1.html#a68765d1e79777165c518157310035844">Solution_generation_1::run_on_single_level</a></div><div class="ttdeci">const MultiLevelSolution run_on_single_level(MultiLevelProblem &amp;ml_prob, MultiLevelMesh &amp;ml_mesh, const unsigned i, const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; Math::Function&lt; double &gt; * &gt; &amp;exact_sol, const MultiLevelSolution::InitFuncMLProb SetInitialCondition_in, const MultiLevelSolution::BoundaryFuncMLProb SetBoundaryCondition_in, const bool equation_sol) const</div></div>
<div class="ttc" id="aclassfemus_1_1FE__convergence_html"><div class="ttname"><a href="../../dd/d36/classfemus_1_1FE__convergence.html">femus::FE_convergence</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd6/FE__convergence_8hpp_source.html#l00041">FE_convergence.hpp:41</a></div></div>
<div class="ttc" id="aclassfemus_1_1FE__convergence_html_a456fb5ad6cbd7cf1322725a317a00d49"><div class="ttname"><a href="../../dd/d36/classfemus_1_1FE__convergence.html#a456fb5ad6cbd7cf1322725a317a00d49">femus::FE_convergence::convergence_study</a></div><div class="ttdeci">void convergence_study(MultiLevelProblem &amp;ml_prob, MultiLevelMesh &amp;ml_mesh, MultiLevelMesh &amp;ml_mesh_all_levels, const unsigned max_number_of_meshes, const unsigned norm_flag, const unsigned conv_rate_computation_method, const unsigned volume_or_boundary, const bool equation_solve, const Solution_generation_single_level &amp;main_in, const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; Math::Function&lt; double &gt; * &gt; &amp;exact_sol, const MultiLevelSolution::InitFuncMLProb SetInitialCondition, const MultiLevelSolution::BoundaryFuncMLProb SetBoundaryCondition)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd6/FE__convergence_8hpp_source.html#l00138">FE_convergence.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1FemusInit_html"><div class="ttname"><a href="../../d6/d8c/classfemus_1_1FemusInit.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0d/FemusInit_8hpp_source.html#l00049">FemusInit.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1FemusInit_html_ab48c1191eb7ebb370a323d3ec4f713c9"><div class="ttname"><a href="../../d6/d8c/classfemus_1_1FemusInit.html#ab48c1191eb7ebb370a323d3ec4f713c9">femus::FemusInit::_adeptStack</a></div><div class="ttdeci">static adept::Stack _adeptStack</div><div class="ttdef"><b>Definition:</b> <a href="../../da/d0d/FemusInit_8hpp_source.html#l00059">FemusInit.hpp:59</a></div></div>
<div class="ttc" id="aclassfemus_1_1Files_html"><div class="ttname"><a href="../../d4/d91/classfemus_1_1Files.html">femus::Files</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc0/Files_8hpp_source.html#l00040">Files.hpp:40</a></div></div>
<div class="ttc" id="aclassfemus_1_1Files_html_aac199200ffda7ba50611cc41f6a874bc"><div class="ttname"><a href="../../d4/d91/classfemus_1_1Files.html#aac199200ffda7ba50611cc41f6a874bc">femus::Files::RedirectCout</a></div><div class="ttdeci">void RedirectCout(const bool redirect_cout_to_file) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d19/Files_8cpp_source.html#l00553">Files.cpp:553</a></div></div>
<div class="ttc" id="aclassfemus_1_1Files_html_ab8c41974c4980d87c7e1467b153854e6"><div class="ttname"><a href="../../d4/d91/classfemus_1_1Files.html#ab8c41974c4980d87c7e1467b153854e6">femus::Files::CheckIODirectories</a></div><div class="ttdeci">void CheckIODirectories(const bool use_output_time_folder)</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d19/Files_8cpp_source.html#l00515">Files.cpp:515</a></div></div>
<div class="ttc" id="aclassfemus_1_1Files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="../../d4/d91/classfemus_1_1Files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dc0/Files_8hpp_source.html#l00064">Files.hpp:64</a></div></div>
<div class="ttc" id="aclassfemus_1_1Gauss_html_ab1eb96997b69ce4ebec7283eb3bf1c01"><div class="ttname"><a href="../../da/da7/classfemus_1_1Gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">femus::Gauss::GetGaussPointsNumber</a></div><div class="ttdeci">const unsigned GetGaussPointsNumber() const</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d9d/GaussPoints_8hpp_source.html#l00136">GaussPoints.hpp:136</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearEquationSolver_html"><div class="ttname"><a href="../../d7/d8c/classfemus_1_1LinearEquationSolver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d37/LinearEquationSolver_8hpp_source.html#l00055">LinearEquationSolver.hpp:55</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearEquation_html_a20ac8999e714492516cd8a2be53fb54f"><div class="ttname"><a href="../../d8/d3d/classfemus_1_1LinearEquation.html#a20ac8999e714492516cd8a2be53fb54f">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition:</b> <a href="../../de/de2/LinearEquation_8hpp_source.html#l00115">LinearEquation.hpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearEquation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="../../d8/d3d/classfemus_1_1LinearEquation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d45/LinearEquation_8cpp_source.html#l00071">LinearEquation.cpp:71</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearEquation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="../../d8/d3d/classfemus_1_1LinearEquation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition:</b> <a href="../../de/de2/LinearEquation_8hpp_source.html#l00118">LinearEquation.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearImplicitSystem_html_a03b082409d094d87e46e023356c4cb8e"><div class="ttname"><a href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#a03b082409d094d87e46e023356c4cb8e">femus::LinearImplicitSystem::SetSolverFineGrids</a></div><div class="ttdeci">void SetSolverFineGrids(const SolverType &amp;solvertype)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d76/LinearImplicitSystem_8cpp_source.html#l01029">LinearImplicitSystem.cpp:1029</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearImplicitSystem_html_a71658025becd1238e92318c950792b4b"><div class="ttname"><a href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#a71658025becd1238e92318c950792b4b">femus::LinearImplicitSystem::ClearVariablesToBeSolved</a></div><div class="ttdeci">void ClearVariablesToBeSolved()</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d76/LinearImplicitSystem_8cpp_source.html#l00975">LinearImplicitSystem.cpp:975</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearImplicitSystem_html_aaff342b69e3dd0e77a1bc084030f795c"><div class="ttname"><a href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#aaff342b69e3dd0e77a1bc084030f795c">femus::LinearImplicitSystem::SetPreconditionerFineGrids</a></div><div class="ttdeci">void SetPreconditionerFineGrids(const PreconditionerType &amp;preconditioner_type)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d76/LinearImplicitSystem_8cpp_source.html#l01047">LinearImplicitSystem.cpp:1047</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearImplicitSystem_html_ab0c6f96601a00ae5f20a44bd137592b8"><div class="ttname"><a href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#ab0c6f96601a00ae5f20a44bd137592b8">femus::LinearImplicitSystem::AddVariableToBeSolved</a></div><div class="ttdeci">void AddVariableToBeSolved(const char solname[])</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d76/LinearImplicitSystem_8cpp_source.html#l00944">LinearImplicitSystem.cpp:944</a></div></div>
<div class="ttc" id="aclassfemus_1_1LinearImplicitSystem_html_ad0a0195fe959aca497e2a7251b43405b"><div class="ttname"><a href="../../d7/d82/classfemus_1_1LinearImplicitSystem.html#ad0a0195fe959aca497e2a7251b43405b">femus::LinearImplicitSystem::SetOuterSolver</a></div><div class="ttdeci">void SetOuterSolver(const SolverType &amp;mgOuterSolver)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/d22/LinearImplicitSystem_8hpp_source.html#l00184">LinearImplicitSystem.hpp:184</a></div></div>
<div class="ttc" id="aclassfemus_1_1Math_1_1Function_html"><div class="ttname"><a href="../../db/dc9/classfemus_1_1Math_1_1Function.html">femus::Math::Function&lt; double &gt;</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/Mesh_8hpp_source.html#l00048">Mesh.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_a555c4982e81fc0042426c6741a792ca2"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#a555c4982e81fc0042426c6741a792ca2">femus::Mesh::_finiteElement</a></div><div class="ttdeci">const elem_type * _finiteElement[N_GEOM_ELS][5]</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/Mesh_8hpp_source.html#l00321">Mesh.hpp:321</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/Mesh_8hpp_source.html#l00159">Mesh.hpp:159</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcc/Mesh_8cpp_source.html#l01222">Mesh.cpp:1222</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/Mesh_8hpp_source.html#l00074">Mesh.hpp:74</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/Mesh_8hpp_source.html#l00464">Mesh.hpp:464</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition:</b> <a href="../../d1/d62/Mesh_8hpp_source.html#l00162">Mesh.hpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcc/Mesh_8cpp_source.html#l00902">Mesh.cpp:902</a></div></div>
<div class="ttc" id="aclassfemus_1_1Mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="../../d6/db7/classfemus_1_1Mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/dcc/Mesh_8cpp_source.html#l01212">Mesh.cpp:1212</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelMesh_html"><div class="ttname"><a href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d21/MultiLevelMesh_8hpp_source.html#l00046">MultiLevelMesh.hpp:46</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelMesh_html_a06c4fe014434c2bafdd2c6e94e018620"><div class="ttname"><a href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a06c4fe014434c2bafdd2c6e94e018620">femus::MultiLevelMesh::RefineMesh</a></div><div class="ttdeci">void RefineMesh(const unsigned short &amp;igridn, const unsigned short &amp;igridr, bool(*SetRefinementFlag)(const std::vector&lt; double &gt; &amp;x, const int &amp;ElemGroupNumber, const int &amp;level))</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc9/MultiLevelMesh_8cpp_source.html#l00495">MultiLevelMesh.cpp:495</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelMesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc9/MultiLevelMesh_8cpp_source.html#l00472">MultiLevelMesh.cpp:472</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelMesh_html_a09c12975f18035d5369ae411c0208648"><div class="ttname"><a href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a09c12975f18035d5369ae411c0208648">femus::MultiLevelMesh::PrintInfo</a></div><div class="ttdeci">void PrintInfo()</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc9/MultiLevelMesh_8cpp_source.html#l00462">MultiLevelMesh.cpp:462</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelMesh_html_a65dabdf1e308c1a44ebe5c6a41d09284"><div class="ttname"><a href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">femus::MultiLevelMesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc9/MultiLevelMesh_8cpp_source.html#l00541">MultiLevelMesh.cpp:541</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelMesh_html_ac474afe18c6be4e181b2bb72695f57e9"><div class="ttname"><a href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#ac474afe18c6be4e181b2bb72695f57e9">femus::MultiLevelMesh::EraseCoarseLevels</a></div><div class="ttdeci">void EraseCoarseLevels(unsigned levels_to_be_erased)</div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dc9/MultiLevelMesh_8cpp_source.html#l00449">MultiLevelMesh.cpp:449</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelMesh_html_ae5e4557f7784330822b988d83e2b6a40"><div class="ttname"><a href="../../d7/d9c/classfemus_1_1MultiLevelMesh.html#ae5e4557f7784330822b988d83e2b6a40">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d21/MultiLevelMesh_8hpp_source.html#l00147">MultiLevelMesh.hpp:147</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00054">MultiLevelProblem.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a17bbb9fcd25c71c60e5cddb033598a6a"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a17bbb9fcd25c71c60e5cddb033598a6a">femus::MultiLevelProblem::GetFilesHandler</a></div><div class="ttdeci">const Files * GetFilesHandler() const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00425">MultiLevelProblem.hpp:425</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a2c8b1b9f67127156c65b24ca7ba6bc46"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a2c8b1b9f67127156c65b24ca7ba6bc46">femus::MultiLevelProblem::GetQuadratureRule</a></div><div class="ttdeci">const Gauss &amp; GetQuadratureRule(const unsigned geom_elem_type) const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00282">MultiLevelProblem.hpp:282</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a537b31965e5402b9c9febebce96ce01c"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a537b31965e5402b9c9febebce96ce01c">femus::MultiLevelProblem::parameters</a></div><div class="ttdeci">Parameters parameters</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00397">MultiLevelProblem.hpp:397</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a623bdc2aefd83cf0c6d74fc265ee5c3f"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a623bdc2aefd83cf0c6d74fc265ee5c3f">femus::MultiLevelProblem::SetFilesHandler</a></div><div class="ttdeci">void SetFilesHandler(const Files *files_in)</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00423">MultiLevelProblem.hpp:423</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a6dd8fec26a0ffbaae07e6df7ea42d12b"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">femus::MultiLevelProblem::_ml_sol</a></div><div class="ttdeci">MultiLevelSolution * _ml_sol</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00079">MultiLevelProblem.hpp:79</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a8b72e984b63d5ff97c1e7a0f0a5eee5a"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a8b72e984b63d5ff97c1e7a0f0a5eee5a">femus::MultiLevelProblem::SetQuadratureRuleAllGeomElems</a></div><div class="ttdeci">void SetQuadratureRuleAllGeomElems(const std::string quadr_order_in)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/MultiLevelProblem_8cpp_source.html#l00177">MultiLevelProblem.cpp:177</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00116">MultiLevelProblem.hpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_ab3dfba9dd931564038c9a800e76d45ce"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#ab3dfba9dd931564038c9a800e76d45ce">femus::MultiLevelProblem::get_systems_map</a></div><div class="ttdeci">std::map&lt; std::string, System * &gt; &amp; get_systems_map()</div><div class="ttdef"><b>Definition:</b> <a href="../../da/de0/MultiLevelProblem_8hpp_source.html#l00150">MultiLevelProblem.hpp:150</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_ad54bc6b7254d2331491ac48b58a2d9e3"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#ad54bc6b7254d2331491ac48b58a2d9e3">femus::MultiLevelProblem::add_system</a></div><div class="ttdeci">virtual System &amp; add_system(const std::string &amp;system_type, const std::string &amp;name)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/MultiLevelProblem_8cpp_source.html#l00077">MultiLevelProblem.cpp:77</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelProblem_html_ad86fcf047c83e4a719e09455a2fa247a"><div class="ttname"><a href="../../d8/d26/classfemus_1_1MultiLevelProblem.html#ad86fcf047c83e4a719e09455a2fa247a">femus::MultiLevelProblem::SetMultiLevelMeshAndSolution</a></div><div class="ttdeci">void SetMultiLevelMeshAndSolution(MultiLevelSolution *ml_sol)</div><div class="ttdef"><b>Definition:</b> <a href="../../d2/d24/MultiLevelProblem_8cpp_source.html#l00068">MultiLevelProblem.cpp:68</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelSolution_html"><div class="ttname"><a href="../../db/d17/classfemus_1_1MultiLevelSolution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/MultiLevelSolution_8hpp_source.html#l00043">MultiLevelSolution.hpp:43</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelSolution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="../../db/d17/classfemus_1_1MultiLevelSolution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d43/MultiLevelSolution_8cpp_source.html#l00444">MultiLevelSolution.cpp:444</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelSolution_html_a51e1cff061477ba02672e5ef790c465f"><div class="ttname"><a href="../../db/d17/classfemus_1_1MultiLevelSolution.html#a51e1cff061477ba02672e5ef790c465f">femus::MultiLevelSolution::InitFuncMLProb</a></div><div class="ttdeci">double(* InitFuncMLProb)(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/MultiLevelSolution_8hpp_source.html#l00244">MultiLevelSolution.hpp:244</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelSolution_html_ac2ecfa36125c8626b6fdf20f71dbde0c"><div class="ttname"><a href="../../db/d17/classfemus_1_1MultiLevelSolution.html#ac2ecfa36125c8626b6fdf20f71dbde0c">femus::MultiLevelSolution::BoundaryFuncMLProb</a></div><div class="ttdeci">bool(* BoundaryFuncMLProb)(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[], double &amp;value, const int FaceName, const double time)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/MultiLevelSolution_8hpp_source.html#l00333">MultiLevelSolution.hpp:333</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelSolution_html_ac6285c5a1907ad1f93ad7b380a08dabe"><div class="ttname"><a href="../../db/d17/classfemus_1_1MultiLevelSolution.html#ac6285c5a1907ad1f93ad7b380a08dabe">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">int GetSolutionType(unsigned i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/MultiLevelSolution_8hpp_source.html#l00186">MultiLevelSolution.hpp:186</a></div></div>
<div class="ttc" id="aclassfemus_1_1MultiLevelSolution_html_afe428eaa84d414762c4cc3b8a1d4f4a7"><div class="ttname"><a href="../../db/d17/classfemus_1_1MultiLevelSolution.html#afe428eaa84d414762c4cc3b8a1d4f4a7">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d29/MultiLevelSolution_8hpp_source.html#l00138">MultiLevelSolution.hpp:138</a></div></div>
<div class="ttc" id="aclassfemus_1_1NonLinearImplicitSystem_html"><div class="ttname"><a href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html">femus::NonLinearImplicitSystem</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d4/dab/NonLinearImplicitSystem_8hpp_source.html#l00035">NonLinearImplicitSystem.hpp:35</a></div></div>
<div class="ttc" id="aclassfemus_1_1NonLinearImplicitSystem_html_a438462e18c01e8fb08358526c04c50b5"><div class="ttname"><a href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html#a438462e18c01e8fb08358526c04c50b5">femus::NonLinearImplicitSystem::MGsolve</a></div><div class="ttdeci">virtual void MGsolve(const MgSmootherType &amp;mgSmootherType=MULTIPLICATIVE)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da8/NonLinearImplicitSystem_8cpp_source.html#l00155">NonLinearImplicitSystem.cpp:155</a></div></div>
<div class="ttc" id="aclassfemus_1_1NonLinearImplicitSystem_html_ad263ecc83efc0d9ea26200bfa3c4cadf"><div class="ttname"><a href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html#ad263ecc83efc0d9ea26200bfa3c4cadf">femus::NonLinearImplicitSystem::SetDebugNonlinear</a></div><div class="ttdeci">void SetDebugNonlinear(const bool my_value)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da8/NonLinearImplicitSystem_8cpp_source.html#l00101">NonLinearImplicitSystem.cpp:101</a></div></div>
<div class="ttc" id="aclassfemus_1_1NonLinearImplicitSystem_html_ad2d20975e0c919a9d99bdd9368a0212a"><div class="ttname"><a href="../../d5/d10/classfemus_1_1NonLinearImplicitSystem.html#ad2d20975e0c919a9d99bdd9368a0212a">femus::NonLinearImplicitSystem::init</a></div><div class="ttdeci">virtual void init()</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/da8/NonLinearImplicitSystem_8cpp_source.html#l00047">NonLinearImplicitSystem.cpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1NumericVector_html"><div class="ttname"><a href="../../db/dcb/classfemus_1_1NumericVector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition:</b> <a href="../../df/d05/NumericVector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1NumericVector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="../../db/dcb/classfemus_1_1NumericVector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1NumericVector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="../../db/dcb/classfemus_1_1NumericVector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1ParallelObject_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../d2/df1/classfemus_1_1ParallelObject.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition:</b> <a href="../../db/db9/ParallelObject_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1Parameter_html"><div class="ttname"><a href="../../d0/d0e/classfemus_1_1Parameter.html">femus::Parameter</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/dce/Parameter_8hpp_source.html#l00028">Parameter.hpp:28</a></div></div>
<div class="ttc" id="aclassfemus_1_1Parameters_html_a419ddd3d0965dbca868a5072249b8374"><div class="ttname"><a href="../../d1/daa/classfemus_1_1Parameters.html#a419ddd3d0965dbca868a5072249b8374">femus::Parameters::get</a></div><div class="ttdeci">const T &amp; get(const std::string &amp;) const</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d93/Parameters_8hpp_source.html#l00414">Parameters.hpp:414</a></div></div>
<div class="ttc" id="aclassfemus_1_1Parameters_html_a552a70edef7b7d9119b1cd4797af776b"><div class="ttname"><a href="../../d1/daa/classfemus_1_1Parameters.html#a552a70edef7b7d9119b1cd4797af776b">femus::Parameters::set</a></div><div class="ttdeci">T &amp; set(const std::string &amp;)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d93/Parameters_8hpp_source.html#l00450">Parameters.hpp:450</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solid_html"><div class="ttname"><a href="../../d3/d04/classfemus_1_1Solid.html">femus::Solid</a></div><div class="ttdef"><b>Definition:</b> <a href="../../dc/df5/Solid_8hpp_source.html#l00036">Solid.hpp:36</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solid_html_a032c01f0f6e345f2818a7ffe24bad883"><div class="ttname"><a href="../../d3/d04/classfemus_1_1Solid.html#a032c01f0f6e345f2818a7ffe24bad883">femus::Solid::get_if_penalty</a></div><div class="ttdeci">const bool get_if_penalty() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da6/Solid_8cpp_source.html#l00161">Solid.cpp:161</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solid_html_a19ca2da625aede63d5277cb034584718"><div class="ttname"><a href="../../d3/d04/classfemus_1_1Solid.html#a19ca2da625aede63d5277cb034584718">femus::Solid::get_physical_model</a></div><div class="ttdeci">const unsigned get_physical_model() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da6/Solid_8cpp_source.html#l00141">Solid.cpp:141</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solid_html_a25307ed3e65fea474b2d74b130348e4b"><div class="ttname"><a href="../../d3/d04/classfemus_1_1Solid.html#a25307ed3e65fea474b2d74b130348e4b">femus::Solid::get_lame_lambda</a></div><div class="ttdeci">const double get_lame_lambda() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da6/Solid_8cpp_source.html#l00153">Solid.cpp:153</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solid_html_a3d971cfb0d2a1810e6b31830f1f4b900"><div class="ttname"><a href="../../d3/d04/classfemus_1_1Solid.html#a3d971cfb0d2a1810e6b31830f1f4b900">femus::Solid::get_poisson_coeff</a></div><div class="ttdeci">const double get_poisson_coeff() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da6/Solid_8cpp_source.html#l00149">Solid.cpp:149</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solid_html_a5f3228eab52c343a13167eaf73f568bc"><div class="ttname"><a href="../../d3/d04/classfemus_1_1Solid.html#a5f3228eab52c343a13167eaf73f568bc">femus::Solid::get_lame_shear_modulus</a></div><div class="ttdeci">const double get_lame_shear_modulus() const</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/da6/Solid_8cpp_source.html#l00157">Solid.cpp:157</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solution__generation__single__level_html"><div class="ttname"><a href="../../d5/df1/classfemus_1_1Solution__generation__single__level.html">femus::Solution_generation_single_level</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d7/dd6/FE__convergence_8hpp_source.html#l00020">FE_convergence.hpp:20</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solution_html"><div class="ttname"><a href="../../d0/da2/classfemus_1_1Solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/Solution_8hpp_source.html#l00049">Solution.hpp:49</a></div></div>
<div class="ttc" id="aclassfemus_1_1Solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="../../d0/da2/classfemus_1_1Solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d9b/Solution_8hpp_source.html#l00151">Solution.hpp:151</a></div></div>
<div class="ttc" id="aclassfemus_1_1SparseMatrix_html"><div class="ttname"><a href="../../d4/d37/classfemus_1_1SparseMatrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d01/SparseMatrix_8hpp_source.html#l00047">SparseMatrix.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1SparseMatrix_html_a45654dbe423d1970565b94c792ce6df3"><div class="ttname"><a href="../../d4/d37/classfemus_1_1SparseMatrix.html#a45654dbe423d1970565b94c792ce6df3">femus::SparseMatrix::zero</a></div><div class="ttdeci">virtual void zero()=0</div></div>
<div class="ttc" id="aclassfemus_1_1SparseMatrix_html_a6eb9fbd88830b0d10c88f0ce066b07ae"><div class="ttname"><a href="../../d4/d37/classfemus_1_1SparseMatrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">femus::SparseMatrix::close</a></div><div class="ttdeci">virtual void close() const =0</div></div>
<div class="ttc" id="aclassfemus_1_1System_html_a42a5b5b5d2c7673b1d4c896762d8db9e"><div class="ttname"><a href="../../d4/d23/classfemus_1_1System.html#a42a5b5b5d2c7673b1d4c896762d8db9e">femus::System::SetAssembleFunction</a></div><div class="ttdeci">void SetAssembleFunction(AssembleFunctionType)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d7c/System_8cpp_source.html#l00058">System.cpp:58</a></div></div>
<div class="ttc" id="aclassfemus_1_1System_html_a606e07526d7a0d31eed638404ee2ed24"><div class="ttname"><a href="../../d4/d23/classfemus_1_1System.html#a606e07526d7a0d31eed638404ee2ed24">femus::System::AddSolutionToSystemPDE</a></div><div class="ttdeci">virtual void AddSolutionToSystemPDE(const char solname[])</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d7c/System_8cpp_source.html#l00075">System.cpp:75</a></div></div>
<div class="ttc" id="aclassfemus_1_1System_html_ae3c161c5a12d55227effe9acf01b6535"><div class="ttname"><a href="../../d4/d23/classfemus_1_1System.html#ae3c161c5a12d55227effe9acf01b6535">femus::System::set_unknown_list_for_assembly</a></div><div class="ttdeci">void set_unknown_list_for_assembly(const std::vector&lt; Unknown &gt; unknown_in)</div><div class="ttdef"><b>Definition:</b> <a href="../../d3/d7c/System_8cpp_source.html#l00115">System.cpp:115</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html">femus::assemble_jacobian</a></div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00026">Assemble_jacobian.hpp:26</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a298fb51789fa086f4ac3904b43336f76"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">femus::assemble_jacobian::res_row_index</a></div><div class="ttdeci">static unsigned int res_row_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int my_row_pos, const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00284">Assemble_jacobian.hpp:284</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a76626a28a3fa87cc055e76d189ed4660"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a76626a28a3fa87cc055e76d189ed4660">femus::assemble_jacobian::print_element_jacobian</a></div><div class="ttdeci">static void print_element_jacobian(const unsigned int iel, const std::vector&lt; double &gt; &amp;Jac, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const unsigned int col_width_visualization, const unsigned int precision)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00221">Assemble_jacobian.hpp:221</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_af1d28f6f33acdba64d6e3c733d09f0aa"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#af1d28f6f33acdba64d6e3c733d09f0aa">femus::assemble_jacobian::print_element_residual</a></div><div class="ttdeci">static void print_element_residual(const unsigned int iel, const std::vector&lt; real_num &gt; &amp;Res, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const unsigned int col_width_visualization, const unsigned int precision)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00256">Assemble_jacobian.hpp:256</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition:</b> <a href="../../db/d97/Elem_8hpp_source.html#l00040">Elem.hpp:40</a></div></div>
<div class="ttc" id="anamespacefemus_html"><div class="ttname"><a href="../../d8/dea/namespacefemus.html">femus</a></div><div class="ttdoc">Class FemusInit.</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d09/GeomElTypeEnum_8hpp_source.html#l00007">GeomElTypeEnum.hpp:7</a></div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d97/Elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a491774c0485f249809d76f7933b79419"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a491774c0485f249809d76f7933b79419">_gravity</a></div><div class="ttdeci">double _gravity[3]</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00020">solidopt_params.hpp:20</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_26ff6c3add381934eb249273d9238662.html">femus</a></li><li class="navelem"><a class="el" href="../../dir_9206ac3774e2a47bcb445b819b2f5964.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_0109ff5b139427b8e4f04e46583f8baf.html">OptimalControl</a></li><li class="navelem"><a class="el" href="../../dir_3fa58a4caa9db4b60f26680e31f0555d.html">04_solidopt</a></li><li class="navelem"><a class="el" href="../../dir_eee40d067f654536dcba835f98a31f33.html">00_solid_state</a></li><li class="navelem"><a class="el" href="../../d5/d7e/00__solid__state_8cpp.html">00_solid_state.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
