<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: D:/femusDoxygen/source/applications/010_OptimalControl/04_solidopt/01_solid_control_boundary/01_solid_control_boundary.cpp File Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d7/d2a/01__solid__control__boundary_8cpp.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Classes</a> &#124;
<a href="#define-members">Macros</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle"><div class="title">01_solid_control_boundary.cpp File Reference</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><code>#include &quot;<a class="el" href="../../df/d7c/_femus_init_8hpp_source.html">FemusInit.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/dbc/_multi_level_problem_8hpp_source.html">MultiLevelProblem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../df/d14/_sparse_matrix_8hpp_source.html">SparseMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d8/df7/_v_t_k_writer_8hpp_source.html">VTKWriter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/dc5/_non_linear_implicit_system_8hpp_source.html">NonLinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d6/d69/_linear_implicit_system_8hpp_source.html">LinearImplicitSystem.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/de5/_linear_equation_solver_8hpp_source.html">LinearEquationSolver.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d1d/_parameter_8hpp_source.html">Parameter.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../dc/dec/_parallel_8hpp_source.html">Parallel.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d6d/_fluid_8hpp_source.html">Fluid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d7c/_solid_8hpp_source.html">Solid.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../db/d4e/_files_8hpp_source.html">Files.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d2/d51/_f_e__convergence_8hpp_source.html">FE_convergence.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d0/db7/_assemble__jacobian_8hpp_source.html">Assemble_jacobian.hpp</a>&quot;</code><br />
<code>#include &quot;<a class="el" href="../../d3/d31/_petsc_matrix_8hpp_source.html">PetscMatrix.hpp</a>&quot;</code><br />
<code>#include &quot;adept.h&quot;</code><br />
<code>#include &quot;<a class="el" href="../../de/d58/solidopt__params_8hpp_source.html">../solidopt_params.hpp</a>&quot;</code><br />
</div>
<p><a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="nested-classes" name="nested-classes"></a>
Classes</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">class &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../db/d43/class_solution__generation__1.html">Solution_generation_1&lt; real_num &gt;</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="define-members" name="define-members"></a>
Macros</h2></td></tr>
<tr class="memitem:aad0021c0ea41252012aebd17473bcd2e"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#aad0021c0ea41252012aebd17473bcd2e">FACE_FOR_CONTROL</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:aad0021c0ea41252012aebd17473bcd2e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a668a0b03c0385e061dad5178865e3b99"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a668a0b03c0385e061dad5178865e3b99">AXIS_DIRECTION_CONTROL_SIDE</a>&#160;&#160;&#160;0</td></tr>
<tr class="separator:a668a0b03c0385e061dad5178865e3b99"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8267a4060045c8116d32a821091e43cd"><td class="memItemLeft" align="right" valign="top">#define&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>&#160;&#160;&#160;3</td></tr>
<tr class="separator:a8267a4060045c8116d32a821091e43cd"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="func-members" name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a5dec9191b407f5f1913e563b23777741"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a> (const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</td></tr>
<tr class="separator:a5dec9191b407f5f1913e563b23777741"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1afc17d1ddb3752caf6910ec9a7c39ef"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a> (const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *ml_prob, const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</td></tr>
<tr class="separator:a1afc17d1ddb3752caf6910ec9a7c39ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aea610d910b5d696b3e500ed9636d8367"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:aea610d910b5d696b3e500ed9636d8367"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#aea610d910b5d696b3e500ed9636d8367">AssembleSolidMech</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:aea610d910b5d696b3e500ed9636d8367"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a96a01d4289cc795fc7506b8b67ba84bc"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:a96a01d4289cc795fc7506b8b67ba84bc"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a96a01d4289cc795fc7506b8b67ba84bc">AssembleSolidMech</a> (<a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob, const <a class="el" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a> &amp;solid_in, system_type *mlPdeSys, const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns)</td></tr>
<tr class="separator:a96a01d4289cc795fc7506b8b67ba84bc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad6b2e165d5cf19933c60a49927c5bf64"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:ad6b2e165d5cf19933c60a49927c5bf64"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#ad6b2e165d5cf19933c60a49927c5bf64">ComputeIntegral</a> (const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:ad6b2e165d5cf19933c60a49927c5bf64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b4961693657f83b36edc7f4e2e17de6"><td class="memTemplParams" colspan="2">template&lt;class system_type , class real_num , class real_num_mov &gt; </td></tr>
<tr class="memitem:a2b4961693657f83b36edc7f4e2e17de6"><td class="memTemplItemLeft" align="right" valign="top">void&#160;</td><td class="memTemplItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a2b4961693657f83b36edc7f4e2e17de6">ComputeIntegral</a> (const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;ml_prob, const system_type *mlPdeSys, const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;unknowns)</td></tr>
<tr class="separator:a2b4961693657f83b36edc7f4e2e17de6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6917621ec8f1cbd9eda71cf3f12de89c"><td class="memItemLeft" align="right" valign="top">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a6917621ec8f1cbd9eda71cf3f12de89c">provide_list_of_unknowns</a> (const unsigned int dimension)</td></tr>
<tr class="separator:a6917621ec8f1cbd9eda71cf3f12de89c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abdd1e0dbfc8ed6ec0a237d9654d0bce9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#abdd1e0dbfc8ed6ec0a237d9654d0bce9">set_phi_gradient_surface</a> (const unsigned int axis_direction_control_side, const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *msh, const unsigned int ig_bd, const std::vector&lt; unsigned int &gt; SolFEType, const unsigned int felt_bd, const unsigned int nve_bd, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_hat_bd, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;phi_hat_bd_x_dof_qp, const unsigned int <a class="el" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, const unsigned int ctrl_pos_begin)</td></tr>
<tr class="separator:abdd1e0dbfc8ed6ec0a237d9654d0bce9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a7a29781a20c5dd4153c3c1cecf0ff328">main</a> (int argc, char **args)</td></tr>
<tr class="separator:a7a29781a20c5dd4153c3c1cecf0ff328"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="var-members" name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a480ad40eedfb9ced9d7b090e19b3b85a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a480ad40eedfb9ced9d7b090e19b3b85a">penalty_outside_control_boundary</a> = 1.e50</td></tr>
<tr class="separator:a480ad40eedfb9ced9d7b090e19b3b85a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a92a609d215ec3c30302b119aa0df10f0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a92a609d215ec3c30302b119aa0df10f0">penalty_ctrl</a> = 1.e10</td></tr>
<tr class="separator:a92a609d215ec3c30302b119aa0df10f0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a949680fe5298ccbe0a9d804df0b792ee"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a949680fe5298ccbe0a9d804df0b792ee">theta_value_outside_fake_element</a> = 0.</td></tr>
<tr class="separator:a949680fe5298ccbe0a9d804df0b792ee"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Macro Definition Documentation</h2>
<a id="a668a0b03c0385e061dad5178865e3b99" name="a668a0b03c0385e061dad5178865e3b99"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a668a0b03c0385e061dad5178865e3b99">&#9670;&#160;</a></span>AXIS_DIRECTION_CONTROL_SIDE</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define AXIS_DIRECTION_CONTROL_SIDE&#160;&#160;&#160;0</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00022">22</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>

</div>
</div>
<a id="a8267a4060045c8116d32a821091e43cd" name="a8267a4060045c8116d32a821091e43cd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8267a4060045c8116d32a821091e43cd">&#9670;&#160;</a></span>CTRL_FACE_IDX</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define CTRL_FACE_IDX&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00027">27</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>

</div>
</div>
<a id="aad0021c0ea41252012aebd17473bcd2e" name="aad0021c0ea41252012aebd17473bcd2e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aad0021c0ea41252012aebd17473bcd2e">&#9670;&#160;</a></span>FACE_FOR_CONTROL</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">#define FACE_FOR_CONTROL&#160;&#160;&#160;3</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00021">21</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a id="aea610d910b5d696b3e500ed9636d8367" name="aea610d910b5d696b3e500ed9636d8367"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aea610d910b5d696b3e500ed9636d8367">&#9670;&#160;</a></span>AssembleSolidMech() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void AssembleSolidMech </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00311">311</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  311</span>                                                   {</div>
<div class="line"><span class="lineno">  312</span>    </div>
<div class="line"><span class="lineno">  313</span> </div>
<div class="line"><span class="lineno">  314</span>  AssembleSolidMech&lt; system_type, real_num, real_num_mov &gt; (  ml_prob, </div>
<div class="line"><span class="lineno">  315</span>                                                              ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a537b31965e5402b9c9febebce96ce01c">parameters</a>.<a class="code hl_function" href="../../d4/de5/classfemus_1_1_parameters.html#a419ddd3d0965dbca868a5072249b8374">get</a>&lt;<a class="code hl_class" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a>&gt;(<span class="stringliteral">&quot;Solid&quot;</span>), </div>
<div class="line"><span class="lineno">  316</span>                                                            &amp; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0), </div>
<div class="line"><span class="lineno">  317</span>                                                              ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0).get_unknown_list_for_assembly());</div>
<div class="line"><span class="lineno">  318</span> </div>
<div class="line"><span class="lineno">  319</span>}</div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a3d90edba93be2c202ea2bf8e87e20854"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">femus::MultiLevelProblem::get_system</a></div><div class="ttdeci">const T_sys &amp; get_system(const std::string &amp;name) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00519">MultiLevelProblem.hpp:519</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a537b31965e5402b9c9febebce96ce01c"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a537b31965e5402b9c9febebce96ce01c">femus::MultiLevelProblem::parameters</a></div><div class="ttdeci">Parameters parameters</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00118">MultiLevelProblem.hpp:118</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parameters_html_a419ddd3d0965dbca868a5072249b8374"><div class="ttname"><a href="../../d4/de5/classfemus_1_1_parameters.html#a419ddd3d0965dbca868a5072249b8374">femus::Parameters::get</a></div><div class="ttdeci">const T &amp; get(const std::string &amp;) const</div><div class="ttdef"><b>Definition</b> <a href="../../d8/de8/_parameters_8hpp_source.html#l00409">Parameters.hpp:409</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html">femus::Solid</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d7c/_solid_8hpp_source.html#l00035">Solid.hpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a96a01d4289cc795fc7506b8b67ba84bc" name="a96a01d4289cc795fc7506b8b67ba84bc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a96a01d4289cc795fc7506b8b67ba84bc">&#9670;&#160;</a></span>AssembleSolidMech() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void AssembleSolidMech </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d8/d1a/classfemus_1_1_solid.html">Solid</a> &amp;&#160;</td>
          <td class="paramname"><em>solid_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">system_type *&#160;</td>
          <td class="paramname"><em>mlPdeSys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00324">324</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  327</span>                                                               {</div>
<div class="line"><span class="lineno">  328</span>    </div>
<div class="line"><span class="lineno">  329</span>  <span class="comment">//  ml_prob is the global object from/to where get/set all the data</span></div>
<div class="line"><span class="lineno">  330</span>  <span class="comment">//  level is the level of the PDE system to be assembled</span></div>
<div class="line"><span class="lineno">  331</span>  <span class="comment">//  levelMax is the Maximum level of the MultiLevelProblem</span></div>
<div class="line"><span class="lineno">  332</span>  <span class="comment">//  assembleMatrix is a flag that tells if only the residual or also the matrix should be assembled</span></div>
<div class="line"><span class="lineno">  333</span> </div>
<div class="line"><span class="lineno">  334</span> </div>
<div class="line"><span class="lineno">  335</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>                level               = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><span class="lineno">  336</span>  <span class="keywordtype">bool</span>                  assembleMatrix              = mlPdeSys-&gt;GetAssembleMatrix(); </div>
<div class="line"><span class="lineno">  337</span>  <span class="keyword">const</span> <span class="keywordtype">char</span>*                   pdename         = mlPdeSys-&gt;name().c_str();</div>
<div class="line"><span class="lineno">  338</span> </div>
<div class="line"><span class="lineno">  339</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>*                         msh             = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno">  340</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>*                         el              = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno">  341</span> </div>
<div class="line"><span class="lineno">  342</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>*           ml_sol  = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><span class="lineno">  343</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>*                     sol             = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level); </div>
<div class="line"><span class="lineno">  344</span> </div>
<div class="line"><span class="lineno">  345</span> </div>
<div class="line"><span class="lineno">  346</span>  <a class="code hl_class" href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">LinearEquationSolver</a>*         pdeSys  = mlPdeSys-&gt;_LinSolver[level];</div>
<div class="line"><span class="lineno">  347</span>  <a class="code hl_class" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a>*                 JAC             = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">_KK</a>;</div>
<div class="line"><span class="lineno">  348</span>  <a class="code hl_class" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a>*                RES         = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">_RES</a>;</div>
<div class="line"><span class="lineno">  349</span> </div>
<div class="line"><span class="lineno">  350</span>  MatSetOption(<span class="keyword">static_cast&lt;</span> <a class="code hl_class" href="../../da/dcf/classfemus_1_1_petsc_matrix.html">PetscMatrix</a>* <span class="keyword">&gt;</span>(JAC)-&gt;mat(),MAT_NEW_NONZERO_ALLOCATION_ERR, PETSC_FALSE);</div>
<div class="line"><span class="lineno">  351</span> </div>
<div class="line"><span class="lineno">  352</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>        <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno">  353</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>   dim2  = (3 * (<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1));</div>
<div class="line"><span class="lineno">  354</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>    nel  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">GetNumberOfElements</a>();</div>
<div class="line"><span class="lineno">  355</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  igrid  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">GetLevel</a>();</div>
<div class="line"><span class="lineno">  356</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  iproc  = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno">  357</span>  <span class="comment">// reserve memory for the local standard vectors</span></div>
<div class="line"><span class="lineno">  358</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size_elem_dofs = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27</span></div>
<div class="line"><span class="lineno">  359</span> </div>
<div class="line"><span class="lineno">  360</span> </div>
<div class="line"><span class="lineno">  361</span>  </div>
<div class="line"><span class="lineno">  362</span>  <span class="comment">//----------- unknowns ------------------------------</span></div>
<div class="line"><span class="lineno">  363</span>   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><span class="lineno">  364</span><span class="comment">//      enum Sol_pos {pos_dx = 0, pos_dy, pos_p};  //these are known at compile-time</span></div>
<div class="line"><span class="lineno">  365</span><span class="comment">//      enum Sol_pos {pos_dx = 0, pos_dy, pos_dz, pos_p};</span></div>
<div class="line"><span class="lineno">  366</span><span class="comment">//   constexpr unsigned int pos_dx = 0;  </span></div>
<div class="line"><span class="lineno">  367</span><span class="comment">//   constexpr unsigned int pos_dy = 1;  </span></div>
<div class="line"><span class="lineno">  368</span><span class="comment">//   constexpr unsigned int pos_dp = 2;  </span></div>
<div class="line"><span class="lineno">  369</span><span class="comment">//   if (dim == 3) {std::cout &lt;&lt; &quot;Uncomment the 3d enum and recompile&quot;; abort(); }</span></div>
<div class="line"><span class="lineno">  370</span>   </div>
<div class="line"><span class="lineno">  371</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> sol_index_displ      = 0;     <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno">  372</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press      = sol_index_displ + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      <span class="comment">//known at run time</span></div>
<div class="line"><span class="lineno">  373</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> state_pos_begin      = sol_index_displ;   <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno">  374</span> </div>
<div class="line"><span class="lineno">  375</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> adj_pos_begin        = <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1;</div>
<div class="line"><span class="lineno">  376</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_adj        = adj_pos_begin;      </div>
<div class="line"><span class="lineno">  377</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press_adj  = sol_index_adj + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;     </div>
<div class="line"><span class="lineno">  378</span> </div>
<div class="line"><span class="lineno">  379</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> ctrl_pos_begin       = 2 * (<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1);</div>
<div class="line"><span class="lineno">  380</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_ctrl       = ctrl_pos_begin;     </div>
<div class="line"><span class="lineno">  381</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> theta_index          = sol_index_ctrl + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      </div>
<div class="line"><span class="lineno">  382</span> </div>
<div class="line"><span class="lineno">  383</span>  <span class="keyword">const</span> <span class="keywordtype">int</span>  n_state_vars = <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1;</div>
<div class="line"><span class="lineno">  384</span>  </div>
<div class="line"><span class="lineno">  385</span>  std::vector &lt; std::string &gt; Solname(n_unknowns);     </div>
<div class="line"><span class="lineno">  386</span>  std::vector &lt; unsigned int &gt; SolIndex(n_unknowns);  </div>
<div class="line"><span class="lineno">  387</span>  std::vector &lt; unsigned int &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><span class="lineno">  388</span>  std::vector &lt; unsigned int &gt; SolFEType(n_unknowns);  </div>
<div class="line"><span class="lineno">  389</span> </div>
<div class="line"><span class="lineno">  390</span> </div>
<div class="line"><span class="lineno">  391</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno">  392</span>       Solname[ivar]    = unknowns[ivar]._name; </div>
<div class="line"><span class="lineno">  393</span>      SolIndex[ivar]    = ml_sol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>        (Solname[ivar].c_str());</div>
<div class="line"><span class="lineno">  394</span>    SolPdeIndex[ivar]   = mlPdeSys-&gt;GetSolPdeIndex(Solname[ivar].c_str());</div>
<div class="line"><span class="lineno">  395</span><span class="comment">//       assert(ivar == SolPdeIndex[ivar]);  //I would like this ivar order to coincide either with SolIndex or with SolPdeIndex, otherwise too many orders... it has to be  with SolPdeIndex, because SolIndex is related to the Solution object which can have more fields... This has to match the order of the unknowns[] argument</span></div>
<div class="line"><span class="lineno">  396</span>    SolFEType[ivar]     = ml_sol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a14df65f22920d95a341bc656b7878dc6">GetSolutionType</a>(SolIndex[ivar]);</div>
<div class="line"><span class="lineno">  397</span>  }</div>
<div class="line"><span class="lineno">  398</span> </div>
<div class="line"><span class="lineno">  399</span>   <span class="keyword">constexpr</span> <span class="keywordtype">int</span> solFEType_max = <a class="code hl_enumvalue" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a>;  <span class="comment">//biquadratic, this is the highest-order FE </span></div>
<div class="line"><span class="lineno">  400</span> </div>
<div class="line"><span class="lineno">  401</span>   std::vector &lt; unsigned int &gt; Sol_n_el_dofs(n_unknowns);</div>
<div class="line"><span class="lineno">  402</span>  </div>
<div class="line"><span class="lineno">  403</span>  <span class="comment">//----------- of dofs and at quadrature points ------------------------------</span></div>
<div class="line"><span class="lineno">  404</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  405</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp(n_unknowns);   <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here  //some of these should be real_num, some real_num_mov...</span></div>
<div class="line"><span class="lineno">  406</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp(n_unknowns);  <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here</span></div>
<div class="line"><span class="lineno">  407</span> </div>
<div class="line"><span class="lineno">  408</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  409</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_x_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  410</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_xx_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  411</span> </div>
<div class="line"><span class="lineno">  412</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {  </div>
<div class="line"><span class="lineno">  413</span>        phi_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  414</span>    phi_hat_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  415</span>      phi_x_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  416</span>  phi_x_hat_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  417</span>     phi_xx_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  418</span> phi_xx_hat_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  419</span>   }</div>
<div class="line"><span class="lineno">  420</span>   </div>
<div class="line"><span class="lineno">  421</span><span class="comment">//----------boundary adjoint &amp; ctrl shape functions----------------------  </span></div>
<div class="line"><span class="lineno">  422</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_bd_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  423</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_bd_x_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  424</span> </div>
<div class="line"><span class="lineno">  425</span>  <span class="comment">//bdry vol adj  evaluated at bdry points</span></div>
<div class="line"><span class="lineno">  426</span>   std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_vol_at_bdry_dof(n_unknowns);</div>
<div class="line"><span class="lineno">  427</span>   std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_x_vol_at_bdry_dof(n_unknowns);</div>
<div class="line"><span class="lineno">  428</span> </div>
<div class="line"><span class="lineno">  429</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns ; unk++) {  </div>
<div class="line"><span class="lineno">  430</span>        phi_hat_bd_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  431</span>      phi_hat_bd_x_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  432</span>  <span class="comment">//bdry vol adj  evaluated at bdry points</span></div>
<div class="line"><span class="lineno">  433</span>         phi_hat_vol_at_bdry_dof[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  434</span>       phi_hat_x_vol_at_bdry_dof[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);     </div>
<div class="line"><span class="lineno">  435</span>    }</div>
<div class="line"><span class="lineno">  436</span> </div>
<div class="line"><span class="lineno">  437</span>  std::vector &lt; std::vector &lt; real_num &gt; &gt;  sol_hat_adj_x_vol_at_bdry_qp(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  438</span>  std::vector &lt; real_num &gt; grad_dot_n_adj_res;</div>
<div class="line"><span class="lineno">  439</span>  std::vector &lt; double &gt; grad_adj_dot_n;</div>
<div class="line"><span class="lineno">  440</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> ldim =0; ldim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ldim++) sol_hat_adj_x_vol_at_bdry_qp[ldim].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  441</span>  grad_dot_n_adj_res.reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  442</span>  grad_adj_dot_n.reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  443</span> </div>
<div class="line"><span class="lineno">  444</span> </div>
<div class="line"><span class="lineno">  445</span> </div>
<div class="line"><span class="lineno">  446</span>    <span class="comment">//----------- at dofs ------------------------------</span></div>
<div class="line"><span class="lineno">  447</span>  std::vector &lt; double &gt;   Jac;   Jac.reserve( n_unknowns * max_size_elem_dofs * n_unknowns * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  448</span>  std::vector &lt; real_num &gt; Res;   Res.reserve( n_unknowns * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  449</span>           std::vector &lt; int &gt;       L2G_dofmap_AllVars;   L2G_dofmap_AllVars.reserve( n_unknowns *max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  450</span>  std::vector &lt; std::vector &lt; int &gt; &gt;         L2G_dofmap(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) {    L2G_dofmap[i].reserve(max_size_elem_dofs); }</div>
<div class="line"><span class="lineno">  451</span>  std::vector &lt; std::vector &lt; real_num &gt; &gt; SolVAR_eldofs(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { SolVAR_eldofs[k].reserve(max_size_elem_dofs); }</div>
<div class="line"><span class="lineno">  452</span> <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  453</span>  std::vector &lt; double &gt;   Jac_state_true;   Jac_state_true.reserve( n_state_vars * max_size_elem_dofs * n_state_vars * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  454</span>  std::vector &lt; double &gt;   Jac_state_false;   Jac_state_false.reserve( n_state_vars * max_size_elem_dofs * n_state_vars * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  455</span>  std::vector &lt; real_num &gt; Res_state;   Res_state.reserve( n_state_vars * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  456</span> </div>
<div class="line"><span class="lineno">  457</span>  <span class="comment">//----------------------------------------------------------------------------------------------------- </span></div>
<div class="line"><span class="lineno">  458</span>  std::vector &lt; real_num &gt; Res_bd;   Res_bd.reserve( n_unknowns * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  459</span>  std::vector &lt; double &gt;   Jac_g;   Jac_g.reserve( n_unknowns * max_size_elem_dofs * n_unknowns * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  460</span>  std::vector &lt; real_num &gt; Res_g;   Res_g.reserve( n_unknowns * max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  461</span>  std::vector &lt; std::vector &lt; double &gt; &gt; Jac_outer(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  462</span>  std::vector &lt; std::vector &lt; real_num &gt; &gt; Res_dctrl_dot_n(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  463</span>  std::vector &lt; real_num &gt; Res_outer(1);</div>
<div class="line"><span class="lineno">  464</span> </div>
<div class="line"><span class="lineno">  465</span>         <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {  </div>
<div class="line"><span class="lineno">  466</span>             Jac_outer[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno">  467</span>             Res_dctrl_dot_n[i].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  468</span>        }</div>
<div class="line"><span class="lineno">  469</span> </div>
<div class="line"><span class="lineno">  470</span>  <span class="comment">// geometry (at dofs) --------------------------------</span></div>
<div class="line"><span class="lineno">  471</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt;   coords(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  472</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  coords_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  473</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  coords_hat_bd(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  474</span>  <span class="keywordtype">unsigned</span> coordsType = <a class="code hl_enumvalue" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a>; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE TENSOR-PRODUCT-QUADRATIC)</span></div>
<div class="line"><span class="lineno">  475</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {   </div>
<div class="line"><span class="lineno">  476</span>           coords[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno">  477</span>       coords_hat[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno">  478</span>    coords_hat_bd[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno">  479</span> }</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span> <span class="comment">//************** geometry phi **************************</span></div>
<div class="line"><span class="lineno">  482</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_dof_qp_domain(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  483</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp_domain(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  484</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp_domain(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  485</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_dof_qp_domain_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  486</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_x_dof_qp_domain_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  487</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_xx_dof_qp_domain_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  488</span> </div>
<div class="line"><span class="lineno">  489</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dom_coord = 0; dom_coord &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; dom_coord++) {</div>
<div class="line"><span class="lineno">  490</span>        phi_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  491</span>      phi_x_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  492</span>     phi_xx_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  493</span>        phi_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno">  494</span>      phi_x_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  495</span>     phi_xx_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno">  496</span>   }</div>
<div class="line"><span class="lineno">  497</span> </div>
<div class="line"><span class="lineno">  498</span> </div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  500</span>  <span class="comment">// geometry ------------------------------------------</span></div>
<div class="line"><span class="lineno">  501</span>  </div>
<div class="line"><span class="lineno">  502</span> </div>
<div class="line"><span class="lineno">  503</span>  <span class="comment">//------------ at quadrature points ---------------------</span></div>
<div class="line"><span class="lineno">  504</span>  real_num_mov weight_qp = 0.;</div>
<div class="line"><span class="lineno">  505</span>    <span class="keywordtype">double</span> weight_hat_qp = 0.;</div>
<div class="line"><span class="lineno">  506</span>    <span class="keywordtype">double</span> weight_hat_bd_qp = 0.;</div>
<div class="line"><span class="lineno">  507</span>    std::vector &lt; real_num &gt; SolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  508</span>    std::vector &lt; real_num &gt; SolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  509</span>    std::vector &lt; std::vector &lt; real_num &gt; &gt; gradSolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  510</span>    std::vector &lt; std::vector &lt; real_num &gt; &gt; gradSolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  511</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { </div>
<div class="line"><span class="lineno">  512</span>          gradSolVAR_qp[k].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  513</span>      gradSolVAR_hat_qp[k].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  514</span>    }</div>
<div class="line"><span class="lineno">  515</span>      </div>
<div class="line"><span class="lineno">  516</span> </div>
<div class="line"><span class="lineno">  517</span>   <span class="comment">// ------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  518</span>    <span class="comment">// Physical parameters</span></div>
<div class="line"><span class="lineno">  519</span>    <span class="keyword">const</span> <span class="keywordtype">int</span>    solid_model    = solid_in.<a class="code hl_function" href="../../d8/d1a/classfemus_1_1_solid.html#a19ca2da625aede63d5277cb034584718">get_physical_model</a>();</div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordtype">double</span> rhos                         = solid_in.<a class="code hl_function" href="../../d0/d38/classfemus_1_1_material.html#aa1968d4c8018a8fca33acb32a5be3dbc">get_density</a>();</div>
<div class="line"><span class="lineno">  521</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mu_lame            = solid_in.<a class="code hl_function" href="../../d8/d1a/classfemus_1_1_solid.html#a5f3228eab52c343a13167eaf73f568bc">get_lame_shear_modulus</a>();</div>
<div class="line"><span class="lineno">  522</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> lambda_lame    = solid_in.<a class="code hl_function" href="../../d8/d1a/classfemus_1_1_solid.html#a25307ed3e65fea474b2d74b130348e4b">get_lame_lambda</a>();</div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> incompressible   = (0.5  ==  solid_in.<a class="code hl_function" href="../../d8/d1a/classfemus_1_1_solid.html#a3d971cfb0d2a1810e6b31830f1f4b900">get_poisson_coeff</a>()) ? 1 : 0;</div>
<div class="line"><span class="lineno">  525</span>    <span class="keyword">const</span> <span class="keywordtype">bool</span> penalty = solid_in.<a class="code hl_function" href="../../d8/d1a/classfemus_1_1_solid.html#a032c01f0f6e345f2818a7ffe24bad883">get_if_penalty</a>();</div>
<div class="line"><span class="lineno">  526</span> </div>
<div class="line"><span class="lineno">  527</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> young_modulus = solid_in.<a class="code hl_function" href="../../d8/d1a/classfemus_1_1_solid.html#a1a27599fb327424255b0823dcddd863a">get_young_module</a>();</div>
<div class="line"><span class="lineno">  528</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> Lref = solid_in.<a class="code hl_variable" href="../../d0/d38/classfemus_1_1_material.html#a393992ac63eb6eaae7d5cbad9c6ac4ec">_parameter</a>-&gt;<a class="code hl_function" href="../../d7/d3c/classfemus_1_1_parameter.html#a010508c1540e2547bcbf77f2c1103695">Get_reference_length</a>();</div>
<div class="line"><span class="lineno">  529</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> nondim_number = Lref/young_modulus;</div>
<div class="line"><span class="lineno">  530</span>    </div>
<div class="line"><span class="lineno">  531</span>    <span class="keyword">const</span> <span class="keywordtype">double</span> mus   =  <span class="comment">/*nondim_number **/</span> mu_lame/rhos;</div>
<div class="line"><span class="lineno">  532</span>    <span class="comment">// -----------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>    RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">zero</a>();</div>
<div class="line"><span class="lineno">  535</span>  <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">zero</a>();</div>
<div class="line"><span class="lineno">  536</span>  </div>
<div class="line"><span class="lineno">  537</span>  adept::Stack &amp; stack = <a class="code hl_variable" href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;  <span class="comment">// call the adept stack object for potential use of AD</span></div>
<div class="line"><span class="lineno">  538</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html">assemble_jacobian</a>&lt; real_num, <span class="keywordtype">double</span><span class="comment">/*real_num_mov*/</span> &gt; assemble_jac;</div>
<div class="line"><span class="lineno">  539</span> <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  540</span>  adept::Stack &amp; stack_state = <a class="code hl_variable" href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">FemusInit::_adeptStack</a>;  <span class="comment">// call the adept stack object for potential use of AD</span></div>
<div class="line"><span class="lineno">  541</span>  <span class="keyword">const</span> <a class="code hl_class" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html">assemble_jacobian</a>&lt; real_num, <span class="keywordtype">double</span><span class="comment">/*real_num_mov*/</span> &gt; assemble_jac_state;</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span> </div>
<div class="line"><span class="lineno">  544</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>   <span class="comment">//all vars ###################################################################  </span></div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> fake_iel_flag = 0;</div>
<div class="line"><span class="lineno">  548</span>    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> global_row_index_bdry_constr = pdeSys-&gt;<a class="code hl_variable" href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">KKoffset</a>[SolPdeIndex[theta_index]][iproc];</div>
<div class="line"><span class="lineno">  549</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno">  550</span>    <span class="keywordtype">unsigned</span> ndofs_unk = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolFEType[k]);</div>
<div class="line"><span class="lineno">  551</span>       Sol_n_el_dofs[k] = ndofs_unk;</div>
<div class="line"><span class="lineno">  552</span>       SolVAR_eldofs[k].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno">  553</span>          L2G_dofmap[k].resize(Sol_n_el_dofs[k]); </div>
<div class="line"><span class="lineno">  554</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; SolVAR_eldofs[k].size(); i++) {</div>
<div class="line"><span class="lineno">  555</span>       <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolFEType[k]);</div>
<div class="line"><span class="lineno">  556</span>       SolVAR_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex[k]])(solDof);</div>
<div class="line"><span class="lineno">  557</span>          L2G_dofmap[k][i] = pdeSys-&gt;<a class="code hl_function" href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">GetSystemDof</a>(SolIndex[k], SolPdeIndex[k], i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><span class="lineno">  558</span>     <span class="keywordflow">if</span> (k == SolPdeIndex[theta_index] &amp;&amp; L2G_dofmap[k][i] == global_row_index_bdry_constr) {       fake_iel_flag = iel;  }</div>
<div class="line"><span class="lineno">  559</span>      }</div>
<div class="line"><span class="lineno">  560</span>    }</div>
<div class="line"><span class="lineno">  561</span>    </div>
<div class="line"><span class="lineno">  562</span>    L2G_dofmap_AllVars.resize(0);</div>
<div class="line"><span class="lineno">  563</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++)     L2G_dofmap_AllVars.insert(L2G_dofmap_AllVars.end(),L2G_dofmap[k].begin(),L2G_dofmap[k].end());</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    <span class="keywordtype">unsigned</span> sum_Sol_n_el_dofs = 0;</div>
<div class="line"><span class="lineno">  566</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) { sum_Sol_n_el_dofs += Sol_n_el_dofs[k]; }</div>
<div class="line"><span class="lineno">  567</span>    Jac.resize(sum_Sol_n_el_dofs * sum_Sol_n_el_dofs);  std::fill(Jac.begin(), Jac.end(), 0.);</div>
<div class="line"><span class="lineno">  568</span>    Res.resize(sum_Sol_n_el_dofs);                      std::fill(Res.begin(), Res.end(), 0.);</div>
<div class="line"><span class="lineno">  569</span>   Res_bd.resize(sum_Sol_n_el_dofs);                      std::fill(Res_bd.begin(), Res_bd.end(), 0.);</div>
<div class="line"><span class="lineno">  570</span>    Jac_g.resize(sum_Sol_n_el_dofs * sum_Sol_n_el_dofs);  std::fill(Jac_g.begin(), Jac_g.end(), 0.);</div>
<div class="line"><span class="lineno">  571</span>    Res_g.resize(sum_Sol_n_el_dofs);                      std::fill(Res_g.begin(), Res_g.end(), 0.);</div>
<div class="line"><span class="lineno">  572</span> </div>
<div class="line"><span class="lineno">  573</span> <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordtype">unsigned</span> state_sum_Sol_n_el_dofs = 0;</div>
<div class="line"><span class="lineno">  575</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_state_vars; k++) { state_sum_Sol_n_el_dofs += Sol_n_el_dofs[k]; }</div>
<div class="line"><span class="lineno">  576</span>    Jac_state_true.resize(state_sum_Sol_n_el_dofs * state_sum_Sol_n_el_dofs);    std::fill(Jac_state_true.begin(), Jac_state_true.end(), 0.);</div>
<div class="line"><span class="lineno">  577</span>    Jac_state_false.resize(state_sum_Sol_n_el_dofs * state_sum_Sol_n_el_dofs);    std::fill(Jac_state_false.begin(), Jac_state_false.end(), 0.);</div>
<div class="line"><span class="lineno">  578</span>    Res_state.resize(state_sum_Sol_n_el_dofs);                              std::fill(Res_state.begin(), Res_state.end(), 0.);</div>
<div class="line"><span class="lineno">  579</span> </div>
<div class="line"><span class="lineno">  580</span>     <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++)    {</div>
<div class="line"><span class="lineno">  581</span>        Jac_outer[ivar].resize(Sol_n_el_dofs[ivar + ctrl_pos_begin]);</div>
<div class="line"><span class="lineno">  582</span>        Res_dctrl_dot_n[ivar].resize(Sol_n_el_dofs[ivar + ctrl_pos_begin]);</div>
<div class="line"><span class="lineno">  583</span>    }</div>
<div class="line"><span class="lineno">  584</span>    Res_outer[0] = 0.;</div>
<div class="line"><span class="lineno">  585</span>    </div>
<div class="line"><span class="lineno">  586</span>    <span class="comment">//all vars ###################################################################</span></div>
<div class="line"><span class="lineno">  587</span>  </div>
<div class="line"><span class="lineno">  588</span>  </div>
<div class="line"><span class="lineno">  589</span><span class="comment">//indices for restr --------------------------------------</span></div>
<div class="line"><span class="lineno">  590</span>           std::vector &lt; int &gt; ind_dtheta(theta_index - sol_index_press_adj);</div>
<div class="line"><span class="lineno">  591</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; ind_dtheta.size(); k++){</div>
<div class="line"><span class="lineno">  592</span>                ind_dtheta[k] = <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, sum_Sol_n_el_dofs, SolPdeIndex[theta_index] , SolPdeIndex[ctrl_pos_begin + k], 0 , 0);</div>
<div class="line"><span class="lineno">  593</span>            }</div>
<div class="line"><span class="lineno">  594</span>    </div>
<div class="line"><span class="lineno">  595</span>           std::vector &lt; int &gt; ind_res_dctrl_dtheta(theta_index - sol_index_press_adj);</div>
<div class="line"><span class="lineno">  596</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> k = 0; k &lt; ind_res_dctrl_dtheta.size(); k++){</div>
<div class="line"><span class="lineno">  597</span>                ind_res_dctrl_dtheta[k] = <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[ctrl_pos_begin + k], 0);</div>
<div class="line"><span class="lineno">  598</span>            }</div>
<div class="line"><span class="lineno">  599</span><span class="comment">//indices for restr --------------------------------------</span></div>
<div class="line"><span class="lineno">  600</span>    </div>
<div class="line"><span class="lineno">  601</span>  <span class="comment">// geometry *****************************</span></div>
<div class="line"><span class="lineno">  602</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>      <span class="keywordtype">unsigned</span> nDofsX = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, coordsType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno">  605</span>    </div>
<div class="line"><span class="lineno">  606</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ivar=0; ivar&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  607</span>      coords[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno">  608</span>      coords_hat[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno">  609</span>    }</div>
<div class="line"><span class="lineno">  610</span>    </div>
<div class="line"><span class="lineno">  611</span>   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno">  612</span>      <span class="keywordtype">unsigned</span> coordsDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, coordsType);    <span class="comment">// global to global mapping between coordinates node and coordinate dof // via local to global solution node</span></div>
<div class="line"><span class="lineno">  613</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno">  614</span>          <span class="comment">//Fixed coordinates (Reference frame)</span></div>
<div class="line"><span class="lineno">  615</span>        coords_hat[ivar][i] = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[ivar])(coordsDof);</div>
<div class="line"><span class="lineno">  616</span>      }</div>
<div class="line"><span class="lineno">  617</span>    }</div>
<div class="line"><span class="lineno">  618</span> </div>
<div class="line"><span class="lineno">  619</span>  <span class="comment">//***************************************  </span></div>
<div class="line"><span class="lineno">  620</span>    assert(nDofsX == Sol_n_el_dofs[sol_index_displ]);</div>
<div class="line"><span class="lineno">  621</span>    <span class="comment">//Moving coordinates (Moving frame)</span></div>
<div class="line"><span class="lineno">  622</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  623</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofsX; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno">  624</span>          coords[idim][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = coords_hat[idim][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + SolVAR_eldofs[SolIndex[idim]][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno">  625</span>        }</div>
<div class="line"><span class="lineno">  626</span>      }</div>
<div class="line"><span class="lineno">  627</span>  </div>
<div class="line"><span class="lineno">  628</span>     <span class="comment">// elem average point </span></div>
<div class="line"><span class="lineno">  629</span>    std::vector &lt; double &gt; elem_center(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);   </div>
<div class="line"><span class="lineno">  630</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0.;  }</div>
<div class="line"><span class="lineno">  631</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  </div>
<div class="line"><span class="lineno">  632</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno">  633</span>         elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += coords_hat[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i];</div>
<div class="line"><span class="lineno">  634</span>       }</div>
<div class="line"><span class="lineno">  635</span>    }</div>
<div class="line"><span class="lineno">  636</span>    </div>
<div class="line"><span class="lineno">  637</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) { elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]/nDofsX; }</div>
<div class="line"><span class="lineno">  638</span>  <span class="comment">//*************************************** </span></div>
<div class="line"><span class="lineno">  639</span>  </div>
<div class="line"><span class="lineno">  640</span>  <span class="comment">//***** set target domain flag ********************************** </span></div>
<div class="line"><span class="lineno">  641</span>   <span class="keywordtype">int</span> target_flag = 0;</div>
<div class="line"><span class="lineno">  642</span>   target_flag = ElementTargetFlag &lt; double &gt; (elem_center);</div>
<div class="line"><span class="lineno">  643</span> </div>
<div class="line"><span class="lineno">  644</span>  <span class="comment">// geometry end *****************************</span></div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>      </div>
<div class="line"><span class="lineno">  647</span><span class="comment">//************ set control flag *********************</span></div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordtype">int</span> control_el_flag = 0;</div>
<div class="line"><span class="lineno">  649</span>        control_el_flag = <a class="code hl_function" href="../../de/d58/solidopt__params_8hpp.html#a1dffa717bb8f2e25ad41baaf598c703f">ControlDomainFlag</a>(elem_center);</div>
<div class="line"><span class="lineno">  650</span>    std::vector&lt; std::vector&lt;int&gt; &gt; control_node_flag(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  651</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  652</span>                  control_node_flag[idim].resize(Sol_n_el_dofs[ctrl_pos_begin]);</div>
<div class="line"><span class="lineno">  653</span>    std::fill(control_node_flag[idim].begin(), control_node_flag[idim].end(), 0);</div>
<div class="line"><span class="lineno">  654</span>            }</div>
<div class="line"><span class="lineno">  655</span> <span class="comment">//*************************************************** </span></div>
<div class="line"><span class="lineno">  656</span>      </div>
<div class="line"><span class="lineno">  657</span>   <span class="comment">//************ set fake theta flag: this flag tells me what degrees of freedom of the current element are fake for the theta variable *********************</span></div>
<div class="line"><span class="lineno">  658</span>    std::vector&lt;int&gt;  bdry_int_constr_pos_vec(1,global_row_index_bdry_constr); <span class="comment">/*KKoffset[SolPdeIndex[PADJ]][iproc]*/</span></div>
<div class="line"><span class="lineno">  659</span>    std::vector&lt;int&gt; fake_theta_flag(Sol_n_el_dofs[theta_index],0);</div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[theta_index]; i++) {</div>
<div class="line"><span class="lineno">  661</span>      <span class="keywordflow">if</span> ( L2G_dofmap[ SolPdeIndex[theta_index] ] [i] == bdry_int_constr_pos_vec[0]) {  fake_theta_flag[i] = 1;       }</div>
<div class="line"><span class="lineno">  662</span>    }</div>
<div class="line"><span class="lineno">  663</span> <span class="comment">//************ end set fake theta flag *********************</span></div>
<div class="line"><span class="lineno">  664</span> </div>
<div class="line"><span class="lineno">  665</span>     assemble_jac.prepare_before_integration_loop(stack);</div>
<div class="line"><span class="lineno">  666</span>     assemble_jac_state.prepare_before_integration_loop(stack_state); <span class="comment">//=================state_only - for Jac retrieval via AD</span></div>
<div class="line"><span class="lineno">  667</span>     </div>
<div class="line"><span class="lineno">  668</span>  </div>
<div class="line"><span class="lineno">  669</span><span class="comment">//========BoundaryLoop=====================================================================</span></div>
<div class="line"><span class="lineno">  670</span> </div>
<div class="line"><span class="lineno">  671</span>  <span class="comment">// Perform face loop over elements that contain some control face</span></div>
<div class="line"><span class="lineno">  672</span>  <span class="keywordflow">if</span> (control_el_flag == 1) {</div>
<div class="line"><span class="lineno">  673</span>          </div>
<div class="line"><span class="lineno">  674</span>      <span class="keywordtype">double</span> tau = 0.;</div>
<div class="line"><span class="lineno">  675</span>      std::vector &lt; double &gt; normal(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,0);</div>
<div class="line"><span class="lineno">  676</span>          </div>
<div class="line"><span class="lineno">  677</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface = 0; jface &lt; msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a3c2977b3363513c86c5cdb0e645a78bd">GetElementFaceNumber</a>(iel); jface++) {</div>
<div class="line"><span class="lineno">  678</span>          std::vector &lt; double &gt; xyz_bdc(3,0.);  <span class="comment">//not being used, because the boundaries are identified by the face numbers</span></div>
<div class="line"><span class="lineno">  679</span>          <span class="comment">// look for boundary faces</span></div>
<div class="line"><span class="lineno">  680</span>          <span class="keywordflow">if</span>(el-&gt;<a class="code hl_function" href="../../db/d2e/classfemus_1_1elem.html#a491172d27d04d10ce166f42161d0c1d1">GetFaceElementIndex</a>(iel,jface) &lt; 0) {</div>
<div class="line"><span class="lineno">  681</span>              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = -( msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>-&gt;<a class="code hl_function" href="../../db/d2e/classfemus_1_1elem.html#a491172d27d04d10ce166f42161d0c1d1">GetFaceElementIndex</a>(iel,jface)+1);</div>
<div class="line"><span class="lineno">  682</span>              <span class="keywordflow">if</span>(  face == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) { <span class="comment">//control face</span></div>
<div class="line"><span class="lineno">  683</span><span class="comment">//=================================================== </span></div>
<div class="line"><span class="lineno">  684</span>                   <span class="comment">//we use the dirichlet flag to say: if dirichlet == true, we set 1 on the diagonal. if dirichlet == false, we put the boundary equation</span></div>
<div class="line"><span class="lineno">  685</span>                  std::vector &lt; bool &gt; dir_bool(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  686</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  687</span>                      dir_bool[idim] = <span class="keyword">false</span>; <span class="comment">//mlSol-&gt;GetBdcFunction()(xyz_bdc,ctrl_name[idim].c_str(),tau,face,0.);</span></div>
<div class="line"><span class="lineno">  688</span>                  }</div>
<div class="line"><span class="lineno">  689</span>          </div>
<div class="line"><span class="lineno">  690</span><span class="comment">//=================================================== </span></div>
<div class="line"><span class="lineno">  691</span>                <span class="keywordtype">unsigned</span> nve_bd = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af372596998e5d55a1fa15d6c5f58f52b">GetElementFaceDofNumber</a>(iel,jface, SolFEType[ctrl_pos_begin] ); <span class="comment">//AAAAAAAAAAAAAAAAA</span></div>
<div class="line"><span class="lineno">  692</span>                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> felt_bd = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a57f92951660269429cc7f04ee3c26c17">GetElementFaceType</a>(iel, jface);    </div>
<div class="line"><span class="lineno">  693</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0; i &lt; nve_bd; i++) {</div>
<div class="line"><span class="lineno">  694</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">GetLocalFaceVertexIndex</a>(iel, jface, i);</div>
<div class="line"><span class="lineno">  695</span>                    <span class="keywordtype">unsigned</span>      iDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i_vol, iel, coordsType);</div>
<div class="line"><span class="lineno">  696</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) { coords_hat_bd[idim][i]=(*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[idim])(iDof); }</div>
<div class="line"><span class="lineno">  697</span>                }</div>
<div class="line"><span class="lineno">  698</span>                </div>
<div class="line"><span class="lineno">  699</span><span class="comment">//========= initialize gauss quantities on the boundary ============================================</span></div>
<div class="line"><span class="lineno">  700</span>         std::vector &lt; real_num &gt;                      SolVAR_bd_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  701</span>         std::vector &lt; std::vector &lt; real_num &gt; &gt;       gradSolVAR_bd_qp(n_unknowns);</div>
<div class="line"><span class="lineno">  702</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;n_unknowns; k++) {  gradSolVAR_bd_qp[k].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);  }</div>
<div class="line"><span class="lineno">  703</span> </div>
<div class="line"><span class="lineno">  704</span><span class="comment">//========= gauss_loop boundary===============================================================</span></div>
<div class="line"><span class="lineno">  705</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ig_bd=0; ig_bd &lt; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(felt_bd).GetGaussPointsNumber(); ig_bd++) {</div>
<div class="line"><span class="lineno">  706</span> </div>
<div class="line"><span class="lineno">  707</span>              ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[felt_bd][SolFEType[theta_index]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a41bf5e7188a121649319194e846e533f">JacobianSur</a>(coords_hat_bd,ig_bd,weight_hat_bd_qp,phi_hat_bd_dof_qp[theta_index],phi_hat_bd_x_dof_qp[theta_index],normal);</div>
<div class="line"><span class="lineno">  708</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno">  709</span>                      ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[felt_bd][SolFEType[kdim + ctrl_pos_begin]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a41bf5e7188a121649319194e846e533f">JacobianSur</a>(coords_hat_bd,ig_bd,weight_hat_bd_qp,phi_hat_bd_dof_qp[kdim + ctrl_pos_begin],phi_hat_bd_x_dof_qp[kdim + ctrl_pos_begin],normal);</div>
<div class="line"><span class="lineno">  710</span>                      ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[ielGeom][SolFEType[kdim + adj_pos_begin]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a6d73c16abce658954e974bf32a5846c7">fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem</a>(coords_hat,coords_hat_bd,jface,ig_bd,phi_hat_vol_at_bdry_dof[kdim + adj_pos_begin],phi_hat_x_vol_at_bdry_dof[kdim + adj_pos_begin]);</div>
<div class="line"><span class="lineno">  711</span>            }</div>
<div class="line"><span class="lineno">  712</span>            </div>
<div class="line"><span class="lineno">  713</span>            </div>
<div class="line"><span class="lineno">  714</span> <a class="code hl_function" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#abdd1e0dbfc8ed6ec0a237d9654d0bce9">set_phi_gradient_surface</a>(<a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a668a0b03c0385e061dad5178865e3b99">AXIS_DIRECTION_CONTROL_SIDE</a>, msh, ig_bd, SolFEType, felt_bd, nve_bd, coords_hat_bd, phi_hat_bd_x_dof_qp, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, ctrl_pos_begin);</div>
<div class="line"><span class="lineno">  715</span> </div>
<div class="line"><span class="lineno">  716</span> </div>
<div class="line"><span class="lineno">  717</span><span class="comment">//========== compute gauss quantities on the boundary ===============================================</span></div>
<div class="line"><span class="lineno">  718</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno">  719</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctrl_index = kdim + ctrl_pos_begin;</div>
<div class="line"><span class="lineno">  720</span>                                                                                  SolVAR_bd_qp[ SolPdeIndex[ctrl_index] ] = 0.;</div>
<div class="line"><span class="lineno">  721</span>                          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {  gradSolVAR_bd_qp[ SolPdeIndex[ctrl_index] ][ivar2] = 0.; }</div>
<div class="line"><span class="lineno">  722</span>            }</div>
<div class="line"><span class="lineno">  723</span>          </div>
<div class="line"><span class="lineno">  724</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno">  725</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctrl_index = kdim + ctrl_pos_begin;</div>
<div class="line"><span class="lineno">  726</span>                          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i_bd = 0; i_bd &lt; nve_bd; i_bd++) {</div>
<div class="line"><span class="lineno">  727</span>                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">GetLocalFaceVertexIndex</a>(iel, jface, i_bd);</div>
<div class="line"><span class="lineno">  728</span>                                                                    SolVAR_bd_qp[SolPdeIndex[ctrl_index]]           += phi_hat_bd_dof_qp  [ ctrl_index ][i_bd]                  * SolVAR_eldofs[ SolPdeIndex[ ctrl_index ] ][i_vol];</div>
<div class="line"><span class="lineno">  729</span>                              <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {  gradSolVAR_bd_qp[SolPdeIndex[ctrl_index]][ivar2]     += phi_hat_bd_x_dof_qp[ ctrl_index ][i_bd + ivar2 * nve_bd] * SolVAR_eldofs[ SolPdeIndex[ ctrl_index ] ][i_vol];      }</div>
<div class="line"><span class="lineno">  730</span>                          }</div>
<div class="line"><span class="lineno">  731</span>                    }<span class="comment">//kdim</span></div>
<div class="line"><span class="lineno">  732</span> <span class="comment">//end unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno">  733</span> </div>
<div class="line"><span class="lineno">  734</span> </div>
<div class="line"><span class="lineno">  735</span><span class="comment">//=============== grad dot n for residual ========================================= </span></div>
<div class="line"><span class="lineno">  736</span><span class="comment">//     compute gauss quantities on the boundary through VOLUME interpolation</span></div>
<div class="line"><span class="lineno">  737</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ldim=0; ldim&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ldim++) {   sol_hat_adj_x_vol_at_bdry_qp[ldim].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>); }</div>
<div class="line"><span class="lineno">  738</span>                grad_dot_n_adj_res.resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  739</span>                grad_adj_dot_n.resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno">  740</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ldim=0; ldim&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ldim++) {   std::fill(sol_hat_adj_x_vol_at_bdry_qp[ldim].begin(), sol_hat_adj_x_vol_at_bdry_qp[ldim].end(), 0.);  }</div>
<div class="line"><span class="lineno">  741</span>                </div>
<div class="line"><span class="lineno">  742</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ldim=0; ldim&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ldim++) {  </div>
<div class="line"><span class="lineno">  743</span>                  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv = 0; iv &lt; Sol_n_el_dofs[adj_pos_begin]; iv++)  {</div>
<div class="line"><span class="lineno">  744</span>                     <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno">  745</span>                           sol_hat_adj_x_vol_at_bdry_qp[ldim][d] += SolVAR_eldofs[SolPdeIndex[ldim + adj_pos_begin]][iv] * phi_hat_x_vol_at_bdry_dof[ldim + adj_pos_begin][iv * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];<span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><span class="lineno">  746</span>                     }</div>
<div class="line"><span class="lineno">  747</span>                  }  </div>
<div class="line"><span class="lineno">  748</span>                      </div>
<div class="line"><span class="lineno">  749</span>                  grad_dot_n_adj_res[ldim] = 0.;</div>
<div class="line"><span class="lineno">  750</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0; d&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno">  751</span>                      grad_dot_n_adj_res[ldim] += sol_hat_adj_x_vol_at_bdry_qp[ldim][d]*normal[d];  </div>
<div class="line"><span class="lineno">  752</span>                  }</div>
<div class="line"><span class="lineno">  753</span>                }</div>
<div class="line"><span class="lineno">  754</span><span class="comment">//=============== grad dot n  for residual =========================================       </span></div>
<div class="line"><span class="lineno">  755</span>                  </div>
<div class="line"><span class="lineno">  756</span><span class="comment">//========== compute gauss quantities on the boundary ================================================</span></div>
<div class="line"><span class="lineno">  757</span> </div>
<div class="line"><span class="lineno">  758</span>                </div>
<div class="line"><span class="lineno">  759</span>  <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><span class="lineno">  760</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_bdry=0; i_bdry &lt; nve_bd; i_bdry++) {</div>
<div class="line"><span class="lineno">  761</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">GetLocalFaceVertexIndex</a>(iel, jface, i_bdry);</div>
<div class="line"><span class="lineno">  762</span>                 </div>
<div class="line"><span class="lineno">  763</span><span class="comment">//=============== construct control node flag field on the go  =========================================    </span></div>
<div class="line"><span class="lineno">  764</span>              <span class="comment">/* (control_node_flag[i])       picks nodes on \Gamma_c</span></div>
<div class="line"><span class="lineno">  765</span><span class="comment">                 (1 - control_node_flag[i])   picks nodes on \Omega \setminus \Gamma_c</span></div>
<div class="line"><span class="lineno">  766</span><span class="comment">               */</span></div>
<div class="line"><span class="lineno">  767</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  768</span>                        <span class="keywordflow">if</span> (dir_bool[idim] == <span class="keyword">false</span>) { </div>
<div class="line"><span class="lineno">  769</span><span class="comment">//              std::cout &lt;&lt; &quot; found boundary control nodes ==== &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><span class="lineno">  770</span>                            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> k=0; k &lt; control_node_flag[idim].size(); k++) {</div>
<div class="line"><span class="lineno">  771</span>                                  control_node_flag[idim][i_vol] = 1;</div>
<div class="line"><span class="lineno">  772</span>                            }</div>
<div class="line"><span class="lineno">  773</span>                        }</div>
<div class="line"><span class="lineno">  774</span>                    }</div>
<div class="line"><span class="lineno">  775</span><span class="comment">//=============== construct control node flag field on the go  =========================================    </span></div>
<div class="line"><span class="lineno">  776</span>                </div>
<div class="line"><span class="lineno">  777</span>                  </div>
<div class="line"><span class="lineno">  778</span><span class="comment">//Boundary Residuals  and Jacobians ==================  </span></div>
<div class="line"><span class="lineno">  779</span> </div>
<div class="line"><span class="lineno">  780</span>                  </div>
<div class="line"><span class="lineno">  781</span><span class="comment">//============ Boundary Residuals============================================================================================</span></div>
<div class="line"><span class="lineno">  782</span>                  </div>
<div class="line"><span class="lineno">  783</span>                      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno">  784</span>                        </div>
<div class="line"><span class="lineno">  785</span>                            real_num lap_res_dctrl_ctrl_bd = 0.;</div>
<div class="line"><span class="lineno">  786</span>                              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  787</span>                                  lap_res_dctrl_ctrl_bd += gradSolVAR_bd_qp[SolPdeIndex[kdim + ctrl_pos_begin]][jdim]*phi_hat_bd_x_dof_qp[kdim + ctrl_pos_begin][i_bdry + jdim*nve_bd];</div>
<div class="line"><span class="lineno">  788</span>                              }<span class="comment">//jdim</span></div>
<div class="line"><span class="lineno">  789</span> </div>
<div class="line"><span class="lineno">  790</span>                        </div>
<div class="line"><span class="lineno">  791</span><span class="comment">/*delta_state row */</span>        <span class="keywordflow">if</span>(i_vol&lt;Sol_n_el_dofs[state_pos_begin])   Res_bd[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[kdim], i_vol) ]                += control_node_flag[kdim][i_vol] * <a class="code hl_variable" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a92a609d215ec3c30302b119aa0df10f0">penalty_ctrl</a> * (SolVAR_eldofs[SolPdeIndex[kdim + state_pos_begin]][i_vol] - SolVAR_eldofs[SolPdeIndex[kdim + ctrl_pos_begin]][i_vol]);         <span class="comment">//u-g</span></div>
<div class="line"><span class="lineno">  792</span><span class="comment">/*delta_adjoint row */</span>     <span class="keywordflow">if</span>(i_vol&lt;Sol_n_el_dofs[adj_pos_begin])   Res_bd[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[kdim + adj_pos_begin], i_vol) ] += 0.;      </div>
<div class="line"><span class="lineno">  793</span><span class="comment">/*delta_control row */</span>     <span class="keywordflow">if</span>(i_vol&lt;Sol_n_el_dofs[ctrl_pos_begin])  Res_bd[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[kdim + ctrl_pos_begin], i_vol) ]  += control_node_flag[kdim][i_vol] * weight_hat_bd_qp * (</div>
<div class="line"><span class="lineno">  794</span>                                                                                          <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>* SolVAR_bd_qp[SolPdeIndex[kdim + ctrl_pos_begin]] * phi_hat_bd_dof_qp[kdim +  ctrl_pos_begin][i_bdry]</div>
<div class="line"><span class="lineno">  795</span>                                                                                        + <a class="code hl_variable" href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a>* lap_res_dctrl_ctrl_bd</div>
<div class="line"><span class="lineno">  796</span>                                                                                        - nondim_number * mus * grad_dot_n_adj_res[kdim]  * phi_hat_bd_dof_qp[kdim +  ctrl_pos_begin][i_bdry]</div>
<div class="line"><span class="lineno">  797</span>                                                                                        );          </div>
<div class="line"><span class="lineno">  798</span>                      }<span class="comment">//kdim  </span></div>
<div class="line"><span class="lineno">  799</span> </div>
<div class="line"><span class="lineno">  800</span><span class="comment">//============ Boundary Residuals  ==================================================================================================</span></div>
<div class="line"><span class="lineno">  801</span> </div>
<div class="line"><span class="lineno">  802</span> </div>
<div class="line"><span class="lineno">  803</span>                        }<span class="comment">//end i_bdry loop</span></div>
<div class="line"><span class="lineno">  804</span> </div>
<div class="line"><span class="lineno">  805</span>                    }  <span class="comment">//end ig_bdry loop</span></div>
<div class="line"><span class="lineno">  806</span>          </div>
<div class="line"><span class="lineno">  807</span>                }    <span class="comment">//end if control face</span></div>
<div class="line"><span class="lineno">  808</span>            }  <span class="comment">//end if boundary faces</span></div>
<div class="line"><span class="lineno">  809</span>        }  <span class="comment">// loop over element faces //jface   </span></div>
<div class="line"><span class="lineno">  810</span>  } <span class="comment">//end if control element flag</span></div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span><span class="comment">//End Boundary Residuals  and Jacobians ==================      </span></div>
<div class="line"><span class="lineno">  813</span> </div>
<div class="line"><span class="lineno">  814</span> </div>
<div class="line"><span class="lineno">  815</span><span class="comment">//======================= Loop without Integration =====================================================    </span></div>
<div class="line"><span class="lineno">  816</span>        <span class="comment">//============ delta_theta - theta row ==================================================================================================</span></div>
<div class="line"><span class="lineno">  817</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[theta_index]; i++) {</div>
<div class="line"><span class="lineno">  818</span>             <span class="comment">/* if ( fake_theta_flag[i] != 1 ) */</span>       Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[theta_index], i) ]    = (1 - fake_theta_flag[i]) * ( <a class="code hl_variable" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a949680fe5298ccbe0a9d804df0b792ee">theta_value_outside_fake_element</a> - SolVAR_eldofs[SolPdeIndex[theta_index]][i]);  <span class="comment">// Res_outer for the exact row (i.e. when fakeflag=1 , res =0(use Res_outer) and if not 1 this loop) and this is to take care of fake placement for the rest of dofs of theta values as 8</span></div>
<div class="line"><span class="lineno">  819</span>        }<span class="comment">//i_theta loop</span></div>
<div class="line"><span class="lineno">  820</span>   </div>
<div class="line"><span class="lineno">  821</span> <span class="comment">//============ delta_theta row ==================================================================================================</span></div>
<div class="line"><span class="lineno">  822</span> <span class="comment">//======================= Loop without Integration =====================================================    </span></div>
<div class="line"><span class="lineno">  823</span> </div>
<div class="line"><span class="lineno">  824</span> </div>
<div class="line"><span class="lineno">  825</span> </div>
<div class="line"><span class="lineno">  826</span> </div>
<div class="line"><span class="lineno">  827</span><span class="comment">//======================= VolumeLoop with Integration (and fake boundary) =====================================================    </span></div>
<div class="line"><span class="lineno">  828</span><span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno">  829</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ig = 0; ig &lt; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom).<a class="code hl_function" href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">GetGaussPointsNumber</a>(); ig++) {</div>
<div class="line"><span class="lineno">  830</span> </div>
<div class="line"><span class="lineno">  831</span>        <span class="comment">// *** get Jacobian and test function and test function derivatives ***</span></div>
<div class="line"><span class="lineno">  832</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {</div>
<div class="line"><span class="lineno">  833</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    ig,weight_qp,    phi_dof_qp[unk],    phi_x_dof_qp[unk],    phi_xx_dof_qp[unk]);</div>
<div class="line"><span class="lineno">  834</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,ig,weight_hat_qp,phi_hat_dof_qp[unk],phi_x_hat_dof_qp[unk],phi_xx_hat_dof_qp[unk]);</div>
<div class="line"><span class="lineno">  835</span>      }</div>
<div class="line"><span class="lineno">  836</span>      </div>
<div class="line"><span class="lineno">  837</span>   <span class="comment">//=============== Integration at qp ========================================</span></div>
<div class="line"><span class="lineno">  838</span>         <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN...</span></div>
<div class="line"><span class="lineno">  839</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno">  840</span>         msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    ig, weight_qp,    phi_dof_qp_domain[d],     phi_x_dof_qp_domain[d],     phi_xx_dof_qp_domain[d]);</div>
<div class="line"><span class="lineno">  841</span>         msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,ig, weight_hat_qp,phi_dof_qp_domain_hat[d], phi_x_dof_qp_domain_hat[d], phi_xx_dof_qp_domain_hat[d]);</div>
<div class="line"><span class="lineno">  842</span>      }</div>
<div class="line"><span class="lineno">  843</span>     </div>
<div class="line"><span class="lineno">  844</span>  <span class="comment">//begin unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno">  845</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> unk = 0; unk &lt;  n_unknowns; unk++) {</div>
<div class="line"><span class="lineno">  846</span>          SolVAR_qp[SolPdeIndex[unk]] = 0.;</div>
<div class="line"><span class="lineno">  847</span>          SolVAR_hat_qp[SolPdeIndex[unk] ]= 0.;</div>
<div class="line"><span class="lineno">  848</span> </div>
<div class="line"><span class="lineno">  849</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++){ </div>
<div class="line"><span class="lineno">  850</span>            gradSolVAR_qp[SolPdeIndex[unk]][ivar2] = 0.; </div>
<div class="line"><span class="lineno">  851</span>            gradSolVAR_hat_qp[SolPdeIndex[unk]][ivar2] = 0.; </div>
<div class="line"><span class="lineno">  852</span>          }</div>
<div class="line"><span class="lineno">  853</span>    }</div>
<div class="line"><span class="lineno">  854</span>          </div>
<div class="line"><span class="lineno">  855</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> unk = 0; unk &lt;  n_unknowns; unk++) {</div>
<div class="line"><span class="lineno">  856</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[unk]; i++) {</div>
<div class="line"><span class="lineno">  857</span>            SolVAR_qp[SolPdeIndex[unk]]    += phi_dof_qp[ unk ][i] * SolVAR_eldofs[SolPdeIndex[unk]][i];</div>
<div class="line"><span class="lineno">  858</span>            SolVAR_hat_qp[SolPdeIndex[unk]]    += phi_hat_dof_qp[ unk ][i] * SolVAR_eldofs[SolPdeIndex[unk]][i];</div>
<div class="line"><span class="lineno">  859</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2 = 0; ivar2 &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {</div>
<div class="line"><span class="lineno">  860</span>              gradSolVAR_qp[SolPdeIndex[unk]][ivar2]     += phi_x_dof_qp[ unk ][i*<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[SolPdeIndex[unk]][i]; </div>
<div class="line"><span class="lineno">  861</span>              gradSolVAR_hat_qp[SolPdeIndex[unk]][ivar2] += phi_x_hat_dof_qp[ unk ][i*<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[SolPdeIndex[unk]][i]; </div>
<div class="line"><span class="lineno">  862</span>            }</div>
<div class="line"><span class="lineno">  863</span>          }</div>
<div class="line"><span class="lineno">  864</span>          </div>
<div class="line"><span class="lineno">  865</span>        }  </div>
<div class="line"><span class="lineno">  866</span> <span class="comment">//end unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno">  867</span> </div>
<div class="line"><span class="lineno">  868</span> </div>
<div class="line"><span class="lineno">  869</span><span class="comment">//  assemble_jacobian&lt; real_num, real_num_mov &gt;::mass_residual (Res, Sol_n_el_dofs, sum_Sol_n_el_dofs, SolPdeIndex, phi_dof_qp, SolVAR_qp, weight_hat_qp); //identity</span></div>
<div class="line"><span class="lineno">  870</span> </div>
<div class="line"><span class="lineno">  871</span> </div>
<div class="line"><span class="lineno">  872</span> <span class="comment">//*******************************************************************************************************</span></div>
<div class="line"><span class="lineno">  873</span>   std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; Cauchy(3); <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Cauchy.size(); i++) Cauchy[i].resize(3);</div>
<div class="line"><span class="lineno">  874</span>   real_num_mov J_hat;</div>
<div class="line"><span class="lineno">  875</span>   real_num_mov trace_e_hat;</div>
<div class="line"><span class="lineno">  876</span> </div>
<div class="line"><span class="lineno">  877</span> </div>
<div class="line"><span class="lineno">  878</span> Cauchy = Solid::get_Cauchy_stress_tensor&lt; real_num_mov &gt;(solid_model, mus, lambda_lame, incompressible, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, sol_index_displ, sol_index_press, gradSolVAR_hat_qp, SolVAR_qp, SolPdeIndex, J_hat, trace_e_hat);</div>
<div class="line"><span class="lineno">  879</span> </div>
<div class="line"><span class="lineno">  880</span>    </div>
<div class="line"><span class="lineno">  881</span>  <span class="comment">//STATE=====================================</span></div>
<div class="line"><span class="lineno">  882</span><span class="comment">//----------from displ_state and p_state</span></div>
<div class="line"><span class="lineno">  883</span>              <span class="comment">//BEGIN residual Solid Momentum in moving domain</span></div>
<div class="line"><span class="lineno">  884</span>          <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_displ]; i++) {</div>
<div class="line"><span class="lineno">  885</span> </div>
<div class="line"><span class="lineno">  886</span>              real_num_mov Cauchy_direction[3] = {0., 0., 0.};</div>
<div class="line"><span class="lineno">  887</span> </div>
<div class="line"><span class="lineno">  888</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0.; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  889</span>                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> jdim = 0.; jdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><span class="lineno">  890</span>                  Cauchy_direction[idim] += nondim_number * phi_x_dof_qp[ idim ][i * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + jdim] * Cauchy[idim][jdim];</div>
<div class="line"><span class="lineno">  891</span>                }</div>
<div class="line"><span class="lineno">  892</span>              }</div>
<div class="line"><span class="lineno">  893</span> </div>
<div class="line"><span class="lineno">  894</span>              <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  895</span>                Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[idim], i) ] += ( Cauchy_direction[idim] -  phi_dof_qp[ idim ][i] * <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a491774c0485f249809d76f7933b79419">_gravity</a>[idim] ) * weight_qp;</div>
<div class="line"><span class="lineno">  896</span>              }</div>
<div class="line"><span class="lineno">  897</span> </div>
<div class="line"><span class="lineno">  898</span>            }</div>
<div class="line"><span class="lineno">  899</span>              <span class="comment">//END residual Solid Momentum in moving domain</span></div>
<div class="line"><span class="lineno">  900</span><span class="comment">//----------from displ_state and p_state</span></div>
<div class="line"><span class="lineno">  901</span>              </div>
<div class="line"><span class="lineno">  902</span> </div>
<div class="line"><span class="lineno">  903</span><span class="comment">//----------from displ_state of divergence</span></div>
<div class="line"><span class="lineno">  904</span>              <span class="comment">//BEGIN residual solid mass balance in reference domain</span></div>
<div class="line"><span class="lineno">  905</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_press]; i++) {</div>
<div class="line"><span class="lineno">  906</span>                </div>
<div class="line"><span class="lineno">  907</span>              Res[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[sol_index_press], i) ] += </div>
<div class="line"><span class="lineno">  908</span>                - weight_hat_qp * phi_hat_dof_qp[ sol_index_press ][i] * Solid::get_mass_balance_reference_domain&lt; real_num_mov &gt;(solid_model, penalty, incompressible, lambda_lame, trace_e_hat, J_hat, SolVAR_qp, SolPdeIndex, sol_index_press);</div>
<div class="line"><span class="lineno">  909</span><span class="comment">//               - weight_hat_qp * phi_dof_qp[ sol_index_press ][i] * Solid::get_mass_balance_moving_domain&lt; real_num_mov &gt;(gradSolVAR_qp, SolPdeIndex);</span></div>
<div class="line"><span class="lineno">  910</span>              </div>
<div class="line"><span class="lineno">  911</span>            }</div>
<div class="line"><span class="lineno">  912</span>              <span class="comment">//END residual solid mass balance in reference domain</span></div>
<div class="line"><span class="lineno">  913</span><span class="comment">//----------from displ_state of div</span></div>
<div class="line"><span class="lineno">  914</span>  <span class="comment">//STATE=====================================</span></div>
<div class="line"><span class="lineno">  915</span> </div>
<div class="line"><span class="lineno">  916</span> </div>
<div class="line"><span class="lineno">  917</span> <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno">  918</span><span class="comment">//----------from displ_state and displ_ctrl</span></div>
<div class="line"><span class="lineno">  919</span>         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_adj]; i++) {</div>
<div class="line"><span class="lineno">  920</span>               <span class="keywordflow">for</span> (<span class="keywordtype">int</span> idim = 0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno">  921</span>   Res[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[idim + adj_pos_begin], i)] += </div>
<div class="line"><span class="lineno">  922</span>    - <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a> * target_flag * (SolVAR_hat_qp[SolPdeIndex[idim]] - <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a80e1487a07155d5b24edd6eca186b73b">TargetDisp</a>[idim]) </div>
<div class="line"><span class="lineno">  923</span>     * phi_dof_qp[ idim + adj_pos_begin ][i] * weight_qp;</div>
<div class="line"><span class="lineno">  924</span>               }</div>
<div class="line"><span class="lineno">  925</span>          }</div>
<div class="line"><span class="lineno">  926</span><span class="comment">//----------from displ_state and displ_ctrl</span></div>
<div class="line"><span class="lineno">  927</span> <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno">  928</span> </div>
<div class="line"><span class="lineno">  929</span>               </div>
<div class="line"><span class="lineno">  930</span> <span class="comment">//CONTROL=====================================</span></div>
<div class="line"><span class="lineno">  931</span> <span class="comment">//============ delta_control row ==================================================================================================</span></div>
<div class="line"><span class="lineno">  932</span><span class="comment">// delta_control</span></div>
<div class="line"><span class="lineno">  933</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) { </div>
<div class="line"><span class="lineno">  934</span>         <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[ctrl_pos_begin]; i++) {</div>
<div class="line"><span class="lineno">  935</span>       Res[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[kdim + ctrl_pos_begin], i) ] += - <a class="code hl_variable" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a480ad40eedfb9ced9d7b090e19b3b85a">penalty_outside_control_boundary</a> * ( (1 - control_node_flag[kdim][i]) * (  SolVAR_eldofs[SolPdeIndex[kdim + ctrl_pos_begin]][i] - 0.)  );              <span class="comment">//enforce control zero outside the control boundary</span></div>
<div class="line"><span class="lineno">  936</span>        }<span class="comment">//i_ctrl loop</span></div>
<div class="line"><span class="lineno">  937</span>    }  <span class="comment">//kdim</span></div>
<div class="line"><span class="lineno">  938</span> </div>
<div class="line"><span class="lineno">  939</span> <span class="comment">//============ delta_control row ==================================================================================================</span></div>
<div class="line"><span class="lineno">  940</span> <span class="comment">//CONTROL=====================================</span></div>
<div class="line"><span class="lineno">  941</span> </div>
<div class="line"><span class="lineno">  942</span>        </div>
<div class="line"><span class="lineno">  943</span>        </div>
<div class="line"><span class="lineno">  944</span>    } <span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno">  945</span> </div>
<div class="line"><span class="lineno">  946</span>    <span class="comment">//--------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  947</span> </div>
<div class="line"><span class="lineno">  948</span>    </div>
<div class="line"><span class="lineno">  949</span> <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Res_state.size(); i++) {</div>
<div class="line"><span class="lineno">  950</span>        Res_state[i] = Res[i];</div>
<div class="line"><span class="lineno">  951</span>  }</div>
<div class="line"><span class="lineno">  952</span>  </div>
<div class="line"><span class="lineno">  953</span>    std::vector &lt; double &gt; Res_state_double(Res_state.size());</div>
<div class="line"><span class="lineno">  954</span> </div>
<div class="line"><span class="lineno">  955</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; Res_state_double.size(); i++) {</div>
<div class="line"><span class="lineno">  956</span>      Res_state_double[i] = - Res_state[i].value();</div>
<div class="line"><span class="lineno">  957</span>    }</div>
<div class="line"><span class="lineno">  958</span> </div>
<div class="line"><span class="lineno">  959</span> </div>
<div class="line"><span class="lineno">  960</span>    stack_state.dependent(  &amp; Res_state[0], Res_state_double.size());      <span class="comment">// define the dependent variables</span></div>
<div class="line"><span class="lineno">  961</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_state_vars; k++) {   </div>
<div class="line"><span class="lineno">  962</span>    stack_state.independent(&amp;SolVAR_eldofs[k][0],       SolVAR_eldofs[k].size());    <span class="comment">// define the independent variables</span></div>
<div class="line"><span class="lineno">  963</span>    }</div>
<div class="line"><span class="lineno">  964</span>    </div>
<div class="line"><span class="lineno">  965</span>    stack_state.jacobian(&amp;Jac_state_true[0], <span class="keyword">true</span>);    <span class="comment">// get the jacobian matrix (ordered by row major for Ctrl block in delta_state) </span></div>
<div class="line"><span class="lineno">  966</span>    stack_state.jacobian(&amp;Jac_state_false[0], <span class="keyword">false</span>);    <span class="comment">// get the jacobian matrix (ordered by column major for Adjoint) // Adj = transpose of state block</span></div>
<div class="line"><span class="lineno">  967</span> </div>
<div class="line"><span class="lineno">  968</span>    stack_state.clear_independents();</div>
<div class="line"><span class="lineno">  969</span>    stack_state.clear_dependents();    </div>
<div class="line"><span class="lineno">  970</span> </div>
<div class="line"><span class="lineno">  971</span> </div>
<div class="line"><span class="lineno">  972</span>  <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno">  973</span><span class="comment">//----------from adj displ</span></div>
<div class="line"><span class="lineno">  974</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = adj_pos_begin; i_block &lt; adj_pos_begin + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i_block++) {</div>
<div class="line"><span class="lineno">  975</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  976</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = 0; j_block &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block++) {</div>
<div class="line"><span class="lineno">  977</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  978</span>    Res[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  979</span>        Jac_state_false[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - adj_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  980</span>            * SolVAR_eldofs[SolPdeIndex[j_block + adj_pos_begin]][j_dof];</div>
<div class="line"><span class="lineno">  981</span>                }</div>
<div class="line"><span class="lineno">  982</span>           }</div>
<div class="line"><span class="lineno">  983</span>        }</div>
<div class="line"><span class="lineno">  984</span>   }</div>
<div class="line"><span class="lineno">  985</span><span class="comment">//----------from adj displ </span></div>
<div class="line"><span class="lineno">  986</span> </div>
<div class="line"><span class="lineno">  987</span><span class="comment">//----------from p_adj only</span></div>
<div class="line"><span class="lineno">  988</span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = adj_pos_begin; i_block &lt; adj_pos_begin + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> ; i_block++) {</div>
<div class="line"><span class="lineno">  989</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno">  990</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block &lt; n_state_vars; j_block++) {</div>
<div class="line"><span class="lineno">  991</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno">  992</span>    Res[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno">  993</span>        Jac_state_true[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - adj_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno">  994</span>            * SolVAR_eldofs[SolPdeIndex[j_block + adj_pos_begin]][j_dof];</div>
<div class="line"><span class="lineno">  995</span>                }</div>
<div class="line"><span class="lineno">  996</span>           }</div>
<div class="line"><span class="lineno">  997</span>        }</div>
<div class="line"><span class="lineno">  998</span>   }</div>
<div class="line"><span class="lineno">  999</span><span class="comment">//----------from p_adj only</span></div>
<div class="line"><span class="lineno"> 1000</span> </div>
<div class="line"><span class="lineno"> 1001</span><span class="comment">//----------from div of displ_adj</span></div>
<div class="line"><span class="lineno"> 1002</span>   <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = sol_index_press_adj; i_block &lt; ctrl_pos_begin ; i_block++) {</div>
<div class="line"><span class="lineno"> 1003</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno"> 1004</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_block = 0; j_block &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; j_block++) {</div>
<div class="line"><span class="lineno"> 1005</span>               <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_dof = 0; j_dof &lt; Sol_n_el_dofs[j_block]; j_dof++) {</div>
<div class="line"><span class="lineno"> 1006</span>    Res[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno"> 1007</span>        Jac_state_true[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, state_sum_Sol_n_el_dofs,i_block - adj_pos_begin , j_block, i_dof, j_dof )] </div>
<div class="line"><span class="lineno"> 1008</span>            * SolVAR_eldofs[SolPdeIndex[j_block + adj_pos_begin]][j_dof];</div>
<div class="line"><span class="lineno"> 1009</span>                }</div>
<div class="line"><span class="lineno"> 1010</span>           }</div>
<div class="line"><span class="lineno"> 1011</span>        }</div>
<div class="line"><span class="lineno"> 1012</span>   }</div>
<div class="line"><span class="lineno"> 1013</span><span class="comment">// ----------from div of displ_adj</span></div>
<div class="line"><span class="lineno"> 1014</span>  <span class="comment">//ADJOINT=====================================</span></div>
<div class="line"><span class="lineno"> 1015</span> </div>
<div class="line"><span class="lineno"> 1016</span> </div>
<div class="line"><span class="lineno"> 1017</span>    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_block = 0; i_block &lt; n_unknowns; i_block++) {</div>
<div class="line"><span class="lineno"> 1018</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_dof = 0; i_dof &lt; Sol_n_el_dofs[i_block]; i_dof++) {</div>
<div class="line"><span class="lineno"> 1019</span>                Res[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)] += </div>
<div class="line"><span class="lineno"> 1020</span>                Res_bd[<a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, i_block, i_dof)];</div>
<div class="line"><span class="lineno"> 1021</span>            }</div>
<div class="line"><span class="lineno"> 1022</span>    }</div>
<div class="line"><span class="lineno"> 1023</span> </div>
<div class="line"><span class="lineno"> 1024</span>  </div>
<div class="line"><span class="lineno"> 1025</span>      </div>
<div class="line"><span class="lineno"> 1026</span>     <span class="keywordflow">if</span> (assembleMatrix) assemble_jac.compute_jacobian_outside_integration_loop(stack, SolVAR_eldofs, Res, Jac, L2G_dofmap_AllVars, RES, JAC);</div>
<div class="line"><span class="lineno"> 1027</span> </div>
<div class="line"><span class="lineno"> 1028</span> </div>
<div class="line"><span class="lineno"> 1029</span><span class="comment">//       //***************************************************************************************************************</span></div>
<div class="line"><span class="lineno"> 1030</span>     </div>
<div class="line"><span class="lineno"> 1031</span>  <span class="keywordflow">if</span> (control_el_flag == 1) {</div>
<div class="line"><span class="lineno"> 1032</span>      </div>
<div class="line"><span class="lineno"> 1033</span>      std::vector &lt; double &gt; normal(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,0);</div>
<div class="line"><span class="lineno"> 1034</span> </div>
<div class="line"><span class="lineno"> 1035</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface = 0; jface &lt; msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a3c2977b3363513c86c5cdb0e645a78bd">GetElementFaceNumber</a>(iel); jface++) {</div>
<div class="line"><span class="lineno"> 1036</span>                </div>
<div class="line"><span class="lineno"> 1037</span>                  <span class="keywordflow">if</span>(el-&gt;<a class="code hl_function" href="../../db/d2e/classfemus_1_1elem.html#a491172d27d04d10ce166f42161d0c1d1">GetFaceElementIndex</a>(iel,jface) &lt; 0) {  <span class="comment">//I am on the boundary</span></div>
<div class="line"><span class="lineno"> 1038</span> </div>
<div class="line"><span class="lineno"> 1039</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = -( msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>-&gt;<a class="code hl_function" href="../../db/d2e/classfemus_1_1elem.html#a491172d27d04d10ce166f42161d0c1d1">GetFaceElementIndex</a>(iel,jface)+1);</div>
<div class="line"><span class="lineno"> 1040</span>                        <span class="keywordflow">if</span>(  face == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) { <span class="comment">//I am a control face</span></div>
<div class="line"><span class="lineno"> 1041</span>              </div>
<div class="line"><span class="lineno"> 1042</span>                <span class="keywordtype">unsigned</span> nve_bd = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af372596998e5d55a1fa15d6c5f58f52b">GetElementFaceDofNumber</a>(iel,jface, SolFEType[ctrl_pos_begin] ); <span class="comment">//AAAAAAAAAAAAAAAAA</span></div>
<div class="line"><span class="lineno"> 1043</span>                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> felt_bd = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a57f92951660269429cc7f04ee3c26c17">GetElementFaceType</a>(iel, jface);    </div>
<div class="line"><span class="lineno"> 1044</span> </div>
<div class="line"><span class="lineno"> 1045</span>         std::vector &lt; real_num &gt;                      SolVAR_bd_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1046</span> </div>
<div class="line"><span class="lineno"> 1047</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ig_bd=0; ig_bd &lt; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(felt_bd).GetGaussPointsNumber(); ig_bd++) {</div>
<div class="line"><span class="lineno"> 1048</span>              </div>
<div class="line"><span class="lineno"> 1049</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1050</span>                      ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[felt_bd][SolFEType[kdim + ctrl_pos_begin]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a41bf5e7188a121649319194e846e533f">JacobianSur</a>(coords_hat_bd,ig_bd,weight_hat_bd_qp,phi_hat_bd_dof_qp[kdim + ctrl_pos_begin],phi_hat_bd_x_dof_qp[kdim + ctrl_pos_begin],normal);</div>
<div class="line"><span class="lineno"> 1051</span>                        }</div>
<div class="line"><span class="lineno"> 1052</span>              </div>
<div class="line"><span class="lineno"> 1053</span>              </div>
<div class="line"><span class="lineno"> 1054</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1055</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctrl_index = kdim + ctrl_pos_begin;</div>
<div class="line"><span class="lineno"> 1056</span>                                                                                  SolVAR_bd_qp[ SolPdeIndex[ctrl_index] ] = 0.;</div>
<div class="line"><span class="lineno"> 1057</span>                                          </div>
<div class="line"><span class="lineno"> 1058</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i_bd = 0; i_bd &lt; nve_bd; i_bd++) {</div>
<div class="line"><span class="lineno"> 1059</span>                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">GetLocalFaceVertexIndex</a>(iel, jface, i_bd);</div>
<div class="line"><span class="lineno"> 1060</span>                                SolVAR_bd_qp[SolPdeIndex[ctrl_index]] += phi_hat_bd_dof_qp  [ ctrl_index ][i_bd]  * SolVAR_eldofs[ SolPdeIndex[ ctrl_index ] ][i_vol];</div>
<div class="line"><span class="lineno"> 1061</span>                                          }                                         </div>
<div class="line"><span class="lineno"> 1062</span>                        }</div>
<div class="line"><span class="lineno"> 1063</span>              </div>
<div class="line"><span class="lineno"> 1064</span>              </div>
<div class="line"><span class="lineno"> 1065</span>  <span class="comment">//============ Res _ Boundary Integral Constraint ============================================================================================</span></div>
<div class="line"><span class="lineno"> 1066</span>              <span class="comment">//residual  -  delta_theta  * g dot n =========================================</span></div>
<div class="line"><span class="lineno"> 1067</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1068</span><span class="comment">//              for(unsigned i=0; i &lt; Sol_n_el_dofs[theta_index]; i ++) { //avoid because it is an element dof</span></div>
<div class="line"><span class="lineno"> 1069</span><span class="comment">/*delta_theta row */</span>     <span class="comment">/*Res_bd[ assemble_jacobian&lt;double,double&gt;::res_row_index(Sol_n_el_dofs, SolPdeIndex[theta_index], i) ] */</span>Res_outer[0] += - <span class="comment">/*fake_theta_flag[i] **/</span> weight_hat_bd_qp * SolVAR_bd_qp[SolPdeIndex[kdim + ctrl_pos_begin]] * normal[kdim] ;</div>
<div class="line"><span class="lineno"> 1070</span><span class="comment">//              }  </span></div>
<div class="line"><span class="lineno"> 1071</span>          }</div>
<div class="line"><span class="lineno"> 1072</span>              <span class="comment">//residual  -  delta_theta * g dot n =========================================</span></div>
<div class="line"><span class="lineno"> 1073</span>              </div>
<div class="line"><span class="lineno"> 1074</span>                        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i_bdry=0; i_bdry &lt; nve_bd; i_bdry++) {</div>
<div class="line"><span class="lineno"> 1075</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">GetLocalFaceVertexIndex</a>(iel, jface, i_bdry);</div>
<div class="line"><span class="lineno"> 1076</span>          </div>
<div class="line"><span class="lineno"> 1077</span>              <span class="comment">//residual  -  theta * delta_g dot n =========================================</span></div>
<div class="line"><span class="lineno"> 1078</span>                              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1079</span>                        </div>
<div class="line"><span class="lineno"> 1080</span>                        </div>
<div class="line"><span class="lineno"> 1081</span><span class="comment">/*delta_control row */</span>     <span class="keywordflow">if</span>( i_vol &lt; Sol_n_el_dofs[ctrl_pos_begin] )  Res_g[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs, SolPdeIndex[kdim + ctrl_pos_begin], i_vol) ]  += -</div>
<div class="line"><span class="lineno"> 1082</span>                                                                                       control_node_flag[kdim][i_vol] * weight_hat_bd_qp * (</div>
<div class="line"><span class="lineno"> 1083</span>                                                                                         SolVAR_eldofs[SolPdeIndex[theta_index]][0] <span class="comment">/*(*sol-&gt;_Sol[SolIndex[theta_index]])(0)*/</span> * phi_hat_bd_dof_qp[kdim +  ctrl_pos_begin][i_bdry] * normal[kdim]  </div>
<div class="line"><span class="lineno"> 1084</span>                                                                                        <span class="comment">//*sol-&gt;_Sol[SolIndex[theta_index]])(0) finds the global value from KKDof pos(63, 169,etc), SolVAReldof_theta gets the value in the boundary point which will be zero. Theta is just a const</span></div>
<div class="line"><span class="lineno"> 1085</span>                                                                                        );          </div>
<div class="line"><span class="lineno"> 1086</span>                                        }<span class="comment">//kdim  </span></div>
<div class="line"><span class="lineno"> 1087</span>              <span class="comment">//residual  -  theta * delta_g dot n =========================================</span></div>
<div class="line"><span class="lineno"> 1088</span>              <span class="comment">//residual - end =========================================</span></div>
<div class="line"><span class="lineno"> 1089</span><span class="comment">//============ End of Res _ Boundary Integral Constraint ============================================================================================</span></div>
<div class="line"><span class="lineno"> 1090</span>              </div>
<div class="line"><span class="lineno"> 1091</span>              <span class="comment">//jacobian =========================================</span></div>
<div class="line"><span class="lineno"> 1092</span>              </div>
<div class="line"><span class="lineno"> 1093</span>  <span class="comment">//============ Jac _ Boundary Integral Constraint ============================================================================================</span></div>
<div class="line"><span class="lineno"> 1094</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) { </div>
<div class="line"><span class="lineno"> 1095</span>                          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i =0; i &lt; Sol_n_el_dofs[theta_index]; i ++) {</div>
<div class="line"><span class="lineno"> 1096</span>                            <span class="keywordflow">if</span>(i_vol &lt; Sol_n_el_dofs[ctrl_pos_begin]) {</div>
<div class="line"><span class="lineno"> 1097</span>                                <span class="keywordtype">double</span> temp = weight_hat_bd_qp * ( phi_hat_bd_dof_qp[kdim + ctrl_pos_begin][i_bdry] * normal[kdim]);</div>
<div class="line"><span class="lineno"> 1098</span><span class="comment">//ROW_BLOCK delta_theta - control -- loop over i in the VOLUME (while j(/i_vol) is in the boundary) -------------------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno"> 1099</span>                              Jac_g[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, sum_Sol_n_el_dofs, theta_index , ctrl_pos_begin + kdim, i, i_vol) ]  +=  temp;</div>
<div class="line"><span class="lineno"> 1100</span><span class="comment">//COLUMN_BLOCK delta_control - theta ---- loop over j in the VOLUME (while i(/i_vol) is in the boundary) ---------------------------------------------------------------------------------------------------</span></div>
<div class="line"><span class="lineno"> 1101</span>                              Jac_g[ <a class="code hl_function" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs, sum_Sol_n_el_dofs, ctrl_pos_begin + kdim, theta_index , i_vol, i) ] +=  control_node_flag[kdim][i_vol] * temp;</div>
<div class="line"><span class="lineno"> 1102</span>                            }<span class="comment">//endif</span></div>
<div class="line"><span class="lineno"> 1103</span>                          }<span class="comment">// i </span></div>
<div class="line"><span class="lineno"> 1104</span>                    }<span class="comment">//kdim</span></div>
<div class="line"><span class="lineno"> 1105</span><span class="comment">//============ End of Jac _ Boundary Integral Constraint ============================================================================================</span></div>
<div class="line"><span class="lineno"> 1106</span>            </div>
<div class="line"><span class="lineno"> 1107</span>              </div>
<div class="line"><span class="lineno"> 1108</span>              </div>
<div class="line"><span class="lineno"> 1109</span>              <span class="comment">//jacobian - end =========================================</span></div>
<div class="line"><span class="lineno"> 1110</span>              </div>
<div class="line"><span class="lineno"> 1111</span>                    } <span class="comment">//i_bdry</span></div>
<div class="line"><span class="lineno"> 1112</span>                    </div>
<div class="line"><span class="lineno"> 1113</span>          }  <span class="comment">//end gauss boundary loop</span></div>
<div class="line"><span class="lineno"> 1114</span> </div>
<div class="line"><span class="lineno"> 1115</span>              </div>
<div class="line"><span class="lineno"> 1116</span>     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++){</div>
<div class="line"><span class="lineno"> 1117</span>          std::vector &lt; double &gt; Jac_dtheta_g(Jac_g.begin() + ind_dtheta[kdim], Jac_g.begin() + ind_dtheta[kdim + 1]);</div>
<div class="line"><span class="lineno"> 1118</span>          std::vector &lt; real_num &gt;  Res_dctrl_dot_n_theta(Res_g.begin() + ind_res_dctrl_dtheta[kdim], Res_g.begin() + ind_res_dctrl_dtheta[kdim + 1]);</div>
<div class="line"><span class="lineno"> 1119</span>          Jac_outer[kdim] = Jac_dtheta_g;</div>
<div class="line"><span class="lineno"> 1120</span>          Res_dctrl_dot_n[kdim] = Res_dctrl_dot_n_theta;</div>
<div class="line"><span class="lineno"> 1121</span>     }</div>
<div class="line"><span class="lineno"> 1122</span>             </div>
<div class="line"><span class="lineno"> 1123</span>                        }</div>
<div class="line"><span class="lineno"> 1124</span>                    }</div>
<div class="line"><span class="lineno"> 1125</span>                }      </div>
<div class="line"><span class="lineno"> 1126</span>            }</div>
<div class="line"><span class="lineno"> 1127</span>     </div>
<div class="line"><span class="lineno"> 1128</span> </div>
<div class="line"><span class="lineno"> 1129</span>     std::vector &lt; double &gt; Res_outer_double(1,0.);</div>
<div class="line"><span class="lineno"> 1130</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; Res_outer_double.size(); i++){   Res_outer_double[i] = Res_outer[i].value();   }</div>
<div class="line"><span class="lineno"> 1131</span> </div>
<div class="line"><span class="lineno"> 1132</span>     std::vector &lt; std::vector &lt; double &gt; &gt; Res_dctrl_dot_n_double(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1133</span>     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim =0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) Res_dctrl_dot_n_double[kdim].resize(Sol_n_el_dofs[ctrl_pos_begin + kdim]);</div>
<div class="line"><span class="lineno"> 1134</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim =0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1135</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i &lt; Res_dctrl_dot_n_double[kdim].size(); i++){</div>
<div class="line"><span class="lineno"> 1136</span>            Res_dctrl_dot_n_double[kdim][i] = Res_dctrl_dot_n[kdim][i].value();</div>
<div class="line"><span class="lineno"> 1137</span>        }</div>
<div class="line"><span class="lineno"> 1138</span>     }</div>
<div class="line"><span class="lineno"> 1139</span> </div>
<div class="line"><span class="lineno"> 1140</span>   <span class="comment">//--------------------------------------------------------------------------------------------------------  </span></div>
<div class="line"><span class="lineno"> 1141</span>    <span class="comment">// THE BLOCKS WITH THETA ROW OR COLUMN </span></div>
<div class="line"><span class="lineno"> 1142</span><span class="comment">//      /*delta_theta-theta*/    JAC-&gt;add_matrix_blocked( Jac[ SolPdeIndex[n_unknowns-1] ][ SolPdeIndex[n_unknowns-1] ], L2G_dofmap[n_unknowns-1], L2G_dofmap[n_unknowns-1]);</span></div>
<div class="line"><span class="lineno"> 1143</span>            </div>
<div class="line"><span class="lineno"> 1144</span>     <span class="keywordflow">if</span> (control_el_flag == 1) {</div>
<div class="line"><span class="lineno"> 1145</span>              <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1146</span>                          <span class="comment">/*delta_control*/</span>       RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_dctrl_dot_n_double[kdim],L2G_dofmap[n_unknowns-2-kdim]); </div>
<div class="line"><span class="lineno"> 1147</span>                <span class="keywordflow">if</span>(assembleMatrix) {</div>
<div class="line"><span class="lineno"> 1148</span>                          <span class="comment">/*delta_theta-control*/</span> JAC-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">add_matrix_blocked</a>( Jac_outer[kdim], bdry_int_constr_pos_vec, L2G_dofmap[n_unknowns-2-kdim]);</div>
<div class="line"><span class="lineno"> 1149</span>                          <span class="comment">/*delta_control-theta*/</span> JAC-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">add_matrix_blocked</a>( Jac_outer[kdim], L2G_dofmap[n_unknowns-2-kdim], bdry_int_constr_pos_vec); </div>
<div class="line"><span class="lineno"> 1150</span>                }</div>
<div class="line"><span class="lineno"> 1151</span>              }  <span class="comment">//kdim</span></div>
<div class="line"><span class="lineno"> 1152</span>     }  <span class="comment">//add control boundary element contributions</span></div>
<div class="line"><span class="lineno"> 1153</span>     </div>
<div class="line"><span class="lineno"> 1154</span>     </div>
<div class="line"><span class="lineno"> 1155</span>          <span class="keywordflow">if</span> (control_el_flag == 1) {</div>
<div class="line"><span class="lineno"> 1156</span>          <span class="comment">/*delta_theta(bdry constr)*/</span>         RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">add_vector_blocked</a>(Res_outer_double,bdry_int_constr_pos_vec);</div>
<div class="line"><span class="lineno"> 1157</span>          }</div>
<div class="line"><span class="lineno"> 1158</span>          </div>
<div class="line"><span class="lineno"> 1159</span><span class="comment">//      /* if (L2G_dofmap[n_unknowns-1][0] != bdry_int_constr_pos_vec[0]) */ /*delta_theta(fake)*/          RES-&gt;add_vector_blocked( Res[ SolPdeIndex[n_unknowns-1]],       L2G_dofmap[n_unknowns-1]);</span></div>
<div class="line"><span class="lineno"> 1160</span>          </div>
<div class="line"><span class="lineno"> 1161</span>   <span class="comment">//--------------------------------------------------------------------------------------------------------  </span></div>
<div class="line"><span class="lineno"> 1162</span> </div>
<div class="line"><span class="lineno"> 1163</span>       </div>
<div class="line"><span class="lineno"> 1164</span><span class="comment">//     assemble_jacobian&lt;real_num,real_num_mov&gt;::print_element_residual(iel, Res, Sol_n_el_dofs, 9, 3);</span></div>
<div class="line"><span class="lineno"> 1165</span><span class="comment">//     assemble_jacobian&lt;real_num,real_num_mov&gt;::print_element_jacobian(iel, Jac, Sol_n_el_dofs, 4, 1);</span></div>
<div class="line"><span class="lineno"> 1166</span>    </div>
<div class="line"><span class="lineno"> 1167</span>  } <span class="comment">//end element loop for each process</span></div>
<div class="line"><span class="lineno"> 1168</span> </div>
<div class="line"><span class="lineno"> 1169</span> </div>
<div class="line"><span class="lineno"> 1170</span> <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;<a class="code hl_function" href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">close</a>();</div>
<div class="line"><span class="lineno"> 1171</span>                     RES-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">close</a>();</div>
<div class="line"><span class="lineno"> 1172</span>  </div>
<div class="line"><span class="lineno"> 1173</span>  </div>
<div class="line"><span class="lineno"> 1174</span>  </div>
<div class="line"><span class="lineno"> 1175</span>    <span class="comment">//print JAC and RES to files</span></div>
<div class="line"><span class="lineno"> 1176</span><span class="comment">//     const unsigned nonlin_iter = mlPdeSys-&gt;GetNonlinearIt();</span></div>
<div class="line"><span class="lineno"> 1177</span><span class="comment">//     assemble_jacobian&lt; real_num_mov,double &gt;::print_global_jacobian(assembleMatrix, ml_prob, JAC, nonlin_iter);</span></div>
<div class="line"><span class="lineno"> 1178</span><span class="comment">//     assemble_jacobian&lt; real_num_mov,double &gt;::print_global_residual(ml_prob, RES, nonlin_iter);</span></div>
<div class="line"><span class="lineno"> 1179</span> </div>
<div class="line"><span class="lineno"> 1180</span>  </div>
<div class="line"><span class="lineno"> 1181</span>}</div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_a480ad40eedfb9ced9d7b090e19b3b85a"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a480ad40eedfb9ced9d7b090e19b3b85a">penalty_outside_control_boundary</a></div><div class="ttdeci">double penalty_outside_control_boundary</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00032">01_solid_control_boundary.cpp:32</a></div></div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_a668a0b03c0385e061dad5178865e3b99"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a668a0b03c0385e061dad5178865e3b99">AXIS_DIRECTION_CONTROL_SIDE</a></div><div class="ttdeci">#define AXIS_DIRECTION_CONTROL_SIDE</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00022">01_solid_control_boundary.cpp:22</a></div></div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_a8267a4060045c8116d32a821091e43cd"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a></div><div class="ttdeci">#define CTRL_FACE_IDX</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00027">01_solid_control_boundary.cpp:27</a></div></div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_a92a609d215ec3c30302b119aa0df10f0"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a92a609d215ec3c30302b119aa0df10f0">penalty_ctrl</a></div><div class="ttdeci">double penalty_ctrl</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00033">01_solid_control_boundary.cpp:33</a></div></div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_a949680fe5298ccbe0a9d804df0b792ee"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a949680fe5298ccbe0a9d804df0b792ee">theta_value_outside_fake_element</a></div><div class="ttdeci">double theta_value_outside_fake_element</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00034">01_solid_control_boundary.cpp:34</a></div></div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_abdd1e0dbfc8ed6ec0a237d9654d0bce9"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#abdd1e0dbfc8ed6ec0a237d9654d0bce9">set_phi_gradient_surface</a></div><div class="ttdeci">void set_phi_gradient_surface(const unsigned int axis_direction_control_side, const Mesh *msh, const unsigned int ig_bd, const std::vector&lt; unsigned int &gt; SolFEType, const unsigned int felt_bd, const unsigned int nve_bd, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_hat_bd, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;phi_hat_bd_x_dof_qp, const unsigned int dim, const unsigned int ctrl_pos_begin)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00214">01_solid_control_boundary.cpp:214</a></div></div>
<div class="ttc" id="a_f_elem_type_enum__list_8hpp_html_aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957"><div class="ttname"><a href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a></div><div class="ttdeci">@ CONTINUOUS_BIQUADRATIC</div><div class="ttdef"><b>Definition</b> <a href="../../d8/d70/_f_elem_type_enum__list_8hpp_source.html#l00029">FElemTypeEnum_list.hpp:29</a></div></div>
<div class="ttc" id="a_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp_html_a9424343761f8c4f4c1afe8f5b6bf471b"><div class="ttname"><a href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a></div><div class="ttdeci">double beta</div><div class="ttdef"><b>Definition</b> <a href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp_source.html#l00011">FSITimeDependentAssemblySupgNonConservativeTwoPressuresNewmark.hpp:11</a></div></div>
<div class="ttc" id="a_m_g_a_m_r_2ex6_2_m_g__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="a_navier_stokes___a_m_r_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dc8/_navier_stokes___a_m_r_8cpp_source.html#l00034">NavierStokes_AMR.cpp:34</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html_ab48c1191eb7ebb370a323d3ec4f713c9"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html#ab48c1191eb7ebb370a323d3ec4f713c9">femus::FemusInit::_adeptStack</a></div><div class="ttdeci">static adept::Stack _adeptStack</div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00064">FemusInit.hpp:64</a></div></div>
<div class="ttc" id="aclassfemus_1_1_gauss_html_ab1eb96997b69ce4ebec7283eb3bf1c01"><div class="ttname"><a href="../../db/db8/classfemus_1_1_gauss.html#ab1eb96997b69ce4ebec7283eb3bf1c01">femus::Gauss::GetGaussPointsNumber</a></div><div class="ttdeci">const unsigned GetGaussPointsNumber() const</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d65/quadrature__interface_8hpp_source.html#l00051">quadrature_interface.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_a4e339f53ed51e108cd33e1577dae9c18"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#a4e339f53ed51e108cd33e1577dae9c18">femus::LinearEquation::GetSystemDof</a></div><div class="ttdeci">unsigned GetSystemDof(const unsigned &amp;index_sol, const unsigned &amp;kkindex_sol, const unsigned &amp;i, const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d77/_linear_equation_8cpp_source.html#l00076">LinearEquation.cpp:76</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_aa10eb0eb318cf0d449f5ecdcec2823bc"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#aa10eb0eb318cf0d449f5ecdcec2823bc">femus::LinearEquation::_KK</a></div><div class="ttdeci">SparseMatrix * _KK</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00149">LinearEquation.hpp:149</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ae3ec0b2dd39e7527448bc35f108f6093"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ae3ec0b2dd39e7527448bc35f108f6093">femus::LinearEquation::KKoffset</a></div><div class="ttdeci">std::vector&lt; std::vector&lt; unsigned &gt; &gt; KKoffset</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00122">LinearEquation.hpp:122</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_html_ae819a67a7c62b49373dd257e11466e5e"><div class="ttname"><a href="../../da/de0/classfemus_1_1_linear_equation.html#ae819a67a7c62b49373dd257e11466e5e">femus::LinearEquation::_RES</a></div><div class="ttdeci">NumericVector * _RES</div><div class="ttdef"><b>Definition</b> <a href="../../da/d41/_linear_equation_8hpp_source.html#l00200">LinearEquation.hpp:200</a></div></div>
<div class="ttc" id="aclassfemus_1_1_linear_equation_solver_html"><div class="ttname"><a href="../../da/d1a/classfemus_1_1_linear_equation_solver.html">femus::LinearEquationSolver</a></div><div class="ttdef"><b>Definition</b> <a href="../../d2/de5/_linear_equation_solver_8hpp_source.html#l00054">LinearEquationSolver.hpp:54</a></div></div>
<div class="ttc" id="aclassfemus_1_1_material_html_a393992ac63eb6eaae7d5cbad9c6ac4ec"><div class="ttname"><a href="../../d0/d38/classfemus_1_1_material.html#a393992ac63eb6eaae7d5cbad9c6ac4ec">femus::Material::_parameter</a></div><div class="ttdeci">Parameter * _parameter</div><div class="ttdef"><b>Definition</b> <a href="../../d4/da9/_material_8hpp_source.html#l00052">Material.hpp:52</a></div></div>
<div class="ttc" id="aclassfemus_1_1_material_html_aa1968d4c8018a8fca33acb32a5be3dbc"><div class="ttname"><a href="../../d0/d38/classfemus_1_1_material.html#aa1968d4c8018a8fca33acb32a5be3dbc">femus::Material::get_density</a></div><div class="ttdeci">const double get_density() const</div><div class="ttdef"><b>Definition</b> <a href="../../d7/db5/_material_8cpp_source.html#l00058">Material.cpp:58</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html">femus::Mesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00057">Mesh.hpp:57</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a24f5ab73a260d61b0ea9ff28f03bc815"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a24f5ab73a260d61b0ea9ff28f03bc815">femus::Mesh::GetLevel</a></div><div class="ttdeci">unsigned GetLevel() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00380">Mesh.hpp:380</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a3c2977b3363513c86c5cdb0e645a78bd"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a3c2977b3363513c86c5cdb0e645a78bd">femus::Mesh::GetElementFaceNumber</a></div><div class="ttdeci">unsigned GetElementFaceNumber(const unsigned &amp;iel, const unsigned &amp;type=GeomElemBase::_index_for_all_faces) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01430">Mesh.cpp:1430</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a57f92951660269429cc7f04ee3c26c17"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a57f92951660269429cc7f04ee3c26c17">femus::Mesh::GetElementFaceType</a></div><div class="ttdeci">const unsigned GetElementFaceType(const unsigned &amp;kel, const unsigned &amp;jface) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01405">Mesh.cpp:1405</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a62689335aebc9de69b7490bfb32f0978"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">femus::Mesh::el</a></div><div class="ttdeci">elem * el</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00196">Mesh.hpp:196</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a679fa1625833f437ea38d2cc651c7462"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">femus::Mesh::GetElementDofNumber</a></div><div class="ttdeci">unsigned GetElementDofNumber(const unsigned &amp;iel, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01400">Mesh.cpp:1400</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_a6f753fa456d2313d902bf184c4bb9e3b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">femus::Mesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00143">Mesh.hpp:143</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ab5bcfd4be738d47ae025a06eddc66f61"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ab5bcfd4be738d47ae025a06eddc66f61">femus::Mesh::GetNumberOfElements</a></div><div class="ttdeci">unsigned GetNumberOfElements() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00210">Mesh.hpp:210</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ac436cfb1f4caaec0c4335358ff8a51d8"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">femus::Mesh::_topology</a></div><div class="ttdeci">Solution * _topology</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00639">Mesh.hpp:639</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_aca17a5dc69b8cfb941b8bbe7ae4a615e"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">femus::Mesh::_elementOffset</a></div><div class="ttdeci">std::vector&lt; unsigned &gt; _elementOffset</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00235">Mesh.hpp:235</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ace44edec2dc2ffb42c0456f03fa227ff"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">femus::Mesh::GetSolutionDof</a></div><div class="ttdeci">unsigned GetSolutionDof(const unsigned &amp;i, const unsigned &amp;iel, const short unsigned &amp;solType) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01008">Mesh.cpp:1008</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_ad18fca5dab8c3567b644996e682043d3"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">femus::Mesh::GetLocalFaceVertexIndex</a></div><div class="ttdeci">unsigned GetLocalFaceVertexIndex(const unsigned &amp;iel, const unsigned &amp;iface, const unsigned &amp;jnode) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01413">Mesh.cpp:1413</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af372596998e5d55a1fa15d6c5f58f52b"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af372596998e5d55a1fa15d6c5f58f52b">femus::Mesh::GetElementFaceDofNumber</a></div><div class="ttdeci">unsigned GetElementFaceDofNumber(const unsigned &amp;iel, const unsigned jface, const unsigned &amp;type) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01424">Mesh.cpp:1424</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af6a027b7ae5fe8a2b87be6ed15891f64"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">femus::Mesh::_finiteElement</a></div><div class="ttdeci">const elem_type * _finiteElement[N_GEOM_ELS][NFE_FAMS]</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d4a/_mesh_8hpp_source.html#l00420">Mesh.hpp:420</a></div></div>
<div class="ttc" id="aclassfemus_1_1_mesh_html_af92bd9944b1d887562b460ede06acf44"><div class="ttname"><a href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">femus::Mesh::GetElementType</a></div><div class="ttdeci">short unsigned GetElementType(const unsigned &amp;iel) const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d06/_mesh_8cpp_source.html#l01390">Mesh.cpp:1390</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_ad59554c65099f852ba8797f09bc40227"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">femus::MultiLevelMesh::_finiteElement</a></div><div class="ttdeci">elem_type * _finiteElement[N_GEOM_ELS][NFE_FAMS]</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00263">MultiLevelMesh.hpp:263</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_af0dec057961b41903215bb9927cbfeed"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">femus::MultiLevelMesh::GetLevel</a></div><div class="ttdeci">Mesh * GetLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00181">MultiLevelMesh.hpp:181</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a34890e6aa9d88946571fa050ee544c39"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">femus::MultiLevelProblem::GetQuadratureRule</a></div><div class="ttdeci">const Gauss &amp; GetQuadratureRule(const unsigned geom_elem_type) const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00133">MultiLevelProblem.hpp:133</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a6dd8fec26a0ffbaae07e6df7ea42d12b"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">femus::MultiLevelProblem::_ml_sol</a></div><div class="ttdeci">MultiLevelSolution * _ml_sol</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00266">MultiLevelProblem.hpp:266</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a946d39c3fba7fac859822702248fe065"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">femus::MultiLevelProblem::_ml_msh</a></div><div class="ttdeci">MultiLevelMesh * _ml_msh</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00232">MultiLevelProblem.hpp:232</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html">femus::MultiLevelSolution</a></div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00044">MultiLevelSolution.hpp:44</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a0c3d81a9146a8e96552da43955f0c7ae"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">femus::MultiLevelSolution::GetIndex</a></div><div class="ttdeci">unsigned GetIndex(const char name[]) const</div><div class="ttdef"><b>Definition</b> <a href="../../d2/db0/_multi_level_solution_8cpp_source.html#l00505">MultiLevelSolution.cpp:505</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a14df65f22920d95a341bc656b7878dc6"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a14df65f22920d95a341bc656b7878dc6">femus::MultiLevelSolution::GetSolutionType</a></div><div class="ttdeci">const int GetSolutionType(unsigned i) const</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00226">MultiLevelSolution.hpp:226</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_solution_html_a9bb3681ff25b06b030d75b1ab1bdfdc3"><div class="ttname"><a href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">femus::MultiLevelSolution::GetSolutionLevel</a></div><div class="ttdeci">Solution * GetSolutionLevel(const unsigned i)</div><div class="ttdef"><b>Definition</b> <a href="../../da/dce/_multi_level_solution_8hpp_source.html#l00180">MultiLevelSolution.hpp:180</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html">femus::NumericVector</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00051">NumericVector.hpp:51</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a0440021963af01ac49a6f02df562e44b"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">femus::NumericVector::add_vector_blocked</a></div><div class="ttdeci">virtual void add_vector_blocked(const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)=0</div><div class="ttdoc">where v is a std::vector !!!fast</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80b1efdc7101659f2035c2da880360e7"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector::zero</a></div><div class="ttdeci">virtual void zero()=0</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a80eb1dc1f53018fd7d08bcc4a511cc09"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector::close</a></div><div class="ttdeci">virtual void close()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_parallel_object_html_a6438b3ffcc8cde2d6ccfb4ec563dfce1"><div class="ttname"><a href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">femus::ParallelObject::processor_id</a></div><div class="ttdeci">int processor_id() const</div><div class="ttdef"><b>Definition</b> <a href="../../da/d3d/_parallel_object_8hpp_source.html#l00053">ParallelObject.hpp:53</a></div></div>
<div class="ttc" id="aclassfemus_1_1_parameter_html_a010508c1540e2547bcbf77f2c1103695"><div class="ttname"><a href="../../d7/d3c/classfemus_1_1_parameter.html#a010508c1540e2547bcbf77f2c1103695">femus::Parameter::Get_reference_length</a></div><div class="ttdeci">double Get_reference_length()</div><div class="ttdef"><b>Definition</b> <a href="../../d2/d9d/_parameter_8cpp_source.html#l00032">Parameter.cpp:32</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_matrix_html"><div class="ttname"><a href="../../da/dcf/classfemus_1_1_petsc_matrix.html">femus::PetscMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="../../d3/d31/_petsc_matrix_8hpp_source.html#l00070">PetscMatrix.hpp:70</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a032c01f0f6e345f2818a7ffe24bad883"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html#a032c01f0f6e345f2818a7ffe24bad883">femus::Solid::get_if_penalty</a></div><div class="ttdeci">const bool get_if_penalty() const</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4c/_solid_8cpp_source.html#l00162">Solid.cpp:162</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a19ca2da625aede63d5277cb034584718"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html#a19ca2da625aede63d5277cb034584718">femus::Solid::get_physical_model</a></div><div class="ttdeci">const unsigned get_physical_model() const</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4c/_solid_8cpp_source.html#l00142">Solid.cpp:142</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a1a27599fb327424255b0823dcddd863a"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html#a1a27599fb327424255b0823dcddd863a">femus::Solid::get_young_module</a></div><div class="ttdeci">const double get_young_module() const</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4c/_solid_8cpp_source.html#l00146">Solid.cpp:146</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a25307ed3e65fea474b2d74b130348e4b"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html#a25307ed3e65fea474b2d74b130348e4b">femus::Solid::get_lame_lambda</a></div><div class="ttdeci">const double get_lame_lambda() const</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4c/_solid_8cpp_source.html#l00154">Solid.cpp:154</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a3d971cfb0d2a1810e6b31830f1f4b900"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html#a3d971cfb0d2a1810e6b31830f1f4b900">femus::Solid::get_poisson_coeff</a></div><div class="ttdeci">const double get_poisson_coeff() const</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4c/_solid_8cpp_source.html#l00150">Solid.cpp:150</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solid_html_a5f3228eab52c343a13167eaf73f568bc"><div class="ttname"><a href="../../d8/d1a/classfemus_1_1_solid.html#a5f3228eab52c343a13167eaf73f568bc">femus::Solid::get_lame_shear_modulus</a></div><div class="ttdeci">const double get_lame_shear_modulus() const</div><div class="ttdef"><b>Definition</b> <a href="../../d5/d4c/_solid_8cpp_source.html#l00158">Solid.cpp:158</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html">femus::Solution</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00048">Solution.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_solution_html_a5c725da69d0b94b7ff4a4e2509c86d53"><div class="ttname"><a href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">femus::Solution::_Sol</a></div><div class="ttdeci">std::vector&lt; NumericVector * &gt; _Sol</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d0d/_solution_8hpp_source.html#l00161">Solution.hpp:161</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html">femus::SparseMatrix</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d14/_sparse_matrix_8hpp_source.html#l00048">SparseMatrix.hpp:48</a></div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a45654dbe423d1970565b94c792ce6df3"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a45654dbe423d1970565b94c792ce6df3">femus::SparseMatrix::zero</a></div><div class="ttdeci">virtual void zero()=0</div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_a6eb9fbd88830b0d10c88f0ce066b07ae"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#a6eb9fbd88830b0d10c88f0ce066b07ae">femus::SparseMatrix::close</a></div><div class="ttdeci">virtual void close() const =0</div></div>
<div class="ttc" id="aclassfemus_1_1_sparse_matrix_html_aac0370cebbcc2d7111660dcf7115ebbf"><div class="ttname"><a href="../../d3/d61/classfemus_1_1_sparse_matrix.html#aac0370cebbcc2d7111660dcf7115ebbf">femus::SparseMatrix::add_matrix_blocked</a></div><div class="ttdeci">virtual void add_matrix_blocked(const std::vector&lt; double &gt; &amp;mat_value, const std::vector&lt; int &gt; &amp;rows, const std::vector&lt; int &gt; &amp;cols)=0</div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html">femus::assemble_jacobian</a></div><div class="ttdef"><b>Definition</b> <a href="../../d0/db7/_assemble__jacobian_8hpp_source.html#l00031">Assemble_jacobian.hpp:31</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a298fb51789fa086f4ac3904b43336f76"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">femus::assemble_jacobian::res_row_index</a></div><div class="ttdeci">static unsigned int res_row_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int my_row_pos, const int i)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/db7/_assemble__jacobian_8hpp_source.html#l00289">Assemble_jacobian.hpp:289</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_afafa42b312f4db1f55298eb039ada1c6"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">femus::assemble_jacobian::jac_row_col_index</a></div><div class="ttdeci">static unsigned int jac_row_col_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int nDof_AllVars, const int my_row_pos, const int my_col_pos, const int i, const int j)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/db7/_assemble__jacobian_8hpp_source.html#l00301">Assemble_jacobian.hpp:301</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a41bf5e7188a121649319194e846e533f"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a41bf5e7188a121649319194e846e533f">femus::elem_type::JacobianSur</a></div><div class="ttdeci">virtual void JacobianSur(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;other_phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, std::vector&lt; adept::adouble &gt; &amp;normal) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a64c3ed0fd9cd8afcb765144362147a2e"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">femus::elem_type::Jacobian</a></div><div class="ttdeci">virtual void Jacobian(const std::vector&lt; std::vector&lt; adept::adouble &gt; &gt; &amp;vt, const unsigned &amp;ig, adept::adouble &amp;Weight, std::vector&lt; double &gt; &amp;phi, std::vector&lt; adept::adouble &gt; &amp;gradphi, boost::optional&lt; std::vector&lt; adept::adouble &gt; &amp; &gt; nablaphi=boost::none) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem__type_html_a6d73c16abce658954e974bf32a5846c7"><div class="ttname"><a href="../../d3/dca/classfemus_1_1elem__type.html#a6d73c16abce658954e974bf32a5846c7">femus::elem_type::fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem</a></div><div class="ttdeci">virtual void fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem(const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;vt, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;vt_bdry, const unsigned &amp;jface, const unsigned &amp;ig, std::vector&lt; double &gt; &amp;phi, std::vector&lt; double &gt; &amp;gradphi) const =0</div></div>
<div class="ttc" id="aclassfemus_1_1elem_html"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html">femus::elem</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/dd9/_elem_8hpp_source.html#l00041">Elem.hpp:41</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem_html_a491172d27d04d10ce166f42161d0c1d1"><div class="ttname"><a href="../../db/d2e/classfemus_1_1elem.html#a491172d27d04d10ce166f42161d0c1d1">femus::elem::GetFaceElementIndex</a></div><div class="ttdeci">int GetFaceElementIndex(const unsigned &amp;iel, const unsigned &amp;iface)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/d8f/_elem_8cpp_source.html#l00360">Elem.cpp:360</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a101671cfe5078b188740d5d892832ea9"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a></div><div class="ttdeci">double cost_functional_coeff</div><div class="ttdef"><b>Definition</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00025">solidopt_params.hpp:25</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a1dffa717bb8f2e25ad41baaf598c703f"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a1dffa717bb8f2e25ad41baaf598c703f">ControlDomainFlag</a></div><div class="ttdeci">int ControlDomainFlag(const std::vector&lt; double &gt; &amp;elem_center)</div><div class="ttdef"><b>Definition</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00080">solidopt_params.hpp:80</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a20f4c4490bc8ecbdd1ffcb79acce6035"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdef"><b>Definition</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00026">solidopt_params.hpp:26</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a491774c0485f249809d76f7933b79419"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a491774c0485f249809d76f7933b79419">_gravity</a></div><div class="ttdeci">double _gravity[3]</div><div class="ttdef"><b>Definition</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00020">solidopt_params.hpp:20</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a80e1487a07155d5b24edd6eca186b73b"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a80e1487a07155d5b24edd6eca186b73b">TargetDisp</a></div><div class="ttdeci">double TargetDisp[3]</div><div class="ttdef"><b>Definition</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00021">solidopt_params.hpp:21</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ad6b2e165d5cf19933c60a49927c5bf64" name="ad6b2e165d5cf19933c60a49927c5bf64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad6b2e165d5cf19933c60a49927c5bf64">&#9670;&#160;</a></span>ComputeIntegral() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void ComputeIntegral </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l01300">1300</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1300</span>                                                       {</div>
<div class="line"><span class="lineno"> 1301</span>    ComputeIntegral&lt; system_type, real_num, real_num_mov &gt; (  ml_prob, </div>
<div class="line"><span class="lineno"> 1302</span>                                                            &amp; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0), </div>
<div class="line"><span class="lineno"> 1303</span>                                                              ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a3d90edba93be2c202ea2bf8e87e20854">get_system</a>&lt; system_type &gt;(0).get_unknown_list_for_assembly());</div>
<div class="line"><span class="lineno"> 1304</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b4961693657f83b36edc7f4e2e17de6" name="a2b4961693657f83b36edc7f4e2e17de6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b4961693657f83b36edc7f4e2e17de6">&#9670;&#160;</a></span>ComputeIntegral() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<div class="memtemplate">
template&lt;class system_type , class real_num , class real_num_mov &gt; </div>
      <table class="memname">
        <tr>
          <td class="memname">void ComputeIntegral </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const system_type *&#160;</td>
          <td class="paramname"><em>mlPdeSys</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; &amp;&#160;</td>
          <td class="paramname"><em>unknowns</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l01307">1307</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno"> 1309</span>                                                            {</div>
<div class="line"><span class="lineno"> 1310</span> </div>
<div class="line"><span class="lineno"> 1311</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>                level           = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><span class="lineno"> 1312</span> </div>
<div class="line"><span class="lineno"> 1313</span>  <a class="code hl_class" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a>*                         msh             = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#af0dec057961b41903215bb9927cbfeed">GetLevel</a>(level);</div>
<div class="line"><span class="lineno"> 1314</span>  <a class="code hl_class" href="../../db/d2e/classfemus_1_1elem.html">elem</a>*                         el              = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>;</div>
<div class="line"><span class="lineno"> 1315</span> </div>
<div class="line"><span class="lineno"> 1316</span>  <a class="code hl_class" href="../../d6/da4/classfemus_1_1_multi_level_solution.html">MultiLevelSolution</a>*           ml_sol  = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>;</div>
<div class="line"><span class="lineno"> 1317</span>  <a class="code hl_class" href="../../d4/d40/classfemus_1_1_solution.html">Solution</a>*                     sol             = ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a6dd8fec26a0ffbaae07e6df7ea42d12b">_ml_sol</a>-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a9bb3681ff25b06b030d75b1ab1bdfdc3">GetSolutionLevel</a>(level); </div>
<div class="line"><span class="lineno"> 1318</span> </div>
<div class="line"><span class="lineno"> 1319</span> </div>
<div class="line"><span class="lineno"> 1320</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>        <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a6f753fa456d2313d902bf184c4bb9e3b">GetDimension</a>();</div>
<div class="line"><span class="lineno"> 1321</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>   dim2  = (3 * (<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1) + !(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> - 1));</div>
<div class="line"><span class="lineno"> 1322</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  iproc  = msh-&gt;<a class="code hl_function" href="../../dd/d90/classfemus_1_1_parallel_object.html#a6438b3ffcc8cde2d6ccfb4ec563dfce1">processor_id</a>();</div>
<div class="line"><span class="lineno"> 1323</span>  <span class="comment">// reserve memory for the local standard vectors</span></div>
<div class="line"><span class="lineno"> 1324</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size_elem_dofs = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));          <span class="comment">// conservative: based on line3, quad9, hex27 </span></div>
<div class="line"><span class="lineno"> 1325</span> </div>
<div class="line"><span class="lineno"> 1326</span>  </div>
<div class="line"><span class="lineno"> 1327</span>  <span class="comment">//----------- unknowns ------------------------------</span></div>
<div class="line"><span class="lineno"> 1328</span>   <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><span class="lineno"> 1329</span>   </div>
<div class="line"><span class="lineno"> 1330</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> sol_index_displ      = 0;     <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno"> 1331</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press      = sol_index_displ + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      <span class="comment">//known at run time</span></div>
<div class="line"><span class="lineno"> 1332</span>  <span class="keyword">constexpr</span> <span class="keywordtype">int</span> state_pos_begin      = sol_index_displ;   <span class="comment">//known at compile time</span></div>
<div class="line"><span class="lineno"> 1333</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> adj_pos_begin        = <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1;</div>
<div class="line"><span class="lineno"> 1334</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_adj        = adj_pos_begin;      </div>
<div class="line"><span class="lineno"> 1335</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_press_adj  = sol_index_adj + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;     </div>
<div class="line"><span class="lineno"> 1336</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> ctrl_pos_begin       = 2 * (<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + 1);</div>
<div class="line"><span class="lineno"> 1337</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> sol_index_ctrl       = ctrl_pos_begin;     </div>
<div class="line"><span class="lineno"> 1338</span>  <span class="keyword">const</span>     <span class="keywordtype">int</span> theta_index = sol_index_ctrl + <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>;      </div>
<div class="line"><span class="lineno"> 1339</span> </div>
<div class="line"><span class="lineno"> 1340</span>  </div>
<div class="line"><span class="lineno"> 1341</span>  std::vector &lt; std::string &gt; Solname(n_unknowns);     </div>
<div class="line"><span class="lineno"> 1342</span>  std::vector &lt; unsigned int &gt; SolIndex(n_unknowns);  </div>
<div class="line"><span class="lineno"> 1343</span>  std::vector &lt; unsigned int &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><span class="lineno"> 1344</span>  std::vector &lt; unsigned int &gt; SolFEType(n_unknowns);  </div>
<div class="line"><span class="lineno"> 1345</span> </div>
<div class="line"><span class="lineno"> 1346</span> </div>
<div class="line"><span class="lineno"> 1347</span>  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><span class="lineno"> 1348</span>       Solname[ivar]    = unknowns[ivar]._name; </div>
<div class="line"><span class="lineno"> 1349</span>      SolIndex[ivar]    = ml_sol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a0c3d81a9146a8e96552da43955f0c7ae">GetIndex</a>        (Solname[ivar].c_str());</div>
<div class="line"><span class="lineno"> 1350</span><span class="comment">//     SolPdeIndex[ivar]        = mlPdeSys-&gt;GetSolPdeIndex(Solname[ivar].c_str());</span></div>
<div class="line"><span class="lineno"> 1351</span><span class="comment">//       assert(ivar == SolPdeIndex[ivar]);  //I would like this ivar order to coincide either with SolIndex or with SolPdeIndex, otherwise too many orders... it has to be  with SolPdeIndex, because SolIndex is related to the Solution object which can have more fields... This has to match the order of the unknowns[] argument</span></div>
<div class="line"><span class="lineno"> 1352</span>    SolFEType[ivar]     = ml_sol-&gt;<a class="code hl_function" href="../../d6/da4/classfemus_1_1_multi_level_solution.html#a14df65f22920d95a341bc656b7878dc6">GetSolutionType</a>(SolIndex[ivar]);<span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1353</span>  }</div>
<div class="line"><span class="lineno"> 1354</span> </div>
<div class="line"><span class="lineno"> 1355</span>   <span class="keyword">constexpr</span> <span class="keywordtype">int</span> solFEType_max = <a class="code hl_enumvalue" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a>;  <span class="comment">//biquadratic, this is the highest-order FE </span></div>
<div class="line"><span class="lineno"> 1356</span> </div>
<div class="line"><span class="lineno"> 1357</span>   std::vector &lt; unsigned int &gt; Sol_n_el_dofs(n_unknowns);</div>
<div class="line"><span class="lineno"> 1358</span>  </div>
<div class="line"><span class="lineno"> 1359</span>  <span class="comment">//----------- of dofs and at quadrature points ------------------------------</span></div>
<div class="line"><span class="lineno"> 1360</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1361</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp(n_unknowns);   <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here  //some of these should be real_num, some real_num_mov...</span></div>
<div class="line"><span class="lineno"> 1362</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp(n_unknowns);  <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here</span></div>
<div class="line"><span class="lineno"> 1363</span> </div>
<div class="line"><span class="lineno"> 1364</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1365</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_x_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1366</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_xx_hat_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1367</span> </div>
<div class="line"><span class="lineno"> 1368</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {  </div>
<div class="line"><span class="lineno"> 1369</span>        phi_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1370</span>    phi_hat_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1371</span>      phi_x_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1372</span>  phi_x_hat_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1373</span>     phi_xx_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1374</span> phi_xx_hat_dof_qp[unk].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1375</span>   }</div>
<div class="line"><span class="lineno"> 1376</span>   </div>
<div class="line"><span class="lineno"> 1377</span><span class="comment">//----------boundary shape functions----------------------  </span></div>
<div class="line"><span class="lineno"> 1378</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_bd_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1379</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_hat_bd_x_dof_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1380</span> </div>
<div class="line"><span class="lineno"> 1381</span> </div>
<div class="line"><span class="lineno"> 1382</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns ; unk++) {  </div>
<div class="line"><span class="lineno"> 1383</span>        phi_hat_bd_dof_qp[unk].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1384</span>      phi_hat_bd_x_dof_qp[unk].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1385</span>    }</div>
<div class="line"><span class="lineno"> 1386</span> </div>
<div class="line"><span class="lineno"> 1387</span>  <span class="comment">//----------- at dofs ------------------------------</span></div>
<div class="line"><span class="lineno"> 1388</span>  std::vector &lt; std::vector &lt; real_num &gt; &gt; SolVAR_eldofs(n_unknowns);  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { SolVAR_eldofs[k].reserve(max_size_elem_dofs); }</div>
<div class="line"><span class="lineno"> 1389</span> </div>
<div class="line"><span class="lineno"> 1390</span> </div>
<div class="line"><span class="lineno"> 1391</span>  <span class="comment">// geometry (at dofs) --------------------------------//</span></div>
<div class="line"><span class="lineno"> 1392</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt;   coords(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1393</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  coords_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1394</span>  std::vector &lt; std::vector &lt; double &gt; &gt;  coords_hat_bd(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1395</span>  <span class="keywordtype">unsigned</span> coordsType = <a class="code hl_enumvalue" href="../../d8/d70/_f_elem_type_enum__list_8hpp.html#aa3c13f1140f458a32182c3d9312b3550aa271c7c274db9d77da40d7a46d749957">CONTINUOUS_BIQUADRATIC</a>; <span class="comment">// get the finite element type for &quot;x&quot;, it is always 2 (LAGRANGE TENSOR-PRODUCT-QUADRATIC)</span></div>
<div class="line"><span class="lineno"> 1396</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++) {   </div>
<div class="line"><span class="lineno"> 1397</span>           coords[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno"> 1398</span>       coords_hat[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno"> 1399</span>    coords_hat_bd[i].reserve(max_size_elem_dofs); </div>
<div class="line"><span class="lineno"> 1400</span> }</div>
<div class="line"><span class="lineno"> 1401</span> </div>
<div class="line"><span class="lineno"> 1402</span> <span class="comment">//************** geometry phi **************************</span></div>
<div class="line"><span class="lineno"> 1403</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_dof_qp_domain(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1404</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_x_dof_qp_domain(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1405</span>  std::vector &lt; std::vector &lt; real_num_mov &gt; &gt; phi_xx_dof_qp_domain(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1406</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_dof_qp_domain_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1407</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_x_dof_qp_domain_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1408</span>  std::vector &lt; std::vector &lt; double &gt; &gt; phi_xx_dof_qp_domain_hat(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1409</span> </div>
<div class="line"><span class="lineno"> 1410</span>  <span class="keywordflow">for</span>(<span class="keywordtype">int</span> dom_coord = 0; dom_coord &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; dom_coord++) {</div>
<div class="line"><span class="lineno"> 1411</span>        phi_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1412</span>      phi_x_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1413</span>     phi_xx_dof_qp_domain[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1414</span>        phi_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1415</span>      phi_x_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1416</span>     phi_xx_dof_qp_domain_hat[dom_coord].reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1417</span>   }</div>
<div class="line"><span class="lineno"> 1418</span> </div>
<div class="line"><span class="lineno"> 1419</span>   <span class="comment">// geometry ------------------------------------------</span></div>
<div class="line"><span class="lineno"> 1420</span>  </div>
<div class="line"><span class="lineno"> 1421</span> </div>
<div class="line"><span class="lineno"> 1422</span>  <span class="comment">//------------ at quadrature points ---------------------</span></div>
<div class="line"><span class="lineno"> 1423</span>  real_num_mov weight_qp = 0.;<span class="comment">//</span></div>
<div class="line"><span class="lineno"> 1424</span>    <span class="keywordtype">double</span> weight_hat_qp = 0.;</div>
<div class="line"><span class="lineno"> 1425</span>    <span class="keywordtype">double</span> weight_hat_bd_qp = 0.;</div>
<div class="line"><span class="lineno"> 1426</span>    std::vector &lt; real_num &gt; SolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1427</span>    std::vector &lt; real_num &gt; SolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1428</span>    std::vector &lt; std::vector &lt; real_num &gt; &gt; gradSolVAR_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1429</span>    std::vector &lt; std::vector &lt; real_num &gt; &gt; gradSolVAR_hat_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1430</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) { </div>
<div class="line"><span class="lineno"> 1431</span>          gradSolVAR_qp[k].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1432</span>      gradSolVAR_hat_qp[k].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1433</span>    }</div>
<div class="line"><span class="lineno"> 1434</span>      </div>
<div class="line"><span class="lineno"> 1435</span> </div>
<div class="line"><span class="lineno"> 1436</span> </div>
<div class="line"><span class="lineno"> 1437</span><span class="comment">// Displ_desired##################################################################</span></div>
<div class="line"><span class="lineno"> 1438</span>  std::vector &lt; double &gt; phi_des_dof_qp;</div>
<div class="line"><span class="lineno"> 1439</span>  std::vector &lt; real_num_mov &gt; phi_des_x_dof_qp;   <span class="comment">//the derivatives depend on the Jacobian, which depends on the unknown, so we have to be adept here  //some of these should be real_num, some real_num_mov...</span></div>
<div class="line"><span class="lineno"> 1440</span>  std::vector &lt; real_num_mov &gt; phi_des_xx_dof_qp;  </div>
<div class="line"><span class="lineno"> 1441</span> </div>
<div class="line"><span class="lineno"> 1442</span>  std::vector &lt; double &gt; phi_des_hat_dof_qp;</div>
<div class="line"><span class="lineno"> 1443</span>  std::vector &lt; double &gt; phi_des_x_hat_dof_qp;</div>
<div class="line"><span class="lineno"> 1444</span>  std::vector &lt; double &gt; phi_des_xx_hat_dof_qp;</div>
<div class="line"><span class="lineno"> 1445</span> </div>
<div class="line"><span class="lineno"> 1446</span>        phi_des_dof_qp.reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1447</span>      phi_des_x_dof_qp.reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1448</span>     phi_des_xx_dof_qp.reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1449</span>    phi_des_hat_dof_qp.reserve(max_size_elem_dofs);</div>
<div class="line"><span class="lineno"> 1450</span>  phi_des_x_hat_dof_qp.reserve(max_size_elem_dofs * <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1451</span> phi_des_xx_hat_dof_qp.reserve(max_size_elem_dofs * dim2);</div>
<div class="line"><span class="lineno"> 1452</span>   </div>
<div class="line"><span class="lineno"> 1453</span>   </div>
<div class="line"><span class="lineno"> 1454</span>  std::vector &lt; real_num &gt;  SolDisp_eldofs(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,0.);</div>
<div class="line"><span class="lineno"> 1455</span>  std::vector &lt; real_num &gt; SolDisp_des_qp(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);  </div>
<div class="line"><span class="lineno"> 1456</span>  </div>
<div class="line"><span class="lineno"> 1457</span>  std::vector &lt; real_num &gt; SolDisp_des_hat_qp(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);  </div>
<div class="line"><span class="lineno"> 1458</span><span class="comment">// Displ_desired##################################################################</span></div>
<div class="line"><span class="lineno"> 1459</span> </div>
<div class="line"><span class="lineno"> 1460</span> </div>
<div class="line"><span class="lineno"> 1461</span> </div>
<div class="line"><span class="lineno"> 1462</span> </div>
<div class="line"><span class="lineno"> 1463</span>real_num  integral_target_alpha = 0.;</div>
<div class="line"><span class="lineno"> 1464</span>real_num        integral_beta   = 0.;</div>
<div class="line"><span class="lineno"> 1465</span>real_num        integral_gamma  = 0.;</div>
<div class="line"><span class="lineno"> 1466</span>real_num   integral_g_dot_n = 0.;</div>
<div class="line"><span class="lineno"> 1467</span> </div>
<div class="line"><span class="lineno"> 1468</span>  <span class="comment">// element loop: each process loops only on the elements that owns</span></div>
<div class="line"><span class="lineno"> 1469</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc]; iel &lt; msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#aca17a5dc69b8cfb941b8bbe7ae4a615e">_elementOffset</a>[iproc + 1]; iel++) {</div>
<div class="line"><span class="lineno"> 1470</span> </div>
<div class="line"><span class="lineno"> 1471</span> </div>
<div class="line"><span class="lineno"> 1472</span>   <span class="comment">//all vars ###################################################################  </span></div>
<div class="line"><span class="lineno"> 1473</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><span class="lineno"> 1474</span>    <span class="keywordtype">unsigned</span> ndofs_unk = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, SolFEType[k]);</div>
<div class="line"><span class="lineno"> 1475</span>       Sol_n_el_dofs[k] = ndofs_unk;</div>
<div class="line"><span class="lineno"> 1476</span>       SolVAR_eldofs[k].resize(Sol_n_el_dofs[k]);</div>
<div class="line"><span class="lineno"> 1477</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; SolVAR_eldofs[k].size(); i++) {</div>
<div class="line"><span class="lineno"> 1478</span>       <span class="keywordtype">unsigned</span> solDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, SolFEType[k]);</div>
<div class="line"><span class="lineno"> 1479</span>       SolVAR_eldofs[k][i] = (*sol-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[SolIndex[k]])(solDof);</div>
<div class="line"><span class="lineno"> 1480</span>      }</div>
<div class="line"><span class="lineno"> 1481</span>    }</div>
<div class="line"><span class="lineno"> 1482</span>   <span class="comment">//all vars ###################################################################</span></div>
<div class="line"><span class="lineno"> 1483</span>  </div>
<div class="line"><span class="lineno"> 1484</span>    </div>
<div class="line"><span class="lineno"> 1485</span>  <span class="comment">// geometry *****************************</span></div>
<div class="line"><span class="lineno"> 1486</span>    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af92bd9944b1d887562b460ede06acf44">GetElementType</a>(iel);</div>
<div class="line"><span class="lineno"> 1487</span> </div>
<div class="line"><span class="lineno"> 1488</span>      <span class="keywordtype">unsigned</span> nDofsX = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a679fa1625833f437ea38d2cc651c7462">GetElementDofNumber</a>(iel, coordsType);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><span class="lineno"> 1489</span>    </div>
<div class="line"><span class="lineno"> 1490</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> ivar=0; ivar&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno"> 1491</span>      coords[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno"> 1492</span>      coords_hat[ivar].resize(nDofsX);</div>
<div class="line"><span class="lineno"> 1493</span>    }</div>
<div class="line"><span class="lineno"> 1494</span>    </div>
<div class="line"><span class="lineno"> 1495</span>   <span class="keywordflow">for</span>( <span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno"> 1496</span>      <span class="keywordtype">unsigned</span> coordsDof  = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i, iel, coordsType);    <span class="comment">// global to global mapping between coordinates node and coordinate dof // via local to global solution node</span></div>
<div class="line"><span class="lineno"> 1497</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar = 0; ivar &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar++) {</div>
<div class="line"><span class="lineno"> 1498</span>          <span class="comment">//Fixed coordinates (Reference frame)</span></div>
<div class="line"><span class="lineno"> 1499</span>        coords_hat[ivar][i] = (*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[ivar])(coordsDof);</div>
<div class="line"><span class="lineno"> 1500</span>      }</div>
<div class="line"><span class="lineno"> 1501</span>    }</div>
<div class="line"><span class="lineno"> 1502</span> </div>
<div class="line"><span class="lineno"> 1503</span>  <span class="comment">//***************************************  </span></div>
<div class="line"><span class="lineno"> 1504</span>    assert(nDofsX == Sol_n_el_dofs[sol_index_displ]);</div>
<div class="line"><span class="lineno"> 1505</span>    <span class="comment">//Moving coordinates (Moving frame)</span></div>
<div class="line"><span class="lineno"> 1506</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno"> 1507</span>        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDofsX; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><span class="lineno"> 1508</span>          coords[idim][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = coords_hat[idim][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] + SolVAR_eldofs[SolIndex[idim]][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>];</div>
<div class="line"><span class="lineno"> 1509</span>        }</div>
<div class="line"><span class="lineno"> 1510</span>      }</div>
<div class="line"><span class="lineno"> 1511</span>  </div>
<div class="line"><span class="lineno"> 1512</span>     <span class="comment">// elem average point </span></div>
<div class="line"><span class="lineno"> 1513</span>    std::vector &lt; double &gt; elem_center(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);   </div>
<div class="line"><span class="lineno"> 1514</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0.;  }</div>
<div class="line"><span class="lineno"> 1515</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {  </div>
<div class="line"><span class="lineno"> 1516</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofsX; i++) {</div>
<div class="line"><span class="lineno"> 1517</span>         elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += coords_hat[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i];</div>
<div class="line"><span class="lineno"> 1518</span>       }</div>
<div class="line"><span class="lineno"> 1519</span>    }</div>
<div class="line"><span class="lineno"> 1520</span>    </div>
<div class="line"><span class="lineno"> 1521</span>   <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) { elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = elem_center[<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]/nDofsX; }</div>
<div class="line"><span class="lineno"> 1522</span>  <span class="comment">//*************************************** </span></div>
<div class="line"><span class="lineno"> 1523</span>  </div>
<div class="line"><span class="lineno"> 1524</span>  <span class="comment">//***** set target domain flag ********************************** </span></div>
<div class="line"><span class="lineno"> 1525</span>   <span class="keywordtype">int</span> target_flag = 0;</div>
<div class="line"><span class="lineno"> 1526</span>   target_flag = ElementTargetFlag &lt; double &gt;(elem_center); <span class="comment">//domain is considered wrt moving</span></div>
<div class="line"><span class="lineno"> 1527</span> </div>
<div class="line"><span class="lineno"> 1528</span>  <span class="comment">// geometry end *****************************</span></div>
<div class="line"><span class="lineno"> 1529</span> </div>
<div class="line"><span class="lineno"> 1530</span> <span class="comment">//************ set control flag *********************</span></div>
<div class="line"><span class="lineno"> 1531</span>    <span class="keywordtype">int</span> control_el_flag = 0;</div>
<div class="line"><span class="lineno"> 1532</span>        control_el_flag = <a class="code hl_function" href="../../de/d58/solidopt__params_8hpp.html#a1dffa717bb8f2e25ad41baaf598c703f">ControlDomainFlag</a>(elem_center);</div>
<div class="line"><span class="lineno"> 1533</span>    std::vector&lt; std::vector&lt;int&gt; &gt; control_node_flag(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><span class="lineno"> 1534</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><span class="lineno"> 1535</span>                  control_node_flag[idim].resize(Sol_n_el_dofs[ctrl_pos_begin]);</div>
<div class="line"><span class="lineno"> 1536</span>    std::fill(control_node_flag[idim].begin(), control_node_flag[idim].end(), 0);</div>
<div class="line"><span class="lineno"> 1537</span>            }</div>
<div class="line"><span class="lineno"> 1538</span> <span class="comment">//*************************************************** </span></div>
<div class="line"><span class="lineno"> 1539</span>  </div>
<div class="line"><span class="lineno"> 1540</span> </div>
<div class="line"><span class="lineno"> 1541</span>  <span class="comment">//DESIRED DISPL###################################################################  </span></div>
<div class="line"><span class="lineno"> 1542</span>    <span class="comment">// displacement ************</span></div>
<div class="line"><span class="lineno"> 1543</span><span class="comment">//     for (unsigned i = 0; i &lt; Sol_n_el_dofs[sol_index_displ]; i++) {</span></div>
<div class="line"><span class="lineno"> 1544</span><span class="comment">//       unsigned solDdesDof = msh-&gt;GetSolutionDof(i, iel, solDType);    // global to global mapping between solution node and solution dof</span></div>
<div class="line"><span class="lineno"> 1545</span> </div>
<div class="line"><span class="lineno"> 1546</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; SolDisp_eldofs.size() <span class="comment">/*dim*/</span>; k++) {</div>
<div class="line"><span class="lineno"> 1547</span>        SolDisp_eldofs[k]<span class="comment">/*[i]*/</span> = <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a80e1487a07155d5b24edd6eca186b73b">TargetDisp</a>[k] <span class="comment">/*(*sol-&gt;_Sol[solDIndex[k]])(solDdesDof)*/</span>;      <span class="comment">// global extraction and local storage for the solution</span></div>
<div class="line"><span class="lineno"> 1548</span>      }</div>
<div class="line"><span class="lineno"> 1549</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno"> 1550</span> <span class="comment">//DESIRED DISPL###################################################################</span></div>
<div class="line"><span class="lineno"> 1551</span> </div>
<div class="line"><span class="lineno"> 1552</span> <span class="comment">//========BoundaryLoop=====================================================================</span></div>
<div class="line"><span class="lineno"> 1553</span> </div>
<div class="line"><span class="lineno"> 1554</span>  <span class="comment">// Perform face loop over elements that contain some control face</span></div>
<div class="line"><span class="lineno"> 1555</span>  <span class="keywordflow">if</span> (control_el_flag == 1) {</div>
<div class="line"><span class="lineno"> 1556</span>          </div>
<div class="line"><span class="lineno"> 1557</span>      <span class="keywordtype">double</span> tau = 0.;</div>
<div class="line"><span class="lineno"> 1558</span>      std::vector &lt; double &gt; normal(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>,0);</div>
<div class="line"><span class="lineno"> 1559</span>          </div>
<div class="line"><span class="lineno"> 1560</span>      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface = 0; jface &lt; msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a3c2977b3363513c86c5cdb0e645a78bd">GetElementFaceNumber</a>(iel); jface++) {</div>
<div class="line"><span class="lineno"> 1561</span>          std::vector &lt; double &gt; xyz_bdc(3,0.);  <span class="comment">//not being used, because the boundaries are identified by the face numbers</span></div>
<div class="line"><span class="lineno"> 1562</span>          <span class="comment">// look for boundary faces</span></div>
<div class="line"><span class="lineno"> 1563</span>          <span class="keywordflow">if</span>(el-&gt;<a class="code hl_function" href="../../db/d2e/classfemus_1_1elem.html#a491172d27d04d10ce166f42161d0c1d1">GetFaceElementIndex</a>(iel,jface) &lt; 0) {</div>
<div class="line"><span class="lineno"> 1564</span>              <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> face = -( msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#a62689335aebc9de69b7490bfb32f0978">el</a>-&gt;<a class="code hl_function" href="../../db/d2e/classfemus_1_1elem.html#a491172d27d04d10ce166f42161d0c1d1">GetFaceElementIndex</a>(iel,jface)+1);</div>
<div class="line"><span class="lineno"> 1565</span>              <span class="keywordflow">if</span>(  face == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) { <span class="comment">//control face</span></div>
<div class="line"><span class="lineno"> 1566</span><span class="comment">//=================================================== </span></div>
<div class="line"><span class="lineno"> 1567</span>                <span class="keywordtype">unsigned</span> nve_bd = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#af372596998e5d55a1fa15d6c5f58f52b">GetElementFaceDofNumber</a>(iel,jface, SolFEType[ctrl_pos_begin] ); <span class="comment">//AAAAAAAAAAAAAAAAA</span></div>
<div class="line"><span class="lineno"> 1568</span>                <span class="keyword">const</span> <span class="keywordtype">unsigned</span> felt_bd = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#a57f92951660269429cc7f04ee3c26c17">GetElementFaceType</a>(iel, jface);    </div>
<div class="line"><span class="lineno"> 1569</span>                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0; i &lt; nve_bd; i++) {</div>
<div class="line"><span class="lineno"> 1570</span>                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">GetLocalFaceVertexIndex</a>(iel, jface, i);</div>
<div class="line"><span class="lineno"> 1571</span>                    <span class="keywordtype">unsigned</span>      iDof = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ace44edec2dc2ffb42c0456f03fa227ff">GetSolutionDof</a>(i_vol, iel, coordsType);</div>
<div class="line"><span class="lineno"> 1572</span>                    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) { coords_hat_bd[idim][i]=(*msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#ac436cfb1f4caaec0c4335358ff8a51d8">_topology</a>-&gt;<a class="code hl_variable" href="../../d4/d40/classfemus_1_1_solution.html#a5c725da69d0b94b7ff4a4e2509c86d53">_Sol</a>[idim])(iDof); }</div>
<div class="line"><span class="lineno"> 1573</span>                }</div>
<div class="line"><span class="lineno"> 1574</span>                </div>
<div class="line"><span class="lineno"> 1575</span><span class="comment">//========= initialize gauss quantities on the boundary ============================================</span></div>
<div class="line"><span class="lineno"> 1576</span>         std::vector &lt; real_num &gt;                      SolVAR_bd_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1577</span>         std::vector &lt; std::vector &lt; real_num &gt; &gt;       gradSolVAR_bd_qp(n_unknowns);</div>
<div class="line"><span class="lineno"> 1578</span>                <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k=0; k&lt;n_unknowns; k++) {    gradSolVAR_bd_qp[k].resize(<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);  }</div>
<div class="line"><span class="lineno"> 1579</span> </div>
<div class="line"><span class="lineno"> 1580</span><span class="comment">//========= gauss_loop boundary===============================================================</span></div>
<div class="line"><span class="lineno"> 1581</span>                  <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ig_bd=0; ig_bd &lt; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(felt_bd).GetGaussPointsNumber(); ig_bd++) {</div>
<div class="line"><span class="lineno"> 1582</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1583</span>                      ml_prob.<a class="code hl_variable" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a946d39c3fba7fac859822702248fe065">_ml_msh</a>-&gt;<a class="code hl_variable" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#ad59554c65099f852ba8797f09bc40227">_finiteElement</a>[felt_bd][SolFEType[ctrl_pos_begin]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a41bf5e7188a121649319194e846e533f">JacobianSur</a>(coords_hat_bd,ig_bd,weight_hat_bd_qp,phi_hat_bd_dof_qp[kdim + ctrl_pos_begin],phi_hat_bd_x_dof_qp[kdim + ctrl_pos_begin],normal);</div>
<div class="line"><span class="lineno"> 1584</span>            }</div>
<div class="line"><span class="lineno"> 1585</span>            </div>
<div class="line"><span class="lineno"> 1586</span> <a class="code hl_function" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#abdd1e0dbfc8ed6ec0a237d9654d0bce9">set_phi_gradient_surface</a>(<a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a668a0b03c0385e061dad5178865e3b99">AXIS_DIRECTION_CONTROL_SIDE</a>, msh, ig_bd, SolFEType, felt_bd, nve_bd, coords_hat_bd, phi_hat_bd_x_dof_qp, <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, ctrl_pos_begin);</div>
<div class="line"><span class="lineno"> 1587</span>            </div>
<div class="line"><span class="lineno"> 1588</span>                  </div>
<div class="line"><span class="lineno"> 1589</span><span class="comment">//========== compute gauss quantities on the boundary ===============================================</span></div>
<div class="line"><span class="lineno"> 1590</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1591</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctrl_index = kdim + ctrl_pos_begin;</div>
<div class="line"><span class="lineno"> 1592</span>                                                                                  SolVAR_bd_qp[ SolPdeIndex[ctrl_index] ] = 0.;</div>
<div class="line"><span class="lineno"> 1593</span>                          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {  gradSolVAR_bd_qp[ SolPdeIndex[ctrl_index] ][ivar2] = 0.; }</div>
<div class="line"><span class="lineno"> 1594</span>                    }<span class="comment">//kdim</span></div>
<div class="line"><span class="lineno"> 1595</span>          </div>
<div class="line"><span class="lineno"> 1596</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno"> 1597</span>                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctrl_index = kdim + ctrl_pos_begin;</div>
<div class="line"><span class="lineno"> 1598</span>                          <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i_bd = 0; i_bd &lt; nve_bd; i_bd++) {</div>
<div class="line"><span class="lineno"> 1599</span>                                  <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;<a class="code hl_function" href="../../d9/d8b/classfemus_1_1_mesh.html#ad18fca5dab8c3567b644996e682043d3">GetLocalFaceVertexIndex</a>(iel, jface, i_bd);</div>
<div class="line"><span class="lineno"> 1600</span>                        SolVAR_bd_qp[SolPdeIndex[ctrl_index]]   += phi_hat_bd_dof_qp  [ ctrl_index ][i_bd] * SolVAR_eldofs[ SolPdeIndex[ ctrl_index ] ][i_vol];</div>
<div class="line"><span class="lineno"> 1601</span>                      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {  </div>
<div class="line"><span class="lineno"> 1602</span>                      gradSolVAR_bd_qp[SolPdeIndex[ctrl_index]][ivar2]  += phi_hat_bd_x_dof_qp[ ctrl_index ][i_bd + ivar2 * nve_bd] * SolVAR_eldofs[ SolPdeIndex[ ctrl_index ] ][i_vol];      </div>
<div class="line"><span class="lineno"> 1603</span>                }</div>
<div class="line"><span class="lineno"> 1604</span>                          }</div>
<div class="line"><span class="lineno"> 1605</span>                    }<span class="comment">//kdim</span></div>
<div class="line"><span class="lineno"> 1606</span> <span class="comment">//end unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno"> 1607</span> </div>
<div class="line"><span class="lineno"> 1608</span> <span class="comment">//========== compute gauss quantities on the boundary ================================================</span></div>
<div class="line"><span class="lineno"> 1609</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1610</span>        integral_beta    += SolVAR_bd_qp[SolPdeIndex[k + ctrl_pos_begin]] * SolVAR_bd_qp[SolPdeIndex[k + ctrl_pos_begin]] * weight_hat_bd_qp;</div>
<div class="line"><span class="lineno"> 1611</span>        integral_g_dot_n += SolVAR_bd_qp[SolPdeIndex[k + ctrl_pos_begin]] * normal[k] * weight_hat_bd_qp; </div>
<div class="line"><span class="lineno"> 1612</span>      }</div>
<div class="line"><span class="lineno"> 1613</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1614</span>            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {       </div>
<div class="line"><span class="lineno"> 1615</span>                integral_gamma    += gradSolVAR_bd_qp[SolPdeIndex[k + ctrl_pos_begin]][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * gradSolVAR_bd_qp[SolPdeIndex[k + ctrl_pos_begin]][<a class="code hl_variable" href="../../dd/dc4/_m_g_a_m_r_2ex6_2_m_g__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * weight_hat_bd_qp;</div>
<div class="line"><span class="lineno"> 1616</span>            }</div>
<div class="line"><span class="lineno"> 1617</span>      }</div>
<div class="line"><span class="lineno"> 1618</span>                  </div>
<div class="line"><span class="lineno"> 1619</span> </div>
<div class="line"><span class="lineno"> 1620</span>                }  <span class="comment">//end ig_bdry loop</span></div>
<div class="line"><span class="lineno"> 1621</span>          </div>
<div class="line"><span class="lineno"> 1622</span>             }    <span class="comment">//end if control face</span></div>
<div class="line"><span class="lineno"> 1623</span>         }  <span class="comment">//end if boundary faces</span></div>
<div class="line"><span class="lineno"> 1624</span>      }  <span class="comment">// loop over element faces //jface   </span></div>
<div class="line"><span class="lineno"> 1625</span>  } <span class="comment">//end if control element flag</span></div>
<div class="line"><span class="lineno"> 1626</span> </div>
<div class="line"><span class="lineno"> 1627</span> </div>
<div class="line"><span class="lineno"> 1628</span>     <span class="comment">// *** Gauss point loop ***</span></div>
<div class="line"><span class="lineno"> 1629</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> ig = 0; ig &lt; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a34890e6aa9d88946571fa050ee544c39">GetQuadratureRule</a>(ielGeom).GetGaussPointsNumber(); ig++) {</div>
<div class="line"><span class="lineno"> 1630</span> </div>
<div class="line"><span class="lineno"> 1631</span>        <span class="comment">// *** get Jacobian and test function and test function derivatives ***</span></div>
<div class="line"><span class="lineno"> 1632</span>      <span class="keywordflow">for</span>(<span class="keywordtype">int</span> unk=0; unk &lt; n_unknowns; unk++) {</div>
<div class="line"><span class="lineno"> 1633</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    ig,weight_qp,    phi_dof_qp[unk],    phi_x_dof_qp[unk],    phi_xx_dof_qp[unk]);</div>
<div class="line"><span class="lineno"> 1634</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][SolFEType[unk]]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,ig,weight_hat_qp,phi_hat_dof_qp[unk],phi_x_hat_dof_qp[unk],phi_xx_hat_dof_qp[unk]);</div>
<div class="line"><span class="lineno"> 1635</span>      }</div>
<div class="line"><span class="lineno"> 1636</span>      </div>
<div class="line"><span class="lineno"> 1637</span>   <span class="comment">//=============== Integration at qp ========================================</span></div>
<div class="line"><span class="lineno"> 1638</span>         <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN...</span></div>
<div class="line"><span class="lineno"> 1639</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> d = 0; d &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><span class="lineno"> 1640</span>         msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords,    ig, weight_qp,    phi_dof_qp_domain[d],     phi_x_dof_qp_domain[d],     phi_xx_dof_qp_domain[d]);</div>
<div class="line"><span class="lineno"> 1641</span>         msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][coordsType]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat,ig, weight_hat_qp,phi_dof_qp_domain_hat[d], phi_x_dof_qp_domain_hat[d], phi_xx_dof_qp_domain_hat[d]);</div>
<div class="line"><span class="lineno"> 1642</span>      }</div>
<div class="line"><span class="lineno"> 1643</span>     </div>
<div class="line"><span class="lineno"> 1644</span>  <span class="comment">//begin unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno"> 1645</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> unk = 0; unk &lt;  n_unknowns; unk++) {</div>
<div class="line"><span class="lineno"> 1646</span>          SolVAR_qp[SolPdeIndex[unk]] = 0.;</div>
<div class="line"><span class="lineno"> 1647</span>          SolVAR_hat_qp[SolPdeIndex[unk]] = 0.;</div>
<div class="line"><span class="lineno"> 1648</span> </div>
<div class="line"><span class="lineno"> 1649</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2=0; ivar2&lt;<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++){ </div>
<div class="line"><span class="lineno"> 1650</span>            gradSolVAR_qp[SolPdeIndex[unk]][ivar2] = 0.; </div>
<div class="line"><span class="lineno"> 1651</span>            gradSolVAR_hat_qp[SolPdeIndex[unk]][ivar2] = 0.; </div>
<div class="line"><span class="lineno"> 1652</span>          }</div>
<div class="line"><span class="lineno"> 1653</span>    }</div>
<div class="line"><span class="lineno"> 1654</span>          </div>
<div class="line"><span class="lineno"> 1655</span>        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> unk = 0; unk &lt;  n_unknowns; unk++) {</div>
<div class="line"><span class="lineno"> 1656</span>          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[unk]; i++) {</div>
<div class="line"><span class="lineno"> 1657</span>            SolVAR_qp[SolPdeIndex[unk]]    += phi_dof_qp[ unk ][i] * SolVAR_eldofs[SolPdeIndex[unk]][i];</div>
<div class="line"><span class="lineno"> 1658</span>            SolVAR_hat_qp[SolPdeIndex[unk]]    += phi_hat_dof_qp[ unk ][i] * SolVAR_eldofs[SolPdeIndex[unk]][i];</div>
<div class="line"><span class="lineno"> 1659</span>            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar2 = 0; ivar2 &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; ivar2++) {</div>
<div class="line"><span class="lineno"> 1660</span>              gradSolVAR_qp[SolPdeIndex[unk]][ivar2]     += phi_x_dof_qp[ unk ][i*<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[SolPdeIndex[unk]][i]; </div>
<div class="line"><span class="lineno"> 1661</span>              gradSolVAR_hat_qp[SolPdeIndex[unk]][ivar2] += phi_x_hat_dof_qp[ unk ][i*<a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>+ivar2] * SolVAR_eldofs[SolPdeIndex[unk]][i]; </div>
<div class="line"><span class="lineno"> 1662</span>            }</div>
<div class="line"><span class="lineno"> 1663</span>          }</div>
<div class="line"><span class="lineno"> 1664</span>          </div>
<div class="line"><span class="lineno"> 1665</span>        }  </div>
<div class="line"><span class="lineno"> 1666</span> <span class="comment">//end unknowns eval at gauss points ********************************</span></div>
<div class="line"><span class="lineno"> 1667</span> </div>
<div class="line"><span class="lineno"> 1668</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][SolFEType[sol_index_displ]  <span class="comment">/*SolDisp_eldofs*/</span>]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords, ig, weight_qp, phi_des_dof_qp, phi_des_x_dof_qp, phi_des_xx_dof_qp);</div>
<div class="line"><span class="lineno"> 1669</span>        msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[ielGeom][SolFEType[sol_index_displ]  <span class="comment">/*SolDisp_eldofs*/</span>]-&gt;<a class="code hl_function" href="../../d3/dca/classfemus_1_1elem__type.html#a64c3ed0fd9cd8afcb765144362147a2e">Jacobian</a>(coords_hat, ig, weight_hat_qp, phi_des_hat_dof_qp, phi_des_x_hat_dof_qp, phi_des_xx_hat_dof_qp);</div>
<div class="line"><span class="lineno"> 1670</span> </div>
<div class="line"><span class="lineno"> 1671</span>    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {      SolDisp_des_qp[k]    = 0.;     }</div>
<div class="line"><span class="lineno"> 1672</span>    </div>
<div class="line"><span class="lineno"> 1673</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {</div>
<div class="line"><span class="lineno"> 1674</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs[sol_index_displ]; i++) {</div>
<div class="line"><span class="lineno"> 1675</span>                SolDisp_des_qp[k] += SolDisp_eldofs[k]<span class="comment">/*[i]*/</span> * phi_des_dof_qp[i];</div>
<div class="line"><span class="lineno"> 1676</span>            SolDisp_des_hat_qp[k] += SolDisp_eldofs[k]<span class="comment">/*[i]*/</span> * phi_des_hat_dof_qp[i];</div>
<div class="line"><span class="lineno"> 1677</span>                }</div>
<div class="line"><span class="lineno"> 1678</span>      }</div>
<div class="line"><span class="lineno"> 1679</span>        </div>
<div class="line"><span class="lineno"> 1680</span>      </div>
<div class="line"><span class="lineno"> 1681</span>          </div>
<div class="line"><span class="lineno"> 1682</span>      <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; k++) {      </div>
<div class="line"><span class="lineno"> 1683</span>          integral_target_alpha += target_flag * (SolVAR_qp[SolPdeIndex[k]]  - SolDisp_des_qp[k]) * </div>
<div class="line"><span class="lineno"> 1684</span>                                                 (SolVAR_qp[SolPdeIndex[k]]  - SolDisp_des_qp[k]) * weight_qp; </div>
<div class="line"><span class="lineno"> 1685</span>                }</div>
<div class="line"><span class="lineno"> 1686</span>   </div>
<div class="line"><span class="lineno"> 1687</span>  </div>
<div class="line"><span class="lineno"> 1688</span>      }<span class="comment">// end gauss point loop</span></div>
<div class="line"><span class="lineno"> 1689</span>    } <span class="comment">//end element loop  </span></div>
<div class="line"><span class="lineno"> 1690</span> </div>
<div class="line"><span class="lineno"> 1691</span>       std::ostringstream filename_out; filename_out &lt;&lt; ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a274e91e352c0d6b69c5925fdfca67d1f">GetFilesHandler</a>()-&gt;<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">GetOutputPath</a>() &lt;&lt; <span class="stringliteral">&quot;/&quot;</span> &lt;&lt; <span class="stringliteral">&quot;Integral_computation&quot;</span>  &lt;&lt; <span class="stringliteral">&quot;.txt&quot;</span>;</div>
<div class="line"><span class="lineno"> 1692</span> </div>
<div class="line"><span class="lineno"> 1693</span>       std::ofstream intgr_fstream;</div>
<div class="line"><span class="lineno"> 1694</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../db/ded/namespacefemus_1_1_parallel.html#a112449ab6b32f2d8f562427b9fa960ab">Parallel::get_rank</a>() == 0 ) {</div>
<div class="line"><span class="lineno"> 1695</span>      intgr_fstream.open(filename_out.str().c_str(),std::ios_base::app);</div>
<div class="line"><span class="lineno"> 1696</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot; ***************************** Non Linear Iteration &quot;</span>&lt;&lt; mlPdeSys-&gt;GetNonlinearIt() &lt;&lt; <span class="stringliteral">&quot; *********************************** &quot;</span> &lt;&lt;  std::endl &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1697</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the target functional for &quot;</span> &lt;&lt; <span class="stringliteral">&quot;alpha &quot;</span> &lt;&lt;   std::setprecision(0) &lt;&lt; std::scientific &lt;&lt; <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt;  std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_target_alpha &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1698</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the L2 control for        &quot;</span> &lt;&lt; <span class="stringliteral">&quot;beta  &quot;</span> &lt;&lt;   std::setprecision(0) &lt;&lt; std::scientific &lt;&lt; <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>  &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt;  std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_beta         &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1699</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the H1 control for        &quot;</span> &lt;&lt; <span class="stringliteral">&quot;gamma &quot;</span> &lt;&lt;   std::setprecision(0) &lt;&lt; std::scientific &lt;&lt; <a class="code hl_variable" href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a> &lt;&lt; <span class="stringliteral">&quot; is &quot;</span> &lt;&lt;  std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_gamma        &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1700</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the integral of g.n &quot;</span>&lt;&lt;    integral_g_dot_n &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1701</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the theta is                             &quot;</span> &lt;&lt;    std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  SolVAR_eldofs[SolPdeIndex[theta_index]][0] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1702</span>      intgr_fstream &lt;&lt; <span class="stringliteral">&quot;The value of the total integral is &quot;</span> &lt;&lt; std::setw(11) &lt;&lt; std::setprecision(10) &lt;&lt;  integral_target_alpha * <a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a101671cfe5078b188740d5d892832ea9">cost_functional_coeff</a>*0.5  + integral_beta *<a class="code hl_variable" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a>*0.5 + integral_gamma *<a class="code hl_variable" href="../../df/dac/_f_s_i_time_dependent_assembly_supg_non_conservative_two_pressures_newmark_8hpp.html#a9424343761f8c4f4c1afe8f5b6bf471b">beta</a>*0.5 &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno"> 1703</span>      intgr_fstream &lt;&lt;  std::endl;</div>
<div class="line"><span class="lineno"> 1704</span>      intgr_fstream.close();  <span class="comment">//you have to close to disassociate the file from the stream</span></div>
<div class="line"><span class="lineno"> 1705</span>}  </div>
<div class="line"><span class="lineno"> 1706</span> </div>
<div class="line"><span class="lineno"> 1707</span>    <span class="keywordflow">return</span>; </div>
<div class="line"><span class="lineno"> 1708</span>          </div>
<div class="line"><span class="lineno"> 1709</span>  </div>
<div class="line"><span class="lineno"> 1710</span>}</div>
<div class="ttc" id="aclassfemus_1_1_files_html_acf59b68932959fe552a95acc362c3920"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#acf59b68932959fe552a95acc362c3920">femus::Files::GetOutputPath</a></div><div class="ttdeci">std::string GetOutputPath() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00110">Files.hpp:110</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a274e91e352c0d6b69c5925fdfca67d1f"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a274e91e352c0d6b69c5925fdfca67d1f">femus::MultiLevelProblem::GetFilesHandler</a></div><div class="ttdeci">const Files * GetFilesHandler() const</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00105">MultiLevelProblem.hpp:105</a></div></div>
<div class="ttc" id="anamespacefemus_1_1_parallel_html_a112449ab6b32f2d8f562427b9fa960ab"><div class="ttname"><a href="../../db/ded/namespacefemus_1_1_parallel.html#a112449ab6b32f2d8f562427b9fa960ab">femus::Parallel::get_rank</a></div><div class="ttdeci">int get_rank()</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dec/_parallel_8hpp_source.html#l00065">Parallel.hpp:65</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7a29781a20c5dd4153c3c1cecf0ff328" name="a7a29781a20c5dd4153c3c1cecf0ff328"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7a29781a20c5dd4153c3c1cecf0ff328">&#9670;&#160;</a></span>main()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int main </td>
          <td>(</td>
          <td class="paramtype">int&#160;</td>
          <td class="paramname"><em>argc</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char **&#160;</td>
          <td class="paramname"><em>args</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00245">245</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  245</span>                                {</div>
<div class="line"><span class="lineno">  246</span> </div>
<div class="line"><span class="lineno">  247</span>  <span class="comment">// ======= Init ==========================</span></div>
<div class="line"><span class="lineno">  248</span>  <a class="code hl_class" href="../../da/d5e/classfemus_1_1_femus_init.html">FemusInit</a> mpinit(argc, args, MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  249</span> </div>
<div class="line"><span class="lineno">  250</span>  <span class="comment">// ======= Files ==================</span></div>
<div class="line"><span class="lineno">  251</span>  <a class="code hl_class" href="../../d6/d0b/classfemus_1_1_files.html">Files</a> files;</div>
<div class="line"><span class="lineno">  252</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">CheckIODirectories</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  253</span>        files.<a class="code hl_function" href="../../d6/d0b/classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">RedirectCout</a>(<span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  254</span> </div>
<div class="line"><span class="lineno">  255</span>  <span class="comment">// ======= Quad Rule ========================</span></div>
<div class="line"><span class="lineno">  256</span>  std::string quad_rule_order(<span class="stringliteral">&quot;seventh&quot;</span>);</div>
<div class="line"><span class="lineno">  257</span> </div>
<div class="line"><span class="lineno">  258</span>  <span class="comment">// ======= Problem ========================</span></div>
<div class="line"><span class="lineno">  259</span>    <a class="code hl_class" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> ml_prob;</div>
<div class="line"><span class="lineno">  260</span>  ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a8b72e984b63d5ff97c1e7a0f0a5eee5a">SetQuadratureRuleAllGeomElems</a>(quad_rule_order);</div>
<div class="line"><span class="lineno">  261</span>  ml_prob.<a class="code hl_function" href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a623bdc2aefd83cf0c6d74fc265ee5c3f">SetFilesHandler</a>(&amp;files);</div>
<div class="line"><span class="lineno">  262</span>    </div>
<div class="line"><span class="lineno">  263</span>  <span class="comment">// ======= Mesh ==================</span></div>
<div class="line"><span class="lineno">  264</span>  <span class="keyword">const</span> <a class="code hl_enumeration" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a> geom_elem_type = <a class="code hl_enumvalue" href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a>;</div>
<div class="line"><span class="lineno">  265</span>  <span class="keyword">const</span> std::vector&lt; unsigned int &gt; nsub = {<a class="code hl_define" href="../../de/d58/solidopt__params_8hpp.html#a40646ef4581e21d1eac608c36580fff3">NSUB</a>, <a class="code hl_define" href="../../de/d58/solidopt__params_8hpp.html#a40646ef4581e21d1eac608c36580fff3">NSUB</a>, 0};</div>
<div class="line"><span class="lineno">  266</span>  <span class="keyword">const</span> std::vector&lt; double &gt;      xyz_min = {0., 0., 0.};</div>
<div class="line"><span class="lineno">  267</span>  <span class="keyword">const</span> std::vector&lt; double &gt;      xyz_max = {1., 1., 0.};</div>
<div class="line"><span class="lineno">  268</span> </div>
<div class="line"><span class="lineno">  269</span>  <a class="code hl_class" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">MultiLevelMesh</a> ml_mesh;</div>
<div class="line"><span class="lineno">  270</span>  ml_mesh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">GenerateCoarseBoxMesh</a>(nsub[0],nsub[1],nsub[2],xyz_min[0],xyz_max[0],xyz_min[1],xyz_max[1],xyz_min[2],xyz_max[2],geom_elem_type,quad_rule_order.c_str());</div>
<div class="line"><span class="lineno">  271</span> </div>
<div class="line"><span class="lineno">  272</span>  <span class="comment">// ======= Unknowns ========================</span></div>
<div class="line"><span class="lineno">  273</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> dimension = ml_mesh.<a class="code hl_function" href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">GetDimension</a>();  </div>
<div class="line"><span class="lineno">  274</span>  std::vector&lt; Unknown &gt; unknowns = <a class="code hl_function" href="../../d9/d2b/ex02__poisson__a__all__dims__dir__neu__multiple__domains_8cpp.html#aa6cf7e343af28b995b6fab3d3528f6ef">provide_list_of_unknowns</a>(dimension);</div>
<div class="line"><span class="lineno">  275</span>  </div>
<div class="line"><span class="lineno">  276</span>  <span class="comment">// ======= Normal run ========================   //if you don&#39;t want the convergence study</span></div>
<div class="line"><span class="lineno">  277</span>  <a class="code hl_class" href="../../db/d43/class_solution__generation__1.html">Solution_generation_1&lt; adept::adouble &gt;</a> my_main;</div>
<div class="line"><span class="lineno">  278</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_levels = 1;</div>
<div class="line"><span class="lineno">  279</span>  my_main.<a class="code hl_function" href="../../db/d43/class_solution__generation__1.html#ad1fd69465a7b2a2120cc9f2d0eb4e98f">run_on_single_level</a>(ml_prob, ml_mesh, n_levels, unknowns,  std::vector&lt; Math::Function &lt;double&gt; * &gt; (), <a class="code hl_function" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a>,<a class="code hl_function" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a>, <span class="keyword">true</span> ); </div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>  </div>
<div class="line"><span class="lineno">  282</span>  </div>
<div class="line"><span class="lineno">  283</span><span class="comment">//   // ======= Convergence study ========================</span></div>
<div class="line"><span class="lineno">  284</span><span class="comment">//     </span></div>
<div class="line"><span class="lineno">  285</span><span class="comment">//    //set coarse storage mesh (should write the copy constructor or &quot;=&quot; operator to copy the previous mesh) ==================</span></div>
<div class="line"><span class="lineno">  286</span><span class="comment">//    MultiLevelMesh ml_mesh_all_levels;</span></div>
<div class="line"><span class="lineno">  287</span><span class="comment">//    ml_mesh_all_levels.GenerateCoarseBoxMesh(nsub[0],nsub[1],nsub[2],xyz_min[0],xyz_max[0],xyz_min[1],xyz_max[1],xyz_min[2],xyz_max[2],geom_elem_type,quad_rule_order.c_str());</span></div>
<div class="line"><span class="lineno">  288</span><span class="comment">//    //   ml_mesh_all_levels.ReadCoarseMesh(infile.c_str(),quad_rule_order.c_str(),1.);</span></div>
<div class="line"><span class="lineno">  289</span><span class="comment">//  </span></div>
<div class="line"><span class="lineno">  290</span><span class="comment">//    // convergence choices ================  </span></div>
<div class="line"><span class="lineno">  291</span><span class="comment">//    unsigned int max_number_of_meshes;               // set total number of levels ================  </span></div>
<div class="line"><span class="lineno">  292</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  293</span><span class="comment">//    if (nsub[2] == 0)   max_number_of_meshes = 3;</span></div>
<div class="line"><span class="lineno">  294</span><span class="comment">//    else                max_number_of_meshes = 4;</span></div>
<div class="line"><span class="lineno">  295</span><span class="comment">//   </span></div>
<div class="line"><span class="lineno">  296</span><span class="comment">// //    My_exact_solution&lt;&gt; exact_sol;                //provide exact solution, if available ==============</span></div>
<div class="line"><span class="lineno">  297</span><span class="comment">//    const unsigned conv_order_flag = 0;              //Choose how to compute the convergence order ========= //0: incremental 1: absolute (with analytical sol)  2: absolute (with projection of finest sol)...</span></div>
<div class="line"><span class="lineno">  298</span><span class="comment">//    const unsigned norm_flag = 1;                    //Choose what norms to compute (//0 = only L2: //1 = L2 + H1) ==============</span></div>
<div class="line"><span class="lineno">  299</span><span class="comment">// </span></div>
<div class="line"><span class="lineno">  300</span><span class="comment">//    </span></div>
<div class="line"><span class="lineno">  301</span><span class="comment">//    // Convergence ================  </span></div>
<div class="line"><span class="lineno">  302</span><span class="comment">//     FE_convergence&lt;&gt;::convergence_study( ... );</span></div>
<div class="line"><span class="lineno">  303</span>  </div>
<div class="line"><span class="lineno">  304</span>    </div>
<div class="line"><span class="lineno">  305</span>  <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  306</span>}</div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_a1afc17d1ddb3752caf6910ec9a7c39ef"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a1afc17d1ddb3752caf6910ec9a7c39ef">Solution_set_boundary_conditions</a></div><div class="ttdeci">bool Solution_set_boundary_conditions(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char SolName[], double &amp;value, const int facename, const double time)</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00085">01_solid_control_boundary.cpp:85</a></div></div>
<div class="ttc" id="a01__solid__control__boundary_8cpp_html_a5dec9191b407f5f1913e563b23777741"><div class="ttname"><a href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a5dec9191b407f5f1913e563b23777741">Solution_set_initial_conditions</a></div><div class="ttdeci">double Solution_set_initial_conditions(const MultiLevelProblem *ml_prob, const std::vector&lt; double &gt; &amp;x, const char name[])</div><div class="ttdef"><b>Definition</b> <a href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00037">01_solid_control_boundary.cpp:37</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627">ElemType</a></div><div class="ttdeci">ElemType</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00006">ElemTypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_elem_type_enum_8hpp_html_a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59"><div class="ttname"><a href="../../df/d2a/_elem_type_enum_8hpp.html#a1b014294b9757a001707c979e2bab627ac17e6803e9d62a4d807c62341c5f7d59">QUAD9</a></div><div class="ttdeci">@ QUAD9</div><div class="ttdef"><b>Definition</b> <a href="../../df/d2a/_elem_type_enum_8hpp_source.html#l00016">ElemTypeEnum.hpp:16</a></div></div>
<div class="ttc" id="aclass_solution__generation__1_html"><div class="ttname"><a href="../../db/d43/class_solution__generation__1.html">Solution_generation_1</a></div><div class="ttdef"><b>Definition</b> <a href="../../d1/d6e/ex02__poisson__c__manufactured__sol__convergence__rate__class_8cpp_source.html#l00123">ex02_poisson_c_manufactured_sol_convergence_rate_class.cpp:123</a></div></div>
<div class="ttc" id="aclass_solution__generation__1_html_ad1fd69465a7b2a2120cc9f2d0eb4e98f"><div class="ttname"><a href="../../db/d43/class_solution__generation__1.html#ad1fd69465a7b2a2120cc9f2d0eb4e98f">Solution_generation_1::run_on_single_level</a></div><div class="ttdeci">const MultiLevelSolution run_on_single_level(MultiLevelProblem &amp;ml_prob, MultiLevelMesh &amp;ml_mesh, const unsigned i, const std::vector&lt; Unknown &gt; &amp;unknowns, const std::vector&lt; Math::Function&lt; double &gt; * &gt; &amp;exact_sol, const MultiLevelSolution::InitFuncMLProb SetInitialCondition_in, const MultiLevelSolution::BoundaryFuncMLProb SetBoundaryCondition_in, const bool my_solution_generation_has_equation_solve) const</div><div class="ttdef"><b>Definition</b> <a href="../../d1/d6e/ex02__poisson__c__manufactured__sol__convergence__rate__class_8cpp_source.html#l00144">ex02_poisson_c_manufactured_sol_convergence_rate_class.cpp:144</a></div></div>
<div class="ttc" id="aclassfemus_1_1_femus_init_html"><div class="ttname"><a href="../../da/d5e/classfemus_1_1_femus_init.html">femus::FemusInit</a></div><div class="ttdef"><b>Definition</b> <a href="../../df/d7c/_femus_init_8hpp_source.html#l00050">FemusInit.hpp:50</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html">femus::Files</a></div><div class="ttdef"><b>Definition</b> <a href="../../db/d4e/_files_8hpp_source.html#l00038">Files.hpp:38</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_aac199200ffda7ba50611cc41f6a874bc"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#aac199200ffda7ba50611cc41f6a874bc">femus::Files::RedirectCout</a></div><div class="ttdeci">void RedirectCout(const bool redirect_cout_to_file) const</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00565">Files.cpp:565</a></div></div>
<div class="ttc" id="aclassfemus_1_1_files_html_ab8c41974c4980d87c7e1467b153854e6"><div class="ttname"><a href="../../d6/d0b/classfemus_1_1_files.html#ab8c41974c4980d87c7e1467b153854e6">femus::Files::CheckIODirectories</a></div><div class="ttdeci">void CheckIODirectories(const bool use_output_time_folder)</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dce/_files_8cpp_source.html#l00527">Files.cpp:527</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html">femus::MultiLevelMesh</a></div><div class="ttdef"><b>Definition</b> <a href="../../dd/dc5/_multi_level_mesh_8hpp_source.html#l00047">MultiLevelMesh.hpp:47</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a0988cbee341d6361df77622b3ce65080"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a0988cbee341d6361df77622b3ce65080">femus::MultiLevelMesh::GenerateCoarseBoxMesh</a></div><div class="ttdeci">void GenerateCoarseBoxMesh(const unsigned int nx, const unsigned int ny, const unsigned int nz, const double xmin, const double xmax, const double ymin, const double ymax, const double zmin, const double zmax, const ElemType type, const char GaussOrder[])</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00215">MultiLevelMesh.cpp:215</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_mesh_html_a65dabdf1e308c1a44ebe5c6a41d09284"><div class="ttname"><a href="../../dc/d8d/classfemus_1_1_multi_level_mesh.html#a65dabdf1e308c1a44ebe5c6a41d09284">femus::MultiLevelMesh::GetDimension</a></div><div class="ttdeci">const unsigned GetDimension() const</div><div class="ttdef"><b>Definition</b> <a href="../../db/d07/_multi_level_mesh_8cpp_source.html#l00116">MultiLevelMesh.cpp:116</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html">femus::MultiLevelProblem</a></div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00060">MultiLevelProblem.hpp:60</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a623bdc2aefd83cf0c6d74fc265ee5c3f"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a623bdc2aefd83cf0c6d74fc265ee5c3f">femus::MultiLevelProblem::SetFilesHandler</a></div><div class="ttdeci">void SetFilesHandler(const Files *files_in)</div><div class="ttdef"><b>Definition</b> <a href="../../d6/dbc/_multi_level_problem_8hpp_source.html#l00103">MultiLevelProblem.hpp:103</a></div></div>
<div class="ttc" id="aclassfemus_1_1_multi_level_problem_html_a8b72e984b63d5ff97c1e7a0f0a5eee5a"><div class="ttname"><a href="../../de/d6a/classfemus_1_1_multi_level_problem.html#a8b72e984b63d5ff97c1e7a0f0a5eee5a">femus::MultiLevelProblem::SetQuadratureRuleAllGeomElems</a></div><div class="ttdeci">void SetQuadratureRuleAllGeomElems(const std::string quadr_order_in)</div><div class="ttdef"><b>Definition</b> <a href="../../d9/dc6/_multi_level_problem_8cpp_source.html#l00177">MultiLevelProblem.cpp:177</a></div></div>
<div class="ttc" id="aex02__poisson__a__all__dims__dir__neu__multiple__domains_8cpp_html_aa6cf7e343af28b995b6fab3d3528f6ef"><div class="ttname"><a href="../../d9/d2b/ex02__poisson__a__all__dims__dir__neu__multiple__domains_8cpp.html#aa6cf7e343af28b995b6fab3d3528f6ef">provide_list_of_unknowns</a></div><div class="ttdeci">const std::vector&lt; Unknown &gt; provide_list_of_unknowns()</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d2b/ex02__poisson__a__all__dims__dir__neu__multiple__domains_8cpp_source.html#l00534">ex02_poisson_a_all_dims_dir_neu_multiple_domains.cpp:534</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a40646ef4581e21d1eac608c36580fff3"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a40646ef4581e21d1eac608c36580fff3">NSUB</a></div><div class="ttdeci">#define NSUB</div><div class="ttdef"><b>Definition</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00007">solidopt_params.hpp:7</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a6917621ec8f1cbd9eda71cf3f12de89c" name="a6917621ec8f1cbd9eda71cf3f12de89c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6917621ec8f1cbd9eda71cf3f12de89c">&#9670;&#160;</a></span>provide_list_of_unknowns()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">const std::vector&lt; <a class="el" href="../../d8/dea/namespacefemus.html#d3/d77/classfemus_1_1_unknown">Unknown</a> &gt; provide_list_of_unknowns </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>dimension</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00128">128</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  128</span>                                                                                    {</div>
<div class="line"><span class="lineno">  129</span>     </div>
<div class="line"><span class="lineno">  130</span>     </div>
<div class="line"><span class="lineno">  131</span>  std::vector&lt; FEFamily &gt; feFamily;</div>
<div class="line"><span class="lineno">  132</span>  std::vector&lt; FEOrder &gt;   feOrder;</div>
<div class="line"><span class="lineno">  133</span> </div>
<div class="line"><span class="lineno">  134</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);   <span class="comment">//state</span></div>
<div class="line"><span class="lineno">  135</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  136</span>  <span class="keywordflow">if</span> (dimension == 3)   feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  137</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a><span class="comment">/*DISCONTINOUS_POLYNOMIAL*/</span>);</div>
<div class="line"><span class="lineno">  138</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);   <span class="comment">//adjoint</span></div>
<div class="line"><span class="lineno">  139</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  140</span>  <span class="keywordflow">if</span> (dimension == 3)   feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  141</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a><span class="comment">/*DISCONTINOUS_POLYNOMIAL*/</span>);</div>
<div class="line"><span class="lineno">  142</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);   <span class="comment">//control</span></div>
<div class="line"><span class="lineno">  143</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  144</span>  <span class="keywordflow">if</span> (dimension == 3)   feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a>);</div>
<div class="line"><span class="lineno">  145</span>                        feFamily.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a>);</div>
<div class="line"><span class="lineno">  146</span> </div>
<div class="line"><span class="lineno">  147</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  148</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  149</span>  <span class="keywordflow">if</span> (dimension == 3)   feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  150</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>);</div>
<div class="line"><span class="lineno">  151</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  152</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  153</span>  <span class="keywordflow">if</span> (dimension == 3)   feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  154</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a>);</div>
<div class="line"><span class="lineno">  155</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  156</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  157</span>  <span class="keywordflow">if</span> (dimension == 3)   feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a>);</div>
<div class="line"><span class="lineno">  158</span>                        feOrder.push_back(<a class="code hl_enumvalue" href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a>);</div>
<div class="line"><span class="lineno">  159</span> </div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  assert( feFamily.size() == feOrder.size() );</div>
<div class="line"><span class="lineno">  162</span> </div>
<div class="line"><span class="lineno">  163</span> std::vector&lt; Unknown &gt;  unknowns(feFamily.size());</div>
<div class="line"><span class="lineno">  164</span> </div>
<div class="line"><span class="lineno">  165</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> adj_pos_begin   = dimension + 1;</div>
<div class="line"><span class="lineno">  166</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> ctrl_pos_begin  = 2 * (dimension + 1);</div>
<div class="line"><span class="lineno">  167</span> </div>
<div class="line"><span class="lineno">  168</span>                                        unknowns[0]._name      = <span class="stringliteral">&quot;DX&quot;</span>;</div>
<div class="line"><span class="lineno">  169</span>                                        unknowns[1]._name      = <span class="stringliteral">&quot;DY&quot;</span>;</div>
<div class="line"><span class="lineno">  170</span>  <span class="keywordflow">if</span> (dimension == 3)                   unknowns[2]._name      = <span class="stringliteral">&quot;DZ&quot;</span>;</div>
<div class="line"><span class="lineno">  171</span>                                unknowns[dimension]._name      = <span class="stringliteral">&quot;P&quot;</span>;</div>
<div class="line"><span class="lineno">  172</span>                        unknowns[adj_pos_begin + 0]._name      = <span class="stringliteral">&quot;DX_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  173</span>                        unknowns[adj_pos_begin + 1]._name      = <span class="stringliteral">&quot;DY_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  174</span>  <span class="keywordflow">if</span> (dimension == 3)   unknowns[adj_pos_begin + 2]._name      = <span class="stringliteral">&quot;DZ_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  175</span>                unknowns[adj_pos_begin + dimension]._name      = <span class="stringliteral">&quot;P_ADJ&quot;</span>;</div>
<div class="line"><span class="lineno">  176</span>                       unknowns[ctrl_pos_begin + 0]._name      = <span class="stringliteral">&quot;GX&quot;</span>;</div>
<div class="line"><span class="lineno">  177</span>                       unknowns[ctrl_pos_begin + 1]._name      = <span class="stringliteral">&quot;GY&quot;</span>;</div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">if</span> (dimension == 3)  unknowns[ctrl_pos_begin + 2]._name      = <span class="stringliteral">&quot;GZ&quot;</span>;</div>
<div class="line"><span class="lineno">  179</span>               unknowns[ctrl_pos_begin + dimension]._name      = <span class="stringliteral">&quot;THETA&quot;</span>;</div>
<div class="line"><span class="lineno">  180</span> </div>
<div class="line"><span class="lineno">  181</span>     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> u = 0; u &lt; unknowns.size(); u++) {</div>
<div class="line"><span class="lineno">  182</span>         </div>
<div class="line"><span class="lineno">  183</span>              unknowns[u]._fe_family  = feFamily[u];</div>
<div class="line"><span class="lineno">  184</span>              unknowns[u]._fe_order   = feOrder[u];</div>
<div class="line"><span class="lineno">  185</span>              unknowns[u]._time_order = 0;</div>
<div class="line"><span class="lineno">  186</span>              unknowns[u]._is_pde_unknown = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  187</span>              </div>
<div class="line"><span class="lineno">  188</span>     }</div>
<div class="line"><span class="lineno">  189</span> </div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>   <span class="keywordflow">return</span> unknowns;</div>
<div class="line"><span class="lineno">  192</span>     </div>
<div class="line"><span class="lineno">  193</span>}</div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa6a7856cca1833641e731676636b193f1">FIRST</a></div><div class="ttdeci">@ FIRST</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00020">FElemTypeEnum.hpp:20</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baa7cb36ff0a80f238d5b987d9250d369e3">SECOND</a></div><div class="ttdeci">@ SECOND</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00023">FElemTypeEnum.hpp:22</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a00ea9562f0dbb25e22bb3297d596e3baae117e3533122c80b262257b49b21cddf">ZERO</a></div><div class="ttdeci">@ ZERO</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00019">FElemTypeEnum.hpp:19</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a2318cd5622bed5320c47de68813ab4df">DISCONTINUOUS_POLYNOMIAL</a></div><div class="ttdeci">@ DISCONTINUOUS_POLYNOMIAL</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00011">FElemTypeEnum.hpp:11</a></div></div>
<div class="ttc" id="a_f_elem_type_enum_8hpp_html_a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e"><div class="ttname"><a href="../../dd/df7/_f_elem_type_enum_8hpp.html#a7c9a70b7c6b5baf5d7942938d770a664a3a2686743e1a69768985087ac144a28e">LAGRANGE</a></div><div class="ttdeci">@ LAGRANGE</div><div class="ttdef"><b>Definition</b> <a href="../../dd/df7/_f_elem_type_enum_8hpp_source.html#l00010">FElemTypeEnum.hpp:10</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abdd1e0dbfc8ed6ec0a237d9654d0bce9" name="abdd1e0dbfc8ed6ec0a237d9654d0bce9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abdd1e0dbfc8ed6ec0a237d9654d0bce9">&#9670;&#160;</a></span>set_phi_gradient_surface()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void set_phi_gradient_surface </td>
          <td>(</td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>axis_direction_control_side</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d9/d8b/classfemus_1_1_mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>msh</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>ig_bd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt;&#160;</td>
          <td class="paramname"><em>SolFEType</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>felt_bd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nve_bd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>coords_hat_bd</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>phi_hat_bd_x_dof_qp</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>dim</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>ctrl_pos_begin</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00214">214</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  224</span>                       {</div>
<div class="line"><span class="lineno">  225</span>    </div>
<div class="line"><span class="lineno">  226</span><span class="comment">//========== temporary soln for surface gradient on a face parallel to the axes ===================</span></div>
<div class="line"><span class="lineno">  227</span><span class="comment">//           const unsigned int axis_direction_control_side = AXIS_DIRECTION_CONTROL_SIDE;</span></div>
<div class="line"><span class="lineno">  228</span>                  <span class="keywordtype">double</span> dx_dcurv_abscissa = 0.;</div>
<div class="line"><span class="lineno">  229</span>                 <span class="keyword">const</span> <a class="code hl_class" href="../../d9/dd6/classfemus_1_1elem__type__1_d.html">elem_type_1D</a> * myeltype = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_class" href="../../d9/dd6/classfemus_1_1elem__type__1_d.html">elem_type_1D</a>*<span class="keyword">&gt;</span>(msh-&gt;<a class="code hl_variable" href="../../d9/d8b/classfemus_1_1_mesh.html#af6a027b7ae5fe8a2b87be6ed15891f64">_finiteElement</a>[felt_bd][SolFEType[ctrl_pos_begin]]);</div>
<div class="line"><span class="lineno">  230</span>                 <span class="keyword">const</span> <span class="keywordtype">double</span> * myptr = myptr = myeltype-&gt;<a class="code hl_function" href="../../d9/dd6/classfemus_1_1elem__type__1_d.html#a231d3fc282fc57ca178f9cbd0d10df7c">GetDPhiDXi</a>(ig_bd);</div>
<div class="line"><span class="lineno">  231</span>                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> inode = 0; inode &lt; nve_bd; inode++) dx_dcurv_abscissa += myptr[inode] * coords_hat_bd[axis_direction_control_side][inode];</div>
<div class="line"><span class="lineno">  232</span>  </div>
<div class="line"><span class="lineno">  233</span>                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  kdim = 0; kdim &lt; <a class="code hl_variable" href="../../d4/dc8/_navier_stokes___a_m_r_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><span class="lineno">  234</span>                      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> inode = 0; inode &lt; nve_bd; inode++) {</div>
<div class="line"><span class="lineno">  235</span>                            <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; coords_hat_bd.size(); d++) {</div>
<div class="line"><span class="lineno">  236</span>                              <span class="keywordflow">if</span> (d == axis_direction_control_side ) phi_hat_bd_x_dof_qp[kdim + ctrl_pos_begin][inode + d*nve_bd] = myptr[inode]* (1./ dx_dcurv_abscissa);</div>
<div class="line"><span class="lineno">  237</span>                              <span class="keywordflow">else</span>  phi_hat_bd_x_dof_qp[kdim + ctrl_pos_begin][inode + d*nve_bd] = 0.;</div>
<div class="line"><span class="lineno">  238</span>                         }</div>
<div class="line"><span class="lineno">  239</span>                     }</div>
<div class="line"><span class="lineno">  240</span>            }</div>
<div class="line"><span class="lineno">  241</span>            </div>
<div class="line"><span class="lineno">  242</span>}</div>
<div class="ttc" id="aclassfemus_1_1elem__type__1_d_html"><div class="ttname"><a href="../../d9/dd6/classfemus_1_1elem__type__1_d.html">femus::elem_type_1D</a></div><div class="ttdef"><b>Definition</b> <a href="../../d8/df9/_elem_type_8hpp_source.html#l00422">ElemType.hpp:423</a></div></div>
<div class="ttc" id="aclassfemus_1_1elem__type__1_d_html_a231d3fc282fc57ca178f9cbd0d10df7c"><div class="ttname"><a href="../../d9/dd6/classfemus_1_1elem__type__1_d.html#a231d3fc282fc57ca178f9cbd0d10df7c">femus::elem_type_1D::GetDPhiDXi</a></div><div class="ttdeci">double * GetDPhiDXi(const unsigned &amp;ig) const</div><div class="ttdef"><b>Definition</b> <a href="../../d8/df9/_elem_type_8hpp_source.html#l00564">ElemType.hpp:564</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1afc17d1ddb3752caf6910ec9a7c39ef" name="a1afc17d1ddb3752caf6910ec9a7c39ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1afc17d1ddb3752caf6910ec9a7c39ef">&#9670;&#160;</a></span>Solution_set_boundary_conditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">bool Solution_set_boundary_conditions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>SolName</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">double &amp;&#160;</td>
          <td class="paramname"><em>value</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>facename</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>time</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00085">85</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   85</span>                                                                                                                                                                                    {</div>
<div class="line"><span class="lineno">   86</span>  <span class="comment">//1: bottom (y=y_min) //2: right (x=x_max)  //3: top (y=y_max)  //4: left (x=x_min)  (in 2D)</span></div>
<div class="line"><span class="lineno">   87</span>  </div>
<div class="line"><span class="lineno">   88</span>  <span class="keywordtype">bool</span> dirichlet  = <span class="keyword">true</span>; </div>
<div class="line"><span class="lineno">   89</span>  value = 0.;</div>
<div class="line"><span class="lineno">   90</span>  </div>
<div class="line"><span class="lineno">   91</span> </div>
<div class="line"><span class="lineno">   92</span>                <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;GX&quot;</span>))       { <span class="keywordflow">if</span> (facename == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">   93</span>                <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;GY&quot;</span>))       { <span class="keywordflow">if</span> (facename == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">   94</span>                <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;GZ&quot;</span>))       { <span class="keywordflow">if</span> (facename == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">   95</span>                <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;THETA&quot;</span>))    { dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">   96</span> </div>
<div class="line"><span class="lineno">   97</span>               <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DX&quot;</span>))       { <span class="keywordflow">if</span> (facename == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">   98</span>                <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DY&quot;</span>))       { <span class="keywordflow">if</span> (facename == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">   99</span>                <span class="keywordflow">if</span> (!strcmp(SolName, <span class="stringliteral">&quot;DZ&quot;</span>))       { <span class="keywordflow">if</span> (facename == <a class="code hl_define" href="../../d7/d2a/01__solid__control__boundary_8cpp.html#a8267a4060045c8116d32a821091e43cd">CTRL_FACE_IDX</a>) dirichlet = <span class="keyword">false</span>; }</div>
<div class="line"><span class="lineno">  100</span>  </div>
<div class="line"><span class="lineno">  101</span>      </div>
<div class="line"><span class="lineno">  102</span> <span class="keywordflow">return</span> dirichlet;</div>
<div class="line"><span class="lineno">  103</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5dec9191b407f5f1913e563b23777741" name="a5dec9191b407f5f1913e563b23777741"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5dec9191b407f5f1913e563b23777741">&#9670;&#160;</a></span>Solution_set_initial_conditions()</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double Solution_set_initial_conditions </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../de/d6a/classfemus_1_1_multi_level_problem.html">MultiLevelProblem</a> *&#160;</td>
          <td class="paramname"><em>ml_prob</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const char&#160;</td>
          <td class="paramname"><em>name</em>[]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00037">37</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>                                                                                                                            {</div>
<div class="line"><span class="lineno">   38</span>         </div>
<div class="line"><span class="lineno">   39</span>           <span class="keywordtype">double</span> value = 0.;</div>
<div class="line"><span class="lineno">   40</span> </div>
<div class="line"><span class="lineno">   41</span>             <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DX&quot;</span>)) {</div>
<div class="line"><span class="lineno">   42</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   43</span>             }</div>
<div class="line"><span class="lineno">   44</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DY&quot;</span>)) {</div>
<div class="line"><span class="lineno">   45</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   46</span>             }</div>
<div class="line"><span class="lineno">   47</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DZ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   48</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   49</span>             }</div>
<div class="line"><span class="lineno">   50</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;P&quot;</span>)) {</div>
<div class="line"><span class="lineno">   51</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   52</span>             }</div>
<div class="line"><span class="lineno">   53</span> </div>
<div class="line"><span class="lineno">   54</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DX_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   55</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   56</span>             }</div>
<div class="line"><span class="lineno">   57</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DY_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   58</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   59</span>             }</div>
<div class="line"><span class="lineno">   60</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;DZ_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   61</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   62</span>             }</div>
<div class="line"><span class="lineno">   63</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;P_ADJ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   64</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   65</span>             }</div>
<div class="line"><span class="lineno">   66</span>             </div>
<div class="line"><span class="lineno">   67</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;GX&quot;</span>)) {</div>
<div class="line"><span class="lineno">   68</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   69</span>             }</div>
<div class="line"><span class="lineno">   70</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;GY&quot;</span>)) {</div>
<div class="line"><span class="lineno">   71</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   72</span>             }</div>
<div class="line"><span class="lineno">   73</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;GZ&quot;</span>)) {</div>
<div class="line"><span class="lineno">   74</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   75</span>             }</div>
<div class="line"><span class="lineno">   76</span>             <span class="keywordflow">else</span> <span class="keywordflow">if</span>(!strcmp(name,<span class="stringliteral">&quot;THETA&quot;</span>)) {</div>
<div class="line"><span class="lineno">   77</span>                 value = 0.;</div>
<div class="line"><span class="lineno">   78</span>             }</div>
<div class="line"><span class="lineno">   79</span>          </div>
<div class="line"><span class="lineno">   80</span>    </div>
<div class="line"><span class="lineno">   81</span>      <span class="keywordflow">return</span> value;   </div>
<div class="line"><span class="lineno">   82</span>}  </div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a id="a92a609d215ec3c30302b119aa0df10f0" name="a92a609d215ec3c30302b119aa0df10f0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a92a609d215ec3c30302b119aa0df10f0">&#9670;&#160;</a></span>penalty_ctrl</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double penalty_ctrl = 1.e10</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00033">33</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>

</div>
</div>
<a id="a480ad40eedfb9ced9d7b090e19b3b85a" name="a480ad40eedfb9ced9d7b090e19b3b85a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a480ad40eedfb9ced9d7b090e19b3b85a">&#9670;&#160;</a></span>penalty_outside_control_boundary</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double penalty_outside_control_boundary = 1.e50</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00032">32</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>

</div>
</div>
<a id="a949680fe5298ccbe0a9d804df0b792ee" name="a949680fe5298ccbe0a9d804df0b792ee"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a949680fe5298ccbe0a9d804df0b792ee">&#9670;&#160;</a></span>theta_value_outside_fake_element</h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">double theta_value_outside_fake_element = 0.</td>
        </tr>
      </table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html#l00034">34</a> of file <a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp_source.html">01_solid_control_boundary.cpp</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../dir_b2f33c71d4aa5e7af42a1ca61ff5af1b.html">source</a></li><li class="navelem"><a class="el" href="../../dir_bc623bb5c626d1209c788e33f57707c6.html">applications</a></li><li class="navelem"><a class="el" href="../../dir_80f1944ed3ab07eccc3fc4912c12d5bd.html">010_OptimalControl</a></li><li class="navelem"><a class="el" href="../../dir_7a7944f644fe8f291a409e47418629cd.html">04_solidopt</a></li><li class="navelem"><a class="el" href="../../dir_0fce92ff50cbf8c1e88bf4914ac5057f.html">01_solid_control_boundary</a></li><li class="navelem"><a class="el" href="../../d7/d2a/01__solid__control__boundary_8cpp.html">01_solid_control_boundary.cpp</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
