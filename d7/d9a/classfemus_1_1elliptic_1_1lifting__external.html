<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.9.1"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: femus::elliptic::lifting_external Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.1 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "../../search",false,'Search','.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-static-attribs">Static Protected Attributes</a> &#124;
<a href="../../d9/db2/classfemus_1_1elliptic_1_1lifting__external-members.html">List of all members</a>  </div>
  <div class="headertitle">
<div class="title">femus::elliptic::lifting_external Class Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for femus::elliptic::lifting_external:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.png" usemap="#femus::elliptic::lifting_5Fexternal_map" alt=""/>
  <map id="femus::elliptic::lifting_5Fexternal_map" name="femus::elliptic::lifting_5Fexternal_map">
<area href="../../de/da3/classfemus_1_1lifting__external.html" alt="femus::lifting_external" shape="rect" coords="0,0,175,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:af0a9ccb75bf6f983cdb5f8573000a33c"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">compute_coordinates_bdry_one_face</a> (std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_at_dofs_bdry, const int solType_coords, const unsigned int iel, const int jface, const <a class="el" href="../../d6/db7/classfemus_1_1Mesh.html">Mesh</a> *msh)</td></tr>
<tr class="separator:af0a9ccb75bf6f983cdb5f8573000a33c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a86be6466c20a785bfa63545d1536fae9"><td class="memItemLeft" align="right" valign="top">static bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a86be6466c20a785bfa63545d1536fae9">find_control_boundary_nodes</a> (std::vector&lt; unsigned int &gt; &amp;interface_node_flag, const std::vector&lt; double &gt; &amp;elem_center_bdry, const unsigned int nDofu_bdry, const unsigned int iel, const int jface, const <a class="el" href="../../d6/db7/classfemus_1_1Mesh.html">Mesh</a> *msh)</td></tr>
<tr class="separator:a86be6466c20a785bfa63545d1536fae9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a52708ef8c522b82aaac9daececb660d7"><td class="memItemLeft" align="right" valign="top">static void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a52708ef8c522b82aaac9daececb660d7">assemble_elliptic_dirichlet_control</a> (<a class="el" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a> &amp;ml_prob)</td></tr>
<tr class="separator:a52708ef8c522b82aaac9daececb660d7"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="pro-static-attribs"></a>
Static Protected Attributes</h2></td></tr>
<tr class="memitem:a3a29ef8490dc93fc0f45f5376e323a61"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> = 1</td></tr>
<tr class="separator:a3a29ef8490dc93fc0f45f5376e323a61"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ad347558b2dc39abe98d8ff7ced798a3c"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">_neumann_adjoint_continuity_sign</a> = -1</td></tr>
<tr class="separator:ad347558b2dc39abe98d8ff7ced798a3c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a65401ffd4bdad0456d123751e028576a"><td class="memItemLeft" align="right" valign="top">static constexpr int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> = 1</td></tr>
<tr class="separator:a65401ffd4bdad0456d123751e028576a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock">
<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01922">1922</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
</div><h2 class="groupheader">Member Function Documentation</h2>
<a id="a52708ef8c522b82aaac9daececb660d7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a52708ef8c522b82aaac9daececb660d7">&#9670;&nbsp;</a></span>assemble_elliptic_dirichlet_control()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void femus::elliptic::lifting_external::assemble_elliptic_dirichlet_control </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../d8/d26/classfemus_1_1MultiLevelProblem.html">MultiLevelProblem</a> &amp;&#160;</td>
          <td class="paramname"><em>ml_prob</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000170">Todo:</a></b></dt><dd>these are the positions in the MlSol object or in the Matrix? I'd say the matrix, but we have to check where we use it... </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000171">Todo:</a></b></dt><dd>maybe it should be geometry-based </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000172">Todo:</a></b></dt><dd>check this term in control equation </dd></dl>
<dl class="todo"><dt><b><a class="el" href="../../dd/da0/todo.html#_todo000173">Todo:</a></b></dt><dd>check this term in control equation </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01991">1991</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01991"></a><span class="lineno"> 1991</span>&#160;                                                                            {</div>
<div class="line"><a name="l01992"></a><span class="lineno"> 1992</span>&#160;    <span class="comment">//  ml_prob is the global object from/to where get/set all the data</span></div>
<div class="line"><a name="l01993"></a><span class="lineno"> 1993</span>&#160; </div>
<div class="line"><a name="l01994"></a><span class="lineno"> 1994</span>&#160;    <span class="comment">//  level is the level of the PDE system to be assembled</span></div>
<div class="line"><a name="l01995"></a><span class="lineno"> 1995</span>&#160;    <span class="comment">//  levelMax is the Maximum level of the MultiLevelProblem</span></div>
<div class="line"><a name="l01996"></a><span class="lineno"> 1996</span>&#160;    <span class="comment">//  assembleMatrix is a flag that tells if only the residual or also the matrix should be assembled</span></div>
<div class="line"><a name="l01997"></a><span class="lineno"> 1997</span>&#160; </div>
<div class="line"><a name="l01998"></a><span class="lineno"> 1998</span>&#160;    <span class="comment">//  extract pointers to the several objects that we are going to use</span></div>
<div class="line"><a name="l01999"></a><span class="lineno"> 1999</span>&#160; </div>
<div class="line"><a name="l02000"></a><span class="lineno"> 2000</span>&#160;    NonLinearImplicitSystemWithPrimalDualActiveSetMethod* mlPdeSys  = &amp;ml_prob.get_system&lt;NonLinearImplicitSystemWithPrimalDualActiveSetMethod&gt; (<span class="stringliteral">&quot;LiftRestr&quot;</span>);   <span class="comment">// pointer to the linear implicit system named &quot;LiftRestr&quot;</span></div>
<div class="line"><a name="l02001"></a><span class="lineno"> 2001</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> level = mlPdeSys-&gt;GetLevelToAssemble();</div>
<div class="line"><a name="l02002"></a><span class="lineno"> 2002</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">bool</span> assembleMatrix = mlPdeSys-&gt;GetAssembleMatrix();</div>
<div class="line"><a name="l02003"></a><span class="lineno"> 2003</span>&#160; </div>
<div class="line"><a name="l02004"></a><span class="lineno"> 2004</span>&#160;    Mesh*                    msh = ml_prob._ml_msh-&gt;GetLevel(level);</div>
<div class="line"><a name="l02005"></a><span class="lineno"> 2005</span>&#160; </div>
<div class="line"><a name="l02006"></a><span class="lineno"> 2006</span>&#160;    MultiLevelSolution*    ml_sol = ml_prob._ml_sol;</div>
<div class="line"><a name="l02007"></a><span class="lineno"> 2007</span>&#160;    Solution*                sol = ml_prob._ml_sol-&gt;GetSolutionLevel(level);</div>
<div class="line"><a name="l02008"></a><span class="lineno"> 2008</span>&#160; </div>
<div class="line"><a name="l02009"></a><span class="lineno"> 2009</span>&#160;    LinearEquationSolver* pdeSys = mlPdeSys-&gt;_LinSolver[level];</div>
<div class="line"><a name="l02010"></a><span class="lineno"> 2010</span>&#160;    SparseMatrix*             JAC = pdeSys-&gt;_KK;</div>
<div class="line"><a name="l02011"></a><span class="lineno"> 2011</span>&#160;    NumericVector*           RES = pdeSys-&gt;_RES;</div>
<div class="line"><a name="l02012"></a><span class="lineno"> 2012</span>&#160; </div>
<div class="line"><a name="l02013"></a><span class="lineno"> 2013</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>  <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = msh-&gt;GetDimension();</div>
<div class="line"><a name="l02014"></a><span class="lineno"> 2014</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> max_size = <span class="keyword">static_cast&lt;</span> <span class="keywordtype">unsigned</span> <span class="keyword">&gt;</span>(ceil(pow(3, <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>)));</div>
<div class="line"><a name="l02015"></a><span class="lineno"> 2015</span>&#160; </div>
<div class="line"><a name="l02016"></a><span class="lineno"> 2016</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span>    iproc = msh-&gt;processor_id();</div>
<div class="line"><a name="l02017"></a><span class="lineno"> 2017</span>&#160;  </div>
<div class="line"><a name="l02018"></a><span class="lineno"> 2018</span>&#160;    </div>
<div class="line"><a name="l02019"></a><span class="lineno"> 2019</span>&#160;    constexpr <span class="keywordtype">bool</span> print_algebra_global = <span class="keyword">true</span>;</div>
<div class="line"><a name="l02020"></a><span class="lineno"> 2020</span>&#160;    constexpr <span class="keywordtype">bool</span> print_algebra_local = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02021"></a><span class="lineno"> 2021</span>&#160;  </div>
<div class="line"><a name="l02022"></a><span class="lineno"> 2022</span>&#160; </div>
<div class="line"><a name="l02023"></a><span class="lineno"> 2023</span>&#160; </div>
<div class="line"><a name="l02024"></a><span class="lineno"> 2024</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02025"></a><span class="lineno"> 2025</span>&#160;  CurrentElem &lt; double &gt; geom_element_iel(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, msh); </div>
<div class="line"><a name="l02026"></a><span class="lineno"> 2026</span>&#160;  </div>
<div class="line"><a name="l02027"></a><span class="lineno"> 2027</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> solType_coords = <a class="code" href="../../df/d21/FETypeEnum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a>;  <span class="comment">//biquadratic</span></div>
<div class="line"><a name="l02028"></a><span class="lineno"> 2028</span>&#160; </div>
<div class="line"><a name="l02029"></a><span class="lineno"> 2029</span>&#160;<span class="comment">//************** geometry (at dofs) *************************************</span></div>
<div class="line"><a name="l02030"></a><span class="lineno"> 2030</span>&#160;    vector &lt; vector &lt; double &gt; &gt; coords_at_dofs(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02031"></a><span class="lineno"> 2031</span>&#160;    vector &lt; vector &lt; double &gt; &gt; coords_at_dofs_bdry(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02032"></a><span class="lineno"> 2032</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><a name="l02033"></a><span class="lineno"> 2033</span>&#160;        coords_at_dofs[idim].reserve(max_size);</div>
<div class="line"><a name="l02034"></a><span class="lineno"> 2034</span>&#160;        coords_at_dofs_bdry[idim].reserve(max_size);</div>
<div class="line"><a name="l02035"></a><span class="lineno"> 2035</span>&#160;    }</div>
<div class="line"><a name="l02036"></a><span class="lineno"> 2036</span>&#160; </div>
<div class="line"><a name="l02037"></a><span class="lineno"> 2037</span>&#160;<span class="comment">//************** geometry (at quadrature points) *************************************</span></div>
<div class="line"><a name="l02038"></a><span class="lineno"> 2038</span>&#160;    vector &lt; double &gt; coord_at_qp(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02039"></a><span class="lineno"> 2039</span>&#160; </div>
<div class="line"><a name="l02040"></a><span class="lineno"> 2040</span>&#160; </div>
<div class="line"><a name="l02041"></a><span class="lineno"> 2041</span>&#160;<span class="comment">//************* shape functions (at dofs and quadrature points) **************************************</span></div>
<div class="line"><a name="l02042"></a><span class="lineno"> 2042</span>&#160;    <span class="keywordtype">double</span> weight_qp = 0.;      <span class="comment">// gauss point weight</span></div>
<div class="line"><a name="l02043"></a><span class="lineno"> 2043</span>&#160;    <span class="keywordtype">double</span> weight_qp_bdry = 0.; <span class="comment">// gauss point weight on the boundary</span></div>
<div class="line"><a name="l02044"></a><span class="lineno"> 2044</span>&#160; </div>
<div class="line"><a name="l02045"></a><span class="lineno"> 2045</span>&#160;    vector &lt; vector &lt; double &gt; &gt; phi_fe_qp(<a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><a name="l02046"></a><span class="lineno"> 2046</span>&#160;    vector &lt; vector &lt; double &gt; &gt; phi_x_fe_qp(<a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><a name="l02047"></a><span class="lineno"> 2047</span>&#160;    vector &lt; vector &lt; double &gt; &gt; phi_xx_fe_qp(<a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><a name="l02048"></a><span class="lineno"> 2048</span>&#160; </div>
<div class="line"><a name="l02049"></a><span class="lineno"> 2049</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><a name="l02050"></a><span class="lineno"> 2050</span>&#160;        phi_fe_qp[fe].reserve(max_size);</div>
<div class="line"><a name="l02051"></a><span class="lineno"> 2051</span>&#160;        phi_x_fe_qp[fe].reserve(max_size*<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02052"></a><span class="lineno"> 2052</span>&#160;        phi_xx_fe_qp[fe].reserve(max_size*(3*(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>-1)));</div>
<div class="line"><a name="l02053"></a><span class="lineno"> 2053</span>&#160;    }</div>
<div class="line"><a name="l02054"></a><span class="lineno"> 2054</span>&#160; </div>
<div class="line"><a name="l02055"></a><span class="lineno"> 2055</span>&#160;<span class="comment">//************* bdry shape functions (at dofs and quadrature points) **************************************</span></div>
<div class="line"><a name="l02056"></a><span class="lineno"> 2056</span>&#160;    vector &lt; vector &lt; double &gt; &gt; phi_fe_qp_bdry(<a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><a name="l02057"></a><span class="lineno"> 2057</span>&#160;    vector &lt; vector &lt; double &gt; &gt; phi_x_fe_qp_bdry(<a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>);</div>
<div class="line"><a name="l02058"></a><span class="lineno"> 2058</span>&#160; </div>
<div class="line"><a name="l02059"></a><span class="lineno"> 2059</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><a name="l02060"></a><span class="lineno"> 2060</span>&#160;        phi_fe_qp_bdry[fe].reserve(max_size);</div>
<div class="line"><a name="l02061"></a><span class="lineno"> 2061</span>&#160;        phi_x_fe_qp_bdry[fe].reserve(max_size * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02062"></a><span class="lineno"> 2062</span>&#160;    }</div>
<div class="line"><a name="l02063"></a><span class="lineno"> 2063</span>&#160; </div>
<div class="line"><a name="l02064"></a><span class="lineno"> 2064</span>&#160;<span class="comment">//********************* vol-at-bdry adjoint *******************</span></div>
<div class="line"><a name="l02065"></a><span class="lineno"> 2065</span>&#160;    vector &lt;double&gt; phi_adj_vol_at_bdry;</div>
<div class="line"><a name="l02066"></a><span class="lineno"> 2066</span>&#160;    phi_adj_vol_at_bdry.reserve(max_size);</div>
<div class="line"><a name="l02067"></a><span class="lineno"> 2067</span>&#160;    vector &lt;double&gt; phi_adj_x_vol_at_bdry;</div>
<div class="line"><a name="l02068"></a><span class="lineno"> 2068</span>&#160;    phi_adj_x_vol_at_bdry.reserve(max_size * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02069"></a><span class="lineno"> 2069</span>&#160;    vector &lt;double&gt; sol_adj_x_vol_at_bdry_gss(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02070"></a><span class="lineno"> 2070</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02071"></a><span class="lineno"> 2071</span>&#160;    </div>
<div class="line"><a name="l02072"></a><span class="lineno"> 2072</span>&#160;<span class="comment">//********************* vol-at-bdry adjoint_ext *******************</span></div>
<div class="line"><a name="l02073"></a><span class="lineno"> 2073</span>&#160;    vector &lt;double&gt; phi_adj_ext_vol_at_bdry;</div>
<div class="line"><a name="l02074"></a><span class="lineno"> 2074</span>&#160;    phi_adj_ext_vol_at_bdry.reserve(max_size);</div>
<div class="line"><a name="l02075"></a><span class="lineno"> 2075</span>&#160;    vector &lt;double&gt; phi_adj_ext_x_vol_at_bdry;</div>
<div class="line"><a name="l02076"></a><span class="lineno"> 2076</span>&#160;    phi_adj_ext_x_vol_at_bdry.reserve(max_size * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02077"></a><span class="lineno"> 2077</span>&#160;    vector &lt;double&gt; sol_adj_ext_x_vol_at_bdry_gss(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02078"></a><span class="lineno"> 2078</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02079"></a><span class="lineno"> 2079</span>&#160; </div>
<div class="line"><a name="l02080"></a><span class="lineno"> 2080</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_components_ctrl = 1;</div>
<div class="line"><a name="l02081"></a><span class="lineno"> 2081</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> first_loc_comp_ctrl = 0;</div>
<div class="line"><a name="l02082"></a><span class="lineno"> 2082</span>&#160; </div>
<div class="line"><a name="l02083"></a><span class="lineno"> 2083</span>&#160;  <span class="comment">//************** act flag ****************************   </span></div>
<div class="line"><a name="l02084"></a><span class="lineno"> 2084</span>&#160;    std::vector &lt;unsigned int&gt; solIndex_act_flag_sol(n_components_ctrl);</div>
<div class="line"><a name="l02085"></a><span class="lineno"> 2085</span>&#160; </div>
<div class="line"><a name="l02086"></a><span class="lineno"> 2086</span>&#160;  <a class="code" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#ad8765c4d3fe1216148aa932896951aee">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::store_act_flag_in_old</a>(mlPdeSys, ml_sol, sol, solIndex_act_flag_sol);</div>
<div class="line"><a name="l02087"></a><span class="lineno"> 2087</span>&#160;    </div>
<div class="line"><a name="l02088"></a><span class="lineno"> 2088</span>&#160; </div>
<div class="line"><a name="l02089"></a><span class="lineno"> 2089</span>&#160; </div>
<div class="line"><a name="l02090"></a><span class="lineno"> 2090</span>&#160;    <span class="comment">//********* variables for ineq constraints *****************</span></div>
<div class="line"><a name="l02091"></a><span class="lineno"> 2091</span>&#160;     std::vector &lt;std::vector &lt; <span class="keywordtype">double</span><span class="comment">/*int*/</span> &gt; &gt; sol_actflag(n_components_ctrl);    <span class="comment">//flag for active set</span></div>
<div class="line"><a name="l02092"></a><span class="lineno"> 2092</span>&#160;     std::vector &lt;std::vector &lt; double &gt; &gt; ctrl_lower(n_components_ctrl);  </div>
<div class="line"><a name="l02093"></a><span class="lineno"> 2093</span>&#160;     std::vector &lt;std::vector &lt; double &gt; &gt; ctrl_upper(n_components_ctrl);  </div>
<div class="line"><a name="l02094"></a><span class="lineno"> 2094</span>&#160;  </div>
<div class="line"><a name="l02095"></a><span class="lineno"> 2095</span>&#160;     <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; n_components_ctrl; kdim++) {</div>
<div class="line"><a name="l02096"></a><span class="lineno"> 2096</span>&#160;          sol_actflag[kdim].reserve(max_size);</div>
<div class="line"><a name="l02097"></a><span class="lineno"> 2097</span>&#160;           ctrl_lower[kdim].reserve(max_size);</div>
<div class="line"><a name="l02098"></a><span class="lineno"> 2098</span>&#160;           ctrl_upper[kdim].reserve(max_size);</div>
<div class="line"><a name="l02099"></a><span class="lineno"> 2099</span>&#160;     }</div>
<div class="line"><a name="l02100"></a><span class="lineno"> 2100</span>&#160;     </div>
<div class="line"><a name="l02101"></a><span class="lineno"> 2101</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">int</span> ineq_flag = <a class="code" href="../../de/d33/03__opt__system__inequalities_8hpp.html#a4b681eb6859b04812f86861be922c517">INEQ_FLAG</a>;</div>
<div class="line"><a name="l02102"></a><span class="lineno"> 2102</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> c_compl = <a class="code" href="../../de/d33/03__opt__system__inequalities_8hpp.html#a90aa72cdc79d3af2036fdbb588d8c1d8">C_COMPL</a>;</div>
<div class="line"><a name="l02103"></a><span class="lineno"> 2103</span>&#160;    <span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02104"></a><span class="lineno"> 2104</span>&#160; </div>
<div class="line"><a name="l02105"></a><span class="lineno"> 2105</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02106"></a><span class="lineno"> 2106</span>&#160;<span class="comment">//********* WHOLE SET OF VARIABLES ******************</span></div>
<div class="line"><a name="l02107"></a><span class="lineno"> 2107</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02108"></a><span class="lineno"> 2108</span>&#160;    <span class="keyword">enum</span> Pos_in_matrix {pos_mat_state = 0, pos_mat_ctrl, pos_mat_adj, pos_mat_adj_ext, pos_mat_mu}; <span class="comment">//these are known at compile-time </span></div>
<div class="line"><a name="l02110"></a><span class="lineno"> 2110</span>&#160;<span class="comment"></span> </div>
<div class="line"><a name="l02111"></a><span class="lineno"> 2111</span>&#160;                    </div>
<div class="line"><a name="l02112"></a><span class="lineno"> 2112</span>&#160;    assert(pos_mat_state   == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;state&quot;</span>));</div>
<div class="line"><a name="l02113"></a><span class="lineno"> 2113</span>&#160;    assert(pos_mat_ctrl    == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;control&quot;</span>));</div>
<div class="line"><a name="l02114"></a><span class="lineno"> 2114</span>&#160;    assert(pos_mat_adj     == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint&quot;</span>));</div>
<div class="line"><a name="l02115"></a><span class="lineno"> 2115</span>&#160;    assert(pos_mat_adj_ext == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint_ext&quot;</span>));</div>
<div class="line"><a name="l02116"></a><span class="lineno"> 2116</span>&#160;    assert(pos_mat_mu      == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;mu&quot;</span>));</div>
<div class="line"><a name="l02117"></a><span class="lineno"> 2117</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02118"></a><span class="lineno"> 2118</span>&#160; </div>
<div class="line"><a name="l02119"></a><span class="lineno"> 2119</span>&#160; </div>
<div class="line"><a name="l02120"></a><span class="lineno"> 2120</span>&#160; std::vector &lt; unsigned &gt;   pos_ctrl_in_mat(n_components_ctrl);  pos_ctrl_in_mat[0] = pos_mat_ctrl;</div>
<div class="line"><a name="l02121"></a><span class="lineno"> 2121</span>&#160; std::vector &lt; unsigned &gt;   pos_mu_in_mat(n_components_ctrl);    pos_mu_in_mat[0] = pos_mat_mu;</div>
<div class="line"><a name="l02122"></a><span class="lineno"> 2122</span>&#160;    </div>
<div class="line"><a name="l02123"></a><span class="lineno"> 2123</span>&#160;    </div>
<div class="line"><a name="l02124"></a><span class="lineno"> 2124</span>&#160;    </div>
<div class="line"><a name="l02125"></a><span class="lineno"> 2125</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> n_unknowns = mlPdeSys-&gt;GetSolPdeIndex().size();</div>
<div class="line"><a name="l02126"></a><span class="lineno"> 2126</span>&#160; </div>
<div class="line"><a name="l02127"></a><span class="lineno"> 2127</span>&#160;    <span class="keyword">enum</span> Sol_pos {pos_state=0, pos_ctrl, pos_adj, pos_adj_ext, pos_mu}; <span class="comment">//these are known at compile-time</span></div>
<div class="line"><a name="l02128"></a><span class="lineno"> 2128</span>&#160; </div>
<div class="line"><a name="l02129"></a><span class="lineno"> 2129</span>&#160;    assert(pos_state   == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;state&quot;</span>));</div>
<div class="line"><a name="l02130"></a><span class="lineno"> 2130</span>&#160;    assert(pos_ctrl    == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;control&quot;</span>));</div>
<div class="line"><a name="l02131"></a><span class="lineno"> 2131</span>&#160;    assert(pos_adj     == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint&quot;</span>));</div>
<div class="line"><a name="l02132"></a><span class="lineno"> 2132</span>&#160;    assert(pos_adj_ext == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;adjoint_ext&quot;</span>));</div>
<div class="line"><a name="l02133"></a><span class="lineno"> 2133</span>&#160;    assert(pos_mu      == mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;mu&quot;</span>));</div>
<div class="line"><a name="l02134"></a><span class="lineno"> 2134</span>&#160; </div>
<div class="line"><a name="l02135"></a><span class="lineno"> 2135</span>&#160; </div>
<div class="line"><a name="l02136"></a><span class="lineno"> 2136</span>&#160;    vector &lt; std::string &gt; Solname(n_unknowns);</div>
<div class="line"><a name="l02137"></a><span class="lineno"> 2137</span>&#160;    Solname[0] = <span class="stringliteral">&quot;state&quot;</span>;</div>
<div class="line"><a name="l02138"></a><span class="lineno"> 2138</span>&#160;    Solname[1] = <span class="stringliteral">&quot;control&quot;</span>;</div>
<div class="line"><a name="l02139"></a><span class="lineno"> 2139</span>&#160;    Solname[2] = <span class="stringliteral">&quot;adjoint&quot;</span>;</div>
<div class="line"><a name="l02140"></a><span class="lineno"> 2140</span>&#160;    Solname[3] = <span class="stringliteral">&quot;adjoint_ext&quot;</span>;</div>
<div class="line"><a name="l02141"></a><span class="lineno"> 2141</span>&#160;    Solname[4] = <span class="stringliteral">&quot;mu&quot;</span>;</div>
<div class="line"><a name="l02142"></a><span class="lineno"> 2142</span>&#160; </div>
<div class="line"><a name="l02143"></a><span class="lineno"> 2143</span>&#160;    vector &lt; unsigned &gt; SolPdeIndex(n_unknowns);</div>
<div class="line"><a name="l02144"></a><span class="lineno"> 2144</span>&#160;    vector &lt; unsigned &gt; SolIndex(n_unknowns);</div>
<div class="line"><a name="l02145"></a><span class="lineno"> 2145</span>&#160;    vector &lt; unsigned &gt; SolFEType(n_unknowns);</div>
<div class="line"><a name="l02146"></a><span class="lineno"> 2146</span>&#160; </div>
<div class="line"><a name="l02147"></a><span class="lineno"> 2147</span>&#160; </div>
<div class="line"><a name="l02148"></a><span class="lineno"> 2148</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ivar=0; ivar &lt; n_unknowns; ivar++) {</div>
<div class="line"><a name="l02149"></a><span class="lineno"> 2149</span>&#160;        SolPdeIndex[ivar] = mlPdeSys-&gt;GetSolPdeIndex(Solname[ivar].c_str());</div>
<div class="line"><a name="l02150"></a><span class="lineno"> 2150</span>&#160;        SolIndex[ivar]    = ml_sol-&gt;GetIndex        (Solname[ivar].c_str());</div>
<div class="line"><a name="l02151"></a><span class="lineno"> 2151</span>&#160;        SolFEType[ivar]   = ml_sol-&gt;GetSolutionType(SolIndex[ivar]);</div>
<div class="line"><a name="l02152"></a><span class="lineno"> 2152</span>&#160;    }</div>
<div class="line"><a name="l02153"></a><span class="lineno"> 2153</span>&#160; </div>
<div class="line"><a name="l02154"></a><span class="lineno"> 2154</span>&#160;    vector &lt; unsigned int &gt; Sol_n_el_dofs_Mat_vol(n_unknowns);</div>
<div class="line"><a name="l02155"></a><span class="lineno"> 2155</span>&#160; </div>
<div class="line"><a name="l02156"></a><span class="lineno"> 2156</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02157"></a><span class="lineno"> 2157</span>&#160;    <span class="comment">//----------- quantities (at dof objects) ------------------------------</span></div>
<div class="line"><a name="l02158"></a><span class="lineno"> 2158</span>&#160;    vector&lt; int &gt;       L2G_dofmap_Mat_AllVars;</div>
<div class="line"><a name="l02159"></a><span class="lineno"> 2159</span>&#160;    L2G_dofmap_Mat_AllVars.reserve( n_unknowns * max_size );</div>
<div class="line"><a name="l02160"></a><span class="lineno"> 2160</span>&#160;    vector &lt; vector &lt; int &gt; &gt;     L2G_dofmap_Mat(n_unknowns);</div>
<div class="line"><a name="l02161"></a><span class="lineno"> 2161</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; n_unknowns; i++) {</div>
<div class="line"><a name="l02162"></a><span class="lineno"> 2162</span>&#160;        L2G_dofmap_Mat[i].reserve(max_size);</div>
<div class="line"><a name="l02163"></a><span class="lineno"> 2163</span>&#160;    }</div>
<div class="line"><a name="l02164"></a><span class="lineno"> 2164</span>&#160;    </div>
<div class="line"><a name="l02165"></a><span class="lineno"> 2165</span>&#160;    vector &lt; vector &lt; double &gt; &gt;  sol_eldofs_Mat(n_unknowns);</div>
<div class="line"><a name="l02166"></a><span class="lineno"> 2166</span>&#160;    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> k = 0; k &lt; n_unknowns; k++) {        sol_eldofs_Mat[k].reserve(max_size);    }</div>
<div class="line"><a name="l02167"></a><span class="lineno"> 2167</span>&#160;    </div>
<div class="line"><a name="l02168"></a><span class="lineno"> 2168</span>&#160;    vector&lt; double &gt; Res;</div>
<div class="line"><a name="l02169"></a><span class="lineno"> 2169</span>&#160;    Res.reserve( n_unknowns * max_size);</div>
<div class="line"><a name="l02170"></a><span class="lineno"> 2170</span>&#160;    vector &lt; double &gt; Jac;</div>
<div class="line"><a name="l02171"></a><span class="lineno"> 2171</span>&#160;    Jac.reserve( n_unknowns * max_size * n_unknowns * max_size);</div>
<div class="line"><a name="l02172"></a><span class="lineno"> 2172</span>&#160; </div>
<div class="line"><a name="l02173"></a><span class="lineno"> 2173</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02174"></a><span class="lineno"> 2174</span>&#160;    <span class="comment">//------------ quantities (at quadrature points) ---------------------</span></div>
<div class="line"><a name="l02175"></a><span class="lineno"> 2175</span>&#160;    vector&lt;double&gt;        sol_qp(n_unknowns);</div>
<div class="line"><a name="l02176"></a><span class="lineno"> 2176</span>&#160;    vector&lt; vector&lt;double&gt; &gt; sol_grad_qp(n_unknowns);</div>
<div class="line"><a name="l02177"></a><span class="lineno"> 2177</span>&#160; </div>
<div class="line"><a name="l02178"></a><span class="lineno"> 2178</span>&#160;    std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><a name="l02179"></a><span class="lineno"> 2179</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><a name="l02180"></a><span class="lineno"> 2180</span>&#160;        sol_grad_qp[k].resize(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02181"></a><span class="lineno"> 2181</span>&#160;        std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.);</div>
<div class="line"><a name="l02182"></a><span class="lineno"> 2182</span>&#160;    }</div>
<div class="line"><a name="l02183"></a><span class="lineno"> 2183</span>&#160; </div>
<div class="line"><a name="l02184"></a><span class="lineno"> 2184</span>&#160; </div>
<div class="line"><a name="l02185"></a><span class="lineno"> 2185</span>&#160;<span class="comment">//********************* DATA ************************</span></div>
<div class="line"><a name="l02186"></a><span class="lineno"> 2186</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> u_des = ctrl::square_or_cube :: cost_functional_without_regularization::DesiredTargetVec()[0];</div>
<div class="line"><a name="l02187"></a><span class="lineno"> 2187</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a> = <a class="code" href="../../dc/d47/elliptic__nonlin__param_8hpp.html#ab6042dc7aa551272ad555cac7a27efca">ALPHA_CTRL_VOL</a>;</div>
<div class="line"><a name="l02188"></a><span class="lineno"> 2188</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> <a class="code" href="../../d8/d87/Conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a>  = <a class="code" href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a516ea8ebb0823e8c37feff8f4fe5afd1">BETA_CTRL_VOL</a>;</div>
<div class="line"><a name="l02189"></a><span class="lineno"> 2189</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty_strong_ctrl = 1.e30;</div>
<div class="line"><a name="l02190"></a><span class="lineno"> 2190</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty_strong_u =    1.e30;</div>
<div class="line"><a name="l02191"></a><span class="lineno"> 2191</span>&#160;    <span class="keyword">const</span> <span class="keywordtype">double</span> penalty_interface = 1.e10;         <span class="comment">//penalty for u = q and for weak continuity of adjoint Neumann</span></div>
<div class="line"><a name="l02192"></a><span class="lineno"> 2192</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02193"></a><span class="lineno"> 2193</span>&#160; </div>
<div class="line"><a name="l02194"></a><span class="lineno"> 2194</span>&#160;    RES-&gt;zero();</div>
<div class="line"><a name="l02195"></a><span class="lineno"> 2195</span>&#160;    <span class="keywordflow">if</span> (assembleMatrix)  JAC-&gt;zero();</div>
<div class="line"><a name="l02196"></a><span class="lineno"> 2196</span>&#160; </div>
<div class="line"><a name="l02197"></a><span class="lineno"> 2197</span>&#160; </div>
<div class="line"><a name="l02198"></a><span class="lineno"> 2198</span>&#160;    <span class="comment">// element loop: each process loops only on the elements that owns</span></div>
<div class="line"><a name="l02199"></a><span class="lineno"> 2199</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</div>
<div class="line"><a name="l02200"></a><span class="lineno"> 2200</span>&#160; </div>
<div class="line"><a name="l02201"></a><span class="lineno"> 2201</span>&#160;    geom_element_iel.set_coords_at_dofs_and_geom_type(iel, solType_coords);</div>
<div class="line"><a name="l02202"></a><span class="lineno"> 2202</span>&#160;        </div>
<div class="line"><a name="l02203"></a><span class="lineno"> 2203</span>&#160;    <span class="keywordtype">short</span> <span class="keywordtype">unsigned</span> ielGeom = geom_element_iel.geom_type();</div>
<div class="line"><a name="l02204"></a><span class="lineno"> 2204</span>&#160; </div>
<div class="line"><a name="l02205"></a><span class="lineno"> 2205</span>&#160;    <span class="keywordtype">int</span> group_flag         = msh-&gt;GetElementGroup(iel);</div>
<div class="line"><a name="l02206"></a><span class="lineno"> 2206</span>&#160;<span class="comment">//    std::cout &lt;&lt; &quot; ======= grp_flag === &quot; &lt;&lt; group_flag &lt;&lt; &quot; ================== &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02207"></a><span class="lineno"> 2207</span>&#160;<span class="comment">//     int face_no         = msh-&gt;GetElementFaceNumber(iel);</span></div>
<div class="line"><a name="l02208"></a><span class="lineno"> 2208</span>&#160;<span class="comment">//     std::cout &lt;&lt; &quot; ======= face# === &quot; &lt;&lt; face_no &lt;&lt; &quot; ================== &quot; &lt;&lt; std::endl;</span></div>
<div class="line"><a name="l02209"></a><span class="lineno"> 2209</span>&#160; </div>
<div class="line"><a name="l02210"></a><span class="lineno"> 2210</span>&#160;<span class="comment">//******************** GEOMETRY *********************</span></div>
<div class="line"><a name="l02211"></a><span class="lineno"> 2211</span>&#160;        <span class="keywordtype">unsigned</span> nDofx = msh-&gt;GetElementDofNumber(iel, solType_coords);    <span class="comment">// number of coordinate element dofs</span></div>
<div class="line"><a name="l02212"></a><span class="lineno"> 2212</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; i++)  coords_at_dofs[i].resize(nDofx);</div>
<div class="line"><a name="l02213"></a><span class="lineno"> 2213</span>&#160;        <span class="comment">// local storage of coordinates</span></div>
<div class="line"><a name="l02214"></a><span class="lineno"> 2214</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx; i++) {</div>
<div class="line"><a name="l02215"></a><span class="lineno"> 2215</span>&#160;            <span class="keywordtype">unsigned</span> xDof  = msh-&gt;GetSolutionDof(i, iel, solType_coords);  <span class="comment">// global to global mapping between coordinates node and coordinate dof</span></div>
<div class="line"><a name="l02216"></a><span class="lineno"> 2216</span>&#160; </div>
<div class="line"><a name="l02217"></a><span class="lineno"> 2217</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> jdim = 0; jdim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; jdim++) {</div>
<div class="line"><a name="l02218"></a><span class="lineno"> 2218</span>&#160;                coords_at_dofs[jdim][i] = (*msh-&gt;_topology-&gt;_Sol[jdim])(xDof);      <span class="comment">// global extraction and local storage for the element coordinates</span></div>
<div class="line"><a name="l02219"></a><span class="lineno"> 2219</span>&#160;            }</div>
<div class="line"><a name="l02220"></a><span class="lineno"> 2220</span>&#160;        }</div>
<div class="line"><a name="l02221"></a><span class="lineno"> 2221</span>&#160; </div>
<div class="line"><a name="l02222"></a><span class="lineno"> 2222</span>&#160;        <span class="comment">// elem average point</span></div>
<div class="line"><a name="l02223"></a><span class="lineno"> 2223</span>&#160;        vector &lt; double &gt; elem_center(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>);</div>
<div class="line"><a name="l02224"></a><span class="lineno"> 2224</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><a name="l02225"></a><span class="lineno"> 2225</span>&#160;            elem_center[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = 0.;</div>
<div class="line"><a name="l02226"></a><span class="lineno"> 2226</span>&#160;        }</div>
<div class="line"><a name="l02227"></a><span class="lineno"> 2227</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><a name="l02228"></a><span class="lineno"> 2228</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDofx; i++) {</div>
<div class="line"><a name="l02229"></a><span class="lineno"> 2229</span>&#160;                elem_center[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] += coords_at_dofs[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>][i];</div>
<div class="line"><a name="l02230"></a><span class="lineno"> 2230</span>&#160;            }</div>
<div class="line"><a name="l02231"></a><span class="lineno"> 2231</span>&#160;        }</div>
<div class="line"><a name="l02232"></a><span class="lineno"> 2232</span>&#160; </div>
<div class="line"><a name="l02233"></a><span class="lineno"> 2233</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><a name="l02234"></a><span class="lineno"> 2234</span>&#160;            elem_center[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = elem_center[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]/nDofx;</div>
<div class="line"><a name="l02235"></a><span class="lineno"> 2235</span>&#160;        }</div>
<div class="line"><a name="l02236"></a><span class="lineno"> 2236</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02237"></a><span class="lineno"> 2237</span>&#160; </div>
<div class="line"><a name="l02238"></a><span class="lineno"> 2238</span>&#160;<span class="comment">//****** set target domain flag *********************</span></div>
<div class="line"><a name="l02239"></a><span class="lineno"> 2239</span>&#160;        <span class="keywordtype">int</span> target_flag = 0;</div>
<div class="line"><a name="l02240"></a><span class="lineno"> 2240</span>&#160;        target_flag = <a class="code" href="../../dc/d47/elliptic__nonlin__param_8hpp.html#ac26c656f6cba791120e68b91d327f1f0">ctrl::square_or_cube :: cost_functional_without_regularization::ElementTargetFlag</a>(elem_center);</div>
<div class="line"><a name="l02241"></a><span class="lineno"> 2241</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02242"></a><span class="lineno"> 2242</span>&#160; </div>
<div class="line"><a name="l02243"></a><span class="lineno"> 2243</span>&#160;        <span class="comment">//all vars###################################################################</span></div>
<div class="line"><a name="l02244"></a><span class="lineno"> 2244</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><a name="l02245"></a><span class="lineno"> 2245</span>&#160;            <span class="keywordtype">unsigned</span>  ndofs_unk = msh-&gt;GetElementDofNumber(iel, SolFEType[k]);</div>
<div class="line"><a name="l02246"></a><span class="lineno"> 2246</span>&#160;            Sol_n_el_dofs_Mat_vol[k] = ndofs_unk;</div>
<div class="line"><a name="l02247"></a><span class="lineno"> 2247</span>&#160;            sol_eldofs_Mat[k].resize(ndofs_unk);</div>
<div class="line"><a name="l02248"></a><span class="lineno"> 2248</span>&#160;            L2G_dofmap_Mat[k].resize(ndofs_unk);</div>
<div class="line"><a name="l02249"></a><span class="lineno"> 2249</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; ndofs_unk; i++) {</div>
<div class="line"><a name="l02250"></a><span class="lineno"> 2250</span>&#160;                <span class="keywordtype">unsigned</span> solDof = msh-&gt;GetSolutionDof(i, iel, SolFEType[k]);                        <span class="comment">// global to global mapping between solution node and solution dof // via local to global solution node</span></div>
<div class="line"><a name="l02251"></a><span class="lineno"> 2251</span>&#160;                sol_eldofs_Mat[k][i] = (*sol-&gt;_Sol[SolIndex[k]])(solDof);                            <span class="comment">// global extraction and local storage for the solution</span></div>
<div class="line"><a name="l02252"></a><span class="lineno"> 2252</span>&#160;                L2G_dofmap_Mat[k][i] = pdeSys-&gt;GetSystemDof(SolIndex[k], SolPdeIndex[k], i, iel);    <span class="comment">// global to global mapping between solution node and pdeSys dof</span></div>
<div class="line"><a name="l02253"></a><span class="lineno"> 2253</span>&#160;            }</div>
<div class="line"><a name="l02254"></a><span class="lineno"> 2254</span>&#160;        }</div>
<div class="line"><a name="l02255"></a><span class="lineno"> 2255</span>&#160;        <span class="comment">//all vars###################################################################</span></div>
<div class="line"><a name="l02256"></a><span class="lineno"> 2256</span>&#160; </div>
<div class="line"><a name="l02257"></a><span class="lineno"> 2257</span>&#160;        <a class="code" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#a53fcde6a8cb427b5da69375d0fe7cd14">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::update_active_set_flag_for_current_nonlinear_iteration</a></div>
<div class="line"><a name="l02258"></a><span class="lineno"> 2258</span>&#160;         (msh, sol, iel, coords_at_dofs, sol_eldofs_Mat, Sol_n_el_dofs_Mat_vol, </div>
<div class="line"><a name="l02259"></a><span class="lineno"> 2259</span>&#160;          c_compl, </div>
<div class="line"><a name="l02260"></a><span class="lineno"> 2260</span>&#160;          pos_mu_in_mat,</div>
<div class="line"><a name="l02261"></a><span class="lineno"> 2261</span>&#160;          pos_ctrl_in_mat, </div>
<div class="line"><a name="l02262"></a><span class="lineno"> 2262</span>&#160;          solIndex_act_flag_sol,</div>
<div class="line"><a name="l02263"></a><span class="lineno"> 2263</span>&#160;          ctrl_lower,</div>
<div class="line"><a name="l02264"></a><span class="lineno"> 2264</span>&#160;          ctrl_upper, </div>
<div class="line"><a name="l02265"></a><span class="lineno"> 2265</span>&#160;          sol_actflag);</div>
<div class="line"><a name="l02266"></a><span class="lineno"> 2266</span>&#160; </div>
<div class="line"><a name="l02267"></a><span class="lineno"> 2267</span>&#160; </div>
<div class="line"><a name="l02268"></a><span class="lineno"> 2268</span>&#160;<span class="comment">//******************** ALL VARS *********************</span></div>
<div class="line"><a name="l02269"></a><span class="lineno"> 2269</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> nDof_max          = <a class="code" href="../../d2/dae/classfemus_1_1ElementJacRes.html#adaae99208cf2f2f60e867d6409035f1d">ElementJacRes&lt;double&gt;::compute_max_n_dofs</a>(Sol_n_el_dofs_Mat_vol);</div>
<div class="line"><a name="l02270"></a><span class="lineno"> 2270</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> sum_Sol_n_el_dofs = <a class="code" href="../../d2/dae/classfemus_1_1ElementJacRes.html#af9f782d3aa6f1bcee95c7eb1af72b8ec">ElementJacRes&lt;double&gt;::compute_sum_n_dofs</a>(Sol_n_el_dofs_Mat_vol);</div>
<div class="line"><a name="l02271"></a><span class="lineno"> 2271</span>&#160;    </div>
<div class="line"><a name="l02272"></a><span class="lineno"> 2272</span>&#160;        </div>
<div class="line"><a name="l02273"></a><span class="lineno"> 2273</span>&#160;        Res.resize(sum_Sol_n_el_dofs);</div>
<div class="line"><a name="l02274"></a><span class="lineno"> 2274</span>&#160;        std::fill(Res.begin(), Res.end(), 0.);</div>
<div class="line"><a name="l02275"></a><span class="lineno"> 2275</span>&#160;        Jac.resize(sum_Sol_n_el_dofs * sum_Sol_n_el_dofs);</div>
<div class="line"><a name="l02276"></a><span class="lineno"> 2276</span>&#160;        std::fill(Jac.begin(), Jac.end(), 0.);</div>
<div class="line"><a name="l02277"></a><span class="lineno"> 2277</span>&#160; </div>
<div class="line"><a name="l02278"></a><span class="lineno"> 2278</span>&#160;        L2G_dofmap_Mat_AllVars.resize(0);</div>
<div class="line"><a name="l02279"></a><span class="lineno"> 2279</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++)     L2G_dofmap_Mat_AllVars.insert(L2G_dofmap_Mat_AllVars.end(),L2G_dofmap_Mat[k].begin(),L2G_dofmap_Mat[k].end());</div>
<div class="line"><a name="l02280"></a><span class="lineno"> 2280</span>&#160;<span class="comment">//***************************************************</span></div>
<div class="line"><a name="l02281"></a><span class="lineno"> 2281</span>&#160; </div>
<div class="line"><a name="l02282"></a><span class="lineno"> 2282</span>&#160;        <span class="keyword">const</span> <span class="keywordtype">int</span> n_faces = msh-&gt;GetElementFaceNumber(iel);</div>
<div class="line"><a name="l02283"></a><span class="lineno"> 2283</span>&#160;        </div>
<div class="line"><a name="l02284"></a><span class="lineno"> 2284</span>&#160;        <span class="comment">//setting up control boundary region - BEGIN ***************************</span></div>
<div class="line"><a name="l02285"></a><span class="lineno"> 2285</span>&#160;        std::vector &lt;bool&gt; interface_elem_flag(n_faces);      <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; n_faces; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) interface_elem_flag[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] = <span class="keyword">false</span>;</div>
<div class="line"><a name="l02286"></a><span class="lineno"> 2286</span>&#160;        std::vector &lt;unsigned int&gt; is_dof_on_Gamma_c(Sol_n_el_dofs_Mat_vol[pos_state]);   </div>
<div class="line"><a name="l02287"></a><span class="lineno"> 2287</span>&#160;        std::fill(is_dof_on_Gamma_c.begin(), is_dof_on_Gamma_c.end(), 0);</div>
<div class="line"><a name="l02288"></a><span class="lineno"> 2288</span>&#160; </div>
<div class="line"><a name="l02289"></a><span class="lineno"> 2289</span>&#160;     <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface = 0; jface &lt; n_faces; jface++) {</div>
<div class="line"><a name="l02290"></a><span class="lineno"> 2290</span>&#160;            </div>
<div class="line"><a name="l02291"></a><span class="lineno"> 2291</span>&#160;       geom_element_iel.set_coords_at_dofs_bdry_3d(iel, jface, solType_coords);</div>
<div class="line"><a name="l02292"></a><span class="lineno"> 2292</span>&#160; </div>
<div class="line"><a name="l02293"></a><span class="lineno"> 2293</span>&#160;       geom_element_iel.set_elem_center_bdry_3d();</div>
<div class="line"><a name="l02294"></a><span class="lineno"> 2294</span>&#160; </div>
<div class="line"><a name="l02295"></a><span class="lineno"> 2295</span>&#160;       <span class="comment">//************** later try to avoid repeating this - BEGIN</span></div>
<div class="line"><a name="l02296"></a><span class="lineno"> 2296</span>&#160;          <a class="code" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">lifting_external::compute_coordinates_bdry_one_face</a>(coords_at_dofs_bdry, solType_coords, iel, jface, msh);</div>
<div class="line"><a name="l02297"></a><span class="lineno"> 2297</span>&#160;          </div>
<div class="line"><a name="l02298"></a><span class="lineno"> 2298</span>&#160;            <span class="keywordtype">unsigned</span> nDofu_bdry    = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_state]);</div>
<div class="line"><a name="l02299"></a><span class="lineno"> 2299</span>&#160;            <span class="keywordtype">unsigned</span> nDofctrl_bdry = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_ctrl]);</div>
<div class="line"><a name="l02300"></a><span class="lineno"> 2300</span>&#160;            <span class="keywordflow">if</span> (nDofu_bdry != nDofctrl_bdry) {</div>
<div class="line"><a name="l02301"></a><span class="lineno"> 2301</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;State and control need to have the same FE space&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02302"></a><span class="lineno"> 2302</span>&#160;                abort();</div>
<div class="line"><a name="l02303"></a><span class="lineno"> 2303</span>&#160;            }</div>
<div class="line"><a name="l02304"></a><span class="lineno"> 2304</span>&#160;         <span class="comment">//************** later try to avoid repeating this - END</span></div>
<div class="line"><a name="l02305"></a><span class="lineno"> 2305</span>&#160;                    </div>
<div class="line"><a name="l02306"></a><span class="lineno"> 2306</span>&#160;           interface_elem_flag[jface] = <a class="code" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a86be6466c20a785bfa63545d1536fae9">lifting_external::find_control_boundary_nodes</a>(is_dof_on_Gamma_c, geom_element_iel.get_elem_center_bdry_3d(), nDofu_bdry, iel, jface, msh);</div>
<div class="line"><a name="l02307"></a><span class="lineno"> 2307</span>&#160;    </div>
<div class="line"><a name="l02308"></a><span class="lineno"> 2308</span>&#160;        }</div>
<div class="line"><a name="l02309"></a><span class="lineno"> 2309</span>&#160;       <span class="comment">//setting up control boundary region - END ***************************</span></div>
<div class="line"><a name="l02310"></a><span class="lineno"> 2310</span>&#160;       </div>
<div class="line"><a name="l02311"></a><span class="lineno"> 2311</span>&#160;        </div>
<div class="line"><a name="l02312"></a><span class="lineno"> 2312</span>&#160;        </div>
<div class="line"><a name="l02313"></a><span class="lineno"> 2313</span>&#160;        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> jface=0; jface &lt; msh-&gt;GetElementFaceNumber(iel); jface++) {</div>
<div class="line"><a name="l02314"></a><span class="lineno"> 2314</span>&#160; </div>
<div class="line"><a name="l02315"></a><span class="lineno"> 2315</span>&#160; </div>
<div class="line"><a name="l02316"></a><span class="lineno"> 2316</span>&#160;            </div>
<div class="line"><a name="l02317"></a><span class="lineno"> 2317</span>&#160;     <a class="code" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">lifting_external::compute_coordinates_bdry_one_face</a>(coords_at_dofs_bdry, solType_coords, iel, jface, msh);</div>
<div class="line"><a name="l02318"></a><span class="lineno"> 2318</span>&#160; </div>
<div class="line"><a name="l02319"></a><span class="lineno"> 2319</span>&#160;            <span class="keywordtype">unsigned</span> nDofu_bdry    = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_state]);</div>
<div class="line"><a name="l02320"></a><span class="lineno"> 2320</span>&#160;            <span class="keywordtype">unsigned</span> nDofctrl_bdry = msh-&gt;GetElementFaceDofNumber(iel,jface,SolFEType[pos_ctrl]);</div>
<div class="line"><a name="l02321"></a><span class="lineno"> 2321</span>&#160;            <span class="keywordflow">if</span> (nDofu_bdry != nDofctrl_bdry) {</div>
<div class="line"><a name="l02322"></a><span class="lineno"> 2322</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot;State and control need to have the same FE space&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02323"></a><span class="lineno"> 2323</span>&#160;                abort();</div>
<div class="line"><a name="l02324"></a><span class="lineno"> 2324</span>&#160;            }</div>
<div class="line"><a name="l02325"></a><span class="lineno"> 2325</span>&#160;            </div>
<div class="line"><a name="l02326"></a><span class="lineno"> 2326</span>&#160;    </div>
<div class="line"><a name="l02327"></a><span class="lineno"> 2327</span>&#160; </div>
<div class="line"><a name="l02328"></a><span class="lineno"> 2328</span>&#160;    <span class="keywordflow">if</span> (interface_elem_flag[jface] == <span class="keyword">true</span>) {</div>
<div class="line"><a name="l02329"></a><span class="lineno"> 2329</span>&#160; </div>
<div class="line"><a name="l02330"></a><span class="lineno"> 2330</span>&#160;              std::vector&lt;double&gt; normal_qp(<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>, 0.);</div>
<div class="line"><a name="l02331"></a><span class="lineno"> 2331</span>&#160;              </div>
<div class="line"><a name="l02332"></a><span class="lineno"> 2332</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">unsigned</span> felt_bdry = msh-&gt;GetElementFaceType(iel, jface);</div>
<div class="line"><a name="l02333"></a><span class="lineno"> 2333</span>&#160;              </div>
<div class="line"><a name="l02334"></a><span class="lineno"> 2334</span>&#160;          <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> ig_bdry=0; ig_bdry &lt; msh-&gt;_finiteElement[felt_bdry][SolFEType[pos_ctrl]]-&gt;GetGaussPointNumber(); ig_bdry++) {</div>
<div class="line"><a name="l02335"></a><span class="lineno"> 2335</span>&#160; </div>
<div class="line"><a name="l02336"></a><span class="lineno"> 2336</span>&#160;                    <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><a name="l02337"></a><span class="lineno"> 2337</span>&#160;                    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><a name="l02338"></a><span class="lineno"> 2338</span>&#160;                        msh-&gt;_finiteElement[felt_bdry][fe]-&gt;JacobianSur(coords_at_dofs_bdry, ig_bdry, weight_qp_bdry, phi_fe_qp_bdry[fe], phi_x_fe_qp_bdry[fe], normal_qp);</div>
<div class="line"><a name="l02339"></a><span class="lineno"> 2339</span>&#160;                    }</div>
<div class="line"><a name="l02340"></a><span class="lineno"> 2340</span>&#160;                    <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN</span></div>
<div class="line"><a name="l02341"></a><span class="lineno"> 2341</span>&#160;                    msh-&gt;_finiteElement[felt_bdry][solType_coords]-&gt;JacobianSur(coords_at_dofs_bdry, ig_bdry, weight_qp_bdry, phi_fe_qp_bdry[solType_coords], phi_x_fe_qp_bdry[solType_coords], normal_qp);</div>
<div class="line"><a name="l02342"></a><span class="lineno"> 2342</span>&#160; </div>
<div class="line"><a name="l02343"></a><span class="lineno"> 2343</span>&#160;                    <span class="keywordflow">if</span> (ielGeom != <a class="code" href="../../d6/d09/GeomElTypeEnum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c">QUAD</a>) {</div>
<div class="line"><a name="l02344"></a><span class="lineno"> 2344</span>&#160;                        std::cout &lt;&lt; <span class="stringliteral">&quot;fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem not implemented&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l02345"></a><span class="lineno"> 2345</span>&#160;                        abort();</div>
<div class="line"><a name="l02346"></a><span class="lineno"> 2346</span>&#160;                    }</div>
<div class="line"><a name="l02347"></a><span class="lineno"> 2347</span>&#160;                    </div>
<div class="line"><a name="l02348"></a><span class="lineno"> 2348</span>&#160;                    msh-&gt;_finiteElement[ielGeom][SolFEType[pos_adj]]-&gt;fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem(coords_at_dofs, coords_at_dofs_bdry, jface, ig_bdry, phi_adj_vol_at_bdry, phi_adj_x_vol_at_bdry);</div>
<div class="line"><a name="l02349"></a><span class="lineno"> 2349</span>&#160;                    msh-&gt;_finiteElement[ielGeom][SolFEType[pos_adj_ext]]-&gt;fill_volume_shape_funcs_at_boundary_quadrature_points_on_current_elem(coords_at_dofs, coords_at_dofs_bdry, jface, ig_bdry, phi_adj_ext_vol_at_bdry, phi_adj_ext_x_vol_at_bdry);</div>
<div class="line"><a name="l02350"></a><span class="lineno"> 2350</span>&#160; </div>
<div class="line"><a name="l02351"></a><span class="lineno"> 2351</span>&#160;                    </div>
<div class="line"><a name="l02352"></a><span class="lineno"> 2352</span>&#160;<span class="comment">//=============== grad dot n for residual =========================================</span></div>
<div class="line"><a name="l02353"></a><span class="lineno"> 2353</span>&#160;<span class="comment">//     compute gauss quantities on the boundary through VOLUME interpolation</span></div>
<div class="line"><a name="l02354"></a><span class="lineno"> 2354</span>&#160;                    std::fill(sol_adj_x_vol_at_bdry_gss.begin(), sol_adj_x_vol_at_bdry_gss.end(), 0.);</div>
<div class="line"><a name="l02355"></a><span class="lineno"> 2355</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv = 0; iv &lt; Sol_n_el_dofs_Mat_vol[pos_adj]; iv++)  {</div>
<div class="line"><a name="l02356"></a><span class="lineno"> 2356</span>&#160; </div>
<div class="line"><a name="l02357"></a><span class="lineno"> 2357</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l02358"></a><span class="lineno"> 2358</span>&#160;                            sol_adj_x_vol_at_bdry_gss[d] += sol_eldofs_Mat[pos_adj][iv] * phi_adj_x_vol_at_bdry[iv * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];<span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><a name="l02359"></a><span class="lineno"> 2359</span>&#160;                        }</div>
<div class="line"><a name="l02360"></a><span class="lineno"> 2360</span>&#160;                    }</div>
<div class="line"><a name="l02361"></a><span class="lineno"> 2361</span>&#160; </div>
<div class="line"><a name="l02362"></a><span class="lineno"> 2362</span>&#160;                    <span class="keywordtype">double</span> grad_adj_dot_n_res = 0.;</div>
<div class="line"><a name="l02363"></a><span class="lineno"> 2363</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l02364"></a><span class="lineno"> 2364</span>&#160;                        grad_adj_dot_n_res += sol_adj_x_vol_at_bdry_gss[d] * normal_qp[d];</div>
<div class="line"><a name="l02365"></a><span class="lineno"> 2365</span>&#160;                    }</div>
<div class="line"><a name="l02366"></a><span class="lineno"> 2366</span>&#160;<span class="comment">//=============== grad dot n  for residual =========================================</span></div>
<div class="line"><a name="l02367"></a><span class="lineno"> 2367</span>&#160; </div>
<div class="line"><a name="l02368"></a><span class="lineno"> 2368</span>&#160;<span class="comment">//=============== grad dot n for residual =========================================</span></div>
<div class="line"><a name="l02369"></a><span class="lineno"> 2369</span>&#160;<span class="comment">//     compute gauss quantities on the boundary through VOLUME interpolation</span></div>
<div class="line"><a name="l02370"></a><span class="lineno"> 2370</span>&#160;                    std::fill(sol_adj_ext_x_vol_at_bdry_gss.begin(), sol_adj_ext_x_vol_at_bdry_gss.end(), 0.);</div>
<div class="line"><a name="l02371"></a><span class="lineno"> 2371</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iv = 0; iv &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext]; iv++)  {</div>
<div class="line"><a name="l02372"></a><span class="lineno"> 2372</span>&#160; </div>
<div class="line"><a name="l02373"></a><span class="lineno"> 2373</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">int</span> d = 0; d &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l02374"></a><span class="lineno"> 2374</span>&#160;                            sol_adj_ext_x_vol_at_bdry_gss[d] += sol_eldofs_Mat[pos_adj_ext][iv] * phi_adj_ext_x_vol_at_bdry[iv * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];<span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><a name="l02375"></a><span class="lineno"> 2375</span>&#160;                        }</div>
<div class="line"><a name="l02376"></a><span class="lineno"> 2376</span>&#160;                    }</div>
<div class="line"><a name="l02377"></a><span class="lineno"> 2377</span>&#160; </div>
<div class="line"><a name="l02378"></a><span class="lineno"> 2378</span>&#160;                    <span class="keywordtype">double</span> grad_adj_ext_dot_n_res = 0.;</div>
<div class="line"><a name="l02379"></a><span class="lineno"> 2379</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l02380"></a><span class="lineno"> 2380</span>&#160;                        grad_adj_ext_dot_n_res += sol_adj_ext_x_vol_at_bdry_gss[d] * normal_qp[d];</div>
<div class="line"><a name="l02381"></a><span class="lineno"> 2381</span>&#160;                    }</div>
<div class="line"><a name="l02382"></a><span class="lineno"> 2382</span>&#160;<span class="comment">//=============== grad dot n  for residual =========================================</span></div>
<div class="line"><a name="l02383"></a><span class="lineno"> 2383</span>&#160; </div>
<div class="line"><a name="l02384"></a><span class="lineno"> 2384</span>&#160; </div>
<div class="line"><a name="l02385"></a><span class="lineno"> 2385</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_bdry = 0; i_bdry &lt; nDofu_bdry; i_bdry++)  {</div>
<div class="line"><a name="l02386"></a><span class="lineno"> 2386</span>&#160;                        <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, i_bdry);</div>
<div class="line"><a name="l02387"></a><span class="lineno"> 2387</span>&#160; </div>
<div class="line"><a name="l02388"></a><span class="lineno"> 2388</span>&#160;<span class="comment">//============ Bdry Residuals - BEGIN ==================</span></div>
<div class="line"><a name="l02389"></a><span class="lineno"> 2389</span>&#160; </div>
<div class="line"><a name="l02390"></a><span class="lineno"> 2390</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_state, i_vol)  ]  +=  -  weight_qp_bdry *  ( grad_adj_dot_n_res * phi_fe_qp_bdry[SolFEType[pos_state]][i_bdry] );</div>
<div class="line"><a name="l02391"></a><span class="lineno"> 2391</span>&#160; </div>
<div class="line"><a name="l02392"></a><span class="lineno"> 2392</span>&#160;                        </div>
<div class="line"><a name="l02393"></a><span class="lineno"> 2393</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_ctrl, i_vol)  ]  +=  -  weight_qp_bdry *  ( grad_adj_ext_dot_n_res * phi_fe_qp_bdry[SolFEType[pos_ctrl]][i_bdry] );</div>
<div class="line"><a name="l02395"></a><span class="lineno"> 2395</span>&#160;                        </div>
<div class="line"><a name="l02396"></a><span class="lineno"> 2396</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> gamma_c_u_minus_q_pos = pos_adj<span class="comment">/*pos_state*/</span>;</div>
<div class="line"><a name="l02397"></a><span class="lineno"> 2397</span>&#160;                        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> gamma_c_Neum_adj_continuity_pos = pos_adj_ext<span class="comment">/*pos_ctrl*/</span>;</div>
<div class="line"><a name="l02398"></a><span class="lineno"> 2398</span>&#160;                        </div>
<div class="line"><a name="l02399"></a><span class="lineno"> 2399</span>&#160;<span class="comment">//                         if ( group_flag == GROUP_INTERNAL ) Res[ assemble_jacobian&lt;double,double&gt;::res_row_index(Sol_n_el_dofs_Mat_vol, pos_adj, i_vol)   ]  +=  -  penalty_interface * ( sol_eldofs_Mat[pos_state][i_vol] - sol_eldofs_Mat[pos_ctrl][i_vol] ) ;    // u = q</span></div>
<div class="line"><a name="l02400"></a><span class="lineno"> 2400</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_u_minus_q_pos, i_vol)  ] +=  -  <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface * ( sol_eldofs_Mat[pos_state][i_vol]);    <span class="comment">// u</span></div>
<div class="line"><a name="l02401"></a><span class="lineno"> 2401</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_u_minus_q_pos, i_vol)  ] +=  -  <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface * ( - sol_eldofs_Mat[pos_ctrl][i_vol]);    <span class="comment">// - q</span></div>
<div class="line"><a name="l02402"></a><span class="lineno"> 2402</span>&#160;                        </div>
<div class="line"><a name="l02403"></a><span class="lineno"> 2403</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_Neum_adj_continuity_pos, i_vol)   ]  +=  - <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface *  weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * ( <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">_neumann_adjoint_continuity_sign</a> ) * grad_adj_dot_n_res ;</div>
<div class="line"><a name="l02404"></a><span class="lineno"> 2404</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, gamma_c_Neum_adj_continuity_pos, i_vol)   ]  +=  - <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface *  weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * (  grad_adj_ext_dot_n_res ) ;</div>
<div class="line"><a name="l02405"></a><span class="lineno"> 2405</span>&#160;<span class="comment">//============ Bdry Residuals - END ==================</span></div>
<div class="line"><a name="l02406"></a><span class="lineno"> 2406</span>&#160; </div>
<div class="line"><a name="l02407"></a><span class="lineno"> 2407</span>&#160;<span class="comment">//============ Bdry Jacobians on Bdry - BEGIN ==================</span></div>
<div class="line"><a name="l02408"></a><span class="lineno"> 2408</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> j_bdry=0; j_bdry &lt; nDofu_bdry; j_bdry ++) {</div>
<div class="line"><a name="l02409"></a><span class="lineno"> 2409</span>&#160;                            <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> j_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, j_bdry);</div>
<div class="line"><a name="l02410"></a><span class="lineno"> 2410</span>&#160; </div>
<div class="line"><a name="l02411"></a><span class="lineno"> 2411</span>&#160;<span class="comment">//============ u = q =============================</span></div>
<div class="line"><a name="l02412"></a><span class="lineno"> 2412</span>&#160;                            <span class="keywordflow">if</span> (i_vol == j_vol)  {</div>
<div class="line"><a name="l02413"></a><span class="lineno"> 2413</span>&#160;                                <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_u_minus_q_pos, pos_state, i_vol, j_vol) ]  += <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface *  ( 1.);</div>
<div class="line"><a name="l02414"></a><span class="lineno"> 2414</span>&#160;                                <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_u_minus_q_pos, pos_ctrl, i_vol, j_vol) ]   += <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">_u_minus_q_strong</a> * penalty_interface *  (-1.);</div>
<div class="line"><a name="l02415"></a><span class="lineno"> 2415</span>&#160;                            }</div>
<div class="line"><a name="l02416"></a><span class="lineno"> 2416</span>&#160;<span class="comment">//============ u = q =============================</span></div>
<div class="line"><a name="l02417"></a><span class="lineno"> 2417</span>&#160; </div>
<div class="line"><a name="l02418"></a><span class="lineno"> 2418</span>&#160;                        } <span class="comment">//end j_bdry</span></div>
<div class="line"><a name="l02419"></a><span class="lineno"> 2419</span>&#160;<span class="comment">//============ Bdry Jacobians on Bdry - END ==================</span></div>
<div class="line"><a name="l02420"></a><span class="lineno"> 2420</span>&#160; </div>
<div class="line"><a name="l02421"></a><span class="lineno"> 2421</span>&#160;<span class="comment">//============ Bdry Jacobians on Volume - BEGIN ==================</span></div>
<div class="line"><a name="l02422"></a><span class="lineno"> 2422</span>&#160;<span class="comment">//===================loop over j in the VOLUME (while i is in the boundary)</span></div>
<div class="line"><a name="l02423"></a><span class="lineno"> 2423</span>&#160;                        <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>=0; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof_max; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ++) {</div>
<div class="line"><a name="l02424"></a><span class="lineno"> 2424</span>&#160; </div>
<div class="line"><a name="l02425"></a><span class="lineno"> 2425</span>&#160;<span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><a name="l02426"></a><span class="lineno"> 2426</span>&#160;                            <span class="keywordtype">double</span> grad_adj_dot_n_mat = 0.;</div>
<div class="line"><a name="l02427"></a><span class="lineno"> 2427</span>&#160;                            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0; d&lt;<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l02428"></a><span class="lineno"> 2428</span>&#160;                                grad_adj_dot_n_mat += phi_adj_x_vol_at_bdry[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] * normal_qp[d];  <span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><a name="l02429"></a><span class="lineno"> 2429</span>&#160;                            }</div>
<div class="line"><a name="l02430"></a><span class="lineno"> 2430</span>&#160;<span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><a name="l02431"></a><span class="lineno"> 2431</span>&#160; </div>
<div class="line"><a name="l02432"></a><span class="lineno"> 2432</span>&#160;<span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><a name="l02433"></a><span class="lineno"> 2433</span>&#160;                            <span class="keywordtype">double</span> grad_adj_ext_dot_n_mat = 0.;</div>
<div class="line"><a name="l02434"></a><span class="lineno"> 2434</span>&#160;                            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> d=0; d&lt;<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l02435"></a><span class="lineno"> 2435</span>&#160;                                grad_adj_ext_dot_n_mat += phi_adj_ext_x_vol_at_bdry[<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d] * normal_qp[d];  <span class="comment">//notice that the convention of the orders x y z is different from vol to bdry</span></div>
<div class="line"><a name="l02436"></a><span class="lineno"> 2436</span>&#160;                            }</div>
<div class="line"><a name="l02437"></a><span class="lineno"> 2437</span>&#160;<span class="comment">//=============== grad dot n  =========================================</span></div>
<div class="line"><a name="l02438"></a><span class="lineno"> 2438</span>&#160; </div>
<div class="line"><a name="l02439"></a><span class="lineno"> 2439</span>&#160;                            <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) {</div>
<div class="line"><a name="l02440"></a><span class="lineno"> 2440</span>&#160;                                Jac[  <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_adj, i_vol, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp_bdry * grad_adj_dot_n_mat * phi_fe_qp_bdry[SolFEType[pos_state]][i_bdry];</div>
<div class="line"><a name="l02441"></a><span class="lineno"> 2441</span>&#160;                            }</div>
<div class="line"><a name="l02442"></a><span class="lineno"> 2442</span>&#160;                            </div>
<div class="line"><a name="l02443"></a><span class="lineno"> 2443</span>&#160;                            <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) {  </div>
<div class="line"><a name="l02444"></a><span class="lineno"> 2444</span>&#160;                                Jac[  <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_adj_ext, i_vol, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp_bdry * grad_adj_ext_dot_n_mat * phi_fe_qp_bdry[SolFEType[pos_ctrl]][i_bdry];</div>
<div class="line"><a name="l02445"></a><span class="lineno"> 2445</span>&#160;                            }</div>
<div class="line"><a name="l02446"></a><span class="lineno"> 2446</span>&#160;                            </div>
<div class="line"><a name="l02447"></a><span class="lineno"> 2447</span>&#160; </div>
<div class="line"><a name="l02448"></a><span class="lineno"> 2448</span>&#160;                                <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_Neum_adj_continuity_pos, pos_adj, i_vol, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface * weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * ( <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">_neumann_adjoint_continuity_sign</a> ) * grad_adj_dot_n_mat;</div>
<div class="line"><a name="l02449"></a><span class="lineno"> 2449</span>&#160;                                <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, gamma_c_Neum_adj_continuity_pos, pos_adj_ext, i_vol, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]   += <a class="code" href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">_neumann_adjoint_explicit</a> * penalty_interface * weight_qp_bdry * phi_fe_qp_bdry[SolFEType[pos_adj_ext]][i_bdry] * ( 1.) * grad_adj_ext_dot_n_mat;</div>
<div class="line"><a name="l02450"></a><span class="lineno"> 2450</span>&#160; </div>
<div class="line"><a name="l02451"></a><span class="lineno"> 2451</span>&#160; </div>
<div class="line"><a name="l02452"></a><span class="lineno"> 2452</span>&#160;                        } <span class="comment">//end j</span></div>
<div class="line"><a name="l02453"></a><span class="lineno"> 2453</span>&#160;<span class="comment">//============ Bdry Jacobians on Volume - END ==================</span></div>
<div class="line"><a name="l02454"></a><span class="lineno"> 2454</span>&#160; </div>
<div class="line"><a name="l02455"></a><span class="lineno"> 2455</span>&#160;                    } <span class="comment">//end i_bdry</span></div>
<div class="line"><a name="l02456"></a><span class="lineno"> 2456</span>&#160; </div>
<div class="line"><a name="l02457"></a><span class="lineno"> 2457</span>&#160;                }  <span class="comment">//end ig_bdry loop</span></div>
<div class="line"><a name="l02458"></a><span class="lineno"> 2458</span>&#160; </div>
<div class="line"><a name="l02459"></a><span class="lineno"> 2459</span>&#160; </div>
<div class="line"><a name="l02460"></a><span class="lineno"> 2460</span>&#160;            }  <span class="comment">//bdry interface elements</span></div>
<div class="line"><a name="l02461"></a><span class="lineno"> 2461</span>&#160; </div>
<div class="line"><a name="l02462"></a><span class="lineno"> 2462</span>&#160;        }  <span class="comment">//end boundary face loop</span></div>
<div class="line"><a name="l02463"></a><span class="lineno"> 2463</span>&#160; </div>
<div class="line"><a name="l02464"></a><span class="lineno"> 2464</span>&#160; </div>
<div class="line"><a name="l02465"></a><span class="lineno"> 2465</span>&#160;        </div>
<div class="line"><a name="l02466"></a><span class="lineno"> 2466</span>&#160;        </div>
<div class="line"><a name="l02467"></a><span class="lineno"> 2467</span>&#160;<span class="comment">//             for (unsigned j = 0; j &lt; is_dof_on_Gamma_c.size(); j++) {</span></div>
<div class="line"><a name="l02468"></a><span class="lineno"> 2468</span>&#160;<span class="comment">//                 std::cout &lt;&lt;  &quot; ** &quot; &lt;&lt; is_dof_on_Gamma_c[j] &lt;&lt; &quot; &quot;;</span></div>
<div class="line"><a name="l02469"></a><span class="lineno"> 2469</span>&#160;<span class="comment">//             }</span></div>
<div class="line"><a name="l02470"></a><span class="lineno"> 2470</span>&#160;<span class="comment">//             </span></div>
<div class="line"><a name="l02471"></a><span class="lineno"> 2471</span>&#160;<span class="comment">//            std::cout &lt;&lt; std::endl; </span></div>
<div class="line"><a name="l02472"></a><span class="lineno"> 2472</span>&#160;            </div>
<div class="line"><a name="l02473"></a><span class="lineno"> 2473</span>&#160; </div>
<div class="line"><a name="l02474"></a><span class="lineno"> 2474</span>&#160;        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> = 0; <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a> &lt; ml_prob.GetQuadratureRule(ielGeom).GetGaussPointsNumber(); <a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>++) {</div>
<div class="line"><a name="l02475"></a><span class="lineno"> 2475</span>&#160; </div>
<div class="line"><a name="l02476"></a><span class="lineno"> 2476</span>&#160;            <span class="comment">// *** get gauss point weight, test function and test function partial derivatives ***</span></div>
<div class="line"><a name="l02477"></a><span class="lineno"> 2477</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">int</span> fe=0; fe &lt; <a class="code" href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a>; fe++) {</div>
<div class="line"><a name="l02478"></a><span class="lineno"> 2478</span>&#160;                msh-&gt;_finiteElement[ielGeom][fe]-&gt;Jacobian(coords_at_dofs,<a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,phi_fe_qp[fe],phi_x_fe_qp[fe],phi_xx_fe_qp[fe]);</div>
<div class="line"><a name="l02479"></a><span class="lineno"> 2479</span>&#160;            }</div>
<div class="line"><a name="l02480"></a><span class="lineno"> 2480</span>&#160;            <span class="comment">//HAVE TO RECALL IT TO HAVE BIQUADRATIC JACOBIAN</span></div>
<div class="line"><a name="l02481"></a><span class="lineno"> 2481</span>&#160;            msh-&gt;_finiteElement[ielGeom][solType_coords]-&gt;Jacobian(coords_at_dofs,<a class="code" href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">ig</a>,weight_qp,phi_fe_qp[solType_coords],phi_x_fe_qp[solType_coords],phi_xx_fe_qp[solType_coords]);</div>
<div class="line"><a name="l02482"></a><span class="lineno"> 2482</span>&#160; </div>
<div class="line"><a name="l02483"></a><span class="lineno"> 2483</span>&#160;<span class="comment">//========= fill gauss value xyz ==================</span></div>
<div class="line"><a name="l02484"></a><span class="lineno"> 2484</span>&#160;            std::fill(coord_at_qp.begin(), coord_at_qp.end(), 0.);</div>
<div class="line"><a name="l02485"></a><span class="lineno"> 2485</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  d = 0; d &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++) {</div>
<div class="line"><a name="l02486"></a><span class="lineno"> 2486</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; coords_at_dofs[d].size(); i++) {</div>
<div class="line"><a name="l02487"></a><span class="lineno"> 2487</span>&#160;                    coord_at_qp[d] += coords_at_dofs[d][i] * phi_fe_qp[solType_coords][i];</div>
<div class="line"><a name="l02488"></a><span class="lineno"> 2488</span>&#160;                }</div>
<div class="line"><a name="l02489"></a><span class="lineno"> 2489</span>&#160;            }</div>
<div class="line"><a name="l02490"></a><span class="lineno"> 2490</span>&#160;            <span class="comment">//========= fill gauss value xyz ==================</span></div>
<div class="line"><a name="l02491"></a><span class="lineno"> 2491</span>&#160; </div>
<div class="line"><a name="l02492"></a><span class="lineno"> 2492</span>&#160;<span class="comment">//========= fill gauss value quantities ==================</span></div>
<div class="line"><a name="l02493"></a><span class="lineno"> 2493</span>&#160;            std::fill(sol_qp.begin(), sol_qp.end(), 0.);</div>
<div class="line"><a name="l02494"></a><span class="lineno"> 2494</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><a name="l02495"></a><span class="lineno"> 2495</span>&#160;                std::fill(sol_grad_qp[k].begin(), sol_grad_qp[k].end(), 0.);</div>
<div class="line"><a name="l02496"></a><span class="lineno"> 2496</span>&#160;            }</div>
<div class="line"><a name="l02497"></a><span class="lineno"> 2497</span>&#160; </div>
<div class="line"><a name="l02498"></a><span class="lineno"> 2498</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span>  k = 0; k &lt; n_unknowns; k++) {</div>
<div class="line"><a name="l02499"></a><span class="lineno"> 2499</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; Sol_n_el_dofs_Mat_vol[k]; i++) {</div>
<div class="line"><a name="l02500"></a><span class="lineno"> 2500</span>&#160;                    sol_qp[k]    += sol_eldofs_Mat[k][i] *   phi_fe_qp[SolFEType[k]][i];</div>
<div class="line"><a name="l02501"></a><span class="lineno"> 2501</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> d = 0; d &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; d++)   sol_grad_qp[k][d] += sol_eldofs_Mat[k][i] * phi_x_fe_qp[SolFEType[k]][i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + d];</div>
<div class="line"><a name="l02502"></a><span class="lineno"> 2502</span>&#160;                }</div>
<div class="line"><a name="l02503"></a><span class="lineno"> 2503</span>&#160;            }</div>
<div class="line"><a name="l02504"></a><span class="lineno"> 2504</span>&#160;<span class="comment">//========= fill gauss value quantities ==================</span></div>
<div class="line"><a name="l02505"></a><span class="lineno"> 2505</span>&#160; </div>
<div class="line"><a name="l02506"></a><span class="lineno"> 2506</span>&#160; </div>
<div class="line"><a name="l02507"></a><span class="lineno"> 2507</span>&#160; </div>
<div class="line"><a name="l02508"></a><span class="lineno"> 2508</span>&#160; </div>
<div class="line"><a name="l02509"></a><span class="lineno"> 2509</span>&#160; </div>
<div class="line"><a name="l02510"></a><span class="lineno"> 2510</span>&#160;<span class="comment">//==========FILLING WITH THE EQUATIONS ===========</span></div>
<div class="line"><a name="l02511"></a><span class="lineno"> 2511</span>&#160;            <span class="comment">// *** phi_i loop ***</span></div>
<div class="line"><a name="l02512"></a><span class="lineno"> 2512</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; nDof_max; i++) {</div>
<div class="line"><a name="l02513"></a><span class="lineno"> 2513</span>&#160; </div>
<div class="line"><a name="l02514"></a><span class="lineno"> 2514</span>&#160;                <span class="keywordtype">double</span> laplace_rhs_du_adj_i = 0.;</div>
<div class="line"><a name="l02515"></a><span class="lineno"> 2515</span>&#160;                <span class="keywordtype">double</span> laplace_rhs_dadj_u_i = 0.;</div>
<div class="line"><a name="l02516"></a><span class="lineno"> 2516</span>&#160;                <span class="keywordtype">double</span> laplace_rhs_dctrl_adj_ext_i = 0.;</div>
<div class="line"><a name="l02517"></a><span class="lineno"> 2517</span>&#160;                <span class="keywordtype">double</span> laplace_rhs_dadj_ext_ctrl_i = 0.;</div>
<div class="line"><a name="l02518"></a><span class="lineno"> 2518</span>&#160;                <span class="keywordtype">double</span> laplace_rhs_dctrl_ctrl_i = 0.;</div>
<div class="line"><a name="l02519"></a><span class="lineno"> 2519</span>&#160; </div>
<div class="line"><a name="l02520"></a><span class="lineno"> 2520</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><a name="l02521"></a><span class="lineno"> 2521</span>&#160;                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_state] )       laplace_rhs_du_adj_i          +=  (phi_x_fe_qp[SolFEType[pos_state]]   [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_adj][kdim]);</div>
<div class="line"><a name="l02522"></a><span class="lineno"> 2522</span>&#160;                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj] )         laplace_rhs_dadj_u_i          +=  (phi_x_fe_qp[SolFEType[pos_adj]]     [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_state][kdim]);</div>
<div class="line"><a name="l02523"></a><span class="lineno"> 2523</span>&#160;                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )        laplace_rhs_dctrl_adj_ext_i   +=  (phi_x_fe_qp[SolFEType[pos_ctrl]]    [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_adj_ext][kdim]);</div>
<div class="line"><a name="l02524"></a><span class="lineno"> 2524</span>&#160;                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext] )     laplace_rhs_dadj_ext_ctrl_i   +=  (phi_x_fe_qp[SolFEType[pos_adj_ext]] [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_ctrl][kdim]);</div>
<div class="line"><a name="l02525"></a><span class="lineno"> 2525</span>&#160;                    <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )        laplace_rhs_dctrl_ctrl_i      +=  (phi_x_fe_qp[SolFEType[pos_ctrl]]    [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * sol_grad_qp[pos_ctrl][kdim]);</div>
<div class="line"><a name="l02526"></a><span class="lineno"> 2526</span>&#160;                }</div>
<div class="line"><a name="l02527"></a><span class="lineno"> 2527</span>&#160; </div>
<div class="line"><a name="l02528"></a><span class="lineno"> 2528</span>&#160;<span class="comment">//======================Volume Residuals - BEGIN =======================</span></div>
<div class="line"><a name="l02529"></a><span class="lineno"> 2529</span>&#160;<span class="comment">//--- equations ---                </span></div>
<div class="line"><a name="l02530"></a><span class="lineno"> 2530</span>&#160;                <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> )     {</div>
<div class="line"><a name="l02531"></a><span class="lineno"> 2531</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_state,i) ]  += - weight_qp * (target_flag * phi_fe_qp[SolFEType[pos_state]][i] * ( sol_qp[pos_state] - u_des) - laplace_rhs_du_adj_i);</div>
<div class="line"><a name="l02532"></a><span class="lineno"> 2532</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_adj,i)]     += - weight_qp *  ( - laplace_rhs_dadj_u_i    - 0.) ;</div>
<div class="line"><a name="l02533"></a><span class="lineno"> 2533</span>&#160;                }</div>
<div class="line"><a name="l02534"></a><span class="lineno"> 2534</span>&#160; </div>
<div class="line"><a name="l02535"></a><span class="lineno"> 2535</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> )  {</div>
<div class="line"><a name="l02536"></a><span class="lineno"> 2536</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_ctrl,i) ]   += - weight_qp * ( <a class="code" href="../../df/d2a/07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a> * <a class="code" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a> * phi_fe_qp[SolFEType[pos_ctrl]][i] * sol_qp[pos_ctrl]</div>
<div class="line"><a name="l02537"></a><span class="lineno"> 2537</span>&#160;                            + <a class="code" href="../../df/d2a/07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a> * <a class="code" href="../../d8/d87/Conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> * laplace_rhs_dctrl_ctrl_i</div>
<div class="line"><a name="l02538"></a><span class="lineno"> 2538</span>&#160;                            - laplace_rhs_dctrl_adj_ext_i <span class="comment">/*+ 7000. * phi_fe_qp[SolFEType[pos_ctrl]][i]*/</span>);</div>
<div class="line"><a name="l02539"></a><span class="lineno"> 2539</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol,pos_adj_ext,i)] += - weight_qp *  ( - laplace_rhs_dadj_ext_ctrl_i - 0.);</div>
<div class="line"><a name="l02540"></a><span class="lineno"> 2540</span>&#160;                }</div>
<div class="line"><a name="l02541"></a><span class="lineno"> 2541</span>&#160; </div>
<div class="line"><a name="l02542"></a><span class="lineno"> 2542</span>&#160;<span class="comment">//--- extensions to zero ---</span></div>
<div class="line"><a name="l02543"></a><span class="lineno"> 2543</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> exclude_Dirichlet_Gamma_c_for_Adjoint =  (1 - is_dof_on_Gamma_c[i]);</div>
<div class="line"><a name="l02544"></a><span class="lineno"> 2544</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> exclude_Dirichlet_Gamma_c_for_Adjoint_Ext =  (1 - is_dof_on_Gamma_c[i]);</div>
<div class="line"><a name="l02545"></a><span class="lineno"> 2545</span>&#160;            </div>
<div class="line"><a name="l02546"></a><span class="lineno"> 2546</span>&#160;                <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> )     {</div>
<div class="line"><a name="l02547"></a><span class="lineno"> 2547</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_adj_ext, i)] += - exclude_Dirichlet_Gamma_c_for_Adjoint_Ext * penalty_strong_ctrl * ( sol_eldofs_Mat[pos_adj_ext][i] - 0.);</div>
<div class="line"><a name="l02548"></a><span class="lineno"> 2548</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_ctrl, i)]    += - (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl * (sol_eldofs_Mat[pos_ctrl][i] - 0.);</div>
<div class="line"><a name="l02549"></a><span class="lineno"> 2549</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_mu, i)]      += - (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl * ( sol_eldofs_Mat[pos_mu][i] - 0.);</div>
<div class="line"><a name="l02550"></a><span class="lineno"> 2550</span>&#160;                }</div>
<div class="line"><a name="l02551"></a><span class="lineno"> 2551</span>&#160; </div>
<div class="line"><a name="l02552"></a><span class="lineno"> 2552</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> )  {</div>
<div class="line"><a name="l02553"></a><span class="lineno"> 2553</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_adj, i)]     += - exclude_Dirichlet_Gamma_c_for_Adjoint * penalty_strong_u * (  sol_eldofs_Mat[pos_adj][i] - 0.);</div>
<div class="line"><a name="l02554"></a><span class="lineno"> 2554</span>&#160;                    Res[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">assemble_jacobian&lt;double,double&gt;::res_row_index</a>(Sol_n_el_dofs_Mat_vol, pos_state, i) ]  += - (1 - is_dof_on_Gamma_c[i]) * penalty_strong_u * (sol_eldofs_Mat[pos_state][i] - 0.);</div>
<div class="line"><a name="l02555"></a><span class="lineno"> 2555</span>&#160;                }</div>
<div class="line"><a name="l02556"></a><span class="lineno"> 2556</span>&#160;<span class="comment">//======================Volume Residuals - END =======================</span></div>
<div class="line"><a name="l02557"></a><span class="lineno"> 2557</span>&#160; </div>
<div class="line"><a name="l02558"></a><span class="lineno"> 2558</span>&#160;                <span class="keywordflow">if</span> (assembleMatrix) {</div>
<div class="line"><a name="l02559"></a><span class="lineno"> 2559</span>&#160; </div>
<div class="line"><a name="l02560"></a><span class="lineno"> 2560</span>&#160;                    <span class="comment">// *** phi_j loop ***</span></div>
<div class="line"><a name="l02561"></a><span class="lineno"> 2561</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> = 0; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; nDof_max; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>++) {</div>
<div class="line"><a name="l02562"></a><span class="lineno"> 2562</span>&#160; </div>
<div class="line"><a name="l02563"></a><span class="lineno"> 2563</span>&#160;                        <span class="keywordtype">double</span> laplace_mat_du_adj = 0.;</div>
<div class="line"><a name="l02564"></a><span class="lineno"> 2564</span>&#160;                        <span class="keywordtype">double</span> laplace_mat_dadj_u = 0.;</div>
<div class="line"><a name="l02565"></a><span class="lineno"> 2565</span>&#160;                        <span class="keywordtype">double</span> laplace_mat_dctrl_adj_ext = 0.;</div>
<div class="line"><a name="l02566"></a><span class="lineno"> 2566</span>&#160;                        <span class="keywordtype">double</span> laplace_mat_dadj_ext_ctrl = 0.;</div>
<div class="line"><a name="l02567"></a><span class="lineno"> 2567</span>&#160;                        <span class="keywordtype">double</span> laplace_mat_dctrl_ctrl = 0.;</div>
<div class="line"><a name="l02568"></a><span class="lineno"> 2568</span>&#160; </div>
<div class="line"><a name="l02569"></a><span class="lineno"> 2569</span>&#160;                        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> kdim = 0; kdim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; kdim++) {</div>
<div class="line"><a name="l02570"></a><span class="lineno"> 2570</span>&#160;                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_state]   &amp;&amp; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_adj] )      laplace_mat_du_adj        += (phi_x_fe_qp[SolFEType[pos_state]]  [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_adj]]    [<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);</div>
<div class="line"><a name="l02571"></a><span class="lineno"> 2571</span>&#160;                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj]     &amp;&amp; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_state] )    laplace_mat_dadj_u        += (phi_x_fe_qp[SolFEType[pos_adj]]    [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_state]]  [<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);  <span class="comment">//equal to the previous</span></div>
<div class="line"><a name="l02572"></a><span class="lineno"> 2572</span>&#160;                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl]    &amp;&amp; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext] )  laplace_mat_dctrl_adj_ext += (phi_x_fe_qp[SolFEType[pos_ctrl]]   [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_adj_ext]][<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);</div>
<div class="line"><a name="l02573"></a><span class="lineno"> 2573</span>&#160;                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_adj_ext] &amp;&amp; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )     laplace_mat_dadj_ext_ctrl += (phi_x_fe_qp[SolFEType[pos_adj_ext]][i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_ctrl]]   [<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);  <span class="comment">//equal to the previous</span></div>
<div class="line"><a name="l02574"></a><span class="lineno"> 2574</span>&#160;                            <span class="keywordflow">if</span> ( i &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl]    &amp;&amp; <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> &lt; Sol_n_el_dofs_Mat_vol[pos_ctrl] )     laplace_mat_dctrl_ctrl    += (phi_x_fe_qp[SolFEType[pos_ctrl]]   [i * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim] * phi_x_fe_qp[SolFEType[pos_ctrl]]   [<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> * <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> + kdim]);</div>
<div class="line"><a name="l02575"></a><span class="lineno"> 2575</span>&#160;                        }</div>
<div class="line"><a name="l02576"></a><span class="lineno"> 2576</span>&#160; </div>
<div class="line"><a name="l02577"></a><span class="lineno"> 2577</span>&#160; </div>
<div class="line"><a name="l02578"></a><span class="lineno"> 2578</span>&#160;<span class="comment">//--- equations ---                </span></div>
<div class="line"><a name="l02579"></a><span class="lineno"> 2579</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) {</div>
<div class="line"><a name="l02580"></a><span class="lineno"> 2580</span>&#160; </div>
<div class="line"><a name="l02581"></a><span class="lineno"> 2581</span>&#160;                            Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_state, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ] += weight_qp * target_flag * phi_fe_qp[SolFEType[pos_state]][<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>] * phi_fe_qp[SolFEType[pos_state]][i];</div>
<div class="line"><a name="l02582"></a><span class="lineno"> 2582</span>&#160;                            Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_adj, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]   += weight_qp * (-1.) * laplace_mat_du_adj;</div>
<div class="line"><a name="l02583"></a><span class="lineno"> 2583</span>&#160; </div>
<div class="line"><a name="l02584"></a><span class="lineno"> 2584</span>&#160;                            Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj, pos_state, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]   += weight_qp * (-1.) * laplace_mat_dadj_u;</div>
<div class="line"><a name="l02585"></a><span class="lineno"> 2585</span>&#160; </div>
<div class="line"><a name="l02586"></a><span class="lineno"> 2586</span>&#160;                        }</div>
<div class="line"><a name="l02587"></a><span class="lineno"> 2587</span>&#160; </div>
<div class="line"><a name="l02588"></a><span class="lineno"> 2588</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) {</div>
<div class="line"><a name="l02589"></a><span class="lineno"> 2589</span>&#160; </div>
<div class="line"><a name="l02590"></a><span class="lineno"> 2590</span>&#160;                            </div>
<div class="line"><a name="l02591"></a><span class="lineno"> 2591</span>&#160;                            Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_ctrl, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]     += weight_qp * ( </div>
<div class="line"><a name="l02592"></a><span class="lineno"> 2592</span>&#160;                                 <a class="code" href="../../df/d2a/07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a> * <a class="code" href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a> * phi_fe_qp[SolFEType[pos_ctrl]][i] * phi_fe_qp[SolFEType[pos_ctrl]][<a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>]</div>
<div class="line"><a name="l02593"></a><span class="lineno"> 2593</span>&#160;                                + <a class="code" href="../../df/d2a/07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a> * <a class="code" href="../../d8/d87/Conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a> * laplace_mat_dctrl_ctrl</div>
<div class="line"><a name="l02594"></a><span class="lineno"> 2594</span>&#160;                                    );</div>
<div class="line"><a name="l02595"></a><span class="lineno"> 2595</span>&#160; </div>
<div class="line"><a name="l02596"></a><span class="lineno"> 2596</span>&#160;                            Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_adj_ext, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp * (-1.) * laplace_mat_dctrl_adj_ext;</div>
<div class="line"><a name="l02597"></a><span class="lineno"> 2597</span>&#160; </div>
<div class="line"><a name="l02598"></a><span class="lineno"> 2598</span>&#160;                            Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj_ext, pos_ctrl, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += weight_qp * (-1.) * laplace_mat_dadj_ext_ctrl;</div>
<div class="line"><a name="l02599"></a><span class="lineno"> 2599</span>&#160; </div>
<div class="line"><a name="l02600"></a><span class="lineno"> 2600</span>&#160;                        }</div>
<div class="line"><a name="l02601"></a><span class="lineno"> 2601</span>&#160; </div>
<div class="line"><a name="l02602"></a><span class="lineno"> 2602</span>&#160;                        </div>
<div class="line"><a name="l02603"></a><span class="lineno"> 2603</span>&#160; </div>
<div class="line"><a name="l02604"></a><span class="lineno"> 2604</span>&#160;<span class="comment">//--- extensions to zero ---                </span></div>
<div class="line"><a name="l02605"></a><span class="lineno"> 2605</span>&#160;                       <span class="keywordflow">if</span> (  i == <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a> ) {</div>
<div class="line"><a name="l02606"></a><span class="lineno"> 2606</span>&#160;                                </div>
<div class="line"><a name="l02607"></a><span class="lineno"> 2607</span>&#160;                        <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a> ) {</div>
<div class="line"><a name="l02608"></a><span class="lineno"> 2608</span>&#160;                             Jac[<a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj_ext, pos_adj_ext, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>)]  += exclude_Dirichlet_Gamma_c_for_Adjoint_Ext * penalty_strong_ctrl;</div>
<div class="line"><a name="l02609"></a><span class="lineno"> 2609</span>&#160;                             Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_ctrl, pos_ctrl, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]      += (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl;</div>
<div class="line"><a name="l02610"></a><span class="lineno"> 2610</span>&#160;                             Jac[<a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_mu, pos_mu, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]           += (1 - is_dof_on_Gamma_c[i]) * penalty_strong_ctrl;</div>
<div class="line"><a name="l02611"></a><span class="lineno"> 2611</span>&#160;                            }</div>
<div class="line"><a name="l02612"></a><span class="lineno"> 2612</span>&#160;                            </div>
<div class="line"><a name="l02613"></a><span class="lineno"> 2613</span>&#160;                        <span class="keywordflow">else</span> <span class="keywordflow">if</span> ( group_flag == <a class="code" href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a> ) {</div>
<div class="line"><a name="l02614"></a><span class="lineno"> 2614</span>&#160;                             Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_adj, pos_adj, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]      += exclude_Dirichlet_Gamma_c_for_Adjoint *  penalty_strong_u;</div>
<div class="line"><a name="l02615"></a><span class="lineno"> 2615</span>&#160;                             Jac[ <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">assemble_jacobian&lt;double,double&gt;::jac_row_col_index</a>(Sol_n_el_dofs_Mat_vol, sum_Sol_n_el_dofs, pos_state, pos_state, i, <a class="code" href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a>) ]  += (1 - is_dof_on_Gamma_c[i]) *  penalty_strong_u;</div>
<div class="line"><a name="l02616"></a><span class="lineno"> 2616</span>&#160;                            }</div>
<div class="line"><a name="l02617"></a><span class="lineno"> 2617</span>&#160; </div>
<div class="line"><a name="l02618"></a><span class="lineno"> 2618</span>&#160;                        }</div>
<div class="line"><a name="l02619"></a><span class="lineno"> 2619</span>&#160;                        </div>
<div class="line"><a name="l02620"></a><span class="lineno"> 2620</span>&#160;                        </div>
<div class="line"><a name="l02621"></a><span class="lineno"> 2621</span>&#160;                        </div>
<div class="line"><a name="l02622"></a><span class="lineno"> 2622</span>&#160;                        </div>
<div class="line"><a name="l02623"></a><span class="lineno"> 2623</span>&#160;                        </div>
<div class="line"><a name="l02624"></a><span class="lineno"> 2624</span>&#160;                        </div>
<div class="line"><a name="l02625"></a><span class="lineno"> 2625</span>&#160;                        </div>
<div class="line"><a name="l02626"></a><span class="lineno"> 2626</span>&#160;                    } <span class="comment">// end phi_j loop</span></div>
<div class="line"><a name="l02627"></a><span class="lineno"> 2627</span>&#160; </div>
<div class="line"><a name="l02628"></a><span class="lineno"> 2628</span>&#160;                } <span class="comment">// endif assemble_matrix</span></div>
<div class="line"><a name="l02629"></a><span class="lineno"> 2629</span>&#160; </div>
<div class="line"><a name="l02630"></a><span class="lineno"> 2630</span>&#160;            } <span class="comment">// end phi_i loop</span></div>
<div class="line"><a name="l02631"></a><span class="lineno"> 2631</span>&#160; </div>
<div class="line"><a name="l02632"></a><span class="lineno"> 2632</span>&#160;        } <span class="comment">// end gauss point loop</span></div>
<div class="line"><a name="l02633"></a><span class="lineno"> 2633</span>&#160; </div>
<div class="line"><a name="l02634"></a><span class="lineno"> 2634</span>&#160; </div>
<div class="line"><a name="l02635"></a><span class="lineno"> 2635</span>&#160;<span class="comment">//========== sum-based part ================================</span></div>
<div class="line"><a name="l02636"></a><span class="lineno"> 2636</span>&#160; </div>
<div class="line"><a name="l02637"></a><span class="lineno"> 2637</span>&#160;        RES-&gt;add_vector_blocked(Res, L2G_dofmap_Mat_AllVars);</div>
<div class="line"><a name="l02638"></a><span class="lineno"> 2638</span>&#160;        <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;add_matrix_blocked(Jac, L2G_dofmap_Mat_AllVars, L2G_dofmap_Mat_AllVars);</div>
<div class="line"><a name="l02639"></a><span class="lineno"> 2639</span>&#160; </div>
<div class="line"><a name="l02640"></a><span class="lineno"> 2640</span>&#160;        </div>
<div class="line"><a name="l02641"></a><span class="lineno"> 2641</span>&#160;        </div>
<div class="line"><a name="l02642"></a><span class="lineno"> 2642</span>&#160;     <span class="keywordflow">if</span> (print_algebra_local) {</div>
<div class="line"><a name="l02643"></a><span class="lineno"> 2643</span>&#160;    <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#af1d28f6f33acdba64d6e3c733d09f0aa">assemble_jacobian&lt;double,double&gt;::print_element_residual</a>(iel, Res, Sol_n_el_dofs_Mat_vol, 10, 5);</div>
<div class="line"><a name="l02644"></a><span class="lineno"> 2644</span>&#160;    <a class="code" href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a76626a28a3fa87cc055e76d189ed4660">assemble_jacobian&lt;double,double&gt;::print_element_jacobian</a>(iel, Jac, Sol_n_el_dofs_Mat_vol, 10, 5);</div>
<div class="line"><a name="l02645"></a><span class="lineno"> 2645</span>&#160;     }</div>
<div class="line"><a name="l02646"></a><span class="lineno"> 2646</span>&#160;        </div>
<div class="line"><a name="l02647"></a><span class="lineno"> 2647</span>&#160;  } <span class="comment">//end element loop for each process</span></div>
<div class="line"><a name="l02648"></a><span class="lineno"> 2648</span>&#160;       </div>
<div class="line"><a name="l02649"></a><span class="lineno"> 2649</span>&#160;       </div>
<div class="line"><a name="l02650"></a><span class="lineno"> 2650</span>&#160;       </div>
<div class="line"><a name="l02651"></a><span class="lineno"> 2651</span>&#160;     <span class="comment">//this part is to add a bunch of 1&#39;s in the residual, so it is not based on the element loop</span></div>
<div class="line"><a name="l02652"></a><span class="lineno"> 2652</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ctrl_index = mlPdeSys-&gt;GetSolPdeIndex(<span class="stringliteral">&quot;control&quot;</span>);</div>
<div class="line"><a name="l02653"></a><span class="lineno"> 2653</span>&#160; </div>
<div class="line"><a name="l02654"></a><span class="lineno"> 2654</span>&#160;    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> global_ctrl_size = pdeSys-&gt;KKoffset[ctrl_index+1][iproc] - pdeSys-&gt;KKoffset[ctrl_index][iproc];</div>
<div class="line"><a name="l02655"></a><span class="lineno"> 2655</span>&#160; </div>
<div class="line"><a name="l02656"></a><span class="lineno"> 2656</span>&#160;    std::vector&lt;double&gt;  one_times_mu(global_ctrl_size, 0.);</div>
<div class="line"><a name="l02657"></a><span class="lineno"> 2657</span>&#160;    std::vector&lt;int&gt;    positions(global_ctrl_size);</div>
<div class="line"><a name="l02658"></a><span class="lineno"> 2658</span>&#160; </div>
<div class="line"><a name="l02659"></a><span class="lineno"> 2659</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> i = 0; i &lt; positions.size(); i++) {</div>
<div class="line"><a name="l02660"></a><span class="lineno"> 2660</span>&#160;        positions[i] = pdeSys-&gt;KKoffset[ctrl_index][iproc] + i;</div>
<div class="line"><a name="l02661"></a><span class="lineno"> 2661</span>&#160;        one_times_mu[i] = ineq_flag * 1. * (*sol-&gt;_Sol[SolIndex[pos_mu]])(i<span class="comment">/*position_mu_i*/</span>) ;</div>
<div class="line"><a name="l02662"></a><span class="lineno"> 2662</span>&#160;    }</div>
<div class="line"><a name="l02663"></a><span class="lineno"> 2663</span>&#160;    RES-&gt;add_vector_blocked(one_times_mu, positions);</div>
<div class="line"><a name="l02664"></a><span class="lineno"> 2664</span>&#160; </div>
<div class="line"><a name="l02665"></a><span class="lineno"> 2665</span>&#160;    </div>
<div class="line"><a name="l02666"></a><span class="lineno"> 2666</span>&#160;    RES-&gt;close();</div>
<div class="line"><a name="l02667"></a><span class="lineno"> 2667</span>&#160;    <span class="keywordflow">if</span> (assembleMatrix)   JAC-&gt;close();</div>
<div class="line"><a name="l02668"></a><span class="lineno"> 2668</span>&#160;      <span class="comment">// ***************** ADD PART - END  *******************</span></div>
<div class="line"><a name="l02669"></a><span class="lineno"> 2669</span>&#160;      </div>
<div class="line"><a name="l02670"></a><span class="lineno"> 2670</span>&#160;        </div>
<div class="line"><a name="l02671"></a><span class="lineno"> 2671</span>&#160;        </div>
<div class="line"><a name="l02672"></a><span class="lineno"> 2672</span>&#160;        </div>
<div class="line"><a name="l02673"></a><span class="lineno"> 2673</span>&#160;<span class="comment">//   ***************** INSERT PART - BEGIN (must go AFTER the sum, clearly) *******************</span></div>
<div class="line"><a name="l02674"></a><span class="lineno"> 2674</span>&#160;  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> iel = msh-&gt;_elementOffset[iproc]; iel &lt; msh-&gt;_elementOffset[iproc + 1]; iel++) {</div>
<div class="line"><a name="l02675"></a><span class="lineno"> 2675</span>&#160; </div>
<div class="line"><a name="l02676"></a><span class="lineno"> 2676</span>&#160;      </div>
<div class="line"><a name="l02677"></a><span class="lineno"> 2677</span>&#160; </div>
<div class="line"><a name="l02678"></a><span class="lineno"> 2678</span>&#160;<span class="comment">// -------</span></div>
<div class="line"><a name="l02679"></a><span class="lineno"> 2679</span>&#160;   geom_element_iel.set_coords_at_dofs_and_geom_type(iel, solType_coords);</div>
<div class="line"><a name="l02680"></a><span class="lineno"> 2680</span>&#160;      </div>
<div class="line"><a name="l02681"></a><span class="lineno"> 2681</span>&#160;   geom_element_iel.set_elem_center_3d(iel, solType_coords);</div>
<div class="line"><a name="l02682"></a><span class="lineno"> 2682</span>&#160;<span class="comment">// -------</span></div>
<div class="line"><a name="l02683"></a><span class="lineno"> 2683</span>&#160;   </div>
<div class="line"><a name="l02684"></a><span class="lineno"> 2684</span>&#160;<span class="comment">// -------</span></div>
<div class="line"><a name="l02685"></a><span class="lineno"> 2685</span>&#160;    <a class="code" href="../../d8/dea/namespacefemus.html#aa2fa50068a407963c5f2ef841333b326">el_dofs_unknowns_vol</a>(sol, msh, pdeSys, iel,</div>
<div class="line"><a name="l02686"></a><span class="lineno"> 2686</span>&#160;                        SolFEType,</div>
<div class="line"><a name="l02687"></a><span class="lineno"> 2687</span>&#160;                        SolIndex,</div>
<div class="line"><a name="l02688"></a><span class="lineno"> 2688</span>&#160;                        SolPdeIndex,</div>
<div class="line"><a name="l02689"></a><span class="lineno"> 2689</span>&#160;                        Sol_n_el_dofs_Mat_vol,</div>
<div class="line"><a name="l02690"></a><span class="lineno"> 2690</span>&#160;                        sol_eldofs_Mat,</div>
<div class="line"><a name="l02691"></a><span class="lineno"> 2691</span>&#160;                        L2G_dofmap_Mat);</div>
<div class="line"><a name="l02692"></a><span class="lineno"> 2692</span>&#160;      </div>
<div class="line"><a name="l02693"></a><span class="lineno"> 2693</span>&#160;    <span class="comment">//***** set control flag ****************************</span></div>
<div class="line"><a name="l02694"></a><span class="lineno"> 2694</span>&#160;  <span class="keywordtype">int</span> control_el_flag = 0;</div>
<div class="line"><a name="l02695"></a><span class="lineno"> 2695</span>&#160;  control_el_flag = <a class="code" href="../../d7/d7b/classfemus_1_1ctrl_1_1square__or__cube_1_1lifting__internal.html#ae8b192bf476ac8b9b8aa23671e98bc84">ctrl:: square_or_cube:: lifting_internal &lt; ctrl::GAMMA_CONTROL_LIST_OF_FACES_WITH_EXTREMES &gt;::ControlDomainFlag_internal_restriction</a>(geom_element_iel.get_elem_center_3d());</div>
<div class="line"><a name="l02696"></a><span class="lineno"> 2696</span>&#160; </div>
<div class="line"><a name="l02697"></a><span class="lineno"> 2697</span>&#160;    </div>
<div class="line"><a name="l02698"></a><span class="lineno"> 2698</span>&#160;    <span class="keywordflow">if</span> (control_el_flag == 1) {</div>
<div class="line"><a name="l02699"></a><span class="lineno"> 2699</span>&#160; </div>
<div class="line"><a name="l02700"></a><span class="lineno"> 2700</span>&#160;        </div>
<div class="line"><a name="l02701"></a><span class="lineno"> 2701</span>&#160;  <a class="code" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#a53fcde6a8cb427b5da69375d0fe7cd14">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::update_active_set_flag_for_current_nonlinear_iteration</a></div>
<div class="line"><a name="l02702"></a><span class="lineno"> 2702</span>&#160;  (msh,</div>
<div class="line"><a name="l02703"></a><span class="lineno"> 2703</span>&#160;   sol,</div>
<div class="line"><a name="l02704"></a><span class="lineno"> 2704</span>&#160;   iel,</div>
<div class="line"><a name="l02705"></a><span class="lineno"> 2705</span>&#160;   geom_element_iel.get_coords_at_dofs<span class="comment">/*_3d*/</span>(),</div>
<div class="line"><a name="l02706"></a><span class="lineno"> 2706</span>&#160;   sol_eldofs_Mat,</div>
<div class="line"><a name="l02707"></a><span class="lineno"> 2707</span>&#160;   Sol_n_el_dofs_Mat_vol,</div>
<div class="line"><a name="l02708"></a><span class="lineno"> 2708</span>&#160;   c_compl,</div>
<div class="line"><a name="l02709"></a><span class="lineno"> 2709</span>&#160;   pos_mu_in_mat,</div>
<div class="line"><a name="l02710"></a><span class="lineno"> 2710</span>&#160;   pos_ctrl_in_mat,</div>
<div class="line"><a name="l02711"></a><span class="lineno"> 2711</span>&#160;   solIndex_act_flag_sol,</div>
<div class="line"><a name="l02712"></a><span class="lineno"> 2712</span>&#160;   ctrl_lower,</div>
<div class="line"><a name="l02713"></a><span class="lineno"> 2713</span>&#160;   ctrl_upper,</div>
<div class="line"><a name="l02714"></a><span class="lineno"> 2714</span>&#160;   sol_actflag);</div>
<div class="line"><a name="l02715"></a><span class="lineno"> 2715</span>&#160;  </div>
<div class="line"><a name="l02716"></a><span class="lineno"> 2716</span>&#160;      </div>
<div class="line"><a name="l02717"></a><span class="lineno"> 2717</span>&#160; </div>
<div class="line"><a name="l02718"></a><span class="lineno"> 2718</span>&#160; </div>
<div class="line"><a name="l02719"></a><span class="lineno"> 2719</span>&#160;    <a class="code" href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#aa3664a638e79db4c4ee17d8776117f30">ctrl::mixed_state_or_ctrl_inequality&lt; femus::ctrl::square_or_cube::mixed_state_or_ctrl_inequality &gt;::node_insertion</a>(iel,</div>
<div class="line"><a name="l02720"></a><span class="lineno"> 2720</span>&#160;                   msh,</div>
<div class="line"><a name="l02721"></a><span class="lineno"> 2721</span>&#160;                   L2G_dofmap_Mat,</div>
<div class="line"><a name="l02722"></a><span class="lineno"> 2722</span>&#160;                   pos_mu_in_mat,</div>
<div class="line"><a name="l02723"></a><span class="lineno"> 2723</span>&#160;                   pos_ctrl_in_mat,</div>
<div class="line"><a name="l02724"></a><span class="lineno"> 2724</span>&#160;                   sol_eldofs_Mat,</div>
<div class="line"><a name="l02725"></a><span class="lineno"> 2725</span>&#160;                   Sol_n_el_dofs_Mat_vol,</div>
<div class="line"><a name="l02726"></a><span class="lineno"> 2726</span>&#160;                   sol_actflag,</div>
<div class="line"><a name="l02727"></a><span class="lineno"> 2727</span>&#160;                   ctrl_lower,</div>
<div class="line"><a name="l02728"></a><span class="lineno"> 2728</span>&#160;                   ctrl_upper,</div>
<div class="line"><a name="l02729"></a><span class="lineno"> 2729</span>&#160;                   ineq_flag,</div>
<div class="line"><a name="l02730"></a><span class="lineno"> 2730</span>&#160;                   c_compl,</div>
<div class="line"><a name="l02731"></a><span class="lineno"> 2731</span>&#160;                   JAC,</div>
<div class="line"><a name="l02732"></a><span class="lineno"> 2732</span>&#160;                   RES,</div>
<div class="line"><a name="l02733"></a><span class="lineno"> 2733</span>&#160;                   assembleMatrix</div>
<div class="line"><a name="l02734"></a><span class="lineno"> 2734</span>&#160;                   );</div>
<div class="line"><a name="l02735"></a><span class="lineno"> 2735</span>&#160;   </div>
<div class="line"><a name="l02736"></a><span class="lineno"> 2736</span>&#160; </div>
<div class="line"><a name="l02737"></a><span class="lineno"> 2737</span>&#160;       }</div>
<div class="line"><a name="l02738"></a><span class="lineno"> 2738</span>&#160;      </div>
<div class="line"><a name="l02739"></a><span class="lineno"> 2739</span>&#160;      </div>
<div class="line"><a name="l02740"></a><span class="lineno"> 2740</span>&#160;<span class="comment">// // // //============= delta_mu row ===============================</span></div>
<div class="line"><a name="l02741"></a><span class="lineno"> 2741</span>&#160;<span class="comment">// // //         std::vector&lt;double&gt; Res_mu (Sol_n_el_dofs[pos_mu]);</span></div>
<div class="line"><a name="l02742"></a><span class="lineno"> 2742</span>&#160;<span class="comment">// // //         std::fill(Res_mu.begin(),Res_mu.end(), 0.);</span></div>
<div class="line"><a name="l02743"></a><span class="lineno"> 2743</span>&#160;<span class="comment">// // //         for (unsigned i = 0; i &lt; sol_actflag.size(); i++) {</span></div>
<div class="line"><a name="l02744"></a><span class="lineno"> 2744</span>&#160;<span class="comment">// // //             if (sol_actflag[i] == 0) {  //inactive</span></div>
<div class="line"><a name="l02745"></a><span class="lineno"> 2745</span>&#160;<span class="comment">// // //                 Res_mu [i] = - ineq_flag * ( 1. * sol_eldofs[pos_mu][i] - 0. );</span></div>
<div class="line"><a name="l02746"></a><span class="lineno"> 2746</span>&#160;<span class="comment">// // //             }</span></div>
<div class="line"><a name="l02747"></a><span class="lineno"> 2747</span>&#160;<span class="comment">// // //             else if (sol_actflag[i] == 1) {  //active_a</span></div>
<div class="line"><a name="l02748"></a><span class="lineno"> 2748</span>&#160;<span class="comment">// // //                 Res_mu [i] = - ineq_flag * ( c_compl *  sol_eldofs[pos_ctrl][i] - c_compl * ctrl_lower[i]);</span></div>
<div class="line"><a name="l02749"></a><span class="lineno"> 2749</span>&#160;<span class="comment">// // //             }</span></div>
<div class="line"><a name="l02750"></a><span class="lineno"> 2750</span>&#160;<span class="comment">// // //             else if (sol_actflag[i] == 2) {  //active_b</span></div>
<div class="line"><a name="l02751"></a><span class="lineno"> 2751</span>&#160;<span class="comment">// // //                 Res_mu [i]  = - ineq_flag * ( c_compl * sol_eldofs[pos_ctrl][i] - c_compl * ctrl_upper[i]);</span></div>
<div class="line"><a name="l02752"></a><span class="lineno"> 2752</span>&#160;<span class="comment">// // //             }</span></div>
<div class="line"><a name="l02753"></a><span class="lineno"> 2753</span>&#160;<span class="comment">// // //         }</span></div>
<div class="line"><a name="l02754"></a><span class="lineno"> 2754</span>&#160;<span class="comment">// // // </span></div>
<div class="line"><a name="l02755"></a><span class="lineno"> 2755</span>&#160;<span class="comment">// // //      </span></div>
<div class="line"><a name="l02756"></a><span class="lineno"> 2756</span>&#160;<span class="comment">// // //         RES-&gt;insert(Res_mu, L2G_dofmap_Mat[pos_mu]);</span></div>
<div class="line"><a name="l02757"></a><span class="lineno"> 2757</span>&#160;<span class="comment">// // // </span></div>
<div class="line"><a name="l02758"></a><span class="lineno"> 2758</span>&#160;<span class="comment">// // //         //============= delta_mu-delta_ctrl row ===============================</span></div>
<div class="line"><a name="l02759"></a><span class="lineno"> 2759</span>&#160;<span class="comment">// // //         for (unsigned i = 0; i &lt; sol_actflag.size(); i++) if (sol_actflag[i] != 0 ) sol_actflag[i] = ineq_flag * c_compl;</span></div>
<div class="line"><a name="l02760"></a><span class="lineno"> 2760</span>&#160;<span class="comment">// // // </span></div>
<div class="line"><a name="l02761"></a><span class="lineno"> 2761</span>&#160;<span class="comment">// // //         JAC-&gt;matrix_set_off_diagonal_values_blocked(L2G_dofmap_Mat[pos_mu], L2G_dofmap_Mat[pos_ctrl], sol_actflag);</span></div>
<div class="line"><a name="l02762"></a><span class="lineno"> 2762</span>&#160;<span class="comment">// // // </span></div>
<div class="line"><a name="l02763"></a><span class="lineno"> 2763</span>&#160;<span class="comment">// // //         //============= delta_mu-delta_mu row ===============================</span></div>
<div class="line"><a name="l02764"></a><span class="lineno"> 2764</span>&#160;<span class="comment">// // //         for (unsigned i = 0; i &lt; sol_actflag.size(); i++) sol_actflag[i] =  ineq_flag * (1 - sol_actflag[i]/c_compl)  + (1-ineq_flag) * 1.;</span></div>
<div class="line"><a name="l02765"></a><span class="lineno"> 2765</span>&#160;<span class="comment">// // // </span></div>
<div class="line"><a name="l02766"></a><span class="lineno"> 2766</span>&#160;<span class="comment">// // //         JAC-&gt;matrix_set_off_diagonal_values_blocked(L2G_dofmap_Mat[pos_mu], L2G_dofmap_Mat[pos_mu], sol_actflag );</span></div>
<div class="line"><a name="l02767"></a><span class="lineno"> 2767</span>&#160;<span class="comment">// // // </span></div>
<div class="line"><a name="l02768"></a><span class="lineno"> 2768</span>&#160;     </div>
<div class="line"><a name="l02769"></a><span class="lineno"> 2769</span>&#160;        <span class="comment">//============= delta_ctrl-delta_mu row ===============================</span></div>
<div class="line"><a name="l02770"></a><span class="lineno"> 2770</span>&#160;        JAC-&gt;matrix_set_off_diagonal_values_blocked( L2G_dofmap_Mat[pos_ctrl], L2G_dofmap_Mat[pos_mu], ineq_flag * 1.);</div>
<div class="line"><a name="l02771"></a><span class="lineno"> 2771</span>&#160; </div>
<div class="line"><a name="l02772"></a><span class="lineno"> 2772</span>&#160;     </div>
<div class="line"><a name="l02773"></a><span class="lineno"> 2773</span>&#160;    } <span class="comment">//end element loop for each process    </span></div>
<div class="line"><a name="l02774"></a><span class="lineno"> 2774</span>&#160; <span class="comment">//   ***************** INSERT PART - END (must go AFTER the sum, clearly) *******************</span></div>
<div class="line"><a name="l02775"></a><span class="lineno"> 2775</span>&#160;   </div>
<div class="line"><a name="l02776"></a><span class="lineno"> 2776</span>&#160;  RES-&gt;close();</div>
<div class="line"><a name="l02777"></a><span class="lineno"> 2777</span>&#160;  <span class="keywordflow">if</span> (assembleMatrix) JAC-&gt;close();</div>
<div class="line"><a name="l02778"></a><span class="lineno"> 2778</span>&#160; </div>
<div class="line"><a name="l02779"></a><span class="lineno"> 2779</span>&#160; </div>
<div class="line"><a name="l02780"></a><span class="lineno"> 2780</span>&#160;  </div>
<div class="line"><a name="l02781"></a><span class="lineno"> 2781</span>&#160;  <a class="code" href="../../d8/dea/namespacefemus.html#a58e58ec75c1599370f2636943a6f6c33">print_global_residual_jacobian</a>(print_algebra_global,</div>
<div class="line"><a name="l02782"></a><span class="lineno"> 2782</span>&#160;                                 ml_prob,</div>
<div class="line"><a name="l02783"></a><span class="lineno"> 2783</span>&#160;                                 mlPdeSys,</div>
<div class="line"><a name="l02784"></a><span class="lineno"> 2784</span>&#160;                                 pdeSys,</div>
<div class="line"><a name="l02785"></a><span class="lineno"> 2785</span>&#160;                                 RES,</div>
<div class="line"><a name="l02786"></a><span class="lineno"> 2786</span>&#160;                                 JAC,</div>
<div class="line"><a name="l02787"></a><span class="lineno"> 2787</span>&#160;                                 iproc,</div>
<div class="line"><a name="l02788"></a><span class="lineno"> 2788</span>&#160;                                 assembleMatrix);</div>
<div class="line"><a name="l02789"></a><span class="lineno"> 2789</span>&#160;  </div>
<div class="line"><a name="l02790"></a><span class="lineno"> 2790</span>&#160; </div>
<div class="line"><a name="l02791"></a><span class="lineno"> 2791</span>&#160; </div>
<div class="line"><a name="l02792"></a><span class="lineno"> 2792</span>&#160;  </div>
<div class="line"><a name="l02793"></a><span class="lineno"> 2793</span>&#160;    <span class="keywordflow">return</span>;</div>
<div class="line"><a name="l02794"></a><span class="lineno"> 2794</span>&#160;}</div>
<div class="ttc" id="a03__opt__system__inequalities_8hpp_html_a4b681eb6859b04812f86861be922c517"><div class="ttname"><a href="../../de/d33/03__opt__system__inequalities_8hpp.html#a4b681eb6859b04812f86861be922c517">INEQ_FLAG</a></div><div class="ttdeci">#define INEQ_FLAG</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00011">03_opt_system_inequalities.hpp:11</a></div></div>
<div class="ttc" id="a03__opt__system__inequalities_8hpp_html_a90aa72cdc79d3af2036fdbb588d8c1d8"><div class="ttname"><a href="../../de/d33/03__opt__system__inequalities_8hpp.html#a90aa72cdc79d3af2036fdbb588d8c1d8">C_COMPL</a></div><div class="ttdeci">#define C_COMPL</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00012">03_opt_system_inequalities.hpp:12</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_a2b20da92637cd95fc41f37f3b0823724"><div class="ttname"><a href="../../df/d2a/07__fractional_8cpp.html#a2b20da92637cd95fc41f37f3b0823724">OP_H1</a></div><div class="ttdeci">#define OP_H1</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/07__fractional_8cpp_source.html#l00036">07_fractional.cpp:36</a></div></div>
<div class="ttc" id="a07__fractional_8cpp_html_aab33c985fc96acde267a7bf1a54b0a1e"><div class="ttname"><a href="../../df/d2a/07__fractional_8cpp.html#aab33c985fc96acde267a7bf1a54b0a1e">OP_L2</a></div><div class="ttdeci">#define OP_L2</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d2a/07__fractional_8cpp_source.html#l00035">07_fractional.cpp:35</a></div></div>
<div class="ttc" id="aConformal_2ex3_2ex3_8cpp_html_a4049344c4d6020a322197047b513967f"><div class="ttname"><a href="../../d8/d87/Conformal_2ex3_2ex3_8cpp.html#a4049344c4d6020a322197047b513967f">beta</a></div><div class="ttdeci">const double beta</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d87/Conformal_2ex3_2ex3_8cpp_source.html#l00023">ex3.cpp:23</a></div></div>
<div class="ttc" id="aFETypeEnum_8hpp_html_a789a31c8b16fddbe5ad66911ec7933c6"><div class="ttname"><a href="../../df/d21/FETypeEnum_8hpp.html#a789a31c8b16fddbe5ad66911ec7933c6">BIQUADR_FE</a></div><div class="ttdeci">#define BIQUADR_FE</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d21/FETypeEnum_8hpp_source.html#l00010">FETypeEnum.hpp:10</a></div></div>
<div class="ttc" id="aFETypeEnum_8hpp_html_ac6579c52f41d7124718cc41736bae6d1"><div class="ttname"><a href="../../df/d21/FETypeEnum_8hpp.html#ac6579c52f41d7124718cc41736bae6d1">NFE_FAMS</a></div><div class="ttdeci">#define NFE_FAMS</div><div class="ttdef"><b>Definition:</b> <a href="../../df/d21/FETypeEnum_8hpp_source.html#l00013">FETypeEnum.hpp:13</a></div></div>
<div class="ttc" id="aGeomElTypeEnum_8hpp_html_a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c"><div class="ttname"><a href="../../d6/d09/GeomElTypeEnum_8hpp.html#a5f4d1ffd8f6d0e4930c05074e733031dae1a12d53590e4fd25c9fd9006f19ab5c">QUAD</a></div><div class="ttdeci">@ QUAD</div><div class="ttdef"><b>Definition:</b> <a href="../../d6/d09/GeomElTypeEnum_8hpp_source.html#l00017">GeomElTypeEnum.hpp:17</a></div></div>
<div class="ttc" id="aISM_2ex4_2ex4_8cpp_html_aece1bc3fff4b670afc08354a6d995a0e"><div class="ttname"><a href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a></div><div class="ttdeci">unsigned dim</div><div class="ttdef"><b>Definition:</b> <a href="../../d8/d2c/ISM_2ex4_2ex4_8cpp_source.html#l00031">ex4.cpp:31</a></div></div>
<div class="ttc" id="aMGAMR_2ex9_2MG__precond_8m_html_ac86694252f8dfdb19aaeadc4b7c342c6"><div class="ttname"><a href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m.html#ac86694252f8dfdb19aaeadc4b7c342c6">j</a></div><div class="ttdeci">for j</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/dbc/MGAMR_2ex9_2MG__precond_8m_source.html#l00032">MG_precond.m:32</a></div></div>
<div class="ttc" id="aclassfemus_1_1ElementJacRes_html_adaae99208cf2f2f60e867d6409035f1d"><div class="ttname"><a href="../../d2/dae/classfemus_1_1ElementJacRes.html#adaae99208cf2f2f60e867d6409035f1d">femus::ElementJacRes::compute_max_n_dofs</a></div><div class="ttdeci">static unsigned int compute_max_n_dofs(const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8f/Assemble__unknown__jacres_8hpp_source.html#l00069">Assemble_unknown_jacres.hpp:69</a></div></div>
<div class="ttc" id="aclassfemus_1_1ElementJacRes_html_af9f782d3aa6f1bcee95c7eb1af72b8ec"><div class="ttname"><a href="../../d2/dae/classfemus_1_1ElementJacRes.html#af9f782d3aa6f1bcee95c7eb1af72b8ec">femus::ElementJacRes::compute_sum_n_dofs</a></div><div class="ttdeci">static unsigned int compute_sum_n_dofs(const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs)</div><div class="ttdef"><b>Definition:</b> <a href="../../d5/d8f/Assemble__unknown__jacres_8hpp_source.html#l00081">Assemble_unknown_jacres.hpp:81</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a298fb51789fa086f4ac3904b43336f76"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a298fb51789fa086f4ac3904b43336f76">femus::assemble_jacobian::res_row_index</a></div><div class="ttdeci">static unsigned int res_row_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int my_row_pos, const int i)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00284">Assemble_jacobian.hpp:284</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_a76626a28a3fa87cc055e76d189ed4660"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#a76626a28a3fa87cc055e76d189ed4660">femus::assemble_jacobian::print_element_jacobian</a></div><div class="ttdeci">static void print_element_jacobian(const unsigned int iel, const std::vector&lt; double &gt; &amp;Jac, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const unsigned int col_width_visualization, const unsigned int precision)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00221">Assemble_jacobian.hpp:221</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_af1d28f6f33acdba64d6e3c733d09f0aa"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#af1d28f6f33acdba64d6e3c733d09f0aa">femus::assemble_jacobian::print_element_residual</a></div><div class="ttdeci">static void print_element_residual(const unsigned int iel, const std::vector&lt; real_num &gt; &amp;Res, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const unsigned int col_width_visualization, const unsigned int precision)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00256">Assemble_jacobian.hpp:256</a></div></div>
<div class="ttc" id="aclassfemus_1_1assemble__jacobian_html_afafa42b312f4db1f55298eb039ada1c6"><div class="ttname"><a href="../../d4/d7a/classfemus_1_1assemble__jacobian.html#afafa42b312f4db1f55298eb039ada1c6">femus::assemble_jacobian::jac_row_col_index</a></div><div class="ttdeci">static unsigned int jac_row_col_index(const std::vector&lt; unsigned int &gt; &amp;_Sol_n_el_dofs, const int nDof_AllVars, const int my_row_pos, const int my_col_pos, const int i, const int j)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d73/Assemble__jacobian_8hpp_source.html#l00296">Assemble_jacobian.hpp:296</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality_html_a53fcde6a8cb427b5da69375d0fe7cd14"><div class="ttname"><a href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#a53fcde6a8cb427b5da69375d0fe7cd14">femus::ctrl::mixed_state_or_ctrl_inequality::update_active_set_flag_for_current_nonlinear_iteration</a></div><div class="ttdeci">static void update_active_set_flag_for_current_nonlinear_iteration(const femus::Mesh *msh, const femus::Solution *sol, const unsigned int iel, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_at_dofs, const std::vector&lt; std::vector&lt; double &gt; &gt; sol_eldofs, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, const double c_compl, const std::vector&lt; unsigned int &gt; pos_mu, const std::vector&lt; unsigned int &gt; pos_ctrl, const std::vector&lt; unsigned int &gt; solIndex_act_flag, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_lower_dofs, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_upper_dofs, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;sol_actflag_dofs)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00031">03_opt_system_inequalities.hpp:31</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality_html_aa3664a638e79db4c4ee17d8776117f30"><div class="ttname"><a href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#aa3664a638e79db4c4ee17d8776117f30">femus::ctrl::mixed_state_or_ctrl_inequality::node_insertion</a></div><div class="ttdeci">static void node_insertion(const unsigned int iel, const Mesh *msh, const vector&lt; vector&lt; int &gt; &gt; &amp;L2G_dofmap_Mat, const std::vector&lt; unsigned int &gt; pos_mat_mu, const std::vector&lt; unsigned int &gt; pos_mat_ctrl, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;sol_eldofs_Mat, const std::vector&lt; unsigned int &gt; &amp;Sol_n_el_dofs, std::vector&lt; std::vector&lt; double &gt; &gt; &amp;sol_actflag_dofs, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_lower_dofs, const std::vector&lt; std::vector&lt; double &gt; &gt; &amp;ctrl_upper_dofs, const double ineq_flag, const double c_compl, SparseMatrix *KK, NumericVector *RES, const bool assembleMatrix)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00183">03_opt_system_inequalities.hpp:183</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality_html_ad8765c4d3fe1216148aa932896951aee"><div class="ttname"><a href="../../d2/dd1/classfemus_1_1ctrl_1_1mixed__state__or__ctrl__inequality.html#ad8765c4d3fe1216148aa932896951aee">femus::ctrl::mixed_state_or_ctrl_inequality::store_act_flag_in_old</a></div><div class="ttdeci">static void store_act_flag_in_old(const NonLinearImplicitSystemWithPrimalDualActiveSetMethod *mlPdeSys, const MultiLevelSolution *ml_sol, Solution *sol, std::vector&lt; unsigned int &gt; &amp;solIndex_act_flag)</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d33/03__opt__system__inequalities_8hpp_source.html#l00426">03_opt_system_inequalities.hpp:426</a></div></div>
<div class="ttc" id="aclassfemus_1_1ctrl_1_1square__or__cube_1_1lifting__internal_html_ae8b192bf476ac8b9b8aa23671e98bc84"><div class="ttname"><a href="../../d7/d7b/classfemus_1_1ctrl_1_1square__or__cube_1_1lifting__internal.html#ae8b192bf476ac8b9b8aa23671e98bc84">femus::ctrl::square_or_cube::lifting_internal::ControlDomainFlag_internal_restriction</a></div><div class="ttdeci">static int ControlDomainFlag_internal_restriction(const std::vector&lt; double &gt; &amp;elem_center)</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d54/square__or__cube__01b__control__faces__domain__elements_8hpp_source.html#l00089">square_or_cube_01b_control_faces_domain_elements.hpp:89</a></div></div>
<div class="ttc" id="aclassfemus_1_1elliptic_1_1lifting__external_html_a86be6466c20a785bfa63545d1536fae9"><div class="ttname"><a href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#a86be6466c20a785bfa63545d1536fae9">femus::elliptic::lifting_external::find_control_boundary_nodes</a></div><div class="ttdeci">static bool find_control_boundary_nodes(std::vector&lt; unsigned int &gt; &amp;interface_node_flag, const std::vector&lt; double &gt; &amp;elem_center_bdry, const unsigned int nDofu_bdry, const unsigned int iel, const int jface, const Mesh *msh)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01948">opt_systems_elliptic_dirichlet.hpp:1948</a></div></div>
<div class="ttc" id="aclassfemus_1_1elliptic_1_1lifting__external_html_af0a9ccb75bf6f983cdb5f8573000a33c"><div class="ttname"><a href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html#af0a9ccb75bf6f983cdb5f8573000a33c">femus::elliptic::lifting_external::compute_coordinates_bdry_one_face</a></div><div class="ttdeci">static void compute_coordinates_bdry_one_face(std::vector&lt; std::vector&lt; double &gt; &gt; &amp;coords_at_dofs_bdry, const int solType_coords, const unsigned int iel, const int jface, const Mesh *msh)</div><div class="ttdef"><b>Definition:</b> <a href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01926">opt_systems_elliptic_dirichlet.hpp:1926</a></div></div>
<div class="ttc" id="aclassfemus_1_1lifting__external_html_a3a29ef8490dc93fc0f45f5376e323a61"><div class="ttname"><a href="../../de/da3/classfemus_1_1lifting__external.html#a3a29ef8490dc93fc0f45f5376e323a61">femus::lifting_external::_neumann_adjoint_explicit</a></div><div class="ttdeci">static constexpr int _neumann_adjoint_explicit</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d91/01__opt__system_8hpp_source.html#l00060">01_opt_system.hpp:60</a></div></div>
<div class="ttc" id="aclassfemus_1_1lifting__external_html_a65401ffd4bdad0456d123751e028576a"><div class="ttname"><a href="../../de/da3/classfemus_1_1lifting__external.html#a65401ffd4bdad0456d123751e028576a">femus::lifting_external::_u_minus_q_strong</a></div><div class="ttdeci">static constexpr int _u_minus_q_strong</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d91/01__opt__system_8hpp_source.html#l00062">01_opt_system.hpp:62</a></div></div>
<div class="ttc" id="aclassfemus_1_1lifting__external_html_ad347558b2dc39abe98d8ff7ced798a3c"><div class="ttname"><a href="../../de/da3/classfemus_1_1lifting__external.html#ad347558b2dc39abe98d8ff7ced798a3c">femus::lifting_external::_neumann_adjoint_continuity_sign</a></div><div class="ttdeci">static constexpr int _neumann_adjoint_continuity_sign</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d91/01__opt__system_8hpp_source.html#l00061">01_opt_system.hpp:61</a></div></div>
<div class="ttc" id="aelliptic__nonlin__param_8hpp_html_a516ea8ebb0823e8c37feff8f4fe5afd1"><div class="ttname"><a href="../../dc/d47/elliptic__nonlin__param_8hpp.html#a516ea8ebb0823e8c37feff8f4fe5afd1">BETA_CTRL_VOL</a></div><div class="ttdeci">#define BETA_CTRL_VOL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d47/elliptic__nonlin__param_8hpp_source.html#l00013">elliptic_nonlin_param.hpp:13</a></div></div>
<div class="ttc" id="aelliptic__nonlin__param_8hpp_html_ab6042dc7aa551272ad555cac7a27efca"><div class="ttname"><a href="../../dc/d47/elliptic__nonlin__param_8hpp.html#ab6042dc7aa551272ad555cac7a27efca">ALPHA_CTRL_VOL</a></div><div class="ttdeci">#define ALPHA_CTRL_VOL</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d47/elliptic__nonlin__param_8hpp_source.html#l00012">elliptic_nonlin_param.hpp:12</a></div></div>
<div class="ttc" id="aelliptic__nonlin__param_8hpp_html_ac26c656f6cba791120e68b91d327f1f0"><div class="ttname"><a href="../../dc/d47/elliptic__nonlin__param_8hpp.html#ac26c656f6cba791120e68b91d327f1f0">ElementTargetFlag</a></div><div class="ttdeci">int ElementTargetFlag(const std::vector&lt; double &gt; &amp;elem_center)</div><div class="ttdef"><b>Definition:</b> <a href="../../dc/d47/elliptic__nonlin__param_8hpp_source.html#l00039">elliptic_nonlin_param.hpp:39</a></div></div>
<div class="ttc" id="anamespacefemus_html_a58e58ec75c1599370f2636943a6f6c33"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a58e58ec75c1599370f2636943a6f6c33">femus::print_global_residual_jacobian</a></div><div class="ttdeci">void print_global_residual_jacobian(const bool print_algebra_global, const MultiLevelProblem &amp;ml_prob, const NonLinearImplicitSystem *mlPdeSys, LinearEquationSolver *pdeSys, NumericVector *RES, SparseMatrix *JAC, const unsigned iproc, const bool assembleMatrix)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d27/Assemble__useful__functions_8hpp_source.html#l00073">Assemble_useful_functions.hpp:73</a></div></div>
<div class="ttc" id="anamespacefemus_html_a865501b20d45caeb12e3f10935e38cf6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a865501b20d45caeb12e3f10935e38cf6">femus::ig</a></div><div class="ttdeci">const unsigned ig[N_GEOM_ELS][6][9]</div><div class="ttdef"><b>Definition:</b> <a href="../../db/d97/Elem_8hpp_source.html#l00345">Elem.hpp:345</a></div></div>
<div class="ttc" id="anamespacefemus_html_aa2fa50068a407963c5f2ef841333b326"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#aa2fa50068a407963c5f2ef841333b326">femus::el_dofs_unknowns_vol</a></div><div class="ttdeci">void el_dofs_unknowns_vol(const Solution *sol, const Mesh *msh, const LinearEquationSolver *pdeSys, const unsigned int iel, const vector&lt; unsigned &gt; &amp;SolFEType, const vector&lt; unsigned &gt; &amp;SolIndex, const vector&lt; unsigned &gt; &amp;SolPdeIndex, vector&lt; unsigned &gt; &amp;Sol_n_el_dofs, vector&lt; vector&lt; double &gt; &gt; &amp;sol_eldofs, vector&lt; vector&lt; int &gt; &gt; &amp;L2G_dofmap)</div><div class="ttdef"><b>Definition:</b> <a href="../../d9/d27/Assemble__useful__functions_8hpp_source.html#l00041">Assemble_useful_functions.hpp:41</a></div></div>
<div class="ttc" id="aparam_8hpp_html_ab3522889778a2c7dc1e90150a08c0d21"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#ab3522889778a2c7dc1e90150a08c0d21">GROUP_INTERNAL</a></div><div class="ttdeci">#define GROUP_INTERNAL</div><div class="ttdoc">‍********domain dependent -BEGIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0b/param_8hpp_source.html#l00184">param.hpp:184</a></div></div>
<div class="ttc" id="aparam_8hpp_html_acf7ddf5f7ed48e02b57e6573e82f53f4"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#acf7ddf5f7ed48e02b57e6573e82f53f4">GROUP_EXTERNAL</a></div><div class="ttdeci">#define GROUP_EXTERNAL</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0b/param_8hpp_source.html#l00185">param.hpp:185</a></div></div>
<div class="ttc" id="asolidopt__params_8hpp_html_a20f4c4490bc8ecbdd1ffcb79acce6035"><div class="ttname"><a href="../../de/d58/solidopt__params_8hpp.html#a20f4c4490bc8ecbdd1ffcb79acce6035">alpha</a></div><div class="ttdeci">double alpha</div><div class="ttdef"><b>Definition:</b> <a href="../../de/d58/solidopt__params_8hpp_source.html#l00026">solidopt_params.hpp:26</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="af0a9ccb75bf6f983cdb5f8573000a33c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af0a9ccb75bf6f983cdb5f8573000a33c">&#9670;&nbsp;</a></span>compute_coordinates_bdry_one_face()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static void femus::elliptic::lifting_external::compute_coordinates_bdry_one_face </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; std::vector&lt; double &gt; &gt; &amp;&#160;</td>
          <td class="paramname"><em>coords_at_dofs_bdry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>solType_coords</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/db7/classfemus_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>msh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01926">1926</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01926"></a><span class="lineno"> 1926</span>&#160;                                                                                                                                                                                            {</div>
<div class="line"><a name="l01927"></a><span class="lineno"> 1927</span>&#160;    </div>
<div class="line"><a name="l01928"></a><span class="lineno"> 1928</span>&#160;     <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a> = coords_at_dofs_bdry.size();</div>
<div class="line"><a name="l01929"></a><span class="lineno"> 1929</span>&#160;     </div>
<div class="line"><a name="l01930"></a><span class="lineno"> 1930</span>&#160;            <span class="keywordtype">unsigned</span> nDofx_bdry    = msh-&gt;GetElementFaceDofNumber(iel,jface,solType_coords);</div>
<div class="line"><a name="l01931"></a><span class="lineno"> 1931</span>&#160; </div>
<div class="line"><a name="l01932"></a><span class="lineno"> 1932</span>&#160;            <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> idim = 0; idim &lt; <a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><a name="l01933"></a><span class="lineno"> 1933</span>&#160;                coords_at_dofs_bdry[idim].resize(nDofx_bdry);</div>
<div class="line"><a name="l01934"></a><span class="lineno"> 1934</span>&#160;            }</div>
<div class="line"><a name="l01935"></a><span class="lineno"> 1935</span>&#160;            </div>
<div class="line"><a name="l01936"></a><span class="lineno"> 1936</span>&#160;            <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> i=0; i &lt; nDofx_bdry; i++) {</div>
<div class="line"><a name="l01937"></a><span class="lineno"> 1937</span>&#160;                <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, i);</div>
<div class="line"><a name="l01938"></a><span class="lineno"> 1938</span>&#160;                <span class="keywordtype">unsigned</span> iDof = msh-&gt;GetSolutionDof(i_vol, iel, solType_coords);</div>
<div class="line"><a name="l01939"></a><span class="lineno"> 1939</span>&#160;                <span class="keywordflow">for</span>(<span class="keywordtype">unsigned</span> idim=0; idim&lt;<a class="code" href="../../d8/d2c/ISM_2ex4_2ex4_8cpp.html#aece1bc3fff4b670afc08354a6d995a0e">dim</a>; idim++) {</div>
<div class="line"><a name="l01940"></a><span class="lineno"> 1940</span>&#160;                    coords_at_dofs_bdry[idim][i]=(*msh-&gt;_topology-&gt;_Sol[idim])(iDof);</div>
<div class="line"><a name="l01941"></a><span class="lineno"> 1941</span>&#160;                }</div>
<div class="line"><a name="l01942"></a><span class="lineno"> 1942</span>&#160;            }</div>
<div class="line"><a name="l01943"></a><span class="lineno"> 1943</span>&#160; </div>
<div class="line"><a name="l01944"></a><span class="lineno"> 1944</span>&#160;}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a86be6466c20a785bfa63545d1536fae9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a86be6466c20a785bfa63545d1536fae9">&#9670;&nbsp;</a></span>find_control_boundary_nodes()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">static bool femus::elliptic::lifting_external::find_control_boundary_nodes </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>interface_node_flag</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>elem_center_bdry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>nDofu_bdry</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const unsigned int&#160;</td>
          <td class="paramname"><em>iel</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>jface</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d6/db7/classfemus_1_1Mesh.html">Mesh</a> *&#160;</td>
          <td class="paramname"><em>msh</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">static</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html#l01948">1948</a> of file <a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a>.</p>
<div class="fragment"><div class="line"><a name="l01948"></a><span class="lineno"> 1948</span>&#160;                                                                                                                                                                                                                              {</div>
<div class="line"><a name="l01949"></a><span class="lineno"> 1949</span>&#160;   </div>
<div class="line"><a name="l01950"></a><span class="lineno"> 1950</span>&#160;       <span class="keyword">enum</span> begin_end {begin = 0, end};</div>
<div class="line"><a name="l01951"></a><span class="lineno"> 1951</span>&#160;       </div>
<div class="line"><a name="l01952"></a><span class="lineno"> 1952</span>&#160;      std::vector&lt; std::vector&lt;double&gt; &gt; coords_bdry_control_face(2);</div>
<div class="line"><a name="l01953"></a><span class="lineno"> 1953</span>&#160;   </div>
<div class="line"><a name="l01954"></a><span class="lineno"> 1954</span>&#160;                    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> be = 0; be &lt; 2; be++)  {</div>
<div class="line"><a name="l01955"></a><span class="lineno"> 1955</span>&#160;                       coords_bdry_control_face[be].resize(elem_center_bdry.size());</div>
<div class="line"><a name="l01956"></a><span class="lineno"> 1956</span>&#160;                        std::fill(coords_bdry_control_face[be].begin(), coords_bdry_control_face[be].end(), 0.);</div>
<div class="line"><a name="l01957"></a><span class="lineno"> 1957</span>&#160;                    }</div>
<div class="line"><a name="l01958"></a><span class="lineno"> 1958</span>&#160;                    </div>
<div class="line"><a name="l01959"></a><span class="lineno"> 1959</span>&#160;                    coords_bdry_control_face[begin][0] = 1.;</div>
<div class="line"><a name="l01960"></a><span class="lineno"> 1960</span>&#160;                    coords_bdry_control_face[end][0] = 1.;</div>
<div class="line"><a name="l01961"></a><span class="lineno"> 1961</span>&#160;                    coords_bdry_control_face[begin][1] = <a class="code" href="../../d4/d0b/param_8hpp.html#a15d2f12bb5524968e0c6a8bcec8cc08e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MIN</a>;</div>
<div class="line"><a name="l01962"></a><span class="lineno"> 1962</span>&#160;                    coords_bdry_control_face[end][1] = <a class="code" href="../../d4/d0b/param_8hpp.html#a5ea340eac1c4a4fed28126e4d9d5c26e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MAX</a>;</div>
<div class="line"><a name="l01963"></a><span class="lineno"> 1963</span>&#160;                    </div>
<div class="line"><a name="l01964"></a><span class="lineno"> 1964</span>&#160;     </div>
<div class="line"><a name="l01965"></a><span class="lineno"> 1965</span>&#160;  <span class="keywordtype">bool</span> interface_elem_flag = <span class="keyword">false</span>;</div>
<div class="line"><a name="l01966"></a><span class="lineno"> 1966</span>&#160;            <span class="keyword">const</span> <span class="keywordtype">double</span> my_eps = 1.e-6;</div>
<div class="line"><a name="l01967"></a><span class="lineno"> 1967</span>&#160;            </div>
<div class="line"><a name="l01968"></a><span class="lineno"> 1968</span>&#160;<span class="comment">//             if (elem_center_bdry[0] &gt; 1. - my_eps   &amp;&amp; elem_center_bdry[0] &lt; 1.   + my_eps  &amp;&amp;</span></div>
<div class="line"><a name="l01969"></a><span class="lineno"> 1969</span>&#160;<span class="comment">//                     elem_center_bdry[1] &gt; 0. - my_eps &amp;&amp; elem_center_bdry[1] &lt; 1. + my_eps)</span></div>
<div class="line"><a name="l01970"></a><span class="lineno"> 1970</span>&#160;            <span class="keywordflow">if</span> (elem_center_bdry[0] &gt; coords_bdry_control_face[begin][0] - my_eps   &amp;&amp; elem_center_bdry[0] &lt; coords_bdry_control_face[end][0] + my_eps  &amp;&amp;</div>
<div class="line"><a name="l01971"></a><span class="lineno"> 1971</span>&#160;                elem_center_bdry[1] &gt; coords_bdry_control_face[begin][1] - my_eps   &amp;&amp; elem_center_bdry[1] &lt; coords_bdry_control_face[end][1] + my_eps)</div>
<div class="line"><a name="l01972"></a><span class="lineno"> 1972</span>&#160;            {</div>
<div class="line"><a name="l01973"></a><span class="lineno"> 1973</span>&#160;                </div>
<div class="line"><a name="l01974"></a><span class="lineno"> 1974</span>&#160;                std::cout &lt;&lt; <span class="stringliteral">&quot; bdry elem on interface with center &quot;</span> &lt;&lt; <span class="stringliteral">&quot;(&quot;</span> &lt;&lt; elem_center_bdry[0] &lt;&lt; <span class="stringliteral">&quot;,&quot;</span> &lt;&lt; elem_center_bdry[1] &lt;&lt; <span class="stringliteral">&quot;)&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><a name="l01975"></a><span class="lineno"> 1975</span>&#160;                </div>
<div class="line"><a name="l01976"></a><span class="lineno"> 1976</span>&#160;             interface_elem_flag = <span class="keyword">true</span>;</div>
<div class="line"><a name="l01977"></a><span class="lineno"> 1977</span>&#160;                </div>
<div class="line"><a name="l01978"></a><span class="lineno"> 1978</span>&#160;                <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i_bdry = 0; i_bdry &lt; nDofu_bdry; i_bdry++)  {</div>
<div class="line"><a name="l01979"></a><span class="lineno"> 1979</span>&#160;                    <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i_vol = msh-&gt;GetLocalFaceVertexIndex(iel, jface, i_bdry);</div>
<div class="line"><a name="l01980"></a><span class="lineno"> 1980</span>&#160;                    interface_node_flag[i_vol] = 1;</div>
<div class="line"><a name="l01981"></a><span class="lineno"> 1981</span>&#160;                   }</div>
<div class="line"><a name="l01982"></a><span class="lineno"> 1982</span>&#160; </div>
<div class="line"><a name="l01983"></a><span class="lineno"> 1983</span>&#160; </div>
<div class="line"><a name="l01984"></a><span class="lineno"> 1984</span>&#160;               }</div>
<div class="line"><a name="l01985"></a><span class="lineno"> 1985</span>&#160; </div>
<div class="line"><a name="l01986"></a><span class="lineno"> 1986</span>&#160;      <span class="keywordflow">return</span> interface_elem_flag;</div>
<div class="line"><a name="l01987"></a><span class="lineno"> 1987</span>&#160;      </div>
<div class="line"><a name="l01988"></a><span class="lineno"> 1988</span>&#160;}</div>
<div class="ttc" id="aparam_8hpp_html_a15d2f12bb5524968e0c6a8bcec8cc08e"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#a15d2f12bb5524968e0c6a8bcec8cc08e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MIN</a></div><div class="ttdeci">#define SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MIN</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0b/param_8hpp_source.html#l00019">param.hpp:19</a></div></div>
<div class="ttc" id="aparam_8hpp_html_a5ea340eac1c4a4fed28126e4d9d5c26e"><div class="ttname"><a href="../../d4/d0b/param_8hpp.html#a5ea340eac1c4a4fed28126e4d9d5c26e">SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MAX</a></div><div class="ttdeci">#define SQUARE_OR_CUBE__CONTROL_FACE_TANG_COORD_MAX</div><div class="ttdef"><b>Definition:</b> <a href="../../d4/d0b/param_8hpp_source.html#l00020">param.hpp:20</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="ad347558b2dc39abe98d8ff7ced798a3c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ad347558b2dc39abe98d8ff7ced798a3c">&#9670;&nbsp;</a></span>_neumann_adjoint_continuity_sign</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int femus::lifting_external::_neumann_adjoint_continuity_sign = -1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html#l00061">61</a> of file <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html">01_opt_system.hpp</a>.</p>

</div>
</div>
<a id="a3a29ef8490dc93fc0f45f5376e323a61"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a29ef8490dc93fc0f45f5376e323a61">&#9670;&nbsp;</a></span>_neumann_adjoint_explicit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int femus::lifting_external::_neumann_adjoint_explicit = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html#l00060">60</a> of file <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html">01_opt_system.hpp</a>.</p>

</div>
</div>
<a id="a65401ffd4bdad0456d123751e028576a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a65401ffd4bdad0456d123751e028576a">&#9670;&nbsp;</a></span>_u_minus_q_strong</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">constexpr int femus::lifting_external::_u_minus_q_strong = 1</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">constexpr</span><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p class="definition">Definition at line <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html#l00062">62</a> of file <a class="el" href="../../db/d91/01__opt__system_8hpp_source.html">01_opt_system.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following file:<ul>
<li>/home/ehsan/Desktop/insync_Poweredge/work/doxygen/femus/applications/OptimalControl/<a class="el" href="../../dd/d03/opt__systems__elliptic__dirichlet_8hpp_source.html">opt_systems_elliptic_dirichlet.hpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/dea/namespacefemus.html">femus</a></li><li class="navelem"><a class="el" href="../../df/d9f/namespacefemus_1_1elliptic.html">elliptic</a></li><li class="navelem"><a class="el" href="../../d7/d9a/classfemus_1_1elliptic_1_1lifting__external.html">lifting_external</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.1 </li>
  </ul>
</div>
</body>
</html>
