<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.9.7"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>femus: femus::PetscVector Class Reference</title>
<link href="../../tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../jquery.js"></script>
<script type="text/javascript" src="../../dynsections.js"></script>
<link href="../../navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../resize.js"></script>
<script type="text/javascript" src="../../navtreedata.js"></script>
<script type="text/javascript" src="../../navtree.js"></script>
<link href="../../search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="../../search/searchdata.js"></script>
<script type="text/javascript" src="../../search/search.js"></script>
<link href="../../doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectalign">
   <div id="projectname">femus
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.9.7 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "../../search/",'.html');
/* @license-end */
</script>
<script type="text/javascript" src="../../menudata.js"></script>
<script type="text/javascript" src="../../menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('../../',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(document).ready(function(){initNavTree('d2/d9c/classfemus_1_1_petsc_vector.html','../../'); initResizable(); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div class="header">
  <div class="summary">
<a href="#pub-methods">Public Member Functions</a> &#124;
<a href="#pub-static-methods">Static Public Member Functions</a> &#124;
<a href="#pro-methods">Protected Member Functions</a> &#124;
<a href="#pro-attribs">Protected Attributes</a> &#124;
<a href="#pri-types">Private Types</a> &#124;
<a href="#pri-attribs">Private Attributes</a> &#124;
<a href="../../d5/d23/classfemus_1_1_petsc_vector-members.html">List of all members</a>  </div>
  <div class="headertitle"><div class="title">femus::PetscVector Class Reference</div></div>
</div><!--header-->
<div class="contents">

<p><code>#include &lt;<a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>&gt;</code></p>
<div class="dynheader">
Inheritance diagram for femus::PetscVector:</div>
<div class="dyncontent">
 <div class="center">
  <img src="../../d2/d9c/classfemus_1_1_petsc_vector.png" usemap="#femus::PetscVector_map" alt=""/>
  <map id="femus::PetscVector_map" name="femus::PetscVector_map">
<area href="../../da/d12/classfemus_1_1_numeric_vector.html" alt="femus::NumericVector" shape="rect" coords="0,0,136,24"/>
  </map>
</div></div>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-methods" name="pub-methods"></a>
Public Member Functions</h2></td></tr>
<tr class="memitem:a97a488763d754a507a0aa1a600f2a0e8"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a> (const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>=<a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)</td></tr>
<tr class="memdesc:a97a488763d754a507a0aa1a600f2a0e8"><td class="mdescLeft">&#160;</td><td class="mdescRight">Dummy-Constructor. Dimension=0.  <br /></td></tr>
<tr class="separator:a97a488763d754a507a0aa1a600f2a0e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab61fb7838cf5cf235307e18362eb44b4"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ab61fb7838cf5cf235307e18362eb44b4">PetscVector</a> (const int n, const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>=<a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)</td></tr>
<tr class="memdesc:ab61fb7838cf5cf235307e18362eb44b4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. Set dimension to <code>n</code> and initialize all elements with zero.  <br /></td></tr>
<tr class="separator:ab61fb7838cf5cf235307e18362eb44b4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a66f41afbaf8d486c5662c66fdf920a0a"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a66f41afbaf8d486c5662c66fdf920a0a">PetscVector</a> (const int n, const int n_local, const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>=<a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)</td></tr>
<tr class="separator:a66f41afbaf8d486c5662c66fdf920a0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac838d4451e3800f1190cf1fc67376577"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac838d4451e3800f1190cf1fc67376577">PetscVector</a> (const int <a class="el" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>, const int n_local, const std::vector&lt; int &gt; &amp;ghost, const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>=<a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)</td></tr>
<tr class="memdesc:ac838d4451e3800f1190cf1fc67376577"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. Set local dimension to <code>n_local</code>, the global dimension to <code>n</code>.  <br /></td></tr>
<tr class="separator:ac838d4451e3800f1190cf1fc67376577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a155bd65a41657efbeabc8a9b0805ab63"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a155bd65a41657efbeabc8a9b0805ab63">PetscVector</a> (Vec v)</td></tr>
<tr class="memdesc:a155bd65a41657efbeabc8a9b0805ab63"><td class="mdescLeft">&#160;</td><td class="mdescRight">Constructor. Creates a <a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a> assuming a valid PETSc Vec object.  <br /></td></tr>
<tr class="separator:a155bd65a41657efbeabc8a9b0805ab63"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:abce13bebc1333766fdd631f6def08ba1"><td class="memItemLeft" align="right" valign="top">&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#abce13bebc1333766fdd631f6def08ba1">~PetscVector</a> ()</td></tr>
<tr class="memdesc:abce13bebc1333766fdd631f6def08ba1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Destructor, deallocates memory.  <br /></td></tr>
<tr class="separator:abce13bebc1333766fdd631f6def08ba1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa25bb3fa43aa9c5e5de7b5772a4d386c"><td class="memItemLeft" align="right" valign="top">std::unique_ptr&lt; <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aa25bb3fa43aa9c5e5de7b5772a4d386c">clone</a> () const</td></tr>
<tr class="memdesc:aa25bb3fa43aa9c5e5de7b5772a4d386c"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a copy of this vector and returns it in an <code>AutoPtr</code>.  <br /></td></tr>
<tr class="separator:aa25bb3fa43aa9c5e5de7b5772a4d386c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68fd9a4430cff15afec82d63479c4227"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a> ()</td></tr>
<tr class="memdesc:a68fd9a4430cff15afec82d63479c4227"><td class="mdescLeft">&#160;</td><td class="mdescRight">Call the assemble functions.  <br /></td></tr>
<tr class="separator:a68fd9a4430cff15afec82d63479c4227"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae203746f2ff75bdc4febe35e3d637d18"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae203746f2ff75bdc4febe35e3d637d18">closeWithMinValues</a> ()</td></tr>
<tr class="separator:ae203746f2ff75bdc4febe35e3d637d18"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a157618d9b5afa9ba23a7f62121194960"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a157618d9b5afa9ba23a7f62121194960">clear</a> ()</td></tr>
<tr class="memdesc:a157618d9b5afa9ba23a7f62121194960"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the <code><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a></code> to a pristine state.  <br /></td></tr>
<tr class="separator:a157618d9b5afa9ba23a7f62121194960"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aab9b165d31a203194f7b82071343358c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aab9b165d31a203194f7b82071343358c">init</a> (const int <a class="el" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>, const int n_local, const bool fast=false, const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>=<a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)</td></tr>
<tr class="separator:aab9b165d31a203194f7b82071343358c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2bcb23296dec3bf06d653d0dcf1912ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a2bcb23296dec3bf06d653d0dcf1912ea">init</a> (const int <a class="el" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a78d6eaf1636482a27da7047fd73c78c3">N</a>, const bool fast=false, const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>=<a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)</td></tr>
<tr class="memdesc:a2bcb23296dec3bf06d653d0dcf1912ea"><td class="mdescLeft">&#160;</td><td class="mdescRight">call init with n_local = N,  <br /></td></tr>
<tr class="separator:a2bcb23296dec3bf06d653d0dcf1912ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4db1fba2a01663ccd6facc3e51a06ca4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a4db1fba2a01663ccd6facc3e51a06ca4">init</a> (const int, const int, const std::vector&lt; int &gt; &amp;, const bool=false, const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>=<a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)</td></tr>
<tr class="memdesc:a4db1fba2a01663ccd6facc3e51a06ca4"><td class="mdescLeft">&#160;</td><td class="mdescRight">Create a vector that holds tha local indices plus those specified in the <code>ghost</code> argument.  <br /></td></tr>
<tr class="separator:a4db1fba2a01663ccd6facc3e51a06ca4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5b41059f33c40724038fc2c9f317de85"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5b41059f33c40724038fc2c9f317de85">init</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;other, const bool fast=false)</td></tr>
<tr class="memdesc:a5b41059f33c40724038fc2c9f317de85"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a vector that has the same dimension.  <br /></td></tr>
<tr class="separator:a5b41059f33c40724038fc2c9f317de85"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adb2885699276be01494525805c9252a8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#adb2885699276be01494525805c9252a8">set</a> (const int i, const double value)</td></tr>
<tr class="memdesc:adb2885699276be01494525805c9252a8"><td class="mdescLeft">&#160;</td><td class="mdescRight">v(i) = value  <br /></td></tr>
<tr class="separator:adb2885699276be01494525805c9252a8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5a93581252131e7434dd3a8c0d242bd2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">add</a> (const int i, const double value)</td></tr>
<tr class="memdesc:a5a93581252131e7434dd3a8c0d242bd2"><td class="mdescLeft">&#160;</td><td class="mdescRight">v(i) += value  <br /></td></tr>
<tr class="separator:a5a93581252131e7434dd3a8c0d242bd2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac59f171adcae52dd1777b3f09941771b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac59f171adcae52dd1777b3f09941771b">zero</a> ()</td></tr>
<tr class="memdesc:ac59f171adcae52dd1777b3f09941771b"><td class="mdescLeft">&#160;</td><td class="mdescRight">Set all entries to zero. Equivalent to <code>v</code> = 0.  <br /></td></tr>
<tr class="separator:ac59f171adcae52dd1777b3f09941771b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6b19b09c93227d33ac093ec32e1436ac"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a6b19b09c93227d33ac093ec32e1436ac">operator=</a> (const double <a class="el" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>)</td></tr>
<tr class="memdesc:a6b19b09c93227d33ac093ec32e1436ac"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_2_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U(0-N) = s$" src="../../form_2.png"/></picture>: fill all components.  <br /></td></tr>
<tr class="separator:a6b19b09c93227d33ac093ec32e1436ac"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9b59acc5f585aa2c2ecc0dbbe64a9657"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9b59acc5f585aa2c2ecc0dbbe64a9657">operator=</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V)</td></tr>
<tr class="memdesc:a9b59acc5f585aa2c2ecc0dbbe64a9657"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U = V$" src="../../form_3.png"/></picture>: copy all components.  <br /></td></tr>
<tr class="separator:a9b59acc5f585aa2c2ecc0dbbe64a9657"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adf08268d805ffac0def033769e0b5c3a"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#adf08268d805ffac0def033769e0b5c3a">operator=</a> (const <a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a> &amp;V)</td></tr>
<tr class="memdesc:adf08268d805ffac0def033769e0b5c3a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U = V$" src="../../form_3.png"/></picture>: copy all components.  <br /></td></tr>
<tr class="separator:adf08268d805ffac0def033769e0b5c3a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2b8d11a241f5e04209e1bf6b387ec845"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a2b8d11a241f5e04209e1bf6b387ec845">operator=</a> (const std::vector&lt; double &gt; &amp;v)</td></tr>
<tr class="memdesc:a2b8d11a241f5e04209e1bf6b387ec845"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U = V$" src="../../form_3.png"/></picture>: copy all components.  <br /></td></tr>
<tr class="separator:a2b8d11a241f5e04209e1bf6b387ec845"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a166857b39031681311dd999d0012c3e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a166857b39031681311dd999d0012c3e8">insert</a> (const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:a166857b39031681311dd999d0012c3e8"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_4_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U=v $" src="../../form_4.png"/></picture> where v is a std::vector&lt;double&gt;  <br /></td></tr>
<tr class="separator:a166857b39031681311dd999d0012c3e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a12109d30e50e3fcfc297f39efe0626e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a12109d30e50e3fcfc297f39efe0626e4">insert</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:a12109d30e50e3fcfc297f39efe0626e4"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U=V$" src="../../form_5.png"/></picture>, where U and V are type <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> and you  <br /></td></tr>
<tr class="separator:a12109d30e50e3fcfc297f39efe0626e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae2f10f91a6d1ace136d76318e1367985"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae2f10f91a6d1ace136d76318e1367985">insert</a> (const <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a> &amp;V, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:ae2f10f91a6d1ace136d76318e1367985"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_6_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U=V $" src="../../form_6.png"/></picture> where V is type <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a>  <br /></td></tr>
<tr class="separator:ae2f10f91a6d1ace136d76318e1367985"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:afb25416c2bc4a3a6b3804667e45cf4e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#afb25416c2bc4a3a6b3804667e45cf4e3">insert</a> (const <a class="el" href="../../dd/d6a/classfemus_1_1_dense_sub_vector.html">DenseSubVector</a> &amp;V, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:afb25416c2bc4a3a6b3804667e45cf4e3"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_6_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U=V $" src="../../form_6.png"/></picture> where V is type <a class="el" href="../../dd/d6a/classfemus_1_1_dense_sub_vector.html">DenseSubVector</a>  <br /></td></tr>
<tr class="separator:afb25416c2bc4a3a6b3804667e45cf4e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a42bc9e11eda70d07852aee9b4fcd9e22"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a> ()</td></tr>
<tr class="separator:a42bc9e11eda70d07852aee9b4fcd9e22"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3bbc9e00cee5c0c3bc20487f48a6d72a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3bbc9e00cee5c0c3bc20487f48a6d72a">min</a> () const</td></tr>
<tr class="memdesc:a3bbc9e00cee5c0c3bc20487f48a6d72a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the minimum element in the vector.  <br /></td></tr>
<tr class="separator:a3bbc9e00cee5c0c3bc20487f48a6d72a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7e45ab5b4889bc59dcaf0413f5253b86"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a7e45ab5b4889bc59dcaf0413f5253b86">max</a> () const</td></tr>
<tr class="memdesc:a7e45ab5b4889bc59dcaf0413f5253b86"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the maximum element in the vector.  <br /></td></tr>
<tr class="separator:a7e45ab5b4889bc59dcaf0413f5253b86"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a04089695a2db68bc91295f18ff1ea297"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a04089695a2db68bc91295f18ff1ea297">sum</a> () const</td></tr>
<tr class="memdesc:a04089695a2db68bc91295f18ff1ea297"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the sum of values in a vector.  <br /></td></tr>
<tr class="separator:a04089695a2db68bc91295f18ff1ea297"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a6e8ed7e8b882c5b283a5dca742b7999b"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a6e8ed7e8b882c5b283a5dca742b7999b">l1_norm</a> () const</td></tr>
<tr class="memdesc:a6e8ed7e8b882c5b283a5dca742b7999b"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the <picture><source srcset="../../form_7_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$l_1$" src="../../form_7.png"/></picture>-norm of the vector.  <br /></td></tr>
<tr class="separator:a6e8ed7e8b882c5b283a5dca742b7999b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a645238b7fe1b4851c0e4b6c067bf428a"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a645238b7fe1b4851c0e4b6c067bf428a">l2_norm</a> () const</td></tr>
<tr class="memdesc:a645238b7fe1b4851c0e4b6c067bf428a"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the <picture><source srcset="../../form_8_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$l_2$" src="../../form_8.png"/></picture>-norm of the vector.  <br /></td></tr>
<tr class="separator:a645238b7fe1b4851c0e4b6c067bf428a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae8e2c6894f258aecc1d4707576cf3577"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae8e2c6894f258aecc1d4707576cf3577">linfty_norm</a> () const</td></tr>
<tr class="memdesc:ae8e2c6894f258aecc1d4707576cf3577"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the maximum absolute value of the elements of this vector.  <br /></td></tr>
<tr class="separator:ae8e2c6894f258aecc1d4707576cf3577"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a55b897177341e239c8ea36e0852ba213"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a> () const</td></tr>
<tr class="memdesc:a55b897177341e239c8ea36e0852ba213"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns dimension of the vector.  <br /></td></tr>
<tr class="separator:a55b897177341e239c8ea36e0852ba213"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a282ee28379f76d570c36a798d72a5484"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a> () const</td></tr>
<tr class="memdesc:a282ee28379f76d570c36a798d72a5484"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the local size of the vector (index_stop-index_start)  <br /></td></tr>
<tr class="separator:a282ee28379f76d570c36a798d72a5484"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0721bc1a1506471210879d543e7fe6fc"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">first_local_index</a> () const</td></tr>
<tr class="memdesc:a0721bc1a1506471210879d543e7fe6fc"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the index of the first vector element.  <br /></td></tr>
<tr class="separator:a0721bc1a1506471210879d543e7fe6fc"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4a613475cbe83e68cc42997ab1749c1f"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a4a613475cbe83e68cc42997ab1749c1f">last_local_index</a> () const</td></tr>
<tr class="memdesc:a4a613475cbe83e68cc42997ab1749c1f"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function returns the index of the last vector element.  <br /></td></tr>
<tr class="separator:a4a613475cbe83e68cc42997ab1749c1f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a56ca5070aac99c844908d46309949a7c"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a56ca5070aac99c844908d46309949a7c">map_global_to_local_index</a> (const int i) const</td></tr>
<tr class="separator:a56ca5070aac99c844908d46309949a7c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2f9ce3bea02e59a55505ed80e7ea26bb"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a2f9ce3bea02e59a55505ed80e7ea26bb">operator()</a> (const int i) const</td></tr>
<tr class="memdesc:a2f9ce3bea02e59a55505ed80e7ea26bb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Access components, returns <code>U(i)</code>.  <br /></td></tr>
<tr class="separator:a2f9ce3bea02e59a55505ed80e7ea26bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac13d5c896c438e020242dc1398a27f2"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aac13d5c896c438e020242dc1398a27f2">get</a> (const std::vector&lt; int &gt; &amp;index, std::vector&lt; double &gt; &amp;values) const</td></tr>
<tr class="separator:aac13d5c896c438e020242dc1398a27f2"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a249c6773bf5506aaf21adec7dae3c676"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a249c6773bf5506aaf21adec7dae3c676">operator+=</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V)</td></tr>
<tr class="memdesc:a249c6773bf5506aaf21adec7dae3c676"><td class="mdescLeft">&#160;</td><td class="mdescRight">Addition operator. Fast equivalent to <code>U.add(1, V)</code>.  <br /></td></tr>
<tr class="separator:a249c6773bf5506aaf21adec7dae3c676"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1d2e66c713a958e59c7692589fcb8347"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a1d2e66c713a958e59c7692589fcb8347">operator-=</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V)</td></tr>
<tr class="memdesc:a1d2e66c713a958e59c7692589fcb8347"><td class="mdescLeft">&#160;</td><td class="mdescRight">Subtraction operator. Fast equivalent to <code>U.add</code>(-1, V).  <br /></td></tr>
<tr class="separator:a1d2e66c713a958e59c7692589fcb8347"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a679816ae3f4763e2969c6bfe0a46e9e4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a679816ae3f4763e2969c6bfe0a46e9e4">add</a> (const double <a class="el" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>)</td></tr>
<tr class="memdesc:a679816ae3f4763e2969c6bfe0a46e9e4"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_9_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U(0-LIBMESH_DIM)+=s$" src="../../form_9.png"/></picture>. Addition of <code>s</code> to all components.  <br /></td></tr>
<tr class="separator:a679816ae3f4763e2969c6bfe0a46e9e4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9441d10fd772d3e3c0dafc3a2e71a784"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9441d10fd772d3e3c0dafc3a2e71a784">add</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V)</td></tr>
<tr class="memdesc:a9441d10fd772d3e3c0dafc3a2e71a784"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=V $" src="../../form_14.png"/></picture>. Simple vector addition, equal to the  <br /></td></tr>
<tr class="separator:a9441d10fd772d3e3c0dafc3a2e71a784"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1239dd71a7f52a31b2ff4fee33413118"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a1239dd71a7f52a31b2ff4fee33413118">add</a> (const double a, const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;v)</td></tr>
<tr class="memdesc:a1239dd71a7f52a31b2ff4fee33413118"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_15_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=a*V $" src="../../form_15.png"/></picture>. Simple vector addition, equal to the  <br /></td></tr>
<tr class="separator:a1239dd71a7f52a31b2ff4fee33413118"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4feb57cf86ee97f01621c2f7cac891ea"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a4feb57cf86ee97f01621c2f7cac891ea">add_vector_blocked</a> (const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:a4feb57cf86ee97f01621c2f7cac891ea"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_12_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=v $" src="../../form_12.png"/></picture> where <code>v</code> is a std::vector !!!fast  <br /></td></tr>
<tr class="separator:a4feb57cf86ee97f01621c2f7cac891ea"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a39cd7a4e0cfb6ee02948cfc94df22be9"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a39cd7a4e0cfb6ee02948cfc94df22be9">add_vector_blocked</a> (const std::vector&lt; double &gt; &amp;v, const std::vector&lt; unsigned &gt; &amp;dof_indices)</td></tr>
<tr class="separator:a39cd7a4e0cfb6ee02948cfc94df22be9"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:af1daa9e3d925f4a2eca4b003de6653ef"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#af1daa9e3d925f4a2eca4b003de6653ef">insert_vector_blocked</a> (const std::vector&lt; double &gt; &amp;values, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="separator:af1daa9e3d925f4a2eca4b003de6653ef"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8af71de6824f0853210942ea07a108fe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a8af71de6824f0853210942ea07a108fe">add_vector</a> (const std::vector&lt; double &gt; &amp;v, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:a8af71de6824f0853210942ea07a108fe"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_12_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=v $" src="../../form_12.png"/></picture> where <code>v</code> is a std::vector  <br /></td></tr>
<tr class="separator:a8af71de6824f0853210942ea07a108fe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0ea2979ea88d30eeb209ddb06f1cb431"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0ea2979ea88d30eeb209ddb06f1cb431">add_vector</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V, const std::vector&lt; int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:a0ea2979ea88d30eeb209ddb06f1cb431"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=V $" src="../../form_14.png"/></picture> where U and V are type <code><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a></code> and you  <br /></td></tr>
<tr class="separator:a0ea2979ea88d30eeb209ddb06f1cb431"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a233249cb34d4aacd2a3bf79dabcd6abd"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a233249cb34d4aacd2a3bf79dabcd6abd">add_vector</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V, const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;<a class="el" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>)</td></tr>
<tr class="memdesc:a233249cb34d4aacd2a3bf79dabcd6abd"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_13_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U+=A*V$" src="../../form_13.png"/></picture>, add the product of a <code><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a></code> <code>A</code>  <br /></td></tr>
<tr class="separator:a233249cb34d4aacd2a3bf79dabcd6abd"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7497e63d027d2cc022881f629b94d66b"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a7497e63d027d2cc022881f629b94d66b">add_vector</a> (const <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a> &amp;V, const std::vector&lt; unsigned int &gt; &amp;dof_indices)</td></tr>
<tr class="memdesc:a7497e63d027d2cc022881f629b94d66b"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_16_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U+=V $" src="../../form_16.png"/></picture> where U and V are type <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a>  <br /></td></tr>
<tr class="separator:a7497e63d027d2cc022881f629b94d66b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4b427c8ca96138d77e8da0ddc2ae5bbe"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a4b427c8ca96138d77e8da0ddc2ae5bbe">resid</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;rhs_in, const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;x, const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;<a class="el" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>)</td></tr>
<tr class="memdesc:a4b427c8ca96138d77e8da0ddc2ae5bbe"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the residual r=b-Ax.  <br /></td></tr>
<tr class="separator:a4b427c8ca96138d77e8da0ddc2ae5bbe"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab2fb8fa48df9f76e71156b3c1fa1ca7a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ab2fb8fa48df9f76e71156b3c1fa1ca7a">matrix_mult</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;vec_in, const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;mat_in)</td></tr>
<tr class="memdesc:ab2fb8fa48df9f76e71156b3c1fa1ca7a"><td class="mdescLeft">&#160;</td><td class="mdescRight"><picture><source srcset="../../form_13_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U+=A*V$" src="../../form_13.png"/></picture>, add the product A*v  <br /></td></tr>
<tr class="separator:ab2fb8fa48df9f76e71156b3c1fa1ca7a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a643df05743c8c974176602369a7d540c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a643df05743c8c974176602369a7d540c">matrix_mult_transpose</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;vec_in, const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;mat_in)</td></tr>
<tr class="memdesc:a643df05743c8c974176602369a7d540c"><td class="mdescLeft">&#160;</td><td class="mdescRight">This function computes the residual r=P^t x.  <br /></td></tr>
<tr class="separator:a643df05743c8c974176602369a7d540c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef674a8e4d928755d54d965e2ded1ab5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aef674a8e4d928755d54d965e2ded1ab5">scale</a> (const double factor)</td></tr>
<tr class="memdesc:aef674a8e4d928755d54d965e2ded1ab5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Scale each element of the vector by the given factor.  <br /></td></tr>
<tr class="separator:aef674a8e4d928755d54d965e2ded1ab5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:acd5e383ca3fe7e5563a7a023b223669c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#acd5e383ca3fe7e5563a7a023b223669c">abs</a> ()</td></tr>
<tr class="memdesc:acd5e383ca3fe7e5563a7a023b223669c"><td class="mdescLeft">&#160;</td><td class="mdescRight">v = abs(v)... that is, each entry in v is replaced  <br /></td></tr>
<tr class="separator:acd5e383ca3fe7e5563a7a023b223669c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a76b87d476c3ddfea50e186323e42dad0"><td class="memItemLeft" align="right" valign="top">double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a76b87d476c3ddfea50e186323e42dad0">dot</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;V) const</td></tr>
<tr class="memdesc:a76b87d476c3ddfea50e186323e42dad0"><td class="mdescLeft">&#160;</td><td class="mdescRight">Computes the dot product, p = U.V.  <br /></td></tr>
<tr class="separator:a76b87d476c3ddfea50e186323e42dad0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aeef164f5cc86f4a78a16eee275aeaf64"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aeef164f5cc86f4a78a16eee275aeaf64">pointwise_mult</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;vec1, const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;vec2)</td></tr>
<tr class="separator:aeef164f5cc86f4a78a16eee275aeaf64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ec285721ca9c4c3d8ed3d991923d2ca"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5ec285721ca9c4c3d8ed3d991923d2ca">localize</a> (std::vector&lt; double &gt; &amp;v_local) const</td></tr>
<tr class="memdesc:a5ec285721ca9c4c3d8ed3d991923d2ca"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a copy of the global vector in the local vector <code>v_local</code>.  <br /></td></tr>
<tr class="separator:a5ec285721ca9c4c3d8ed3d991923d2ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9c351017a679abb97160b18cb09a7ef3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9c351017a679abb97160b18cb09a7ef3">localize</a> (<a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;v_local) const</td></tr>
<tr class="memdesc:a9c351017a679abb97160b18cb09a7ef3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Same, but fills a <code><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a></code> instead of a <code>std::vector</code>.  <br /></td></tr>
<tr class="separator:a9c351017a679abb97160b18cb09a7ef3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a38c23362386ed34dc810e7c9ed3bd127"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a38c23362386ed34dc810e7c9ed3bd127">localize</a> (<a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;v_local, const std::vector&lt; int &gt; &amp;send_list) const</td></tr>
<tr class="memdesc:a38c23362386ed34dc810e7c9ed3bd127"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a local vector <code>v_local</code> containing.  <br /></td></tr>
<tr class="separator:a38c23362386ed34dc810e7c9ed3bd127"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae6fc1f3d94f3466a88b72191fd999a45"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae6fc1f3d94f3466a88b72191fd999a45">localize</a> (const int first_local_idx, const int last_local_idx, const std::vector&lt; int &gt; &amp;send_list)</td></tr>
<tr class="memdesc:ae6fc1f3d94f3466a88b72191fd999a45"><td class="mdescLeft">&#160;</td><td class="mdescRight">Updates a local vector with selected values from neighboring processors.  <br /></td></tr>
<tr class="separator:ae6fc1f3d94f3466a88b72191fd999a45"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac46ebab319de3c8f7c982be12de13d39"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac46ebab319de3c8f7c982be12de13d39">localize_to_one</a> (std::vector&lt; double &gt; &amp;v_local, const int proc_id=0) const</td></tr>
<tr class="separator:ac46ebab319de3c8f7c982be12de13d39"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2e43106e5039314263c36fce1ee9fce5"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a2e43106e5039314263c36fce1ee9fce5">localize_to_all</a> (std::vector&lt; double &gt; &amp;v_local) const</td></tr>
<tr class="memdesc:a2e43106e5039314263c36fce1ee9fce5"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a local copy of the global vector.  <br /></td></tr>
<tr class="separator:a2e43106e5039314263c36fce1ee9fce5"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9cb55d3292876ec373b24403e49e7a4f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9cb55d3292876ec373b24403e49e7a4f">create_subvector</a> (<a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;subvector, const std::vector&lt; int &gt; &amp;rows) const</td></tr>
<tr class="memdesc:a9cb55d3292876ec373b24403e49e7a4f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Creates a "subvector" from this vector using the rows indices of the "rows" array.  <br /></td></tr>
<tr class="separator:a9cb55d3292876ec373b24403e49e7a4f"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aac9b1e5aacfb44580370b344112731b1"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aac9b1e5aacfb44580370b344112731b1">swap</a> (<a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;v)</td></tr>
<tr class="memdesc:aac9b1e5aacfb44580370b344112731b1"><td class="mdescLeft">&#160;</td><td class="mdescRight">Swaps the raw PETSc vector context pointers.  <br /></td></tr>
<tr class="separator:aac9b1e5aacfb44580370b344112731b1"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4ec1a8d67f0d7a413678ddc9f407b071"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a4ec1a8d67f0d7a413678ddc9f407b071">BinaryPrint</a> (const char *fileName)</td></tr>
<tr class="separator:a4ec1a8d67f0d7a413678ddc9f407b071"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a37320faa1f195935598941fde977c57c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a37320faa1f195935598941fde977c57c">BinaryLoad</a> (const char *fileName)</td></tr>
<tr class="separator:a37320faa1f195935598941fde977c57c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a26d8ccf5f86fae43264918ce337488b7"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a> () const</td></tr>
<tr class="separator:a26d8ccf5f86fae43264918ce337488b7"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a34f55bd075ab087a8b6c2d10fe962f0a"><td class="memItemLeft" align="right" valign="top">virtual bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a> () const</td></tr>
<tr class="separator:a34f55bd075ab087a8b6c2d10fe962f0a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a426f4ebb35ef955a10b0e6f954120658"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a> () const</td></tr>
<tr class="separator:a426f4ebb35ef955a10b0e6f954120658"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3da0dc3bbf4eed29cbfee8cb958bc1bb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a3da0dc3bbf4eed29cbfee8cb958bc1bb">type</a> ()</td></tr>
<tr class="separator:a3da0dc3bbf4eed29cbfee8cb958bc1bb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a31ab593cb8e23427dfc052f722534bff"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a31ab593cb8e23427dfc052f722534bff">subset_l1_norm</a> (const std::set&lt; int &gt; &amp;indices)</td></tr>
<tr class="separator:a31ab593cb8e23427dfc052f722534bff"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5fe444121af2d624e9385c52be03d21c"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a5fe444121af2d624e9385c52be03d21c">subset_l2_norm</a> (const std::set&lt; int &gt; &amp;indices)</td></tr>
<tr class="separator:a5fe444121af2d624e9385c52be03d21c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7f43523d987d66bf1471867fc01dd3ec"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a7f43523d987d66bf1471867fc01dd3ec">subset_linfty_norm</a> (const std::set&lt; int &gt; &amp;indices)</td></tr>
<tr class="separator:a7f43523d987d66bf1471867fc01dd3ec"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adc6ca7c50215bf1e82722d08b511ac82"><td class="memItemLeft" align="right" valign="top">virtual double&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#adc6ca7c50215bf1e82722d08b511ac82">el</a> (const int i) const</td></tr>
<tr class="separator:adc6ca7c50215bf1e82722d08b511ac82"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a67020e70f04581ad0a51851ba9f166b6"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a67020e70f04581ad0a51851ba9f166b6">operator*=</a> (const double a)</td></tr>
<tr class="memdesc:a67020e70f04581ad0a51851ba9f166b6"><td class="mdescLeft">&#160;</td><td class="mdescRight">Multiplication operator. Equivalent to <code>U.scale(a)</code>  <br /></td></tr>
<tr class="separator:a67020e70f04581ad0a51851ba9f166b6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a5ccb956f73e8b2320a4c98089df577cb"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a5ccb956f73e8b2320a4c98089df577cb">operator/=</a> (const double a)</td></tr>
<tr class="memdesc:a5ccb956f73e8b2320a4c98089df577cb"><td class="mdescLeft">&#160;</td><td class="mdescRight">Division operator. Equivalent to <code>U.scale</code>(1./a)  <br /></td></tr>
<tr class="separator:a5ccb956f73e8b2320a4c98089df577cb"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a692068ac78adf8745fa5ba7a2efd7189"><td class="memItemLeft" align="right" valign="top">virtual int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a692068ac78adf8745fa5ba7a2efd7189">compare</a> (const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;other_vector, const double threshold=1.e-20) const</td></tr>
<tr class="separator:a692068ac78adf8745fa5ba7a2efd7189"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a747d2a62dbad91f7b04434a67c8636f4"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a747d2a62dbad91f7b04434a67c8636f4">print</a> (std::ostream &amp;os=std::cout) const</td></tr>
<tr class="separator:a747d2a62dbad91f7b04434a67c8636f4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aec17991ed847c6b52b055a7cd737dae1"><td class="memItemLeft" align="right" valign="top">virtual void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aec17991ed847c6b52b055a7cd737dae1">print_global</a> (std::ostream &amp;os=std::cout) const</td></tr>
<tr class="separator:aec17991ed847c6b52b055a7cd737dae1"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pub-static-methods" name="pub-static-methods"></a>
Static Public Member Functions</h2></td></tr>
<tr class="memitem:aa554690df717f373d2b51e564fc421d6"><td class="memItemLeft" align="right" valign="top">static std::unique_ptr&lt; <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa554690df717f373d2b51e564fc421d6">build</a> (const <a class="el" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fe">SolverPackage</a> solver_package=LSOLVER)</td></tr>
<tr class="separator:aa554690df717f373d2b51e564fc421d6"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-methods" name="pro-methods"></a>
Protected Member Functions</h2></td></tr>
<tr class="memitem:a9f69ab1cfaa5e08f4421cdce135c5804"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9f69ab1cfaa5e08f4421cdce135c5804">_get_array</a> (void) const</td></tr>
<tr class="memdesc:a9f69ab1cfaa5e08f4421cdce135c5804"><td class="mdescLeft">&#160;</td><td class="mdescRight">Queries the array (and the local form if the vector is ghosted) from Petsc.  <br /></td></tr>
<tr class="separator:a9f69ab1cfaa5e08f4421cdce135c5804"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae72305c0a5c596cf56fdbdf6354bff8f"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a> (void) const</td></tr>
<tr class="memdesc:ae72305c0a5c596cf56fdbdf6354bff8f"><td class="mdescLeft">&#160;</td><td class="mdescRight">Restores the array (and the local form if the vector is ghosted) to Petsc.  <br /></td></tr>
<tr class="separator:ae72305c0a5c596cf56fdbdf6354bff8f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pro-attribs" name="pro-attribs"></a>
Protected Attributes</h2></td></tr>
<tr class="memitem:a722d2654319ad192949d9f844975e80e"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a></td></tr>
<tr class="separator:a722d2654319ad192949d9f844975e80e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a1c0db787810e7c4b7d385da57081790a"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">_is_initialized</a></td></tr>
<tr class="separator:a1c0db787810e7c4b7d385da57081790a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a40eebd0755df82e691bea575694f1100"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a></td></tr>
<tr class="separator:a40eebd0755df82e691bea575694f1100"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-types" name="pri-types"></a>
Private Types</h2></td></tr>
<tr class="memitem:a6d964d0674ab95f3ed6c62aabd9a546f"><td class="memItemLeft" align="right" valign="top">typedef std::map&lt; int, int &gt;&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a6d964d0674ab95f3ed6c62aabd9a546f">GlobalToLocalMap</a></td></tr>
<tr class="memdesc:a6d964d0674ab95f3ed6c62aabd9a546f"><td class="mdescLeft">&#160;</td><td class="mdescRight">doubleype for map that maps global to local ghost cells.  <br /></td></tr>
<tr class="separator:a6d964d0674ab95f3ed6c62aabd9a546f"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a id="pri-attribs" name="pri-attribs"></a>
Private Attributes</h2></td></tr>
<tr class="memitem:ac134673509a18ee6f600fb64d192c779"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a></td></tr>
<tr class="memdesc:ac134673509a18ee6f600fb64d192c779"><td class="mdescLeft">&#160;</td><td class="mdescRight">Actual Petsc vector datatype.  <br /></td></tr>
<tr class="separator:ac134673509a18ee6f600fb64d192c779"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3a8817772640ae70c8edda2690d9a805"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a></td></tr>
<tr class="separator:a3a8817772640ae70c8edda2690d9a805"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac54679893cd2b3ef663e56e54b618e64"><td class="memItemLeft" align="right" valign="top">Vec&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a></td></tr>
<tr class="separator:ac54679893cd2b3ef663e56e54b618e64"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a64a405181970b8ff404707c307d10a4a"><td class="memItemLeft" align="right" valign="top">PetscScalar *&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a></td></tr>
<tr class="separator:a64a405181970b8ff404707c307d10a4a"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a3e5cd746fb38edacb229b98824a68e26"><td class="memItemLeft" align="right" valign="top"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a6d964d0674ab95f3ed6c62aabd9a546f">GlobalToLocalMap</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a></td></tr>
<tr class="memdesc:a3e5cd746fb38edacb229b98824a68e26"><td class="mdescLeft">&#160;</td><td class="mdescRight">Map that maps global to local ghost cells (will be empty if not in ghost cell mode.  <br /></td></tr>
<tr class="separator:a3e5cd746fb38edacb229b98824a68e26"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a22b1d0ffe5c8f5cea50ebdc10f931051"><td class="memItemLeft" align="right" valign="top">bool&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a></td></tr>
<tr class="separator:a22b1d0ffe5c8f5cea50ebdc10f931051"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0fa88c0d3fa08d1e690d2bdc6936b5ca"><td class="memItemLeft" align="right" valign="top">int&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0fa88c0d3fa08d1e690d2bdc6936b5ca">_local_size</a></td></tr>
<tr class="separator:a0fa88c0d3fa08d1e690d2bdc6936b5ca"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Petsc vector. Provides a nice interface to the Petsc C-based data structures for parallel vectors. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00057">57</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
</div><h2 class="groupheader">Member Typedef Documentation</h2>
<a id="a6d964d0674ab95f3ed6c62aabd9a546f" name="a6d964d0674ab95f3ed6c62aabd9a546f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6d964d0674ab95f3ed6c62aabd9a546f">&#9670;&#160;</a></span>GlobalToLocalMap</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">typedef std::map&lt;int, int&gt; <a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a6d964d0674ab95f3ed6c62aabd9a546f">femus::PetscVector::GlobalToLocalMap</a></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>doubleype for map that maps global to local ghost cells. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00308">308</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<h2 class="groupheader">Constructor &amp; Destructor Documentation</h2>
<a id="a97a488763d754a507a0aa1a600f2a0e8" name="a97a488763d754a507a0aa1a600f2a0e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a97a488763d754a507a0aa1a600f2a0e8">&#9670;&#160;</a></span>PetscVector() <span class="overload">[1/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::PetscVector::PetscVector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Dummy-Constructor. Dimension=0. </p>
<p>--------------------&mdash; Inline functions -------------------------------&mdash; </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00331">331</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  332</span>    : <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a> (<span class="keyword">false</span>),</div>
<div class="line"><span class="lineno">  333</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a> (NULL),</div>
<div class="line"><span class="lineno">  334</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a> (NULL),</div>
<div class="line"><span class="lineno">  335</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>(),</div>
<div class="line"><span class="lineno">  336</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  337</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>;</div>
<div class="line"><span class="lineno">  338</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a40eebd0755df82e691bea575694f1100"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">femus::NumericVector::_type</a></div><div class="ttdeci">ParallelType _type</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00365">NumericVector.hpp:365</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a426f4ebb35ef955a10b0e6f954120658"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">femus::NumericVector::type</a></div><div class="ttdeci">ParallelType type() const</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00184">NumericVector.hpp:184</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a22b1d0ffe5c8f5cea50ebdc10f931051"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">femus::PetscVector::_destroy_vec_on_exit</a></div><div class="ttdeci">bool _destroy_vec_on_exit</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00315">PetscVector.hpp:315</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a3a8817772640ae70c8edda2690d9a805"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">femus::PetscVector::_array_is_present</a></div><div class="ttdeci">bool _array_is_present</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00296">PetscVector.hpp:296</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a3e5cd746fb38edacb229b98824a68e26"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">femus::PetscVector::_global_to_local_map</a></div><div class="ttdeci">GlobalToLocalMap _global_to_local_map</div><div class="ttdoc">Map that maps global to local ghost cells (will be empty if not in ghost cell mode.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00311">PetscVector.hpp:311</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a64a405181970b8ff404707c307d10a4a"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">femus::PetscVector::_values</a></div><div class="ttdeci">PetscScalar * _values</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00305">PetscVector.hpp:305</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_ac54679893cd2b3ef663e56e54b618e64"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">femus::PetscVector::_local_form</a></div><div class="ttdeci">Vec _local_form</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00301">PetscVector.hpp:301</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ab61fb7838cf5cf235307e18362eb44b4" name="ab61fb7838cf5cf235307e18362eb44b4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab61fb7838cf5cf235307e18362eb44b4">&#9670;&#160;</a></span>PetscVector() <span class="overload">[2/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::PetscVector::PetscVector </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">explicit</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. Set dimension to <code>n</code> and initialize all elements with zero. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00340">340</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  341</span>    : <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a> (<span class="keyword">false</span>),</div>
<div class="line"><span class="lineno">  342</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a> (NULL),</div>
<div class="line"><span class="lineno">  343</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a> (NULL),</div>
<div class="line"><span class="lineno">  344</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>(),</div>
<div class="line"><span class="lineno">  345</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  346</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aab9b165d31a203194f7b82071343358c">init</a> (n, n, <span class="keyword">false</span>, <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>);</div>
<div class="line"><span class="lineno">  347</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_aab9b165d31a203194f7b82071343358c"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aab9b165d31a203194f7b82071343358c">femus::PetscVector::init</a></div><div class="ttdeci">void init(const int N, const int n_local, const bool fast=false, const ParallelType type=AUTOMATIC)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00466">PetscVector.hpp:466</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a66f41afbaf8d486c5662c66fdf920a0a" name="a66f41afbaf8d486c5662c66fdf920a0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a66f41afbaf8d486c5662c66fdf920a0a">&#9670;&#160;</a></span>PetscVector() <span class="overload">[3/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::PetscVector::PetscVector </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Constructor. Set local dimension to <code>n_local</code>, the global dimension to <code>n</code>, and initialize all elements with zero. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00349">349</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  352</span>    : <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a> (<span class="keyword">false</span>),</div>
<div class="line"><span class="lineno">  353</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a> (NULL),</div>
<div class="line"><span class="lineno">  354</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a> (NULL),</div>
<div class="line"><span class="lineno">  355</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>(),</div>
<div class="line"><span class="lineno">  356</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  357</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aab9b165d31a203194f7b82071343358c">init</a> (n, n_local, <span class="keyword">false</span>, <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>);</div>
<div class="line"><span class="lineno">  358</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac838d4451e3800f1190cf1fc67376577" name="ac838d4451e3800f1190cf1fc67376577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac838d4451e3800f1190cf1fc67376577">&#9670;&#160;</a></span>PetscVector() <span class="overload">[4/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::PetscVector::PetscVector </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ghost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. Set local dimension to <code>n_local</code>, the global dimension to <code>n</code>. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00360">360</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  364</span>    : <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a> (<span class="keyword">false</span>),</div>
<div class="line"><span class="lineno">  365</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a> (NULL),</div>
<div class="line"><span class="lineno">  366</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a> (NULL),</div>
<div class="line"><span class="lineno">  367</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>(),</div>
<div class="line"><span class="lineno">  368</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a> (<span class="keyword">true</span>) {</div>
<div class="line"><span class="lineno">  369</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aab9b165d31a203194f7b82071343358c">init</a> (n, n_local, ghost, <span class="keyword">false</span>, <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>);</div>
<div class="line"><span class="lineno">  370</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a155bd65a41657efbeabc8a9b0805ab63" name="a155bd65a41657efbeabc8a9b0805ab63"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a155bd65a41657efbeabc8a9b0805ab63">&#9670;&#160;</a></span>PetscVector() <span class="overload">[5/5]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::PetscVector::PetscVector </td>
          <td>(</td>
          <td class="paramtype">Vec&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Constructor. Creates a <a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a> assuming a valid PETSc Vec object. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00372">372</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  373</span>    : <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a> (<span class="keyword">false</span>),</div>
<div class="line"><span class="lineno">  374</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a> (NULL),</div>
<div class="line"><span class="lineno">  375</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a> (NULL),</div>
<div class="line"><span class="lineno">  376</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>(),</div>
<div class="line"><span class="lineno">  377</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a> (<span class="keyword">false</span>) {</div>
<div class="line"><span class="lineno">  378</span>    this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a> = v;</div>
<div class="line"><span class="lineno">  379</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  380</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">_is_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  381</span> </div>
<div class="line"><span class="lineno">  382</span>    <span class="comment">/* We need to ask PETSc about the (local to global) ghost value</span></div>
<div class="line"><span class="lineno">  383</span><span class="comment">       mapping and create the inverse mapping out of it.  */</span></div>
<div class="line"><span class="lineno">  384</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  385</span>    <span class="keywordtype">int</span> petsc_local_size = 0;</div>
<div class="line"><span class="lineno">  386</span>    ierr = VecGetLocalSize (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;petsc_local_size);</div>
<div class="line"><span class="lineno">  387</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  388</span> </div>
<div class="line"><span class="lineno">  389</span><span class="comment">//   // Get the vector type from PETSc.</span></div>
<div class="line"><span class="lineno">  390</span><span class="comment">//   const VecType type;</span></div>
<div class="line"><span class="lineno">  391</span><span class="comment">//   ierr = VecGetType(_vec, &amp;type);</span></div>
<div class="line"><span class="lineno">  392</span><span class="comment">//   CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  393</span> </div>
<div class="line"><span class="lineno">  394</span>    <span class="comment">// Get the vector type from PETSc.</span></div>
<div class="line"><span class="lineno">  395</span>    <span class="comment">// As of Petsc 3.0.0, the VecType #define lost its const-ness, so we</span></div>
<div class="line"><span class="lineno">  396</span>    <span class="comment">// need to have it in the code</span></div>
<div class="line"><span class="lineno">  397</span><span class="preprocessor">#if PETSC_VERSION_LESS_THAN(3,0,0) || !PETSC_VERSION_LESS_THAN(3,4,0)</span></div>
<div class="line"><span class="lineno">  398</span>    <span class="comment">// Pre-3.0 and petsc-dev (as of October 2012) use non-const versions</span></div>
<div class="line"><span class="lineno">  399</span>    VecType ptype;</div>
<div class="line"><span class="lineno">  400</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  401</span>    <span class="keyword">const</span> VecType ptype;</div>
<div class="line"><span class="lineno">  402</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  403</span>    ierr = VecGetType (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;ptype);</div>
<div class="line"><span class="lineno">  404</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  405</span> </div>
<div class="line"><span class="lineno">  406</span>    <span class="keywordflow">if</span> ( (strcmp (ptype, VECSHARED) == 0) || (strcmp (ptype, VECMPI) == 0)) {</div>
<div class="line"><span class="lineno">  407</span><span class="preprocessor">#if PETSC_VERSION_RELEASE &amp;&amp; PETSC_VERSION_LESS_THAN(3,1,1)</span></div>
<div class="line"><span class="lineno">  408</span>      ISLocalToGlobalMapping mapping = <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>-&gt;mapping;</div>
<div class="line"><span class="lineno">  409</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  410</span>      ISLocalToGlobalMapping mapping;</div>
<div class="line"><span class="lineno">  411</span>      ierr = VecGetLocalToGlobalMapping (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;mapping);</div>
<div class="line"><span class="lineno">  412</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  413</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  414</span><span class="comment">//     ISLocalToGlobalMapping mapping;</span></div>
<div class="line"><span class="lineno">  415</span><span class="comment">//     ierr = VecGetLocalToGlobalMapping(_vec, &amp;mapping);</span></div>
<div class="line"><span class="lineno">  416</span><span class="comment">//     CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  417</span> </div>
<div class="line"><span class="lineno">  418</span>      <span class="comment">// If is a sparsely stored vector, set up our new mapping</span></div>
<div class="line"><span class="lineno">  419</span>      <span class="keywordflow">if</span> (mapping) {</div>
<div class="line"><span class="lineno">  420</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_local_size);</div>
<div class="line"><span class="lineno">  421</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ghost_begin = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_local_size);</div>
<div class="line"><span class="lineno">  422</span><span class="preprocessor">#if PETSC_VERSION_RELEASE &amp;&amp; PETSC_VERSION_LESS_THAN(3,4,0)</span></div>
<div class="line"><span class="lineno">  423</span>        <span class="keyword">const</span> numeric_index_type ghost_end = <span class="keyword">static_cast&lt;</span>numeric_index_type<span class="keyword">&gt;</span> (mapping-&gt;n);</div>
<div class="line"><span class="lineno">  424</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  425</span>        PetscInt n;</div>
<div class="line"><span class="lineno">  426</span>        ierr = ISLocalToGlobalMappingGetSize (mapping, &amp;n);</div>
<div class="line"><span class="lineno">  427</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  428</span>        <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> ghost_end = <span class="keyword">static_cast&lt;</span><span class="keywordtype">unsigned</span> <span class="keywordtype">int</span><span class="keyword">&gt;</span> (n);</div>
<div class="line"><span class="lineno">  429</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  430</span><span class="preprocessor">#if PETSC_VERSION_RELEASE &amp;&amp; PETSC_VERSION_LESS_THAN(3,1,1)</span></div>
<div class="line"><span class="lineno">  431</span>        <span class="keyword">const</span> PetscInt *indices = mapping-&gt;indices;</div>
<div class="line"><span class="lineno">  432</span><span class="preprocessor">#else</span></div>
<div class="line"><span class="lineno">  433</span>        <span class="keyword">const</span> PetscInt *indices;</div>
<div class="line"><span class="lineno">  434</span>        ierr = ISLocalToGlobalMappingGetIndices (mapping, &amp;indices);</div>
<div class="line"><span class="lineno">  435</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  436</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  437</span>        <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i = ghost_begin; i &lt; ghost_end; i++)</div>
<div class="line"><span class="lineno">  438</span>          <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>[indices[i]] = i - <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>;</div>
<div class="line"><span class="lineno">  439</span>        this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>;</div>
<div class="line"><span class="lineno">  440</span><span class="preprocessor">#if !PETSC_VERSION_RELEASE || !PETSC_VERSION_LESS_THAN(3,1,1)</span></div>
<div class="line"><span class="lineno">  441</span>        ierr = ISLocalToGlobalMappingRestoreIndices (mapping, &amp;indices);</div>
<div class="line"><span class="lineno">  442</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  443</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  444</span><span class="comment">//       const unsigned int ghost_end = static_cast&lt;unsigned int&gt;(mapping-&gt;n);</span></div>
<div class="line"><span class="lineno">  445</span><span class="comment">//       const int *indices = mapping-&gt;indices;</span></div>
<div class="line"><span class="lineno">  446</span><span class="comment">//       ierr = ISLocalToGlobalMappingGetIndices(mapping,&amp;indices);</span></div>
<div class="line"><span class="lineno">  447</span><span class="comment">//       CHKERRABORT(MPI_COMM_WORLD,ierr);</span></div>
<div class="line"><span class="lineno">  448</span><span class="comment">//       for(unsigned int i=ghost_begin; i&lt;ghost_end; i++)</span></div>
<div class="line"><span class="lineno">  449</span><span class="comment">//         _global_to_local_map[indices[i]] = i-local_size;</span></div>
<div class="line"><span class="lineno">  450</span><span class="comment">//       this-&gt;_type = GHOSTED;</span></div>
<div class="line"><span class="lineno">  451</span>      }</div>
<div class="line"><span class="lineno">  452</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  453</span>        this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>;</div>
<div class="line"><span class="lineno">  454</span>    }</div>
<div class="line"><span class="lineno">  455</span>    <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">  456</span>      this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>;</div>
<div class="line"><span class="lineno">  457</span> </div>
<div class="line"><span class="lineno">  458</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a>();</div>
<div class="line"><span class="lineno">  459</span>  }</div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a></div><div class="ttdeci">@ PARALLEL</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00007">ParalleltypeEnum.hpp:7</a></div></div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a></div><div class="ttdeci">@ SERIAL</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00006">ParalleltypeEnum.hpp:6</a></div></div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a></div><div class="ttdeci">@ GHOSTED</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00008">ParalleltypeEnum.hpp:8</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a1c0db787810e7c4b7d385da57081790a"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">femus::NumericVector::_is_initialized</a></div><div class="ttdeci">bool _is_initialized</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00362">NumericVector.hpp:362</a></div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a722d2654319ad192949d9f844975e80e"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">femus::NumericVector::_is_closed</a></div><div class="ttdeci">bool _is_closed</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00359">NumericVector.hpp:359</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a282ee28379f76d570c36a798d72a5484"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">femus::PetscVector::local_size</a></div><div class="ttdeci">int local_size() const</div><div class="ttdoc">This function returns the local size of the vector (index_stop-index_start)</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00700">PetscVector.hpp:700</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a68fd9a4430cff15afec82d63479c4227"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">femus::PetscVector::close</a></div><div class="ttdeci">void close()</div><div class="ttdoc">Call the assemble functions.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00595">PetscVector.hpp:595</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_ac134673509a18ee6f600fb64d192c779"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">femus::PetscVector::_vec</a></div><div class="ttdeci">Vec _vec</div><div class="ttdoc">Actual Petsc vector datatype.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00292">PetscVector.hpp:292</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="abce13bebc1333766fdd631f6def08ba1" name="abce13bebc1333766fdd631f6def08ba1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#abce13bebc1333766fdd631f6def08ba1">&#9670;&#160;</a></span>~PetscVector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">femus::PetscVector::~PetscVector </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Destructor, deallocates memory. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00462">462</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  462</span>                                    {</div>
<div class="line"><span class="lineno">  463</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a157618d9b5afa9ba23a7f62121194960">clear</a> ();</div>
<div class="line"><span class="lineno">  464</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a157618d9b5afa9ba23a7f62121194960"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a157618d9b5afa9ba23a7f62121194960">femus::PetscVector::clear</a></div><div class="ttdeci">void clear()</div><div class="ttdoc">This function returns the PetscVector to a pristine state.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00645">PetscVector.hpp:645</a></div></div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Function Documentation</h2>
<a id="a9f69ab1cfaa5e08f4421cdce135c5804" name="a9f69ab1cfaa5e08f4421cdce135c5804"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9f69ab1cfaa5e08f4421cdce135c5804">&#9670;&#160;</a></span>_get_array()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::_get_array </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Queries the array (and the local form if the vector is ghosted) from Petsc. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00811">811</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  811</span>                                                 {</div>
<div class="line"><span class="lineno">  812</span>    assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  813</span>    <span class="keywordflow">if</span> (!<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a>) {</div>
<div class="line"><span class="lineno">  814</span>      <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  815</span>      <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) {</div>
<div class="line"><span class="lineno">  816</span>        ierr = VecGetArray (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a>);</div>
<div class="line"><span class="lineno">  817</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  818</span>      }</div>
<div class="line"><span class="lineno">  819</span>      <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  820</span>        ierr = VecGhostGetLocalForm (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a>);</div>
<div class="line"><span class="lineno">  821</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  822</span>        ierr = VecGetArray (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a>, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a>);</div>
<div class="line"><span class="lineno">  823</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  824</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno">  825</span>        <span class="keywordtype">int</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a> = 0;</div>
<div class="line"><span class="lineno">  826</span>        ierr = VecGetLocalSize (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a>, &amp;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>);</div>
<div class="line"><span class="lineno">  827</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  828</span>        <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0fa88c0d3fa08d1e690d2bdc6936b5ca">_local_size</a> = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>);</div>
<div class="line"><span class="lineno">  829</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  830</span>      }</div>
<div class="line"><span class="lineno">  831</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  832</span>    }</div>
<div class="line"><span class="lineno">  833</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a26d8ccf5f86fae43264918ce337488b7"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">femus::NumericVector::initialized</a></div><div class="ttdeci">virtual bool initialized() const</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00175">NumericVector.hpp:175</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a0fa88c0d3fa08d1e690d2bdc6936b5ca"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0fa88c0d3fa08d1e690d2bdc6936b5ca">femus::PetscVector::_local_size</a></div><div class="ttdeci">int _local_size</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00321">PetscVector.hpp:321</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae72305c0a5c596cf56fdbdf6354bff8f" name="ae72305c0a5c596cf56fdbdf6354bff8f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae72305c0a5c596cf56fdbdf6354bff8f">&#9670;&#160;</a></span>_restore_array()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::_restore_array </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">protected</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Restores the array (and the local form if the vector is ghosted) to Petsc. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00836">836</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  836</span>                                                     {</div>
<div class="line"><span class="lineno">  837</span>    assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  838</span>    <span class="keywordflow">if</span> (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a>) {</div>
<div class="line"><span class="lineno">  839</span>      <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  840</span>      <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) {</div>
<div class="line"><span class="lineno">  841</span>        ierr = VecRestoreArray (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a>);</div>
<div class="line"><span class="lineno">  842</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  843</span>        <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a> = NULL;</div>
<div class="line"><span class="lineno">  844</span>      }</div>
<div class="line"><span class="lineno">  845</span>      <span class="keywordflow">else</span>  {</div>
<div class="line"><span class="lineno">  846</span>        ierr = VecRestoreArray (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a>, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a>);</div>
<div class="line"><span class="lineno">  847</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  848</span>        <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a> = NULL;</div>
<div class="line"><span class="lineno">  849</span>        ierr = VecGhostRestoreLocalForm (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a>);</div>
<div class="line"><span class="lineno">  850</span>        CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  851</span>        <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a> = NULL;</div>
<div class="line"><span class="lineno">  852</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno">  853</span>        <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0fa88c0d3fa08d1e690d2bdc6936b5ca">_local_size</a> = 0;</div>
<div class="line"><span class="lineno">  854</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  855</span>      }</div>
<div class="line"><span class="lineno">  856</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  857</span>    }</div>
<div class="line"><span class="lineno">  858</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="acd5e383ca3fe7e5563a7a023b223669c" name="acd5e383ca3fe7e5563a7a023b223669c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#acd5e383ca3fe7e5563a7a023b223669c">&#9670;&#160;</a></span>abs()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::abs </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>v = abs(v)... that is, each entry in v is replaced </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ade0f50b972c3deecd23d54bc81bd8b19">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00381">381</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  381</span>                      {</div>
<div class="line"><span class="lineno">  382</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  383</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  384</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)   {</div>
<div class="line"><span class="lineno">  385</span>    ierr = VecAbs(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  386</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  387</span>  } <span class="keywordflow">else</span>    {</div>
<div class="line"><span class="lineno">  388</span>    Vec loc_vec;</div>
<div class="line"><span class="lineno">  389</span>    ierr = VecGhostGetLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  390</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  391</span>    ierr = VecAbs(loc_vec);</div>
<div class="line"><span class="lineno">  392</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  393</span>    ierr = VecGhostRestoreLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  394</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  395</span>  }</div>
<div class="line"><span class="lineno">  396</span>}</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_ae72305c0a5c596cf56fdbdf6354bff8f"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">femus::PetscVector::_restore_array</a></div><div class="ttdeci">void _restore_array(void) const</div><div class="ttdoc">Restores the array (and the local form if the vector is ghosted) to Petsc.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00836">PetscVector.hpp:836</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a1239dd71a7f52a31b2ff4fee33413118" name="a1239dd71a7f52a31b2ff4fee33413118"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1239dd71a7f52a31b2ff4fee33413118">&#9670;&#160;</a></span>add() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>a</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_15_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=a*V $" src="../../form_15.png"/></picture>. Simple vector addition, equal to the </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#abff6f46504f6e04bd8cc36944697cc27">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00303">303</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  303</span>                                                                  {</div>
<div class="line"><span class="lineno">  304</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  305</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  306</span>  PetscScalar a = <span class="keyword">static_cast&lt;</span>PetscScalar<span class="keyword">&gt;</span>(a_in);</div>
<div class="line"><span class="lineno">  307</span> </div>
<div class="line"><span class="lineno">  308</span>  <span class="comment">// Make sure the NumericVector passed in is really a PetscVector</span></div>
<div class="line"><span class="lineno">  309</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* v = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;v_in);</div>
<div class="line"><span class="lineno">  310</span>  v-&gt;_restore_array();</div>
<div class="line"><span class="lineno">  311</span>  assert(this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>() == v-&gt;size());</div>
<div class="line"><span class="lineno">  312</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) {</div>
<div class="line"><span class="lineno">  313</span>    ierr = VecAXPY(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, a, v-&gt;_vec);</div>
<div class="line"><span class="lineno">  314</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  315</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  316</span>    Vec loc_vec;</div>
<div class="line"><span class="lineno">  317</span>    Vec v_loc_vec;</div>
<div class="line"><span class="lineno">  318</span>    ierr = VecGhostGetLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  319</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  320</span>    ierr = VecGhostGetLocalForm(v-&gt;_vec,&amp;v_loc_vec);</div>
<div class="line"><span class="lineno">  321</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  322</span>    ierr = VecAXPY(loc_vec, a, v_loc_vec);</div>
<div class="line"><span class="lineno">  323</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  324</span>    ierr = VecGhostRestoreLocalForm(v-&gt;_vec,&amp;v_loc_vec);</div>
<div class="line"><span class="lineno">  325</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  326</span>    ierr = VecGhostRestoreLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  327</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  328</span>  }</div>
<div class="line"><span class="lineno">  329</span>}</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a55b897177341e239c8ea36e0852ba213"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">femus::PetscVector::size</a></div><div class="ttdeci">int size() const</div><div class="ttdoc">This function returns dimension of the vector.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00689">PetscVector.hpp:689</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a97a488763d754a507a0aa1a600f2a0e8"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">femus::PetscVector::PetscVector</a></div><div class="ttdeci">PetscVector(const ParallelType type=AUTOMATIC)</div><div class="ttdoc">Dummy-Constructor. Dimension=0.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00331">PetscVector.hpp:331</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a679816ae3f4763e2969c6bfe0a46e9e4" name="a679816ae3f4763e2969c6bfe0a46e9e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a679816ae3f4763e2969c6bfe0a46e9e4">&#9670;&#160;</a></span>add() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_9_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U(0-LIBMESH_DIM)+=s$" src="../../form_9.png"/></picture>. Addition of <code>s</code> to all components. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a3d6d99a22ab6f27a53e9bda379faab93">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00250">250</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  250</span>                                       {</div>
<div class="line"><span class="lineno">  251</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  252</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  253</span>  PetscScalar* values;</div>
<div class="line"><span class="lineno">  254</span>  <span class="keyword">const</span> PetscScalar v = <span class="keyword">static_cast&lt;</span>PetscScalar<span class="keyword">&gt;</span>(v_in);</div>
<div class="line"><span class="lineno">  255</span> </div>
<div class="line"><span class="lineno">  256</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)    {</div>
<div class="line"><span class="lineno">  257</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> n   = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>());</div>
<div class="line"><span class="lineno">  258</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> fli = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">first_local_index</a>());</div>
<div class="line"><span class="lineno">  259</span> </div>
<div class="line"><span class="lineno">  260</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div>
<div class="line"><span class="lineno">  261</span>      ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  262</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  263</span>      <span class="keywordtype">int</span> ig = fli + i;</div>
<div class="line"><span class="lineno">  264</span>      PetscScalar value = (values[i] + v);</div>
<div class="line"><span class="lineno">  265</span>      ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  266</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  267</span>      ierr = VecSetValues(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, 1, &amp;ig, &amp;value, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  268</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  269</span>    }</div>
<div class="line"><span class="lineno">  270</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  271</span>    <span class="comment">/* Vectors that include ghost values require a special</span></div>
<div class="line"><span class="lineno">  272</span><span class="comment">    handling.  */</span></div>
<div class="line"><span class="lineno">  273</span>    Vec loc_vec;</div>
<div class="line"><span class="lineno">  274</span>    ierr = VecGhostGetLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  275</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  276</span> </div>
<div class="line"><span class="lineno">  277</span>    <span class="keywordtype">int</span> n=0;</div>
<div class="line"><span class="lineno">  278</span>    ierr = VecGetSize(loc_vec, &amp;n);</div>
<div class="line"><span class="lineno">  279</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  280</span> </div>
<div class="line"><span class="lineno">  281</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) {</div>
<div class="line"><span class="lineno">  282</span>      ierr = VecGetArray(loc_vec, &amp;values);</div>
<div class="line"><span class="lineno">  283</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  284</span>      PetscScalar value = (values[i] + v);</div>
<div class="line"><span class="lineno">  285</span>      ierr = VecRestoreArray(loc_vec, &amp;values);</div>
<div class="line"><span class="lineno">  286</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  287</span>      ierr = VecSetValues(loc_vec, 1, &amp;i, &amp;value, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  288</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  289</span>    }</div>
<div class="line"><span class="lineno">  290</span> </div>
<div class="line"><span class="lineno">  291</span>    ierr = VecGhostRestoreLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  292</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  293</span>  }</div>
<div class="line"><span class="lineno">  294</span>  this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  295</span>}</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a0721bc1a1506471210879d543e7fe6fc"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">femus::PetscVector::first_local_index</a></div><div class="ttdeci">int first_local_index() const</div><div class="ttdoc">This function returns the index of the first vector element.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00709">PetscVector.hpp:709</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5a93581252131e7434dd3a8c0d242bd2" name="a5a93581252131e7434dd3a8c0d242bd2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5a93581252131e7434dd3a8c0d242bd2">&#9670;&#160;</a></span>add() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>v(i) += value </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a016609e0912f741ed161b201edf8f86f">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00118">118</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  118</span>                                                      {</div>
<div class="line"><span class="lineno">  119</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  120</span>  assert(i&lt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>());</div>
<div class="line"><span class="lineno">  121</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  122</span>  <span class="keywordtype">int</span> i_val = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i);</div>
<div class="line"><span class="lineno">  123</span>  PetscScalar petsc_value = <span class="keyword">static_cast&lt;</span>PetscScalar<span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">  124</span> </div>
<div class="line"><span class="lineno">  125</span>  ierr = VecSetValues(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, 1, &amp;i_val, &amp;petsc_value, ADD_VALUES);</div>
<div class="line"><span class="lineno">  126</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  127</span>  this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  128</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9441d10fd772d3e3c0dafc3a2e71a784" name="a9441d10fd772d3e3c0dafc3a2e71a784"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9441d10fd772d3e3c0dafc3a2e71a784">&#9670;&#160;</a></span>add() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=V $" src="../../form_14.png"/></picture>. Simple vector addition, equal to the </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a6433358b382a0d0be3058336210d3bf2">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00298">298</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  298</span>                                            {</div>
<div class="line"><span class="lineno">  299</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">add</a>(1., v);</div>
<div class="line"><span class="lineno">  300</span>}</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a5a93581252131e7434dd3a8c0d242bd2"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">femus::PetscVector::add</a></div><div class="ttdeci">void add(const int i, const double value)</div><div class="ttdoc">v(i) += value</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d01/_petsc_vector_8cpp_source.html#l00118">PetscVector.cpp:118</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a7497e63d027d2cc022881f629b94d66b" name="a7497e63d027d2cc022881f629b94d66b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7497e63d027d2cc022881f629b94d66b">&#9670;&#160;</a></span>add_vector() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_16_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U+=V $" src="../../form_16.png"/></picture> where U and V are type <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a> </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#acf2d25ce69856346361c65e78df281ef">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00197">197</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  198</span>                                                                          {</div>
<div class="line"><span class="lineno">  199</span>  assert((<span class="keywordtype">int</span>)V.size() == dof_indices.size());</div>
<div class="line"><span class="lineno">  200</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(int)V.size(); i++)  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">add</a>(dof_indices[i], V(i));</div>
<div class="line"><span class="lineno">  201</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a233249cb34d4aacd2a3bf79dabcd6abd" name="a233249cb34d4aacd2a3bf79dabcd6abd"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a233249cb34d4aacd2a3bf79dabcd6abd">&#9670;&#160;</a></span>add_vector() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_13_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U+=A*V$" src="../../form_13.png"/></picture>, add the product of a <code><a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a></code> <code>A</code> </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a279b5c283fc92dbaa2b1d09dbf70e231">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00182">182</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  183</span>                                                        {</div>
<div class="line"><span class="lineno">  184</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  185</span>  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><span class="lineno">  186</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* V = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;V_in);</div>
<div class="line"><span class="lineno">  187</span>  <span class="keyword">const</span> PetscMatrix* <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>PetscMatrix*<span class="keyword">&gt;</span>(&amp;A_in);</div>
<div class="line"><span class="lineno">  188</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  189</span>  <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>-&gt;close();</div>
<div class="line"><span class="lineno">  190</span> </div>
<div class="line"><span class="lineno">  191</span>  <span class="comment">// The const_cast&lt;&gt; is not elegant, but it is required since PETSc</span></div>
<div class="line"><span class="lineno">  192</span>  <span class="comment">// is not const-correct.</span></div>
<div class="line"><span class="lineno">  193</span>  ierr = MatMultAdd(<span class="keyword">const_cast&lt;</span>PetscMatrix*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>)-&gt;mat(), V-&gt;_vec, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  194</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  195</span>}</div>
<div class="ttc" id="ainternal__waves__zlevel_8cpp_html_a2941385b1be5280d3b1f546356f7ec99"><div class="ttname"><a href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a></div><div class="ttdeci">double A</div><div class="ttdef"><b>Definition</b> <a href="../../dc/d97/internal__waves__zlevel_8cpp_source.html#l00044">internal_waves_zlevel.cpp:44</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a0ea2979ea88d30eeb209ddb06f1cb431" name="a0ea2979ea88d30eeb209ddb06f1cb431"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0ea2979ea88d30eeb209ddb06f1cb431">&#9670;&#160;</a></span>add_vector() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add_vector </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_14_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=V $" src="../../form_14.png"/></picture> where U and V are type <code><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a></code> and you </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a4cb61447e41df8d24311a54a10a5b291">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00175">175</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  176</span>                                                                  {</div>
<div class="line"><span class="lineno">  177</span>  assert((<span class="keywordtype">int</span>)V.size() == (<span class="keywordtype">int</span>)dof_indices.size());</div>
<div class="line"><span class="lineno">  178</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(int)V.size(); i++) this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">add</a>(dof_indices[i], V(i));</div>
<div class="line"><span class="lineno">  179</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a8af71de6824f0853210942ea07a108fe" name="a8af71de6824f0853210942ea07a108fe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a8af71de6824f0853210942ea07a108fe">&#9670;&#160;</a></span>add_vector() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add_vector </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_12_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=v $" src="../../form_12.png"/></picture> where <code>v</code> is a std::vector </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a7189cbf63afd3adf254971ec36809c07">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00167">167</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  168</span>                                                                  {</div>
<div class="line"><span class="lineno">  169</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  170</span>  assert(v.size() == dof_indices.size());</div>
<div class="line"><span class="lineno">  171</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(int)v.size(); i++)    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">add</a>(dof_indices[i], v[i]);</div>
<div class="line"><span class="lineno">  172</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4feb57cf86ee97f01621c2f7cac891ea" name="a4feb57cf86ee97f01621c2f7cac891ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4feb57cf86ee97f01621c2f7cac891ea">&#9670;&#160;</a></span>add_vector_blocked() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add_vector_blocked </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_12_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U+=v $" src="../../form_12.png"/></picture> where <code>v</code> is a std::vector !!!fast </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0440021963af01ac49a6f02df562e44b">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00132">132</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  133</span>                                                                         {</div>
<div class="line"><span class="lineno">  134</span>  <span class="comment">//this-&gt;_restore_array();</span></div>
<div class="line"><span class="lineno">  135</span>  <span class="keywordtype">int</span> dof_size = dof_indices.size();</div>
<div class="line"><span class="lineno">  136</span>  assert(values.size() == dof_size);</div>
<div class="line"><span class="lineno">  137</span> </div>
<div class="line"><span class="lineno">  138</span>  <span class="keywordtype">int</span> ierr = VecSetValues(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,dof_size,&amp;dof_indices[0],&amp;values[0],ADD_VALUES);</div>
<div class="line"><span class="lineno">  139</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  140</span> </div>
<div class="line"><span class="lineno">  141</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a39cd7a4e0cfb6ee02948cfc94df22be9" name="a39cd7a4e0cfb6ee02948cfc94df22be9"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a39cd7a4e0cfb6ee02948cfc94df22be9">&#9670;&#160;</a></span>add_vector_blocked() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::add_vector_blocked </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; unsigned &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aae38f0c4f3d840a615894b1ee846c96c">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00144">144</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  145</span>                                                                               {</div>
<div class="line"><span class="lineno">  146</span>  <span class="comment">//this-&gt;_restore_array();</span></div>
<div class="line"><span class="lineno">  147</span>  <span class="keywordtype">int</span> dof_size = dof_indices.size();</div>
<div class="line"><span class="lineno">  148</span>  assert(values.size() == dof_size);</div>
<div class="line"><span class="lineno">  149</span>  </div>
<div class="line"><span class="lineno">  150</span>  <span class="keywordtype">int</span> ierr = VecSetValues(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,dof_size,(<span class="keywordtype">int</span>*)&amp;dof_indices[0],&amp;values[0],ADD_VALUES);</div>
<div class="line"><span class="lineno">  151</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  152</span>  </div>
<div class="line"><span class="lineno">  153</span>                                     }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a37320faa1f195935598941fde977c57c" name="a37320faa1f195935598941fde977c57c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a37320faa1f195935598941fde977c57c">&#9670;&#160;</a></span>BinaryLoad()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::BinaryLoad </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ad18ea02ddcee43fb8071b5125f4c1b5e">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00905">905</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  905</span>                                                  {</div>
<div class="line"><span class="lineno">  906</span>    </div>
<div class="line"><span class="lineno">  907</span>    PetscViewer binv;</div>
<div class="line"><span class="lineno">  908</span>    PetscViewerBinaryOpen(MPI_COMM_WORLD,fileName, FILE_MODE_READ, &amp;binv);</div>
<div class="line"><span class="lineno">  909</span>    VecLoad(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, binv);</div>
<div class="line"><span class="lineno">  910</span>    PetscViewerDestroy(&amp;binv);</div>
<div class="line"><span class="lineno">  911</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a>();</div>
<div class="line"><span class="lineno">  912</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4ec1a8d67f0d7a413678ddc9f407b071" name="a4ec1a8d67f0d7a413678ddc9f407b071"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4ec1a8d67f0d7a413678ddc9f407b071">&#9670;&#160;</a></span>BinaryPrint()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::BinaryPrint </td>
          <td>(</td>
          <td class="paramtype">const char *&#160;</td>
          <td class="paramname"><em>fileName</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Reimplemented from <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#af87a4526918cc4b5a825f6ff9dd7616d">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00895">895</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  895</span>                                                   {</div>
<div class="line"><span class="lineno">  896</span>    </div>
<div class="line"><span class="lineno">  897</span>    PetscViewer binv;</div>
<div class="line"><span class="lineno">  898</span>    PetscViewerBinaryOpen(MPI_COMM_WORLD,fileName, FILE_MODE_WRITE, &amp;binv);</div>
<div class="line"><span class="lineno">  899</span>    VecView(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, binv);</div>
<div class="line"><span class="lineno">  900</span>    PetscViewerDestroy(&amp;binv);</div>
<div class="line"><span class="lineno">  901</span>   </div>
<div class="line"><span class="lineno">  902</span>    </div>
<div class="line"><span class="lineno">  903</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa554690df717f373d2b51e564fc421d6" name="aa554690df717f373d2b51e564fc421d6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa554690df717f373d2b51e564fc421d6">&#9670;&#160;</a></span>build()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &gt; femus::NumericVector::build </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fe">SolverPackage</a>&#160;</td>
          <td class="paramname"><em>solver_package</em> = <code>LSOLVER</code></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">static</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Builds a <code><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a></code> using the linear solver package specified by <code>solver_package</code> </p>

<p class="definition">Definition at line <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html#l00036">36</a> of file <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html">NumericVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   37</span>  {</div>
<div class="line"><span class="lineno">   38</span>    <span class="comment">// Build the appropriate vector</span></div>
<div class="line"><span class="lineno">   39</span>    <span class="keywordflow">switch</span>(solver_package) {</div>
<div class="line"><span class="lineno">   40</span><span class="preprocessor">#ifdef HAVE_PETSC</span></div>
<div class="line"><span class="lineno">   41</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea0c85f2467c937723b91a9219b0b55399">PETSC_SOLVERS</a>: {</div>
<div class="line"><span class="lineno">   42</span>          std::unique_ptr&lt;NumericVector &gt; <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>(<span class="keyword">new</span> PetscVector);</div>
<div class="line"><span class="lineno">   43</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>;</div>
<div class="line"><span class="lineno">   44</span>        }</div>
<div class="line"><span class="lineno">   45</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   46</span><span class="preprocessor">#ifdef HAVE_TRILINOS</span></div>
<div class="line"><span class="lineno">   47</span>      <span class="keywordflow">case</span> <a class="code hl_enumvalue" href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea4ab73e197d88ce3b742bcd4bcc0bd5e4">TRILINOS_SOLVERS</a>: {</div>
<div class="line"><span class="lineno">   48</span>          std::unique_ptr&lt;NumericVector &gt; <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>(<span class="keyword">new</span> EpetraVector&lt;double&gt;);</div>
<div class="line"><span class="lineno">   49</span>          <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a>;</div>
<div class="line"><span class="lineno">   50</span>        }</div>
<div class="line"><span class="lineno">   51</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">   52</span>      <span class="keywordflow">default</span>:</div>
<div class="line"><span class="lineno">   53</span>        std::cerr &lt;&lt; <span class="stringliteral">&quot;SolverPackage solver_package:  Unrecognized: &quot;</span> &lt;&lt; solver_package;</div>
<div class="line"><span class="lineno">   54</span>        abort();</div>
<div class="line"><span class="lineno">   55</span>    }</div>
<div class="line"><span class="lineno">   56</span>  }</div>
<div class="ttc" id="a_solver_package_enum_8hpp_html_a32541e934c944770722653e69abe38fea0c85f2467c937723b91a9219b0b55399"><div class="ttname"><a href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea0c85f2467c937723b91a9219b0b55399">PETSC_SOLVERS</a></div><div class="ttdeci">@ PETSC_SOLVERS</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d99/_solver_package_enum_8hpp_source.html#l00005">SolverPackageEnum.hpp:5</a></div></div>
<div class="ttc" id="a_solver_package_enum_8hpp_html_a32541e934c944770722653e69abe38fea4ab73e197d88ce3b742bcd4bcc0bd5e4"><div class="ttname"><a href="../../d0/d99/_solver_package_enum_8hpp.html#a32541e934c944770722653e69abe38fea4ab73e197d88ce3b742bcd4bcc0bd5e4">TRILINOS_SOLVERS</a></div><div class="ttdeci">@ TRILINOS_SOLVERS</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d99/_solver_package_enum_8hpp_source.html#l00006">SolverPackageEnum.hpp:6</a></div></div>
<div class="ttc" id="a_willmore_2_willmore_surface_2ex1_2ex1_8cpp_html_a8d72c06f81fac2023cddbaf79c968a51"><div class="ttname"><a href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp.html#a8d72c06f81fac2023cddbaf79c968a51">ap</a></div><div class="ttdeci">const double ap[3]</div><div class="ttdef"><b>Definition</b> <a href="../../d4/d7d/_willmore_2_willmore_surface_2ex1_2ex1_8cpp_source.html#l00035">ex1.cpp:35</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a157618d9b5afa9ba23a7f62121194960" name="a157618d9b5afa9ba23a7f62121194960"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a157618d9b5afa9ba23a7f62121194960">&#9670;&#160;</a></span>clear()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::clear </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the <code><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a></code> to a pristine state. </p>

<p>Reimplemented from <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ab208467b03b999ece4888d64a7cc7ece">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00645">645</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  645</span>                                  {</div>
<div class="line"><span class="lineno">  646</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>())    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  647</span> </div>
<div class="line"><span class="lineno">  648</span>    <span class="keywordflow">if</span> ( (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>()) &amp;&amp; (this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a>))    {</div>
<div class="line"><span class="lineno">  649</span>      <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  650</span>      ierr = VecDestroy (&amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  651</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  652</span>    }</div>
<div class="line"><span class="lineno">  653</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">_is_initialized</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  654</span>    <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>.clear();</div>
<div class="line"><span class="lineno">  655</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aa25bb3fa43aa9c5e5de7b5772a4d386c" name="aa25bb3fa43aa9c5e5de7b5772a4d386c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aa25bb3fa43aa9c5e5de7b5772a4d386c">&#9670;&#160;</a></span>clone()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">std::unique_ptr&lt; <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &gt; femus::PetscVector::clone </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a copy of this vector and returns it in an <code>AutoPtr</code>. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a3cf215a263d72e9fd0cf3d26ee10be8e">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00681">681</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  681</span>                                                                 {</div>
<div class="line"><span class="lineno">  682</span>    std::unique_ptr&lt;NumericVector&gt; cloned_vector (<span class="keyword">new</span> PetscVector);</div>
<div class="line"><span class="lineno">  683</span>    cloned_vector-&gt;init (*<span class="keyword">this</span>, <span class="keyword">true</span>);</div>
<div class="line"><span class="lineno">  684</span>    *cloned_vector = *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  685</span>    <span class="keywordflow">return</span> cloned_vector;</div>
<div class="line"><span class="lineno">  686</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a68fd9a4430cff15afec82d63479c4227" name="a68fd9a4430cff15afec82d63479c4227"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a68fd9a4430cff15afec82d63479c4227">&#9670;&#160;</a></span>close()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::close </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Call the assemble functions. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80eb1dc1f53018fd7d08bcc4a511cc09">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00595">595</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  595</span>                                  {</div>
<div class="line"><span class="lineno">  596</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  597</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  598</span> </div>
<div class="line"><span class="lineno">  599</span>    ierr = VecAssemblyBegin (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  600</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  601</span>    ierr = VecAssemblyEnd (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  602</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  603</span> </div>
<div class="line"><span class="lineno">  604</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) {</div>
<div class="line"><span class="lineno">  605</span>      ierr = VecGhostUpdateBegin (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  606</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  607</span>      ierr = VecGhostUpdateEnd (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  608</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  609</span> </div>
<div class="line"><span class="lineno">  610</span>    }</div>
<div class="line"><span class="lineno">  611</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  612</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a34f55bd075ab087a8b6c2d10fe962f0a" name="a34f55bd075ab087a8b6c2d10fe962f0a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a34f55bd075ab087a8b6c2d10fe962f0a">&#9670;&#160;</a></span>closed()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool femus::NumericVector::closed </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if the vector is closed and ready </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00179">179</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  179</span>                              {</div>
<div class="line"><span class="lineno">  180</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a>;</div>
<div class="line"><span class="lineno">  181</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae203746f2ff75bdc4febe35e3d637d18" name="ae203746f2ff75bdc4febe35e3d637d18"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae203746f2ff75bdc4febe35e3d637d18">&#9670;&#160;</a></span>closeWithMinValues()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::closeWithMinValues </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#afeb0048287cf27d9dbd38363adc0c326">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00614">614</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  614</span>                                              {</div>
<div class="line"><span class="lineno">  615</span> </div>
<div class="line"><span class="lineno">  616</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) {</div>
<div class="line"><span class="lineno">  619</span>      <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>) {  </div>
<div class="line"><span class="lineno">  620</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Warning! The function PetscVector::closeWithMinValues() is only available for GHOSTED vector!\n&quot;</span>;</div>
<div class="line"><span class="lineno">  621</span>        std::cout &lt;&lt; <span class="stringliteral">&quot;Calling regular close() function instead\n&quot;</span>;</div>
<div class="line"><span class="lineno">  622</span>      }</div>
<div class="line"><span class="lineno">  623</span>      this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a>();</div>
<div class="line"><span class="lineno">  624</span>    }</div>
<div class="line"><span class="lineno">  625</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  626</span>      <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  627</span> </div>
<div class="line"><span class="lineno">  628</span><span class="comment">//       ierr = VecGhostUpdateBegin (_vec, MIN_VALUES, SCATTER_REVERSE);</span></div>
<div class="line"><span class="lineno">  629</span>      ierr = VecGhostUpdateBegin (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"><span class="lineno">  630</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  631</span><span class="comment">//       ierr = VecGhostUpdateEnd (_vec, MIN_VALUES, SCATTER_REVERSE);</span></div>
<div class="line"><span class="lineno">  632</span>      ierr = VecGhostUpdateEnd (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, INSERT_VALUES, SCATTER_REVERSE);</div>
<div class="line"><span class="lineno">  633</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  634</span> </div>
<div class="line"><span class="lineno">  635</span>      ierr = VecGhostUpdateBegin (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  636</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  637</span>      ierr = VecGhostUpdateEnd (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  638</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  639</span> </div>
<div class="line"><span class="lineno">  640</span>      this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  641</span>    }</div>
<div class="line"><span class="lineno">  642</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a692068ac78adf8745fa5ba7a2efd7189" name="a692068ac78adf8745fa5ba7a2efd7189"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a692068ac78adf8745fa5ba7a2efd7189">&#9670;&#160;</a></span>compare()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::NumericVector::compare </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>other_vector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>threshold</em> = <code>1.e-20</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd><code>-1</code> when <code>this</code> is equivalent to <code>other_vector</code>, </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html#l00059">59</a> of file <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html">NumericVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   61</span>  {</div>
<div class="line"><span class="lineno">   62</span>    assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">   63</span>    assert(other_vector.initialized());</div>
<div class="line"><span class="lineno">   64</span>    assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0249a27bfb19a2b8c7eb87b30b3e8ec0">first_local_index</a>() == other_vector.first_local_index());</div>
<div class="line"><span class="lineno">   65</span>    assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a801088d0a16b73338893411c00b594a0">last_local_index</a>()  == other_vector.last_local_index());</div>
<div class="line"><span class="lineno">   66</span> </div>
<div class="line"><span class="lineno">   67</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> initialization_val = std::numeric_limits&lt;int&gt;::max();<span class="comment">/*-1; this is not working in parallel*/</span></div>
<div class="line"><span class="lineno">   68</span> </div>
<div class="line"><span class="lineno">   69</span>    <span class="keywordtype">int</span> first_different_i     = initialization_val;</div>
<div class="line"><span class="lineno">   70</span>    </div>
<div class="line"><span class="lineno">   71</span>    <span class="keywordtype">int</span> i = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0249a27bfb19a2b8c7eb87b30b3e8ec0">first_local_index</a>();</div>
<div class="line"><span class="lineno">   72</span> </div>
<div class="line"><span class="lineno">   73</span>    <span class="keywordflow">do</span> {</div>
<div class="line"><span class="lineno">   74</span>      <span class="keywordflow">if</span>( std::abs((*<span class="keyword">this</span>)(i) - other_vector(i) ) &gt; threshold)</div>
<div class="line"><span class="lineno">   75</span>        first_different_i = i;</div>
<div class="line"><span class="lineno">   76</span>      <span class="keywordflow">else</span></div>
<div class="line"><span class="lineno">   77</span>        i++;</div>
<div class="line"><span class="lineno">   78</span>    }</div>
<div class="line"><span class="lineno">   79</span>    <span class="keywordflow">while</span>(first_different_i == initialization_val &amp;&amp; i &lt; <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a801088d0a16b73338893411c00b594a0">last_local_index</a>());</div>
<div class="line"><span class="lineno">   80</span> </div>
<div class="line"><span class="lineno">   81</span>  <span class="comment">// Find the correct first differing index in parallel</span></div>
<div class="line"><span class="lineno">   82</span>    <a class="code hl_function" href="../../db/ded/namespacefemus_1_1_parallel.html#a63e5f0fd22309cacacb73e7dfd3256df">Parallel::min</a>(first_different_i);</div>
<div class="line"><span class="lineno">   83</span> </div>
<div class="line"><span class="lineno">   84</span><span class="comment">//     if (n_procs &gt; 1)</span></div>
<div class="line"><span class="lineno">   85</span><span class="comment">//     {</span></div>
<div class="line"><span class="lineno">   86</span><span class="comment">//       MPI_Allreduce (MPI_IN_PLACE, &amp; first_different_i, 1,  MPI_INT, MPI_MIN,  MPI_COMM_WORLD);</span></div>
<div class="line"><span class="lineno">   87</span><span class="comment">//     }</span></div>
<div class="line"><span class="lineno">   88</span> </div>
<div class="line"><span class="lineno">   89</span>  </div>
<div class="line"><span class="lineno">   90</span>  </div>
<div class="line"><span class="lineno">   91</span>  </div>
<div class="line"><span class="lineno">   92</span>  </div>
<div class="line"><span class="lineno">   93</span>  <span class="keywordflow">if</span> (first_different_i == std::numeric_limits&lt;int&gt;::max())  { <span class="keywordflow">return</span> -1; }</div>
<div class="line"><span class="lineno">   94</span> </div>
<div class="line"><span class="lineno">   95</span>  <span class="keywordflow">return</span> first_different_i;</div>
<div class="line"><span class="lineno">   96</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a0249a27bfb19a2b8c7eb87b30b3e8ec0"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a0249a27bfb19a2b8c7eb87b30b3e8ec0">femus::NumericVector::first_local_index</a></div><div class="ttdeci">virtual int first_local_index() const =0</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a801088d0a16b73338893411c00b594a0"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a801088d0a16b73338893411c00b594a0">femus::NumericVector::last_local_index</a></div><div class="ttdeci">virtual int last_local_index() const =0</div></div>
<div class="ttc" id="anamespacefemus_1_1_parallel_html_a63e5f0fd22309cacacb73e7dfd3256df"><div class="ttname"><a href="../../db/ded/namespacefemus_1_1_parallel.html#a63e5f0fd22309cacacb73e7dfd3256df">femus::Parallel::min</a></div><div class="ttdeci">void min(T &amp;r)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dec/_parallel_8hpp_source.html#l01686">Parallel.hpp:1686</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9cb55d3292876ec373b24403e49e7a4f" name="a9cb55d3292876ec373b24403e49e7a4f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9cb55d3292876ec373b24403e49e7a4f">&#9670;&#160;</a></span>create_subvector()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::create_subvector </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>subvector</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>rows</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a "subvector" from this vector using the rows indices of the "rows" array. </p>
<p>This function creates a subvector. </p>

<p>Reimplemented from <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aabe0286e4e88ef9c2c8a8ea5442ea511">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00824">824</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  827</span>        {<span class="comment">// ======================</span></div>
<div class="line"><span class="lineno">  828</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  829</span> </div>
<div class="line"><span class="lineno">  830</span>  <span class="comment">// PETSc data structures</span></div>
<div class="line"><span class="lineno">  831</span>  IS parent_is, subvector_is;</div>
<div class="line"><span class="lineno">  832</span>  VecScatter scatter;</div>
<div class="line"><span class="lineno">  833</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  834</span> </div>
<div class="line"><span class="lineno">  835</span>  <span class="comment">// Make sure the passed in subvector is really a PetscVector</span></div>
<div class="line"><span class="lineno">  836</span>  <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* petsc_subvector = <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;subvector);</div>
<div class="line"><span class="lineno">  837</span> </div>
<div class="line"><span class="lineno">  838</span>  <span class="comment">// If the petsc_subvector is already initialized, we assume that the</span></div>
<div class="line"><span class="lineno">  839</span>  <span class="comment">// user has already allocated the *correct* amount of space for it.</span></div>
<div class="line"><span class="lineno">  840</span>  <span class="comment">// If not, we use the appropriate PETSc routines to initialize it.</span></div>
<div class="line"><span class="lineno">  841</span>  <span class="keywordflow">if</span> (!petsc_subvector-&gt;initialized())  {</div>
<div class="line"><span class="lineno">  842</span>    <span class="comment">// Initialize the petsc_subvector to have enough space to hold</span></div>
<div class="line"><span class="lineno">  843</span>    <span class="comment">// the entries which will be scattered into it.  Note: such an</span></div>
<div class="line"><span class="lineno">  844</span>    <span class="comment">// init() function (where we let PETSc decide the number of local</span></div>
<div class="line"><span class="lineno">  845</span>    <span class="comment">// entries) is not currently offered by the PetscVector</span></div>
<div class="line"><span class="lineno">  846</span>    <span class="comment">// class.  Should we differentiate here between sequential and</span></div>
<div class="line"><span class="lineno">  847</span>    <span class="comment">// parallel vector creation based on n_processors() ?</span></div>
<div class="line"><span class="lineno">  848</span>    ierr = VecCreateMPI(MPI_COMM_WORLD,</div>
<div class="line"><span class="lineno">  849</span>                        PETSC_DECIDE,          <span class="comment">// n_local</span></div>
<div class="line"><span class="lineno">  850</span>                        rows.size(),           <span class="comment">// n_global</span></div>
<div class="line"><span class="lineno">  851</span>                        &amp;(petsc_subvector-&gt;_vec));</div>
<div class="line"><span class="lineno">  852</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  853</span> </div>
<div class="line"><span class="lineno">  854</span>    ierr = VecSetFromOptions(petsc_subvector-&gt;_vec);</div>
<div class="line"><span class="lineno">  855</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  856</span>    <span class="comment">// Mark the subvector as initialized</span></div>
<div class="line"><span class="lineno">  857</span>    petsc_subvector-&gt;_is_initialized = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  858</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  859</span>    petsc_subvector-&gt;_restore_array();</div>
<div class="line"><span class="lineno">  860</span>  }</div>
<div class="line"><span class="lineno">  861</span> </div>
<div class="line"><span class="lineno">  862</span>  <span class="comment">// Use iota to fill an array with entries [0,1,2,3,4,...rows.size()]</span></div>
<div class="line"><span class="lineno">  863</span>  std::vector&lt;int&gt; <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>(rows.size());</div>
<div class="line"><span class="lineno">  864</span>  std::iota(<a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>.begin(), <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>.end(), 0);</div>
<div class="line"><span class="lineno">  865</span><span class="comment">//   Utility::iota (idx.begin(), idx.end(), 0);</span></div>
<div class="line"><span class="lineno">  866</span> </div>
<div class="line"><span class="lineno">  867</span>  <span class="comment">// Construct index sets</span></div>
<div class="line"><span class="lineno">  868</span>  ierr = ISCreateGeneral(MPI_COMM_WORLD,rows.size(),(<span class="keywordtype">int</span>*) &amp;rows[0],</div>
<div class="line"><span class="lineno">  869</span>                         PETSC_USE_POINTER,&amp;parent_is);</div>
<div class="line"><span class="lineno">  870</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  871</span>  ierr = ISCreateGeneral(MPI_COMM_WORLD,rows.size(),(<span class="keywordtype">int</span>*) &amp;idx[0],</div>
<div class="line"><span class="lineno">  872</span>                         PETSC_USE_POINTER,&amp;subvector_is);</div>
<div class="line"><span class="lineno">  873</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  874</span>  <span class="comment">// Construct the scatter object</span></div>
<div class="line"><span class="lineno">  875</span>  ierr = VecScatterCreate(this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,parent_is,petsc_subvector-&gt;_vec,</div>
<div class="line"><span class="lineno">  876</span>                          subvector_is,&amp;scatter);</div>
<div class="line"><span class="lineno">  877</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  878</span>  <span class="comment">// Actually perform the scatter</span></div>
<div class="line"><span class="lineno">  879</span>  ierr = VecScatterBegin(scatter, this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, petsc_subvector-&gt;_vec,</div>
<div class="line"><span class="lineno">  880</span>                         INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  881</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  882</span>  ierr = VecScatterEnd(scatter, this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, petsc_subvector-&gt;_vec,</div>
<div class="line"><span class="lineno">  883</span>                       INSERT_VALUES,SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  884</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  885</span>  <span class="comment">// Clean up</span></div>
<div class="line"><span class="lineno">  886</span>  ierr = ISDestroy(&amp;parent_is);</div>
<div class="line"><span class="lineno">  887</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  888</span>  ierr = ISDestroy(&amp;subvector_is);</div>
<div class="line"><span class="lineno">  889</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  890</span>  ierr = VecScatterDestroy(&amp;scatter);</div>
<div class="line"><span class="lineno">  891</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  892</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  893</span>}</div>
<div class="ttc" id="anamespacefemus_1_1_mesh_tools_1_1_generation_1_1_private_html_aaf3a90632b9ae7f97dc126807a304603"><div class="ttname"><a href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">femus::MeshTools::Generation::Private::idx</a></div><div class="ttdeci">unsigned int idx(const ElemType type, const unsigned int nx, const unsigned int i, const unsigned int j)</div><div class="ttdef"><b>Definition</b> <a href="../../de/dd7/_mesh_generation_8cpp_source.html#l00052">MeshGeneration.cpp:52</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a76b87d476c3ddfea50e186323e42dad0" name="a76b87d476c3ddfea50e186323e42dad0"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a76b87d476c3ddfea50e186323e42dad0">&#9670;&#160;</a></span>dot()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::dot </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Computes the dot product, p = U.V. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a11301832a7c65ec6f66aecdcf4adcebe">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00399">399</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  399</span>                                                    {</div>
<div class="line"><span class="lineno">  400</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  401</span>  <span class="comment">// Error flag and Return value</span></div>
<div class="line"><span class="lineno">  402</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  403</span>  PetscScalar value=0.;</div>
<div class="line"><span class="lineno">  404</span>  <span class="comment">// Make sure the NumericVector passed in is really a PetscVector</span></div>
<div class="line"><span class="lineno">  405</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* v = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;V);</div>
<div class="line"><span class="lineno">  406</span>  <span class="comment">// 2.3.x (at least) style.  Untested for previous versions.</span></div>
<div class="line"><span class="lineno">  407</span>  ierr = VecDot(this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, v-&gt;_vec, &amp;value);</div>
<div class="line"><span class="lineno">  408</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  409</span>  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">  410</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adc6ca7c50215bf1e82722d08b511ac82" name="adc6ca7c50215bf1e82722d08b511ac82"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adc6ca7c50215bf1e82722d08b511ac82">&#9670;&#160;</a></span>el()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual double femus::NumericVector::el </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the element <code>U(i)</code> </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00226">226</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  226</span>                                        {</div>
<div class="line"><span class="lineno">  227</span>    <span class="keywordflow">return</span> (*<span class="keyword">this</span>)(i);</div>
<div class="line"><span class="lineno">  228</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a0721bc1a1506471210879d543e7fe6fc" name="a0721bc1a1506471210879d543e7fe6fc"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0721bc1a1506471210879d543e7fe6fc">&#9670;&#160;</a></span>first_local_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::PetscVector::first_local_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the index of the first vector element. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0249a27bfb19a2b8c7eb87b30b3e8ec0">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00709">709</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  709</span>                                                   {</div>
<div class="line"><span class="lineno">  710</span>    assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  711</span>    <span class="keywordtype">int</span> ierr = 0, petsc_first = 0, petsc_last = 0;</div>
<div class="line"><span class="lineno">  712</span>    ierr = VecGetOwnershipRange (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;petsc_first, &amp;petsc_last);</div>
<div class="line"><span class="lineno">  713</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  714</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_first);</div>
<div class="line"><span class="lineno">  715</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac13d5c896c438e020242dc1398a27f2" name="aac13d5c896c438e020242dc1398a27f2"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac13d5c896c438e020242dc1398a27f2">&#9670;&#160;</a></span>get()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::get </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>index</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>values</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Access multiple components at once. Overloaded method that should be faster (probably much faster) than calling <code>operator()</code> individually for each index. </p>

<p>Reimplemented from <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a3b3e0e4ad00dfd23aee8d226264cfbb9">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00762">762</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  762</span>                                                                                            {</div>
<div class="line"><span class="lineno">  763</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9f69ab1cfaa5e08f4421cdce135c5804">_get_array</a>();</div>
<div class="line"><span class="lineno">  764</span> </div>
<div class="line"><span class="lineno">  765</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> num = index.size();</div>
<div class="line"><span class="lineno">  766</span>    values.resize (num);</div>
<div class="line"><span class="lineno">  767</span> </div>
<div class="line"><span class="lineno">  768</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; num; i++) {</div>
<div class="line"><span class="lineno">  769</span>      <span class="keyword">const</span> <span class="keywordtype">int</span> local_index = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a56ca5070aac99c844908d46309949a7c">map_global_to_local_index</a> (index[i]);</div>
<div class="line"><span class="lineno">  770</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno">  771</span>      <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) assert (local_index &lt; <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0fa88c0d3fa08d1e690d2bdc6936b5ca">_local_size</a>);</div>
<div class="line"><span class="lineno">  772</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  773</span>      values[i] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a>[local_index]);</div>
<div class="line"><span class="lineno">  774</span>    }</div>
<div class="line"><span class="lineno">  775</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a56ca5070aac99c844908d46309949a7c"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a56ca5070aac99c844908d46309949a7c">femus::PetscVector::map_global_to_local_index</a></div><div class="ttdeci">int map_global_to_local_index(const int i) const</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00727">PetscVector.hpp:727</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a9f69ab1cfaa5e08f4421cdce135c5804"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9f69ab1cfaa5e08f4421cdce135c5804">femus::PetscVector::_get_array</a></div><div class="ttdeci">void _get_array(void) const</div><div class="ttdoc">Queries the array (and the local form if the vector is ghosted) from Petsc.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00811">PetscVector.hpp:811</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2bcb23296dec3bf06d653d0dcf1912ea" name="a2bcb23296dec3bf06d653d0dcf1912ea"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2bcb23296dec3bf06d653d0dcf1912ea">&#9670;&#160;</a></span>init() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::init </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>fast</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>call init with n_local = N, </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a25073e01fdd83a8eddf1e6c13ebc668c">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00508">508</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  510</span>                                                          {</div>
<div class="line"><span class="lineno">  511</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#aab9b165d31a203194f7b82071343358c">init</a> (n, n, fast, <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>);</div>
<div class="line"><span class="lineno">  512</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="aab9b165d31a203194f7b82071343358c" name="aab9b165d31a203194f7b82071343358c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aab9b165d31a203194f7b82071343358c">&#9670;&#160;</a></span>init() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::init </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>N</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>fast</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Change the dimension of the vector to <code>N</code>. doublehe reserved memory for this vector remains unchanged if possible, to make things faster, but this may waste some memory, so take this in the back of your head. However, if <code>N==0</code> all memory is freed, i.e. if you want to resize the vector and release the memory not needed, you have to first call <code>init(0)</code> and then <code>init(N)</code>. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd17257b0b8aa9e09fd13cbd9c0bed08">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00466">466</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  469</span>                                                          {</div>
<div class="line"><span class="lineno">  470</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  471</span>    <span class="keywordtype">int</span> petsc_n = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (n);</div>
<div class="line"><span class="lineno">  472</span>    <span class="keywordtype">int</span> petsc_n_local = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (n_local);</div>
<div class="line"><span class="lineno">  473</span>    <span class="comment">// Clear initialized vectors</span></div>
<div class="line"><span class="lineno">  474</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>())  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a157618d9b5afa9ba23a7f62121194960">clear</a>();</div>
<div class="line"><span class="lineno">  475</span>    <span class="keywordflow">if</span> (<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a> == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a>)    {</div>
<div class="line"><span class="lineno">  476</span>      <span class="keywordflow">if</span> (n == n_local)   this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>;</div>
<div class="line"><span class="lineno">  477</span>      <span class="keywordflow">else</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>;</div>
<div class="line"><span class="lineno">  478</span>    }</div>
<div class="line"><span class="lineno">  479</span>    <span class="keywordflow">else</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>;</div>
<div class="line"><span class="lineno">  480</span> </div>
<div class="line"><span class="lineno">  481</span>    assert ( (this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a> &amp;&amp; n == n_local) || this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>);</div>
<div class="line"><span class="lineno">  482</span> </div>
<div class="line"><span class="lineno">  483</span>    <span class="comment">// create a sequential vector if on only 1 processor</span></div>
<div class="line"><span class="lineno">  484</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab110642f01505447ed49cf2d49fbf0a2">SERIAL</a>) {</div>
<div class="line"><span class="lineno">  485</span>      ierr = VecCreateSeq (PETSC_COMM_SELF, petsc_n, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  486</span>      CHKERRABORT (PETSC_COMM_SELF, ierr);</div>
<div class="line"><span class="lineno">  487</span>      ierr = VecSetFromOptions (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  488</span>      CHKERRABORT (PETSC_COMM_SELF, ierr);</div>
<div class="line"><span class="lineno">  489</span>    }</div>
<div class="line"><span class="lineno">  490</span>    <span class="comment">// otherwise create an MPI-enabled vector</span></div>
<div class="line"><span class="lineno">  491</span>    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>) {</div>
<div class="line"><span class="lineno">  492</span>      assert (n_local &lt;= n);</div>
<div class="line"><span class="lineno">  493</span>      ierr = VecCreateMPI (MPI_COMM_WORLD, petsc_n_local, petsc_n, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  494</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  495</span>      ierr = VecSetFromOptions (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  496</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  497</span>    }</div>
<div class="line"><span class="lineno">  498</span>    <span class="keywordflow">else</span>   {</div>
<div class="line"><span class="lineno">  499</span>      std::cout &lt;&lt; <span class="stringliteral">&quot;Not good&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  500</span>      abort();</div>
<div class="line"><span class="lineno">  501</span>    }</div>
<div class="line"><span class="lineno">  502</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">_is_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  503</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  504</span>    <span class="keywordflow">if</span> (fast == <span class="keyword">false</span>)  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac59f171adcae52dd1777b3f09941771b">zero</a> ();</div>
<div class="line"><span class="lineno">  505</span>  }</div>
<div class="ttc" id="a_paralleltype_enum_8hpp_html_a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda"><div class="ttname"><a href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></div><div class="ttdeci">@ AUTOMATIC</div><div class="ttdef"><b>Definition</b> <a href="../../d4/dca/_paralleltype_enum_8hpp_source.html#l00005">ParalleltypeEnum.hpp:5</a></div></div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_ac59f171adcae52dd1777b3f09941771b"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac59f171adcae52dd1777b3f09941771b">femus::PetscVector::zero</a></div><div class="ttdeci">void zero()</div><div class="ttdoc">Set all entries to zero. Equivalent to v = 0.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00658">PetscVector.hpp:658</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4db1fba2a01663ccd6facc3e51a06ca4" name="a4db1fba2a01663ccd6facc3e51a06ca4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4db1fba2a01663ccd6facc3e51a06ca4">&#9670;&#160;</a></span>init() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::init </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>n_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>ghost</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>fast</em> = <code>false</code>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a>&#160;</td>
          <td class="paramname"><em>type</em> = <code><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a></code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Create a vector that holds tha local indices plus those specified in the <code>ghost</code> argument. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#af615f6d94b46ac802b4c2434177154ac">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00515">515</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  519</span>                                                          {</div>
<div class="line"><span class="lineno">  520</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  521</span>    PetscInt petsc_n = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (n);</div>
<div class="line"><span class="lineno">  522</span>    PetscInt petsc_n_local = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (n_local);</div>
<div class="line"><span class="lineno">  523</span>    PetscInt petsc_n_ghost = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (ghost.size());</div>
<div class="line"><span class="lineno">  524</span> </div>
<div class="line"><span class="lineno">  525</span>    <span class="comment">// If the mesh is not disjoint, every processor will either have</span></div>
<div class="line"><span class="lineno">  526</span>    <span class="comment">// all the dofs, none of the dofs, or some non-zero dofs at the</span></div>
<div class="line"><span class="lineno">  527</span>    <span class="comment">// boundary between processors.</span></div>
<div class="line"><span class="lineno">  528</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  529</span>    <span class="comment">// However we can&#39;t assert this, because someone might want to</span></div>
<div class="line"><span class="lineno">  530</span>    <span class="comment">// construct a GHOSTED vector which doesn&#39;t include neighbor element</span></div>
<div class="line"><span class="lineno">  531</span>    <span class="comment">// dofs.  Boyce tried to do so in user code, and we&#39;re going to want</span></div>
<div class="line"><span class="lineno">  532</span>    <span class="comment">// to do so in S ystem::project_vector().</span></div>
<div class="line"><span class="lineno">  533</span>    <span class="comment">//</span></div>
<div class="line"><span class="lineno">  534</span>    <span class="comment">// libmesh_assert(n_local == 0 || n_local == n || !ghost.empty());</span></div>
<div class="line"><span class="lineno">  535</span> </div>
<div class="line"><span class="lineno">  536</span>    assert (<span class="keyword">sizeof</span> (PetscInt) == <span class="keyword">sizeof</span> (<span class="keywordtype">int</span>));</div>
<div class="line"><span class="lineno">  537</span>    <span class="comment">// If the mesh is disjoint, the following assertion will fail.</span></div>
<div class="line"><span class="lineno">  538</span>    <span class="comment">// If the mesh is not disjoint, every processor will either have</span></div>
<div class="line"><span class="lineno">  539</span>    <span class="comment">// all the dofs, none of the dofs, or some non-zero dofs at the</span></div>
<div class="line"><span class="lineno">  540</span>    <span class="comment">// boundary between processors.</span></div>
<div class="line"><span class="lineno">  541</span>    <span class="comment">//assert(n_local == 0 || n_local == n || !ghost.empty());</span></div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>    PetscInt* petsc_ghost = ghost.empty() ? PETSC_NULL :</div>
<div class="line"><span class="lineno">  544</span>                            <span class="keyword">const_cast&lt;</span><span class="keywordtype">int</span>*<span class="keyword">&gt;</span> (<span class="keyword">reinterpret_cast&lt;</span><span class="keyword">const </span>PetscInt*<span class="keyword">&gt;</span> (&amp;ghost[0]));</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>    <span class="comment">// Clear initialized vectors</span></div>
<div class="line"><span class="lineno">  547</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>())   this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a157618d9b5afa9ba23a7f62121194960">clear</a>();</div>
<div class="line"><span class="lineno">  548</span> </div>
<div class="line"><span class="lineno">  549</span>    assert (<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a> == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca0a831c2bc18e8354fe3e30ec0f3cdcda">AUTOMATIC</a> || <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a> == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>);</div>
<div class="line"><span class="lineno">  550</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>;</div>
<div class="line"><span class="lineno">  551</span> </div>
<div class="line"><span class="lineno">  552</span>    <span class="comment">/* Make the global-to-local ghost cell map.  */</span></div>
<div class="line"><span class="lineno">  553</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; (int) ghost.size(); i++) {</div>
<div class="line"><span class="lineno">  554</span>      <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>[ghost[i]] = i;</div>
<div class="line"><span class="lineno">  555</span>    }</div>
<div class="line"><span class="lineno">  556</span> </div>
<div class="line"><span class="lineno">  557</span>    <span class="comment">/* Create vector.  */</span></div>
<div class="line"><span class="lineno">  558</span>    ierr = VecCreateGhost (MPI_COMM_WORLD, petsc_n_local, petsc_n,</div>
<div class="line"><span class="lineno">  559</span>                           petsc_n_ghost, petsc_ghost, &amp;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  560</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  561</span> </div>
<div class="line"><span class="lineno">  562</span>    ierr = VecSetFromOptions (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  563</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  564</span> </div>
<div class="line"><span class="lineno">  565</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">_is_initialized</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  566</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">true</span>;</div>
<div class="line"><span class="lineno">  567</span>    <span class="keywordflow">if</span> (fast == <span class="keyword">false</span>)</div>
<div class="line"><span class="lineno">  568</span>      this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac59f171adcae52dd1777b3f09941771b">zero</a> ();</div>
<div class="line"><span class="lineno">  569</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5b41059f33c40724038fc2c9f317de85" name="a5b41059f33c40724038fc2c9f317de85"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5b41059f33c40724038fc2c9f317de85">&#9670;&#160;</a></span>init() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::init </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>other</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const bool&#160;</td>
          <td class="paramname"><em>fast</em> = <code>false</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a vector that has the same dimension. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a5e855a5b6050845459cd81c721e088dd">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00572">572</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  572</span>                                                                            {</div>
<div class="line"><span class="lineno">  573</span>    <span class="comment">// Clear initialized vectors</span></div>
<div class="line"><span class="lineno">  574</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>())   this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a157618d9b5afa9ba23a7f62121194960">clear</a>();</div>
<div class="line"><span class="lineno">  575</span>    <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>&amp; v = femus::cast_ref&lt;const PetscVector&amp;&gt; (other);</div>
<div class="line"><span class="lineno">  576</span>    <span class="comment">// Other vector should restore array.</span></div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">if</span> (v.initialized())    {</div>
<div class="line"><span class="lineno">  578</span>      v._restore_array();</div>
<div class="line"><span class="lineno">  579</span>    }</div>
<div class="line"><span class="lineno">  580</span> </div>
<div class="line"><span class="lineno">  581</span>    this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a> = v._global_to_local_map;</div>
<div class="line"><span class="lineno">  582</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a>      = v._is_closed;</div>
<div class="line"><span class="lineno">  583</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">_is_initialized</a> = v._is_initialized;</div>
<div class="line"><span class="lineno">  584</span>    this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> = v._type;</div>
<div class="line"><span class="lineno">  585</span> </div>
<div class="line"><span class="lineno">  586</span>    <span class="keywordflow">if</span> (v.size() != 0)   {</div>
<div class="line"><span class="lineno">  587</span>      <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  588</span>      ierr = VecDuplicate (v._vec, &amp;this-&gt;_vec);</div>
<div class="line"><span class="lineno">  589</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  590</span>    }</div>
<div class="line"><span class="lineno">  591</span>    <span class="keywordflow">if</span> (fast == <span class="keyword">false</span>)   this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac59f171adcae52dd1777b3f09941771b">zero</a> ();</div>
<div class="line"><span class="lineno">  592</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a26d8ccf5f86fae43264918ce337488b7" name="a26d8ccf5f86fae43264918ce337488b7"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a26d8ccf5f86fae43264918ce337488b7">&#9670;&#160;</a></span>initialized()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">virtual bool femus::NumericVector::initialized </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>true if the vector has been initialized, </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00175">175</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  175</span>                                   {</div>
<div class="line"><span class="lineno">  176</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a1c0db787810e7c4b7d385da57081790a">_is_initialized</a>;</div>
<div class="line"><span class="lineno">  177</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="afb25416c2bc4a3a6b3804667e45cf4e3" name="afb25416c2bc4a3a6b3804667e45cf4e3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#afb25416c2bc4a3a6b3804667e45cf4e3">&#9670;&#160;</a></span>insert() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::insert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../dd/d6a/classfemus_1_1_dense_sub_vector.html">DenseSubVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_6_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U=V $" src="../../form_6.png"/></picture> where V is type <a class="el" href="../../dd/d6a/classfemus_1_1_dense_sub_vector.html">DenseSubVector</a> </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa8ba2833d62343508676066556bbe506">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00354">354</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  355</span>                                                              {</div>
<div class="line"><span class="lineno">  356</span>  assert(V.size() == dof_indices.size());</div>
<div class="line"><span class="lineno">  357</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(int)V.size(); i++)  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#adb2885699276be01494525805c9252a8">set</a>(dof_indices[i], V(i));</div>
<div class="line"><span class="lineno">  358</span>}</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_adb2885699276be01494525805c9252a8"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#adb2885699276be01494525805c9252a8">femus::PetscVector::set</a></div><div class="ttdeci">void set(const int i, const double value)</div><div class="ttdoc">v(i) = value</div><div class="ttdef"><b>Definition</b> <a href="../../d9/d01/_petsc_vector_8cpp_source.html#l00106">PetscVector.cpp:106</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="ae2f10f91a6d1ace136d76318e1367985" name="ae2f10f91a6d1ace136d76318e1367985"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae2f10f91a6d1ace136d76318e1367985">&#9670;&#160;</a></span>insert() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::insert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_6_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U=V $" src="../../form_6.png"/></picture> where V is type <a class="el" href="../../d7/de8/classfemus_1_1_dense_vector.html">DenseVector</a> </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa141a3133a2a35962713cb331d8137f3">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00347">347</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  348</span>                                                              {</div>
<div class="line"><span class="lineno">  349</span>  assert(V.size() == dof_indices.size());</div>
<div class="line"><span class="lineno">  350</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(int)V.size(); i++)  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#adb2885699276be01494525805c9252a8">set</a>(dof_indices[i], V(i));</div>
<div class="line"><span class="lineno">  351</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a12109d30e50e3fcfc297f39efe0626e4" name="a12109d30e50e3fcfc297f39efe0626e4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a12109d30e50e3fcfc297f39efe0626e4">&#9670;&#160;</a></span>insert() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::insert </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_5_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U=V$" src="../../form_5.png"/></picture>, where U and V are type <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> and you </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a993c202d43f23f0e81d74b635cc5c3ba">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00340">340</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  341</span>                                                              {</div>
<div class="line"><span class="lineno">  342</span>  assert((<span class="keywordtype">int</span>)V.size() == (<span class="keywordtype">int</span>)dof_indices.size());</div>
<div class="line"><span class="lineno">  343</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(int)V.size(); i++)   this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#adb2885699276be01494525805c9252a8">set</a>(dof_indices[i], V(i));</div>
<div class="line"><span class="lineno">  344</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a166857b39031681311dd999d0012c3e8" name="a166857b39031681311dd999d0012c3e8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a166857b39031681311dd999d0012c3e8">&#9670;&#160;</a></span>insert() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::insert </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_4_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$ U=v $" src="../../form_4.png"/></picture> where v is a std::vector&lt;double&gt; </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a96f696c38f27d57cf58bfb0fac9d9f6f">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00333">333</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  334</span>                                                              {</div>
<div class="line"><span class="lineno">  335</span>  assert(v.size() == dof_indices.size());</div>
<div class="line"><span class="lineno">  336</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;(int)v.size(); i++)    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#adb2885699276be01494525805c9252a8">set</a>(dof_indices[i], v[i]);</div>
<div class="line"><span class="lineno">  337</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="af1daa9e3d925f4a2eca4b003de6653ef" name="af1daa9e3d925f4a2eca4b003de6653ef"></a>
<h2 class="memtitle"><span class="permalink"><a href="#af1daa9e3d925f4a2eca4b003de6653ef">&#9670;&#160;</a></span>insert_vector_blocked()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::insert_vector_blocked </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>values</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>dof_indices</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a49f6a79b10ae44161897b6ae9ee0df89">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00155">155</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  156</span>                                                                         {</div>
<div class="line"><span class="lineno">  157</span>  <span class="comment">//this-&gt;_restore_array();</span></div>
<div class="line"><span class="lineno">  158</span>  <span class="keywordtype">int</span> dof_size = dof_indices.size();</div>
<div class="line"><span class="lineno">  159</span>  assert(values.size() == dof_size);</div>
<div class="line"><span class="lineno">  160</span> </div>
<div class="line"><span class="lineno">  161</span>  <span class="keywordtype">int</span> ierr = VecSetValues(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,dof_size,&amp;dof_indices[0],&amp;values[0],INSERT_VALUES);</div>
<div class="line"><span class="lineno">  162</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  163</span> </div>
<div class="line"><span class="lineno">  164</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6e8ed7e8b882c5b283a5dca742b7999b" name="a6e8ed7e8b882c5b283a5dca742b7999b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6e8ed7e8b882c5b283a5dca742b7999b">&#9670;&#160;</a></span>l1_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::l1_norm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the <picture><source srcset="../../form_7_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$l_1$" src="../../form_7.png"/></picture>-norm of the vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#acf36fd402fe969244682a009f46d8f8c">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00055">55</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   55</span>                                  {</div>
<div class="line"><span class="lineno">   56</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">   57</span>  assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a>());</div>
<div class="line"><span class="lineno">   58</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">   59</span>  PetscReal value=0.;</div>
<div class="line"><span class="lineno">   60</span>  ierr = VecNorm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, NORM_1, &amp;value);</div>
<div class="line"><span class="lineno">   61</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">   62</span>  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">   63</span>}</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a34f55bd075ab087a8b6c2d10fe962f0a"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">femus::NumericVector::closed</a></div><div class="ttdeci">virtual bool closed() const</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00179">NumericVector.hpp:179</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a645238b7fe1b4851c0e4b6c067bf428a" name="a645238b7fe1b4851c0e4b6c067bf428a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a645238b7fe1b4851c0e4b6c067bf428a">&#9670;&#160;</a></span>l2_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::l2_norm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the <picture><source srcset="../../form_8_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$l_2$" src="../../form_8.png"/></picture>-norm of the vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa86bfb1f5b0cb1f61dbb564764b44370">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00067">67</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   67</span>                                  {</div>
<div class="line"><span class="lineno">   68</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">   69</span>  assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a>());</div>
<div class="line"><span class="lineno">   70</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">   71</span>  PetscReal value=0.;</div>
<div class="line"><span class="lineno">   72</span>  ierr = VecNorm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, NORM_2, &amp;value);</div>
<div class="line"><span class="lineno">   73</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">   74</span>  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">   75</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a4a613475cbe83e68cc42997ab1749c1f" name="a4a613475cbe83e68cc42997ab1749c1f"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4a613475cbe83e68cc42997ab1749c1f">&#9670;&#160;</a></span>last_local_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::PetscVector::last_local_index </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the index of the last vector element. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a801088d0a16b73338893411c00b594a0">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00718">718</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  718</span>                                                  {</div>
<div class="line"><span class="lineno">  719</span>    assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  720</span>    <span class="keywordtype">int</span> ierr = 0, petsc_first = 0, petsc_last = 0;</div>
<div class="line"><span class="lineno">  721</span>    ierr = VecGetOwnershipRange (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;petsc_first, &amp;petsc_last);</div>
<div class="line"><span class="lineno">  722</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  723</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_last);</div>
<div class="line"><span class="lineno">  724</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae8e2c6894f258aecc1d4707576cf3577" name="ae8e2c6894f258aecc1d4707576cf3577"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae8e2c6894f258aecc1d4707576cf3577">&#9670;&#160;</a></span>linfty_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::linfty_norm </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the maximum absolute value of the elements of this vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ad110dd5f363f806eef72b67f8756be36">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00079">79</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   79</span>                                      {</div>
<div class="line"><span class="lineno">   80</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">   81</span>  assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a>());</div>
<div class="line"><span class="lineno">   82</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">   83</span>  PetscReal value=0.;</div>
<div class="line"><span class="lineno">   84</span>  ierr = VecNorm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, NORM_INFINITY, &amp;value);</div>
<div class="line"><span class="lineno">   85</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">   86</span>  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">   87</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a282ee28379f76d570c36a798d72a5484" name="a282ee28379f76d570c36a798d72a5484"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a282ee28379f76d570c36a798d72a5484">&#9670;&#160;</a></span>local_size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::PetscVector::local_size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the local size of the vector (index_stop-index_start) </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a8d012b41e20b62c55d4823b7fe008afb">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00700">700</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  700</span>                                     {</div>
<div class="line"><span class="lineno">  701</span>    assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  702</span>    <span class="keywordtype">int</span> ierr = 0, petsc_size = 0;</div>
<div class="line"><span class="lineno">  703</span>    ierr = VecGetLocalSize (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;petsc_size);</div>
<div class="line"><span class="lineno">  704</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  705</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_size);</div>
<div class="line"><span class="lineno">  706</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ae6fc1f3d94f3466a88b72191fd999a45" name="ae6fc1f3d94f3466a88b72191fd999a45"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ae6fc1f3d94f3466a88b72191fd999a45">&#9670;&#160;</a></span>localize() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::localize </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>first_local_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>last_local_idx</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>send_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Updates a local vector with selected values from neighboring processors. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aab08801600890c48c64b0ddc08085928">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00625">625</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  629</span>  { <span class="comment">// ==================================</span></div>
<div class="line"><span class="lineno">  630</span> </div>
<div class="line"><span class="lineno">  631</span>  assert(send_list.size() &lt;= this-&gt;size());</div>
<div class="line"><span class="lineno">  632</span>  assert(last_local_idx+1 &lt;= this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>());</div>
<div class="line"><span class="lineno">  633</span>  <span class="comment">// -------------------------------------------</span></div>
<div class="line"><span class="lineno">  634</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>       = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>();</div>
<div class="line"><span class="lineno">  635</span>  <span class="keyword">const</span> <span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a> = (last_local_idx - first_local_idx + 1);</div>
<div class="line"><span class="lineno">  636</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  637</span>  <span class="keywordtype">int</span> npi=1;</div>
<div class="line"><span class="lineno">  638</span> </div>
<div class="line"><span class="lineno">  639</span>  <span class="comment">// But we do need to stay in sync for degenerate cases</span></div>
<div class="line"><span class="lineno">  640</span>  MPI_Comm_size(MPI_COMM_WORLD, &amp;npi);</div>
<div class="line"><span class="lineno">  641</span>  <span class="keywordflow">if</span> (npi == 1)    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  642</span>  <span class="comment">// Build a parallel vector, initialize it with the local parts of (*this)</span></div>
<div class="line"><span class="lineno">  643</span>  <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a> parallel_vec;</div>
<div class="line"><span class="lineno">  644</span>  parallel_vec.init(<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>, <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>, <span class="keyword">true</span>, <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>);</div>
<div class="line"><span class="lineno">  645</span> </div>
<div class="line"><span class="lineno">  646</span>  {</div>
<div class="line"><span class="lineno">  647</span>    <span class="comment">// Copy part of *this into the parallel_vec -------------</span></div>
<div class="line"><span class="lineno">  648</span>    IS is;</div>
<div class="line"><span class="lineno">  649</span>    VecScatter scatter;</div>
<div class="line"><span class="lineno">  650</span>    std::vector&lt;int&gt; <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>(<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>);</div>
<div class="line"><span class="lineno">  651</span>    std::iota(<a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>.begin(), <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>.end(), first_local_idx);</div>
<div class="line"><span class="lineno">  652</span> </div>
<div class="line"><span class="lineno">  653</span>    <span class="comment">// Create the index set &amp; scatter object</span></div>
<div class="line"><span class="lineno">  654</span>    ierr = ISCreateGeneral(MPI_COMM_WORLD, <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>,</div>
<div class="line"><span class="lineno">  655</span>                           <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a> ? &amp;idx[0] : NULL, PETSC_USE_POINTER, &amp;is);</div>
<div class="line"><span class="lineno">  656</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  657</span>    ierr = VecScatterCreate(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,is, parallel_vec._vec, is, &amp;scatter);</div>
<div class="line"><span class="lineno">  658</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  659</span>    <span class="comment">// Perform the scatter</span></div>
<div class="line"><span class="lineno">  660</span>    ierr = VecScatterBegin(scatter, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, parallel_vec._vec,</div>
<div class="line"><span class="lineno">  661</span>                           INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  662</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  663</span>    ierr = VecScatterEnd(scatter, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, parallel_vec._vec,</div>
<div class="line"><span class="lineno">  664</span>                         INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  665</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  666</span>    <span class="comment">// Clean up</span></div>
<div class="line"><span class="lineno">  667</span>    ierr = ISDestroy(&amp;is);</div>
<div class="line"><span class="lineno">  668</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  669</span>    ierr = VecScatterDestroy(&amp;scatter);</div>
<div class="line"><span class="lineno">  670</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  671</span>  } <span class="comment">// -------------------------------------------------------</span></div>
<div class="line"><span class="lineno">  672</span> </div>
<div class="line"><span class="lineno">  673</span>  <span class="comment">// localize like normal</span></div>
<div class="line"><span class="lineno">  674</span>  parallel_vec.close();</div>
<div class="line"><span class="lineno">  675</span>  parallel_vec.localize(*<span class="keyword">this</span>, send_list);</div>
<div class="line"><span class="lineno">  676</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a>();</div>
<div class="line"><span class="lineno">  677</span> </div>
<div class="line"><span class="lineno">  678</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  679</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a9c351017a679abb97160b18cb09a7ef3" name="a9c351017a679abb97160b18cb09a7ef3"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9c351017a679abb97160b18cb09a7ef3">&#9670;&#160;</a></span>localize() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::localize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>v_local</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Same, but fills a <code><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a></code> instead of a <code>std::vector</code>. </p>
<p>This function localizes data from any processor to a local vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#abc5c852cbb755c8e0b3eb6c59d145ae0">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00520">520</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  522</span>        { <span class="comment">// ===================================================</span></div>
<div class="line"><span class="lineno">  523</span> </div>
<div class="line"><span class="lineno">  524</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  525</span>  <span class="comment">// Make sure the NumericVector passed in is really a PetscVector</span></div>
<div class="line"><span class="lineno">  526</span>  <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* v_local = <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;v_local_in);</div>
<div class="line"><span class="lineno">  527</span>  assert(v_local != NULL);</div>
<div class="line"><span class="lineno">  528</span>  assert(v_local-&gt;size() == this-&gt;size());</div>
<div class="line"><span class="lineno">  529</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  530</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>();</div>
<div class="line"><span class="lineno">  531</span>  IS is;</div>
<div class="line"><span class="lineno">  532</span>  VecScatter scatter;</div>
<div class="line"><span class="lineno">  533</span> </div>
<div class="line"><span class="lineno">  534</span>  <span class="comment">// Create idx, idx[i] = i;</span></div>
<div class="line"><span class="lineno">  535</span>  std::vector&lt;int&gt; <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>(n);</div>
<div class="line"><span class="lineno">  536</span>  std::iota(<a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>.begin(), <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>.end(), 0);</div>
<div class="line"><span class="lineno">  537</span><span class="comment">//   Utility::iota (idx.begin(), idx.end(), 0);</span></div>
<div class="line"><span class="lineno">  538</span> </div>
<div class="line"><span class="lineno">  539</span>  <span class="comment">// Create the index set &amp; scatter object</span></div>
<div class="line"><span class="lineno">  540</span>  ierr = ISCreateGeneral(MPI_COMM_WORLD, n, &amp;idx[0], PETSC_USE_POINTER, &amp;is);</div>
<div class="line"><span class="lineno">  541</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  542</span> </div>
<div class="line"><span class="lineno">  543</span>  ierr = VecScatterCreate(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,   is,v_local-&gt;_vec, is,&amp;scatter);</div>
<div class="line"><span class="lineno">  544</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  545</span> </div>
<div class="line"><span class="lineno">  546</span>  <span class="comment">// Perform the scatter</span></div>
<div class="line"><span class="lineno">  547</span>  ierr = VecScatterBegin(scatter, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, v_local-&gt;_vec,</div>
<div class="line"><span class="lineno">  548</span>                         INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  549</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  550</span>  ierr = VecScatterEnd(scatter, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, v_local-&gt;_vec,</div>
<div class="line"><span class="lineno">  551</span>                       INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  552</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  553</span> </div>
<div class="line"><span class="lineno">  554</span>  <span class="comment">// Clean up</span></div>
<div class="line"><span class="lineno">  555</span>  ierr = ISDestroy(&amp;is);</div>
<div class="line"><span class="lineno">  556</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  557</span>  ierr = VecScatterDestroy(&amp;scatter);</div>
<div class="line"><span class="lineno">  558</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  559</span> </div>
<div class="line"><span class="lineno">  560</span>  <span class="comment">// Make sure ghost dofs are up to date</span></div>
<div class="line"><span class="lineno">  561</span>  <span class="keywordflow">if</span> (v_local-&gt;type() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)   v_local-&gt;close();</div>
<div class="line"><span class="lineno">  562</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  563</span> </div>
<div class="line"><span class="lineno">  564</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a38c23362386ed34dc810e7c9ed3bd127" name="a38c23362386ed34dc810e7c9ed3bd127"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a38c23362386ed34dc810e7c9ed3bd127">&#9670;&#160;</a></span>localize() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::localize </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>v_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const std::vector&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>send_list</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a local vector <code>v_local</code> containing. </p>
<p>This function localizes data from any processor to a local vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a8fd7eaef548a167d7a25847545df90d3">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00568">568</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  571</span>        { <span class="comment">// ===========================================</span></div>
<div class="line"><span class="lineno">  572</span>  <span class="comment">// Workaround for a strange bug at large-scale.</span></div>
<div class="line"><span class="lineno">  573</span>  <span class="comment">// If we have ghosting, PETSc lets us just copy the solution, and</span></div>
<div class="line"><span class="lineno">  574</span>  <span class="comment">// doing so avoids a segfault?</span></div>
<div class="line"><span class="lineno">  575</span>  <span class="keywordflow">if</span> (v_local_in.type() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a> &amp;&amp;  this-&gt;type() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567ca90606f8ca5d91452541a74f1caef1d11">PARALLEL</a>) {</div>
<div class="line"><span class="lineno">  576</span>    v_local_in = *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  577</span>    <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  578</span>  }</div>
<div class="line"><span class="lineno">  579</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  580</span>  <span class="comment">// Make sure the NumericVector passed in is really a PetscVector</span></div>
<div class="line"><span class="lineno">  581</span>  <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* v_local = <span class="keyword">static_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;v_local_in);</div>
<div class="line"><span class="lineno">  582</span> </div>
<div class="line"><span class="lineno">  583</span>  assert(v_local != NULL);</div>
<div class="line"><span class="lineno">  584</span>  assert((<span class="keywordtype">int</span>)v_local-&gt;size() == (<span class="keywordtype">int</span>)this-&gt;size());</div>
<div class="line"><span class="lineno">  585</span>  assert((<span class="keywordtype">int</span>)send_list.size() &lt;= (<span class="keywordtype">int</span>)v_local-&gt;size());</div>
<div class="line"><span class="lineno">  586</span> </div>
<div class="line"><span class="lineno">  587</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  588</span>  <span class="keyword">const</span>  <span class="keywordtype">int</span> n_sl = send_list.size();</div>
<div class="line"><span class="lineno">  589</span>  IS is;</div>
<div class="line"><span class="lineno">  590</span>  VecScatter scatter;</div>
<div class="line"><span class="lineno">  591</span> </div>
<div class="line"><span class="lineno">  592</span>  std::vector&lt;int&gt; <a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>(n_sl + this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>());</div>
<div class="line"><span class="lineno">  593</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n_sl; i++)   idx[i] = static_cast&lt;int&gt;(send_list[i]);</div>
<div class="line"><span class="lineno">  594</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i != this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>(); ++i)   idx[n_sl+i] = i + this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">first_local_index</a>();</div>
<div class="line"><span class="lineno">  595</span> </div>
<div class="line"><span class="lineno">  596</span>  <span class="comment">// Create the index set &amp; scatter object</span></div>
<div class="line"><span class="lineno">  597</span>  <span class="keywordflow">if</span> (<a class="code hl_function" href="../../d9/de2/namespacefemus_1_1_mesh_tools_1_1_generation_1_1_private.html#aaf3a90632b9ae7f97dc126807a304603">idx</a>.empty())  ierr = ISCreateGeneral(MPI_COMM_WORLD,n_sl+this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>(),</div>
<div class="line"><span class="lineno">  598</span>                             PETSC_NULL, PETSC_USE_POINTER, &amp;is);</div>
<div class="line"><span class="lineno">  599</span>  <span class="keywordflow">else</span>  ierr = ISCreateGeneral(MPI_COMM_WORLD,n_sl+this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>(),</div>
<div class="line"><span class="lineno">  600</span>                                 &amp;idx[0],  PETSC_USE_POINTER,&amp;is);</div>
<div class="line"><span class="lineno">  601</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  602</span>  ierr = VecScatterCreate(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,is,v_local-&gt;_vec, is,&amp;scatter);</div>
<div class="line"><span class="lineno">  603</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  604</span> </div>
<div class="line"><span class="lineno">  605</span>  <span class="comment">// Perform the scatter</span></div>
<div class="line"><span class="lineno">  606</span>  ierr = VecScatterBegin(scatter, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, v_local-&gt;_vec,</div>
<div class="line"><span class="lineno">  607</span>                         INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  608</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  609</span>  ierr = VecScatterEnd(scatter, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, v_local-&gt;_vec,</div>
<div class="line"><span class="lineno">  610</span>                       INSERT_VALUES, SCATTER_FORWARD);</div>
<div class="line"><span class="lineno">  611</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  612</span>  <span class="comment">// Clean up</span></div>
<div class="line"><span class="lineno">  613</span>  ierr = ISDestroy(&amp;is);</div>
<div class="line"><span class="lineno">  614</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  615</span>  ierr = VecScatterDestroy(&amp;scatter);</div>
<div class="line"><span class="lineno">  616</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  617</span> </div>
<div class="line"><span class="lineno">  618</span>  <span class="comment">// Make sure ghost dofs are up to date</span></div>
<div class="line"><span class="lineno">  619</span>  <span class="keywordflow">if</span> (v_local-&gt;type() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)  v_local-&gt;close();</div>
<div class="line"><span class="lineno">  620</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  621</span> </div>
<div class="line"><span class="lineno">  622</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ec285721ca9c4c3d8ed3d991923d2ca" name="a5ec285721ca9c4c3d8ed3d991923d2ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ec285721ca9c4c3d8ed3d991923d2ca">&#9670;&#160;</a></span>localize() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::localize </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_local</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a copy of the global vector in the local vector <code>v_local</code>. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd237a8a3e8ec60b2b6953db2c0bb3d7">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00684">684</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  684</span>                                                           {</div>
<div class="line"><span class="lineno">  685</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  686</span> </div>
<div class="line"><span class="lineno">  687</span>  <span class="comment">// This function must be run on all processors at once</span></div>
<div class="line"><span class="lineno">  688</span>  <a class="code hl_define" href="../../dc/dec/_parallel_8hpp.html#a62393baf55626739885fea8ca69de53a">parallel_only</a>();</div>
<div class="line"><span class="lineno">  689</span> </div>
<div class="line"><span class="lineno">  690</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  691</span>  PetscScalar *values;</div>
<div class="line"><span class="lineno">  692</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>();</div>
<div class="line"><span class="lineno">  693</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nl = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>();</div>
<div class="line"><span class="lineno">  694</span>  v_local.clear();</div>
<div class="line"><span class="lineno">  695</span>  v_local.resize(n, 0.);</div>
<div class="line"><span class="lineno">  696</span> </div>
<div class="line"><span class="lineno">  697</span>  ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  698</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  699</span> </div>
<div class="line"><span class="lineno">  700</span>  <span class="keywordtype">int</span> ioff = <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">first_local_index</a>();</div>
<div class="line"><span class="lineno">  701</span>  <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nl; i++)   v_local[i+ioff] = static_cast&lt;double&gt;(values[i]);</div>
<div class="line"><span class="lineno">  702</span>  ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  703</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  704</span>  <a class="code hl_function" href="../../db/ded/namespacefemus_1_1_parallel.html#a17c680b5adf174b6185a5aeea86e5188">Parallel::sum</a>(v_local);   <span class="comment">//TODO must become Parallel</span></div>
<div class="line"><span class="lineno">  705</span>}</div>
<div class="ttc" id="a_parallel_8hpp_html_a62393baf55626739885fea8ca69de53a"><div class="ttname"><a href="../../dc/dec/_parallel_8hpp.html#a62393baf55626739885fea8ca69de53a">parallel_only</a></div><div class="ttdeci">#define parallel_only()</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dec/_parallel_8hpp_source.html#l00045">Parallel.hpp:45</a></div></div>
<div class="ttc" id="anamespacefemus_1_1_parallel_html_a17c680b5adf174b6185a5aeea86e5188"><div class="ttname"><a href="../../db/ded/namespacefemus_1_1_parallel.html#a17c680b5adf174b6185a5aeea86e5188">femus::Parallel::sum</a></div><div class="ttdeci">void sum(T &amp;r)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dec/_parallel_8hpp_source.html#l01694">Parallel.hpp:1694</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2e43106e5039314263c36fce1ee9fce5" name="a2e43106e5039314263c36fce1ee9fce5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2e43106e5039314263c36fce1ee9fce5">&#9670;&#160;</a></span>localize_to_all()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::localize_to_all </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_local</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Creates a local copy of the global vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a912461feae9b5a74418e26da08d1fca3">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00744">744</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  745</span>                                    {</div>
<div class="line"><span class="lineno">  746</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  747</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  748</span>  PetscScalar *values;</div>
<div class="line"><span class="lineno">  749</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n  = <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>();</div>
<div class="line"><span class="lineno">  750</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nl = <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>();</div>
<div class="line"><span class="lineno">  751</span>  v_local.resize(n);</div>
<div class="line"><span class="lineno">  752</span>  <span class="comment">// only one processor</span></div>
<div class="line"><span class="lineno">  753</span>  <span class="keywordflow">if</span> (n == nl) {</div>
<div class="line"><span class="lineno">  754</span>    ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  755</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  756</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) v_local[i] = static_cast&lt;double&gt;(values[i]);</div>
<div class="line"><span class="lineno">  757</span>    ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  758</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  759</span>  }</div>
<div class="line"><span class="lineno">  760</span>  <span class="comment">// otherwise multiple processors</span></div>
<div class="line"><span class="lineno">  761</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  762</span>    <span class="keywordtype">int</span> ioff = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">first_local_index</a>();</div>
<div class="line"><span class="lineno">  763</span>    std::vector&lt;double&gt; local_values(n, 0.);</div>
<div class="line"><span class="lineno">  764</span>    {</div>
<div class="line"><span class="lineno">  765</span>      ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  766</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  767</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nl; i++) {</div>
<div class="line"><span class="lineno">  768</span>        local_values[i+ioff] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(values[i]);</div>
<div class="line"><span class="lineno">  769</span>      }</div>
<div class="line"><span class="lineno">  770</span>      ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  771</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  772</span>    }</div>
<div class="line"><span class="lineno">  773</span>    <span class="keywordtype">int</span> nprocs;</div>
<div class="line"><span class="lineno">  774</span>    MPI_Comm_size(MPI_COMM_WORLD, &amp;nprocs);</div>
<div class="line"><span class="lineno">  775</span>    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> iproc=0;iproc&lt;nprocs;iproc++){</div>
<div class="line"><span class="lineno">  776</span>      ierr = MPI_Reduce(&amp;local_values[0], &amp;v_local[0],n,MPI_DOUBLE,MPI_SUM,iproc,MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  777</span>    }</div>
<div class="line"><span class="lineno">  778</span>  }</div>
<div class="line"><span class="lineno">  779</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac46ebab319de3c8f7c982be12de13d39" name="ac46ebab319de3c8f7c982be12de13d39"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac46ebab319de3c8f7c982be12de13d39">&#9670;&#160;</a></span>localize_to_one()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::localize_to_one </td>
          <td>(</td>
          <td class="paramtype">std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v_local</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>proc_id</em> = <code>0</code>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Creates a local copy of the global vector in <code>v_local</code> only on processor <code>proc_id</code>. By default the data is sent to processor 0. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a79162ba04fabd23806f9bd4ac360e59c">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00708">708</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  711</span>        {</div>
<div class="line"><span class="lineno">  712</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  713</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  714</span>  PetscScalar *values;</div>
<div class="line"><span class="lineno">  715</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> n  = <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>();</div>
<div class="line"><span class="lineno">  716</span>  <span class="keyword">const</span> <span class="keywordtype">int</span> nl = <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>();</div>
<div class="line"><span class="lineno">  717</span>  v_local.resize(n);</div>
<div class="line"><span class="lineno">  718</span>  <span class="comment">// only one processor</span></div>
<div class="line"><span class="lineno">  719</span>  <span class="keywordflow">if</span> (n == nl) {</div>
<div class="line"><span class="lineno">  720</span>    ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  721</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  722</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;n; i++) v_local[i] = static_cast&lt;double&gt;(values[i]);</div>
<div class="line"><span class="lineno">  723</span>    ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  724</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  725</span>  }</div>
<div class="line"><span class="lineno">  726</span>  <span class="comment">// otherwise multiple processors</span></div>
<div class="line"><span class="lineno">  727</span>  <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  728</span>    <span class="keywordtype">int</span> ioff = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">first_local_index</a>();</div>
<div class="line"><span class="lineno">  729</span>    std::vector&lt;double&gt; local_values(n, 0.);</div>
<div class="line"><span class="lineno">  730</span>    {</div>
<div class="line"><span class="lineno">  731</span>      ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  732</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  733</span>      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nl; i++) {</div>
<div class="line"><span class="lineno">  734</span>        local_values[i+ioff] = <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(values[i]);</div>
<div class="line"><span class="lineno">  735</span>      }</div>
<div class="line"><span class="lineno">  736</span>      ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  737</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  738</span>    }</div>
<div class="line"><span class="lineno">  739</span>    ierr = MPI_Reduce(&amp;local_values[0], &amp;v_local[0],n,MPI_DOUBLE,MPI_SUM,pid,MPI_COMM_WORLD);</div>
<div class="line"><span class="lineno">  740</span>  }</div>
<div class="line"><span class="lineno">  741</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a56ca5070aac99c844908d46309949a7c" name="a56ca5070aac99c844908d46309949a7c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a56ca5070aac99c844908d46309949a7c">&#9670;&#160;</a></span>map_global_to_local_index()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::PetscVector::map_global_to_local_index </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Maps the global index <code>i</code> to the corresponding global index. If the index is not a ghost cell, this is done by subtraction the number of the first local index. If it is a ghost cell, it has to be looked up in the map. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00727">727</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  727</span>                                                                      {</div>
<div class="line"><span class="lineno">  728</span>    assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  729</span> </div>
<div class="line"><span class="lineno">  730</span>    <span class="keywordtype">int</span> ierr = 0, petsc_first = 0, petsc_last = 0;</div>
<div class="line"><span class="lineno">  731</span>    ierr = VecGetOwnershipRange (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;petsc_first, &amp;petsc_last);</div>
<div class="line"><span class="lineno">  732</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  733</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> first = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_first);</div>
<div class="line"><span class="lineno">  734</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> last = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_last);</div>
<div class="line"><span class="lineno">  735</span> </div>
<div class="line"><span class="lineno">  736</span>    <span class="keywordflow">if</span> ( (i &gt;= first) &amp;&amp; (i &lt; last))    {</div>
<div class="line"><span class="lineno">  737</span>      <span class="keywordflow">return</span> i - first;</div>
<div class="line"><span class="lineno">  738</span>    }</div>
<div class="line"><span class="lineno">  739</span> </div>
<div class="line"><span class="lineno">  740</span>    GlobalToLocalMap::const_iterator it = <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>.find (i);</div>
<div class="line"><span class="lineno">  741</span>    assert (it != <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>.end());</div>
<div class="line"><span class="lineno">  742</span>    <span class="keywordflow">return</span> it-&gt;second + last - first;</div>
<div class="line"><span class="lineno">  743</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ab2fb8fa48df9f76e71156b3c1fa1ca7a" name="ab2fb8fa48df9f76e71156b3c1fa1ca7a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ab2fb8fa48df9f76e71156b3c1fa1ca7a">&#9670;&#160;</a></span>matrix_mult()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::matrix_mult </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>vec_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_13_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U+=A*V$" src="../../form_13.png"/></picture>, add the product A*v </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#abc7a62c82d215dcc9e6b42f7bb4ee8eb">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00203">203</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  203</span>                                                                                    {</div>
<div class="line"><span class="lineno">  204</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  205</span>  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><span class="lineno">  206</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* v = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;vec_in);</div>
<div class="line"><span class="lineno">  207</span>  <span class="keyword">const</span> PetscMatrix* <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>PetscMatrix*<span class="keyword">&gt;</span>(&amp;mat_in);</div>
<div class="line"><span class="lineno">  208</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  209</span>  <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>-&gt;close();</div>
<div class="line"><span class="lineno">  210</span>  ierr = MatMult(<span class="keyword">const_cast&lt;</span>PetscMatrix*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>)-&gt;mat(),v-&gt;_vec,<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  211</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  212</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a>();</div>
<div class="line"><span class="lineno">  213</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  214</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a643df05743c8c974176602369a7d540c" name="a643df05743c8c974176602369a7d540c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a643df05743c8c974176602369a7d540c">&#9670;&#160;</a></span>matrix_mult_transpose()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::matrix_mult_transpose </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>vec_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>mat_in</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function computes the residual r=P^t x. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a94072c3be7b12eb7fb6113f565b9e5d2">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00219">219</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  219</span>                                                                                              {</div>
<div class="line"><span class="lineno">  220</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  221</span>  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><span class="lineno">  222</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* v = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;vec_in);</div>
<div class="line"><span class="lineno">  223</span>  <span class="keyword">const</span> PetscMatrix* <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>PetscMatrix*<span class="keyword">&gt;</span>(&amp;mat_in);</div>
<div class="line"><span class="lineno">  224</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  225</span>  <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>-&gt;close();</div>
<div class="line"><span class="lineno">  226</span>  ierr = MatMultTranspose(<span class="keyword">const_cast&lt;</span>PetscMatrix*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>)-&gt;mat(),v-&gt;_vec,<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  227</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  228</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a>();</div>
<div class="line"><span class="lineno">  229</span>  <span class="keywordflow">return</span>;</div>
<div class="line"><span class="lineno">  230</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7e45ab5b4889bc59dcaf0413f5253b86" name="a7e45ab5b4889bc59dcaf0413f5253b86"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7e45ab5b4889bc59dcaf0413f5253b86">&#9670;&#160;</a></span>max()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::max </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the maximum element in the vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a8eda5468f45a3115fc55faf3aca9f57b">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00788">788</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  788</span>                                       {</div>
<div class="line"><span class="lineno">  789</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  790</span>    <span class="keywordtype">int</span> index = 0, ierr = 0;</div>
<div class="line"><span class="lineno">  791</span>    PetscReal <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a7e45ab5b4889bc59dcaf0413f5253b86">max</a> = 0.;</div>
<div class="line"><span class="lineno">  792</span>    ierr = VecMax (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;index, &amp;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a7e45ab5b4889bc59dcaf0413f5253b86">max</a>);</div>
<div class="line"><span class="lineno">  793</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  794</span>    <span class="comment">// this return value is correct: VecMax returns a PetscReal</span></div>
<div class="line"><span class="lineno">  795</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> (<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a7e45ab5b4889bc59dcaf0413f5253b86">max</a>);</div>
<div class="line"><span class="lineno">  796</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a7e45ab5b4889bc59dcaf0413f5253b86"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a7e45ab5b4889bc59dcaf0413f5253b86">femus::PetscVector::max</a></div><div class="ttdeci">double max() const</div><div class="ttdoc">This function returns the maximum element in the vector.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00788">PetscVector.hpp:788</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3bbc9e00cee5c0c3bc20487f48a6d72a" name="a3bbc9e00cee5c0c3bc20487f48a6d72a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3bbc9e00cee5c0c3bc20487f48a6d72a">&#9670;&#160;</a></span>min()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::min </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the minimum element in the vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a243fa2b85e0ef03df5b6ce7096cd4700">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00777">777</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  777</span>                                        {</div>
<div class="line"><span class="lineno">  778</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  779</span>    <span class="keywordtype">int</span> index = 0, ierr = 0;</div>
<div class="line"><span class="lineno">  780</span>    PetscReal <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3bbc9e00cee5c0c3bc20487f48a6d72a">min</a> = 0.;</div>
<div class="line"><span class="lineno">  781</span>    ierr = VecMin (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;index, &amp;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3bbc9e00cee5c0c3bc20487f48a6d72a">min</a>);</div>
<div class="line"><span class="lineno">  782</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  783</span>    <span class="comment">// this return value is correct: VecMin returns a PetscReal</span></div>
<div class="line"><span class="lineno">  784</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> (<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3bbc9e00cee5c0c3bc20487f48a6d72a">min</a>);</div>
<div class="line"><span class="lineno">  785</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a3bbc9e00cee5c0c3bc20487f48a6d72a"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3bbc9e00cee5c0c3bc20487f48a6d72a">femus::PetscVector::min</a></div><div class="ttdeci">double min() const</div><div class="ttdoc">This function returns the minimum element in the vector.</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00777">PetscVector.hpp:777</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a2f9ce3bea02e59a55505ed80e7ea26bb" name="a2f9ce3bea02e59a55505ed80e7ea26bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2f9ce3bea02e59a55505ed80e7ea26bb">&#9670;&#160;</a></span>operator()()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::operator() </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Access components, returns <code>U(i)</code>. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ab54106edd2a7508e3b926d7e29772c20">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00746">746</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  746</span>                                                          {</div>
<div class="line"><span class="lineno">  747</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a9f69ab1cfaa5e08f4421cdce135c5804">_get_array</a>();</div>
<div class="line"><span class="lineno">  748</span>    <span class="keyword">const</span> <span class="keywordtype">int</span> local_index = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a56ca5070aac99c844908d46309949a7c">map_global_to_local_index</a> (i);</div>
<div class="line"><span class="lineno">  749</span><span class="preprocessor">#ifndef NDEBUG</span></div>
<div class="line"><span class="lineno">  750</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) assert (local_index &lt; <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0fa88c0d3fa08d1e690d2bdc6936b5ca">_local_size</a>);</div>
<div class="line"><span class="lineno">  751</span><span class="preprocessor">#endif</span></div>
<div class="line"><span class="lineno">  752</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span> (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a>[local_index]);</div>
<div class="line"><span class="lineno">  753</span> </div>
<div class="line"><span class="lineno">  754</span><span class="comment">//   double value;</span></div>
<div class="line"><span class="lineno">  755</span><span class="comment">//   VecGetValues(_vec,1,&amp;i,&amp;value);</span></div>
<div class="line"><span class="lineno">  756</span><span class="comment">//</span></div>
<div class="line"><span class="lineno">  757</span><span class="comment">//   return value;</span></div>
<div class="line"><span class="lineno">  758</span> </div>
<div class="line"><span class="lineno">  759</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a67020e70f04581ad0a51851ba9f166b6" name="a67020e70f04581ad0a51851ba9f166b6"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a67020e70f04581ad0a51851ba9f166b6">&#9670;&#160;</a></span>operator*=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp; femus::NumericVector::operator*= </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Multiplication operator. Equivalent to <code>U.scale(a)</code> </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00247">247</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  247</span>                                               {</div>
<div class="line"><span class="lineno">  248</span>    this-&gt;<a class="code hl_variable" href="../../df/d33/fsi_steady_m_g_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>(a);</div>
<div class="line"><span class="lineno">  249</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  250</span>  }</div>
<div class="ttc" id="afsi_steady_m_g_8cpp_html_a80d402d10e8341004c0caf10133b80ab"><div class="ttname"><a href="../../df/d33/fsi_steady_m_g_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a></div><div class="ttdeci">double scale</div><div class="ttdef"><b>Definition</b> <a href="../../df/d33/fsi_steady_m_g_8cpp_source.html#l00015">fsiSteadyMG.cpp:15</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a249c6773bf5506aaf21adec7dae3c676" name="a249c6773bf5506aaf21adec7dae3c676"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a249c6773bf5506aaf21adec7dae3c676">&#9670;&#160;</a></span>operator+=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp; femus::PetscVector::operator+= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Addition operator. Fast equivalent to <code>U.add(1, V)</code>. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a602902c89533f633692048819a133d8e">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00090">90</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   90</span>                                                               {</div>
<div class="line"><span class="lineno">   91</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">   92</span>  assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a>());</div>
<div class="line"><span class="lineno">   93</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">add</a>(1., v);</div>
<div class="line"><span class="lineno">   94</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">   95</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a1d2e66c713a958e59c7692589fcb8347" name="a1d2e66c713a958e59c7692589fcb8347"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1d2e66c713a958e59c7692589fcb8347">&#9670;&#160;</a></span>operator-=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp; femus::PetscVector::operator-= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Subtraction operator. Fast equivalent to <code>U.add</code>(-1, V). </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a320b66fdb88bfadb4715a9cc8166b184">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00098">98</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   98</span>                                                               {</div>
<div class="line"><span class="lineno">   99</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  100</span>  assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a>());</div>
<div class="line"><span class="lineno">  101</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a5a93581252131e7434dd3a8c0d242bd2">add</a>(-1., v);</div>
<div class="line"><span class="lineno">  102</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  103</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a5ccb956f73e8b2320a4c98089df577cb" name="a5ccb956f73e8b2320a4c98089df577cb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5ccb956f73e8b2320a4c98089df577cb">&#9670;&#160;</a></span>operator/=()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp; femus::NumericVector::operator/= </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>a</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Division operator. Equivalent to <code>U.scale</code>(1./a) </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00252">252</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  252</span>                                               {</div>
<div class="line"><span class="lineno">  253</span>    this-&gt;<a class="code hl_variable" href="../../df/d33/fsi_steady_m_g_8cpp.html#a80d402d10e8341004c0caf10133b80ab">scale</a>(1./a);</div>
<div class="line"><span class="lineno">  254</span>    <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  255</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a6b19b09c93227d33ac093ec32e1436ac" name="a6b19b09c93227d33ac093ec32e1436ac"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a6b19b09c93227d33ac093ec32e1436ac">&#9670;&#160;</a></span>operator=() <span class="overload">[1/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp; femus::PetscVector::operator= </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>s</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_2_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U(0-N) = s$" src="../../form_2.png"/></picture>: fill all components. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a118539deb87a185ce2398ee434a4e34c">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00413">413</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  413</span>                                                         {</div>
<div class="line"><span class="lineno">  414</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  415</span>  assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a>());</div>
<div class="line"><span class="lineno">  416</span> </div>
<div class="line"><span class="lineno">  417</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  418</span>  PetscScalar <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a> = <span class="keyword">static_cast&lt;</span>PetscScalar<span class="keyword">&gt;</span>(s_in);</div>
<div class="line"><span class="lineno">  419</span> </div>
<div class="line"><span class="lineno">  420</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>() != 0)    {</div>
<div class="line"><span class="lineno">  421</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)  {</div>
<div class="line"><span class="lineno">  422</span>      ierr = VecSet(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>);</div>
<div class="line"><span class="lineno">  423</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  424</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  425</span>      Vec loc_vec;</div>
<div class="line"><span class="lineno">  426</span>      ierr = VecGhostGetLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  427</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  428</span>      ierr = VecSet(loc_vec, <a class="code hl_variable" href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">s</a>);</div>
<div class="line"><span class="lineno">  429</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  430</span>      ierr = VecGhostRestoreLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  431</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  432</span>    }</div>
<div class="line"><span class="lineno">  433</span>  }</div>
<div class="line"><span class="lineno">  434</span> </div>
<div class="line"><span class="lineno">  435</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  436</span>}</div>
<div class="ttc" id="anamespacefemus_html_a7216a0536acdac46863fd54b0320a8e6"><div class="ttname"><a href="../../d8/dea/namespacefemus.html#a7216a0536acdac46863fd54b0320a8e6">femus::s</a></div><div class="ttdeci">double * s</div><div class="ttdef"><b>Definition</b> <a href="../../d0/dc5/_f_s_i_time_dependent_assembly_supg_g_c_l_8hpp_source.html#l00036">FSITimeDependentAssemblySupgGCL.hpp:36</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a9b59acc5f585aa2c2ecc0dbbe64a9657" name="a9b59acc5f585aa2c2ecc0dbbe64a9657"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a9b59acc5f585aa2c2ecc0dbbe64a9657">&#9670;&#160;</a></span>operator=() <span class="overload">[2/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp; femus::PetscVector::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U = V$" src="../../form_3.png"/></picture>: copy all components. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ad11d8ee6f1fbb784f112b7cf3fc09229">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00441">441</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  441</span>                                                                 {</div>
<div class="line"><span class="lineno">  442</span>  <span class="comment">// Make sure the NumericVector passed in is really a PetscVector</span></div>
<div class="line"><span class="lineno">  443</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* v = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;v_in);</div>
<div class="line"><span class="lineno">  444</span>  *<span class="keyword">this</span> = *v;</div>
<div class="line"><span class="lineno">  445</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  446</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adf08268d805ffac0def033769e0b5c3a" name="adf08268d805ffac0def033769e0b5c3a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adf08268d805ffac0def033769e0b5c3a">&#9670;&#160;</a></span>operator=() <span class="overload">[3/4]</span></h2>

<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a> &amp; femus::PetscVector::operator= </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a> &amp;&#160;</td>
          <td class="paramname"><em>V</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U = V$" src="../../form_3.png"/></picture>: copy all components. </p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00449">449</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  449</span>                                                          {</div>
<div class="line"><span class="lineno">  450</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  451</span>  v._restore_array();</div>
<div class="line"><span class="lineno">  452</span>  assert(this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a> == v._type);</div>
<div class="line"><span class="lineno">  453</span>  assert(this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>() == (<span class="keywordtype">int</span>)v.size());</div>
<div class="line"><span class="lineno">  454</span>  assert(this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>() == v.local_size());</div>
<div class="line"><span class="lineno">  455</span>  assert(this-&gt;<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a> == v._global_to_local_map);</div>
<div class="line"><span class="lineno">  456</span>  <span class="keywordflow">if</span> ((<span class="keywordtype">int</span>)v.size() != 0)    {</div>
<div class="line"><span class="lineno">  457</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  458</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)  {</div>
<div class="line"><span class="lineno">  459</span>      ierr = VecCopy(v._vec, this-&gt;_vec);</div>
<div class="line"><span class="lineno">  460</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  461</span>    } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  462</span>      Vec loc_vec;</div>
<div class="line"><span class="lineno">  463</span>      Vec v_loc_vec;</div>
<div class="line"><span class="lineno">  464</span>      ierr = VecGhostGetLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  465</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  466</span>      ierr = VecGhostGetLocalForm(v._vec,&amp;v_loc_vec);</div>
<div class="line"><span class="lineno">  467</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  468</span>      ierr = VecCopy(v_loc_vec, loc_vec);</div>
<div class="line"><span class="lineno">  469</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  470</span>      ierr = VecGhostRestoreLocalForm(v._vec,&amp;v_loc_vec);</div>
<div class="line"><span class="lineno">  471</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  472</span>      ierr = VecGhostRestoreLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  473</span>      CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  474</span>    }</div>
<div class="line"><span class="lineno">  475</span>  }</div>
<div class="line"><span class="lineno">  476</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  477</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a2b8d11a241f5e04209e1bf6b387ec845" name="a2b8d11a241f5e04209e1bf6b387ec845"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a2b8d11a241f5e04209e1bf6b387ec845">&#9670;&#160;</a></span>operator=() <span class="overload">[4/4]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp; femus::PetscVector::operator= </td>
          <td>(</td>
          <td class="paramtype">const std::vector&lt; double &gt; &amp;&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p><picture><source srcset="../../form_3_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$U = V$" src="../../form_3.png"/></picture>: copy all components. </p>
<p>Case 1: The vector is the same size of The global vector. Only add the local components.</p>
<p>Case 2: The vector is the same size as our local piece. Insert directly to the local piece.</p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ab1457c5c924ec26d13b33d0ef198ee8c">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00480">480</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  480</span>                                                                  {</div>
<div class="line"><span class="lineno">  481</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  482</span>  <span class="keyword">const</span>  <span class="keywordtype">int</span> nl   = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>();</div>
<div class="line"><span class="lineno">  483</span>  <span class="keyword">const</span>  <span class="keywordtype">int</span> ioff = this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a0721bc1a1506471210879d543e7fe6fc">first_local_index</a>();</div>
<div class="line"><span class="lineno">  484</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  485</span>  PetscScalar* values;</div>
<div class="line"><span class="lineno">  490</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>() == (<span class="keywordtype">int</span>)v.size())    {</div>
<div class="line"><span class="lineno">  491</span>    ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  492</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  493</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nl; i++) {</div>
<div class="line"><span class="lineno">  494</span>      values[i] =  <span class="keyword">static_cast&lt;</span>PetscScalar<span class="keyword">&gt;</span>(v[i+ioff]);</div>
<div class="line"><span class="lineno">  495</span>    }</div>
<div class="line"><span class="lineno">  496</span>    ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  497</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  498</span>  }</div>
<div class="line"><span class="lineno">  499</span> </div>
<div class="line"><span class="lineno">  504</span>  <span class="keywordflow">else</span>    {</div>
<div class="line"><span class="lineno">  505</span>    assert(this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a282ee28379f76d570c36a798d72a5484">local_size</a>() == (<span class="keywordtype">int</span>)v.size());</div>
<div class="line"><span class="lineno">  506</span>    ierr = VecGetArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  507</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  508</span>    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i=0; i&lt;nl; i++)  values[i] = static_cast&lt;PetscScalar&gt;(v[i]);</div>
<div class="line"><span class="lineno">  509</span>    ierr = VecRestoreArray(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;values);</div>
<div class="line"><span class="lineno">  510</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  511</span>  }</div>
<div class="line"><span class="lineno">  512</span>  <span class="comment">// Make sure ghost dofs are up to date</span></div>
<div class="line"><span class="lineno">  513</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() == <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)   this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a68fd9a4430cff15afec82d63479c4227">close</a>();</div>
<div class="line"><span class="lineno">  514</span> </div>
<div class="line"><span class="lineno">  515</span>  <span class="keywordflow">return</span> *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  516</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aeef164f5cc86f4a78a16eee275aeaf64" name="aeef164f5cc86f4a78a16eee275aeaf64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aeef164f5cc86f4a78a16eee275aeaf64">&#9670;&#160;</a></span>pointwise_mult()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::pointwise_mult </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>vec1</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>vec2</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Computes the pointwise (i.e. component-wise) product of <code>vec1</code> and <code>vec2</code> and stores the result in <code>*this</code>. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a03fe33034db2031592e9714d6b091503">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00782">782</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  783</span>                                                             {</div>
<div class="line"><span class="lineno">  784</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  785</span> </div>
<div class="line"><span class="lineno">  786</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  787</span> </div>
<div class="line"><span class="lineno">  788</span>  <span class="comment">// Convert arguments to PetscVector*.</span></div>
<div class="line"><span class="lineno">  789</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* vec1_petsc = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;vec1);</div>
<div class="line"><span class="lineno">  790</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* vec2_petsc = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;vec2);</div>
<div class="line"><span class="lineno">  791</span> </div>
<div class="line"><span class="lineno">  792</span>  <span class="comment">// Call PETSc function.</span></div>
<div class="line"><span class="lineno">  793</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) {</div>
<div class="line"><span class="lineno">  794</span>    ierr = VecPointwiseMult(this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a>(),</div>
<div class="line"><span class="lineno">  795</span>                            <span class="keyword">const_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(vec1_petsc)-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a>(),</div>
<div class="line"><span class="lineno">  796</span>                            <span class="keyword">const_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(vec2_petsc)-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a>());</div>
<div class="line"><span class="lineno">  797</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  798</span>  } <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  799</span>    Vec loc_vec;</div>
<div class="line"><span class="lineno">  800</span>    Vec v1_loc_vec;</div>
<div class="line"><span class="lineno">  801</span>    Vec v2_loc_vec;</div>
<div class="line"><span class="lineno">  802</span>    ierr = VecGhostGetLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  803</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  804</span>    ierr = VecGhostGetLocalForm(<span class="keyword">const_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(vec1_petsc)-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a>(),&amp;v1_loc_vec);</div>
<div class="line"><span class="lineno">  805</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  806</span>    ierr = VecGhostGetLocalForm(<span class="keyword">const_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(vec2_petsc)-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a>(),&amp;v2_loc_vec);</div>
<div class="line"><span class="lineno">  807</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  808</span> </div>
<div class="line"><span class="lineno">  809</span>    ierr = VecPointwiseMult(loc_vec,v1_loc_vec,v2_loc_vec);</div>
<div class="line"><span class="lineno">  810</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  811</span> </div>
<div class="line"><span class="lineno">  812</span>    ierr = VecGhostRestoreLocalForm(<span class="keyword">const_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(vec1_petsc)-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a>(),&amp;v1_loc_vec);</div>
<div class="line"><span class="lineno">  813</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  814</span>    ierr = VecGhostRestoreLocalForm(<span class="keyword">const_cast&lt;</span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(vec2_petsc)-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">vec</a>(),&amp;v2_loc_vec);</div>
<div class="line"><span class="lineno">  815</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  816</span>    ierr = VecGhostRestoreLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  817</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  818</span>  }</div>
<div class="line"><span class="lineno">  819</span> </div>
<div class="line"><span class="lineno">  820</span>}</div>
<div class="ttc" id="aclassfemus_1_1_petsc_vector_html_a42bc9e11eda70d07852aee9b4fcd9e22"><div class="ttname"><a href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a42bc9e11eda70d07852aee9b4fcd9e22">femus::PetscVector::vec</a></div><div class="ttdeci">Vec vec()</div><div class="ttdef"><b>Definition</b> <a href="../../d0/d77/_petsc_vector_8hpp_source.html#l00159">PetscVector.hpp:159</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a747d2a62dbad91f7b04434a67c8636f4" name="a747d2a62dbad91f7b04434a67c8636f4"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a747d2a62dbad91f7b04434a67c8636f4">&#9670;&#160;</a></span>print()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::NumericVector::print </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code>std::cout</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints the local contents of the vector to the screen. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00418">418</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  418</span>                                                     {</div>
<div class="line"><span class="lineno">  419</span>  assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  420</span>  os &lt;&lt; <span class="stringliteral">&quot;Size\tglobal =  &quot;</span> &lt;&lt; this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a54137bb26362db737820d48b5c6169ed">size</a>()</div>
<div class="line"><span class="lineno">  421</span>     &lt;&lt; <span class="stringliteral">&quot;\t\tlocal =  &quot;</span> &lt;&lt; this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a8d012b41e20b62c55d4823b7fe008afb">local_size</a>() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  422</span>  os &lt;&lt; <span class="stringliteral">&quot;#\tValue&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  423</span>  <span class="keywordflow">for</span> ( <span class="keywordtype">int</span> i = this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a0249a27bfb19a2b8c7eb87b30b3e8ec0">first_local_index</a>(); i &lt; this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a801088d0a16b73338893411c00b594a0">last_local_index</a>(); i++) {</div>
<div class="line"><span class="lineno">  424</span><span class="comment">//     std::cerr &lt;&lt; &quot;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp;&amp; &quot; &lt;&lt; i; /// @todo way to locate valgrind errors </span></div>
<div class="line"><span class="lineno">  425</span>    os &lt;&lt; i;</div>
<div class="line"><span class="lineno">  426</span>    os &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span>;</div>
<div class="line"><span class="lineno">  427</span>    os &lt;&lt; (*this)(i);</div>
<div class="line"><span class="lineno">  428</span>    os &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  429</span>  }</div>
<div class="line"><span class="lineno">  430</span>}</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a54137bb26362db737820d48b5c6169ed"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a54137bb26362db737820d48b5c6169ed">femus::NumericVector::size</a></div><div class="ttdeci">virtual int size() const =0</div></div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a8d012b41e20b62c55d4823b7fe008afb"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a8d012b41e20b62c55d4823b7fe008afb">femus::NumericVector::local_size</a></div><div class="ttdeci">virtual int local_size() const =0</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aec17991ed847c6b52b055a7cd737dae1" name="aec17991ed847c6b52b055a7cd737dae1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aec17991ed847c6b52b055a7cd737dae1">&#9670;&#160;</a></span>print_global()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::NumericVector::print_global </td>
          <td>(</td>
          <td class="paramtype">std::ostream &amp;&#160;</td>
          <td class="paramname"><em>os</em> = <code>std::cout</code></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Prints the global contents of the vector to the screen. </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00433">433</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  433</span>                                                            {</div>
<div class="line"><span class="lineno">  434</span>  assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  435</span>  std::vector&lt;double&gt; v(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a54137bb26362db737820d48b5c6169ed">size</a>());</div>
<div class="line"><span class="lineno">  436</span>  this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#abd237a8a3e8ec60b2b6953db2c0bb3d7">localize</a>(v);</div>
<div class="line"><span class="lineno">  437</span>  <span class="comment">// Right now we only want one copy of the output</span></div>
<div class="line"><span class="lineno">  438</span>  </div>
<div class="line"><span class="lineno">  439</span>  os &lt;&lt; <span class="stringliteral">&quot;Size\tglobal =  &quot;</span> &lt;&lt; this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a54137bb26362db737820d48b5c6169ed">size</a>() &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  440</span>  os &lt;&lt; <span class="stringliteral">&quot;#\tValue&quot;</span> &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  441</span>  <span class="keywordflow">for</span> (<span class="keywordtype">unsigned</span> <span class="keywordtype">int</span> i=0; i!=v.size(); i++) os &lt;&lt; i &lt;&lt; <span class="stringliteral">&quot;\t&quot;</span> &lt;&lt; v[i] &lt;&lt; std::endl;</div>
<div class="line"><span class="lineno">  442</span>  </div>
<div class="line"><span class="lineno">  443</span>}</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_abd237a8a3e8ec60b2b6953db2c0bb3d7"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#abd237a8a3e8ec60b2b6953db2c0bb3d7">femus::NumericVector::localize</a></div><div class="ttdeci">virtual void localize(std::vector&lt; double &gt; &amp;v_local) const =0</div><div class="ttdoc">Creates a copy of the global vector in the local vector v_local.</div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a4b427c8ca96138d77e8da0ddc2ae5bbe" name="a4b427c8ca96138d77e8da0ddc2ae5bbe"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a4b427c8ca96138d77e8da0ddc2ae5bbe">&#9670;&#160;</a></span>resid()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::resid </td>
          <td>(</td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>rhs_in</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>x</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const <a class="el" href="../../d3/d61/classfemus_1_1_sparse_matrix.html">SparseMatrix</a> &amp;&#160;</td>
          <td class="paramname"><em>A</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function computes the residual r=b-Ax. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a421d6425fa15f0addb36804fc230ca90">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00234">234</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  235</span>                                                   {</div>
<div class="line"><span class="lineno">  236</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  237</span>  <span class="comment">// Make sure the data passed in are really of Petsc types</span></div>
<div class="line"><span class="lineno">  238</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* <a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a> = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;b_in);</div>
<div class="line"><span class="lineno">  239</span>  <span class="keyword">const</span> <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>* x = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span><a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>*<span class="keyword">&gt;</span>(&amp;x_in);</div>
<div class="line"><span class="lineno">  240</span>  <span class="keyword">const</span> PetscMatrix* <a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a> = <span class="keyword">static_cast&lt;</span><span class="keyword">const </span>PetscMatrix*<span class="keyword">&gt;</span>(&amp;A_in);</div>
<div class="line"><span class="lineno">  241</span>  <span class="keywordtype">int</span> ierr=0; <span class="comment">/* A-&gt;close();*/</span></div>
<div class="line"><span class="lineno">  242</span>  <span class="comment">// residual computation r=b-Ax</span></div>
<div class="line"><span class="lineno">  243</span>  ierr = MatMult(<span class="keyword">const_cast&lt;</span>PetscMatrix*<span class="keyword">&gt;</span>(<a class="code hl_variable" href="../../dc/d97/internal__waves__zlevel_8cpp.html#a2941385b1be5280d3b1f546356f7ec99">A</a>)-&gt;mat(), x-&gt;_vec, <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>);</div>
<div class="line"><span class="lineno">  244</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  245</span>  ierr = VecAYPX(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,-1,<a class="code hl_variable" href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a>-&gt;_vec);</div>
<div class="line"><span class="lineno">  246</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  247</span>}</div>
<div class="ttc" id="a_u_q_2ex12_2ex12_8cpp_html_a1510a66dacf9cf3586de5fc89ae2a073"><div class="ttname"><a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp.html#a1510a66dacf9cf3586de5fc89ae2a073">b</a></div><div class="ttdeci">double b</div><div class="ttdef"><b>Definition</b> <a href="../../dd/d80/_u_q_2ex12_2ex12_8cpp_source.html#l00053">ex12.cpp:53</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="aef674a8e4d928755d54d965e2ded1ab5" name="aef674a8e4d928755d54d965e2ded1ab5"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aef674a8e4d928755d54d965e2ded1ab5">&#9670;&#160;</a></span>scale()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::scale </td>
          <td>(</td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>factor</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Scale each element of the vector by the given factor. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a69a852e1b8b362836c707941bcab6f10">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00361">361</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  361</span>                                              {</div>
<div class="line"><span class="lineno">  362</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  363</span>  <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  364</span>  PetscScalar factor = <span class="keyword">static_cast&lt;</span>PetscScalar<span class="keyword">&gt;</span>(factor_in);</div>
<div class="line"><span class="lineno">  365</span> </div>
<div class="line"><span class="lineno">  366</span>  <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>)    {</div>
<div class="line"><span class="lineno">  367</span>    ierr = VecScale(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, factor);</div>
<div class="line"><span class="lineno">  368</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  369</span>  } <span class="keywordflow">else</span>   {</div>
<div class="line"><span class="lineno">  370</span>    Vec loc_vec;</div>
<div class="line"><span class="lineno">  371</span>    ierr = VecGhostGetLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  372</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  373</span>    ierr = VecScale(loc_vec, factor);</div>
<div class="line"><span class="lineno">  374</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  375</span>    ierr = VecGhostRestoreLocalForm(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>,&amp;loc_vec);</div>
<div class="line"><span class="lineno">  376</span>    CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  377</span>  }</div>
<div class="line"><span class="lineno">  378</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="adb2885699276be01494525805c9252a8" name="adb2885699276be01494525805c9252a8"></a>
<h2 class="memtitle"><span class="permalink"><a href="#adb2885699276be01494525805c9252a8">&#9670;&#160;</a></span>set()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::set </td>
          <td>(</td>
          <td class="paramtype">const int&#160;</td>
          <td class="paramname"><em>i</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">const double&#160;</td>
          <td class="paramname"><em>value</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>v(i) = value </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#ae76dc72630fe1516241d7f02438e6c19">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00106">106</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  106</span>                                                      {</div>
<div class="line"><span class="lineno">  107</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  108</span>  assert(i&lt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a55b897177341e239c8ea36e0852ba213">size</a>());</div>
<div class="line"><span class="lineno">  109</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">  110</span>  <span class="keywordtype">int</span> i_val = <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span>(i);</div>
<div class="line"><span class="lineno">  111</span>  PetscScalar petsc_value = <span class="keyword">static_cast&lt;</span>PetscScalar<span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">  112</span>  ierr = VecSetValues(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, 1, &amp;i_val, &amp;petsc_value, INSERT_VALUES);</div>
<div class="line"><span class="lineno">  113</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">  114</span>  this-&gt;<a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a722d2654319ad192949d9f844975e80e">_is_closed</a> = <span class="keyword">false</span>;</div>
<div class="line"><span class="lineno">  115</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="a55b897177341e239c8ea36e0852ba213" name="a55b897177341e239c8ea36e0852ba213"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a55b897177341e239c8ea36e0852ba213">&#9670;&#160;</a></span>size()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::PetscVector::size </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns dimension of the vector. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a54137bb26362db737820d48b5c6169ed">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00689">689</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  689</span>                                      {</div>
<div class="line"><span class="lineno">  690</span>    assert (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>());</div>
<div class="line"><span class="lineno">  691</span>    <span class="keywordtype">int</span> ierr = 0, petsc_size = 0;</div>
<div class="line"><span class="lineno">  692</span>    <span class="keywordflow">if</span> (!this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a26d8ccf5f86fae43264918ce337488b7">initialized</a>())   <span class="keywordflow">return</span> 0;</div>
<div class="line"><span class="lineno">  693</span>    ierr = VecGetSize (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;petsc_size);</div>
<div class="line"><span class="lineno">  694</span>    CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  695</span>    <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">int</span><span class="keyword">&gt;</span> (petsc_size);</div>
<div class="line"><span class="lineno">  696</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a31ab593cb8e23427dfc052f722534bff" name="a31ab593cb8e23427dfc052f722534bff"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a31ab593cb8e23427dfc052f722534bff">&#9670;&#160;</a></span>subset_l1_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::NumericVector::subset_l1_norm </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>indices</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the <picture><source srcset="../../form_7_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$l_1$" src="../../form_7.png"/></picture>-norm of the vector, i.e. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html#l00099">99</a> of file <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html">NumericVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  100</span>  {</div>
<div class="line"><span class="lineno">  101</span>    <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a09f0db3964796d3984fad98c1ba4a556">NumericVector</a>&amp; v = *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  102</span> </div>
<div class="line"><span class="lineno">  103</span>    std::set&lt; int&gt;::iterator it = indices.begin();</div>
<div class="line"><span class="lineno">  104</span>    <span class="keyword">const</span> std::set&lt; int&gt;::iterator it_end = indices.end();</div>
<div class="line"><span class="lineno">  105</span>    <span class="keywordtype">double</span> norm = 0;</div>
<div class="line"><span class="lineno">  106</span>    <span class="keywordflow">for</span>(; it != it_end; ++it)    norm += std::abs(v(*it));</div>
<div class="line"><span class="lineno">  107</span>    <a class="code hl_function" href="../../db/ded/namespacefemus_1_1_parallel.html#a17c680b5adf174b6185a5aeea86e5188">Parallel::sum</a>(norm);</div>
<div class="line"><span class="lineno">  108</span>    <span class="keywordflow">return</span> norm;</div>
<div class="line"><span class="lineno">  109</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_a09f0db3964796d3984fad98c1ba4a556"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#a09f0db3964796d3984fad98c1ba4a556">femus::NumericVector::NumericVector</a></div><div class="ttdeci">NumericVector(const ParallelType=AUTOMATIC)</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00374">NumericVector.hpp:374</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a5fe444121af2d624e9385c52be03d21c" name="a5fe444121af2d624e9385c52be03d21c"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a5fe444121af2d624e9385c52be03d21c">&#9670;&#160;</a></span>subset_l2_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::NumericVector::subset_l2_norm </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>indices</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the <picture><source srcset="../../form_8_dark.png" media="(prefers-color-scheme: dark)"/><img class="formulaInl" alt="$l_2$" src="../../form_8.png"/></picture>-norm of the vector, i.e. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html#l00112">112</a> of file <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html">NumericVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  113</span>  {</div>
<div class="line"><span class="lineno">  114</span>    <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a09f0db3964796d3984fad98c1ba4a556">NumericVector</a>&amp; v = *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  115</span>    std::set&lt; int&gt;::iterator it = indices.begin();</div>
<div class="line"><span class="lineno">  116</span>    <span class="keyword">const</span> std::set&lt; int&gt;::iterator it_end = indices.end();</div>
<div class="line"><span class="lineno">  117</span>    <span class="keywordtype">double</span> norm = 0;</div>
<div class="line"><span class="lineno">  118</span>    <span class="keywordflow">for</span>(; it != it_end; ++it)    norm += (v(*it) * v(*it));</div>
<div class="line"><span class="lineno">  119</span>    <a class="code hl_function" href="../../db/ded/namespacefemus_1_1_parallel.html#a17c680b5adf174b6185a5aeea86e5188">Parallel::sum</a>(norm);</div>
<div class="line"><span class="lineno">  120</span>    <span class="keywordflow">return</span> std::sqrt(norm);</div>
<div class="line"><span class="lineno">  121</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a7f43523d987d66bf1471867fc01dd3ec" name="a7f43523d987d66bf1471867fc01dd3ec"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a7f43523d987d66bf1471867fc01dd3ec">&#9670;&#160;</a></span>subset_linfty_norm()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::NumericVector::subset_linfty_norm </td>
          <td>(</td>
          <td class="paramtype">const std::set&lt; int &gt; &amp;&#160;</td>
          <td class="paramname"><em>indices</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the maximum absolute value of the </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html#l00124">124</a> of file <a class="el" href="../../de/dbc/_numeric_vector_8cpp_source.html">NumericVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  125</span>  {</div>
<div class="line"><span class="lineno">  126</span>    <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a09f0db3964796d3984fad98c1ba4a556">NumericVector</a>&amp; v = *<span class="keyword">this</span>;</div>
<div class="line"><span class="lineno">  127</span>    std::set&lt; int&gt;::iterator it = indices.begin();</div>
<div class="line"><span class="lineno">  128</span>    <span class="keyword">const</span> std::set&lt; int&gt;::iterator it_end = indices.end();</div>
<div class="line"><span class="lineno">  129</span>    <span class="keywordtype">double</span> norm = 0;</div>
<div class="line"><span class="lineno">  130</span>    <span class="keywordflow">for</span>(; it != it_end; ++it)    {</div>
<div class="line"><span class="lineno">  131</span>      <span class="keywordtype">double</span> value = std::abs(v(*it));</div>
<div class="line"><span class="lineno">  132</span>      <span class="keywordflow">if</span>(value &gt; norm)     norm = value;</div>
<div class="line"><span class="lineno">  133</span>    }</div>
<div class="line"><span class="lineno">  134</span>    <a class="code hl_function" href="../../db/ded/namespacefemus_1_1_parallel.html#af18000527efd43ab82a8734b3c6d91f1">Parallel::max</a>(norm);</div>
<div class="line"><span class="lineno">  135</span> </div>
<div class="line"><span class="lineno">  136</span>    <span class="keywordflow">return</span> norm;</div>
<div class="line"><span class="lineno">  137</span>  }</div>
<div class="ttc" id="anamespacefemus_1_1_parallel_html_af18000527efd43ab82a8734b3c6d91f1"><div class="ttname"><a href="../../db/ded/namespacefemus_1_1_parallel.html#af18000527efd43ab82a8734b3c6d91f1">femus::Parallel::max</a></div><div class="ttdeci">void max(T &amp;r)</div><div class="ttdef"><b>Definition</b> <a href="../../dc/dec/_parallel_8hpp_source.html#l01690">Parallel.hpp:1690</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a04089695a2db68bc91295f18ff1ea297" name="a04089695a2db68bc91295f18ff1ea297"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a04089695a2db68bc91295f18ff1ea297">&#9670;&#160;</a></span>sum()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">double femus::PetscVector::sum </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>This function returns the sum of values in a vector. </p>
<p>&lt; This function returns the sum of values in a vector </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#aa26920ed5ca50ba8c595f9b6d608db9a">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html#l00043">43</a> of file <a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">   43</span>                              {</div>
<div class="line"><span class="lineno">   44</span>  this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">   45</span>  assert(this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a34f55bd075ab087a8b6c2d10fe962f0a">closed</a>());</div>
<div class="line"><span class="lineno">   46</span>  <span class="keywordtype">int</span> ierr=0;</div>
<div class="line"><span class="lineno">   47</span>  PetscScalar value=0.;</div>
<div class="line"><span class="lineno">   48</span>  ierr = VecSum(<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;value);</div>
<div class="line"><span class="lineno">   49</span>  CHKERRABORT(MPI_COMM_WORLD,ierr);</div>
<div class="line"><span class="lineno">   50</span>  <span class="keywordflow">return</span> <span class="keyword">static_cast&lt;</span><span class="keywordtype">double</span><span class="keyword">&gt;</span>(value);</div>
<div class="line"><span class="lineno">   51</span>}</div>
</div><!-- fragment -->
</div>
</div>
<a id="aac9b1e5aacfb44580370b344112731b1" name="aac9b1e5aacfb44580370b344112731b1"></a>
<h2 class="memtitle"><span class="permalink"><a href="#aac9b1e5aacfb44580370b344112731b1">&#9670;&#160;</a></span>swap()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::swap </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html">NumericVector</a> &amp;&#160;</td>
          <td class="paramname"><em>v</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Swaps the raw PETSc vector context pointers. </p>

<p>Reimplemented from <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#af7c41b0e6db81bd7ad5e505753979dfd">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00799">799</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  799</span>                                                     {</div>
<div class="line"><span class="lineno">  800</span>    <a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#af7c41b0e6db81bd7ad5e505753979dfd">NumericVector::swap</a> (other);</div>
<div class="line"><span class="lineno">  801</span>    <a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a97a488763d754a507a0aa1a600f2a0e8">PetscVector</a>&amp; v = femus::cast_ref&lt;PetscVector&amp;&gt; (other);</div>
<div class="line"><span class="lineno">  802</span>    std::swap (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, v._vec);</div>
<div class="line"><span class="lineno">  803</span>    std::swap (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a22b1d0ffe5c8f5cea50ebdc10f931051">_destroy_vec_on_exit</a>, v._destroy_vec_on_exit);</div>
<div class="line"><span class="lineno">  804</span>    std::swap (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3e5cd746fb38edacb229b98824a68e26">_global_to_local_map</a>, v._global_to_local_map);</div>
<div class="line"><span class="lineno">  805</span>    std::swap (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a3a8817772640ae70c8edda2690d9a805">_array_is_present</a>, v._array_is_present);</div>
<div class="line"><span class="lineno">  806</span>    std::swap (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac54679893cd2b3ef663e56e54b618e64">_local_form</a>, v._local_form);</div>
<div class="line"><span class="lineno">  807</span>    std::swap (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a64a405181970b8ff404707c307d10a4a">_values</a>, v._values);</div>
<div class="line"><span class="lineno">  808</span>  }</div>
<div class="ttc" id="aclassfemus_1_1_numeric_vector_html_af7c41b0e6db81bd7ad5e505753979dfd"><div class="ttname"><a href="../../da/d12/classfemus_1_1_numeric_vector.html#af7c41b0e6db81bd7ad5e505753979dfd">femus::NumericVector::swap</a></div><div class="ttdeci">virtual void swap(NumericVector &amp;v)</div><div class="ttdoc">Exchanges the values/sizes of two vectors.</div><div class="ttdef"><b>Definition</b> <a href="../../d3/d43/_numeric_vector_8hpp_source.html#l00411">NumericVector.hpp:411</a></div></div>
</div><!-- fragment -->
</div>
</div>
<a id="a3da0dc3bbf4eed29cbfee8cb958bc1bb" name="a3da0dc3bbf4eed29cbfee8cb958bc1bb"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3da0dc3bbf4eed29cbfee8cb958bc1bb">&#9670;&#160;</a></span>type() <span class="overload">[1/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> &amp; femus::NumericVector::type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the type (SERIAL, PARALLEL, GHOSTED) of the vector. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00188">188</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  188</span>                        {</div>
<div class="line"><span class="lineno">  189</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a>;</div>
<div class="line"><span class="lineno">  190</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a426f4ebb35ef955a10b0e6f954120658" name="a426f4ebb35ef955a10b0e6f954120658"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a426f4ebb35ef955a10b0e6f954120658">&#9670;&#160;</a></span>type() <span class="overload">[2/2]</span></h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> femus::NumericVector::type </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td> const</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<dl class="section return"><dt>Returns</dt><dd>the type (SERIAL, PARALLEL, GHOSTED) of the vector. </dd></dl>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00184">184</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  184</span>                            {</div>
<div class="line"><span class="lineno">  185</span>    <span class="keywordflow">return</span> <a class="code hl_variable" href="../../da/d12/classfemus_1_1_numeric_vector.html#a40eebd0755df82e691bea575694f1100">_type</a>;</div>
<div class="line"><span class="lineno">  186</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<a id="a42bc9e11eda70d07852aee9b4fcd9e22" name="a42bc9e11eda70d07852aee9b4fcd9e22"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a42bc9e11eda70d07852aee9b4fcd9e22">&#9670;&#160;</a></span>vec()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vec femus::PetscVector::vec </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Returns the raw PETSc vector context pointer. Note this is generally not required in user-level code. Just don't do anything crazy like calling VecDestroy()! </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00159">159</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  159</span>                 {</div>
<div class="line"><span class="lineno">  160</span>        assert (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a> != NULL);</div>
<div class="line"><span class="lineno">  161</span>        <span class="keywordflow">return</span> <a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>;</div>
<div class="line"><span class="lineno">  162</span>      }</div>
</div><!-- fragment -->
</div>
</div>
<a id="ac59f171adcae52dd1777b3f09941771b" name="ac59f171adcae52dd1777b3f09941771b"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac59f171adcae52dd1777b3f09941771b">&#9670;&#160;</a></span>zero()</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">void femus::PetscVector::zero </td>
          <td>(</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">inline</span><span class="mlabel">virtual</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Set all entries to zero. Equivalent to <code>v</code> = 0. </p>

<p>Implements <a class="el" href="../../da/d12/classfemus_1_1_numeric_vector.html#a80b1efdc7101659f2035c2da880360e7">femus::NumericVector</a>.</p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00658">658</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>
<div class="fragment"><div class="line"><span class="lineno">  658</span>                                 {</div>
<div class="line"><span class="lineno">  659</span>    this-&gt;<a class="code hl_function" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ae72305c0a5c596cf56fdbdf6354bff8f">_restore_array</a>();</div>
<div class="line"><span class="lineno">  660</span>    <span class="keywordtype">int</span> ierr = 0;</div>
<div class="line"><span class="lineno">  661</span>    PetscScalar z = 0.;</div>
<div class="line"><span class="lineno">  662</span> </div>
<div class="line"><span class="lineno">  663</span>    <span class="keywordflow">if</span> (this-&gt;<a class="code hl_function" href="../../da/d12/classfemus_1_1_numeric_vector.html#a426f4ebb35ef955a10b0e6f954120658">type</a>() != <a class="code hl_enumvalue" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567cab3c5d10dc5e522ae61f52b2e1473f209">GHOSTED</a>) {</div>
<div class="line"><span class="lineno">  664</span>      ierr = VecSet (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, z);</div>
<div class="line"><span class="lineno">  665</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  666</span>    }</div>
<div class="line"><span class="lineno">  667</span>    <span class="keywordflow">else</span> {</div>
<div class="line"><span class="lineno">  668</span>      <span class="comment">/* Vectors that include ghost values require a special</span></div>
<div class="line"><span class="lineno">  669</span><span class="comment">      handling.  */</span></div>
<div class="line"><span class="lineno">  670</span>      Vec loc_vec;</div>
<div class="line"><span class="lineno">  671</span>      ierr = VecGhostGetLocalForm (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;loc_vec);</div>
<div class="line"><span class="lineno">  672</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  673</span>      ierr = VecSet (loc_vec, z);</div>
<div class="line"><span class="lineno">  674</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  675</span>      ierr = VecGhostRestoreLocalForm (<a class="code hl_variable" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#ac134673509a18ee6f600fb64d192c779">_vec</a>, &amp;loc_vec);</div>
<div class="line"><span class="lineno">  676</span>      CHKERRABORT (MPI_COMM_WORLD, ierr);</div>
<div class="line"><span class="lineno">  677</span>    }</div>
<div class="line"><span class="lineno">  678</span>  }</div>
</div><!-- fragment -->
</div>
</div>
<h2 class="groupheader">Member Data Documentation</h2>
<a id="a3a8817772640ae70c8edda2690d9a805" name="a3a8817772640ae70c8edda2690d9a805"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3a8817772640ae70c8edda2690d9a805">&#9670;&#160;</a></span>_array_is_present</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::PetscVector::_array_is_present</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>If <code>true</code>, the actual Petsc array of the values of the vector is currently accessible. doublehat means that the members <code>_local_form</code> and <code>_values</code> are valid. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00296">296</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<a id="a22b1d0ffe5c8f5cea50ebdc10f931051" name="a22b1d0ffe5c8f5cea50ebdc10f931051"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a22b1d0ffe5c8f5cea50ebdc10f931051">&#9670;&#160;</a></span>_destroy_vec_on_exit</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::PetscVector::_destroy_vec_on_exit</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>doublehis boolean value should only be set to false for the constructor which takes a PETSc Vec object. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00315">315</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<a id="a3e5cd746fb38edacb229b98824a68e26" name="a3e5cd746fb38edacb229b98824a68e26"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a3e5cd746fb38edacb229b98824a68e26">&#9670;&#160;</a></span>_global_to_local_map</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html#a6d964d0674ab95f3ed6c62aabd9a546f">GlobalToLocalMap</a> femus::PetscVector::_global_to_local_map</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Map that maps global to local ghost cells (will be empty if not in ghost cell mode. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00311">311</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<a id="a722d2654319ad192949d9f844975e80e" name="a722d2654319ad192949d9f844975e80e"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a722d2654319ad192949d9f844975e80e">&#9670;&#160;</a></span>_is_closed</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::NumericVector::_is_closed</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to see if the Numeric assemble routines have been called yet </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00359">359</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>

</div>
</div>
<a id="a1c0db787810e7c4b7d385da57081790a" name="a1c0db787810e7c4b7d385da57081790a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a1c0db787810e7c4b7d385da57081790a">&#9670;&#160;</a></span>_is_initialized</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">bool femus::NumericVector::_is_initialized</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Flag to tell if init has been called yet </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00362">362</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>

</div>
</div>
<a id="ac54679893cd2b3ef663e56e54b618e64" name="ac54679893cd2b3ef663e56e54b618e64"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac54679893cd2b3ef663e56e54b618e64">&#9670;&#160;</a></span>_local_form</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vec femus::PetscVector::_local_form</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Petsc vector datatype to hold the local form of a ghosted vector. doublehe contents of this field are only valid if the vector is ghosted and <code>_array_is_present</code> is <code>true</code>. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00301">301</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<a id="a0fa88c0d3fa08d1e690d2bdc6936b5ca" name="a0fa88c0d3fa08d1e690d2bdc6936b5ca"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a0fa88c0d3fa08d1e690d2bdc6936b5ca">&#9670;&#160;</a></span>_local_size</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">int femus::PetscVector::_local_size</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Size of the local form, for being used in assertations. doublehe contents of this field are only valid if the vector is ghosted and <code>_array_is_present</code> is <code>true</code>. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00321">321</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<a id="a40eebd0755df82e691bea575694f1100" name="a40eebd0755df82e691bea575694f1100"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a40eebd0755df82e691bea575694f1100">&#9670;&#160;</a></span>_type</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname"><a class="el" href="../../d4/dca/_paralleltype_enum_8hpp.html#a55f694af2ca20b6481914237cf7e567c">ParallelType</a> femus::NumericVector::_type</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">protected</span><span class="mlabel">inherited</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Type of vector </p>

<p class="definition">Definition at line <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html#l00365">365</a> of file <a class="el" href="../../d3/d43/_numeric_vector_8hpp_source.html">NumericVector.hpp</a>.</p>

</div>
</div>
<a id="a64a405181970b8ff404707c307d10a4a" name="a64a405181970b8ff404707c307d10a4a"></a>
<h2 class="memtitle"><span class="permalink"><a href="#a64a405181970b8ff404707c307d10a4a">&#9670;&#160;</a></span>_values</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">PetscScalar* femus::PetscVector::_values</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">mutable</span><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">
<p>Pointer to the actual Petsc array of the values of the vector. doublehis pointer is only valid if <code>_array_is_present</code> is <code>true</code>. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00305">305</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<a id="ac134673509a18ee6f600fb64d192c779" name="ac134673509a18ee6f600fb64d192c779"></a>
<h2 class="memtitle"><span class="permalink"><a href="#ac134673509a18ee6f600fb64d192c779">&#9670;&#160;</a></span>_vec</h2>

<div class="memitem">
<div class="memproto">
<table class="mlabels">
  <tr>
  <td class="mlabels-left">
      <table class="memname">
        <tr>
          <td class="memname">Vec femus::PetscVector::_vec</td>
        </tr>
      </table>
  </td>
  <td class="mlabels-right">
<span class="mlabels"><span class="mlabel">private</span></span>  </td>
  </tr>
</table>
</div><div class="memdoc">

<p>Actual Petsc vector datatype. </p>

<p class="definition">Definition at line <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html#l00292">292</a> of file <a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a>.</p>

</div>
</div>
<hr/>The documentation for this class was generated from the following files:<ul>
<li>D:/femusDoxygen/source/src/03_algebra/00_vectors/<a class="el" href="../../d0/d77/_petsc_vector_8hpp_source.html">PetscVector.hpp</a></li>
<li>D:/femusDoxygen/source/src/03_algebra/00_vectors/<a class="el" href="../../d9/d01/_petsc_vector_8cpp_source.html">PetscVector.cpp</a></li>
</ul>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="../../d8/dea/namespacefemus.html">femus</a></li><li class="navelem"><a class="el" href="../../d2/d9c/classfemus_1_1_petsc_vector.html">PetscVector</a></li>
    <li class="footer">Generated by <a href="https://www.doxygen.org/index.html"><img class="footer" src="../../doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.9.7 </li>
  </ul>
</div>
</body>
</html>
